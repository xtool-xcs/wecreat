import{_ as le,a as re}from"./materialListContent.vue_vue_type_style_index_0_lang-51e5ddc8.js";import{_ as ce,V as de}from"./bottomBar.vue_vue_type_style_index_0_lang-af91e570.js";import{u as ue}from"./device-1f3f345b.js";import{u as ve}from"./user-a7205a05.js";import{s as me}from"./opencv-49a7e8f2.js";import{g as pe,a as he}from"./commonjs-dynamic-modules-df5d654f.js";import{d as A,r as t,a as _,o as a,c as g,b as o,e as H,w as B,f as ge,F as _e,u as w,g as fe,h as ke,i as be,j as r,t as h,k as Ce,n as z,l as ye,m as we,p as Te,q as Le,_ as Ie}from"./index-e43f4e63.js";import"./bottomPopSheet.vue_vue_type_style_index_0_lang-1c011284.js";import"./function-call-76f75aad.js";import"./index-affcdb37.js";import"./index-410ce858.js";import"./isObject-93378927.js";const $e={key:0,class:"slider-skeleton-content"},Se=A({__name:"sliderTabs",props:{slideTabsList:null,isSliderBarLoading:{type:Boolean}},emits:["update:id","handleClick"],setup(m,{emit:p}){const T=m,f=t(0),L=()=>{const k=w(T.slideTabsList)[f.value],i=k.id?k.id.split("/"):null,l=i?i[i.length-1]:"";p("update:id",l),p("handleClick")};return(k,i)=>{const l=_("van-skeleton-paragraph"),N=_("van-tab"),I=_("van-tabs");return m.isSliderBarLoading?(a(),g("div",$e,[o(l),o(l),o(l),o(l),o(l)])):(a(),H(I,{key:1,active:f.value,"onUpdate:active":i[0]||(i[0]=c=>f.value=c),class:"slider-content",onClick:L},{default:B(()=>[(a(!0),g(_e,null,ge(m.slideTabsList,(c,b)=>(a(),H(N,{key:b+1,title:c.title},null,8,["title"]))),128))]),_:1},8,["active"]))}}});const Pe=m=>(Te("data-v-f59038bb"),m=m(),Le(),m),xe={class:"top-menu"},Be={key:0},He={key:1},Ne={key:2,class:"add-icon"},Ve={class:"menu-pop"},Ue={key:1,class:"user-id"},De={class:"mnus-details-item"},Ee=Pe(()=>r("div",{class:"back-img"},null,-1)),Me=A({__name:"index",setup(m){const p=we(),T=ue(),f=ve(),L=fe(()=>f.userInfos),k=20,i=t(0);let l=null;const N=window.innerHeight,I=t(""),c=t(!1),b=t(T.isConnectedDevice),E=t(),$=t(!1),C=t(!1),V=t(!1),U=t([]),S=t([]),P=t(""),d=t("success"),J=20;let y={endCursor:"",hasNextPage:!0,hasPreviousPage:!1,startCursor:""};const M=async()=>{var e;V.value=!0,$.value=!0,G();try{const{products:s}=await pe({limit:J});x("success"),V.value=!1,U.value=s.map(u=>({title:u.node.title,id:u.node.id})),P.value=ee((e=U.value[0])==null?void 0:e.id),D()}catch(s){me("服务出错,请刷新重试"),x("error")}},G=()=>{l=setInterval(()=>{i.value<k?i.value=i.value+1:x("overTime")},1e3)},x=e=>{l&&(i.value=0,d.value=e||d.value,clearInterval(l))},K=e=>{c.value=!1,p.push({path:"/editor/".concat(e)})},Q=()=>{c.value=!1,p.push({path:"/mine"})},X=()=>{$.value=!0,C.value=!1,S.value=[],y={endCursor:"",hasNextPage:!0,hasPreviousPage:!1,startCursor:""},D()},Y=()=>{x("success"),M()},Z=()=>{!y.hasNextPage||C.value||(C.value=!0,D())},D=async()=>{const{collections:e,pageInfo:s}=await he({limit:10,cursor:y.endCursor,id:P.value});C.value=!1,$.value=!1,y=s;const u=e.map(v=>{var O,j,q;const n=v.node.id.split("/"),W=n[n.length-1],F=((O=v.node.variants.nodes)==null?void 0:O[0].id).split("/"),ie=F[F.length-1];return{image:(q=(j=v.node)==null?void 0:j.featuredImage)==null?void 0:q.url,tags:v.node.tags,title:v.node.title,id:W,shopId:ie,amount:v.node.priceRangeV2.maxVariantPrice.amount,showJoin:!1}});S.value=[...S.value,...u]},ee=e=>{const s=e?e.split("/"):null;return s?s[s.length-1]:""},se=()=>{p.push("/connectConfig")},te=()=>{p.push("/search")},ne=()=>{p.push("/login"),c.value=!1},ae=e=>window.screen.width/375*e,oe=()=>{const e=window.screen.height,s=ae(46+45+60);E.value=e-s};return ke(()=>{b.value=T.isConnectedDevice}),be(()=>{M(),setTimeout(()=>{oe()},100)}),(e,s)=>{const u=_("vk-icon"),v=_("van-popup"),R=_("van-empty");return a(),g("div",{class:z(["mobile-home-page",{"bg-white":d.value==="error"||d.value==="overTime"}]),style:ye({minHeight:"".concat(w(N),"px")})},[r("div",xe,[r("div",{class:"left-items items",onClick:s[0]||(s[0]=n=>c.value=!0)},[o(u,{icon:"",class:"menu-icon"}),r("span",null,h(e.$t("common.homePage")),1)]),r("div",{class:"right-items items",onClick:se},[b.value?(a(),g("span",Be,h(e.$t("home.connected")),1)):(a(),g("span",He,h(e.$t("home.connectInfos")),1)),b.value?Ce("",!0):(a(),g("span",Ne,[o(u,{icon:"",class:"add-img"})]))])]),o(v,{show:c.value,"onUpdate:show":s[2]||(s[2]=n=>c.value=n),position:"left",style:{width:"260px",height:"100%"}},{default:B(()=>{var n;return[r("div",Ve,[w(L)?(a(),g("div",Ue,h((n=w(L))==null?void 0:n.displayName),1)):(a(),g("div",{key:0,class:"user-id",onClick:ne},h(e.$t("home.pleaseToLogin")),1)),r("div",De,[r("span",{class:"items",onClick:s[1]||(s[1]=W=>K(1))},h(e.$t("home.canvas")),1),r("span",{class:"items",onClick:Q},h(e.$t("home.setting")),1)])])]}),_:1},8,["show"]),r("div",{class:z(["top-content",{hidden:d.value==="error"||d.value==="overTime"}])},[Ee,o(le,{value:I.value,"onUpdate:value":s[3]||(s[3]=n=>I.value=n),onHandleClick:te},null,8,["value"])],2),d.value==="error"||d.value==="overTime"?(a(),H(R,{key:0,image:"network",description:d.value==="error"?e.$t("error.netError"):e.$t("error.requestOverTime")},{default:B(()=>[r("div",{class:"click-refresh",onClick:Y},h(e.$t("home.clickFresh")),1)]),_:1},8,["description"])):(a(),H(re,{key:1,"material-list":S.value,height:E.value,loading:$.value,"finished-loading":!w(y).hasNextPage,"is-scroll-loading":C.value,isShowBanner:!0,onScrollLoad:Z},{tabs:B(()=>[o(Se,{id:P.value,"onUpdate:id":s[4]||(s[4]=n=>P.value=n),"slide-tabs-list":U.value,"is-slider-bar-loading":V.value,onHandleClick:X},null,8,["id","slide-tabs-list","is-slider-bar-loading"])]),_:1},8,["material-list","height","loading","finished-loading","is-scroll-loading"])),o(ce),o(de,{isHome:!0})],6)}}});const Ye=Ie(Me,[["__scopeId","data-v-f59038bb"]]);export{Ye as default};
