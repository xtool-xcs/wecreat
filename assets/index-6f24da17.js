var ul=Object.defineProperty;var hl=(v,d,y)=>d in v?ul(v,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):v[d]=y;var Fe=(v,d,y)=>(hl(v,typeof d!="symbol"?d+"":d,y),y);import{d as Ft,g as rt,s as Cr,c as St,u as De,F as Yi,f as Ya,b as Xe,w as Rt,j as He,t as et,v as Vt,n as Jt,k as er,a as It,o as ht,e as Dr,x as _r,_ as Hr,y as Xa,z as fr,A as ts,r as Ze,B as dl,C as Ge,D as ml,E as rs,i as is,G as la,H as yr,I as Ri,J as Di,p as as,q as ns,K as pl,L as ca,M as vl,N as bl,O as gl,m as ss,P as os,h as ls,Q as Li,R as $a}from"./index-e43f4e63.js";import{t as _l,c as fa,m as Kr,a as cs,u as ua,M as yl,b as Gr,i as $e,P as hr,C as Xi}from"./device-1f3f345b.js";import{d as $i,c as qe,b as wl,e as Qr,f as fs,u as us}from"./commonjs-dynamic-modules-df5d654f.js";import{i as xl,P as _t,C as sr,O as at,s as Sl,c as Va,E as dr,M as Cl,a as El}from"./index-affcdb37.js";import{_ as kl}from"./equ-img-d9c9b100.js";import{_ as Tl}from"./bottomPopSheet.vue_vue_type_style_index_0_lang-1c011284.js";import{s as Qt}from"./opencv-49a7e8f2.js";import{i as hs,b as ds,a as Ul}from"./isObject-93378927.js";import{s as ms}from"./function-call-76f75aad.js";import{u as ps}from"./user-a7205a05.js";import{g as Jr}from"./getElementPX-5c89db0f.js";function Al(v,d,y){var m=-1,x=v.length;d<0&&(d=-d>x?0:x+d),y=y>x?x:y,y<0&&(y+=x),x=d>y?0:y-d>>>0,d>>>=0;for(var g=Array(x);++m<x;)g[m]=v[m+d];return g}function Ol(v,d,y){var m=v.length;return y=y===void 0?m:y,!d&&y>=m?v:Al(v,d,y)}var Ml="\\ud800-\\udfff",Pl="\\u0300-\\u036f",Rl="\\ufe20-\\ufe2f",Dl="\\u20d0-\\u20ff",Ll=Pl+Rl+Dl,Il="\\ufe0e\\ufe0f",Fl="\\u200d",Bl=RegExp("["+Fl+Ml+Ll+Il+"]");function vs(v){return Bl.test(v)}function Nl(v){return v.split("")}var bs="\\ud800-\\udfff",zl="\\u0300-\\u036f",jl="\\ufe20-\\ufe2f",Hl="\\u20d0-\\u20ff",Gl=zl+jl+Hl,Wl="\\ufe0e\\ufe0f",Yl="["+bs+"]",Vi="["+Gl+"]",Zi="\\ud83c[\\udffb-\\udfff]",Xl="(?:"+Vi+"|"+Zi+")",gs="[^"+bs+"]",_s="(?:\\ud83c[\\udde6-\\uddff]){2}",ys="[\\ud800-\\udbff][\\udc00-\\udfff]",$l="\\u200d",ws=Xl+"?",xs="["+Wl+"]?",Vl="(?:"+$l+"(?:"+[gs,_s,ys].join("|")+")"+xs+ws+")*",Zl=xs+ws+Vl,ql="(?:"+[gs+Vi+"?",Vi,_s,ys,Yl].join("|")+")",Kl=RegExp(Zi+"(?="+Zi+")|"+ql+Zl,"g");function Ql(v){return v.match(Kl)||[]}function Jl(v){return vs(v)?Ql(v):Nl(v)}function ec(v){return function(d){d=_l(d);var y=vs(d)?Jl(d):void 0,m=y?y[0]:d.charAt(0),x=y?Ol(y,1).join(""):d.slice(1);return m[v]()+x}}var tc=ec("toUpperCase");const rc=tc;var ic="[object String]";function yi(v){return typeof v=="string"||!xl(v)&&hs(v)&&ds(v)==ic}var ac="[object Number]";function wr(v){return typeof v=="number"||hs(v)&&ds(v)==ac}var nc="Expected a function";function sc(v,d,y){var m=!0,x=!0;if(typeof v!="function")throw new TypeError(nc);return Ul(y)&&(m="leading"in y?!!y.leading:m,x="trailing"in y?!!y.trailing:x),$i(v,d,{leading:m,maxWait:d,trailing:x})}const Za={};function Ss(v,d){const y=Za[v]||0,m=new Date().getTime();m-y<=300&&d&&d(),Za[v]=m}const oc={class:"edit-setting-config"},lc={key:0,class:"bottom-button"},cc={class:"icon operate-icons"},fc={class:"icon operate-icons"},uc={key:1,class:"bottom-button process"},hc={class:"process-slider-row flex-center meterial"},dc={class:"process-slider-row flex-center"},mc={class:"tabs"},pc=["title","name","onClick"],vc={key:0},bc={class:"process-slider-row"},gc={class:"prosess-title"},_c={class:"flex flex-center paddLeft15"},yc={class:"process-slider-row"},wc={class:"prosess-title"},xc={class:"flex flex-center paddLeft15"},Sc={class:"process-slider-row flex-center"},Cc={class:"prosess-title"},Ec={key:1},kc={class:"process-slider-row"},Tc={class:"prosess-title"},Uc={class:"flex flex-center paddLeft15"},Ac={class:"process-slider-row"},Oc={class:"prosess-title"},Mc={class:"flex flex-center paddLeft15"},Pc={class:"process-slider-row flex-center"},Rc={class:"prosess-title"},Dc={key:2},Lc={class:"process-slider-row"},Ic={class:"prosess-title"},Fc={class:"flex flex-center paddLeft15"},Bc={class:"process-slider-row"},Nc={class:"prosess-title"},zc={class:"flex flex-center paddLeft15"},jc={class:"process-slider-row flex-center"},Hc={class:"prosess-title"},Gc=Ft({__name:"EditBottomBar",props:{isShowProcessPop:{type:Boolean},isCanvasMoved:{type:Boolean},currentPage:null,buttons:null,processAttr:null,processMode:null,imageProcessMode:null,plate:null,times:null,isRanging:{type:Boolean},isTakingPhoto:{type:Boolean}},emits:["handleToolClick","handleSwitchModel","onClickTab","onFormChange","handleFocus","handleTakePhoto","update:processAttr","update:plate","update:times"],setup(v,{emit:d}){const y=v,m=rt(()=>y.isShowProcessPop),x=rt(()=>y.isCanvasMoved),g=rt(()=>fa(y.processAttr)),b=Cr({"engrave.power":!1,"fillEngrave.power":!1,"cut.power":!1,"engrave.speed":!1,"fillEngrave.speed":!1,"cut.speed":!1}),f={image:600,vector:250},n=rt(()=>t.value||y.processAttr.processMode===_t.fillEngrave),o=rt(()=>n.value?f.image:f.vector),a=rt({get(){return y.plate},set(_){d("update:plate",_)}}),t=rt(()=>g.value.type==="image"),i=_=>{d("handleToolClick",_)},r=()=>{d("handleSwitchModel")},e=_=>{_==="fillEngrave"?(b["fillEngrave.power"]=!1,b["fillEngrave.speed"]=!1):_==="engrave"?(b["engrave.power"]=!1,b["engrave.speed"]=!1):_==="cut"&&(b["cut.power"]=!1,b["cut.speed"]=!1),d("onClickTab",_)},l=(_,w,S)=>{if((_.indexOf("power")>-1||_.indexOf("speed")>-1)&&!b[_]){b[_]=!0;return}const C=w?parseInt(w):null;C&&C>S?(g.value[_]=S,c(_,S)):c(_,C)},s=(_,w)=>_===""||_==="0"?_:(_?parseInt(_):0)>w?""+w:_,c=(_,w)=>{d("onFormChange",_,w)},u=()=>{d("handleTakePhoto")},h=()=>{d("handleFocus")},p=(_,w,S)=>{let C=w;if(S==="minus"){if(!w||C<=1)return;C=Number(C)-1}else S==="plus"&&(C=Number(C)+1);c(_,C)};return(_,w)=>{const S=It("vk-icon"),C=It("van-button"),E=It("van-field"),k=It("van-loading"),O=It("van-slider");return ht(),St("div",oc,[De(m)?(ht(),St("div",uc,[He("div",null,[He("div",hc,[He("span",null,et(_.$t("editor.material"))+":",1),Xe(E,{modelValue:De(a),"onUpdate:modelValue":w[0]||(w[0]=U=>Vt(a)?a.value=U:null),class:"no-border","is-link":"",readonly:"",name:"picker"},null,8,["modelValue"])]),He("div",dc,[Xe(C,{class:"auto-focus-btn",onClick:u},{default:Rt(()=>[v.isTakingPhoto?(ht(),Dr(k,{key:0,color:"#333",type:"spinner",size:"16px"})):er("",!0),_r("  "+et(_.$t("editor.refreshBg"))+"  ",1)]),_:1}),Xe(C,{class:"auto-focus-btn",onClick:h},{default:Rt(()=>[v.isRanging?(ht(),Dr(k,{key:0,color:"#333",type:"spinner",size:"16px"})):er("",!0),_r("  "+et(_.$t("editor.autoFocus"))+"  ",1),Xe(S,{icon:"",class:"focus-icon"})]),_:1})]),He("div",mc,[(ht(!0),St(Yi,null,Ya(De(t)?v.imageProcessMode:v.processMode,(U,F)=>(ht(),St("div",{key:F,class:Jt(["tabs-item",{active:De(g).processMode===U.key,"full-item":De(t)}]),title:U.label,name:U.key,onClick:M=>e(U.key)},[He("span",null,et(U.label),1)],10,pc))),128))]),De(g).processMode===De(_t).engrave?(ht(),St("div",vc,[He("div",bc,[He("span",gc,et(_.$t("editor.power"))+" (%):",1),He("div",_c,[Xe(O,{modelValue:De(g).engrave.power,"onUpdate:modelValue":w[1]||(w[1]=U=>De(g).engrave.power=U),max:100,onChange:w[2]||(w[2]=U=>c("engrave.power",U))},null,8,["modelValue"]),Xe(E,{modelValue:De(g).engrave.power,"onUpdate:modelValue":[w[3]||(w[3]=U=>De(g).engrave.power=U),w[4]||(w[4]=U=>l("engrave.power",U,100))],class:Jt(["border-cell",{line:De(g).engrave.power>100}]),type:"number",max:100,formatter:U=>s(U,100)},null,8,["modelValue","class","formatter"])])]),He("div",yc,[He("span",wc,et(_.$t("editor.speed"))+" (mm/s):",1),He("div",xc,[Xe(O,{modelValue:De(g).engrave.speed,"onUpdate:modelValue":w[5]||(w[5]=U=>De(g).engrave.speed=U),max:De(o),onChange:w[6]||(w[6]=U=>c("engrave.speed",U))},null,8,["modelValue","max"]),Xe(E,{modelValue:De(g).engrave.speed,"onUpdate:modelValue":[w[7]||(w[7]=U=>De(g).engrave.speed=U),w[8]||(w[8]=U=>l("engrave.speed",U,De(o)))],class:"border-cell",type:"number",formatter:U=>s(U,De(o))},null,8,["modelValue","formatter"])])]),He("div",Sc,[He("span",Cc,et(_.$t("editor.proTimes"))+":",1),Xe(E,{modelValue:De(g).engrave.repeat,"onUpdate:modelValue":w[9]||(w[9]=U=>De(g).engrave.repeat=U),class:Jt(["times border-cell",{leftDisabled:De(g).engrave.repeat<=1,rightDisabled:De(g).engrave.repeat>=999}]),type:"number","left-icon":"minus","right-icon":"plus",onClickLeftIcon:w[10]||(w[10]=()=>p("engrave.repeat",De(g).engrave.repeat,"minus")),onClickRightIcon:w[11]||(w[11]=()=>p("engrave.repeat",De(g).engrave.repeat,"plus")),onChange:w[12]||(w[12]=U=>{p("engrave.repeat",U)})},null,8,["modelValue","class"])])])):er("",!0),De(g).processMode===De(_t).fillEngrave?(ht(),St("div",Ec,[He("div",kc,[He("span",Tc,et(_.$t("editor.power"))+" (%):",1),He("div",Uc,[Xe(O,{modelValue:De(g).fillEngrave.power,"onUpdate:modelValue":w[13]||(w[13]=U=>De(g).fillEngrave.power=U),max:100,onChange:w[14]||(w[14]=U=>c("fillEngrave.power",U))},null,8,["modelValue"]),Xe(E,{modelValue:De(g).fillEngrave.power,"onUpdate:modelValue":[w[15]||(w[15]=U=>De(g).fillEngrave.power=U),w[16]||(w[16]=U=>l("fillEngrave.power",U,100))],class:"border-cell",type:"number",maxlength:"100",formatter:U=>s(U,100)},null,8,["modelValue","formatter"])])]),He("div",Ac,[He("span",Oc,et(_.$t("editor.speed"))+" (mm/s):",1),He("div",Mc,[Xe(O,{modelValue:De(g).fillEngrave.speed,"onUpdate:modelValue":w[17]||(w[17]=U=>De(g).fillEngrave.speed=U),max:De(o),onChange:w[18]||(w[18]=U=>c("fillEngrave.speed",U))},null,8,["modelValue","max"]),Xe(E,{modelValue:De(g).fillEngrave.speed,"onUpdate:modelValue":[w[19]||(w[19]=U=>De(g).fillEngrave.speed=U),w[20]||(w[20]=U=>l("fillEngrave.speed",U,De(o)))],class:"border-cell",type:"number",formatter:U=>s(U,De(o))},null,8,["modelValue","formatter"])])]),He("div",Pc,[He("span",Rc,et(_.$t("editor.proTimes"))+":",1),Xe(E,{modelValue:De(g).fillEngrave.repeat,"onUpdate:modelValue":w[21]||(w[21]=U=>De(g).fillEngrave.repeat=U),class:Jt(["times border-cell",{leftDisabled:De(g).fillEngrave.repeat<=1,rightDisabled:De(g).fillEngrave.repeat>=999}]),type:"number","left-icon":"minus","right-icon":"plus",onClickLeftIcon:w[22]||(w[22]=()=>p("fillEngrave.repeat",De(g).fillEngrave.repeat,"minus")),onClickRightIcon:w[23]||(w[23]=()=>p("fillEngrave.repeat",De(g).fillEngrave.repeat,"plus")),onChange:w[24]||(w[24]=U=>{p("fillEngrave.repeat",U)})},null,8,["modelValue","class"])])])):er("",!0),De(g).processMode===De(_t).cut?(ht(),St("div",Dc,[He("div",Lc,[He("span",Ic,et(_.$t("editor.power"))+" (%):",1),He("div",Fc,[Xe(O,{modelValue:De(g).cut.power,"onUpdate:modelValue":w[25]||(w[25]=U=>De(g).cut.power=U),max:100,onChange:w[26]||(w[26]=U=>c("cut.power",U))},null,8,["modelValue"]),Xe(E,{modelValue:De(g).cut.power,"onUpdate:modelValue":[w[27]||(w[27]=U=>De(g).cut.power=U),w[28]||(w[28]=U=>l("cut.power",U,100))],class:"border-cell",type:"number",formatter:U=>s(U,100)},null,8,["modelValue","formatter"])])]),He("div",Bc,[He("span",Nc,et(_.$t("editor.speed"))+" (mm/s):",1),He("div",zc,[Xe(O,{modelValue:De(g).cut.speed,"onUpdate:modelValue":w[29]||(w[29]=U=>De(g).cut.speed=U),max:De(o),onChange:w[30]||(w[30]=U=>c("cut.speed",U))},null,8,["modelValue","max"]),Xe(E,{modelValue:De(g).cut.speed,"onUpdate:modelValue":[w[31]||(w[31]=U=>De(g).cut.speed=U),w[32]||(w[32]=U=>l("cut.speed",U,De(o)))],class:"border-cell",type:"number",formatter:U=>s(U,De(o))},null,8,["modelValue","formatter"])])]),He("div",jc,[He("span",Hc,et(_.$t("editor.proTimes"))+":",1),Xe(E,{modelValue:De(g).cut.repeat,"onUpdate:modelValue":w[33]||(w[33]=U=>De(g).cut.repeat=U),class:Jt(["times border-cell",{leftDisabled:De(g).cut.repeat<=1,rightDisabled:De(g).cut.repeat>=999}]),type:"number","left-icon":"minus","right-icon":"plus",onClickLeftIcon:w[34]||(w[34]=()=>p("cut.repeat",De(g).cut.repeat,"minus")),onClickRightIcon:w[35]||(w[35]=()=>p("cut.repeat",De(g).cut.repeat,"plus")),onChange:w[36]||(w[36]=U=>{p("cut.repeat",U)})},null,8,["modelValue","class"])])])):er("",!0)])])):(ht(),St("div",lc,[(ht(!0),St(Yi,null,Ya(v.buttons,(U,F)=>(ht(),Dr(C,{key:F,class:"btns",size:"small",onClick:M=>i(U.key)},{default:Rt(()=>[He("div",cc,[Xe(S,{icon:U.icon},null,8,["icon"])]),_r(" "+et(U.label),1)]),_:2},1032,["onClick"]))),128)),Xe(C,{class:"btns",size:"small",onClick:r},{default:Rt(()=>[He("div",fc,[De(x)?(ht(),Dr(S,{key:0,icon:"",class:"bottom-icon"})):(ht(),Dr(S,{key:1,icon:"",class:"bottom-icon"}))]),_r(" "+et(De(x)?_.$t("editor.edit"):_.$t("editor.move")),1)]),_:1})]))])}}});const Wc=Hr(Gc,[["__scopeId","data-v-ccf00891"]]),Yc={class:"edit-page-bar"},Xc=["onClick"],$c=Ft({__name:"PageBar",props:{isShowPagePick:{type:Boolean},currentPage:null,canvasList:null},emits:["prePage","nextPage","showPagePop","closePagePop","onSelectPage"],setup(v,{emit:d}){const y=v,m=rt(()=>y.isShowPagePick),x=()=>{d("prePage")},g=()=>{d("nextPage")},b=()=>{d("showPagePop")},f=()=>{d("closePagePop")},n=o=>{d("onSelectPage",o)};return(o,a)=>{const t=It("van-cell"),i=It("van-action-sheet");return ht(),St(Yi,null,[He("div",Yc,[He("span",{class:Jt(["change-page-btn",{disabled:v.currentPage===1}]),onClick:x},et(o.$t("editor.lastPage")),3),Xe(t,{class:"show-pages-btn","is-link":"",title:"".concat(v.currentPage," / ").concat(v.canvasList.length||0),onClick:Xa(b,["stop"])},null,8,["title","onClick"]),He("span",{class:Jt(["change-page-btn",{disabled:v.currentPage===v.canvasList.length}]),onClick:Xa(g,["stop"])},et(o.$t("editor.nextPage")),11,Xc)]),Xe(i,{show:De(m),"onUpdate:show":a[0]||(a[0]=r=>Vt(m)?m.value=r:null),actions:v.canvasList,"cancel-text":o.$t("common.close"),title:o.$t("editor.pageTitle"),"close-on-click-action":"",style:{"max-height":"50%"},onCancel:f,onSelect:n},null,8,["show","actions","cancel-text","title"])],64)}}});const Vc=Hr($c,[["__scopeId","data-v-dde2a7d5"]]),Zc=""+new URL("finished-image-62ab7aa0.png",import.meta.url).href,qa={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"},kr="^\\s*",Tr="\\s*$",or="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",lr="([0-9A-Fa-f])",cr="([0-9A-Fa-f]{2})",qc=new RegExp("".concat(kr,"rgb\\s*\\(").concat(or,",").concat(or,",").concat(or,"\\)").concat(Tr)),Kc=new RegExp("".concat(kr,"rgba\\s*\\(").concat(or,",").concat(or,",").concat(or,",").concat(or,"\\)").concat(Tr)),Qc=new RegExp("".concat(kr,"#").concat(lr).concat(lr).concat(lr).concat(Tr)),Jc=new RegExp("".concat(kr,"#").concat(cr).concat(cr).concat(cr).concat(Tr)),ef=new RegExp("".concat(kr,"#").concat(lr).concat(lr).concat(lr).concat(lr).concat(Tr)),tf=new RegExp("".concat(kr,"#").concat(cr).concat(cr).concat(cr).concat(cr).concat(Tr));function At(v){return parseInt(v,16)}function Er(v){try{let d;if(d=Jc.exec(v))return[At(d[1]),At(d[2]),At(d[3]),1];if(d=qc.exec(v))return[Et(d[1]),Et(d[5]),Et(d[9]),1];if(d=Kc.exec(v))return[Et(d[1]),Et(d[5]),Et(d[9]),Br(d[13])];if(d=Qc.exec(v))return[At(d[1]+d[1]),At(d[2]+d[2]),At(d[3]+d[3]),1];if(d=tf.exec(v))return[At(d[1]),At(d[2]),At(d[3]),Br(At(d[4])/255)];if(d=ef.exec(v))return[At(d[1]+d[1]),At(d[2]+d[2]),At(d[3]+d[3]),Br(At(d[4]+d[4])/255)];if(v in qa)return Er(qa[v]);throw new Error("[seemly/rgba]: Invalid color value ".concat(v,"."))}catch(d){throw d}}function rf(v){return v>1?1:v<0?0:v}function af(v,d,y,m){return"rgba(".concat(Et(v),", ").concat(Et(d),", ").concat(Et(y),", ").concat(rf(m),")")}function Ii(v,d,y,m,x){return Et((v*d*(1-m)+y*m)/x)}function nf(v,d){Array.isArray(v)||(v=Er(v)),Array.isArray(d)||(d=Er(d));const y=v[3],m=d[3],x=Br(y+m-y*m);return af(Ii(v[0],y,d[0],m,x),Ii(v[1],y,d[1],m,x),Ii(v[2],y,d[2],m,x),x)}function ei(v,d){const[y,m,x,g=1]=Array.isArray(v)?v:Er(v),{lightness:b=1,alpha:f=1}=d;return sf([y*b,m*b,x*b,g*f])}function Br(v){const d=Math.round(Number(v)*100)/100;return d>1?1:d<0?0:d}function Et(v){const d=Math.round(Number(v));return d>255?255:d<0?0:d}function sf(v){const[d,y,m]=v;return 3 in v?"rgba(".concat(Et(d),", ").concat(Et(y),", ").concat(Et(m),", ").concat(Br(v[3]),")"):"rgba(".concat(Et(d),", ").concat(Et(y),", ").concat(Et(m),", 1)")}function of(v,d){throw new Error("[naive/".concat(v,"]: ").concat(d))}const lf=/^(\d|\.)+$/,Ka=/(\d|\.)+/;function mr(v,{c:d=1,offset:y=0,attachPx:m=!0}={}){if(typeof v=="number"){const x=(v+y)*d;return x===0?"0":"".concat(x,"px")}else if(typeof v=="string")if(lf.test(v)){const x=(Number(v)+y)*d;return m?x===0?"0":"".concat(x,"px"):"".concat(x)}else{const x=Ka.exec(v);return x?v.replace(Ka,String((Number(x[0])+y)*d)):v}return v}function cf(v){let d=0;for(let y=0;y<v.length;++y)v[y]==="&"&&++d;return d}const Cs=/\s*,(?![^(]*\))\s*/g,ff=/\s+/g;function uf(v,d){const y=[];return d.split(Cs).forEach(m=>{let x=cf(m);if(x){if(x===1){v.forEach(b=>{y.push(m.replace("&",b))});return}}else{v.forEach(b=>{y.push((b&&b+" ")+m)});return}let g=[m];for(;x--;){const b=[];g.forEach(f=>{v.forEach(n=>{b.push(f.replace("&",n))})}),g=b}g.forEach(b=>y.push(b))}),y}function hf(v,d){const y=[];return d.split(Cs).forEach(m=>{v.forEach(x=>{y.push((x&&x+" ")+m)})}),y}function df(v){let d=[""];return v.forEach(y=>{y=y&&y.trim(),y&&(y.includes("&")?d=uf(d,y):d=hf(d,y))}),d.join(", ").replace(ff," ")}function Qa(v){if(!v)return;const d=v.parentElement;d&&d.removeChild(v)}function ha(v){return document.querySelector('style[cssr-id="'.concat(v,'"]'))}function mf(v){const d=document.createElement("style");return d.setAttribute("cssr-id",v),d}function ti(v){return v?/^\s*@(s|m)/.test(v):!1}const pf=/[A-Z]/g;function Es(v){return v.replace(pf,d=>"-"+d.toLowerCase())}function vf(v,d="  "){return typeof v=="object"&&v!==null?" {\n"+Object.entries(v).map(y=>d+"  ".concat(Es(y[0]),": ").concat(y[1],";")).join("\n")+"\n"+d+"}":": ".concat(v,";")}function bf(v,d,y){return typeof v=="function"?v({context:d.context,props:y}):v}function Ja(v,d,y,m){if(!d)return"";const x=bf(d,y,m);if(!x)return"";if(typeof x=="string")return"".concat(v," {\n").concat(x,"\n}");const g=Object.keys(x);if(g.length===0)return y.config.keepEmptyBlock?v+" {\n}":"";const b=v?[v+" {"]:[];return g.forEach(f=>{const n=x[f];if(f==="raw"){b.push("\n"+n+"\n");return}f=Es(f),n!=null&&b.push("  ".concat(f).concat(vf(n)))}),v&&b.push("}"),b.join("\n")}function qi(v,d,y){v&&v.forEach(m=>{if(Array.isArray(m))qi(m,d,y);else if(typeof m=="function"){const x=m(d);Array.isArray(x)?qi(x,d,y):x&&y(x)}else m&&y(m)})}function ks(v,d,y,m,x,g){const b=v.$;let f="";if(!b||typeof b=="string")ti(b)?f=b:d.push(b);else if(typeof b=="function"){const a=b({context:m.context,props:x});ti(a)?f=a:d.push(a)}else if(b.before&&b.before(m.context),!b.$||typeof b.$=="string")ti(b.$)?f=b.$:d.push(b.$);else if(b.$){const a=b.$({context:m.context,props:x});ti(a)?f=a:d.push(a)}const n=df(d),o=Ja(n,v.props,m,x);f?(y.push("".concat(f," {")),g&&o&&g.insertRule("".concat(f," {\n").concat(o,"\n}\n"))):(g&&o&&g.insertRule(o),!g&&o.length&&y.push(o)),v.children&&qi(v.children,{context:m.context,props:x},a=>{if(typeof a=="string"){const t=Ja(n,{raw:a},m,x);g?g.insertRule(t):y.push(t)}else ks(a,d,y,m,x,g)}),d.pop(),f&&y.push("}"),b&&b.after&&b.after(m.context)}function Ts(v,d,y,m=!1){const x=[];return ks(v,[],x,d,y,m?v.instance.__styleSheet:void 0),m?"":x.join("\n\n")}function Ki(v){for(var d=0,y,m=0,x=v.length;x>=4;++m,x-=4)y=v.charCodeAt(m)&255|(v.charCodeAt(++m)&255)<<8|(v.charCodeAt(++m)&255)<<16|(v.charCodeAt(++m)&255)<<24,y=(y&65535)*1540483477+((y>>>16)*59797<<16),y^=y>>>24,d=(y&65535)*1540483477+((y>>>16)*59797<<16)^(d&65535)*1540483477+((d>>>16)*59797<<16);switch(x){case 3:d^=(v.charCodeAt(m+2)&255)<<16;case 2:d^=(v.charCodeAt(m+1)&255)<<8;case 1:d^=v.charCodeAt(m)&255,d=(d&65535)*1540483477+((d>>>16)*59797<<16)}return d^=d>>>13,d=(d&65535)*1540483477+((d>>>16)*59797<<16),((d^d>>>15)>>>0).toString(36)}typeof window<"u"&&(window.__cssrContext={});function gf(v,d,y){const{els:m}=d;if(y===void 0)m.forEach(Qa),d.els=[];else{const x=ha(y);x&&m.includes(x)&&(Qa(x),d.els=m.filter(g=>g!==x))}}function en(v,d){v.push(d)}function _f(v,d,y,m,x,g,b,f,n){if(g&&!n){if(y===void 0){console.error("[css-render/mount]: `id` is required in `silent` mode.");return}const i=window.__cssrContext;i[y]||(i[y]=!0,Ts(d,v,m,g));return}let o;if(y===void 0&&(o=d.render(m),y=Ki(o)),n){n.adapter(y,o!=null?o:d.render(m));return}const a=ha(y);if(a!==null&&!b)return a;const t=a!=null?a:mf(y);if(o===void 0&&(o=d.render(m)),t.textContent=o,a!==null)return a;if(f){const i=document.head.querySelector('meta[name="'.concat(f,'"]'));if(i)return document.head.insertBefore(t,i),en(d.els,t),t}return x?document.head.insertBefore(t,document.head.querySelector("style, link")):document.head.appendChild(t),en(d.els,t),t}function yf(v){return Ts(this,this.instance,v)}function wf(v={}){const{id:d,ssr:y,props:m,head:x=!1,silent:g=!1,force:b=!1,anchorMetaName:f}=v;return _f(this.instance,this,d,m,x,g,b,f,y)}function xf(v={}){const{id:d}=v;gf(this.instance,this,d)}const ri=function(v,d,y,m){return{instance:v,$:d,props:y,children:m,els:[],render:yf,mount:wf,unmount:xf}},Sf=function(v,d,y,m){return Array.isArray(d)?ri(v,{$:null},null,d):Array.isArray(y)?ri(v,d,null,y):Array.isArray(m)?ri(v,d,y,m):ri(v,d,y,null)};function Cf(v={}){let d=null;const y={c:(...m)=>Sf(y,...m),use:(m,...x)=>m.install(y,...x),find:ha,context:{},config:v,get __styleSheet(){if(!d){const m=document.createElement("style");return document.head.appendChild(m),d=document.styleSheets[document.styleSheets.length-1],d}return d}};return y}function Ef(v){let d=".",y="__",m="--",x;if(v){let e=v.blockPrefix;e&&(d=e),e=v.elementPrefix,e&&(y=e),e=v.modifierPrefix,e&&(m=e)}const g={install(e){x=e.c;const l=e.context;l.bem={},l.bem.b=null,l.bem.els=null}};function b(e){let l,s;return{before(c){l=c.bem.b,s=c.bem.els,c.bem.els=null},after(c){c.bem.b=l,c.bem.els=s},$({context:c,props:u}){return e=typeof e=="string"?e:e({context:c,props:u}),c.bem.b=e,"".concat((u==null?void 0:u.bPrefix)||d).concat(c.bem.b)}}}function f(e){let l;return{before(s){l=s.bem.els},after(s){s.bem.els=l},$({context:s,props:c}){return e=typeof e=="string"?e:e({context:s,props:c}),s.bem.els=e.split(",").map(u=>u.trim()),s.bem.els.map(u=>"".concat((c==null?void 0:c.bPrefix)||d).concat(s.bem.b).concat(y).concat(u)).join(", ")}}}function n(e){return{$({context:l,props:s}){e=typeof e=="string"?e:e({context:l,props:s});const c=e.split(",").map(p=>p.trim());function u(p){return c.map(_=>"&".concat((s==null?void 0:s.bPrefix)||d).concat(l.bem.b).concat(p!==void 0?"".concat(y).concat(p):"").concat(m).concat(_)).join(", ")}const h=l.bem.els;return h!==null?u(h[0]):u()}}}function o(e){return{$({context:l,props:s}){e=typeof e=="string"?e:e({context:l,props:s});const c=l.bem.els;return"&:not(".concat((s==null?void 0:s.bPrefix)||d).concat(l.bem.b).concat(c!==null&&c.length>0?"".concat(y).concat(c[0]):"").concat(m).concat(e,")")}}}return Object.assign(g,{cB:(...e)=>x(b(e[0]),e[1],e[2]),cE:(...e)=>x(f(e[0]),e[1],e[2]),cM:(...e)=>x(n(e[0]),e[1],e[2]),cNotM:(...e)=>x(o(e[0]),e[1],e[2])}),g}function Qi(v,d){return v+(d==="default"?"":d.replace(/^[a-z]/,y=>y.toUpperCase()))}Qi("abc","def");const kf="n",Tf=".".concat(kf,"-"),Uf="__",Af="--",Us=Cf(),As=Ef({blockPrefix:Tf,elementPrefix:Uf,modifierPrefix:Af});Us.use(As);const{c:tr,find:gy}=Us,{cB:ot,cE:_y,cM:Zt,cNotM:yy}=As,Os=Symbol("@css-render/vue3-ssr");function Of(v,d){return'<style cssr-id="'.concat(v,'">\n').concat(d,"\n</style>")}function Mf(v,d){const y=fr(Os,null);if(y===null){console.error("[css-render/vue3-ssr]: no ssr context found.");return}const{styles:m,ids:x}=y;x.has(v)||m!==null&&(x.add(v),m.push(Of(v,d)))}const Pf=typeof document<"u";function da(){if(Pf)return;const v=fr(Os,null);if(v!==null)return{adapter:Mf,context:v}}const Ms={fontFamily:'v-sans, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontFamilyMono:"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace",fontWeight:"400",fontWeightStrong:"500",cubicBezierEaseInOut:"cubic-bezier(.4, 0, .2, 1)",cubicBezierEaseOut:"cubic-bezier(0, 0, .2, 1)",cubicBezierEaseIn:"cubic-bezier(.4, 0, 1, 1)",borderRadius:"3px",borderRadiusSmall:"2px",fontSize:"14px",fontSizeMini:"12px",fontSizeTiny:"12px",fontSizeSmall:"14px",fontSizeMedium:"14px",fontSizeLarge:"15px",fontSizeHuge:"16px",lineHeight:"1.6",heightMini:"16px",heightTiny:"22px",heightSmall:"28px",heightMedium:"34px",heightLarge:"40px",heightHuge:"46px"},{fontSize:Rf,fontFamily:Df,lineHeight:Lf}=Ms,Ps=tr("body","\n margin: 0;\n font-size: ".concat(Rf,";\n font-family: ").concat(Df,";\n line-height: ").concat(Lf,";\n -webkit-text-size-adjust: 100%;\n -webkit-tap-highlight-color: transparent;\n"),[tr("input","\n font-family: inherit;\n font-size: inherit;\n ")]),Wr="n-config-provider",mi="naive-ui-style";function ma(v,d,y,m,x,g){const b=da(),f=fr(Wr,null);if(y){const o=()=>{const a=g==null?void 0:g.value;y.mount({id:a===void 0?d:a+d,head:!0,props:{bPrefix:a?".".concat(a,"-"):void 0},anchorMetaName:mi,ssr:b}),f!=null&&f.preflightStyleDisabled||Ps.mount({id:"n-global",head:!0,anchorMetaName:mi,ssr:b})};b?o():ts(o)}return rt(()=>{var o;const{theme:{common:a,self:t,peers:i={}}={},themeOverrides:r={},builtinThemeOverrides:e={}}=x,{common:l,peers:s}=r,{common:c=void 0,[v]:{common:u=void 0,self:h=void 0,peers:p={}}={}}=(f==null?void 0:f.mergedThemeRef.value)||{},{common:_=void 0,[v]:w={}}=(f==null?void 0:f.mergedThemeOverridesRef.value)||{},{common:S,peers:C={}}=w,E=Kr({},a||u||c||m.common,_,S,l),k=Kr((o=t||h||m.self)===null||o===void 0?void 0:o(E),e,w,r);return{common:E,self:k,peers:Kr({},m.peers,p,i),peerOverrides:Kr({},e.peers,C,s)}})}ma.props={theme:Object,themeOverrides:Object,builtinThemeOverrides:Object};const If="n";function Ff(v={},d={defaultBordered:!0}){const y=fr(Wr,null);return{inlineThemeDisabled:y==null?void 0:y.inlineThemeDisabled,mergedRtlRef:y==null?void 0:y.mergedRtlRef,mergedComponentPropsRef:y==null?void 0:y.mergedComponentPropsRef,mergedBreakpointsRef:y==null?void 0:y.mergedBreakpointsRef,mergedBorderedRef:rt(()=>{var m,x;const{bordered:g}=v;return g!==void 0?g:(x=(m=y==null?void 0:y.mergedBorderedRef.value)!==null&&m!==void 0?m:d.defaultBordered)!==null&&x!==void 0?x:!0}),mergedClsPrefixRef:rt(()=>(y==null?void 0:y.mergedClsPrefixRef.value)||If),namespaceRef:rt(()=>y==null?void 0:y.mergedNamespaceRef.value)}}function Bf(v,d,y){if(!d)return;const m=da(),x=fr(Wr,null),g=()=>{const b=y==null?void 0:y.value;d.mount({id:b===void 0?v:b+v,head:!0,anchorMetaName:mi,props:{bPrefix:b?".".concat(b,"-"):void 0},ssr:m}),x!=null&&x.preflightStyleDisabled||Ps.mount({id:"n-global",head:!0,anchorMetaName:mi,ssr:m})};m?g():ts(g)}function Nf(v,d,y,m){var x;y||of("useThemeClass","cssVarsRef is not passed");const g=(x=fr(Wr,null))===null||x===void 0?void 0:x.mergedThemeHashRef,b=Ze(""),f=da();let n;const o="__".concat(v),a=()=>{let t=o;const i=d?d.value:void 0,r=g==null?void 0:g.value;r&&(t+="-"+r),i&&(t+="-"+i);const{themeOverrides:e,builtinThemeOverrides:l}=m;e&&(t+="-"+Ki(JSON.stringify(e))),l&&(t+="-"+Ki(JSON.stringify(l))),b.value=t,n=()=>{const s=y.value;let c="";for(const u in s)c+="".concat(u,": ").concat(s[u],";");tr(".".concat(t),c).mount({id:t,ssr:f}),n=void 0}};return dl(()=>{a()}),{themeClass:b,onRender:()=>{n==null||n()}}}function wi(v,d){return Ft({name:rc(v),setup(){var y;const m=(y=fr(Wr,null))===null||y===void 0?void 0:y.mergedIconsRef;return()=>{var x;const g=(x=m==null?void 0:m.value)===null||x===void 0?void 0:x[v];return g?g():d}}})}const Rs=wi("error",Ge("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ge("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},Ge("g",{"fill-rule":"nonzero"},Ge("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),Ds=wi("info",Ge("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ge("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},Ge("g",{"fill-rule":"nonzero"},Ge("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),Ls=wi("success",Ge("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ge("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},Ge("g",{"fill-rule":"nonzero"},Ge("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),Is=wi("warning",Ge("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ge("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},Ge("g",{"fill-rule":"nonzero"},Ge("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),zf=ot("base-icon","\n height: 1em;\n width: 1em;\n line-height: 1em;\n text-align: center;\n display: inline-block;\n position: relative;\n fill: currentColor;\n transform: translateZ(0);\n",[tr("svg","\n height: 1em;\n width: 1em;\n ")]),Fs=Ft({name:"BaseIcon",props:{role:String,ariaLabel:String,ariaDisabled:{type:Boolean,default:void 0},ariaHidden:{type:Boolean,default:void 0},clsPrefix:{type:String,required:!0},onClick:Function,onMousedown:Function,onMouseup:Function},setup(v){Bf("-base-icon",zf,ml(v,"clsPrefix"))},render(){return Ge("i",{class:"".concat(this.clsPrefix,"-base-icon"),onClick:this.onClick,onMousedown:this.onMousedown,onMouseup:this.onMouseup,role:this.role,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,"aria-disabled":this.ariaDisabled},this.$slots)}}),We={neutralBase:"#FFF",neutralInvertBase:"#000",neutralTextBase:"#000",neutralPopover:"#fff",neutralCard:"#fff",neutralModal:"#fff",neutralBody:"#fff",alpha1:"0.82",alpha2:"0.72",alpha3:"0.38",alpha4:"0.24",alpha5:"0.18",alphaClose:"0.6",alphaDisabled:"0.5",alphaDisabledInput:"0.02",alphaPending:"0.05",alphaTablePending:"0.02",alphaPressed:"0.07",alphaAvatar:"0.2",alphaRail:"0.14",alphaProgressRail:".08",alphaBorder:"0.12",alphaDivider:"0.06",alphaInput:"0",alphaAction:"0.02",alphaTab:"0.04",alphaScrollbar:"0.25",alphaScrollbarHover:"0.4",alphaCode:"0.05",alphaTag:"0.02",primaryHover:"#36ad6a",primaryDefault:"#18a058",primaryActive:"#0c7a43",primarySuppl:"#36ad6a",infoHover:"#4098fc",infoDefault:"#2080f0",infoActive:"#1060c9",infoSuppl:"#4098fc",errorHover:"#de576d",errorDefault:"#d03050",errorActive:"#ab1f3f",errorSuppl:"#de576d",warningHover:"#fcb040",warningDefault:"#f0a020",warningActive:"#c97c10",warningSuppl:"#fcb040",successHover:"#36ad6a",successDefault:"#18a058",successActive:"#0c7a43",successSuppl:"#36ad6a"},jf=Er(We.neutralBase),Bs=Er(We.neutralInvertBase),Hf="rgba("+Bs.slice(0,3).join(", ")+", ";function tn(v){return Hf+String(v)+")"}function Ct(v){const d=Array.from(Bs);return d[3]=Number(v),nf(jf,d)}const Gf=Object.assign(Object.assign({name:"common"},Ms),{baseColor:We.neutralBase,primaryColor:We.primaryDefault,primaryColorHover:We.primaryHover,primaryColorPressed:We.primaryActive,primaryColorSuppl:We.primarySuppl,infoColor:We.infoDefault,infoColorHover:We.infoHover,infoColorPressed:We.infoActive,infoColorSuppl:We.infoSuppl,successColor:We.successDefault,successColorHover:We.successHover,successColorPressed:We.successActive,successColorSuppl:We.successSuppl,warningColor:We.warningDefault,warningColorHover:We.warningHover,warningColorPressed:We.warningActive,warningColorSuppl:We.warningSuppl,errorColor:We.errorDefault,errorColorHover:We.errorHover,errorColorPressed:We.errorActive,errorColorSuppl:We.errorSuppl,textColorBase:We.neutralTextBase,textColor1:"rgb(31, 34, 37)",textColor2:"rgb(51, 54, 57)",textColor3:"rgb(118, 124, 130)",textColorDisabled:Ct(We.alpha4),placeholderColor:Ct(We.alpha4),placeholderColorDisabled:Ct(We.alpha5),iconColor:Ct(We.alpha4),iconColorHover:ei(Ct(We.alpha4),{lightness:.75}),iconColorPressed:ei(Ct(We.alpha4),{lightness:.9}),iconColorDisabled:Ct(We.alpha5),opacity1:We.alpha1,opacity2:We.alpha2,opacity3:We.alpha3,opacity4:We.alpha4,opacity5:We.alpha5,dividerColor:"rgb(239, 239, 245)",borderColor:"rgb(224, 224, 230)",closeIconColor:Ct(Number(We.alphaClose)),closeIconColorHover:Ct(Number(We.alphaClose)),closeIconColorPressed:Ct(Number(We.alphaClose)),closeColorHover:"rgba(0, 0, 0, .09)",closeColorPressed:"rgba(0, 0, 0, .13)",clearColor:Ct(We.alpha4),clearColorHover:ei(Ct(We.alpha4),{lightness:.75}),clearColorPressed:ei(Ct(We.alpha4),{lightness:.9}),scrollbarColor:tn(We.alphaScrollbar),scrollbarColorHover:tn(We.alphaScrollbarHover),scrollbarWidth:"5px",scrollbarHeight:"5px",scrollbarBorderRadius:"5px",progressRailColor:Ct(We.alphaProgressRail),railColor:"rgb(219, 219, 223)",popoverColor:We.neutralPopover,tableColor:We.neutralCard,cardColor:We.neutralCard,modalColor:We.neutralModal,bodyColor:We.neutralBody,tagColor:"#eee",avatarColor:Ct(We.alphaAvatar),invertedColor:"rgb(0, 20, 40)",inputColor:Ct(We.alphaInput),codeColor:"rgb(244, 244, 248)",tabColor:"rgb(247, 247, 250)",actionColor:"rgb(250, 250, 252)",tableHeaderColor:"rgb(250, 250, 252)",hoverColor:"rgb(243, 243, 245)",tableColorHover:"rgba(0, 0, 100, 0.03)",tableColorStriped:"rgba(0, 0, 100, 0.02)",pressedColor:"rgb(237, 237, 239)",opacityDisabled:We.alphaDisabled,inputColorDisabled:"rgb(250, 250, 252)",buttonColor2:"rgba(46, 51, 56, .05)",buttonColor2Hover:"rgba(46, 51, 56, .09)",buttonColor2Pressed:"rgba(46, 51, 56, .13)",boxShadow1:"0 1px 2px -2px rgba(0, 0, 0, .08), 0 3px 6px 0 rgba(0, 0, 0, .06), 0 5px 12px 4px rgba(0, 0, 0, .04)",boxShadow2:"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05)",boxShadow3:"0 6px 16px -9px rgba(0, 0, 0, .08), 0 9px 28px 0 rgba(0, 0, 0, .05), 0 12px 48px 16px rgba(0, 0, 0, .03)"}),Wf=Gf,Yf=v=>{const{infoColor:d,successColor:y,warningColor:m,errorColor:x,textColor2:g,progressRailColor:b,fontSize:f,fontWeight:n}=v;return{fontSize:f,fontSizeCircle:"28px",fontWeightCircle:n,railColor:b,railHeight:"8px",iconSizeCircle:"36px",iconSizeLine:"18px",iconColor:d,iconColorInfo:d,iconColorSuccess:y,iconColorWarning:m,iconColorError:x,textColorCircle:g,textColorLineInner:"rgb(255, 255, 255)",textColorLineOuter:g,fillColor:d,fillColorInfo:d,fillColorSuccess:y,fillColorWarning:m,fillColorError:x,lineBgProcessing:"linear-gradient(90deg, rgba(255, 255, 255, .3) 0%, rgba(255, 255, 255, .5) 100%)"}},Xf={name:"Progress",common:Wf,self:Yf},$f=Xf,Vf=tr([ot("progress",{display:"inline-block"},[ot("progress-icon","\n color: var(--n-icon-color);\n transition: color .3s var(--n-bezier);\n "),Zt("line","\n width: 100%;\n display: block;\n ",[ot("progress-content","\n display: flex;\n align-items: center;\n ",[ot("progress-graph",{flex:1})]),ot("progress-custom-content",{marginLeft:"14px"}),ot("progress-icon","\n width: 30px;\n padding-left: 14px;\n height: var(--n-icon-size-line);\n line-height: var(--n-icon-size-line);\n font-size: var(--n-icon-size-line);\n ",[Zt("as-text","\n color: var(--n-text-color-line-outer);\n text-align: center;\n width: 40px;\n font-size: var(--n-font-size);\n padding-left: 4px;\n transition: color .3s var(--n-bezier);\n ")])]),Zt("circle, dashboard",{width:"120px"},[ot("progress-custom-content","\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translateX(-50%) translateY(-50%);\n display: flex;\n align-items: center;\n justify-content: center;\n "),ot("progress-text","\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translateX(-50%) translateY(-50%);\n display: flex;\n align-items: center;\n color: inherit;\n font-size: var(--n-font-size-circle);\n color: var(--n-text-color-circle);\n font-weight: var(--n-font-weight-circle);\n transition: color .3s var(--n-bezier);\n white-space: nowrap;\n "),ot("progress-icon","\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translateX(-50%) translateY(-50%);\n display: flex;\n align-items: center;\n color: var(--n-icon-color);\n font-size: var(--n-icon-size-circle);\n ")]),Zt("multiple-circle","\n width: 200px;\n color: inherit;\n ",[ot("progress-text","\n font-weight: var(--n-font-weight-circle);\n color: var(--n-text-color-circle);\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translateX(-50%) translateY(-50%);\n display: flex;\n align-items: center;\n justify-content: center;\n transition: color .3s var(--n-bezier);\n ")]),ot("progress-content",{position:"relative"}),ot("progress-graph",{position:"relative"},[ot("progress-graph-circle",[tr("svg",{verticalAlign:"bottom"}),ot("progress-graph-circle-fill","\n stroke: var(--n-fill-color);\n transition:\n opacity .3s var(--n-bezier),\n stroke .3s var(--n-bezier),\n stroke-dasharray .3s var(--n-bezier);\n ",[Zt("empty",{opacity:0})]),ot("progress-graph-circle-rail","\n transition: stroke .3s var(--n-bezier);\n overflow: hidden;\n stroke: var(--n-rail-color);\n ")]),ot("progress-graph-line",[Zt("indicator-inside",[ot("progress-graph-line-rail","\n height: 16px;\n line-height: 16px;\n border-radius: 10px;\n ",[ot("progress-graph-line-fill","\n height: inherit;\n border-radius: 10px;\n "),ot("progress-graph-line-indicator","\n background: #0000;\n white-space: nowrap;\n text-align: right;\n margin-left: 14px;\n margin-right: 14px;\n height: inherit;\n font-size: 12px;\n color: var(--n-text-color-line-inner);\n transition: color .3s var(--n-bezier);\n ")])]),Zt("indicator-inside-label","\n height: 16px;\n display: flex;\n align-items: center;\n ",[ot("progress-graph-line-rail","\n flex: 1;\n transition: background-color .3s var(--n-bezier);\n "),ot("progress-graph-line-indicator","\n background: var(--n-fill-color);\n font-size: 12px;\n transform: translateZ(0);\n display: flex;\n vertical-align: middle;\n height: 16px;\n line-height: 16px;\n padding: 0 10px;\n border-radius: 10px;\n position: absolute;\n white-space: nowrap;\n color: var(--n-text-color-line-inner);\n transition:\n right .2s var(--n-bezier),\n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n ")]),ot("progress-graph-line-rail","\n position: relative;\n overflow: hidden;\n height: var(--n-rail-height);\n border-radius: 5px;\n background-color: var(--n-rail-color);\n transition: background-color .3s var(--n-bezier);\n ",[ot("progress-graph-line-fill","\n background: var(--n-fill-color);\n position: relative;\n border-radius: 5px;\n height: inherit;\n width: 100%;\n max-width: 0%;\n transition:\n background-color .3s var(--n-bezier),\n max-width .2s var(--n-bezier);\n ",[Zt("processing",[tr("&::after",'\n content: "";\n background-image: var(--n-line-bg-processing);\n animation: progress-processing-animation 2s var(--n-bezier) infinite;\n ')])])])])])]),tr("@keyframes progress-processing-animation","\n 0% {\n position: absolute;\n left: 0;\n top: 0;\n bottom: 0;\n right: 100%;\n opacity: 1;\n }\n 66% {\n position: absolute;\n left: 0;\n top: 0;\n bottom: 0;\n right: 0;\n opacity: 0;\n }\n 100% {\n position: absolute;\n left: 0;\n top: 0;\n bottom: 0;\n right: 0;\n opacity: 0;\n }\n ")]),Zf={success:Ge(Ls,null),error:Ge(Rs,null),warning:Ge(Is,null),info:Ge(Ds,null)},qf=Ft({name:"ProgressLine",props:{clsPrefix:{type:String,required:!0},percentage:{type:Number,default:0},railColor:String,railStyle:[String,Object],fillColor:String,status:{type:String,required:!0},indicatorPlacement:{type:String,required:!0},indicatorTextColor:String,unit:{type:String,default:"%"},processing:{type:Boolean,required:!0},showIndicator:{type:Boolean,required:!0},height:[String,Number],railBorderRadius:[String,Number],fillBorderRadius:[String,Number]},setup(v,{slots:d}){const y=rt(()=>mr(v.height)),m=rt(()=>v.railBorderRadius!==void 0?mr(v.railBorderRadius):v.height!==void 0?mr(v.height,{c:.5}):""),x=rt(()=>v.fillBorderRadius!==void 0?mr(v.fillBorderRadius):v.railBorderRadius!==void 0?mr(v.railBorderRadius):v.height!==void 0?mr(v.height,{c:.5}):"");return()=>{const{indicatorPlacement:g,railColor:b,railStyle:f,percentage:n,unit:o,indicatorTextColor:a,status:t,showIndicator:i,fillColor:r,processing:e,clsPrefix:l}=v;return Ge("div",{class:"".concat(l,"-progress-content"),role:"none"},Ge("div",{class:"".concat(l,"-progress-graph"),"aria-hidden":!0},Ge("div",{class:["".concat(l,"-progress-graph-line"),{["".concat(l,"-progress-graph-line--indicator-").concat(g)]:!0}]},Ge("div",{class:"".concat(l,"-progress-graph-line-rail"),style:[{backgroundColor:b,height:y.value,borderRadius:m.value},f]},Ge("div",{class:["".concat(l,"-progress-graph-line-fill"),e&&"".concat(l,"-progress-graph-line-fill--processing")],style:{maxWidth:"".concat(v.percentage,"%"),backgroundColor:r,height:y.value,lineHeight:y.value,borderRadius:x.value}},g==="inside"?Ge("div",{class:"".concat(l,"-progress-graph-line-indicator"),style:{color:a}},n,o):null)))),i&&g==="outside"?Ge("div",null,d.default?Ge("div",{class:"".concat(l,"-progress-custom-content"),style:{color:a},role:"none"},d.default()):t==="default"?Ge("div",{role:"none",class:"".concat(l,"-progress-icon ").concat(l,"-progress-icon--as-text"),style:{color:a}},n,o):Ge("div",{class:"".concat(l,"-progress-icon"),"aria-hidden":!0},Ge(Fs,{clsPrefix:l},{default:()=>Zf[t]}))):null)}}}),Kf={success:Ge(Ls,null),error:Ge(Rs,null),warning:Ge(Is,null),info:Ge(Ds,null)},Qf=Ft({name:"ProgressCircle",props:{clsPrefix:{type:String,required:!0},status:{type:String,required:!0},strokeWidth:{type:Number,required:!0},fillColor:String,railColor:String,railStyle:[String,Object],percentage:{type:Number,default:0},offsetDegree:{type:Number,default:0},showIndicator:{type:Boolean,required:!0},indicatorTextColor:String,unit:String,viewBoxWidth:{type:Number,required:!0},gapDegree:{type:Number,required:!0},gapOffsetDegree:{type:Number,default:0}},setup(v,{slots:d}){function y(m,x,g){const{gapDegree:b,viewBoxWidth:f,strokeWidth:n}=v,o=50,a=0,t=o,i=0,r=2*o,e=50+n/2,l="M ".concat(e,",").concat(e," m ").concat(a,",").concat(t,"\n      a ").concat(o,",").concat(o," 0 1 1 ").concat(i,",").concat(-r,"\n      a ").concat(o,",").concat(o," 0 1 1 ").concat(-i,",").concat(r),s=Math.PI*2*o,c={stroke:g,strokeDasharray:"".concat(m/100*(s-b),"px ").concat(f*8,"px"),strokeDashoffset:"-".concat(b/2,"px"),transformOrigin:x?"center":void 0,transform:x?"rotate(".concat(x,"deg)"):void 0};return{pathString:l,pathStyle:c}}return()=>{const{fillColor:m,railColor:x,strokeWidth:g,offsetDegree:b,status:f,percentage:n,showIndicator:o,indicatorTextColor:a,unit:t,gapOffsetDegree:i,clsPrefix:r}=v,{pathString:e,pathStyle:l}=y(100,0,x),{pathString:s,pathStyle:c}=y(n,b,m),u=100+g;return Ge("div",{class:"".concat(r,"-progress-content"),role:"none"},Ge("div",{class:"".concat(r,"-progress-graph"),"aria-hidden":!0},Ge("div",{class:"".concat(r,"-progress-graph-circle"),style:{transform:i?"rotate(".concat(i,"deg)"):void 0}},Ge("svg",{viewBox:"0 0 ".concat(u," ").concat(u)},Ge("g",null,Ge("path",{class:"".concat(r,"-progress-graph-circle-rail"),d:e,"stroke-width":g,"stroke-linecap":"round",fill:"none",style:l})),Ge("g",null,Ge("path",{class:["".concat(r,"-progress-graph-circle-fill"),n===0&&"".concat(r,"-progress-graph-circle-fill--empty")],d:s,"stroke-width":g,"stroke-linecap":"round",fill:"none",style:c}))))),o?Ge("div",null,d.default?Ge("div",{class:"".concat(r,"-progress-custom-content"),role:"none"},d.default()):f!=="default"?Ge("div",{class:"".concat(r,"-progress-icon"),"aria-hidden":!0},Ge(Fs,{clsPrefix:r},{default:()=>Kf[f]})):Ge("div",{class:"".concat(r,"-progress-text"),style:{color:a},role:"none"},Ge("span",{class:"".concat(r,"-progress-text__percentage")},n),Ge("span",{class:"".concat(r,"-progress-text__unit")},t))):null)}}});function rn(v,d,y=100){return"m ".concat(y/2," ").concat(y/2-v," a ").concat(v," ").concat(v," 0 1 1 0 ").concat(2*v," a ").concat(v," ").concat(v," 0 1 1 0 -").concat(2*v)}const Jf=Ft({name:"ProgressMultipleCircle",props:{clsPrefix:{type:String,required:!0},viewBoxWidth:{type:Number,required:!0},percentage:{type:Array,default:[0]},strokeWidth:{type:Number,required:!0},circleGap:{type:Number,required:!0},showIndicator:{type:Boolean,required:!0},fillColor:{type:Array,default:()=>[]},railColor:{type:Array,default:()=>[]},railStyle:{type:Array,default:()=>[]}},setup(v,{slots:d}){const y=rt(()=>v.percentage.map((x,g)=>"".concat(Math.PI*x/100*(v.viewBoxWidth/2-v.strokeWidth/2*(1+2*g)-v.circleGap*g)*2,", ").concat(v.viewBoxWidth*8)));return()=>{const{viewBoxWidth:m,strokeWidth:x,circleGap:g,showIndicator:b,fillColor:f,railColor:n,railStyle:o,percentage:a,clsPrefix:t}=v;return Ge("div",{class:"".concat(t,"-progress-content"),role:"none"},Ge("div",{class:"".concat(t,"-progress-graph"),"aria-hidden":!0},Ge("div",{class:"".concat(t,"-progress-graph-circle")},Ge("svg",{viewBox:"0 0 ".concat(m," ").concat(m)},a.map((i,r)=>Ge("g",{key:r},Ge("path",{class:"".concat(t,"-progress-graph-circle-rail"),d:rn(m/2-x/2*(1+2*r)-g*r,x,m),"stroke-width":x,"stroke-linecap":"round",fill:"none",style:[{strokeDashoffset:0,stroke:n[r]},o[r]]}),Ge("path",{class:["".concat(t,"-progress-graph-circle-fill"),i===0&&"".concat(t,"-progress-graph-circle-fill--empty")],d:rn(m/2-x/2*(1+2*r)-g*r,x,m),"stroke-width":x,"stroke-linecap":"round",fill:"none",style:{strokeDasharray:y.value[r],strokeDashoffset:0,stroke:f[r]}})))))),b&&d.default?Ge("div",null,Ge("div",{class:"".concat(t,"-progress-text")},d.default())):null)}}}),eu=Object.assign(Object.assign({},ma.props),{processing:Boolean,type:{type:String,default:"line"},gapDegree:Number,gapOffsetDegree:Number,status:{type:String,default:"default"},railColor:[String,Array],railStyle:[String,Array],color:[String,Array],viewBoxWidth:{type:Number,default:100},strokeWidth:{type:Number,default:7},percentage:[Number,Array],unit:{type:String,default:"%"},showIndicator:{type:Boolean,default:!0},indicatorPosition:{type:String,default:"outside"},indicatorPlacement:{type:String,default:"outside"},indicatorTextColor:String,circleGap:{type:Number,default:1},height:Number,borderRadius:[String,Number],fillBorderRadius:[String,Number],offsetDegree:Number}),tu=Ft({name:"Progress",props:eu,setup(v){const d=rt(()=>v.indicatorPlacement||v.indicatorPosition),y=rt(()=>{if(v.gapDegree||v.gapDegree===0)return v.gapDegree;if(v.type==="dashboard")return 75}),{mergedClsPrefixRef:m,inlineThemeDisabled:x}=Ff(v),g=ma("Progress","-progress",Vf,$f,v,m),b=rt(()=>{const{status:n}=v,{common:{cubicBezierEaseInOut:o},self:{fontSize:a,fontSizeCircle:t,railColor:i,railHeight:r,iconSizeCircle:e,iconSizeLine:l,textColorCircle:s,textColorLineInner:c,textColorLineOuter:u,lineBgProcessing:h,fontWeightCircle:p,[Qi("iconColor",n)]:_,[Qi("fillColor",n)]:w}}=g.value;return{"--n-bezier":o,"--n-fill-color":w,"--n-font-size":a,"--n-font-size-circle":t,"--n-font-weight-circle":p,"--n-icon-color":_,"--n-icon-size-circle":e,"--n-icon-size-line":l,"--n-line-bg-processing":h,"--n-rail-color":i,"--n-rail-height":r,"--n-text-color-circle":s,"--n-text-color-line-inner":c,"--n-text-color-line-outer":u}}),f=x?Nf("progress",rt(()=>v.status[0]),b,v):void 0;return{mergedClsPrefix:m,mergedIndicatorPlacement:d,gapDeg:y,cssVars:x?void 0:b,themeClass:f==null?void 0:f.themeClass,onRender:f==null?void 0:f.onRender}},render(){const{type:v,cssVars:d,indicatorTextColor:y,showIndicator:m,status:x,railColor:g,railStyle:b,color:f,percentage:n,viewBoxWidth:o,strokeWidth:a,mergedIndicatorPlacement:t,unit:i,borderRadius:r,fillBorderRadius:e,height:l,processing:s,circleGap:c,mergedClsPrefix:u,gapDeg:h,gapOffsetDegree:p,themeClass:_,$slots:w,onRender:S}=this;return S==null||S(),Ge("div",{class:[_,"".concat(u,"-progress"),"".concat(u,"-progress--").concat(v),"".concat(u,"-progress--").concat(x)],style:d,"aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":n,role:v==="circle"||v==="line"||v==="dashboard"?"progressbar":"none"},v==="circle"||v==="dashboard"?Ge(Qf,{clsPrefix:u,status:x,showIndicator:m,indicatorTextColor:y,railColor:g,fillColor:f,railStyle:b,offsetDegree:this.offsetDegree,percentage:n,viewBoxWidth:o,strokeWidth:a,gapDegree:h===void 0?v==="dashboard"?75:0:h,gapOffsetDegree:p,unit:i},w):v==="line"?Ge(qf,{clsPrefix:u,status:x,showIndicator:m,indicatorTextColor:y,railColor:g,fillColor:f,railStyle:b,percentage:n,processing:s,indicatorPlacement:t,unit:i,fillBorderRadius:e,railBorderRadius:r,height:l},w):v==="multiple-circle"?Ge(Jf,{clsPrefix:u,strokeWidth:a,railColor:g,fillColor:f,railStyle:b,viewBoxWidth:o,percentage:n,showIndicator:m,circleGap:c},w):null)}}),ru={class:"process-box"},iu=Ft({__name:"ProcessProgress",props:{duration:null},setup(v,{expose:d}){const y=v,m=cs(),x=ua(),g=Ze(0);let b=null;const f=rt(()=>100/y.duration),n=()=>{b=setInterval(()=>{g.value=parseFloat((g.value+f.value).toFixed(2)),b&&g.value>=99&&(g.value=99,b&&clearInterval(b))},1e3)},o=async i=>{const r=await x.device.controlProcess(i);if(r.status===200){const{code:e}=r.data;return e===0?Promise.resolve(r.data):Promise.reject()}},a=(i,r)=>{o(i).then(()=>{n(),r&&r()})},t=(i,r)=>{o(i).then(()=>{b&&clearInterval(b),r&&r()})};return rs(()=>m.socketData.control.action,i=>{i===sr.FINISH?g.value=100:i===sr.START?n():i===sr.STOP&&b&&clearInterval(b)}),d({go:a,pause:t}),is(()=>{m.socketData.control.action===sr.FINISH&&(g.value=100)}),la(()=>{b&&clearInterval(b)}),n(),(i,r)=>(ht(),St("div",ru,[Xe(De(tu),{type:"line",percentage:g.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])]))}});const an=Hr(iu,[["__scopeId","data-v-86a943ce"]]),au={class:"page-title"},nu={ref:"gcodeViewContainer",class:"gcodeViewContainer"},su={id:"gcodeView",ref:"gcodeViewBox",class:"gcodeViewBox"},ou={class:"bottom-infos"},lu={key:0,style:{"text-align":"center"}},cu={class:"times"},fu={key:1,class:"standby-status-content"},uu=He("img",{src:kl,class:"equ-img",alt:"",draggable:"false"},null,-1),hu={class:"words"},du={class:"working-status",style:{width:"80%"}},mu={class:"working-status"},pu={key:2,class:"finished-box"},vu=He("img",{src:Zc,alt:"",class:"finished-image",draggable:"false"},null,-1),bu={class:"bottom-remarks"},gu={class:"title"},_u={class:"content"},yu=Ft({__name:"ProcessPop",props:{duration:null,showModal:{type:Boolean},processStatus:null,tip:null},emits:["finish","handleSend","close","update:showModal"],setup(v,{emit:d}){const y=v,m=rt({get(){return y.showModal},set(f){d("update:showModal",f)}}),x=()=>{d("finish")},g=()=>{d("handleSend")},b=()=>{m.value=!1,yr(()=>{d("close")})};return(f,n)=>{const o=It("van-button"),a=It("van-popup");return ht(),St("div",null,[Xe(a,{show:De(m),"onUpdate:show":n[0]||(n[0]=t=>Vt(m)?m.value=t:null),position:"top",class:"start-process-pop",closeable:"",onClose:b},{default:Rt(()=>[He("span",au,et(f.$t("editor.preparePro")),1),Ri(He("div",nu,[He("canvas",su,null,512)],512),[[Di,v.processStatus!=="standby"]]),He("div",ou,[v.processStatus==="beforeSend"?(ht(),St("div",lu,[He("div",cu,[He("span",null,et(v.tip),1)]),Xe(o,{color:"var(--backgroundColorMain)",round:"",class:"send-btn",onClick:g},{default:Rt(()=>[_r(et(f.$t("editor.send")),1)]),_:1})])):er("",!0),v.processStatus==="standby"?(ht(),St("div",fu,[uu,He("span",hu,et(f.$t("editor.pressStart")),1)])):er("",!0),Ri(He("div",du,[He("span",null,et(f.$t("editor.processAccuracy")),1),Xe(an,{ref:"progress",duration:v.duration,onFinish:x},null,8,["duration"])],512),[[Di,v.processStatus==="working"]]),Ri(He("div",mu,[He("span",null,et(f.$t("editor.suspend")),1),Xe(an,{ref:"progress",duration:v.duration},null,8,["duration"])],512),[[Di,v.processStatus==="suspend"]]),v.processStatus==="finished"?(ht(),St("div",pu,[vu,Xe(o,{color:"var(--backgroundColorMain)",round:"",class:"complate-btn",onClick:b},{default:Rt(()=>[_r(et(f.$t("editor.proFinished")),1)]),_:1})])):er("",!0),He("div",bu,[He("span",gu,et(f.$t("editor.remark")),1),He("span",_u,et(f.$t("editor.remarkContent")),1)])])]),_:1},8,["show"])])}}});const pa=v=>(as("data-v-50a2862e"),v=v(),ns(),v),wu={class:"shape-pop-content"},xu=pa(()=>He("div",{class:"triangle"},null,-1)),Su=[xu],Cu=pa(()=>He("div",{class:"round"},null,-1)),Eu=[Cu],ku=pa(()=>He("div",{class:"square"},null,-1)),Tu=[ku],Uu=Ft({__name:"ShapeChoosePop",props:{isShowShapePop:{type:Boolean}},emits:["handleToolClick","update:isShowShapePop"],setup(v,{emit:d}){const y=v,m=rt({get(){return y.isShowShapePop},set(g){d("update:isShowShapePop",g)}}),x=g=>{d("handleToolClick",g)};return(g,b)=>{const f=It("van-col"),n=It("van-row");return ht(),St("div",null,[Xe(Tl,{show:De(m),"onUpdate:show":b[3]||(b[3]=o=>Vt(m)?m.value=o:null),title:g.$t("editor.shape")},{default:Rt(()=>[He("div",wu,[Xe(n,{gutter:12},{default:Rt(()=>[Xe(f,{span:8},{default:Rt(()=>[He("div",{class:"shape-box",onClick:b[0]||(b[0]=o=>x(De(at).TRIANGLE))},Su)]),_:1}),Xe(f,{span:8},{default:Rt(()=>[He("div",{class:"shape-box",onClick:b[1]||(b[1]=o=>x(De(at).CIRCLE))},Eu)]),_:1}),Xe(f,{span:8},{default:Rt(()=>[He("div",{class:"shape-box",onClick:b[2]||(b[2]=o=>x(De(at).RECT))},Tu)]),_:1})]),_:1})])]),_:1},8,["show","title"])])}}});const Au=Hr(Uu,[["__scopeId","data-v-50a2862e"]]);var Ns={},va={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d={verbose:!1};v.default=d})(va);var ba={},zs={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m){var x,g={};return m.forEach(function(b){var f=b[0],n=b[1];switch(n){case"$MEASUREMENT":{x="measurement";break}case"$INSUNITS":{x="insUnits";break}case"$EXTMIN":g.extMin={},x="extMin";break;case"$EXTMAX":g.extMax={},x="extMax";break;case"$DIMASZ":g.dimArrowSize={},x="dimArrowSize";break;default:switch(x){case"extMin":case"extMax":{switch(f){case 10:g[x].x=n;break;case 20:g[x].y=n;break;case 30:g[x].z=n,x=void 0;break}break}case"measurement":case"insUnits":{switch(f){case 70:{g[x]=n,x=void 0;break}}break}case"dimArrowSize":{switch(f){case 40:{g[x]=n,x=void 0;break}}break}}}}),g};v.default=d})(zs);var js={},Gt={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(va);function y(f){return f&&f.__esModule?f:{default:f}}function m(){d.default.verbose&&console.info.apply(void 0,arguments)}function x(){d.default.verbose&&console.warn.apply(void 0,arguments)}function g(){console.error.apply(void 0,arguments)}var b={info:m,warn:x,error:g};v.default=b})(Gt);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(Gt);function y(o){return o&&o.__esModule?o:{default:o}}var m=function(a){var t=null,i=null;return a.reduce(function(r,e){var l=e[0],s=e[1];switch(l){case 2:r.name=s;break;case 3:r.description=s;break;case 70:r.flag=s;break;case 72:r.alignment=s;break;case 73:r.elementCount=parseInt(s);break;case 40:r.patternLength=s;break;case 49:t=Object.create({scales:[],offset:[]}),t.length=s,r.pattern.push(t);break;case 74:t.shape=s;break;case 75:t.shapeNumber=s;break;case 340:t.styleHandle=s;break;case 46:t.scales.push(s);break;case 50:t.rotation=s;break;case 44:i=Object.create({x:s,y:0}),t.offset.push(i);break;case 45:i.y=s;break;case 9:t.text=s;break}return r},{type:"LTYPE",pattern:[]})},x=function(a){return a.reduce(function(t,i){var r=i[0],e=i[1];switch(r){case 2:t.name=e;break;case 6:t.lineTypeName=e;break;case 62:t.colorNumber=e;break;case 70:t.flags=e;break;case 290:t.plot=parseInt(e)!==0;break;case 370:t.lineWeightEnum=e;break}return t},{type:"LAYER"})},g=function(a){return a.reduce(function(t,i){var r=i[0],e=i[1];switch(r){case 2:t.name=e;break;case 6:t.lineTypeName=e;break;case 40:t.fixedTextHeight=e;break;case 41:t.widthFactor=e;break;case 50:t.obliqueAngle=e;break;case 71:t.flags=e;break;case 42:t.lastHeightUsed=e;break;case 3:t.primaryFontFileName=e;break;case 4:t.bigFontFileName=e;break}return t},{type:"STYLE"})},b=function(a){return a.reduce(function(t,i){var r=i[0],e=i[1];switch(r){case 2:t.name=e;break;case 5:t.handle=e;break;case 70:t.flags=e;break;case 10:t.lowerLeft.x=parseFloat(e);break;case 20:t.lowerLeft.y=parseFloat(e);break;case 11:t.upperRight.x=parseFloat(e);break;case 21:t.upperRight.y=parseFloat(e);break;case 12:t.center.x=parseFloat(e);break;case 22:t.center.y=parseFloat(e);break;case 14:t.snapSpacing.x=parseFloat(e);break;case 24:t.snapSpacing.y=parseFloat(e);break;case 15:t.gridSpacing.x=parseFloat(e);break;case 25:t.gridSpacing.y=parseFloat(e);break;case 16:t.direction.x=parseFloat(e);break;case 26:t.direction.y=parseFloat(e);break;case 36:t.direction.z=parseFloat(e);break;case 17:t.target.x=parseFloat(e);break;case 27:t.target.y=parseFloat(e);break;case 37:t.target.z=parseFloat(e);break;case 45:t.height=parseFloat(e);break;case 50:t.snapAngle=parseFloat(e);break;case 51:t.angle=parseFloat(e);break;case 110:t.x=parseFloat(e);break;case 120:t.y=parseFloat(e);break;case 130:t.z=parseFloat(e);break;case 111:t.xAxisX=parseFloat(e);break;case 121:t.xAxisY=parseFloat(e);break;case 131:t.xAxisZ=parseFloat(e);break;case 112:t.xAxisX=parseFloat(e);break;case 122:t.xAxisY=parseFloat(e);break;case 132:t.xAxisZ=parseFloat(e);break;case 146:t.elevation=parseFloat(e);break}return t},{type:"VPORT",center:{},lowerLeft:{},upperRight:{},snap:{},snapSpacing:{},gridSpacing:{},direction:{},target:{}})},f=function(a,t,i){var r=[],e;return a.forEach(function(l){var s=l[0],c=l[1];(s===0||s===2)&&c===t?(e=[],r.push(e)):e.push(l)}),r.reduce(function(l,s){var c=i(s);return c.name?l[c.name]=c:d.default.warn("table row without name:",c),l},{})},n=function(a){var t=[],i;a.forEach(function(c){var u=c[1];u==="TABLE"?(i=[],t.push(i)):u==="ENDTAB"?t.push(i):i.push(c)});var r=[],e=[],l=[],s=[];return t.forEach(function(c){c[0][1]==="STYLE"?r=c:c[0][1]==="LTYPE"?s=c:c[0][1]==="LAYER"?e=c:c[0][1]==="VPORT"&&(l=c)}),{layers:f(e,"LAYER",x),styles:f(r,"STYLE",g),vports:f(l,"VPORT",b),ltypes:f(s,"LTYPE",m)}};v.default=n})(js);var Hs={},ga={},Gs={},yt={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m,x){switch(m){case 5:return{handle:x};case 6:return{lineTypeName:x};case 8:return{layer:x};case 48:return{lineTypeScale:x};case 60:return{visible:x===0};case 62:return{colorNumber:x};case 67:return x===0?{}:{paperSpace:x};case 68:return{viewportOn:x};case 69:return{viewport:x};case 210:return{extrusionX:x};case 220:return{extrusionY:x};case 230:return{extrusionZ:x};case 410:return{layout:x};default:return{}}};v.default=d})(yt);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="POINT";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 10:n.x=t;break;case 20:n.y=t;break;case 30:n.z=t;break;case 39:n.thickness=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m})};v.process=x;var g={TYPE:m,process:x};v.default=g})(Gs);var Ws={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="LINE";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 10:n.start.x=t;break;case 20:n.start.y=t;break;case 30:n.start.z=t;break;case 39:n.thickness=t;break;case 11:n.end.x=t;break;case 21:n.end.y=t;break;case 31:n.end.z=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m,start:{},end:{}})};v.process=x;var g={TYPE:m,process:x};v.default=g})(Ws);var Ys={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="LWPOLYLINE";v.TYPE=m;var x=function(f){var n;return f.reduce(function(o,a){var t=a[0],i=a[1];switch(t){case 70:o.closed=(i&1)===1;break;case 10:n={x:i,y:0},o.vertices.push(n);break;case 20:n.y=i;break;case 39:o.thickness=i;break;case 42:n.bulge=i;break;default:Object.assign(o,(0,d.default)(t,i));break}return o},{type:m,vertices:[]})};v.process=x;var g={TYPE:m,process:x};v.default=g})(Ys);var Xs={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="POLYLINE";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 70:n.closed=(t&1)===1,n.polygonMesh=(t&16)===16,n.polyfaceMesh=(t&64)===64;break;case 39:n.thickness=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m,vertices:[]})};v.process=x;var g={TYPE:m,process:x};v.default=g})(Xs);var $s={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d="VERTEX";v.TYPE=d;var y=function(g){return g.reduce(function(b,f){var n=f[0],o=f[1];switch(n){case 10:b.x=o;break;case 20:b.y=o;break;case 30:b.z=o;break;case 42:b.bulge=o;break}return b},{})};v.process=y;var m={TYPE:d,process:y};v.default=m})($s);var Vs={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="CIRCLE";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 10:n.x=t;break;case 20:n.y=t;break;case 30:n.z=t;break;case 40:n.r=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m})};v.process=x;var g={TYPE:m,process:x};v.default=g})(Vs);var Zs={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="ARC";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 10:n.x=t;break;case 20:n.y=t;break;case 30:n.z=t;break;case 39:n.thickness=t;break;case 40:n.r=t;break;case 50:n.startAngle=t/180*Math.PI;break;case 51:n.endAngle=t/180*Math.PI;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m})};v.process=x;var g={TYPE:m,process:x};v.default=g})(Zs);var qs={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="ELLIPSE";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 10:n.x=t;break;case 11:n.majorX=t;break;case 20:n.y=t;break;case 21:n.majorY=t;break;case 30:n.z=t;break;case 31:n.majorZ=t;break;case 40:n.axisRatio=t;break;case 41:n.startAngle=t;break;case 42:n.endAngle=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m})};v.process=x;var g={TYPE:m,process:x};v.default=g})(qs);var Ks={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="SPLINE";v.TYPE=m;var x=function(f){var n;return f.reduce(function(o,a){var t=a[0],i=a[1];switch(t){case 10:n={x:i,y:0},o.controlPoints.push(n);break;case 20:n.y=i;break;case 30:n.z=i;break;case 40:o.knots.push(i);break;case 41:o.weights||(o.weights=[]),o.weights.push(i);break;case 42:o.knotTolerance=i;break;case 43:o.controlPointTolerance=i;break;case 44:o.fitTolerance=i;break;case 70:o.flag=i,o.closed=(i&1)===1;break;case 71:o.degree=i;break;case 72:o.numberOfKnots=i;break;case 73:o.numberOfControlPoints=i;break;case 74:o.numberOfFitPoints=i;break;default:Object.assign(o,(0,d.default)(t,i));break}return o},{type:m,controlPoints:[],knots:[]})};v.process=x;var g={TYPE:m,process:x};v.default=g})(Ks);var Qs={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="SOLID";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 10:n.corners[0].x=t;break;case 20:n.corners[0].y=t;break;case 30:n.corners[0].z=t;break;case 11:n.corners[1].x=t;break;case 21:n.corners[1].y=t;break;case 31:n.corners[1].z=t;break;case 12:n.corners[2].x=t;break;case 22:n.corners[2].y=t;break;case 32:n.corners[2].z=t;break;case 13:n.corners[3].x=t;break;case 23:n.corners[3].y=t;break;case 33:n.corners[3].z=t;break;case 39:n.thickness=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m,corners:[{},{},{},{}]})};v.process=x;var g={TYPE:m,process:x};v.default=g})(Qs);var Js={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(l){return l&&l.__esModule?l:{default:l}}var m="HATCH";v.TYPE=m;var x="IDLE",g={},b=0,f=!1,n=null,o={references:[],entities:[]},a=null,t=function(s){return s.reduce(function(c,u){var h=u[0],p=u[1];switch(h){case 100:x="IDLE";break;case 2:c.patternName=p;break;case 10:x==="IDLE"?c.elevation.x=parseFloat(p):x==="POLYLINE"?(a=Object.create({x:parseFloat(p),y:0,bulge:0}),o.entities[0].points.push(a)):x==="SEED"?(n||(n={x:0,y:0},c.seeds.seeds.push(n)),n.x=parseFloat(p)):e(h,b,parseFloat(p));break;case 20:x==="IDLE"?c.elevation.y=parseFloat(p):x==="POLYLINE"?a.y=parseFloat(p):x==="SEED"?(n.y=parseFloat(p),n=null):e(h,b,parseFloat(p));break;case 30:c.elevation.z=parseFloat(p);break;case 63:c.fillColor=p;break;case 70:c.fillType=parseFloat(p)===1?"SOLID":"PATTERN";break;case 210:c.extrusionDir.x=parseFloat(p);break;case 220:c.extrusionDir.y=parseFloat(p);break;case 230:c.extrusionDir.z=parseFloat(p);break;case 91:c.boundary.count=parseFloat(p);break;case 92:if(o={references:[],entities:[]},c.boundary.loops.push(o),o.type=parseFloat(p),f=(o.type&2)===2,f){var _={type:"POLYLINE",points:[]};o.entities.push(_),x="POLYLINE"}break;case 93:x==="IDLE"&&(x="ENT"),o.count=parseFloat(p);break;case 11:case 21:case 40:case 50:case 51:case 74:case 94:case 95:case 96:e(h,b,parseFloat(p));break;case 42:f?a.bulge=parseFloat(p):e(h,b,parseFloat(p));break;case 72:b=parseFloat(p),o[f?"hasBulge":"edgeType"]=b,f||(g=r(b),o.entities.push(g));break;case 73:x==="IDLE"||f?o.entities[0].closed=p:e(h,b,parseFloat(p));break;case 75:x="IDLE",c.style=parseFloat(p);break;case 76:c.hatchType=parseFloat(p);break;case 97:x="IDLE",f=!1,o.sourceObjects=parseFloat(p);break;case 98:x="SEED",c.seeds.count=parseFloat(p);break;case 52:c.shadowPatternAngle=parseFloat(p);break;case 41:c.spacing=parseFloat(p);break;case 77:c.double=parseFloat(p)===1;break;case 78:c.pattern.lineCount=parseFloat(p);break;case 53:c.pattern.angle=parseFloat(p);break;case 43:c.pattern.x=parseFloat(p);break;case 44:c.pattern.y=parseFloat(p);break;case 45:c.pattern.offsetX=parseFloat(p);break;case 46:c.pattern.offsetY=parseFloat(p);break;case 79:c.pattern.dashCount=parseFloat(p);break;case 49:c.pattern.length.push(p);break;case 330:o.references.push(p);break;case 450:c.solidOrGradient=parseFloat(p)===0?"SOLID":"GRADIENT";break;case 453:c.color.count=parseFloat(p);break;case 460:c.color.rotation=p;break;case 461:c.color.gradient=p;break;case 462:c.color.tint=p;break;default:Object.assign(c,(0,d.default)(h,p));break}return c},{type:m,elevation:{},extrusionDir:{x:0,y:0,z:1},pattern:{length:[]},boundary:{loops:[]},seeds:{count:0,seeds:[]},color:{}})};v.process=t;var i={TYPE:m,process:t};v.default=i;function r(l){if(f)return{};switch(l){case 1:return{type:"LINE",start:{x:0,y:0},end:{x:0,y:0}};case 2:return{type:"ARC",center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,counterClockWise:!1};case 3:return{type:"ELLIPSE",center:{x:0,y:0},startAngle:0,endAngle:0,counterClockWise:!1,major:{x:0,y:0},minor:0};case 4:return{type:"SPLINE",degree:0,rational:0,periodic:0,knots:{count:0,knots:[]},controlPoints:{count:0,point:{x:0,y:0}},weights:1}}return{}}function e(l,s,c){switch(l){case 10:switch(s){case 1:g.start.x=c;break;case 2:g.center.x=c;break;case 3:g.center.x=c;break;case 4:g.controlPoints.point.x=c;break}break;case 20:{switch(s){case 1:g.start.y=c;break;case 2:g.center.y=c;break;case 3:g.center.y=c;break;case 4:g.controlPoints.point.y=c;break}break}case 11:switch(s){case 1:g.end.x=c;break;case 3:g.major.x=c;break}break;case 21:{switch(s){case 1:g.end.y=c;break;case 3:g.major.y=c;break}break}case 40:switch(s){case 2:g.radius=c;break;case 3:g.minor=c;break;case 4:g.knots.knots.push(c);break}break;case 42:switch(s){case 4:g.weights=c;break}break;case 50:switch(s){case 2:g.startAngle=c;break;case 3:g.startAngle=c;break}break;case 51:switch(s){case 2:g.endAngle=c;break;case 3:g.endAngle=c;break}break;case 73:switch(s){case 2:g.counterClockWise=parseFloat(c)===1;break;case 3:g.counterClockWise=parseFloat(c)===1;break;case 4:g.rational=c;break}break;case 74:switch(s){case 4:g.periodic=c;break}break;case 94:switch(s){case 4:g.degree=c;break}break;case 95:switch(s){case 4:g.knots.count=c;break}break;case 96:switch(s){case 4:g.controlPoints.count=c;break}break}}})(Js);var _a={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.assign=v.TYPE=void 0;var d=y(yt);function y(n){return n&&n.__esModule?n:{default:n}}var m="MTEXT";v.TYPE=m;var x={10:"x",20:"y",30:"z",40:"nominalTextHeight",41:"refRectangleWidth",71:"attachmentPoint",72:"drawingDirection",7:"styleName",11:"xAxisX",21:"xAxisY",31:"xAxisZ",42:"horizontalWidth",43:"verticalHeight",73:"lineSpacingStyle",44:"lineSpacingFactor",90:"backgroundFill",420:"bgColorRGB0",421:"bgColorRGB1",422:"bgColorRGB2",423:"bgColorRGB3",424:"bgColorRGB4",425:"bgColorRGB5",426:"bgColorRGB6",427:"bgColorRGB7",428:"bgColorRGB8",429:"bgColorRGB9",430:"bgColorName0",431:"bgColorName1",432:"bgColorName2",433:"bgColorName3",434:"bgColorName4",435:"bgColorName5",436:"bgColorName6",437:"bgColorName7",438:"bgColorName8",439:"bgColorName9",45:"fillBoxStyle",63:"bgFillColor",441:"bgFillTransparency",75:"columnType",76:"columnCount",78:"columnFlowReversed",79:"columnAutoheight",48:"columnWidth",49:"columnGutter",50:"columnHeights"},g=function(o){return o.reduce(function(a,t){var i=t[0],r=t[1];return b(a,i,r),a},{type:m,string:""})};v.process=g;var b=function(o,a,t){return x[a]!==void 0?o[x[a]]=t:a===1||a===3?o.string+=t:a===50?(o.xAxisX=Math.cos(t),o.xAxisY=Math.sin(t)):Object.assign(o,(0,d.default)(a,t)),o};v.assign=b;var f={TYPE:m,process:g,assign:b};v.default=f})(_a);var ya={},wa={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.assign=v.TYPE=void 0;var d=y(yt);function y(n){return n&&n.__esModule?n:{default:n}}var m="TEXT";v.TYPE=m;var x={1:"string",10:"x",20:"y",30:"z",11:"x2",21:"y2",31:"z2",39:"thickness",40:"textHeight",41:"relScaleX",50:"rotation",51:"obliqueAngle",7:"styleName",71:"mirror",72:"hAlign",73:"vAlign"},g=function(o){return o.reduce(function(a,t){var i=t[0],r=t[1];return b(a,i,r),a},{type:m,string:""})};v.process=g;var b=function(o,a,t){x[a]!==void 0?o[x[a]]=t:Object.assign(o,(0,d.default)(a,t))};v.assign=b;var f={TYPE:m,process:g,assign:b};v.default=f})(wa);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.assign=v.TYPE=void 0;var d=x(yt),y=_a,m=wa;function x(o){return o&&o.__esModule?o:{default:o}}var g="ATTDEF";v.TYPE=g;var b=function(a){return a.reduce(function(t,i){var r=i[0],e=i[1];return f(t,r,e),t},{type:g,subclassMarker:"AcDbText",thickness:0,scaleX:1,mtext:{},text:{}})};v.process=b;var f=function(a,t,i){switch(t){case 100:{a.subclassMarker=i;break}case 1:switch(a.subclassMarker){case"AcDbText":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 2:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":a.tag=i;break;case"AcDbXrecord":a.attdefFlag=i;break}break;case 3:switch(a.subclassMarker){case"AcDbAttributeDefinition":a.prompt=i;break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 7:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 10:switch(a.subclassMarker){case"AcDbText":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break;case"AcDbXrecord":a.x=i;break}break;case 20:switch(a.subclassMarker){case"AcDbText":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break;case"AcDbXrecord":a.y=i;break}break;case 30:switch(a.subclassMarker){case"AcDbText":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break;case"AcDbXrecord":a.z=i;break}break;case 11:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":a.x2=i;break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 21:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":a.y2=i;break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 31:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":a.z2=i;break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 39:(0,m.assign)(a.text,t,i);break;case 40:switch(a.subclassMarker){case"AcDbText":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break;case"AcDbXrecord":a.annotationScale=i;break}break;case 41:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 42:case 43:case 44:case 45:(0,y.assign)(a.mtext,t,i);break;case 46:a.mtext.annotationHeight=i;break;case 48:case 49:(0,y.assign)(a.mtext,t,i);break;case 50:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 51:(0,m.assign)(a.text,t,i);break;case 63:(0,y.assign)(a.mtext,t,i);break;case 70:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":a.attributeFlags=i;break;case"AcDbXrecord":typeof a.mTextFlag>"u"?a.mTextFlag=i:typeof a.isReallyLocked>"u"?a.isReallyLocked=i:a.secondaryAttdefCount=i;break}break;case 71:case 72:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,m.assign)(a.text,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 73:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":a.fieldLength=i;break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 74:(0,m.assign)(a.text,73,i);break;case 75:case 76:case 78:case 79:(0,y.assign)(a.mtext,t,i);break;case 90:(0,y.assign)(a.mtext,t,i);break;case 210:case 220:case 230:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,m.assign)(a.mtext,t,i);break;case"AcDbMText":(0,y.assign)(a.mtext,t,i);break}break;case 280:switch(a.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":a.lock=i;break;case"AcDbXrecord":a.clone=!0;break}break;case 340:a.attdefHandle=i;break;case 420:case 421:case 422:case 423:case 424:case 425:case 426:case 427:case 428:case 429:case 430:case 431:case 432:case 433:case 434:case 435:case 436:case 437:case 438:case 439:case 441:(0,y.assign)(a.mtext,t,i);break;default:Object.assign(a,(0,d.default)(t,i));break}};v.assign=f;var n={TYPE:g,process:b,assign:f};v.default=n})(ya);var eo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=ya,y="ATTRIB";v.TYPE=y;var m=function(b){return b.reduce(function(f,n){var o=n[0],a=n[1];return(0,d.assign)(f,o,a),f},{type:y,subclassMarker:"AcDbText",thickness:0,scaleX:1,mtext:{},text:{}})};v.process=m;var x={TYPE:y,process:m};v.default=x})(eo);var to={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="INSERT";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 2:n.block=t;break;case 10:n.x=t;break;case 20:n.y=t;break;case 30:n.z=t;break;case 41:n.scaleX=t;break;case 42:n.scaleY=t;break;case 43:n.scaleZ=t;break;case 44:n.columnSpacing=t;break;case 45:n.rowSpacing=t;break;case 50:n.rotation=t;break;case 70:n.columnCount=t;break;case 71:n.rowCount=t;break;case 210:n.extrusionX=t;break;case 220:n.extrusionY=t;break;case 230:n.extrusionZ=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m})};v.process=x;var g={TYPE:m,process:x};v.default=g})(to);var ro={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="3DFACE";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 10:n.vertices[0].x=t;break;case 20:n.vertices[0].y=t;break;case 30:n.vertices[0].z=t;break;case 11:n.vertices[1].x=t;break;case 21:n.vertices[1].y=t;break;case 31:n.vertices[1].z=t;break;case 12:n.vertices[2].x=t;break;case 22:n.vertices[2].y=t;break;case 32:n.vertices[2].z=t;break;case 13:n.vertices[3].x=t;break;case 23:n.vertices[3].y=t;break;case 33:n.vertices[3].z=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m,vertices:[{},{},{},{}]})};v.process=x;var g={TYPE:m,process:x};v.default=g})(ro);var io={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(f){return f&&f.__esModule?f:{default:f}}var m="DIMENSION";v.TYPE=m;var x=function(n){return n.reduce(function(o,a){var t=a[0],i=a[1];switch(t){case 2:o.block=i;break;case 10:o.start.x=i;break;case 20:o.start.y=i;break;case 30:o.start.z=i;break;case 11:o.textMidpoint.x=i;break;case 21:o.textMidpoint.y=i;break;case 31:o.textMidpoint.z=i;break;case 13:o.measureStart.x=i;break;case 23:o.measureStart.y=i;break;case 33:o.measureStart.z=i;break;case 14:o.measureEnd.x=i;break;case 24:o.measureEnd.y=i;break;case 34:o.measureEnd.z=i;break;case 50:o.rotation=i;break;case 51:o.horizonRotation=i;break;case 52:o.extensionRotation=i;break;case 53:o.textRotation=i;break;case 70:{var r=g(i);r.ordinateType&&(o.ordinateType=!0),r.uniqueBlockReference&&(o.uniqueBlockReference=!0),r.userDefinedLocation&&(o.userDefinedLocation=!0),o.dimensionType=r.dimensionType;break}case 71:o.attachementPoint=i;break;case 210:o.extrudeDirection=o.extrudeDirection||{},o.extrudeDirection.x=i;break;case 220:o.extrudeDirection=o.extrudeDirection||{},o.extrudeDirection.y=i;break;case 230:o.extrudeDirection=o.extrudeDirection||{},o.extrudeDirection.z=i;break;default:Object.assign(o,(0,d.default)(t,i));break}return o},{type:m,start:{x:0,y:0,z:0},measureStart:{x:0,y:0,z:0},measureEnd:{x:0,y:0,z:0},textMidpoint:{x:0,y:0,z:0},attachementPoint:1,dimensionType:0})};v.process=x;function g(f){var n=!1,o=!1,a=!1;if(f>6){var t=f-32,i=f-64,r=f-32-64,e=f-32-128,l=f-32-64-128;t>=0&&t<=6?(n=!0,f=t):i>=0&&i<=6?(o=!0,f=i):r>=0&&r<=6?(n=!0,o=!0,f=r):e>=0&&e<=6?(n=!0,a=!0,f=e):l>=0&&l<=6&&(n=!0,o=!0,a=!0,f=l)}return{dimensionType:f,uniqueBlockReference:n,ordinateType:o,userDefinedLocation:a}}var b={TYPE:m,process:x};v.default=b})(io);var ao={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.process=v.default=v.TYPE=void 0;var d=y(yt);function y(b){return b&&b.__esModule?b:{default:b}}var m="VIEWPORT";v.TYPE=m;var x=function(f){return f.reduce(function(n,o){var a=o[0],t=o[1];switch(a){case 1:n.layout=parseFloat(t);break;case 10:n.center.x=parseFloat(t);break;case 20:n.center.y=parseFloat(t);break;case 30:n.center.z=parseFloat(t);break;case 12:n.centerDCS.x=parseFloat(t);break;case 22:n.centerDCS.y=parseFloat(t);break;case 13:n.snap.x=parseFloat(t);break;case 23:n.snap.y=parseFloat(t);break;case 14:n.snapSpacing.x=parseFloat(t);break;case 24:n.snapSpacing.y=parseFloat(t);break;case 15:n.gridSpacing.x=parseFloat(t);break;case 25:n.gridSpacing.y=parseFloat(t);break;case 16:n.direction.x=parseFloat(t);break;case 26:n.direction.y=parseFloat(t);break;case 36:n.direction.z=parseFloat(t);break;case 17:n.target.x=parseFloat(t);break;case 27:n.target.y=parseFloat(t);break;case 37:n.target.z=parseFloat(t);break;case 40:n.width=parseFloat(t);break;case 41:n.height=parseFloat(t);break;case 50:n.snapAngle=parseFloat(t);break;case 51:n.angle=parseFloat(t);break;case 68:n.status=t;break;case 69:n.id=t;break;case 90:n.flags=t;break;case 110:n.x=parseFloat(t);break;case 120:n.y=parseFloat(t);break;case 130:n.z=parseFloat(t);break;case 111:n.xAxisX=parseFloat(t);break;case 121:n.xAxisY=parseFloat(t);break;case 131:n.xAxisZ=parseFloat(t);break;case 112:n.xAxisX=parseFloat(t);break;case 122:n.xAxisY=parseFloat(t);break;case 132:n.xAxisZ=parseFloat(t);break;case 146:n.elevation=parseFloat(t);break;case 281:n.render=t;break;default:Object.assign(n,(0,d.default)(a,t));break}return n},{type:m,center:{},centerDCS:{},snap:{},snapSpacing:{},gridSpacing:{},direction:{},target:{}})};v.process=x;var g={TYPE:m,process:x};v.default=g})(ao);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=_(Gt),y=_(Gs),m=_(Ws),x=_(Ys),g=_(Xs),b=_($s),f=_(Vs),n=_(Zs),o=_(qs),a=_(Ks),t=_(Qs),i=_(Js),r=_(_a),e=_(ya),l=_(eo),s=_(to),c=_(ro),u=_(io),h=_(wa),p=_(ao);function _(C){return C&&C.__esModule?C:{default:C}}var w=[y.default,m.default,x.default,g.default,b.default,f.default,n.default,o.default,a.default,t.default,i.default,r.default,e.default,l.default,h.default,s.default,u.default,c.default,p.default].reduce(function(C,E){return C[E.TYPE]=E,C},{}),S=function(E){var k=[],O=[],U;E.forEach(function(M){var j=M[0];j===0&&(U=[],O.push(U)),U.push(M)});var F;return O.forEach(function(M){var j=M[0][1],G=M.slice(1);if(w[j]!==void 0){var N=w[j].process(G);j==="POLYLINE"?(F=N,k.push(N)):j==="VERTEX"?F?F.vertices.push(N):d.default.error("ignoring invalid VERTEX entity"):j==="SEQEND"?F=void 0:k.push(N)}else d.default.warn("unsupported type in ENTITIES section:",j)}),k};v.default=S})(ga);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(ga);function y(x){return x&&x.__esModule?x:{default:x}}var m=function(g){var b,f=[],n,o=[];return g.forEach(function(a){var t=a[0],i=a[1];if(i==="BLOCK")b="block",n={},o=[],f.push(n);else if(i==="ENDBLK")b==="entities"?n.entities=(0,d.default)(o):n.entities=[],o=void 0,b=void 0;else if(b==="block"&&t!==0)switch(t){case 1:n.xref=i;break;case 2:n.name=i;break;case 10:n.x=i;break;case 20:n.y=i;break;case 30:n.z=i;break;case 67:i!==0&&(n.paperSpace=i);break;case 410:n.layout=i;break}else b==="block"&&t===0?(b="entities",o.push(a)):b==="entities"&&o.push(a)}),f};v.default=m})(Hs);var no={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m){var x,g={layouts:[]},b={};return m.forEach(function(f,n){var o=f[0],a=f[1];if(o===0&&(x="IDLE"),a==="LAYOUT"&&(x="layout",b={},g.layouts.push(b)),x==="layout"&&o!==0)switch(o){case 100:a==="AcDbLayout"&&(x="AcDbLayout");break}if(x==="AcDbLayout"&&o!==0)switch(o){case 1:b.name=a;break;case 5:b.handle=a;break;case 10:b.minLimitX=parseFloat(a);break;case 20:b.minLimitY=parseFloat(a);break;case 11:b.maxLimitX=parseFloat(a);break;case 21:b.maxLimitY=parseFloat(a);break;case 12:b.x=parseFloat(a);break;case 22:b.y=parseFloat(a);break;case 32:b.z=parseFloat(a);break;case 14:b.minX=parseFloat(a);break;case 24:b.minY=parseFloat(a);break;case 34:b.minZ=parseFloat(a);break;case 15:b.maxX=parseFloat(a);break;case 25:b.maxY=parseFloat(a);break;case 35:b.maxZ=parseFloat(a);break;case 70:b.flag=a===1?"PSLTSCALE":"LIMCHECK";break;case 71:b.tabOrder=a;break;case 146:b.elevation=parseFloat(a);break;case 13:b.ucsX=parseFloat(a);break;case 23:b.ucsY=parseFloat(a);break;case 33:b.ucsZ=parseFloat(a);break;case 16:b.ucsXaxisX=parseFloat(a);break;case 26:b.ucsXaxisY=parseFloat(a);break;case 36:b.ucsXaxisZ=parseFloat(a);break;case 17:b.ucsYaxisX=parseFloat(a);break;case 27:b.ucsYaxisY=parseFloat(a);break;case 37:b.ucsYaxisZ=parseFloat(a);break;case 76:switch(a){case 0:b.ucsType="NOT ORTHOGRAPHIC";break;case 1:b.ucsType="TOP";break;case 2:b.ucsType="BOTTOM";break;case 3:b.ucsType="FRONT";break;case 4:b.ucsType="BACK";break;case 5:b.ucsType="LEFT";break;case 6:b.ucsType="RIGHT";break}break;case 330:b.tableRecord=a;break;case 331:b.lastActiveViewport=a;break;case 333:b.shadePlot=a;break}}),g};v.default=d})(no);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=f(zs),y=f(js),m=f(Hs),x=f(ga),g=f(no),b=f(Gt);function f(s){return s&&s.__esModule?s:{default:s}}function n(s,c){var u=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!u){if(Array.isArray(s)||(u=o(s))||c&&s&&typeof s.length=="number"){u&&(s=u);var h=0,p=function(){};return{s:p,n:function(){return h>=s.length?{done:!0}:{done:!1,value:s[h++]}},e:function(E){throw E},f:p}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var _=!0,w=!1,S;return{s:function(){u=u.call(s)},n:function(){var E=u.next();return _=E.done,E},e:function(E){w=!0,S=E},f:function(){try{!_&&u.return!=null&&u.return()}finally{if(w)throw S}}}}function o(s,c){if(s){if(typeof s=="string")return a(s,c);var u=Object.prototype.toString.call(s).slice(8,-1);if(u==="Object"&&s.constructor&&(u=s.constructor.name),u==="Map"||u==="Set")return Array.from(s);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return a(s,c)}}function a(s,c){(c==null||c>s.length)&&(c=s.length);for(var u=0,h=new Array(c);u<c;u++)h[u]=s[u];return h}var t=function(c,u){return c>=10&&c<60||c>=210&&c<240?parseFloat(u,10):c>=60&&c<100?parseInt(u,10):u},i=function(c){var u="type",h,p=[],_=n(c),w;try{for(_.s();!(w=_.n()).done;){var S=w.value;u==="type"?(h=parseInt(S,10),u="value"):(p.push([h,t(h,S)]),u="type")}}catch(C){_.e(C)}finally{_.f()}return p},r=function(c){var u;return c.reduce(function(h,p){return p[0]===0&&p[1]==="SECTION"?u=[]:p[0]===0&&p[1]==="ENDSEC"?(h.push(u),u=void 0):u!==void 0&&u.push(p),h},[])},e=function(c,u){var h=u[0][1],p=u.slice(1);switch(h){case"HEADER":c.header=(0,d.default)(p);break;case"TABLES":c.tables=(0,y.default)(p);break;case"BLOCKS":c.blocks=(0,m.default)(p);break;case"ENTITIES":c.entities=(0,x.default)(p);break;case"OBJECTS":c.objects=(0,g.default)(p);break;default:b.default.warn("Unsupported section: ".concat(h))}return c},l=function(c){var u=c.split(/\r\n|\r|\n/g),h=i(u),p=r(h),_=p.reduce(e,{header:{},blocks:[],entities:[],objects:{layouts:[]},tables:{layers:{},styles:{},ltypes:{}}});return _};v.default=l})(ba);var Yr={};function Ou(){this.__data__=[],this.size=0}var Mu=Ou;function Pu(v,d){return v===d||v!==v&&d!==d}var so=Pu,Ru=so;function Du(v,d){for(var y=v.length;y--;)if(Ru(v[y][0],d))return y;return-1}var xi=Du,Lu=xi,Iu=Array.prototype,Fu=Iu.splice;function Bu(v){var d=this.__data__,y=Lu(d,v);if(y<0)return!1;var m=d.length-1;return y==m?d.pop():Fu.call(d,y,1),--this.size,!0}var Nu=Bu,zu=xi;function ju(v){var d=this.__data__,y=zu(d,v);return y<0?void 0:d[y][1]}var Hu=ju,Gu=xi;function Wu(v){return Gu(this.__data__,v)>-1}var Yu=Wu,Xu=xi;function $u(v,d){var y=this.__data__,m=Xu(y,v);return m<0?(++this.size,y.push([v,d])):y[m][1]=d,this}var Vu=$u,Zu=Mu,qu=Nu,Ku=Hu,Qu=Yu,Ju=Vu;function Ur(v){var d=-1,y=v==null?0:v.length;for(this.clear();++d<y;){var m=v[d];this.set(m[0],m[1])}}Ur.prototype.clear=Zu;Ur.prototype.delete=qu;Ur.prototype.get=Ku;Ur.prototype.has=Qu;Ur.prototype.set=Ju;var Si=Ur,eh=Si;function th(){this.__data__=new eh,this.size=0}var rh=th;function ih(v){var d=this.__data__,y=d.delete(v);return this.size=d.size,y}var ah=ih;function nh(v){return this.__data__.get(v)}var sh=nh;function oh(v){return this.__data__.has(v)}var lh=oh,ch=typeof qe=="object"&&qe&&qe.Object===Object&&qe,oo=ch,fh=oo,uh=typeof self=="object"&&self&&self.Object===Object&&self,hh=fh||uh||Function("return this")(),Wt=hh,dh=Wt,mh=dh.Symbol,xa=mh,nn=xa,lo=Object.prototype,ph=lo.hasOwnProperty,vh=lo.toString,Lr=nn?nn.toStringTag:void 0;function bh(v){var d=ph.call(v,Lr),y=v[Lr];try{v[Lr]=void 0;var m=!0}catch(g){}var x=vh.call(v);return m&&(d?v[Lr]=y:delete v[Lr]),x}var gh=bh,_h=Object.prototype,yh=_h.toString;function wh(v){return yh.call(v)}var xh=wh,sn=xa,Sh=gh,Ch=xh,Eh="[object Null]",kh="[object Undefined]",on=sn?sn.toStringTag:void 0;function Th(v){return v==null?v===void 0?kh:Eh:on&&on in Object(v)?Sh(v):Ch(v)}var Ci=Th;function Uh(v){var d=typeof v;return v!=null&&(d=="object"||d=="function")}var Xr=Uh,Ah=Ci,Oh=Xr,Mh="[object AsyncFunction]",Ph="[object Function]",Rh="[object GeneratorFunction]",Dh="[object Proxy]";function Lh(v){if(!Oh(v))return!1;var d=Ah(v);return d==Ph||d==Rh||d==Mh||d==Dh}var co=Lh,Ih=Wt,Fh=Ih["__core-js_shared__"],Bh=Fh,Fi=Bh,ln=function(){var v=/[^.]+$/.exec(Fi&&Fi.keys&&Fi.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}();function Nh(v){return!!ln&&ln in v}var zh=Nh,jh=Function.prototype,Hh=jh.toString;function Gh(v){if(v!=null){try{return Hh.call(v)}catch(d){}try{return v+""}catch(d){}}return""}var fo=Gh,Wh=co,Yh=zh,Xh=Xr,$h=fo,Vh=/[\\^$.*+?()[\]{}|]/g,Zh=/^\[object .+?Constructor\]$/,qh=Function.prototype,Kh=Object.prototype,Qh=qh.toString,Jh=Kh.hasOwnProperty,ed=RegExp("^"+Qh.call(Jh).replace(Vh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function td(v){if(!Xh(v)||Yh(v))return!1;var d=Wh(v)?ed:Zh;return d.test($h(v))}var rd=td;function id(v,d){return v==null?void 0:v[d]}var ad=id,nd=rd,sd=ad;function od(v,d){var y=sd(v,d);return nd(y)?y:void 0}var ur=od,ld=ur,cd=Wt,fd=ld(cd,"Map"),Sa=fd,ud=ur,hd=ud(Object,"create"),Ei=hd,cn=Ei;function dd(){this.__data__=cn?cn(null):{},this.size=0}var md=dd;function pd(v){var d=this.has(v)&&delete this.__data__[v];return this.size-=d?1:0,d}var vd=pd,bd=Ei,gd="__lodash_hash_undefined__",_d=Object.prototype,yd=_d.hasOwnProperty;function wd(v){var d=this.__data__;if(bd){var y=d[v];return y===gd?void 0:y}return yd.call(d,v)?d[v]:void 0}var xd=wd,Sd=Ei,Cd=Object.prototype,Ed=Cd.hasOwnProperty;function kd(v){var d=this.__data__;return Sd?d[v]!==void 0:Ed.call(d,v)}var Td=kd,Ud=Ei,Ad="__lodash_hash_undefined__";function Od(v,d){var y=this.__data__;return this.size+=this.has(v)?0:1,y[v]=Ud&&d===void 0?Ad:d,this}var Md=Od,Pd=md,Rd=vd,Dd=xd,Ld=Td,Id=Md;function Ar(v){var d=-1,y=v==null?0:v.length;for(this.clear();++d<y;){var m=v[d];this.set(m[0],m[1])}}Ar.prototype.clear=Pd;Ar.prototype.delete=Rd;Ar.prototype.get=Dd;Ar.prototype.has=Ld;Ar.prototype.set=Id;var Fd=Ar,fn=Fd,Bd=Si,Nd=Sa;function zd(){this.size=0,this.__data__={hash:new fn,map:new(Nd||Bd),string:new fn}}var jd=zd;function Hd(v){var d=typeof v;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?v!=="__proto__":v===null}var Gd=Hd,Wd=Gd;function Yd(v,d){var y=v.__data__;return Wd(d)?y[typeof d=="string"?"string":"hash"]:y.map}var ki=Yd,Xd=ki;function $d(v){var d=Xd(this,v).delete(v);return this.size-=d?1:0,d}var Vd=$d,Zd=ki;function qd(v){return Zd(this,v).get(v)}var Kd=qd,Qd=ki;function Jd(v){return Qd(this,v).has(v)}var e0=Jd,t0=ki;function r0(v,d){var y=t0(this,v),m=y.size;return y.set(v,d),this.size+=y.size==m?0:1,this}var i0=r0,a0=jd,n0=Vd,s0=Kd,o0=e0,l0=i0;function Or(v){var d=-1,y=v==null?0:v.length;for(this.clear();++d<y;){var m=v[d];this.set(m[0],m[1])}}Or.prototype.clear=a0;Or.prototype.delete=n0;Or.prototype.get=s0;Or.prototype.has=o0;Or.prototype.set=l0;var c0=Or,f0=Si,u0=Sa,h0=c0,d0=200;function m0(v,d){var y=this.__data__;if(y instanceof f0){var m=y.__data__;if(!u0||m.length<d0-1)return m.push([v,d]),this.size=++y.size,this;y=this.__data__=new h0(m)}return y.set(v,d),this.size=y.size,this}var p0=m0,v0=Si,b0=rh,g0=ah,_0=sh,y0=lh,w0=p0;function Mr(v){var d=this.__data__=new v0(v);this.size=d.size}Mr.prototype.clear=b0;Mr.prototype.delete=g0;Mr.prototype.get=_0;Mr.prototype.has=y0;Mr.prototype.set=w0;var x0=Mr;function S0(v,d){for(var y=-1,m=v==null?0:v.length;++y<m&&d(v[y],y,v)!==!1;);return v}var C0=S0,E0=ur,k0=function(){try{var v=E0(Object,"defineProperty");return v({},"",{}),v}catch(d){}}(),T0=k0,un=T0;function U0(v,d,y){d=="__proto__"&&un?un(v,d,{configurable:!0,enumerable:!0,value:y,writable:!0}):v[d]=y}var uo=U0,A0=uo,O0=so,M0=Object.prototype,P0=M0.hasOwnProperty;function R0(v,d,y){var m=v[d];(!(P0.call(v,d)&&O0(m,y))||y===void 0&&!(d in v))&&A0(v,d,y)}var ho=R0,D0=ho,L0=uo;function I0(v,d,y,m){var x=!y;y||(y={});for(var g=-1,b=d.length;++g<b;){var f=d[g],n=m?m(y[f],v[f],f,y,v):void 0;n===void 0&&(n=v[f]),x?L0(y,f,n):D0(y,f,n)}return y}var Ti=I0;function F0(v,d){for(var y=-1,m=Array(v);++y<v;)m[y]=d(y);return m}var B0=F0;function N0(v){return v!=null&&typeof v=="object"}var $r=N0,z0=Ci,j0=$r,H0="[object Arguments]";function G0(v){return j0(v)&&z0(v)==H0}var W0=G0,hn=W0,Y0=$r,mo=Object.prototype,X0=mo.hasOwnProperty,$0=mo.propertyIsEnumerable,V0=hn(function(){return arguments}())?hn:function(v){return Y0(v)&&X0.call(v,"callee")&&!$0.call(v,"callee")},Z0=V0,q0=Array.isArray,Ca=q0,pi={exports:{}};function K0(){return!1}var Q0=K0;pi.exports;(function(v,d){var y=Wt,m=Q0,x=d&&!d.nodeType&&d,g=x&&!0&&v&&!v.nodeType&&v,b=g&&g.exports===x,f=b?y.Buffer:void 0,n=f?f.isBuffer:void 0,o=n||m;v.exports=o})(pi,pi.exports);var po=pi.exports,J0=9007199254740991,em=/^(?:0|[1-9]\d*)$/;function tm(v,d){var y=typeof v;return d=d==null?J0:d,!!d&&(y=="number"||y!="symbol"&&em.test(v))&&v>-1&&v%1==0&&v<d}var rm=tm,im=9007199254740991;function am(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=im}var vo=am,nm=Ci,sm=vo,om=$r,lm="[object Arguments]",cm="[object Array]",fm="[object Boolean]",um="[object Date]",hm="[object Error]",dm="[object Function]",mm="[object Map]",pm="[object Number]",vm="[object Object]",bm="[object RegExp]",gm="[object Set]",_m="[object String]",ym="[object WeakMap]",wm="[object ArrayBuffer]",xm="[object DataView]",Sm="[object Float32Array]",Cm="[object Float64Array]",Em="[object Int8Array]",km="[object Int16Array]",Tm="[object Int32Array]",Um="[object Uint8Array]",Am="[object Uint8ClampedArray]",Om="[object Uint16Array]",Mm="[object Uint32Array]",nt={};nt[Sm]=nt[Cm]=nt[Em]=nt[km]=nt[Tm]=nt[Um]=nt[Am]=nt[Om]=nt[Mm]=!0;nt[lm]=nt[cm]=nt[wm]=nt[fm]=nt[xm]=nt[um]=nt[hm]=nt[dm]=nt[mm]=nt[pm]=nt[vm]=nt[bm]=nt[gm]=nt[_m]=nt[ym]=!1;function Pm(v){return om(v)&&sm(v.length)&&!!nt[nm(v)]}var Rm=Pm;function Dm(v){return function(d){return v(d)}}var Ea=Dm,vi={exports:{}};vi.exports;(function(v,d){var y=oo,m=d&&!d.nodeType&&d,x=m&&!0&&v&&!v.nodeType&&v,g=x&&x.exports===m,b=g&&y.process,f=function(){try{var n=x&&x.require&&x.require("util").types;return n||b&&b.binding&&b.binding("util")}catch(o){}}();v.exports=f})(vi,vi.exports);var ka=vi.exports,Lm=Rm,Im=Ea,dn=ka,mn=dn&&dn.isTypedArray,Fm=mn?Im(mn):Lm,Bm=Fm,Nm=B0,zm=Z0,jm=Ca,Hm=po,Gm=rm,Wm=Bm,Ym=Object.prototype,Xm=Ym.hasOwnProperty;function $m(v,d){var y=jm(v),m=!y&&zm(v),x=!y&&!m&&Hm(v),g=!y&&!m&&!x&&Wm(v),b=y||m||x||g,f=b?Nm(v.length,String):[],n=f.length;for(var o in v)(d||Xm.call(v,o))&&!(b&&(o=="length"||x&&(o=="offset"||o=="parent")||g&&(o=="buffer"||o=="byteLength"||o=="byteOffset")||Gm(o,n)))&&f.push(o);return f}var bo=$m,Vm=Object.prototype;function Zm(v){var d=v&&v.constructor,y=typeof d=="function"&&d.prototype||Vm;return v===y}var Ta=Zm;function qm(v,d){return function(y){return v(d(y))}}var go=qm,Km=go,Qm=Km(Object.keys,Object),Jm=Qm,ep=Ta,tp=Jm,rp=Object.prototype,ip=rp.hasOwnProperty;function ap(v){if(!ep(v))return tp(v);var d=[];for(var y in Object(v))ip.call(v,y)&&y!="constructor"&&d.push(y);return d}var np=ap,sp=co,op=vo;function lp(v){return v!=null&&op(v.length)&&!sp(v)}var _o=lp,cp=bo,fp=np,up=_o;function hp(v){return up(v)?cp(v):fp(v)}var Ua=hp,dp=Ti,mp=Ua;function pp(v,d){return v&&dp(d,mp(d),v)}var vp=pp;function bp(v){var d=[];if(v!=null)for(var y in Object(v))d.push(y);return d}var gp=bp,_p=Xr,yp=Ta,wp=gp,xp=Object.prototype,Sp=xp.hasOwnProperty;function Cp(v){if(!_p(v))return wp(v);var d=yp(v),y=[];for(var m in v)m=="constructor"&&(d||!Sp.call(v,m))||y.push(m);return y}var Ep=Cp,kp=bo,Tp=Ep,Up=_o;function Ap(v){return Up(v)?kp(v,!0):Tp(v)}var Aa=Ap,Op=Ti,Mp=Aa;function Pp(v,d){return v&&Op(d,Mp(d),v)}var Rp=Pp,bi={exports:{}};bi.exports;(function(v,d){var y=Wt,m=d&&!d.nodeType&&d,x=m&&!0&&v&&!v.nodeType&&v,g=x&&x.exports===m,b=g?y.Buffer:void 0,f=b?b.allocUnsafe:void 0;function n(o,a){if(a)return o.slice();var t=o.length,i=f?f(t):new o.constructor(t);return o.copy(i),i}v.exports=n})(bi,bi.exports);var Dp=bi.exports;function Lp(v,d){var y=-1,m=v.length;for(d||(d=Array(m));++y<m;)d[y]=v[y];return d}var Ip=Lp;function Fp(v,d){for(var y=-1,m=v==null?0:v.length,x=0,g=[];++y<m;){var b=v[y];d(b,y,v)&&(g[x++]=b)}return g}var Bp=Fp;function Np(){return[]}var yo=Np,zp=Bp,jp=yo,Hp=Object.prototype,Gp=Hp.propertyIsEnumerable,pn=Object.getOwnPropertySymbols,Wp=pn?function(v){return v==null?[]:(v=Object(v),zp(pn(v),function(d){return Gp.call(v,d)}))}:jp,Oa=Wp,Yp=Ti,Xp=Oa;function $p(v,d){return Yp(v,Xp(v),d)}var Vp=$p;function Zp(v,d){for(var y=-1,m=d.length,x=v.length;++y<m;)v[x+y]=d[y];return v}var wo=Zp,qp=go,Kp=qp(Object.getPrototypeOf,Object),xo=Kp,Qp=wo,Jp=xo,ev=Oa,tv=yo,rv=Object.getOwnPropertySymbols,iv=rv?function(v){for(var d=[];v;)Qp(d,ev(v)),v=Jp(v);return d}:tv,So=iv,av=Ti,nv=So;function sv(v,d){return av(v,nv(v),d)}var ov=sv,lv=wo,cv=Ca;function fv(v,d,y){var m=d(v);return cv(v)?m:lv(m,y(v))}var Co=fv,uv=Co,hv=Oa,dv=Ua;function mv(v){return uv(v,dv,hv)}var pv=mv,vv=Co,bv=So,gv=Aa;function _v(v){return vv(v,gv,bv)}var yv=_v,wv=ur,xv=Wt,Sv=wv(xv,"DataView"),Cv=Sv,Ev=ur,kv=Wt,Tv=Ev(kv,"Promise"),Uv=Tv,Av=ur,Ov=Wt,Mv=Av(Ov,"Set"),Pv=Mv,Rv=ur,Dv=Wt,Lv=Rv(Dv,"WeakMap"),Iv=Lv,Ji=Cv,ea=Sa,ta=Uv,ra=Pv,ia=Iv,Eo=Ci,Pr=fo,vn="[object Map]",Fv="[object Object]",bn="[object Promise]",gn="[object Set]",_n="[object WeakMap]",yn="[object DataView]",Bv=Pr(Ji),Nv=Pr(ea),zv=Pr(ta),jv=Pr(ra),Hv=Pr(ia),nr=Eo;(Ji&&nr(new Ji(new ArrayBuffer(1)))!=yn||ea&&nr(new ea)!=vn||ta&&nr(ta.resolve())!=bn||ra&&nr(new ra)!=gn||ia&&nr(new ia)!=_n)&&(nr=function(v){var d=Eo(v),y=d==Fv?v.constructor:void 0,m=y?Pr(y):"";if(m)switch(m){case Bv:return yn;case Nv:return vn;case zv:return bn;case jv:return gn;case Hv:return _n}return d});var Ma=nr,Gv=Object.prototype,Wv=Gv.hasOwnProperty;function Yv(v){var d=v.length,y=new v.constructor(d);return d&&typeof v[0]=="string"&&Wv.call(v,"index")&&(y.index=v.index,y.input=v.input),y}var Xv=Yv,$v=Wt,Vv=$v.Uint8Array,Zv=Vv,wn=Zv;function qv(v){var d=new v.constructor(v.byteLength);return new wn(d).set(new wn(v)),d}var Pa=qv,Kv=Pa;function Qv(v,d){var y=d?Kv(v.buffer):v.buffer;return new v.constructor(y,v.byteOffset,v.byteLength)}var Jv=Qv,eb=/\w*$/;function tb(v){var d=new v.constructor(v.source,eb.exec(v));return d.lastIndex=v.lastIndex,d}var rb=tb,xn=xa,Sn=xn?xn.prototype:void 0,Cn=Sn?Sn.valueOf:void 0;function ib(v){return Cn?Object(Cn.call(v)):{}}var ab=ib,nb=Pa;function sb(v,d){var y=d?nb(v.buffer):v.buffer;return new v.constructor(y,v.byteOffset,v.length)}var ob=sb,lb=Pa,cb=Jv,fb=rb,ub=ab,hb=ob,db="[object Boolean]",mb="[object Date]",pb="[object Map]",vb="[object Number]",bb="[object RegExp]",gb="[object Set]",_b="[object String]",yb="[object Symbol]",wb="[object ArrayBuffer]",xb="[object DataView]",Sb="[object Float32Array]",Cb="[object Float64Array]",Eb="[object Int8Array]",kb="[object Int16Array]",Tb="[object Int32Array]",Ub="[object Uint8Array]",Ab="[object Uint8ClampedArray]",Ob="[object Uint16Array]",Mb="[object Uint32Array]";function Pb(v,d,y){var m=v.constructor;switch(d){case wb:return lb(v);case db:case mb:return new m(+v);case xb:return cb(v,y);case Sb:case Cb:case Eb:case kb:case Tb:case Ub:case Ab:case Ob:case Mb:return hb(v,y);case pb:return new m;case vb:case _b:return new m(v);case bb:return fb(v);case gb:return new m;case yb:return ub(v)}}var Rb=Pb,Db=Xr,En=Object.create,Lb=function(){function v(){}return function(d){if(!Db(d))return{};if(En)return En(d);v.prototype=d;var y=new v;return v.prototype=void 0,y}}(),Ib=Lb,Fb=Ib,Bb=xo,Nb=Ta;function zb(v){return typeof v.constructor=="function"&&!Nb(v)?Fb(Bb(v)):{}}var jb=zb,Hb=Ma,Gb=$r,Wb="[object Map]";function Yb(v){return Gb(v)&&Hb(v)==Wb}var Xb=Yb,$b=Xb,Vb=Ea,kn=ka,Tn=kn&&kn.isMap,Zb=Tn?Vb(Tn):$b,qb=Zb,Kb=Ma,Qb=$r,Jb="[object Set]";function eg(v){return Qb(v)&&Kb(v)==Jb}var tg=eg,rg=tg,ig=Ea,Un=ka,An=Un&&Un.isSet,ag=An?ig(An):rg,ng=ag,sg=x0,og=C0,lg=ho,cg=vp,fg=Rp,ug=Dp,hg=Ip,dg=Vp,mg=ov,pg=pv,vg=yv,bg=Ma,gg=Xv,_g=Rb,yg=jb,wg=Ca,xg=po,Sg=qb,Cg=Xr,Eg=ng,kg=Ua,Tg=Aa,Ug=1,Ag=2,Og=4,ko="[object Arguments]",Mg="[object Array]",Pg="[object Boolean]",Rg="[object Date]",Dg="[object Error]",To="[object Function]",Lg="[object GeneratorFunction]",Ig="[object Map]",Fg="[object Number]",Uo="[object Object]",Bg="[object RegExp]",Ng="[object Set]",zg="[object String]",jg="[object Symbol]",Hg="[object WeakMap]",Gg="[object ArrayBuffer]",Wg="[object DataView]",Yg="[object Float32Array]",Xg="[object Float64Array]",$g="[object Int8Array]",Vg="[object Int16Array]",Zg="[object Int32Array]",qg="[object Uint8Array]",Kg="[object Uint8ClampedArray]",Qg="[object Uint16Array]",Jg="[object Uint32Array]",tt={};tt[ko]=tt[Mg]=tt[Gg]=tt[Wg]=tt[Pg]=tt[Rg]=tt[Yg]=tt[Xg]=tt[$g]=tt[Vg]=tt[Zg]=tt[Ig]=tt[Fg]=tt[Uo]=tt[Bg]=tt[Ng]=tt[zg]=tt[jg]=tt[qg]=tt[Kg]=tt[Qg]=tt[Jg]=!0;tt[Dg]=tt[To]=tt[Hg]=!1;function li(v,d,y,m,x,g){var b,f=d&Ug,n=d&Ag,o=d&Og;if(y&&(b=x?y(v,m,x,g):y(v)),b!==void 0)return b;if(!Cg(v))return v;var a=wg(v);if(a){if(b=gg(v),!f)return hg(v,b)}else{var t=bg(v),i=t==To||t==Lg;if(xg(v))return ug(v,f);if(t==Uo||t==ko||i&&!x){if(b=n||i?{}:yg(v),!f)return n?mg(v,fg(b,v)):dg(v,cg(b,v))}else{if(!tt[t])return x?v:{};b=_g(v,t,f)}}g||(g=new sg);var r=g.get(v);if(r)return r;g.set(v,b),Eg(v)?v.forEach(function(s){b.add(li(s,d,y,s,v,g))}):Sg(v)&&v.forEach(function(s,c){b.set(c,li(s,d,y,c,v,g))});var e=o?n?vg:pg:n?Tg:kg,l=a?void 0:e(v);return og(l||v,function(s,c){l&&(c=s,s=v[c]),lg(b,c,li(s,d,y,c,v,g))}),b}var e1=li,t1=e1,r1=1,i1=4;function a1(v){return t1(v,r1|i1)}var n1=a1;(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=m(n1),y=m(Gt);function m(b){return b&&b.__esModule?b:{default:b}}function x(b){"@babel/helpers - typeof";return x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},x(b)}var g=function(f){var n=f.blocks.reduce(function(a,t){return a[t.name]=t,a},{}),o=function a(t,i){var r=[];return t.forEach(function(e){if(e.type==="INSERT"){var l=function(){var c,u,h,p,_,w=e,S=n[w.block];if(!S)return y.default.error("no block found for insert. block:",w.block),{v:void 0};var C=(c=w.rowCount)!==null&&c!==void 0?c:1,E=(u=w.columnCount)!==null&&u!==void 0?u:1,k=(h=w.rowSpacing)!==null&&h!==void 0?h:0,O=(p=w.columnSpacing)!==null&&p!==void 0?p:0,U=(_=w.rotation)!==null&&_!==void 0?_:0,F,M;if(C>1||E>1){var j=Math.cos(U*Math.PI/180),G=Math.sin(U*Math.PI/180);F={x:-G*k,y:j*k},M={x:j*O,y:G*O}}else F={x:0,y:0},M={x:0,y:0};for(var N=0;N<C;N++)for(var R=0;R<E;R++){var A={x:w.x+F.x*N+M.x*R,y:w.y+F.y*N+M.y*R,scaleX:w.scaleX,scaleY:w.scaleY,scaleZ:w.scaleZ,extrusionX:w.extrusionX,extrusionY:w.extrusionY,extrusionZ:w.extrusionZ,rotation:w.rotation},H=i.slice(0);H.push(A);var Z=S.entities.map(function(K){var J=(0,d.default)(K);switch(J.layer=w.layer,J.type){case"LINE":{J.start.x-=S.x,J.start.y-=S.y,J.end.x-=S.x,J.end.y-=S.y;break}case"LWPOLYLINE":case"POLYLINE":{J.vertices.forEach(function(D){D.x-=S.x,D.y-=S.y});break}case"CIRCLE":case"ELLIPSE":case"ARC":{J.x-=S.x,J.y-=S.y;break}case"SPLINE":{J.controlPoints.forEach(function(D){D.x-=S.x,D.y-=S.y});break}}return J});r=r.concat(a(Z,H))}}();if(x(l)==="object")return l.v}else{var s=(0,d.default)(e);s.transforms=i.slice().reverse(),r.push(s)}}),r};return o(f.entities,[])};v.default=g})(Yr);var Ra={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m){return m.reduce(function(x,g){var b=g.layer;return x[b]||(x[b]=[]),x[b].push(g),x},{})};v.default=d})(Ra);var Da={},Vr={},Ui={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;function d(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?d=function(o){return typeof o}:d=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},d(f)}function y(f,n){if(!(f instanceof n))throw new TypeError("Cannot call a class as a function")}function m(f,n){for(var o=0;o<n.length;o++){var a=n[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(f,a.key,a)}}function x(f,n,o){return n&&m(f.prototype,n),o&&m(f,o),f}var g=function(){function f(n,o){y(this,f),d(n)==="object"?(this.x=n.x,this.y=n.y):(this.x=n,this.y=o)}return x(f,[{key:"equals",value:function(o){return this.x===o.x&&this.y===o.y}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function(){return new f(-this.x,-this.y)}},{key:"add",value:function(o){return new f(this.x+o.x,this.y+o.y)}},{key:"sub",value:function(o){return new f(this.x-o.x,this.y-o.y)}},{key:"multiply",value:function(o){return new f(this.x*o,this.y*o)}},{key:"norm",value:function(){return this.multiply(1/this.length())}},{key:"dot",value:function(o){return this.x*o.x+this.y*o.y}}]),f}(),b=g;v.default=b})(Ui);var Zr={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;function d(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?d=function(o){return typeof o}:d=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},d(f)}function y(f,n){if(!(f instanceof n))throw new TypeError("Cannot call a class as a function")}function m(f,n){for(var o=0;o<n.length;o++){var a=n[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(f,a.key,a)}}function x(f,n,o){return n&&m(f.prototype,n),o&&m(f,o),f}var g=function(){function f(n,o,a){y(this,f),d(n)==="object"?(this.x=n.x,this.y=n.y,this.z=n.z):n===void 0?(this.x=0,this.y=0,this.z=0):(this.x=n,this.y=o,this.z=a)}return x(f,[{key:"equals",value:function(o,a){return a===void 0&&(a=0),Math.abs(this.x-o.x)<=a&&Math.abs(this.y-o.y)<=a&&Math.abs(this.z-o.z)<=a}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function(){return new f(-this.x,-this.y,-this.z)}},{key:"add",value:function(o){return new f(this.x+o.x,this.y+o.y,this.z+o.z)}},{key:"sub",value:function(o){return new f(this.x-o.x,this.y-o.y,this.z-o.z)}},{key:"multiply",value:function(o){return new f(this.x*o,this.y*o,this.z*o)}},{key:"norm",value:function(){return this.multiply(1/this.length())}},{key:"dot",value:function(o){return this.x*o.x+this.y*o.y+this.z*o.z}},{key:"cross",value:function(o){return new f(this.y*o.z-this.z*o.y,this.z*o.x-this.x*o.z,this.x*o.y-this.y*o.x)}}]),f}(),b=g;v.default=b})(Zr);var Ao={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(Ui);function y(o){return o&&o.__esModule?o:{default:o}}function m(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?m=function(t){return typeof t}:m=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(o)}function x(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")}function g(o,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}function b(o,a,t){return a&&g(o.prototype,a),t&&g(o,t),o}var f=function(){function o(a,t){if(x(this,o),m(a)==="object"&&m(t)==="object"&&a.x!==void 0&&a.y!==void 0&&t.x!==void 0&&t.y!==void 0)this.min=new d.default(a),this.max=new d.default(t),this.valid=!0;else if(a===void 0&&t===void 0)this.min=new d.default(1/0,1/0),this.max=new d.default(-1/0,-1/0),this.valid=!1;else throw Error("Illegal construction - must use { x, y } objects")}return b(o,[{key:"equals",value:function(t){if(!this.valid)throw Error("Box2 is invalid");return this.min.equals(t.min)&&this.max.equals(t.max)}},{key:"expandByPoint",value:function(t){return this.min=new d.default(Math.min(this.min.x,t.x),Math.min(this.min.y,t.y)),this.max=new d.default(Math.max(this.max.x,t.x),Math.max(this.max.y,t.y)),this.valid=!0,this}},{key:"expandByPoints",value:function(t){var i=this;return t.forEach(function(r){i.expandByPoint(r)},this),this}},{key:"isPointInside",value:function(t){return t.x>=this.min.x&&t.y>=this.min.y&&t.x<=this.max.x&&t.y<=this.max.y}},{key:"width",get:function(){if(!this.valid)throw Error("Box2 is invalid");return this.max.x-this.min.x}},{key:"height",get:function(){if(!this.valid)throw Error("Box2 is invalid");return this.max.y-this.min.y}}]),o}();f.fromPoints=function(o){return new f().expandByPoints(o)};var n=f;v.default=n})(Ao);var Oo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(Zr);function y(o){return o&&o.__esModule?o:{default:o}}function m(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?m=function(t){return typeof t}:m=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(o)}function x(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")}function g(o,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}function b(o,a,t){return a&&g(o.prototype,a),t&&g(o,t),o}var f=function(){function o(a,t){if(x(this,o),m(a)==="object"&&m(t)==="object"&&a.x!==void 0&&a.y!==void 0&&a.z!==void 0&&t.x!==void 0&&t.y!==void 0&&t.z!==void 0)this.min=new d.default(a),this.max=new d.default(t),this.valid=!0;else if(a===void 0&&t===void 0)this.min=new d.default(1/0,1/0,1/0),this.max=new d.default(-1/0,-1/0,-1/0),this.valid=!1;else throw Error("Illegal construction - must use { x, y, z } objects")}return b(o,[{key:"equals",value:function(t){if(!this.valid)throw Error("Box3 is invalid");return this.min.equals(t.min)&&this.max.equals(t.max)}},{key:"expandByPoint",value:function(t){return this.min=new d.default(Math.min(this.min.x,t.x),Math.min(this.min.y,t.y),Math.min(this.min.z,t.z)),this.max=new d.default(Math.max(this.max.x,t.x),Math.max(this.max.y,t.y),Math.max(this.max.z,t.z)),this.valid=!0,this}},{key:"expandByPoints",value:function(t){var i=this;return t.forEach(function(r){i.expandByPoint(r)},this),this}},{key:"isPointInside",value:function(t){return t.x>=this.min.x&&t.y>=this.min.y&&t.z>=this.min.z&&t.x<=this.max.x&&t.y<=this.max.y&&t.z<=this.max.z}},{key:"width",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.x-this.min.x}},{key:"depth",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.y-this.min.y}},{key:"height",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.z-this.min.z}}]),o}();f.fromPoints=function(o){return new f().expandByPoints(o)};var n=f;v.default=n})(Oo);var Mo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;function d(b,f){if(!(b instanceof f))throw new TypeError("Cannot call a class as a function")}function y(b,f){for(var n=0;n<f.length;n++){var o=f[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(b,o.key,o)}}function m(b,f,n){return f&&y(b.prototype,f),n&&y(b,n),b}var x=function(){function b(f,n,o,a){d(this,b),this.a=f,this.b=n,this.c=o,this.d=a}return m(b,[{key:"distanceToPoint",value:function(n){var o=(this.a*n.x+this.b*n.y+this.c*n.z+this.d)/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);return o}},{key:"equals",value:function(n){return this.a===n.a&&this.b===n.b&&this.c===n.c&&this.d===n.d}},{key:"coPlanar",value:function(n){var o=this.a===n.a&&this.b===n.b&&this.c===n.c&&this.d===n.d,a=this.a===-n.a&&this.b===-n.b&&this.c===-n.c&&this.d===-n.d;return o||a}}]),b}();x.fromPointAndNormal=function(b,f){var n=f.x,o=f.y,a=f.z,t=-(b.x*n+b.y*o+b.z*a);return new x(f.x,f.y,f.z,t)},x.fromPoints=function(b){for(var f,n=0,o=b.length;n<o;++n){var a=b[(n+1)%o].sub(b[n]),t=b[(n+2)%o].sub(b[(n+1)%o]),i=a.cross(t);if(!(isNaN(i.length())||i.length()===0))if(!f)f=i.norm();else{var r=i.norm().equals(f,1e-6),e=i.neg().norm().equals(f,1e-6);if(!(r||e))throw Error("points not on a plane")}}if(!f)throw Error("points not on a plane");return x.fromPointAndNormal(b[0],f.norm())};var g=x;v.default=g})(Mo);var Po={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(Zr);function y(n){return n&&n.__esModule?n:{default:n}}function m(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function x(n,o){for(var a=0;a<o.length;a++){var t=o[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function g(n,o,a){return o&&x(n.prototype,o),a&&x(n,a),n}var b=function(){function n(o,a,t,i){m(this,n),this.x=o,this.y=a,this.z=t,this.w=i}return g(n,[{key:"applyToVec3",value:function(a){var t=a.x,i=a.y,r=a.z,e=this.x,l=this.y,s=this.z,c=this.w,u=c*t+l*r-s*i,h=c*i+s*t-e*r,p=c*r+e*i-l*t,_=-e*t-l*i-s*r;return new d.default(u*c+_*-e+h*-s-p*-l,h*c+_*-l+p*-e-u*-s,p*c+_*-s+u*-l-h*-e)}}]),n}();b.fromAxisAngle=function(n,o){var a=n.norm(),t=o/2,i=Math.sin(t);return new b(a.x*i,a.y*i,a.z*i,Math.cos(t))};var f=b;v.default=f})(Po);var Ro={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(Ui);function y(r){return r&&r.__esModule?r:{default:r}}function m(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?m=function(l){return typeof l}:m=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},m(r)}function x(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function g(r,e){for(var l=0;l<e.length;l++){var s=e[l];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(r,s.key,s)}}function b(r,e,l){return e&&g(r.prototype,e),l&&g(r,l),r}var f=function(e,l,s){var c=e.x,u=e.y,h=l.x,p=l.y,_=s.x,w=s.y,S=(w-u)*(h-c),C=(p-u)*(_-c);return S>C+Number.EPSILON?1:S+Number.EPSILON<C?-1:0},n=function(e,l){var s=e.a,c=e.b,u=l.a,h=l.b;return f(s,u,h)!==f(c,u,h)&&f(s,c,u)!==f(s,c,h)},o=function(e,l){var s=e.a.x,c=e.b.x,u=e.a.y,h=e.b.y,p=l.a.x,_=l.b.x,w=l.a.y,S=l.b.y,C=s-c,E=p-_,k=u-h,O=w-S,U=C*O-k*E,F=((s*h-u*c)*E-C*(p*S-w*_))/U,M=((s*h-u*c)*O-k*(p*S-w*_))/U;return isNaN(F)||isNaN(M)?null:new d.default(F,M)},a=function(e,l){return Math.sqrt(Math.pow(e.x-l.x,2)+Math.pow(e.y-l.y,2))},t=function(){function r(e,l){if(x(this,r),m(e)!=="object"||e.x===void 0||e.y===void 0)throw Error("expected first argument to have x and y properties");if(m(l)!=="object"||l.x===void 0||l.y===void 0)throw Error("expected second argument to have x and y properties");this.a=new d.default(e),this.b=new d.default(l)}return b(r,[{key:"length",value:function(){return this.a.sub(this.b).length()}},{key:"intersects",value:function(l){if(!(l instanceof r))throw new Error("expected argument to be an instance of vecks.Line2");return n(this,l)}},{key:"getIntersection",value:function(l){return this.intersects(l)?o(this,l):null}},{key:"containsPoint",value:function(l){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e-12;return Math.abs(a(this.a,this.b)-a(l,this.a)-a(l,this.b))<s}}]),r}(),i=t;v.default=i})(Ro);var Do={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(Zr);function y(a){return a&&a.__esModule?a:{default:a}}function m(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?m=function(i){return typeof i}:m=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},m(a)}function x(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function g(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function b(a,t,i){return t&&g(a.prototype,t),i&&g(a,i),a}var f=function(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)+Math.pow(t.z-i.z,2))},n=function(){function a(t,i){if(x(this,a),m(t)!=="object"||t.x===void 0||t.y===void 0||t.z===void 0)throw Error("expected first argument to have x, y and z properties");if(m(i)!=="object"||i.x===void 0||i.y===void 0||i.y===void 0)throw Error("expected second argument to have x, y and z properties");this.a=new d.default(t),this.b=new d.default(i)}return b(a,[{key:"length",value:function(){return this.a.sub(this.b).length()}},{key:"containsPoint",value:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e-12;return Math.abs(f(this.a,this.b)-f(i,this.a)-f(i,this.b))<r}}]),a}(),o=n;v.default=o})(Do);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),Object.defineProperty(v,"V2",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(v,"V3",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(v,"Box2",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(v,"Box3",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(v,"Plane3",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(v,"Quaternion",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(v,"Line2",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(v,"Line3",{enumerable:!0,get:function(){return n.default}});var d=o(Ui),y=o(Zr),m=o(Ao),x=o(Oo),g=o(Mo),b=o(Po),f=o(Ro),n=o(Do);function o(a){return a&&a.__esModule?a:{default:a}}})(Vr);var Ai={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=[[0,0,0],[255,0,0],[255,255,0],[0,255,0],[0,255,255],[0,0,255],[255,0,255],[255,255,255],[65,65,65],[128,128,128],[255,0,0],[255,170,170],[189,0,0],[189,126,126],[129,0,0],[129,86,86],[104,0,0],[104,69,69],[79,0,0],[79,53,53],[255,63,0],[255,191,170],[189,46,0],[189,141,126],[129,31,0],[129,96,86],[104,25,0],[104,78,69],[79,19,0],[79,59,53],[255,127,0],[255,212,170],[189,94,0],[189,157,126],[129,64,0],[129,107,86],[104,52,0],[104,86,69],[79,39,0],[79,66,53],[255,191,0],[255,234,170],[189,141,0],[189,173,126],[129,96,0],[129,118,86],[104,78,0],[104,95,69],[79,59,0],[79,73,53],[255,255,0],[255,255,170],[189,189,0],[189,189,126],[129,129,0],[129,129,86],[104,104,0],[104,104,69],[79,79,0],[79,79,53],[191,255,0],[234,255,170],[141,189,0],[173,189,126],[96,129,0],[118,129,86],[78,104,0],[95,104,69],[59,79,0],[73,79,53],[127,255,0],[212,255,170],[94,189,0],[157,189,126],[64,129,0],[107,129,86],[52,104,0],[86,104,69],[39,79,0],[66,79,53],[63,255,0],[191,255,170],[46,189,0],[141,189,126],[31,129,0],[96,129,86],[25,104,0],[78,104,69],[19,79,0],[59,79,53],[0,255,0],[170,255,170],[0,189,0],[126,189,126],[0,129,0],[86,129,86],[0,104,0],[69,104,69],[0,79,0],[53,79,53],[0,255,63],[170,255,191],[0,189,46],[126,189,141],[0,129,31],[86,129,96],[0,104,25],[69,104,78],[0,79,19],[53,79,59],[0,255,127],[170,255,212],[0,189,94],[126,189,157],[0,129,64],[86,129,107],[0,104,52],[69,104,86],[0,79,39],[53,79,66],[0,255,191],[170,255,234],[0,189,141],[126,189,173],[0,129,96],[86,129,118],[0,104,78],[69,104,95],[0,79,59],[53,79,73],[0,255,255],[170,255,255],[0,189,189],[126,189,189],[0,129,129],[86,129,129],[0,104,104],[69,104,104],[0,79,79],[53,79,79],[0,191,255],[170,234,255],[0,141,189],[126,173,189],[0,96,129],[86,118,129],[0,78,104],[69,95,104],[0,59,79],[53,73,79],[0,127,255],[170,212,255],[0,94,189],[126,157,189],[0,64,129],[86,107,129],[0,52,104],[69,86,104],[0,39,79],[53,66,79],[0,63,255],[170,191,255],[0,46,189],[126,141,189],[0,31,129],[86,96,129],[0,25,104],[69,78,104],[0,19,79],[53,59,79],[0,0,255],[170,170,255],[0,0,189],[126,126,189],[0,0,129],[86,86,129],[0,0,104],[69,69,104],[0,0,79],[53,53,79],[63,0,255],[191,170,255],[46,0,189],[141,126,189],[31,0,129],[96,86,129],[25,0,104],[78,69,104],[19,0,79],[59,53,79],[127,0,255],[212,170,255],[94,0,189],[157,126,189],[64,0,129],[107,86,129],[52,0,104],[86,69,104],[39,0,79],[66,53,79],[191,0,255],[234,170,255],[141,0,189],[173,126,189],[96,0,129],[118,86,129],[78,0,104],[95,69,104],[59,0,79],[73,53,79],[255,0,255],[255,170,255],[189,0,189],[189,126,189],[129,0,129],[129,86,129],[104,0,104],[104,69,104],[79,0,79],[79,53,79],[255,0,191],[255,170,234],[189,0,141],[189,126,173],[129,0,96],[129,86,118],[104,0,78],[104,69,95],[79,0,59],[79,53,73],[255,0,127],[255,170,212],[189,0,94],[189,126,157],[129,0,64],[129,86,107],[104,0,52],[104,69,86],[79,0,39],[79,53,66],[255,0,63],[255,170,191],[189,0,46],[189,126,141],[129,0,31],[129,86,96],[104,0,25],[104,69,78],[79,0,19],[79,53,59],[51,51,51],[80,80,80],[105,105,105],[130,130,130],[190,190,190],[255,255,255]];v.default=d})(Ai);var La={},Lo={},Io={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m,x){return typeof x>"u"||+x==0?Math.round(m):(m=+m,x=+x,isNaN(m)||!(typeof x=="number"&&x%1===0)?NaN:(m=m.toString().split("e"),m=Math.round(+(m[0]+"e"+(m[1]?+m[1]-x:-x))),m=m.toString().split("e"),+(m[0]+"e"+(m[1]?+m[1]+x:x))))};v.default=d})(Io);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=y(Io);function y(x){return x&&x.__esModule?x:{default:x}}var m=function(g,b,f,n,o){var a=f.length,t=f[0].length;if(g<0||g>1)throw new Error("t out of bounds [0,1]: "+g);if(b<1)throw new Error("degree must be at least 1 (linear)");if(b>a-1)throw new Error("degree must be less than or equal to point count - 1");if(!o){o=[];for(var i=0;i<a;i++)o[i]=1}if(n){if(n.length!==a+b+1)throw new Error("bad knot vector length")}else{n=[];for(var r=0;r<a+b+1;r++)n[r]=r}var e=[b,n.length-1-b],l=n[e[0]],s=n[e[1]];g=g*(s-l)+l,g=Math.max(g,l),g=Math.min(g,s);var c;for(c=e[0];c<e[1]&&!(g>=n[c]&&g<=n[c+1]);c++);for(var u=[],h=0;h<a;h++){u[h]=[];for(var p=0;p<t;p++)u[h][p]=f[h][p]*o[h];u[h][t]=o[h]}for(var _,w=1;w<=b+1;w++)for(var S=c;S>c-b-1+w;S--){_=(g-n[S])/(n[S+b+1-w]-n[S]);for(var C=0;C<t+1;C++)u[S][C]=(1-_)*u[S-1][C]+_*u[S][C]}for(var E=[],k=0;k<t;k++)E[k]=(0,d.default)(u[c][k]/u[c][t],-9);return E};v.default=m})(Lo);var Fo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=Vr,y=function(x,g,b,f){f||(f=5);var n,o,a;b<0?(n=Math.atan(-b)*4,o=new d.V2(x[0],x[1]),a=new d.V2(g[0],g[1])):(n=Math.atan(b)*4,o=new d.V2(g[0],g[1]),a=new d.V2(x[0],x[1]));var t=a.sub(o),i=t.length(),r=o.add(t.multiply(.5)),e=Math.abs(i/2/Math.tan(n/2)),l=t.norm(),s;if(n<Math.PI){var c=new d.V2(l.x*Math.cos(Math.PI/2)-l.y*Math.sin(Math.PI/2),l.y*Math.cos(Math.PI/2)+l.x*Math.sin(Math.PI/2));s=r.add(c.multiply(-e))}else{var u=new d.V2(l.x*Math.cos(Math.PI/2)-l.y*Math.sin(Math.PI/2),l.y*Math.cos(Math.PI/2)+l.x*Math.sin(Math.PI/2));s=r.add(u.multiply(e))}var h=Math.atan2(a.y-s.y,a.x-s.x)/Math.PI*180,p=Math.atan2(o.y-s.y,o.x-s.x)/Math.PI*180;p<h&&(p+=360);for(var _=a.sub(s).length(),w=Math.floor(h/f)*f+f,S=Math.ceil(p/f)*f-f,C=[],E=w;E<=S;E+=f)C.push(s.add(new d.V2(Math.cos(E/180*Math.PI)*_,Math.sin(E/180*Math.PI)*_)));return b<0&&C.reverse(),C.map(function(k){return[k.x,k.y]})};v.default=y})(Fo);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.interpolateBSpline=v.default=void 0;var d=x(Lo),y=x(Gt),m=x(Fo);function x(o){return o&&o.__esModule?o:{default:o}}var g=function(a,t){return a.map(function(i){return[i[0]*Math.cos(t)-i[1]*Math.sin(t),i[1]*Math.cos(t)+i[0]*Math.sin(t)]})},b=function(a,t,i,r,e,l,s){l<e&&(l+=Math.PI*2);for(var c=[],u=Math.PI*2/72,h=1e-6,p=e;p<l-h;p+=u)c.push([Math.cos(p)*i,Math.sin(p)*r]);return c.push([Math.cos(l)*i,Math.sin(l)*r]),s&&(c=g(c,s)),c=c.map(function(_){return[a+_[0],t+_[1]]}),c},f=function(a,t,i,r,e){for(var l=[],s=a.map(function(O){return[O.x,O.y]}),c=[i[t]],u=[i[t],i[i.length-1-t]],h=t+1;h<i.length-t;++h)c[c.length-1]!==i[h]&&c.push(i[h]);r=r||25;for(var p=1;p<c.length;++p)for(var _=c[p-1],w=c[p],S=0;S<=r;++S){var C=S/r*(w-_)+_,E=(C-u[0])/(u[1]-u[0]);E=Math.max(E,0),E=Math.min(E,1);var k=(0,d.default)(E,t,s,i,e);l.push(k)}return l};v.interpolateBSpline=f;var n=function(a,t){t=t||{};var i;if(a.type==="LINE"&&(i=[[a.start.x,a.start.y],[a.end.x,a.end.y]]),(a.type==="LWPOLYLINE"||a.type==="POLYLINE")&&(i=[],!(a.polygonMesh||a.polyfaceMesh)))if(a.vertices.length){a.closed&&(a.vertices=a.vertices.concat(a.vertices[0]));for(var r=0,e=a.vertices.length;r<e-1;++r){var l=[a.vertices[r].x,a.vertices[r].y],s=[a.vertices[r+1].x,a.vertices[r+1].y];i.push(l),a.vertices[r].bulge&&(i=i.concat((0,m.default)(l,s,a.vertices[r].bulge))),r===e-2&&i.push(s)}}else y.default.warn("Polyline entity with no vertices");if(a.type==="CIRCLE"&&(i=b(a.x,a.y,a.r,a.r,0,Math.PI*2),a.extrusionZ===-1&&(i=i.map(function(p){return[-p[0],p[1]]}))),a.type==="ELLIPSE"){var c=Math.sqrt(a.majorX*a.majorX+a.majorY*a.majorY),u=a.axisRatio*c,h=-Math.atan2(-a.majorY,a.majorX);i=b(a.x,a.y,c,u,a.startAngle,a.endAngle,h),a.extrusionZ===-1&&(i=i.map(function(p){return[-p[0],p[1]]}))}return a.type==="ARC"&&(i=b(a.x,a.y,a.r,a.r,a.startAngle,a.endAngle,void 0),a.extrusionZ===-1&&(i=i.map(function(p){return[-p[0],p[1]]}))),a.type==="SPLINE"&&(i=f(a.controlPoints,a.degree,a.knots,t.interpolationsPerSplineSegment,a.weights)),i||(y.default.warn("unsupported entity for converting to polyline:",a.type),[])};v.default=n})(La);var Bo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m,x){return x.forEach(function(g){m=m.map(function(b){var f=[b[0],b[1]];if(g.scaleX&&(f[0]=f[0]*g.scaleX),g.scaleY&&(f[1]=f[1]*g.scaleY),g.rotation){var n=g.rotation/180*Math.PI;f=[f[0]*Math.cos(n)-f[1]*Math.sin(n),f[1]*Math.cos(n)+f[0]*Math.sin(n)]}return g.x&&(f[0]=f[0]+g.x),g.y&&(f[1]=f[1]+g.y),g.extrusionZ===-1&&(f[0]=-f[0]),f})}),m};v.default=d})(Bo);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=Vr,y=f(Ai),m=f(Yr),x=f(La),g=f(Bo),b=f(Gt);function f(o){return o&&o.__esModule?o:{default:o}}var n=function(a){var t=(0,m.default)(a),i=t.map(function(e){var l=a.tables.layers[e.layer],s;if(l){var c="colorNumber"in e?e.colorNumber:l.colorNumber;s=y.default[c],s===void 0&&(b.default.warn("Color index",c,"invalid, defaulting to black"),s=[0,0,0])}else b.default.warn("no layer table for layer:"+e.layer),s=[0,0,0];return{rgb:s,vertices:(0,g.default)((0,x.default)(e),e.transforms)}}),r=new d.Box2;return i.forEach(function(e){e.vertices.forEach(function(l){r.expandByPoint({x:l[0],y:l[1]})})}),{bbox:r,polylines:i}};v.default=n})(Da);var Ia={},No={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=m(Ai),y=m(Gt);function m(g){return g&&g.__esModule?g:{default:g}}var x=function(b,f){var n=b[f.layer];if(n){var o="colorNumber"in f&&f.colorNumber!==256,a=o?f.colorNumber:n.colorNumber,t=d.default[a];return t||(y.default.warn("Color index",a,"invalid, defaulting to black"),[0,0,0])}else return y.default.warn("no layer table for layer:"+f.layer),[0,0,0]};v.default=x})(No);var zo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m,x){return{x:m.x*Math.cos(x)-m.y*Math.sin(x),y:m.y*Math.cos(x)+m.x*Math.sin(x)}};v.default=d})(zo);var jo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m){return m[0]===255&&m[1]===255&&m[2]===255?"rgb(0, 0, 0)":"rgb(".concat(m[0],", ").concat(m[1],", ").concat(m[2],")")};v.default=d})(jo);var Ho={},Go={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=function(m,x,g,b){for(var f=g,n=x,o=x.length,a=0,t=!1,i=0;i<o+m;i++)if(b>f[i]&&b<=f[i+1]){a=i,t=!0;break}if(!t)throw new Error("invalid new knot");for(var r=[],e=0;e<o+m+1;e++)e<=a?r[e]=f[e]:e===a+1?r[e]=b:r[e]=f[e-1];for(var l,s=[],c=0;c<o+1;c++)c<=a-m+1?l=1:a-m+2<=c&&c<=a?f[c+m-1]-f[c]===0?l=0:l=(b-f[c])/(f[c+m-1]-f[c]):l=0,l===0?s[c]=n[c-1]:l===1?s[c]=n[c]:s[c]={x:(1-l)*n[c-1].x+l*n[c].x,y:(1-l)*n[c-1].y+l*n[c].y};return{controlPoints:s,knots:r}};v.default=d})(Go);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.multiplicity=v.default=v.computeInsertions=v.checkPinned=void 0;var d=y(Go);function y(f){return f&&f.__esModule?f:{default:f}}var m=function(n,o){for(var a=1;a<n;++a)if(o[a]!==o[0])throw Error("not pinned. order: ".concat(n," knots: ").concat(o));for(var t=o.length-2;t>o.length-n-1;--t)if(o[t]!==o[o.length-1])throw Error("not pinned. order: ".concat(n," knots: ").concat(o))};v.checkPinned=m;var x=function(n,o){for(var a=1,t=o+1;t<n.length&&n[t]===n[o];++t)++a;return a};v.multiplicity=x;var g=function(n,o){for(var a=[],t=n;t<o.length-n;){for(var i=o[t],r=x(o,t),e=0;e<n-r-1;++e)a.push(i);t=t+r}return a};v.computeInsertions=g;var b=function(n,o,a){m(n,a);var t=g(n,a);return t.reduce(function(i,r){return(0,d.default)(n,i.controlPoints,i.knots,r)},{controlPoints:o,knots:a})};v.default=b})(Ho);var Wo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=Vr;function y(o,a){return f(o)||b(o,a)||x(o,a)||m()}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(o,a){if(o){if(typeof o=="string")return g(o,a);var t=Object.prototype.toString.call(o).slice(8,-1);if(t==="Object"&&o.constructor&&(t=o.constructor.name),t==="Map"||t==="Set")return Array.from(o);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return g(o,a)}}function g(o,a){(a==null||a>o.length)&&(a=o.length);for(var t=0,i=new Array(a);t<a;t++)i[t]=o[t];return i}function b(o,a){var t=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(t!=null){var i,r,e,l,s=[],c=!0,u=!1;try{if(e=(t=t.call(o)).next,a===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(i=e.call(t)).done)&&(s.push(i.value),s.length!==a);c=!0);}catch(h){u=!0,r=h}finally{try{if(!c&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw r}}return s}}function f(o){if(Array.isArray(o))return o}var n=function(a,t,i){var r="",e=i.map(function(c){var u=c.x||0,h=c.y||0,p=c.scaleX||1,_=c.scaleY||1,w=(c.rotation||0)/180*Math.PI,S=Math.cos,C=Math.sin,E,k,O,U,F,M;return c.extrusionZ===-1?(E=-p*S(w),k=p*C(w),O=_*C(w),U=_*S(w),F=-u,M=h):(E=p*S(w),k=p*C(w),O=-_*C(w),U=_*S(w),F=u,M=h),[E,k,O,U,F,M]}),l=new d.Box2;if(a.valid){var s=[{x:a.min.x,y:a.min.y},{x:a.max.x,y:a.min.y},{x:a.max.x,y:a.max.y},{x:a.min.x,y:a.max.y}];e.forEach(function(c){var u=y(c,6),h=u[0],p=u[1],_=u[2],w=u[3],S=u[4],C=u[5];s=s.map(function(E){return{x:E.x*h+E.y*_+S,y:E.x*p+E.y*w+C}})}),l=s.reduce(function(c,u){return c.expandByPoint(u)},new d.Box2)}return e.reverse(),e.forEach(function(c){var u=y(c,6),h=u[0],p=u[1],_=u[2],w=u[3],S=u[4],C=u[5];r+='<g transform="matrix('.concat(h," ").concat(p," ").concat(_," ").concat(w," ").concat(S," ").concat(C,')">')}),r+=t,e.forEach(function(c){r+="</g>"}),{bbox:l,element:r}};v.default=n})(Wo);(function(v){function d(j){"@babel/helpers - typeof";return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},d(j)}Object.defineProperty(v,"__esModule",{value:!0}),v.piecewiseToPaths=v.default=void 0;var y=Vr,m=r(La),x=r(Yr),g=r(No),b=r(Gt),f=r(zo),n=r(jo),o=i(Ho),a=r(Wo);function t(j){if(typeof WeakMap!="function")return null;var G=new WeakMap,N=new WeakMap;return(t=function(A){return A?N:G})(j)}function i(j,G){if(!G&&j&&j.__esModule)return j;if(j===null||d(j)!=="object"&&typeof j!="function")return{default:j};var N=t(G);if(N&&N.has(j))return N.get(j);var R={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in j)if(H!=="default"&&Object.prototype.hasOwnProperty.call(j,H)){var Z=A?Object.getOwnPropertyDescriptor(j,H):null;Z&&(Z.get||Z.set)?Object.defineProperty(R,H,Z):R[H]=j[H]}return R.default=j,N&&N.set(j,R),R}function r(j){return j&&j.__esModule?j:{default:j}}function e(j,G){return h(j)||u(j,G)||s(j,G)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(j,G){if(j){if(typeof j=="string")return c(j,G);var N=Object.prototype.toString.call(j).slice(8,-1);if(N==="Object"&&j.constructor&&(N=j.constructor.name),N==="Map"||N==="Set")return Array.from(j);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return c(j,G)}}function c(j,G){(G==null||G>j.length)&&(G=j.length);for(var N=0,R=new Array(G);N<G;N++)R[N]=j[N];return R}function u(j,G){var N=j==null?null:typeof Symbol<"u"&&j[Symbol.iterator]||j["@@iterator"];if(N!=null){var R,A,H,Z,K=[],J=!0,D=!1;try{if(H=(N=N.call(j)).next,G===0){if(Object(N)!==N)return;J=!1}else for(;!(J=(R=H.call(N)).done)&&(K.push(R.value),K.length!==G);J=!0);}catch(I){D=!0,A=I}finally{try{if(!J&&N.return!=null&&(Z=N.return(),Object(Z)!==Z))return}finally{if(D)throw A}}return K}}function h(j){if(Array.isArray(j))return j}var p=function(G,N){var R=N.bbox,A=N.element;return G.extrusionZ===-1?{bbox:new y.Box2().expandByPoint({x:-R.min.x,y:R.min.y}).expandByPoint({x:-R.max.x,y:R.max.y}),element:'<g transform="matrix(-1 0 0 1 0 0)">\n        '.concat(A,"\n      </g>")}:{bbox:R,element:A}},_=function(G){var N=(0,m.default)(G),R=N.reduce(function(H,Z){var K=e(Z,2),J=K[0],D=K[1];return H.expandByPoint({x:J,y:D})},new y.Box2),A=N.reduce(function(H,Z,K){return H+=K===0?"M":"L",H+=Z[0]+","+Z[1],H},"");return(0,a.default)(R,'<path d="'.concat(A,'" />'),G.transforms)},w=function(G){var N=new y.Box2().expandByPoint({x:G.x+G.r,y:G.y+G.r}).expandByPoint({x:G.x-G.r,y:G.y-G.r}),R='<circle cx="'.concat(G.x,'" cy="').concat(G.y,'" r="').concat(G.r,'" />'),A=p(G,{bbox:N,element:R}),H=A.bbox,Z=A.element;return(0,a.default)(H,Z,G.transforms)},S=function(G,N,R,A,H,Z,K,J){var D=Math.sqrt(R*R+A*A),I=H*D,W=-Math.atan2(-A,R),q=C(G,N,R,A,H,Z,K);if(Math.abs(Z-K)<1e-9||Math.abs(Z-K+Math.PI*2)<1e-9){var ne='<g transform="rotate('.concat(W/Math.PI*180," ").concat(G,", ").concat(N,')">\n      <ellipse cx="').concat(G,'" cy="').concat(N,'" rx="').concat(D,'" ry="').concat(I,'" />\n    </g>');return{bbox:q,element:ne}}else{var le=(0,f.default)({x:Math.cos(Z)*D,y:Math.sin(Z)*I},W),ce={x:G+le.x,y:N+le.y},fe=(0,f.default)({x:Math.cos(K)*D,y:Math.sin(K)*I},W),he={x:G+fe.x,y:N+fe.y},se=K<Z?K+Math.PI*2:K,ie=se-Z<Math.PI?0:1,Q="M ".concat(ce.x," ").concat(ce.y," A ").concat(D," ").concat(I," ").concat(W/Math.PI*180," ").concat(ie," 1 ").concat(he.x," ").concat(he.y),re='<path d="'.concat(Q,'" />');return{bbox:q,element:re}}},C=function(G,N,R,A,H,Z,K,J){for(;Z<0;)Z+=Math.PI*2;for(;K<=Z;)K+=Math.PI*2;var D=[];if(Math.abs(R)<1e-12||Math.abs(A)<1e-12)for(var I=0;I<4;I++)D.push(I/2*Math.PI);else D[0]=Math.atan(-A*H/R)-Math.PI,D[1]=Math.atan(R*H/A)-Math.PI,D[2]=D[0]-Math.PI,D[3]=D[1]-Math.PI;for(var W=4;W>=0;W--){for(;D[W]<Z;)D[W]+=Math.PI*2;D[W]>K&&D.splice(W,1)}D.push(Z),D.push(K);var q=D.map(function(fe){return{x:Math.cos(fe),y:Math.sin(fe)}}),ne=[[R,-A*H],[A,R*H]],le=q.map(function(fe){return{x:fe.x*ne[0][0]+fe.y*ne[0][1]+G,y:fe.x*ne[1][0]+fe.y*ne[1][1]+N}}),ce=le.reduce(function(fe,he){return fe.expandByPoint(he),fe},new y.Box2);return ce},E=function(G){var N=S(G.x,G.y,G.majorX,G.majorY,G.axisRatio,G.startAngle,G.endAngle),R=N.bbox,A=N.element,H=p(G,{bbox:R,element:A}),Z=H.bbox,K=H.element;return(0,a.default)(Z,K,G.transforms)},k=function(G){var N=S(G.x,G.y,G.r,0,1,G.startAngle,G.endAngle,G.extrusionZ===-1),R=N.bbox,A=N.element,H=p(G,{bbox:R,element:A}),Z=H.bbox,K=H.element;return(0,a.default)(Z,K,G.transforms)},O=function(G,N,R){for(var A=[],H=0,Z=G;Z<N.length-G+1;){var K=(0,o.multiplicity)(N,Z),J=R.slice(H,H+G);G===4?A.push('<path d="M '.concat(J[0].x," ").concat(J[0].y," C ").concat(J[1].x," ").concat(J[1].y," ").concat(J[2].x," ").concat(J[2].y," ").concat(J[3].x," ").concat(J[3].y,'" />')):G===3&&A.push('<path d="M '.concat(J[0].x," ").concat(J[0].y," Q ").concat(J[1].x," ").concat(J[1].y," ").concat(J[2].x," ").concat(J[2].y,'" />')),H+=K,Z+=K}return A};v.piecewiseToPaths=O;var U=function(G){var N=new y.Box2;G.controlPoints.forEach(function(K){N=N.expandByPoint(K)});var R=G.degree+1,A=(0,o.default)(R,G.controlPoints,G.knots),H=O(R,A.knots,A.controlPoints),Z="<g>".concat(H.join(""),"</g>");return(0,a.default)(N,Z,G.transforms)},F=function(G){switch(G.type){case"CIRCLE":return w(G);case"ELLIPSE":return E(G);case"ARC":return k(G);case"SPLINE":{var N=G.weights&&G.weights.some(function(R){return R!==1});if((G.degree===2||G.degree===3)&&!N)try{return U(G)}catch(R){return _(G)}else return _(G)}case"LINE":case"LWPOLYLINE":case"POLYLINE":return _(G);default:return b.default.warn("entity type not supported in SVG rendering:",G.type),null}},M=function(G){var N=(0,x.default)(G),R=N.reduce(function(K,J,D){var I=(0,g.default)(G.tables.layers,J),W=F(J);if(W){var q=W.bbox,ne=W.element;q.valid&&(K.bbox.expandByPoint(q.min),K.bbox.expandByPoint(q.max)),K.elements.push('<g stroke="'.concat((0,n.default)(I),'">').concat(ne,"</g>"))}return K},{bbox:new y.Box2,elements:[]}),A=R.bbox,H=R.elements,Z=A.valid?{x:A.min.x,y:-A.max.y,width:A.max.x-A.min.x,height:A.max.y-A.min.y}:{x:0,y:0,width:0,height:0};return'<?xml version="1.0"?>\n<svg\n  xmlns="http://www.w3.org/2000/svg"\n  xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\n  preserveAspectRatio="xMinYMin meet"\n  viewBox="'.concat(Z.x," ").concat(Z.y," ").concat(Z.width," ").concat(Z.height,'"\n  width="100%" height="100%"\n>\n  <g stroke="#000000" stroke-width="0.1%" fill="none" transform="matrix(1,0,0,-1,0,0)">\n    ').concat(H.join("\n"),"\n  </g>\n</svg>")};v.default=M})(Ia);var Yo={};(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var d=f(Gt),y=f(ba),m=f(Yr),x=f(Ia),g=f(Da),b=f(Ra);function f(l){return l&&l.__esModule?l:{default:l}}function n(l){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},n(l)}function o(l,s){if(!(l instanceof s))throw new TypeError("Cannot call a class as a function")}function a(l,s){for(var c=0;c<s.length;c++){var u=s[c];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(l,i(u.key),u)}}function t(l,s,c){return s&&a(l.prototype,s),c&&a(l,c),Object.defineProperty(l,"prototype",{writable:!1}),l}function i(l){var s=r(l,"string");return n(s)==="symbol"?s:String(s)}function r(l,s){if(n(l)!=="object"||l===null)return l;var c=l[Symbol.toPrimitive];if(c!==void 0){var u=c.call(l,s||"default");if(n(u)!=="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(l)}var e=function(){function l(s){if(o(this,l),typeof s!="string")throw Error("Helper constructor expects a DXF string");this._contents=s,this._parsed=null,this._denormalised=null}return t(l,[{key:"parse",value:function(){return this._parsed=(0,y.default)(this._contents),d.default.info("parsed:",this.parsed),this._parsed}},{key:"parsed",get:function(){return this._parsed===null&&this.parse(),this._parsed}},{key:"denormalise",value:function(){return this._denormalised=(0,m.default)(this.parsed),d.default.info("denormalised:",this._denormalised),this._denormalised}},{key:"denormalised",get:function(){return this._denormalised||this.denormalise(),this._denormalised}},{key:"group",value:function(){this._groups=(0,b.default)(this.denormalised)}},{key:"groups",get:function(){return this._groups||this.group(),this._groups}},{key:"toSVG",value:function(){return(0,x.default)(this.parsed)}},{key:"toPolylines",value:function(){return(0,g.default)(this.parsed)}}]),l}();v.default=e})(Yo);(function(v){Object.defineProperty(v,"__esModule",{value:!0}),Object.defineProperty(v,"Helper",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(v,"colors",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(v,"config",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(v,"denormalise",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(v,"groupEntitiesByLayer",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(v,"parseString",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(v,"toPolylines",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(v,"toSVG",{enumerable:!0,get:function(){return b.default}});var d=o(va),y=o(ba),m=o(Yr),x=o(Ra),g=o(Da),b=o(Ia),f=o(Ai),n=o(Yo);function o(a){return a&&a.__esModule?a:{default:a}}})(Ns);function jt(v){if(typeof v!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(v))}function On(v,d){for(var y="",m=0,x=-1,g=0,b,f=0;f<=v.length;++f){if(f<v.length)b=v.charCodeAt(f);else{if(b===47)break;b=47}if(b===47){if(!(x===f-1||g===1))if(x!==f-1&&g===2){if(y.length<2||m!==2||y.charCodeAt(y.length-1)!==46||y.charCodeAt(y.length-2)!==46){if(y.length>2){var n=y.lastIndexOf("/");if(n!==y.length-1){n===-1?(y="",m=0):(y=y.slice(0,n),m=y.length-1-y.lastIndexOf("/")),x=f,g=0;continue}}else if(y.length===2||y.length===1){y="",m=0,x=f,g=0;continue}}d&&(y.length>0?y+="/..":y="..",m=2)}else y.length>0?y+="/"+v.slice(x+1,f):y=v.slice(x+1,f),m=f-x-1;x=f,g=0}else b===46&&g!==-1?++g:g=-1}return y}function s1(v,d){var y=d.dir||d.root,m=d.base||(d.name||"")+(d.ext||"");return y?y===d.root?y+m:y+v+m:m}var xr={resolve:function(){for(var d="",y=!1,m,x=arguments.length-1;x>=-1&&!y;x--){var g;x>=0?g=arguments[x]:(m===void 0&&(m=process.cwd()),g=m),jt(g),g.length!==0&&(d=g+"/"+d,y=g.charCodeAt(0)===47)}return d=On(d,!y),y?d.length>0?"/"+d:"/":d.length>0?d:"."},normalize:function(d){if(jt(d),d.length===0)return".";var y=d.charCodeAt(0)===47,m=d.charCodeAt(d.length-1)===47;return d=On(d,!y),d.length===0&&!y&&(d="."),d.length>0&&m&&(d+="/"),y?"/"+d:d},isAbsolute:function(d){return jt(d),d.length>0&&d.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var d,y=0;y<arguments.length;++y){var m=arguments[y];jt(m),m.length>0&&(d===void 0?d=m:d+="/"+m)}return d===void 0?".":xr.normalize(d)},relative:function(d,y){if(jt(d),jt(y),d===y||(d=xr.resolve(d),y=xr.resolve(y),d===y))return"";for(var m=1;m<d.length&&d.charCodeAt(m)===47;++m);for(var x=d.length,g=x-m,b=1;b<y.length&&y.charCodeAt(b)===47;++b);for(var f=y.length,n=f-b,o=g<n?g:n,a=-1,t=0;t<=o;++t){if(t===o){if(n>o){if(y.charCodeAt(b+t)===47)return y.slice(b+t+1);if(t===0)return y.slice(b+t)}else g>o&&(d.charCodeAt(m+t)===47?a=t:t===0&&(a=0));break}var i=d.charCodeAt(m+t),r=y.charCodeAt(b+t);if(i!==r)break;i===47&&(a=t)}var e="";for(t=m+a+1;t<=x;++t)(t===x||d.charCodeAt(t)===47)&&(e.length===0?e+="..":e+="/..");return e.length>0?e+y.slice(b+a):(b+=a,y.charCodeAt(b)===47&&++b,y.slice(b))},_makeLong:function(d){return d},dirname:function(d){if(jt(d),d.length===0)return".";for(var y=d.charCodeAt(0),m=y===47,x=-1,g=!0,b=d.length-1;b>=1;--b)if(y=d.charCodeAt(b),y===47){if(!g){x=b;break}}else g=!1;return x===-1?m?"/":".":m&&x===1?"//":d.slice(0,x)},basename:function(d,y){if(y!==void 0&&typeof y!="string")throw new TypeError('"ext" argument must be a string');jt(d);var m=0,x=-1,g=!0,b;if(y!==void 0&&y.length>0&&y.length<=d.length){if(y.length===d.length&&y===d)return"";var f=y.length-1,n=-1;for(b=d.length-1;b>=0;--b){var o=d.charCodeAt(b);if(o===47){if(!g){m=b+1;break}}else n===-1&&(g=!1,n=b+1),f>=0&&(o===y.charCodeAt(f)?--f===-1&&(x=b):(f=-1,x=n))}return m===x?x=n:x===-1&&(x=d.length),d.slice(m,x)}else{for(b=d.length-1;b>=0;--b)if(d.charCodeAt(b)===47){if(!g){m=b+1;break}}else x===-1&&(g=!1,x=b+1);return x===-1?"":d.slice(m,x)}},extname:function(d){jt(d);for(var y=-1,m=0,x=-1,g=!0,b=0,f=d.length-1;f>=0;--f){var n=d.charCodeAt(f);if(n===47){if(!g){m=f+1;break}continue}x===-1&&(g=!1,x=f+1),n===46?y===-1?y=f:b!==1&&(b=1):y!==-1&&(b=-1)}return y===-1||x===-1||b===0||b===1&&y===x-1&&y===m+1?"":d.slice(y,x)},format:function(d){if(d===null||typeof d!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof d);return s1("/",d)},parse:function(d){jt(d);var y={root:"",dir:"",base:"",ext:"",name:""};if(d.length===0)return y;var m=d.charCodeAt(0),x=m===47,g;x?(y.root="/",g=1):g=0;for(var b=-1,f=0,n=-1,o=!0,a=d.length-1,t=0;a>=g;--a){if(m=d.charCodeAt(a),m===47){if(!o){f=a+1;break}continue}n===-1&&(o=!1,n=a+1),m===46?b===-1?b=a:t!==1&&(t=1):b!==-1&&(t=-1)}return b===-1||n===-1||t===0||t===1&&b===n-1&&b===f+1?n!==-1&&(f===0&&x?y.base=y.name=d.slice(1,n):y.base=y.name=d.slice(f,n)):(f===0&&x?(y.name=d.slice(1,b),y.base=d.slice(1,n)):(y.name=d.slice(f,b),y.base=d.slice(f,n)),y.ext=d.slice(b,n)),f>0?y.dir=d.slice(0,f-1):x&&(y.dir="/"),y},sep:"/",delimiter:":",win32:null,posix:null};xr.posix=xr;var o1=xr;const l1=["jpg","jpeg","gif","png","bmp","svg","dxf","webp"],ii={async openFileDialog(v=l1){var d,y;return(d=window.electron)!=null&&d.openFileDialog?(y=window.electron)==null?void 0:y.openFileDialog({filters:[{name:"file",extensions:v}]}):Sl(v)},async readFile(v){const d=yi(v)?v:v.name,y=o1.extname(d).replace(".","").toLocaleLowerCase();let m;switch(y){case"png":case"jpg":case"jpeg":case"bmp":case"gif":m=await c1(v);break;case"svg":m=await gi(v);break;case"dxf":m=await u1(v);break;default:m=await gi(v)}return m},async writeFile(v,d){var y;await((y=window.electron)==null?void 0:y.FileHelper.write(v,d))},async showSaveDialog(v={}){var y;return await((y=window.electron)==null?void 0:y.showSaveDialog(v))}},c1=v=>new Promise(async(d,y)=>{if(yi(v)){const x=await f1(v);v=new Blob([x])}const m=new FileReader;m.onload=x=>{var f;const g=(f=x.target)==null?void 0:f.result,b=new Image;b.src=g,b.onload=()=>{URL.revokeObjectURL(b.src),d(b)},b.onerror=y},m.readAsDataURL(v)}),f1=async v=>gi(v,"arraybuffer"),gi=(v,d="text")=>{var y;if(yi(v)){const m=(y=window.electron)==null?void 0:y.FileHelper;return m?d==="text"?m.read2Str(v):m.read2Buffer(v):Promise.reject("read file error. path: ".concat(v))}return new Promise(m=>{const x=new FileReader;x.onload=()=>{m(x.result)},d==="text"?x.readAsText(v):x.readAsArrayBuffer(v)})},u1=async v=>{const d=await gi(v),m=new Ns.Helper(d).toSVG();return await yl.send({method:"preProcessPath",data:{svgStr:m}})},h1=pl("files",{actions:{async uploadFile(v){const d=await this.openFileDialog(v);return d?{fileData:await this.readFile(d),file:d}:{}},openFileDialog:v=>ii.openFileDialog(v),readFile:v=>ii.readFile(v),writeFile:(v,d)=>ii.writeFile(v,d),showSaveDialog:(v={})=>ii.showSaveDialog(v)}}),d1="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjg2ODg0MjUyMzM1IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjMzODUiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTIzMS44NjY4NTggOTI0LjU1OTE5N2w5OS42MjM5NzUtMzE1LjMxNTQzMkw3Ni44OTMyNzQgMzkxLjUzNDM0OGwzMjAuNDMwOTQgMEw1MTIuMDUwMTQyIDk4LjE1ODZsMTI4LjY0MTg2OSAyOTMuMzc1NzQ3IDMwNi40MTQ3MTUgMEw3MDYuOTcxNTUzIDYwOS4wOTc0MzIgODA5LjY3NDY1NyA5MjUuODUwNjA5IDUxMy42NDM0MyA3MjcuNDA4MDAxIDIzMS44NjY4NTggOTI0LjU1OTE5N3pNNTEzLjEzNDg0NyA2ODcuODI2NTE4bDIzOC45MTg0NjEgMTU5LjA0NTMxOUw2NzAuODI2MzMyIDU5OS43NDIzNjdsMTk2LjAxNTMyNi0xNzYuNDg1NTI3TDYyMC4wOTM4OCA0MjMuMjU2ODQgNTEzLjcxMTk5MSAxODAuNjY2NzU2bC05NC44NjY2MjQgMjQyLjU5MDA4NEwxNjAuNjgzNjMyIDQyMy4yNTY4NCAzNjcuNjY3Nzc3IDU5OS4xMzQ1MjMgMjg5LjQ1NjQ4NSA4NDguMjEyMzY4IDUxMy4xMzQ4NDcgNjg3LjgyNjUxOHoiIHAtaWQ9IjMzODYiPjwvcGF0aD48L3N2Zz4=";function m1(){const v=Gr(),d=h1(),{t:y}=ca(),m=Ze(!1),x=Ze(!1),g=Ze(!1),b=Ze([{label:y("editor.line"),key:at.LINE,icon:"&#xe606;"},{label:y("editor.text"),key:at.TEXT,icon:"&#xe764;"},{label:y("editor.shape"),key:at.SHAPE,icon:"&#xe767;"},{label:y("editor.unload"),key:at.UPLOAD,icon:"&#xe765;"},{label:y("editor.undo"),key:at.UNDO,icon:"&#xe766;"},{label:y("editor.redo"),key:at.REDO,icon:"&#xe763;"}]),f=()=>{b.value=[{label:y("editor.line"),key:at.LINE,icon:"&#xe606;"},{label:y("editor.text"),key:at.TEXT,icon:"&#xe764;"},{label:y("editor.shape"),key:at.SHAPE,icon:"&#xe767;"},{label:y("editor.unload"),key:at.UPLOAD,icon:"&#xe765;"},{label:y("editor.undo"),key:at.UNDO,icon:"&#xe766;"},{label:y("editor.redo"),key:at.REDO,icon:"&#xe763;"}]},n=async e=>{var l,s,c,u,h,p;switch(r(!1),x.value=!1,e){case at.LINE:m.value=!0,(l=v.canvas())==null||l.startDrawLine();break;case at.RECT:m.value=!0,(s=v.canvas())==null||s.drawShape(e);break;case at.CIRCLE:m.value=!0,(c=v.canvas())==null||c.drawShape(e);break;case at.TEXT:m.value=!0,(u=v.canvas())==null||u.startDrawText();break;case at.SHAPE:x.value=!0;break;case at.TRIANGLE:m.value=!0,(h=v.canvas())==null||h.drawShape(e);break;case at.SVG:m.value=!0,(p=v.canvas())==null||p.startDrawSvg(d1);break;case at.UPLOAD:if(m.value=!0,vl||bl)gl("openAlbum",{},_=>{const w=JSON.parse(_);(w.code==="0"||w.albumAuthority==="0")&&Qt(y("device.blue.openAlbumPermis"))});else{const{fileData:_}=await d.uploadFile();_&&i(_)}break;case at.UNDO:m.value=!0,o();break;case at.REDO:m.value=!0,a();break}},o=()=>{var e;(e=v.canvas())==null||e.undo()},a=()=>{var e;(e=v.canvas())==null||e.redo()},t=e=>{if(e){const l=JSON.parse(e),s=document.createElement("img");s.src=l.image,s.width=l.width,s.height=l.height,i(s)}},i=e=>{var s,c,u;const l=(s=v.canvas())==null?void 0:s.whiteScreenData;if(yi(e))(c=v.canvas())==null||c.loadResource(e);else{const h=l.width,p=l.height,_=e.width,w=e.height;h<_||p<w?ms({title:y("common.tip"),message:y("editor.tips.unloadImgs"),confirmButtonText:y("common.confirm"),cancelButtonText:y("common.cancel")}).then(()=>{var C;const S=Math.min(h/_,p/w);(C=v.canvas())==null||C.loadResource(e,{scaleX:S,scaleY:S})}).catch(()=>{var S;(S=v.canvas())==null||S.loadResource(e)}):(u=v.canvas())==null||u.loadResource(e)}},r=e=>{var l,s;e===!0||e===!1?(g.value=e,(l=v.canvas())==null||l.setSelectable(!g.value)):(g.value=!g.value,(s=v.canvas())==null||s.setSelectable(!g.value))};return{buttons:b,isDrawing:m,isShowShapePop:x,isCanvasMoved:g,switchBtnsLan:f,handleToolClick:n,handleImage:t,handleSwitchModel:r}}var ut=(v=>(v.RECT="RECT",v.CIRCLE="CIRCLE",v.LINE="LINE",v.TEXT="TEXT",v.NONE="NONE",v.PEN="PEN",v.TRIANGLE="TRIANGLE",v.SVG="SVG",v))(ut||{}),_i=(v=>(v.MM="mm",v.INCH="in",v))(_i||{}),Tt=(v=>(v.auto="auto",v.default="default",v.none="none",v.initial="initial",v.inherit="inherit",v.contextMenu="context-menu",v.help="help",v.pointer="pointer",v.progress="progress",v.wait="wait",v.cell="cell",v.crosshair="crosshair",v.text="text",v.verticalText="vertical-text",v.alias="alias",v.copy="copy",v.move="move",v.noDrop="no-drop",v.notAllowed="not-allowed",v.allScroll="all-scroll",v.colResize="col-resize",v.rowResize="row-resize",v.nResize="n-resize",v.eResize="e-resize",v.sResize="s-resize",v.wResize="w-resize",v.neResize="ne-resize",v.nwResize="nw-resize",v.seResize="se-resize",v.swResize="sw-resize",v.ewResize="ew-resize",v.nsResize="ns-resize",v.neswResize="nesw-resize",v.nwseResize="nwse-resize",v.zoomIn="zoom-in",v.zoomOut="zoom-out",v.grab="grab",v.grabbing="grabbing",v))(Tt||{}),Xt=(v=>(v.engrave="engrave",v.fillEngrave="fillEngrave",v.cut="cut",v))(Xt||{});const Nt={engrave:"orange",fillEngrave:"#17489C",cut:"#E61F19",variableThickness:"#00FF00"},Fr="element",Dt={name:Fr,strokeWidth:1,stroke:Nt.engrave,fill:void 0,strokeUniform:!0,isLock:!1};var Ve=(v=>(v.SELECTION_CHANGE="SELECTION_CHANGE",v.ELEMENT_MODIFY="ELEMENT_MODIFY",v.SELECTION_CLEAR="SELECTION_CLEAR",v.STAGE_MOVE="CANVAS_MOVE",v.ZOOM="ZOOM",v.RESIZE="RESIZE",v.OPERATE="OPERATE",v.MOUSE_DOWN="MOUSE_DOWN",v.MOUSE_MOVE="MOUSE_MOVE",v.ZOOM_IN="ZOOM_IN",v.ZOOM_OUT="ZOOM_OUT",v.MOUSE_UP="MOUSE_UP",v.LOCK="LOCK",v.UPDATE_ELEMENT_PROPERTY="UPDATE_ELEMENT_PROPERTY",v.ADDED="ADDED",v.REMOVED="REMOVED",v.PROPERTYMANAGER="PROPERTYMANAGER",v))(Ve||{}),$t=(v=>(v.LEFT="LEFT",v.RIGHT="RIGHT",v.UP="UP",v.DOWN="DOWN",v.XCENTER="XCENTER",v.YCENTER="YCENTER",v.HCENTER="HCENTER",v.VCENTER="VCENTER",v))($t||{}),Ke=(v=>(v.rect="rect",v.line="line",v.circle="circle",v.ellipse="ellipse",v.IText="i-text",v.Text="text",v.path="path",v.polygon="polygon",v.image="image",v.group="group",v))(Ke||{});const p1=["id","left","top","width","height","angle","fill","flipX","flipY","scaleX","scaleY","skewX","skewY","stroke","strokeWidth","type","name","strokeUniform","isLock","originStroke","hasBezierControl","isVariableThickness"],Mn={hoverBorderColor:"#1dd2ca",borderColor:Nt.engrave},Bt="activeSelection";var Fa={exports:{}},Sr=typeof Reflect=="object"?Reflect:null,Pn=Sr&&typeof Sr.apply=="function"?Sr.apply:function(d,y,m){return Function.prototype.apply.call(d,y,m)},ci;Sr&&typeof Sr.ownKeys=="function"?ci=Sr.ownKeys:Object.getOwnPropertySymbols?ci=function(d){return Object.getOwnPropertyNames(d).concat(Object.getOwnPropertySymbols(d))}:ci=function(d){return Object.getOwnPropertyNames(d)};function v1(v){console&&console.warn&&console.warn(v)}var Xo=Number.isNaN||function(d){return d!==d};function Qe(){Qe.init.call(this)}Fa.exports=Qe;Fa.exports.once=y1;Qe.EventEmitter=Qe;Qe.prototype._events=void 0;Qe.prototype._eventsCount=0;Qe.prototype._maxListeners=void 0;var Rn=10;function Oi(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)}Object.defineProperty(Qe,"defaultMaxListeners",{enumerable:!0,get:function(){return Rn},set:function(v){if(typeof v!="number"||v<0||Xo(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");Rn=v}});Qe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Qe.prototype.setMaxListeners=function(d){if(typeof d!="number"||d<0||Xo(d))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+d+".");return this._maxListeners=d,this};function $o(v){return v._maxListeners===void 0?Qe.defaultMaxListeners:v._maxListeners}Qe.prototype.getMaxListeners=function(){return $o(this)};Qe.prototype.emit=function(d){for(var y=[],m=1;m<arguments.length;m++)y.push(arguments[m]);var x=d==="error",g=this._events;if(g!==void 0)x=x&&g.error===void 0;else if(!x)return!1;if(x){var b;if(y.length>0&&(b=y[0]),b instanceof Error)throw b;var f=new Error("Unhandled error."+(b?" ("+b.message+")":""));throw f.context=b,f}var n=g[d];if(n===void 0)return!1;if(typeof n=="function")Pn(n,this,y);else for(var o=n.length,a=Qo(n,o),m=0;m<o;++m)Pn(a[m],this,y);return!0};function Vo(v,d,y,m){var x,g,b;if(Oi(y),g=v._events,g===void 0?(g=v._events=Object.create(null),v._eventsCount=0):(g.newListener!==void 0&&(v.emit("newListener",d,y.listener?y.listener:y),g=v._events),b=g[d]),b===void 0)b=g[d]=y,++v._eventsCount;else if(typeof b=="function"?b=g[d]=m?[y,b]:[b,y]:m?b.unshift(y):b.push(y),x=$o(v),x>0&&b.length>x&&!b.warned){b.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(d)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=v,f.type=d,f.count=b.length,v1(f)}return v}Qe.prototype.addListener=function(d,y){return Vo(this,d,y,!1)};Qe.prototype.on=Qe.prototype.addListener;Qe.prototype.prependListener=function(d,y){return Vo(this,d,y,!0)};function b1(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zo(v,d,y){var m={fired:!1,wrapFn:void 0,target:v,type:d,listener:y},x=b1.bind(m);return x.listener=y,m.wrapFn=x,x}Qe.prototype.once=function(d,y){return Oi(y),this.on(d,Zo(this,d,y)),this};Qe.prototype.prependOnceListener=function(d,y){return Oi(y),this.prependListener(d,Zo(this,d,y)),this};Qe.prototype.removeListener=function(d,y){var m,x,g,b,f;if(Oi(y),x=this._events,x===void 0)return this;if(m=x[d],m===void 0)return this;if(m===y||m.listener===y)--this._eventsCount===0?this._events=Object.create(null):(delete x[d],x.removeListener&&this.emit("removeListener",d,m.listener||y));else if(typeof m!="function"){for(g=-1,b=m.length-1;b>=0;b--)if(m[b]===y||m[b].listener===y){f=m[b].listener,g=b;break}if(g<0)return this;g===0?m.shift():g1(m,g),m.length===1&&(x[d]=m[0]),x.removeListener!==void 0&&this.emit("removeListener",d,f||y)}return this};Qe.prototype.off=Qe.prototype.removeListener;Qe.prototype.removeAllListeners=function(d){var y,m,x;if(m=this._events,m===void 0)return this;if(m.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):m[d]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete m[d]),this;if(arguments.length===0){var g=Object.keys(m),b;for(x=0;x<g.length;++x)b=g[x],b!=="removeListener"&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(y=m[d],typeof y=="function")this.removeListener(d,y);else if(y!==void 0)for(x=y.length-1;x>=0;x--)this.removeListener(d,y[x]);return this};function qo(v,d,y){var m=v._events;if(m===void 0)return[];var x=m[d];return x===void 0?[]:typeof x=="function"?y?[x.listener||x]:[x]:y?_1(x):Qo(x,x.length)}Qe.prototype.listeners=function(d){return qo(this,d,!0)};Qe.prototype.rawListeners=function(d){return qo(this,d,!1)};Qe.listenerCount=function(v,d){return typeof v.listenerCount=="function"?v.listenerCount(d):Ko.call(v,d)};Qe.prototype.listenerCount=Ko;function Ko(v){var d=this._events;if(d!==void 0){var y=d[v];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}Qe.prototype.eventNames=function(){return this._eventsCount>0?ci(this._events):[]};function Qo(v,d){for(var y=new Array(d),m=0;m<d;++m)y[m]=v[m];return y}function g1(v,d){for(;d+1<v.length;d++)v[d]=v[d+1];v.pop()}function _1(v){for(var d=new Array(v.length),y=0;y<d.length;++y)d[y]=v[y].listener||v[y];return d}function y1(v,d){return new Promise(function(y,m){function x(b){v.removeListener(d,g),m(b)}function g(){typeof v.removeListener=="function"&&v.removeListener("error",x),y([].slice.call(arguments))}Jo(v,d,g,{once:!0}),d!=="error"&&w1(v,x,{once:!0})})}function w1(v,d,y){typeof v.on=="function"&&Jo(v,"error",d,y)}function Jo(v,d,y,m){if(typeof v.on=="function")m.once?v.once(d,y):v.on(d,y);else if(typeof v.addEventListener=="function")v.addEventListener(d,function x(g){m.once&&v.removeEventListener(d,x),y(g)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof v)}var x1=Fa.exports,Me={};const S1={},C1=Object.freeze(Object.defineProperty({__proto__:null,default:S1},Symbol.toStringTag,{value:"Module"})),Bi=wl(C1);(function(v){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var d=d||{version:"5.3.0"};if(v.fabric=d,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?d.document=document:d.document=document.implementation.createHTMLDocument(""),d.window=window;else{var y=Bi,m=new y.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;d.document=m.document,d.jsdomImplForWrapper=Bi.implForWrapper,d.nodeCanvas=Bi.Canvas,d.window=m,DOMParser=d.window.DOMParser}d.isTouchSupported="ontouchstart"in d.window||"ontouchstart"in d.document||d.window&&d.window.navigator&&d.window.navigator.maxTouchPoints>0,d.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",d.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],d.DPI=96,d.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",d.commaWsp="(?:\\s+,?\\s*|,\\s*)",d.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,d.reNonWord=/[ \n\.,;!\?\-]/,d.fontPaths={},d.iMatrix=[1,0,0,1,0,0],d.svgNS="http://www.w3.org/2000/svg",d.perfLimitSizeTotal=2097152,d.maxCacheSideLimit=4096,d.minCacheSideLimit=256,d.charWidthsCache={},d.textureSize=2048,d.disableStyleCopyPaste=!1,d.enableGLFiltering=!0,d.devicePixelRatio=d.window.devicePixelRatio||d.window.webkitDevicePixelRatio||d.window.mozDevicePixelRatio||1,d.browserShadowBlurConstant=1,d.arcToSegmentsCache={},d.boundsOfCurveCache={},d.cachesBoundsOfCurve=!0,d.forceGLPutImageData=!1,d.initFilterBackend=function(){if(d.enableGLFiltering&&d.isWebglSupported&&d.isWebglSupported(d.textureSize))return console.log("max texture size: "+d.maxTextureSize),new d.WebglFilterBackend({tileSize:d.textureSize});if(d.Canvas2dFilterBackend)return new d.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=d),function(){function f(r,e){if(this.__eventListeners[r]){var l=this.__eventListeners[r];e?l[l.indexOf(e)]=!1:d.util.array.fill(l,!1)}}function n(r,e){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var l in r)this.on(l,r[l]);else this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(e);return this}function o(r,e){var l=(function(){e.apply(this,arguments),this.off(r,l)}).bind(this);this.on(r,l)}function a(r,e){if(arguments.length===1)for(var l in r)o.call(this,l,r[l]);else o.call(this,r,e);return this}function t(r,e){if(!this.__eventListeners)return this;if(arguments.length===0)for(r in this.__eventListeners)f.call(this,r);else if(arguments.length===1&&typeof arguments[0]=="object")for(var l in r)f.call(this,l,r[l]);else f.call(this,r,e);return this}function i(r,e){if(!this.__eventListeners)return this;var l=this.__eventListeners[r];if(!l)return this;for(var s=0,c=l.length;s<c;s++)l[s]&&l[s].call(this,e||{});return this.__eventListeners[r]=l.filter(function(u){return u!==!1}),this}d.Observable={fire:i,on:n,once:a,off:t}}(),d.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var f=0,n=arguments.length;f<n;f++)this._onObjectAdded(arguments[f]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(f,n,o){var a=this._objects;return o?a[n]=f:a.splice(n,0,f),this._onObjectAdded&&this._onObjectAdded(f),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var f=this._objects,n,o=!1,a=0,t=arguments.length;a<t;a++)n=f.indexOf(arguments[a]),n!==-1&&(o=!0,f.splice(n,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[a]));return this.renderOnAddRemove&&o&&this.requestRenderAll(),this},forEachObject:function(f,n){for(var o=this.getObjects(),a=0,t=o.length;a<t;a++)f.call(n,o[a],a,o);return this},getObjects:function(f){return typeof f>"u"?this._objects.concat():this._objects.filter(function(n){return n.type===f})},item:function(f){return this._objects[f]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(f,n){return this._objects.indexOf(f)>-1?!0:n?this._objects.some(function(o){return typeof o.contains=="function"&&o.contains(f,!0)}):!1},complexity:function(){return this._objects.reduce(function(f,n){return f+=n.complexity?n.complexity():0,f},0)}},d.CommonMethods={_setOptions:function(f){for(var n in f)this.set(n,f[n])},_initGradient:function(f,n){f&&f.colorStops&&!(f instanceof d.Gradient)&&this.set(n,new d.Gradient(f))},_initPattern:function(f,n,o){f&&f.source&&!(f instanceof d.Pattern)?this.set(n,new d.Pattern(f,o)):o&&o()},_setObject:function(f){for(var n in f)this._set(n,f[n])},set:function(f,n){return typeof f=="object"?this._setObject(f):this._set(f,n),this},_set:function(f,n){this[f]=n},toggle:function(f){var n=this.get(f);return typeof n=="boolean"&&this.set(f,!n),this},get:function(f){return this[f]}},function(f){var n=Math.sqrt,o=Math.atan2,a=Math.pow,t=Math.PI/180,i=Math.PI/2;d.util={cos:function(r){if(r===0)return 1;r<0&&(r=-r);var e=r/i;switch(e){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},sin:function(r){if(r===0)return 0;var e=r/i,l=1;switch(r<0&&(l=-1),e){case 1:return l;case 2:return 0;case 3:return-l}return Math.sin(r)},removeFromArray:function(r,e){var l=r.indexOf(e);return l!==-1&&r.splice(l,1),r},getRandomInt:function(r,e){return Math.floor(Math.random()*(e-r+1))+r},degreesToRadians:function(r){return r*t},radiansToDegrees:function(r){return r/t},rotatePoint:function(r,e,l){var s=new d.Point(r.x-e.x,r.y-e.y),c=d.util.rotateVector(s,l);return new d.Point(c.x,c.y).addEquals(e)},rotateVector:function(r,e){var l=d.util.sin(e),s=d.util.cos(e),c=r.x*s-r.y*l,u=r.x*l+r.y*s;return{x:c,y:u}},createVector:function(r,e){return new d.Point(e.x-r.x,e.y-r.y)},calcAngleBetweenVectors:function(r,e){return Math.acos((r.x*e.x+r.y*e.y)/(Math.hypot(r.x,r.y)*Math.hypot(e.x,e.y)))},getHatVector:function(r){return new d.Point(r.x,r.y).multiply(1/Math.hypot(r.x,r.y))},getBisector:function(r,e,l){var s=d.util.createVector(r,e),c=d.util.createVector(r,l),u=d.util.calcAngleBetweenVectors(s,c),h=d.util.calcAngleBetweenVectors(d.util.rotateVector(s,u),c),p=u*(h===0?1:-1)/2;return{vector:d.util.getHatVector(d.util.rotateVector(s,p)),angle:u}},projectStrokeOnPoints:function(r,e,l){var s=[],c=e.strokeWidth/2,u=e.strokeUniform?new d.Point(1/e.scaleX,1/e.scaleY):new d.Point(1,1),h=function(p){var _=c/Math.hypot(p.x,p.y);return new d.Point(p.x*_*u.x,p.y*_*u.y)};return r.length<=1||r.forEach(function(p,_){var w=new d.Point(p.x,p.y),S,C;_===0?(C=r[_+1],S=l?h(d.util.createVector(C,w)).addEquals(w):r[r.length-1]):_===r.length-1?(S=r[_-1],C=l?h(d.util.createVector(S,w)).addEquals(w):r[0]):(S=r[_-1],C=r[_+1]);var E=d.util.getBisector(w,S,C),k=E.vector,O=E.angle,U,F;if(e.strokeLineJoin==="miter"&&(U=-c/Math.sin(O/2),F=new d.Point(k.x*U*u.x,k.y*U*u.y),Math.hypot(F.x,F.y)/c<=e.strokeMiterLimit)){s.push(w.add(F)),s.push(w.subtract(F));return}U=-c*Math.SQRT2,F=new d.Point(k.x*U*u.x,k.y*U*u.y),s.push(w.add(F)),s.push(w.subtract(F))}),s},transformPoint:function(r,e,l){return l?new d.Point(e[0]*r.x+e[2]*r.y,e[1]*r.x+e[3]*r.y):new d.Point(e[0]*r.x+e[2]*r.y+e[4],e[1]*r.x+e[3]*r.y+e[5])},makeBoundingBoxFromPoints:function(r,e){if(e)for(var l=0;l<r.length;l++)r[l]=d.util.transformPoint(r[l],e);var s=[r[0].x,r[1].x,r[2].x,r[3].x],c=d.util.array.min(s),u=d.util.array.max(s),h=u-c,p=[r[0].y,r[1].y,r[2].y,r[3].y],_=d.util.array.min(p),w=d.util.array.max(p),S=w-_;return{left:c,top:_,width:h,height:S}},invertTransform:function(r){var e=1/(r[0]*r[3]-r[1]*r[2]),l=[e*r[3],-e*r[1],-e*r[2],e*r[0]],s=d.util.transformPoint({x:r[4],y:r[5]},l,!0);return l[4]=-s.x,l[5]=-s.y,l},toFixed:function(r,e){return parseFloat(Number(r).toFixed(e))},parseUnit:function(r,e){var l=/\D{0,2}$/.exec(r),s=parseFloat(r);switch(e||(e=d.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return s*d.DPI/25.4;case"cm":return s*d.DPI/2.54;case"in":return s*d.DPI;case"pt":return s*d.DPI/72;case"pc":return s*d.DPI/72*12;case"em":return s*e;default:return s}},falseFunction:function(){return!1},getKlass:function(r,e){return r=d.util.string.camelize(r.charAt(0).toUpperCase()+r.slice(1)),d.util.resolveNamespace(e)[r]},getSvgAttributes:function(r){var e=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"]);break}return e},resolveNamespace:function(r){if(!r)return d;var e=r.split("."),l=e.length,s,c=f||d.window;for(s=0;s<l;++s)c=c[e[s]];return c},loadImage:function(r,e,l,s){if(!r){e&&e.call(l,r);return}var c=d.util.createImage(),u=function(){e&&e.call(l,c,!1),c=c.onload=c.onerror=null};c.onload=u,c.onerror=function(){d.log("Error loading "+c.src),e&&e.call(l,null,!0),c=c.onload=c.onerror=null},r.indexOf("data")!==0&&s!==void 0&&s!==null&&(c.crossOrigin=s),r.substring(0,14)==="data:image/svg"&&(c.onload=null,d.util.loadImageInDom(c,u)),c.src=r},loadImageInDom:function(r,e){var l=d.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(r),d.document.querySelector("body").appendChild(l),r.onload=function(){e(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(r,e,l,s){r=r||[];var c=[],u=0,h=r.length;function p(){++u===h&&e&&e(c.filter(function(_){return _}))}if(!h){e&&e(c);return}r.forEach(function(_,w){if(!_||!_.type){p();return}var S=d.util.getKlass(_.type,l);S.fromObject(_,function(C,E){E||(c[w]=C),s&&s(_,C,E),p()})})},enlivenObjectEnlivables:function(r,e,l){var s=d.Object.ENLIVEN_PROPS.filter(function(c){return!!r[c]});d.util.enlivenObjects(s.map(function(c){return r[c]}),function(c){var u={};s.forEach(function(h,p){u[h]=c[p],e&&(e[h]=c[p])}),l&&l(u)})},enlivenPatterns:function(r,e){r=r||[];function l(){++c===u&&e&&e(s)}var s=[],c=0,u=r.length;if(!u){e&&e(s);return}r.forEach(function(h,p){h&&h.source?new d.Pattern(h,function(_){s[p]=_,l()}):(s[p]=h,l())})},groupSVGElements:function(r,e,l){var s;return r&&r.length===1?(typeof l<"u"&&(r[0].sourcePath=l),r[0]):(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),s=new d.Group(r,e),typeof l<"u"&&(s.sourcePath=l),s)},populateWithProperties:function(r,e,l){if(l&&Array.isArray(l))for(var s=0,c=l.length;s<c;s++)l[s]in r&&(e[l[s]]=r[l[s]])},createCanvasElement:function(){return d.document.createElement("canvas")},copyCanvasElement:function(r){var e=d.util.createCanvasElement();return e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0),e},toDataURL:function(r,e,l){return r.toDataURL("image/"+e,l)},createImage:function(){return d.document.createElement("img")},multiplyTransformMatrices:function(r,e,l){return[r[0]*e[0]+r[2]*e[1],r[1]*e[0]+r[3]*e[1],r[0]*e[2]+r[2]*e[3],r[1]*e[2]+r[3]*e[3],l?0:r[0]*e[4]+r[2]*e[5]+r[4],l?0:r[1]*e[4]+r[3]*e[5]+r[5]]},qrDecompose:function(r){var e=o(r[1],r[0]),l=a(r[0],2)+a(r[1],2),s=n(l),c=(r[0]*r[3]-r[2]*r[1])/s,u=o(r[0]*r[2]+r[1]*r[3],l);return{angle:e/t,scaleX:s,scaleY:c,skewX:u/t,skewY:0,translateX:r[4],translateY:r[5]}},calcRotateMatrix:function(r){if(!r.angle)return d.iMatrix.concat();var e=d.util.degreesToRadians(r.angle),l=d.util.cos(e),s=d.util.sin(e);return[l,s,-s,l,0,0]},calcDimensionsMatrix:function(r){var e=typeof r.scaleX>"u"?1:r.scaleX,l=typeof r.scaleY>"u"?1:r.scaleY,s=[r.flipX?-e:e,0,0,r.flipY?-l:l,0,0],c=d.util.multiplyTransformMatrices,u=d.util.degreesToRadians;return r.skewX&&(s=c(s,[1,0,Math.tan(u(r.skewX)),1],!0)),r.skewY&&(s=c(s,[1,Math.tan(u(r.skewY)),0,1],!0)),s},composeMatrix:function(r){var e=[1,0,0,1,r.translateX||0,r.translateY||0],l=d.util.multiplyTransformMatrices;return r.angle&&(e=l(e,d.util.calcRotateMatrix(r))),(r.scaleX!==1||r.scaleY!==1||r.skewX||r.skewY||r.flipX||r.flipY)&&(e=l(e,d.util.calcDimensionsMatrix(r))),e},resetObjectTransform:function(r){r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},saveObjectTransform:function(r){return{scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}},isTransparent:function(r,e,l,s){s>0&&(e>s?e-=s:e=0,l>s?l-=s:l=0);var c=!0,u,h,p=r.getImageData(e,l,s*2||1,s*2||1),_=p.data.length;for(u=3;u<_&&(h=p.data[u],c=h<=0,c!==!1);u+=4);return p=null,c},parsePreserveAspectRatioAttribute:function(r){var e="meet",l="Mid",s="Mid",c=r.split(" "),u;return c&&c.length&&(e=c.pop(),e!=="meet"&&e!=="slice"?(u=e,e="meet"):c.length&&(u=c.pop())),l=u!=="none"?u.slice(1,4):"none",s=u!=="none"?u.slice(5,8):"none",{meetOrSlice:e,alignX:l,alignY:s}},clearFabricFontCache:function(r){r=(r||"").toLowerCase(),r?d.charWidthsCache[r]&&delete d.charWidthsCache[r]:d.charWidthsCache={}},limitDimsByArea:function(r,e){var l=Math.sqrt(e*r),s=Math.floor(e/l);return{x:Math.floor(l),y:s}},capValue:function(r,e,l){return Math.max(r,Math.min(e,l))},findScaleToFit:function(r,e){return Math.min(e.width/r.width,e.height/r.height)},findScaleToCover:function(r,e){return Math.max(e.width/r.width,e.height/r.height)},matrixToSVG:function(r){return"matrix("+r.map(function(e){return d.util.toFixed(e,d.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(r,e){var l=d.util.invertTransform(e),s=d.util.multiplyTransformMatrices(l,r.calcOwnMatrix());d.util.applyTransformToObject(r,s)},addTransformToObject:function(r,e){d.util.applyTransformToObject(r,d.util.multiplyTransformMatrices(e,r.calcOwnMatrix()))},applyTransformToObject:function(r,e){var l=d.util.qrDecompose(e),s=new d.Point(l.translateX,l.translateY);r.flipX=!1,r.flipY=!1,r.set("scaleX",l.scaleX),r.set("scaleY",l.scaleY),r.skewX=l.skewX,r.skewY=l.skewY,r.angle=l.angle,r.setPositionByOrigin(s,"center","center")},sizeAfterTransform:function(r,e,l){var s=r/2,c=e/2,u=[{x:-s,y:-c},{x:s,y:-c},{x:-s,y:c},{x:s,y:c}],h=d.util.calcDimensionsMatrix(l),p=d.util.makeBoundingBoxFromPoints(u,h);return{x:p.width,y:p.height}},mergeClipPaths:function(r,e){var l=r,s=e;l.inverted&&!s.inverted&&(l=e,s=r),d.util.applyTransformToObject(s,d.util.multiplyTransformMatrices(d.util.invertTransform(l.calcTransformMatrix()),s.calcTransformMatrix()));var c=l.inverted&&s.inverted;return c&&(l.inverted=s.inverted=!1),new d.Group([l],{clipPath:s,inverted:c})},hasStyleChanged:function(r,e,l){return l=l||!1,r.fill!==e.fill||r.stroke!==e.stroke||r.strokeWidth!==e.strokeWidth||r.fontSize!==e.fontSize||r.fontFamily!==e.fontFamily||r.fontWeight!==e.fontWeight||r.fontStyle!==e.fontStyle||r.textBackgroundColor!==e.textBackgroundColor||r.deltaY!==e.deltaY||l&&(r.overline!==e.overline||r.underline!==e.underline||r.linethrough!==e.linethrough)},stylesToArray:function(l,e){for(var l=d.util.object.clone(l,!0),s=e.split("\n"),c=-1,u={},h=[],p=0;p<s.length;p++){if(!l[p]){c+=s[p].length;continue}for(var _=0;_<s[p].length;_++){c++;var w=l[p][_];if(w&&Object.keys(w).length>0){var S=d.util.hasStyleChanged(u,w,!0);S?h.push({start:c,end:c+1,style:w}):h[h.length-1].end++}u=w||{}}}return h},stylesFromArray:function(r,e){if(!Array.isArray(r))return r;for(var l=e.split("\n"),s=-1,c=0,u={},h=0;h<l.length;h++)for(var p=0;p<l[h].length;p++)s++,r[c]&&r[c].start<=s&&s<r[c].end&&(u[h]=u[h]||{},u[h][p]=Object.assign({},r[c].style),s===r[c].end-1&&c++);return u}}}(v),function(){var f=Array.prototype.join,n={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},o={m:"l",M:"L"};function a(A,H,Z,K,J,D,I,W,q,ne,le){var ce=d.util.cos(A),fe=d.util.sin(A),he=d.util.cos(H),se=d.util.sin(H),ie=Z*J*he-K*D*se+I,Q=K*J*he+Z*D*se+W,re=ne+q*(-Z*J*fe-K*D*ce),te=le+q*(-K*J*fe+Z*D*ce),V=ie+q*(Z*J*se+K*D*he),z=Q+q*(K*J*se-Z*D*he);return["C",re,te,V,z,ie,Q]}function t(A,H,Z,K,J,D,I){var W=Math.PI,q=I*W/180,ne=d.util.sin(q),le=d.util.cos(q),ce=0,fe=0;Z=Math.abs(Z),K=Math.abs(K);var he=-le*A*.5-ne*H*.5,se=-le*H*.5+ne*A*.5,ie=Z*Z,Q=K*K,re=se*se,te=he*he,V=ie*Q-ie*re-Q*te,z=0;if(V<0){var B=Math.sqrt(1-V/(ie*Q));Z*=B,K*=B}else z=(J===D?-1:1)*Math.sqrt(V/(ie*re+Q*te));var ee=z*Z*se/K,Y=-z*K*he/Z,L=le*ee-ne*Y+A*.5,P=ne*ee+le*Y+H*.5,ae=i(1,0,(he-ee)/Z,(se-Y)/K),ue=i((he-ee)/Z,(se-Y)/K,(-he-ee)/Z,(-se-Y)/K);D===0&&ue>0?ue-=2*W:D===1&&ue<0&&(ue+=2*W);for(var ve=Math.ceil(Math.abs(ue/W*2)),_e=[],Te=ue/ve,Re=8/3*Math.sin(Te/4)*Math.sin(Te/4)/Math.sin(Te/2),Le=ae+Te,Se=0;Se<ve;Se++)_e[Se]=a(ae,Le,le,ne,Z,K,L,P,Re,ce,fe),ce=_e[Se][5],fe=_e[Se][6],ae=Le,Le+=Te;return _e}function i(A,H,Z,K){var J=Math.atan2(H,A),D=Math.atan2(K,Z);return D>=J?D-J:2*Math.PI-(J-D)}function r(A,H,Z,K,J,D,I,W){var q;if(d.cachesBoundsOfCurve&&(q=f.call(arguments),d.boundsOfCurveCache[q]))return d.boundsOfCurveCache[q];var ne=Math.sqrt,le=Math.min,ce=Math.max,fe=Math.abs,he=[],se=[[],[]],ie,Q,re,te,V,z,B,ee;Q=6*A-12*Z+6*J,ie=-3*A+9*Z-9*J+3*I,re=3*Z-3*A;for(var Y=0;Y<2;++Y){if(Y>0&&(Q=6*H-12*K+6*D,ie=-3*H+9*K-9*D+3*W,re=3*K-3*H),fe(ie)<1e-12){if(fe(Q)<1e-12)continue;te=-re/Q,0<te&&te<1&&he.push(te);continue}B=Q*Q-4*re*ie,!(B<0)&&(ee=ne(B),V=(-Q+ee)/(2*ie),0<V&&V<1&&he.push(V),z=(-Q-ee)/(2*ie),0<z&&z<1&&he.push(z))}for(var L,P,ae=he.length,ue=ae,ve;ae--;)te=he[ae],ve=1-te,L=ve*ve*ve*A+3*ve*ve*te*Z+3*ve*te*te*J+te*te*te*I,se[0][ae]=L,P=ve*ve*ve*H+3*ve*ve*te*K+3*ve*te*te*D+te*te*te*W,se[1][ae]=P;se[0][ue]=A,se[1][ue]=H,se[0][ue+1]=I,se[1][ue+1]=W;var _e=[{x:le.apply(null,se[0]),y:le.apply(null,se[1])},{x:ce.apply(null,se[0]),y:ce.apply(null,se[1])}];return d.cachesBoundsOfCurve&&(d.boundsOfCurveCache[q]=_e),_e}function e(A,H,Z){for(var K=Z[1],J=Z[2],D=Z[3],I=Z[4],W=Z[5],q=Z[6],ne=Z[7],le=t(q-A,ne-H,K,J,I,W,D),ce=0,fe=le.length;ce<fe;ce++)le[ce][1]+=A,le[ce][2]+=H,le[ce][3]+=A,le[ce][4]+=H,le[ce][5]+=A,le[ce][6]+=H;return le}function l(A){var H=0,Z=0,K=A.length,J=0,D=0,I,W,q,ne=[],le,ce,fe;for(W=0;W<K;++W){switch(q=!1,I=A[W].slice(0),I[0]){case"l":I[0]="L",I[1]+=H,I[2]+=Z;case"L":H=I[1],Z=I[2];break;case"h":I[1]+=H;case"H":I[0]="L",I[2]=Z,H=I[1];break;case"v":I[1]+=Z;case"V":I[0]="L",Z=I[1],I[1]=H,I[2]=Z;break;case"m":I[0]="M",I[1]+=H,I[2]+=Z;case"M":H=I[1],Z=I[2],J=I[1],D=I[2];break;case"c":I[0]="C",I[1]+=H,I[2]+=Z,I[3]+=H,I[4]+=Z,I[5]+=H,I[6]+=Z;case"C":ce=I[3],fe=I[4],H=I[5],Z=I[6];break;case"s":I[0]="S",I[1]+=H,I[2]+=Z,I[3]+=H,I[4]+=Z;case"S":le==="C"?(ce=2*H-ce,fe=2*Z-fe):(ce=H,fe=Z),H=I[3],Z=I[4],I[0]="C",I[5]=I[3],I[6]=I[4],I[3]=I[1],I[4]=I[2],I[1]=ce,I[2]=fe,ce=I[3],fe=I[4];break;case"q":I[0]="Q",I[1]+=H,I[2]+=Z,I[3]+=H,I[4]+=Z;case"Q":ce=I[1],fe=I[2],H=I[3],Z=I[4];break;case"t":I[0]="T",I[1]+=H,I[2]+=Z;case"T":le==="Q"?(ce=2*H-ce,fe=2*Z-fe):(ce=H,fe=Z),I[0]="Q",H=I[1],Z=I[2],I[1]=ce,I[2]=fe,I[3]=H,I[4]=Z;break;case"a":I[0]="A",I[6]+=H,I[7]+=Z;case"A":q=!0,ne=ne.concat(e(H,Z,I)),H=I[6],Z=I[7];break;case"z":case"Z":H=J,Z=D;break}q||ne.push(I),le=I[0]}return ne}function s(A,H,Z,K){return Math.sqrt((Z-A)*(Z-A)+(K-H)*(K-H))}function c(A){return A*A*A}function u(A){return 3*A*A*(1-A)}function h(A){return 3*A*(1-A)*(1-A)}function p(A){return(1-A)*(1-A)*(1-A)}function _(A,H,Z,K,J,D,I,W){return function(q){var ne=c(q),le=u(q),ce=h(q),fe=p(q);return{x:I*ne+J*le+Z*ce+A*fe,y:W*ne+D*le+K*ce+H*fe}}}function w(A,H,Z,K,J,D,I,W){return function(q){var ne=1-q,le=3*ne*ne*(Z-A)+6*ne*q*(J-Z)+3*q*q*(I-J),ce=3*ne*ne*(K-H)+6*ne*q*(D-K)+3*q*q*(W-D);return Math.atan2(ce,le)}}function S(A){return A*A}function C(A){return 2*A*(1-A)}function E(A){return(1-A)*(1-A)}function k(A,H,Z,K,J,D){return function(I){var W=S(I),q=C(I),ne=E(I);return{x:J*W+Z*q+A*ne,y:D*W+K*q+H*ne}}}function O(A,H,Z,K,J,D){return function(I){var W=1-I,q=2*W*(Z-A)+2*I*(J-Z),ne=2*W*(K-H)+2*I*(D-K);return Math.atan2(ne,q)}}function U(A,H,Z){var K={x:H,y:Z},J,D=0,I;for(I=1;I<=100;I+=1)J=A(I/100),D+=s(K.x,K.y,J.x,J.y),K=J;return D}function F(A,H){for(var Z=0,K=0,J=A.iterator,D={x:A.x,y:A.y},I,W,q=.01,ne=A.angleFinder,le;K<H&&q>1e-4;)I=J(Z),le=Z,W=s(D.x,D.y,I.x,I.y),W+K>H?(Z-=q,q/=2):(D=I,Z+=q,K+=W);return I.angle=ne(le),I}function M(A){for(var H=0,Z=A.length,K,J=0,D=0,I=0,W=0,q=[],ne,le,ce,fe=0;fe<Z;fe++){switch(K=A[fe],le={x:J,y:D,command:K[0]},K[0]){case"M":le.length=0,I=J=K[1],W=D=K[2];break;case"L":le.length=s(J,D,K[1],K[2]),J=K[1],D=K[2];break;case"C":ne=_(J,D,K[1],K[2],K[3],K[4],K[5],K[6]),ce=w(J,D,K[1],K[2],K[3],K[4],K[5],K[6]),le.iterator=ne,le.angleFinder=ce,le.length=U(ne,J,D),J=K[5],D=K[6];break;case"Q":ne=k(J,D,K[1],K[2],K[3],K[4]),ce=O(J,D,K[1],K[2],K[3],K[4]),le.iterator=ne,le.angleFinder=ce,le.length=U(ne,J,D),J=K[3],D=K[4];break;case"Z":case"z":le.destX=I,le.destY=W,le.length=s(J,D,I,W),J=I,D=W;break}H+=le.length,q.push(le)}return q.push({length:H,x:J,y:D}),q}function j(A,H,Z){Z||(Z=M(A));for(var K=0;H-Z[K].length>0&&K<Z.length-2;)H-=Z[K].length,K++;var J=Z[K],D=H/J.length,I=J.command,W=A[K],q;switch(I){case"M":return{x:J.x,y:J.y,angle:0};case"Z":case"z":return q=new d.Point(J.x,J.y).lerp(new d.Point(J.destX,J.destY),D),q.angle=Math.atan2(J.destY-J.y,J.destX-J.x),q;case"L":return q=new d.Point(J.x,J.y).lerp(new d.Point(W[1],W[2]),D),q.angle=Math.atan2(W[2]-J.y,W[1]-J.x),q;case"C":return F(J,H);case"Q":return F(J,H)}}function G(A){var H=[],Z=[],K,J,D=d.rePathCommand,I="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",W="("+I+")"+d.commaWsp,q="([01])"+d.commaWsp+"?",ne=W+"?"+W+"?"+W+q+q+W+"?("+I+")",le=new RegExp(ne,"g"),ce,fe,he;if(!A||!A.match)return H;he=A.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var se=0,ie,Q=he.length;se<Q;se++){K=he[se],fe=K.slice(1).trim(),Z.length=0;var re=K.charAt(0);if(ie=[re],re.toLowerCase()==="a")for(var te;te=le.exec(fe);)for(var V=1;V<te.length;V++)Z.push(te[V]);else for(;ce=D.exec(fe);)Z.push(ce[0]);for(var V=0,z=Z.length;V<z;V++)J=parseFloat(Z[V]),isNaN(J)||ie.push(J);var B=n[re.toLowerCase()],ee=o[re]||re;if(ie.length-1>B)for(var Y=1,L=ie.length;Y<L;Y+=B)H.push([re].concat(ie.slice(Y,Y+B))),re=ee;else H.push(ie)}return H}function N(A,H){var Z=[],K,J=new d.Point(A[0].x,A[0].y),D=new d.Point(A[1].x,A[1].y),I=A.length,W=1,q=0,ne=I>2;for(H=H||0,ne&&(W=A[2].x<D.x?-1:A[2].x===D.x?0:1,q=A[2].y<D.y?-1:A[2].y===D.y?0:1),Z.push(["M",J.x-W*H,J.y-q*H]),K=1;K<I;K++){if(!J.eq(D)){var le=J.midPointFrom(D);Z.push(["Q",J.x,J.y,le.x,le.y])}J=A[K],K+1<A.length&&(D=A[K+1])}return ne&&(W=J.x>A[K-2].x?1:J.x===A[K-2].x?0:-1,q=J.y>A[K-2].y?1:J.y===A[K-2].y?0:-1),Z.push(["L",J.x+W*H,J.y+q*H]),Z}function R(A,H,Z){return Z&&(H=d.util.multiplyTransformMatrices(H,[1,0,0,1,-Z.x,-Z.y])),A.map(function(K){for(var J=K.slice(0),D={},I=1;I<K.length-1;I+=2)D.x=K[I],D.y=K[I+1],D=d.util.transformPoint(D,H),J[I]=D.x,J[I+1]=D.y;return J})}d.util.joinPath=function(A){return A.map(function(H){return H.join(" ")}).join(" ")},d.util.parsePath=G,d.util.makePathSimpler=l,d.util.getSmoothPathFromPoints=N,d.util.getPathSegmentsInfo=M,d.util.getBoundsOfCurve=r,d.util.getPointOnPath=j,d.util.transformPath=R}(),function(){var f=Array.prototype.slice;function n(r,e){for(var l=f.call(arguments,2),s=[],c=0,u=r.length;c<u;c++)s[c]=l.length?r[c][e].apply(r[c],l):r[c][e].call(r[c]);return s}function o(r,e){return i(r,e,function(l,s){return l>=s})}function a(r,e){return i(r,e,function(l,s){return l<s})}function t(r,e){for(var l=r.length;l--;)r[l]=e;return r}function i(r,e,l){if(!(!r||r.length===0)){var s=r.length-1,c=e?r[s][e]:r[s];if(e)for(;s--;)l(r[s][e],c)&&(c=r[s][e]);else for(;s--;)l(r[s],c)&&(c=r[s]);return c}}d.util.array={fill:t,invoke:n,min:a,max:o}}(),function(){function f(o,a,t){if(t)if(!d.isLikelyNode&&a instanceof Element)o=a;else if(a instanceof Array){o=[];for(var i=0,r=a.length;i<r;i++)o[i]=f({},a[i],t)}else if(a&&typeof a=="object")for(var e in a)e==="canvas"||e==="group"?o[e]=null:a.hasOwnProperty(e)&&(o[e]=f({},a[e],t));else o=a;else for(var e in a)o[e]=a[e];return o}function n(o,a){return f({},o,a)}d.util.object={extend:f,clone:n},d.util.object.extend(d.util,d.Observable)}(),function(){function f(i){return i.replace(/-+(.)?/g,function(r,e){return e?e.toUpperCase():""})}function n(i,r){return i.charAt(0).toUpperCase()+(r?i.slice(1):i.slice(1).toLowerCase())}function o(i){return i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function a(i){var r=0,e,l=[];for(r=0,e;r<i.length;r++)(e=t(i,r))!==!1&&l.push(e);return l}function t(i,r){var e=i.charCodeAt(r);if(isNaN(e))return"";if(e<55296||e>57343)return i.charAt(r);if(55296<=e&&e<=56319){if(i.length<=r+1)throw"High surrogate without following low surrogate";var l=i.charCodeAt(r+1);if(56320>l||l>57343)throw"High surrogate without following low surrogate";return i.charAt(r)+i.charAt(r+1)}if(r===0)throw"Low surrogate without preceding high surrogate";var s=i.charCodeAt(r-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1}d.util.string={camelize:f,capitalize:n,escapeXml:o,graphemeSplit:a}}(),function(){var f=Array.prototype.slice,n=function(){},o=function(){for(var e in{toString:1})if(e==="toString")return!1;return!0}(),a=function(e,l,s){for(var c in l)c in e.prototype&&typeof e.prototype[c]=="function"&&(l[c]+"").indexOf("callSuper")>-1?e.prototype[c]=function(u){return function(){var h=this.constructor.superclass;this.constructor.superclass=s;var p=l[u].apply(this,arguments);if(this.constructor.superclass=h,u!=="initialize")return p}}(c):e.prototype[c]=l[c],o&&(l.toString!==Object.prototype.toString&&(e.prototype.toString=l.toString),l.valueOf!==Object.prototype.valueOf&&(e.prototype.valueOf=l.valueOf))};function t(){}function i(e){for(var l=null,s=this;s.constructor.superclass;){var c=s.constructor.superclass.prototype[e];if(s[e]!==c){l=c;break}s=s.constructor.superclass.prototype}return l?arguments.length>1?l.apply(this,f.call(arguments,1)):l.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}function r(){var e=null,l=f.call(arguments,0);typeof l[0]=="function"&&(e=l.shift());function s(){this.initialize.apply(this,arguments)}s.superclass=e,s.subclasses=[],e&&(t.prototype=e.prototype,s.prototype=new t,e.subclasses.push(s));for(var c=0,u=l.length;c<u;c++)a(s,l[c],e);return s.prototype.initialize||(s.prototype.initialize=n),s.prototype.constructor=s,s.prototype.callSuper=i,s}d.util.createClass=r}(),function(){var f=!!d.document.createElement("div").attachEvent,n=["touchstart","touchmove","touchend"];d.util.addListener=function(a,t,i,r){a&&a.addEventListener(t,i,f?!1:r)},d.util.removeListener=function(a,t,i,r){a&&a.removeEventListener(t,i,f?!1:r)};function o(a){var t=a.changedTouches;return t&&t[0]?t[0]:a}d.util.getPointer=function(a){var t=a.target,i=d.util.getScrollLeftTop(t),r=o(a);return{x:r.clientX+i.left,y:r.clientY+i.top}},d.util.isTouchEvent=function(a){return n.indexOf(a.type)>-1||a.pointerType==="touch"}}(),function(){function f(r,e){var l=r.style;if(!l)return r;if(typeof e=="string")return r.style.cssText+=";"+e,e.indexOf("opacity")>-1?i(r,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):r;for(var s in e)if(s==="opacity")i(r,e[s]);else{var c=s==="float"||s==="cssFloat"?typeof l.styleFloat>"u"?"cssFloat":"styleFloat":s;l.setProperty(c,e[s])}return r}var n=d.document.createElement("div"),o=typeof n.style.opacity=="string",a=typeof n.style.filter=="string",t=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,i=function(r){return r};o?i=function(r,e){return r.style.opacity=e,r}:a&&(i=function(r,e){var l=r.style;return r.currentStyle&&!r.currentStyle.hasLayout&&(l.zoom=1),t.test(l.filter)?(e=e>=.9999?"":"alpha(opacity="+e*100+")",l.filter=l.filter.replace(t,e)):l.filter+=" alpha(opacity="+e*100+")",r}),d.util.setStyle=f}(),function(){var f=Array.prototype.slice;function n(p){return typeof p=="string"?d.document.getElementById(p):p}var o,a=function(p){return f.call(p,0)};try{o=a(d.document.childNodes)instanceof Array}catch(p){}o||(a=function(p){for(var _=new Array(p.length),w=p.length;w--;)_[w]=p[w];return _});function t(p,_){var w=d.document.createElement(p);for(var S in _)S==="class"?w.className=_[S]:S==="for"?w.htmlFor=_[S]:w.setAttribute(S,_[S]);return w}function i(p,_){p&&(" "+p.className+" ").indexOf(" "+_+" ")===-1&&(p.className+=(p.className?" ":"")+_)}function r(p,_,w){return typeof _=="string"&&(_=t(_,w)),p.parentNode&&p.parentNode.replaceChild(_,p),_.appendChild(p),_}function e(p){for(var _=0,w=0,S=d.document.documentElement,C=d.document.body||{scrollLeft:0,scrollTop:0};p&&(p.parentNode||p.host)&&(p=p.parentNode||p.host,p===d.document?(_=C.scrollLeft||S.scrollLeft||0,w=C.scrollTop||S.scrollTop||0):(_+=p.scrollLeft||0,w+=p.scrollTop||0),!(p.nodeType===1&&p.style.position==="fixed")););return{left:_,top:w}}function l(p){var _,w=p&&p.ownerDocument,S={left:0,top:0},C={left:0,top:0},E,k={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!w)return C;for(var O in k)C[k[O]]+=parseInt(s(p,O),10)||0;return _=w.documentElement,typeof p.getBoundingClientRect<"u"&&(S=p.getBoundingClientRect()),E=e(p),{left:S.left+E.left-(_.clientLeft||0)+C.left,top:S.top+E.top-(_.clientTop||0)+C.top}}var s;d.document.defaultView&&d.document.defaultView.getComputedStyle?s=function(p,_){var w=d.document.defaultView.getComputedStyle(p,null);return w?w[_]:void 0}:s=function(p,_){var w=p.style[_];return!w&&p.currentStyle&&(w=p.currentStyle[_]),w},function(){var p=d.document.documentElement.style,_="userSelect"in p?"userSelect":"MozUserSelect"in p?"MozUserSelect":"WebkitUserSelect"in p?"WebkitUserSelect":"KhtmlUserSelect"in p?"KhtmlUserSelect":"";function w(C){return typeof C.onselectstart<"u"&&(C.onselectstart=d.util.falseFunction),_?C.style[_]="none":typeof C.unselectable=="string"&&(C.unselectable="on"),C}function S(C){return typeof C.onselectstart<"u"&&(C.onselectstart=null),_?C.style[_]="":typeof C.unselectable=="string"&&(C.unselectable=""),C}d.util.makeElementUnselectable=w,d.util.makeElementSelectable=S}();function c(p){var _=d.jsdomImplForWrapper(p);return _._canvas||_._image}function u(p){if(d.isLikelyNode){var _=d.jsdomImplForWrapper(p);_&&(_._image=null,_._canvas=null,_._currentSrc=null,_._attributes=null,_._classList=null)}}function h(p,_){p.imageSmoothingEnabled=p.imageSmoothingEnabled||p.webkitImageSmoothingEnabled||p.mozImageSmoothingEnabled||p.msImageSmoothingEnabled||p.oImageSmoothingEnabled,p.imageSmoothingEnabled=_}d.util.setImageSmoothing=h,d.util.getById=n,d.util.toArray=a,d.util.addClass=i,d.util.makeElement=t,d.util.wrapElement=r,d.util.getScrollLeftTop=e,d.util.getElementOffset=l,d.util.getNodeCanvas=c,d.util.cleanUpJsdomNode=u}(),function(){function f(a,t){return a+(/\?/.test(a)?"&":"?")+t}function n(){}function o(a,t){t||(t={});var i=t.method?t.method.toUpperCase():"GET",r=t.onComplete||function(){},e=new d.window.XMLHttpRequest,l=t.body||t.parameters;return e.onreadystatechange=function(){e.readyState===4&&(r(e),e.onreadystatechange=n)},i==="GET"&&(l=null,typeof t.parameters=="string"&&(a=f(a,t.parameters))),e.open(i,a,!0),(i==="POST"||i==="PUT")&&e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(l),e}d.util.request=o}(),d.log=console.log,d.warn=console.warn,function(){var f=d.util.object.extend,n=d.util.object.clone,o=[];d.util.object.extend(o,{cancelAll:function(){var c=this.splice(0);return c.forEach(function(u){u.cancel()}),c},cancelByCanvas:function(c){if(!c)return[];var u=this.filter(function(h){return typeof h.target=="object"&&h.target.canvas===c});return u.forEach(function(h){h.cancel()}),u},cancelByTarget:function(c){var u=this.findAnimationsByTarget(c);return u.forEach(function(h){h.cancel()}),u},findAnimationIndex:function(c){return this.indexOf(this.findAnimation(c))},findAnimation:function(c){return this.find(function(u){return u.cancel===c})},findAnimationsByTarget:function(c){return c?this.filter(function(u){return u.target===c}):[]}});function a(){return!1}function t(c,u,h,p){return-h*Math.cos(c/p*(Math.PI/2))+h+u}function i(c){c||(c={});var u=!1,h,p=function(){var _=d.runningAnimations.indexOf(h);return _>-1&&d.runningAnimations.splice(_,1)[0]};return h=f(n(c),{cancel:function(){return u=!0,p()},currentValue:"startValue"in c?c.startValue:0,completionRate:0,durationRate:0}),d.runningAnimations.push(h),l(function(_){var w=_||+new Date,S=c.duration||500,C=w+S,E,k=c.onChange||a,O=c.abort||a,U=c.onComplete||a,F=c.easing||t,M="startValue"in c?c.startValue.length>0:!1,j="startValue"in c?c.startValue:0,G="endValue"in c?c.endValue:100,N=c.byValue||(M?j.map(function(R,A){return G[A]-j[A]}):G-j);c.onStart&&c.onStart(),function R(A){E=A||+new Date;var H=E>C?S:E-w,Z=H/S,K=M?j.map(function(D,I){return F(H,j[I],N[I],S)}):F(H,j,N,S),J=Math.abs(M?(K[0]-j[0])/N[0]:(K-j)/N);if(h.currentValue=M?K.slice():K,h.completionRate=J,h.durationRate=Z,!u){if(O(K,J,Z)){p();return}if(E>C){h.currentValue=M?G.slice():G,h.completionRate=1,h.durationRate=1,k(M?G.slice():G,1,1),U(G,1,1),p();return}else k(K,J,Z),l(R)}}(w)}),h.cancel}var r=d.window.requestAnimationFrame||d.window.webkitRequestAnimationFrame||d.window.mozRequestAnimationFrame||d.window.oRequestAnimationFrame||d.window.msRequestAnimationFrame||function(c){return d.window.setTimeout(c,1e3/60)},e=d.window.cancelAnimationFrame||d.window.clearTimeout;function l(){return r.apply(d.window,arguments)}function s(){return e.apply(d.window,arguments)}d.util.animate=i,d.util.requestAnimFrame=l,d.util.cancelAnimFrame=s,d.runningAnimations=o}(),function(){function f(o,a,t){var i="rgba("+parseInt(o[0]+t*(a[0]-o[0]),10)+","+parseInt(o[1]+t*(a[1]-o[1]),10)+","+parseInt(o[2]+t*(a[2]-o[2]),10);return i+=","+(o&&a?parseFloat(o[3]+t*(a[3]-o[3])):1),i+=")",i}function n(o,a,t,i){var r=new d.Color(o).getSource(),e=new d.Color(a).getSource(),l=i.onComplete,s=i.onChange;return i=i||{},d.util.animate(d.util.object.extend(i,{duration:t||500,startValue:r,endValue:e,byValue:e,easing:function(c,u,h,p){var _=i.colorEasing?i.colorEasing(c,p):1-Math.cos(c/p*(Math.PI/2));return f(u,h,_)},onComplete:function(c,u,h){if(l)return l(f(e,e,0),u,h)},onChange:function(c,u,h){if(s){if(Array.isArray(c))return s(f(c,c,0),u,h);s(c,u,h)}}}))}d.util.animateColor=n}(),function(){function f(A,H,Z,K){return A<Math.abs(H)?(A=H,K=Z/4):H===0&&A===0?K=Z/(2*Math.PI)*Math.asin(1):K=Z/(2*Math.PI)*Math.asin(H/A),{a:A,c:H,p:Z,s:K}}function n(A,H,Z){return A.a*Math.pow(2,10*(H-=1))*Math.sin((H*Z-A.s)*(2*Math.PI)/A.p)}function o(A,H,Z,K){return Z*((A=A/K-1)*A*A+1)+H}function a(A,H,Z,K){return A/=K/2,A<1?Z/2*A*A*A+H:Z/2*((A-=2)*A*A+2)+H}function t(A,H,Z,K){return Z*(A/=K)*A*A*A+H}function i(A,H,Z,K){return-Z*((A=A/K-1)*A*A*A-1)+H}function r(A,H,Z,K){return A/=K/2,A<1?Z/2*A*A*A*A+H:-Z/2*((A-=2)*A*A*A-2)+H}function e(A,H,Z,K){return Z*(A/=K)*A*A*A*A+H}function l(A,H,Z,K){return Z*((A=A/K-1)*A*A*A*A+1)+H}function s(A,H,Z,K){return A/=K/2,A<1?Z/2*A*A*A*A*A+H:Z/2*((A-=2)*A*A*A*A+2)+H}function c(A,H,Z,K){return-Z*Math.cos(A/K*(Math.PI/2))+Z+H}function u(A,H,Z,K){return Z*Math.sin(A/K*(Math.PI/2))+H}function h(A,H,Z,K){return-Z/2*(Math.cos(Math.PI*A/K)-1)+H}function p(A,H,Z,K){return A===0?H:Z*Math.pow(2,10*(A/K-1))+H}function _(A,H,Z,K){return A===K?H+Z:Z*(-Math.pow(2,-10*A/K)+1)+H}function w(A,H,Z,K){return A===0?H:A===K?H+Z:(A/=K/2,A<1?Z/2*Math.pow(2,10*(A-1))+H:Z/2*(-Math.pow(2,-10*--A)+2)+H)}function S(A,H,Z,K){return-Z*(Math.sqrt(1-(A/=K)*A)-1)+H}function C(A,H,Z,K){return Z*Math.sqrt(1-(A=A/K-1)*A)+H}function E(A,H,Z,K){return A/=K/2,A<1?-Z/2*(Math.sqrt(1-A*A)-1)+H:Z/2*(Math.sqrt(1-(A-=2)*A)+1)+H}function k(A,H,Z,K){var J=1.70158,D=0,I=Z;if(A===0)return H;if(A/=K,A===1)return H+Z;D||(D=K*.3);var W=f(I,Z,D,J);return-n(W,A,K)+H}function O(A,H,Z,K){var J=1.70158,D=0,I=Z;if(A===0)return H;if(A/=K,A===1)return H+Z;D||(D=K*.3);var W=f(I,Z,D,J);return W.a*Math.pow(2,-10*A)*Math.sin((A*K-W.s)*(2*Math.PI)/W.p)+W.c+H}function U(A,H,Z,K){var J=1.70158,D=0,I=Z;if(A===0)return H;if(A/=K/2,A===2)return H+Z;D||(D=K*(.3*1.5));var W=f(I,Z,D,J);return A<1?-.5*n(W,A,K)+H:W.a*Math.pow(2,-10*(A-=1))*Math.sin((A*K-W.s)*(2*Math.PI)/W.p)*.5+W.c+H}function F(A,H,Z,K,J){return J===void 0&&(J=1.70158),Z*(A/=K)*A*((J+1)*A-J)+H}function M(A,H,Z,K,J){return J===void 0&&(J=1.70158),Z*((A=A/K-1)*A*((J+1)*A+J)+1)+H}function j(A,H,Z,K,J){return J===void 0&&(J=1.70158),A/=K/2,A<1?Z/2*(A*A*(((J*=1.525)+1)*A-J))+H:Z/2*((A-=2)*A*(((J*=1.525)+1)*A+J)+2)+H}function G(A,H,Z,K){return Z-N(K-A,0,Z,K)+H}function N(A,H,Z,K){return(A/=K)<1/2.75?Z*(7.5625*A*A)+H:A<2/2.75?Z*(7.5625*(A-=1.5/2.75)*A+.75)+H:A<2.5/2.75?Z*(7.5625*(A-=2.25/2.75)*A+.9375)+H:Z*(7.5625*(A-=2.625/2.75)*A+.984375)+H}function R(A,H,Z,K){return A<K/2?G(A*2,0,Z,K)*.5+H:N(A*2-K,0,Z,K)*.5+Z*.5+H}d.util.ease={easeInQuad:function(A,H,Z,K){return Z*(A/=K)*A+H},easeOutQuad:function(A,H,Z,K){return-Z*(A/=K)*(A-2)+H},easeInOutQuad:function(A,H,Z,K){return A/=K/2,A<1?Z/2*A*A+H:-Z/2*(--A*(A-2)-1)+H},easeInCubic:function(A,H,Z,K){return Z*(A/=K)*A*A+H},easeOutCubic:o,easeInOutCubic:a,easeInQuart:t,easeOutQuart:i,easeInOutQuart:r,easeInQuint:e,easeOutQuint:l,easeInOutQuint:s,easeInSine:c,easeOutSine:u,easeInOutSine:h,easeInExpo:p,easeOutExpo:_,easeInOutExpo:w,easeInCirc:S,easeOutCirc:C,easeInOutCirc:E,easeInElastic:k,easeOutElastic:O,easeInOutElastic:U,easeInBack:F,easeOutBack:M,easeInOutBack:j,easeInBounce:G,easeOutBounce:N,easeInOutBounce:R}}(),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.extend,a=n.util.object.clone,t=n.util.toFixed,i=n.util.parseUnit,r=n.util.multiplyTransformMatrices,e=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],l=["symbol","image","marker","pattern","view","svg"],s=["pattern","defs","symbol","metadata","clipPath","mask","desc"],c=["symbol","g","a","svg","clipPath","defs"],u={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},h={stroke:"strokeOpacity",fill:"fillOpacity"},p="font-size",_="clip-path";n.svgValidTagNamesRegEx=C(e),n.svgViewBoxElementsRegEx=C(l),n.svgInvalidAncestorsRegEx=C(s),n.svgValidParentsRegEx=C(c),n.cssRules={},n.gradientDefs={},n.clipPaths={};function w(D){return D in u?u[D]:D}function S(D,I,W,q){var ne=Array.isArray(I),le;if((D==="fill"||D==="stroke")&&I==="none")I="";else{if(D==="strokeUniform")return I==="non-scaling-stroke";if(D==="strokeDashArray")I==="none"?I=null:I=I.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(D==="transformMatrix")W&&W.transformMatrix?I=r(W.transformMatrix,n.parseTransformAttribute(I)):I=n.parseTransformAttribute(I);else if(D==="visible")I=I!=="none"&&I!=="hidden",W&&W.visible===!1&&(I=!1);else if(D==="opacity")I=parseFloat(I),W&&typeof W.opacity<"u"&&(I*=W.opacity);else if(D==="textAnchor")I=I==="start"?"left":I==="end"?"right":"center";else if(D==="charSpacing")le=i(I,q)/q*1e3;else if(D==="paintFirst"){var ce=I.indexOf("fill"),fe=I.indexOf("stroke"),I="fill";(ce>-1&&fe>-1&&fe<ce||ce===-1&&fe>-1)&&(I="stroke")}else{if(D==="href"||D==="xlink:href"||D==="font")return I;if(D==="imageSmoothing")return I==="optimizeQuality";le=ne?I.map(i):i(I,q)}}return!ne&&isNaN(le)?I:le}function C(D){return new RegExp("^("+D.join("|")+")\\b","i")}function E(D){for(var I in h)if(!(typeof D[h[I]]>"u"||D[I]==="")){if(typeof D[I]>"u"){if(!n.Object.prototype[I])continue;D[I]=n.Object.prototype[I]}if(D[I].indexOf("url(")!==0){var W=new n.Color(D[I]);D[I]=W.setAlpha(t(W.getAlpha()*D[h[I]],2)).toRgba()}}return D}function k(D,I){var W,q=[],ne,le,ce;for(le=0,ce=I.length;le<ce;le++)W=I[le],ne=D.getElementsByTagName(W),q=q.concat(Array.prototype.slice.call(ne));return q}n.parseTransformAttribute=function(){function D(Y,L){var P=n.util.cos(L[0]),ae=n.util.sin(L[0]),ue=0,ve=0;L.length===3&&(ue=L[1],ve=L[2]),Y[0]=P,Y[1]=ae,Y[2]=-ae,Y[3]=P,Y[4]=ue-(P*ue-ae*ve),Y[5]=ve-(ae*ue+P*ve)}function I(Y,L){var P=L[0],ae=L.length===2?L[1]:L[0];Y[0]=P,Y[3]=ae}function W(Y,L,P){Y[P]=Math.tan(n.util.degreesToRadians(L[0]))}function q(Y,L){Y[4]=L[0],L.length===2&&(Y[5]=L[1])}var ne=n.iMatrix,le=n.reNum,ce=n.commaWsp,fe="(?:(skewX)\\s*\\(\\s*("+le+")\\s*\\))",he="(?:(skewY)\\s*\\(\\s*("+le+")\\s*\\))",se="(?:(rotate)\\s*\\(\\s*("+le+")(?:"+ce+"("+le+")"+ce+"("+le+"))?\\s*\\))",ie="(?:(scale)\\s*\\(\\s*("+le+")(?:"+ce+"("+le+"))?\\s*\\))",Q="(?:(translate)\\s*\\(\\s*("+le+")(?:"+ce+"("+le+"))?\\s*\\))",re="(?:(matrix)\\s*\\(\\s*("+le+")"+ce+"("+le+")"+ce+"("+le+")"+ce+"("+le+")"+ce+"("+le+")"+ce+"("+le+")\\s*\\))",te="(?:"+re+"|"+Q+"|"+ie+"|"+se+"|"+fe+"|"+he+")",V="(?:"+te+"(?:"+ce+"*"+te+")*)",z="^\\s*(?:"+V+"?)\\s*$",B=new RegExp(z),ee=new RegExp(te,"g");return function(Y){var L=ne.concat(),P=[];if(!Y||Y&&!B.test(Y))return L;Y.replace(ee,function(ue){var ve=new RegExp(te).exec(ue).filter(function(Re){return!!Re}),_e=ve[1],Te=ve.slice(2).map(parseFloat);switch(_e){case"translate":q(L,Te);break;case"rotate":Te[0]=n.util.degreesToRadians(Te[0]),D(L,Te);break;case"scale":I(L,Te);break;case"skewX":W(L,Te,2);break;case"skewY":W(L,Te,1);break;case"matrix":L=Te;break}P.push(L.concat()),L=ne.concat()});for(var ae=P[0];P.length>1;)P.shift(),ae=n.util.multiplyTransformMatrices(ae,P[0]);return ae}}();function O(D,I){var W,q;D.replace(/;\s*$/,"").split(";").forEach(function(ne){var le=ne.split(":");W=le[0].trim().toLowerCase(),q=le[1].trim(),I[W]=q})}function U(D,I){var W,q;for(var ne in D)typeof D[ne]>"u"||(W=ne.toLowerCase(),q=D[ne],I[W]=q)}function F(D,I){var W={};for(var q in n.cssRules[I])if(M(D,q.split(" ")))for(var ne in n.cssRules[I][q])W[ne]=n.cssRules[I][q][ne];return W}function M(D,I){var W,q=!0;return W=G(D,I.pop()),W&&I.length&&(q=j(D,I)),W&&q&&I.length===0}function j(D,I){for(var W,q=!0;D.parentNode&&D.parentNode.nodeType===1&&I.length;)q&&(W=I.pop()),D=D.parentNode,q=G(D,W);return I.length===0}function G(D,I){var W=D.nodeName,q=D.getAttribute("class"),ne=D.getAttribute("id"),le,ce;if(le=new RegExp("^"+W,"i"),I=I.replace(le,""),ne&&I.length&&(le=new RegExp("#"+ne+"(?![a-zA-Z\\-]+)","i"),I=I.replace(le,"")),q&&I.length)for(q=q.split(" "),ce=q.length;ce--;)le=new RegExp("\\."+q[ce]+"(?![a-zA-Z\\-]+)","i"),I=I.replace(le,"");return I.length===0}function N(D,I){var W;if(D.getElementById&&(W=D.getElementById(I)),W)return W;var q,ne,le,ce=D.getElementsByTagName("*");for(ne=0,le=ce.length;ne<le;ne++)if(q=ce[ne],I===q.getAttribute("id"))return q}function R(D){for(var I=k(D,["use","svg:use"]),W=0;I.length&&W<I.length;){var q=I[W],ne=q.getAttribute("xlink:href")||q.getAttribute("href");if(ne===null)return;var le=ne.slice(1),ce=q.getAttribute("x")||0,fe=q.getAttribute("y")||0,he=N(D,le).cloneNode(!0),se=(he.getAttribute("transform")||"")+" translate("+ce+", "+fe+")",ie,Q=I.length,re,te,V,z,B=n.svgNS;if(H(he),/^svg$/i.test(he.nodeName)){var ee=he.ownerDocument.createElementNS(B,"g");for(te=0,V=he.attributes,z=V.length;te<z;te++)re=V.item(te),ee.setAttributeNS(B,re.nodeName,re.nodeValue);for(;he.firstChild;)ee.appendChild(he.firstChild);he=ee}for(te=0,V=q.attributes,z=V.length;te<z;te++)re=V.item(te),!(re.nodeName==="x"||re.nodeName==="y"||re.nodeName==="xlink:href"||re.nodeName==="href")&&(re.nodeName==="transform"?se=re.nodeValue+" "+se:he.setAttribute(re.nodeName,re.nodeValue));he.setAttribute("transform",se),he.setAttribute("instantiated_by_use","1"),he.removeAttribute("id"),ie=q.parentNode,ie.replaceChild(he,q),I.length===Q&&W++}}var A=new RegExp("^\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*$");function H(D){if(!n.svgViewBoxElementsRegEx.test(D.nodeName))return{};var I=D.getAttribute("viewBox"),W=1,q=1,ne=0,le=0,ce,fe,he,se,ie=D.getAttribute("width"),Q=D.getAttribute("height"),re=D.getAttribute("x")||0,te=D.getAttribute("y")||0,V=D.getAttribute("preserveAspectRatio")||"",z=!I||!(I=I.match(A)),B=!ie||!Q||ie==="100%"||Q==="100%",ee=z&&B,Y={},L="",P=0,ae=0;if(Y.width=0,Y.height=0,Y.toBeParsed=ee,z&&(re||te)&&D.parentNode&&D.parentNode.nodeName!=="#document"&&(L=" translate("+i(re)+" "+i(te)+") ",he=(D.getAttribute("transform")||"")+L,D.setAttribute("transform",he),D.removeAttribute("x"),D.removeAttribute("y")),ee)return Y;if(z)return Y.width=i(ie),Y.height=i(Q),Y;if(ne=-parseFloat(I[1]),le=-parseFloat(I[2]),ce=parseFloat(I[3]),fe=parseFloat(I[4]),Y.minX=ne,Y.minY=le,Y.viewBoxWidth=ce,Y.viewBoxHeight=fe,B?(Y.width=ce,Y.height=fe):(Y.width=i(ie),Y.height=i(Q),W=Y.width/ce,q=Y.height/fe),V=n.util.parsePreserveAspectRatioAttribute(V),V.alignX!=="none"&&(V.meetOrSlice==="meet"&&(q=W=W>q?q:W),V.meetOrSlice==="slice"&&(q=W=W>q?W:q),P=Y.width-ce*W,ae=Y.height-fe*W,V.alignX==="Mid"&&(P/=2),V.alignY==="Mid"&&(ae/=2),V.alignX==="Min"&&(P=0),V.alignY==="Min"&&(ae=0)),W===1&&q===1&&ne===0&&le===0&&re===0&&te===0)return Y;if((re||te)&&D.parentNode.nodeName!=="#document"&&(L=" translate("+i(re)+" "+i(te)+") "),he=L+" matrix("+W+" 0 0 "+q+" "+(ne*W+P)+" "+(le*q+ae)+") ",D.nodeName==="svg"){for(se=D.ownerDocument.createElementNS(n.svgNS,"g");D.firstChild;)se.appendChild(D.firstChild);D.appendChild(se)}else se=D,se.removeAttribute("x"),se.removeAttribute("y"),he=se.getAttribute("transform")+he;return se.setAttribute("transform",he),Y}function Z(D,I){for(;D&&(D=D.parentNode);)if(D.nodeName&&I.test(D.nodeName.replace("svg:",""))&&!D.getAttribute("instantiated_by_use"))return!0;return!1}n.parseSVGDocument=function(D,I,W,q){if(D){R(D);var ne=n.Object.__uid++,le,ce,fe=H(D),he=n.util.toArray(D.getElementsByTagName("*"));if(fe.crossOrigin=q&&q.crossOrigin,fe.svgUid=ne,he.length===0&&n.isLikelyNode){he=D.selectNodes('//*[name(.)!="svg"]');var se=[];for(le=0,ce=he.length;le<ce;le++)se[le]=he[le];he=se}var ie=he.filter(function(re){return H(re),n.svgValidTagNamesRegEx.test(re.nodeName.replace("svg:",""))&&!Z(re,n.svgInvalidAncestorsRegEx)});if(!ie||ie&&!ie.length){I&&I([],{});return}var Q={};he.filter(function(re){return re.nodeName.replace("svg:","")==="clipPath"}).forEach(function(re){var te=re.getAttribute("id");Q[te]=n.util.toArray(re.getElementsByTagName("*")).filter(function(V){return n.svgValidTagNamesRegEx.test(V.nodeName.replace("svg:",""))})}),n.gradientDefs[ne]=n.getGradientDefs(D),n.cssRules[ne]=n.getCSSRules(D),n.clipPaths[ne]=Q,n.parseElements(ie,function(re,te){I&&(I(re,fe,te,he),delete n.gradientDefs[ne],delete n.cssRules[ne],delete n.clipPaths[ne])},a(fe),W,q)}};function K(D,I){var W=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],q="xlink:href",ne=I.getAttribute(q).slice(1),le=N(D,ne);if(le&&le.getAttribute(q)&&K(D,le),W.forEach(function(fe){le&&!I.hasAttribute(fe)&&le.hasAttribute(fe)&&I.setAttribute(fe,le.getAttribute(fe))}),!I.children.length)for(var ce=le.cloneNode(!0);ce.firstChild;)I.appendChild(ce.firstChild);I.removeAttribute(q)}var J=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+n.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+n.reNum+"))?\\s+(.*)");o(n,{parseFontDeclaration:function(D,I){var W=D.match(J);if(W){var q=W[1],ne=W[3],le=W[4],ce=W[5],fe=W[6];q&&(I.fontStyle=q),ne&&(I.fontWeight=isNaN(parseFloat(ne))?ne:parseFloat(ne)),le&&(I.fontSize=i(le)),fe&&(I.fontFamily=fe),ce&&(I.lineHeight=ce==="normal"?1:ce)}},getGradientDefs:function(D){var I=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],W=k(D,I),q,ne=0,le={};for(ne=W.length;ne--;)q=W[ne],q.getAttribute("xlink:href")&&K(D,q),le[q.getAttribute("id")]=q;return le},parseAttributes:function(D,I,W){if(D){var q,ne={},le,ce;typeof W>"u"&&(W=D.getAttribute("svgUid")),D.parentNode&&n.svgValidParentsRegEx.test(D.parentNode.nodeName)&&(ne=n.parseAttributes(D.parentNode,I,W));var fe=I.reduce(function(V,z){return q=D.getAttribute(z),q&&(V[z]=q),V},{}),he=o(F(D,W),n.parseStyleAttribute(D));fe=o(fe,he),he[_]&&D.setAttribute(_,he[_]),le=ce=ne.fontSize||n.Text.DEFAULT_SVG_FONT_SIZE,fe[p]&&(fe[p]=le=i(fe[p],ce));var se,ie,Q={};for(var re in fe)se=w(re),ie=S(se,fe[re],ne,le),Q[se]=ie;Q&&Q.font&&n.parseFontDeclaration(Q.font,Q);var te=o(ne,Q);return n.svgValidParentsRegEx.test(D.nodeName)?te:E(te)}},parseElements:function(D,I,W,q,ne){new n.ElementsParser(D,I,W,q,ne).parse()},parseStyleAttribute:function(D){var I={},W=D.getAttribute("style");return W&&(typeof W=="string"?O(W,I):U(W,I)),I},parsePointsAttribute:function(D){if(!D)return null;D=D.replace(/,/g," ").trim(),D=D.split(/\s+/);var I=[],W,q;for(W=0,q=D.length;W<q;W+=2)I.push({x:parseFloat(D[W]),y:parseFloat(D[W+1])});return I},getCSSRules:function(D){var I=D.getElementsByTagName("style"),W,q,ne={},le;for(W=0,q=I.length;W<q;W++){var ce=I[W].textContent;ce=ce.replace(/\/\*[\s\S]*?\*\//g,""),ce.trim()!==""&&(le=ce.split("}"),le=le.filter(function(fe){return fe.trim()}),le.forEach(function(fe){var he=fe.split("{"),se={},ie=he[1].trim(),Q=ie.split(";").filter(function(z){return z.trim()});for(W=0,q=Q.length;W<q;W++){var re=Q[W].split(":"),te=re[0].trim(),V=re[1].trim();se[te]=V}fe=he[0].trim(),fe.split(",").forEach(function(z){z=z.replace(/^svg/i,"").trim(),z!==""&&(ne[z]?n.util.object.extend(ne[z],se):ne[z]=n.util.object.clone(se))})}))}return ne},loadSVGFromURL:function(D,I,W,q){D=D.replace(/^\n\s*/,"").trim(),new n.util.request(D,{method:"get",onComplete:ne});function ne(le){var ce=le.responseXML;if(!ce||!ce.documentElement)return I&&I(null),!1;n.parseSVGDocument(ce.documentElement,function(fe,he,se,ie){I&&I(fe,he,se,ie)},W,q)}},loadSVGFromString:function(D,I,W,q){var ne=new n.window.DOMParser,le=ne.parseFromString(D.trim(),"text/xml");n.parseSVGDocument(le.documentElement,function(ce,fe,he,se){I(ce,fe,he,se)},W,q)}})}(v),d.ElementsParser=function(f,n,o,a,t,i){this.elements=f,this.callback=n,this.options=o,this.reviver=a,this.svgUid=o&&o.svgUid||0,this.parsingOptions=t,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=i},function(f){f.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},f.createObjects=function(){var n=this;this.elements.forEach(function(o,a){o.setAttribute("svgUid",n.svgUid),n.createObject(o,a)})},f.findTag=function(n){return d[d.util.string.capitalize(n.tagName.replace("svg:",""))]},f.createObject=function(n,o){var a=this.findTag(n);if(a&&a.fromElement)try{a.fromElement(n,this.createCallback(o,n),this.options)}catch(t){d.log(t)}else this.checkIfDone()},f.createCallback=function(n,o){var a=this;return function(t){var i;a.resolveGradient(t,o,"fill"),a.resolveGradient(t,o,"stroke"),t instanceof d.Image&&t._originalElement&&(i=t.parsePreserveAspectRatioAttribute(o)),t._removeTransformMatrix(i),a.resolveClipPath(t,o),a.reviver&&a.reviver(o,t),a.instances[n]=t,a.checkIfDone()}},f.extractPropertyDefinition=function(n,o,a){var t=n[o],i=this.regexUrl;if(i.test(t)){i.lastIndex=0;var r=i.exec(t)[1];return i.lastIndex=0,d[a][this.svgUid][r]}},f.resolveGradient=function(n,o,a){var t=this.extractPropertyDefinition(n,a,"gradientDefs");if(t){var i=o.getAttribute(a+"-opacity"),r=d.Gradient.fromElement(t,n,i,this.options);n.set(a,r)}},f.createClipPathCallback=function(n,o){return function(a){a._removeTransformMatrix(),a.fillRule=a.clipRule,o.push(a)}},f.resolveClipPath=function(n,o){var a=this.extractPropertyDefinition(n,"clipPath","clipPaths"),t,i,r,e,l,s;if(a){e=[],r=d.util.invertTransform(n.calcTransformMatrix());for(var c=a[0].parentNode,u=o;u.parentNode&&u.getAttribute("clip-path")!==n.clipPath;)u=u.parentNode;u.parentNode.appendChild(c);for(var h=0;h<a.length;h++)t=a[h],i=this.findTag(t),i.fromElement(t,this.createClipPathCallback(n,e),this.options);e.length===1?a=e[0]:a=new d.Group(e),l=d.util.multiplyTransformMatrices(r,a.calcTransformMatrix()),a.clipPath&&this.resolveClipPath(a,u);var s=d.util.qrDecompose(l);a.flipX=!1,a.flipY=!1,a.set("scaleX",s.scaleX),a.set("scaleY",s.scaleY),a.angle=s.angle,a.skewX=s.skewX,a.skewY=0,a.setPositionByOrigin({x:s.translateX,y:s.translateY},"center","center"),n.clipPath=a}else delete n.clipPath},f.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(n){return n!=null}),this.callback(this.instances,this.elements))}}(d.ElementsParser.prototype),function(f){var n=f.fabric||(f.fabric={});if(n.Point){n.warn("fabric.Point is already defined");return}n.Point=o;function o(a,t){this.x=a,this.y=t}o.prototype={type:"point",constructor:o,add:function(a){return new o(this.x+a.x,this.y+a.y)},addEquals:function(a){return this.x+=a.x,this.y+=a.y,this},scalarAdd:function(a){return new o(this.x+a,this.y+a)},scalarAddEquals:function(a){return this.x+=a,this.y+=a,this},subtract:function(a){return new o(this.x-a.x,this.y-a.y)},subtractEquals:function(a){return this.x-=a.x,this.y-=a.y,this},scalarSubtract:function(a){return new o(this.x-a,this.y-a)},scalarSubtractEquals:function(a){return this.x-=a,this.y-=a,this},multiply:function(a){return new o(this.x*a,this.y*a)},multiplyEquals:function(a){return this.x*=a,this.y*=a,this},divide:function(a){return new o(this.x/a,this.y/a)},divideEquals:function(a){return this.x/=a,this.y/=a,this},eq:function(a){return this.x===a.x&&this.y===a.y},lt:function(a){return this.x<a.x&&this.y<a.y},lte:function(a){return this.x<=a.x&&this.y<=a.y},gt:function(a){return this.x>a.x&&this.y>a.y},gte:function(a){return this.x>=a.x&&this.y>=a.y},lerp:function(a,t){return typeof t>"u"&&(t=.5),t=Math.max(Math.min(1,t),0),new o(this.x+(a.x-this.x)*t,this.y+(a.y-this.y)*t)},distanceFrom:function(a){var t=this.x-a.x,i=this.y-a.y;return Math.sqrt(t*t+i*i)},midPointFrom:function(a){return this.lerp(a)},min:function(a){return new o(Math.min(this.x,a.x),Math.min(this.y,a.y))},max:function(a){return new o(Math.max(this.x,a.x),Math.max(this.y,a.y))},toString:function(){return this.x+","+this.y},setXY:function(a,t){return this.x=a,this.y=t,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setFromPoint:function(a){return this.x=a.x,this.y=a.y,this},swap:function(a){var t=this.x,i=this.y;this.x=a.x,this.y=a.y,a.x=t,a.y=i},clone:function(){return new o(this.x,this.y)}}}(v),function(f){var n=f.fabric||(f.fabric={});if(n.Intersection){n.warn("fabric.Intersection is already defined");return}function o(a){this.status=a,this.points=[]}n.Intersection=o,n.Intersection.prototype={constructor:o,appendPoint:function(a){return this.points.push(a),this},appendPoints:function(a){return this.points=this.points.concat(a),this}},n.Intersection.intersectLineLine=function(a,t,i,r){var e,l=(r.x-i.x)*(a.y-i.y)-(r.y-i.y)*(a.x-i.x),s=(t.x-a.x)*(a.y-i.y)-(t.y-a.y)*(a.x-i.x),c=(r.y-i.y)*(t.x-a.x)-(r.x-i.x)*(t.y-a.y);if(c!==0){var u=l/c,h=s/c;0<=u&&u<=1&&0<=h&&h<=1?(e=new o("Intersection"),e.appendPoint(new n.Point(a.x+u*(t.x-a.x),a.y+u*(t.y-a.y)))):e=new o}else l===0||s===0?e=new o("Coincident"):e=new o("Parallel");return e},n.Intersection.intersectLinePolygon=function(a,t,i){var r=new o,e=i.length,l,s,c,u;for(u=0;u<e;u++)l=i[u],s=i[(u+1)%e],c=o.intersectLineLine(a,t,l,s),r.appendPoints(c.points);return r.points.length>0&&(r.status="Intersection"),r},n.Intersection.intersectPolygonPolygon=function(a,t){var i=new o,r=a.length,e;for(e=0;e<r;e++){var l=a[e],s=a[(e+1)%r],c=o.intersectLinePolygon(l,s,t);i.appendPoints(c.points)}return i.points.length>0&&(i.status="Intersection"),i},n.Intersection.intersectPolygonRectangle=function(a,t,i){var r=t.min(i),e=t.max(i),l=new n.Point(e.x,r.y),s=new n.Point(r.x,e.y),c=o.intersectLinePolygon(r,l,a),u=o.intersectLinePolygon(l,e,a),h=o.intersectLinePolygon(e,s,a),p=o.intersectLinePolygon(s,r,a),_=new o;return _.appendPoints(c.points),_.appendPoints(u.points),_.appendPoints(h.points),_.appendPoints(p.points),_.points.length>0&&(_.status="Intersection"),_}}(v),function(f){var n=f.fabric||(f.fabric={});if(n.Color){n.warn("fabric.Color is already defined.");return}function o(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}n.Color=o,n.Color.prototype={_tryParsingColor:function(t){var i;t in o.colorNameMap&&(t=o.colorNameMap[t]),t==="transparent"&&(i=[255,255,255,0]),i||(i=o.sourceFromHex(t)),i||(i=o.sourceFromRgb(t)),i||(i=o.sourceFromHsl(t)),i||(i=[0,0,0,1]),i&&this.setSource(i)},_rgbToHsl:function(t,i,r){t/=255,i/=255,r/=255;var e,l,s,c=n.util.array.max([t,i,r]),u=n.util.array.min([t,i,r]);if(s=(c+u)/2,c===u)e=l=0;else{var h=c-u;switch(l=s>.5?h/(2-c-u):h/(c+u),c){case t:e=(i-r)/h+(i<r?6:0);break;case i:e=(r-t)/h+2;break;case r:e=(t-i)/h+4;break}e/=6}return[Math.round(e*360),Math.round(l*100),Math.round(s*100)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),i=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+i[0]+","+i[1]+"%,"+i[2]+"%)"},toHsla:function(){var t=this.getSource(),i=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+i[0]+","+i[1]+"%,"+i[2]+"%,"+t[3]+")"},toHex:function(){var t=this.getSource(),i,r,e;return i=t[0].toString(16),i=i.length===1?"0"+i:i,r=t[1].toString(16),r=r.length===1?"0"+r:r,e=t[2].toString(16),e=e.length===1?"0"+e:e,i.toUpperCase()+r.toUpperCase()+e.toUpperCase()},toHexa:function(){var t=this.getSource(),i;return i=Math.round(t[3]*255),i=i.toString(16),i=i.length===1?"0"+i:i,this.toHex()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var i=this.getSource();return i[3]=t,this.setSource(i),this},toGrayscale:function(){var t=this.getSource(),i=parseInt((t[0]*.3+t[1]*.59+t[2]*.11).toFixed(0),10),r=t[3];return this.setSource([i,i,i,r]),this},toBlackWhite:function(t){var i=this.getSource(),r=(i[0]*.3+i[1]*.59+i[2]*.11).toFixed(0),e=i[3];return t=t||127,r=Number(r)<Number(t)?0:255,this.setSource([r,r,r,e]),this},overlayWith:function(t){t instanceof o||(t=new o(t));var i=[],r=this.getAlpha(),e=.5,l=this.getSource(),s=t.getSource(),c;for(c=0;c<3;c++)i.push(Math.round(l[c]*(1-e)+s[c]*e));return i[3]=r,this.setSource(i),this}},n.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,n.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,n.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,n.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function a(t,i,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(i-t)*6*r:r<1/2?i:r<2/3?t+(i-t)*(2/3-r)*6:t}n.Color.fromRgb=function(t){return o.fromSource(o.sourceFromRgb(t))},n.Color.sourceFromRgb=function(t){var i=t.match(o.reRGBa);if(i){var r=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),e=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),l=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(r,10),parseInt(e,10),parseInt(l,10),i[4]?parseFloat(i[4]):1]}},n.Color.fromRgba=o.fromRgb,n.Color.fromHsl=function(t){return o.fromSource(o.sourceFromHsl(t))},n.Color.sourceFromHsl=function(t){var i=t.match(o.reHSLa);if(i){var r=(parseFloat(i[1])%360+360)%360/360,e=parseFloat(i[2])/(/%$/.test(i[2])?100:1),l=parseFloat(i[3])/(/%$/.test(i[3])?100:1),s,c,u;if(e===0)s=c=u=l;else{var h=l<=.5?l*(e+1):l+e-l*e,p=l*2-h;s=a(p,h,r+1/3),c=a(p,h,r),u=a(p,h,r-1/3)}return[Math.round(s*255),Math.round(c*255),Math.round(u*255),i[4]?parseFloat(i[4]):1]}},n.Color.fromHsla=o.fromHsl,n.Color.fromHex=function(t){return o.fromSource(o.sourceFromHex(t))},n.Color.sourceFromHex=function(t){if(t.match(o.reHex)){var i=t.slice(t.indexOf("#")+1),r=i.length===3||i.length===4,e=i.length===8||i.length===4,l=r?i.charAt(0)+i.charAt(0):i.substring(0,2),s=r?i.charAt(1)+i.charAt(1):i.substring(2,4),c=r?i.charAt(2)+i.charAt(2):i.substring(4,6),u=e?r?i.charAt(3)+i.charAt(3):i.substring(6,8):"FF";return[parseInt(l,16),parseInt(s,16),parseInt(c,16),parseFloat((parseInt(u,16)/255).toFixed(2))]}},n.Color.fromSource=function(t){var i=new o;return i.setSource(t),i}}(v),function(f){var n=f.fabric||(f.fabric={}),o=["e","se","s","sw","w","nw","n","ne","e"],a=["ns","nesw","ew","nwse"],t={},i="left",r="top",e="right",l="bottom",s="center",c={top:l,bottom:r,left:e,right:i,center:s},u=n.util.radiansToDegrees,h=Math.sign||function(se){return(se>0)-(se<0)||+se};function p(se,ie){var Q=se.angle+u(Math.atan2(ie.y,ie.x))+360;return Math.round(Q%360/45)}function _(se,ie){var Q=ie.transform.target,re=Q.canvas,te=n.util.object.clone(ie);te.target=Q,re&&re.fire("object:"+se,te),Q.fire(se,ie)}function w(se,ie){var Q=ie.canvas,re=Q.uniScaleKey,te=se[re];return Q.uniformScaling&&!te||!Q.uniformScaling&&te}function S(se){return se.originX===s&&se.originY===s}function C(se,ie,Q){var re=se.lockScalingX,te=se.lockScalingY;return!!(re&&te||!ie&&(re||te)&&Q||re&&ie==="x"||te&&ie==="y")}function E(se,ie,Q){var re="not-allowed",te=w(se,Q),V="";if(ie.x!==0&&ie.y===0?V="x":ie.x===0&&ie.y!==0&&(V="y"),C(Q,V,te))return re;var z=p(Q,ie);return o[z]+"-resize"}function k(se,ie,Q){var re="not-allowed";if(ie.x!==0&&Q.lockSkewingY||ie.y!==0&&Q.lockSkewingX)return re;var te=p(Q,ie)%4;return a[te]+"-resize"}function O(se,ie,Q){return se[Q.canvas.altActionKey]?t.skewCursorStyleHandler(se,ie,Q):t.scaleCursorStyleHandler(se,ie,Q)}function U(se,ie,Q){var re=se[Q.canvas.altActionKey];if(ie.x===0)return re?"skewX":"scaleY";if(ie.y===0)return re?"skewY":"scaleX"}function F(se,ie,Q){return Q.lockRotation?"not-allowed":ie.cursorStyle}function M(se,ie,Q,re){return{e:se,transform:ie,pointer:{x:Q,y:re}}}function j(se){return function(ie,Q,re,te){var V=Q.target,z=V.getCenterPoint(),B=V.translateToOriginPoint(z,Q.originX,Q.originY),ee=se(ie,Q,re,te);return V.setPositionByOrigin(B,Q.originX,Q.originY),ee}}function G(se,ie){return function(Q,re,te,V){var z=ie(Q,re,te,V);return z&&_(se,M(Q,re,te,V)),z}}function N(se,ie,Q,re,te){var V=se.target,z=V.controls[se.corner],B=V.canvas.getZoom(),ee=V.padding/B,Y=V.toLocalPoint(new n.Point(re,te),ie,Q);return Y.x>=ee&&(Y.x-=ee),Y.x<=-ee&&(Y.x+=ee),Y.y>=ee&&(Y.y-=ee),Y.y<=ee&&(Y.y+=ee),Y.x-=z.offsetX,Y.y-=z.offsetY,Y}function R(se){return se.flipX!==se.flipY}function A(se,ie,Q,re,te){if(se[ie]!==0){var V=se._getTransformedDimensions()[re],z=te/V*se[Q];se.set(Q,z)}}function H(se,ie,Q,re){var te=ie.target,V=te._getTransformedDimensions(0,te.skewY),z=N(ie,ie.originX,ie.originY,Q,re),B=Math.abs(z.x*2)-V.x,ee=te.skewX,Y;B<2?Y=0:(Y=u(Math.atan2(B/te.scaleX,V.y/te.scaleY)),ie.originX===i&&ie.originY===l&&(Y=-Y),ie.originX===e&&ie.originY===r&&(Y=-Y),R(te)&&(Y=-Y));var L=ee!==Y;if(L){var P=te._getTransformedDimensions().y;te.set("skewX",Y),A(te,"skewY","scaleY","y",P)}return L}function Z(se,ie,Q,re){var te=ie.target,V=te._getTransformedDimensions(te.skewX,0),z=N(ie,ie.originX,ie.originY,Q,re),B=Math.abs(z.y*2)-V.y,ee=te.skewY,Y;B<2?Y=0:(Y=u(Math.atan2(B/te.scaleY,V.x/te.scaleX)),ie.originX===i&&ie.originY===l&&(Y=-Y),ie.originX===e&&ie.originY===r&&(Y=-Y),R(te)&&(Y=-Y));var L=ee!==Y;if(L){var P=te._getTransformedDimensions().x;te.set("skewY",Y),A(te,"skewX","scaleX","x",P)}return L}function K(se,ie,Q,re){var te=ie.target,V=te.skewX,z,B=ie.originY;if(te.lockSkewingX)return!1;if(V===0){var ee=N(ie,s,s,Q,re);ee.x>0?z=i:z=e}else V>0&&(z=B===r?i:e),V<0&&(z=B===r?e:i),R(te)&&(z=z===i?e:i);ie.originX=z;var Y=G("skewing",j(H));return Y(se,ie,Q,re)}function J(se,ie,Q,re){var te=ie.target,V=te.skewY,z,B=ie.originX;if(te.lockSkewingY)return!1;if(V===0){var ee=N(ie,s,s,Q,re);ee.y>0?z=r:z=l}else V>0&&(z=B===i?r:l),V<0&&(z=B===i?l:r),R(te)&&(z=z===r?l:r);ie.originY=z;var Y=G("skewing",j(Z));return Y(se,ie,Q,re)}function D(se,ie,Q,re){var te=ie,V=te.target,z=V.translateToOriginPoint(V.getCenterPoint(),te.originX,te.originY);if(V.lockRotation)return!1;var B=Math.atan2(te.ey-z.y,te.ex-z.x),ee=Math.atan2(re-z.y,Q-z.x),Y=u(ee-B+te.theta),L=!0;if(V.snapAngle>0){var P=V.snapAngle,ae=V.snapThreshold||P,ue=Math.ceil(Y/P)*P,ve=Math.floor(Y/P)*P;Math.abs(Y-ve)<ae?Y=ve:Math.abs(Y-ue)<ae&&(Y=ue)}return Y<0&&(Y=360+Y),Y%=360,L=V.angle!==Y,V.angle=Y,L}function I(se,ie,Q,re,te){te=te||{};var V=ie.target,z=V.lockScalingX,B=V.lockScalingY,ee=te.by,Y,L,P,ae,ue=w(se,V),ve=C(V,ee,ue),_e,Te,Re=ie.gestureScale;if(ve)return!1;if(Re)L=ie.scaleX*Re,P=ie.scaleY*Re;else{if(Y=N(ie,ie.originX,ie.originY,Q,re),_e=ee!=="y"?h(Y.x):1,Te=ee!=="x"?h(Y.y):1,ie.signX||(ie.signX=_e),ie.signY||(ie.signY=Te),V.lockScalingFlip&&(ie.signX!==_e||ie.signY!==Te))return!1;if(ae=V._getTransformedDimensions(),ue&&!ee){var Le=Math.abs(Y.x)+Math.abs(Y.y),Se=ie.original,Ee=Math.abs(ae.x*Se.scaleX/V.scaleX)+Math.abs(ae.y*Se.scaleY/V.scaleY),Ce=Le/Ee;L=Se.scaleX*Ce,P=Se.scaleY*Ce}else L=Math.abs(Y.x*V.scaleX/ae.x),P=Math.abs(Y.y*V.scaleY/ae.y);S(ie)&&(L*=2,P*=2),ie.signX!==_e&&ee!=="y"&&(ie.originX=c[ie.originX],L*=-1,ie.signX=_e),ie.signY!==Te&&ee!=="x"&&(ie.originY=c[ie.originY],P*=-1,ie.signY=Te)}var Ie=V.scaleX,Ae=V.scaleY;return ee?(ee==="x"&&V.set("scaleX",L),ee==="y"&&V.set("scaleY",P)):(!z&&V.set("scaleX",L),!B&&V.set("scaleY",P)),Ie!==V.scaleX||Ae!==V.scaleY}function W(se,ie,Q,re){return I(se,ie,Q,re)}function q(se,ie,Q,re){return I(se,ie,Q,re,{by:"x"})}function ne(se,ie,Q,re){return I(se,ie,Q,re,{by:"y"})}function le(se,ie,Q,re){return se[ie.target.canvas.altActionKey]?t.skewHandlerX(se,ie,Q,re):t.scalingY(se,ie,Q,re)}function ce(se,ie,Q,re){return se[ie.target.canvas.altActionKey]?t.skewHandlerY(se,ie,Q,re):t.scalingX(se,ie,Q,re)}function fe(se,ie,Q,re){var te=ie.target,V=N(ie,ie.originX,ie.originY,Q,re),z=te.strokeWidth/(te.strokeUniform?te.scaleX:1),B=S(ie)?2:1,ee=te.width,Y=Math.abs(V.x*B/te.scaleX)-z;return te.set("width",Math.max(Y,0)),ee!==Y}function he(se,ie,Q,re){var te=ie.target,V=Q-ie.offsetX,z=re-ie.offsetY,B=!te.get("lockMovementX")&&te.left!==V,ee=!te.get("lockMovementY")&&te.top!==z;return B&&te.set("left",V),ee&&te.set("top",z),(B||ee)&&_("moving",M(se,ie,Q,re)),B||ee}t.scaleCursorStyleHandler=E,t.skewCursorStyleHandler=k,t.scaleSkewCursorStyleHandler=O,t.rotationWithSnapping=G("rotating",j(D)),t.scalingEqually=G("scaling",j(W)),t.scalingX=G("scaling",j(q)),t.scalingY=G("scaling",j(ne)),t.scalingYOrSkewingX=le,t.scalingXOrSkewingY=ce,t.changeWidth=G("resizing",j(fe)),t.skewHandlerX=K,t.skewHandlerY=J,t.dragHandler=he,t.scaleOrSkewActionName=U,t.rotationStyleHandler=F,t.fireEvent=_,t.wrapWithFixedAnchor=j,t.wrapWithFireEvent=G,t.getLocalPoint=N,n.controlsUtils=t}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.degreesToRadians,a=n.controlsUtils;function t(r,e,l,s,c){s=s||{};var u=this.sizeX||s.cornerSize||c.cornerSize,h=this.sizeY||s.cornerSize||c.cornerSize,p=typeof s.transparentCorners<"u"?s.transparentCorners:c.transparentCorners,_=p?"stroke":"fill",w=!p&&(s.cornerStrokeColor||c.cornerStrokeColor),S=e,C=l,E;r.save(),r.fillStyle=s.cornerColor||c.cornerColor,r.strokeStyle=s.cornerStrokeColor||c.cornerStrokeColor,u>h?(E=u,r.scale(1,h/u),C=l*u/h):h>u?(E=h,r.scale(u/h,1),S=e*h/u):E=u,r.lineWidth=1,r.beginPath(),r.arc(S,C,E/2,0,2*Math.PI,!1),r[_](),w&&r.stroke(),r.restore()}function i(r,e,l,s,c){s=s||{};var u=this.sizeX||s.cornerSize||c.cornerSize,h=this.sizeY||s.cornerSize||c.cornerSize,p=typeof s.transparentCorners<"u"?s.transparentCorners:c.transparentCorners,_=p?"stroke":"fill",w=!p&&(s.cornerStrokeColor||c.cornerStrokeColor),S=u/2,C=h/2;r.save(),r.fillStyle=s.cornerColor||c.cornerColor,r.strokeStyle=s.cornerStrokeColor||c.cornerStrokeColor,r.lineWidth=1,r.translate(e,l),r.rotate(o(c.angle)),r[_+"Rect"](-S,-C,u,h),w&&r.strokeRect(-S,-C,u,h),r.restore()}a.renderCircleControl=t,a.renderSquareControl=i}(v),function(f){var n=f.fabric||(f.fabric={});function o(a){for(var t in a)this[t]=a[t]}n.Control=o,n.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(a,t){return t.cursorStyle},getActionName:function(a,t){return t.actionName},getVisibility:function(a,t){var i=a._controlsVisibility;return i&&typeof i[t]<"u"?i[t]:this.visible},setVisibility:function(a){this.visible=a},positionHandler:function(a,t){var i=n.util.transformPoint({x:this.x*a.x+this.offsetX,y:this.y*a.y+this.offsetY},t);return i},calcCornerCoords:function(a,t,i,r,e){var l,s,c,u,h=e?this.touchSizeX:this.sizeX,p=e?this.touchSizeY:this.sizeY;if(h&&p&&h!==p){var _=Math.atan2(p,h),w=Math.sqrt(h*h+p*p)/2,S=_-n.util.degreesToRadians(a),C=Math.PI/2-_-n.util.degreesToRadians(a);l=w*n.util.cos(S),s=w*n.util.sin(S),c=w*n.util.cos(C),u=w*n.util.sin(C)}else{var E=h&&p?h:t;w=E*.7071067812;var S=n.util.degreesToRadians(45-a);l=c=w*n.util.cos(S),s=u=w*n.util.sin(S)}return{tl:{x:i-u,y:r-c},tr:{x:i+l,y:r-s},bl:{x:i-l,y:r+s},br:{x:i+u,y:r+c}}},render:function(a,t,i,r,e){switch(r=r||{},r.cornerStyle||e.cornerStyle){case"circle":n.controlsUtils.renderCircleControl.call(this,a,t,i,r,e);break;default:n.controlsUtils.renderSquareControl.call(this,a,t,i,r,e)}}}}(v),function(){function f(i,r){var e=i.getAttribute("style"),l=i.getAttribute("offset")||0,s,c,u,h;if(l=parseFloat(l)/(/%$/.test(l)?100:1),l=l<0?0:l>1?1:l,e){var p=e.split(/\s*;\s*/);for(p[p.length-1]===""&&p.pop(),h=p.length;h--;){var _=p[h].split(/\s*:\s*/),w=_[0].trim(),S=_[1].trim();w==="stop-color"?s=S:w==="stop-opacity"&&(u=S)}}return s||(s=i.getAttribute("stop-color")||"rgb(0,0,0)"),u||(u=i.getAttribute("stop-opacity")),s=new d.Color(s),c=s.getAlpha(),u=isNaN(parseFloat(u))?1:parseFloat(u),u*=c*r,{offset:l,color:s.toRgb(),opacity:u}}function n(i){return{x1:i.getAttribute("x1")||0,y1:i.getAttribute("y1")||0,x2:i.getAttribute("x2")||"100%",y2:i.getAttribute("y2")||0}}function o(i){return{x1:i.getAttribute("fx")||i.getAttribute("cx")||"50%",y1:i.getAttribute("fy")||i.getAttribute("cy")||"50%",r1:0,x2:i.getAttribute("cx")||"50%",y2:i.getAttribute("cy")||"50%",r2:i.getAttribute("r")||"50%"}}var a=d.util.object.clone;d.Gradient=d.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(i){i||(i={}),i.coords||(i.coords={});var r,e=this;Object.keys(i).forEach(function(l){e[l]=i[l]}),this.id?this.id+="_"+d.Object.__uid++:this.id=d.Object.__uid++,r={x1:i.coords.x1||0,y1:i.coords.y1||0,x2:i.coords.x2||0,y2:i.coords.y2||0},this.type==="radial"&&(r.r1=i.coords.r1||0,r.r2=i.coords.r2||0),this.coords=r,this.colorStops=i.colorStops.slice()},addColorStop:function(i){for(var r in i){var e=new d.Color(i[r]);this.colorStops.push({offset:parseFloat(r),color:e.toRgb(),opacity:e.getAlpha()})}return this},toObject:function(i){var r={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return d.util.populateWithProperties(this,r,i),r},toSVG:function(i,c){var e=a(this.coords,!0),l,s,c=c||{},u,h,p=a(this.colorStops,!0),_=e.r1>e.r2,w=this.gradientTransform?this.gradientTransform.concat():d.iMatrix.concat(),S=-this.offsetX,C=-this.offsetY,E=!!c.additionalTransform,k=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(p.sort(function(j,G){return j.offset-G.offset}),k==="objectBoundingBox"?(S/=i.width,C/=i.height):(S+=i.width/2,C+=i.height/2),i.type==="path"&&this.gradientUnits!=="percentage"&&(S-=i.pathOffset.x,C-=i.pathOffset.y),w[4]-=S,w[5]-=C,h='id="SVGID_'+this.id+'" gradientUnits="'+k+'"',h+=' gradientTransform="'+(E?c.additionalTransform+" ":"")+d.util.matrixToSVG(w)+'" ',this.type==="linear"?u=["<linearGradient ",h,' x1="',e.x1,'" y1="',e.y1,'" x2="',e.x2,'" y2="',e.y2,'">\n']:this.type==="radial"&&(u=["<radialGradient ",h,' cx="',_?e.x1:e.x2,'" cy="',_?e.y1:e.y2,'" r="',_?e.r1:e.r2,'" fx="',_?e.x2:e.x1,'" fy="',_?e.y2:e.y1,'">\n']),this.type==="radial"){if(_)for(p=p.concat(),p.reverse(),l=0,s=p.length;l<s;l++)p[l].offset=1-p[l].offset;var O=Math.min(e.r1,e.r2);if(O>0){var U=Math.max(e.r1,e.r2),F=O/U;for(l=0,s=p.length;l<s;l++)p[l].offset+=F*(1-p[l].offset)}}for(l=0,s=p.length;l<s;l++){var M=p[l];u.push("<stop ",'offset="',M.offset*100+"%",'" style="stop-color:',M.color,typeof M.opacity<"u"?";stop-opacity: "+M.opacity:";",'"/>\n')}return u.push(this.type==="linear"?"</linearGradient>\n":"</radialGradient>\n"),u.join("")},toLive:function(i){var r,e=d.util.object.clone(this.coords),l,s;if(this.type){for(this.type==="linear"?r=i.createLinearGradient(e.x1,e.y1,e.x2,e.y2):this.type==="radial"&&(r=i.createRadialGradient(e.x1,e.y1,e.r1,e.x2,e.y2,e.r2)),l=0,s=this.colorStops.length;l<s;l++){var c=this.colorStops[l].color,u=this.colorStops[l].opacity,h=this.colorStops[l].offset;typeof u<"u"&&(c=new d.Color(c).setAlpha(u).toRgba()),r.addColorStop(h,c)}return r}}}),d.util.object.extend(d.Gradient,{fromElement:function(i,r,e,l){var s=parseFloat(e)/(/%$/.test(e)?100:1);s=s<0?0:s>1?1:s,isNaN(s)&&(s=1);var c=i.getElementsByTagName("stop"),u,h=i.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",p=i.getAttribute("gradientTransform")||"",_=[],w,S,C=0,E=0,k;for(i.nodeName==="linearGradient"||i.nodeName==="LINEARGRADIENT"?(u="linear",w=n(i)):(u="radial",w=o(i)),S=c.length;S--;)_.push(f(c[S],s));k=d.parseTransformAttribute(p),t(r,w,l,h),h==="pixels"&&(C=-r.left,E=-r.top);var O=new d.Gradient({id:i.getAttribute("id"),type:u,coords:w,colorStops:_,gradientUnits:h,gradientTransform:k,offsetX:C,offsetY:E});return O}});function t(i,r,e,l){var s,c;Object.keys(r).forEach(function(u){s=r[u],s==="Infinity"?c=1:s==="-Infinity"?c=0:(c=parseFloat(r[u],10),typeof s=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(s)&&(c*=.01,l==="pixels"&&((u==="x1"||u==="x2"||u==="r2")&&(c*=e.viewBoxWidth||e.width),(u==="y1"||u==="y2")&&(c*=e.viewBoxHeight||e.height)))),r[u]=c})}}(),function(){var f=d.util.toFixed;d.Pattern=d.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(n,o){if(n||(n={}),this.id=d.Object.__uid++,this.setOptions(n),!n.source||n.source&&typeof n.source!="string"){o&&o(this);return}else{var a=this;this.source=d.util.createImage(),d.util.loadImage(n.source,function(t,i){a.source=t,o&&o(a,i)},null,this.crossOrigin)}},toObject:function(n){var o=d.Object.NUM_FRACTION_DIGITS,a,t;return typeof this.source.src=="string"?a=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(a=this.source.toDataURL()),t={type:"pattern",source:a,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:f(this.offsetX,o),offsetY:f(this.offsetY,o),patternTransform:this.patternTransform?this.patternTransform.concat():null},d.util.populateWithProperties(this,t,n),t},toSVG:function(n){var o=typeof this.source=="function"?this.source():this.source,a=o.width/n.width,t=o.height/n.height,i=this.offsetX/n.width,r=this.offsetY/n.height,e="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(t=1,r&&(t+=Math.abs(r))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(a=1,i&&(a+=Math.abs(i))),o.src?e=o.src:o.toDataURL&&(e=o.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+i+'" y="'+r+'" width="'+a+'" height="'+t+'">\n<image x="0" y="0" width="'+o.width+'" height="'+o.height+'" xlink:href="'+e+'"></image>\n</pattern>\n'},setOptions:function(n){for(var o in n)this[o]=n[o]},toLive:function(n){var o=this.source;return!o||typeof o.src<"u"&&(!o.complete||o.naturalWidth===0||o.naturalHeight===0)?"":n.createPattern(o,this.repeat)}})}(),function(f){var n=f.fabric||(f.fabric={}),o=n.util.toFixed;if(n.Shadow){n.warn("fabric.Shadow is already defined.");return}n.Shadow=n.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(a){typeof a=="string"&&(a=this._parseShadow(a));for(var t in a)this[t]=a[t];this.id=n.Object.__uid++},_parseShadow:function(a){var t=a.trim(),i=n.Shadow.reOffsetsAndBlur.exec(t)||[],r=t.replace(n.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:r.trim(),offsetX:parseFloat(i[1],10)||0,offsetY:parseFloat(i[2],10)||0,blur:parseFloat(i[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(a){var t=40,i=40,r=n.Object.NUM_FRACTION_DIGITS,e=n.util.rotateVector({x:this.offsetX,y:this.offsetY},n.util.degreesToRadians(-a.angle)),l=20,s=new n.Color(this.color);return a.width&&a.height&&(t=o((Math.abs(e.x)+this.blur)/a.width,r)*100+l,i=o((Math.abs(e.y)+this.blur)/a.height,r)*100+l),a.flipX&&(e.x*=-1),a.flipY&&(e.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+i+'%" height="'+(100+2*i)+'%" x="-'+t+'%" width="'+(100+2*t)+'%" >\n	<feGaussianBlur in="SourceAlpha" stdDeviation="'+o(this.blur?this.blur/2:0,r)+'"></feGaussianBlur>\n	<feOffset dx="'+o(e.x,r)+'" dy="'+o(e.y,r)+'" result="oBlur" ></feOffset>\n	<feFlood flood-color="'+s.toRgb()+'" flood-opacity="'+s.getAlpha()+'"/>\n	<feComposite in2="oBlur" operator="in" />\n	<feMerge>\n		<feMergeNode></feMergeNode>\n		<feMergeNode in="SourceGraphic"></feMergeNode>\n	</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var a={},t=n.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(i){this[i]!==t[i]&&(a[i]=this[i])},this),a}}),n.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(v),function(){if(d.StaticCanvas){d.warn("fabric.StaticCanvas is already defined.");return}var f=d.util.object.extend,n=d.util.getElementOffset,o=d.util.removeFromArray,a=d.util.toFixed,t=d.util.transformPoint,i=d.util.invertTransform,r=d.util.getNodeCanvas,e=d.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");d.StaticCanvas=d.util.createClass(d.CommonMethods,{initialize:function(s,c){c||(c={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(s,c)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:d.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(s,c){var u=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(s),this._initOptions(c),this.interactive||this._initRetinaScaling(),c.overlayImage&&this.setOverlayImage(c.overlayImage,u),c.backgroundImage&&this.setBackgroundImage(c.backgroundImage,u),c.backgroundColor&&this.setBackgroundColor(c.backgroundColor,u),c.overlayColor&&this.setOverlayColor(c.overlayColor,u),this.calcOffset()},_isRetinaScaling:function(){return d.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,d.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var s=d.devicePixelRatio;this.__initRetinaScaling(s,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(s,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(s,c,u){c.setAttribute("width",this.width*s),c.setAttribute("height",this.height*s),u.scale(s,s)},calcOffset:function(){return this._offset=n(this.lowerCanvasEl),this},setOverlayImage:function(s,c,u){return this.__setBgOverlayImage("overlayImage",s,c,u)},setBackgroundImage:function(s,c,u){return this.__setBgOverlayImage("backgroundImage",s,c,u)},setOverlayColor:function(s,c){return this.__setBgOverlayColor("overlayColor",s,c)},setBackgroundColor:function(s,c){return this.__setBgOverlayColor("backgroundColor",s,c)},__setBgOverlayImage:function(s,c,u,h){return typeof c=="string"?d.util.loadImage(c,function(p,_){if(p){var w=new d.Image(p,h);this[s]=w,w.canvas=this}u&&u(p,_)},this,h&&h.crossOrigin):(h&&c.setOptions(h),this[s]=c,c&&(c.canvas=this),u&&u(c,!1)),this},__setBgOverlayColor:function(s,c,u){return this[s]=c,this._initGradient(c,s),this._initPattern(c,s,u),this},_createCanvasElement:function(){var s=e();if(!s||(s.style||(s.style={}),typeof s.getContext>"u"))throw l;return s},_initOptions:function(s){var c=this.lowerCanvasEl;this._setOptions(s),this.width=this.width||parseInt(c.width,10)||0,this.height=this.height||parseInt(c.height,10)||0,this.lowerCanvasEl.style&&(c.width=this.width,c.height=this.height,c.style.width=this.width+"px",c.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(s){s&&s.getContext?this.lowerCanvasEl=s:this.lowerCanvasEl=d.util.getById(s)||this._createCanvasElement(),d.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(s,c){return this.setDimensions({width:s},c)},setHeight:function(s,c){return this.setDimensions({height:s},c)},setDimensions:function(s,c){var u;c=c||{};for(var h in s)u=s[h],c.cssOnly||(this._setBackstoreDimension(h,s[h]),u+="px",this.hasLostContext=!0),c.backstoreOnly||this._setCssDimension(h,u);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),c.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(s,c){return this.lowerCanvasEl[s]=c,this.upperCanvasEl&&(this.upperCanvasEl[s]=c),this.cacheCanvasEl&&(this.cacheCanvasEl[s]=c),this[s]=c,this},_setCssDimension:function(s,c){return this.lowerCanvasEl.style[s]=c,this.upperCanvasEl&&(this.upperCanvasEl.style[s]=c),this.wrapperEl&&(this.wrapperEl.style[s]=c),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(s){var c=this._activeObject,u=this.backgroundImage,h=this.overlayImage,p,_,w;for(this.viewportTransform=s,_=0,w=this._objects.length;_<w;_++)p=this._objects[_],p.group||p.setCoords(!0);return c&&c.setCoords(),u&&u.setCoords(!0),h&&h.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(s,c){var u=s,h=this.viewportTransform.slice(0);s=t(s,i(this.viewportTransform)),h[0]=c,h[3]=c;var p=t(s,h);return h[4]+=u.x-p.x,h[5]+=u.y-p.y,this.setViewportTransform(h)},setZoom:function(s){return this.zoomToPoint(new d.Point(0,0),s),this},absolutePan:function(s){var c=this.viewportTransform.slice(0);return c[4]=-s.x,c[5]=-s.y,this.setViewportTransform(c)},relativePan:function(s){return this.absolutePan(new d.Point(-s.x-this.viewportTransform[4],-s.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(s){this.stateful&&s.setupState(),s._set("canvas",this),s.setCoords(),this.fire("object:added",{target:s}),s.fire("added")},_onObjectRemoved:function(s){this.fire("object:removed",{target:s}),s.fire("removed"),delete s.canvas},clearContext:function(s){return s.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var s=this.contextContainer;return this.renderCanvas(s,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=d.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var s={},c=this.width,u=this.height,h=i(this.viewportTransform);return s.tl=t({x:0,y:0},h),s.br=t({x:c,y:u},h),s.tr=new d.Point(s.br.x,s.tl.y),s.bl=new d.Point(s.tl.x,s.br.y),this.vptCoords=s,s},cancelRequestedRender:function(){this.isRendering&&(d.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(s,c){var u=this.viewportTransform,h=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(s),d.util.setImageSmoothing(s,this.imageSmoothingEnabled),this.fire("before:render",{ctx:s}),this._renderBackground(s),s.save(),s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._renderObjects(s,c),s.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(s),h&&(h.canvas=this,h.shouldCache(),h._transformDone=!0,h.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(s)),this._renderOverlay(s),this.controlsAboveOverlay&&this.interactive&&this.drawControls(s),this.fire("after:render",{ctx:s})},drawClipPathOnCanvas:function(s){var c=this.viewportTransform,u=this.clipPath;s.save(),s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),s.globalCompositeOperation="destination-in",u.transform(s),s.scale(1/u.zoomX,1/u.zoomY),s.drawImage(u._cacheCanvas,-u.cacheTranslationX,-u.cacheTranslationY),s.restore()},_renderObjects:function(s,c){var u,h;for(u=0,h=c.length;u<h;++u)c[u]&&c[u].render(s)},_renderBackgroundOrOverlay:function(s,c){var u=this[c+"Color"],h=this[c+"Image"],p=this.viewportTransform,_=this[c+"Vpt"];if(!(!u&&!h)){if(u){s.save(),s.beginPath(),s.moveTo(0,0),s.lineTo(this.width,0),s.lineTo(this.width,this.height),s.lineTo(0,this.height),s.closePath(),s.fillStyle=u.toLive?u.toLive(s,this):u,_&&s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),s.transform(1,0,0,1,u.offsetX||0,u.offsetY||0);var w=u.gradientTransform||u.patternTransform;w&&s.transform(w[0],w[1],w[2],w[3],w[4],w[5]),s.fill(),s.restore()}h&&(s.save(),_&&s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),h.render(s),s.restore())}},_renderBackground:function(s){this._renderBackgroundOrOverlay(s,"background")},_renderOverlay:function(s){this._renderBackgroundOrOverlay(s,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new d.Point(this.width/2,this.height/2)},centerObjectH:function(s){return this._centerObject(s,new d.Point(this.getCenterPoint().x,s.getCenterPoint().y))},centerObjectV:function(s){return this._centerObject(s,new d.Point(s.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(s){var c=this.getCenterPoint();return this._centerObject(s,c)},viewportCenterObject:function(s){var c=this.getVpCenter();return this._centerObject(s,c)},viewportCenterObjectH:function(s){var c=this.getVpCenter();return this._centerObject(s,new d.Point(c.x,s.getCenterPoint().y)),this},viewportCenterObjectV:function(s){var c=this.getVpCenter();return this._centerObject(s,new d.Point(s.getCenterPoint().x,c.y))},getVpCenter:function(){var s=this.getCenterPoint(),c=i(this.viewportTransform);return t(s,c)},_centerObject:function(s,c){return s.setPositionByOrigin(c,"center","center"),s.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(s){return this.toDatalessObject(s)},toObject:function(s){return this._toObjectMethod("toObject",s)},toDatalessObject:function(s){return this._toObjectMethod("toDatalessObject",s)},_toObjectMethod:function(s,c){var u=this.clipPath,h={version:d.version,objects:this._toObjects(s,c)};return u&&!u.excludeFromExport&&(h.clipPath=this._toObject(this.clipPath,s,c)),f(h,this.__serializeBgOverlay(s,c)),d.util.populateWithProperties(this,h,c),h},_toObjects:function(s,c){return this._objects.filter(function(u){return!u.excludeFromExport}).map(function(u){return this._toObject(u,s,c)},this)},_toObject:function(s,c,u){var h;this.includeDefaultValues||(h=s.includeDefaultValues,s.includeDefaultValues=!1);var p=s[c](u);return this.includeDefaultValues||(s.includeDefaultValues=h),p},__serializeBgOverlay:function(s,c){var u={},h=this.backgroundImage,p=this.overlayImage,_=this.backgroundColor,w=this.overlayColor;return _&&_.toObject?_.excludeFromExport||(u.background=_.toObject(c)):_&&(u.background=_),w&&w.toObject?w.excludeFromExport||(u.overlay=w.toObject(c)):w&&(u.overlay=w),h&&!h.excludeFromExport&&(u.backgroundImage=this._toObject(h,s,c)),p&&!p.excludeFromExport&&(u.overlayImage=this._toObject(p,s,c)),u},svgViewportTransformation:!0,toSVG:function(s,c){s||(s={}),s.reviver=c;var u=[];return this._setSVGPreamble(u,s),this._setSVGHeader(u,s),this.clipPath&&u.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(u,"background"),this._setSVGBgOverlayImage(u,"backgroundImage",c),this._setSVGObjects(u,c),this.clipPath&&u.push("</g>\n"),this._setSVGBgOverlayColor(u,"overlay"),this._setSVGBgOverlayImage(u,"overlayImage",c),u.push("</svg>"),u.join("")},_setSVGPreamble:function(s,c){c.suppressPreamble||s.push('<?xml version="1.0" encoding="',c.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(s,c){var u=c.width||this.width,h=c.height||this.height,p,_='viewBox="0 0 '+this.width+" "+this.height+'" ',w=d.Object.NUM_FRACTION_DIGITS;c.viewBox?_='viewBox="'+c.viewBox.x+" "+c.viewBox.y+" "+c.viewBox.width+" "+c.viewBox.height+'" ':this.svgViewportTransformation&&(p=this.viewportTransform,_='viewBox="'+a(-p[4]/p[0],w)+" "+a(-p[5]/p[3],w)+" "+a(this.width/p[0],w)+" "+a(this.height/p[3],w)+'" '),s.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',u,'" ','height="',h,'" ',_,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",d.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(c),"</defs>\n")},createSVGClipPathMarkup:function(s){var c=this.clipPath;return c?(c.clipPathId="CLIPPATH_"+d.Object.__uid++,'<clipPath id="'+c.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(s.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var s=this,c=["background","overlay"].map(function(u){var h=s[u+"Color"];if(h&&h.toLive){var p=s[u+"Vpt"],_=s.viewportTransform,w={width:s.width/(p?_[0]:1),height:s.height/(p?_[3]:1)};return h.toSVG(w,{additionalTransform:p?d.util.matrixToSVG(_):""})}});return c.join("")},createSVGFontFacesMarkup:function(){var s="",c={},u,h,p,_,w,S,C,E,k,O=d.fontPaths,U=[];for(this._objects.forEach(function M(j){U.push(j),j._objects&&j._objects.forEach(M)}),E=0,k=U.length;E<k;E++)if(u=U[E],h=u.fontFamily,!(u.type.indexOf("text")===-1||c[h]||!O[h])&&(c[h]=!0,!!u.styles)){p=u.styles;for(w in p){_=p[w];for(C in _)S=_[C],h=S.fontFamily,!c[h]&&O[h]&&(c[h]=!0)}}for(var F in c)s+=["		@font-face {\n","			font-family: '",F,"';\n","			src: url('",O[F],"');\n","		}\n"].join("");return s&&(s=['	<style type="text/css">',"<![CDATA[\n",s,"]]>","</style>\n"].join("")),s},_setSVGObjects:function(s,c){var u,h,p,_=this._objects;for(h=0,p=_.length;h<p;h++)u=_[h],!u.excludeFromExport&&this._setSVGObject(s,u,c)},_setSVGObject:function(s,c,u){s.push(c.toSVG(u))},_setSVGBgOverlayImage:function(s,c,u){this[c]&&!this[c].excludeFromExport&&this[c].toSVG&&s.push(this[c].toSVG(u))},_setSVGBgOverlayColor:function(s,c){var u=this[c+"Color"],h=this.viewportTransform,p=this.width,_=this.height;if(u)if(u.toLive){var w=u.repeat,S=d.util.invertTransform(h),C=this[c+"Vpt"],E=C?d.util.matrixToSVG(S):"";s.push('<rect transform="'+E+" translate(",p/2,",",_/2,')"',' x="',u.offsetX-p/2,'" y="',u.offsetY-_/2,'" ','width="',w==="repeat-y"||w==="no-repeat"?u.source.width:p,'" height="',w==="repeat-x"||w==="no-repeat"?u.source.height:_,'" fill="url(#SVGID_'+u.id+')"',"></rect>\n")}else s.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',u,'"',"></rect>\n")},sendToBack:function(s){if(!s)return this;var c=this._activeObject,u,h,p;if(s===c&&s.type==="activeSelection")for(p=c._objects,u=p.length;u--;)h=p[u],o(this._objects,h),this._objects.unshift(h);else o(this._objects,s),this._objects.unshift(s);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(s){if(!s)return this;var c=this._activeObject,u,h,p;if(s===c&&s.type==="activeSelection")for(p=c._objects,u=0;u<p.length;u++)h=p[u],o(this._objects,h),this._objects.push(h);else o(this._objects,s),this._objects.push(s);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(s,c){if(!s)return this;var u=this._activeObject,h,p,_,w,S,C=0;if(s===u&&s.type==="activeSelection")for(S=u._objects,h=0;h<S.length;h++)p=S[h],_=this._objects.indexOf(p),_>0+C&&(w=_-1,o(this._objects,p),this._objects.splice(w,0,p)),C++;else _=this._objects.indexOf(s),_!==0&&(w=this._findNewLowerIndex(s,_,c),o(this._objects,s),this._objects.splice(w,0,s));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(s,c,u){var h,p;if(u)for(h=c,p=c-1;p>=0;--p){var _=s.intersectsWithObject(this._objects[p])||s.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(s);if(_){h=p;break}}else h=c-1;return h},bringForward:function(s,c){if(!s)return this;var u=this._activeObject,h,p,_,w,S,C=0;if(s===u&&s.type==="activeSelection")for(S=u._objects,h=S.length;h--;)p=S[h],_=this._objects.indexOf(p),_<this._objects.length-1-C&&(w=_+1,o(this._objects,p),this._objects.splice(w,0,p)),C++;else _=this._objects.indexOf(s),_!==this._objects.length-1&&(w=this._findNewUpperIndex(s,_,c),o(this._objects,s),this._objects.splice(w,0,s));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(s,c,u){var h,p,_;if(u)for(h=c,p=c+1,_=this._objects.length;p<_;++p){var w=s.intersectsWithObject(this._objects[p])||s.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(s);if(w){h=p;break}}else h=c+1;return h},moveTo:function(s,c){return o(this._objects,s),this._objects.splice(c,0,s),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(d.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(s){s.dispose&&s.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),d.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),d.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),f(d.StaticCanvas.prototype,d.Observable),f(d.StaticCanvas.prototype,d.Collection),f(d.StaticCanvas.prototype,d.DataURLExporter),f(d.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(s){var c=e();if(!c||!c.getContext)return null;var u=c.getContext("2d");if(!u)return null;switch(s){case"setLineDash":return typeof u.setLineDash<"u";default:return null}}}),d.StaticCanvas.prototype.toJSON=d.StaticCanvas.prototype.toObject,d.isLikelyNode&&(d.StaticCanvas.prototype.createPNGStream=function(){var s=r(this.lowerCanvasEl);return s&&s.createPNGStream()},d.StaticCanvas.prototype.createJPEGStream=function(s){var c=r(this.lowerCanvasEl);return c&&c.createJPEGStream(s)})}(),d.BaseBrush=d.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(f){f.strokeStyle=this.color,f.lineWidth=this.width,f.lineCap=this.strokeLineCap,f.miterLimit=this.strokeMiterLimit,f.lineJoin=this.strokeLineJoin,f.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(f){var n=this.canvas.viewportTransform;f.save(),f.transform(n[0],n[1],n[2],n[3],n[4],n[5])},_setShadow:function(){if(this.shadow){var f=this.canvas,n=this.shadow,o=f.contextTop,a=f.getZoom();f&&f._isRetinaScaling()&&(a*=d.devicePixelRatio),o.shadowColor=n.color,o.shadowBlur=n.blur*a,o.shadowOffsetX=n.offsetX*a,o.shadowOffsetY=n.offsetY*a}},needsFullRender:function(){var f=new d.Color(this.color);return f.getAlpha()<1||!!this.shadow},_resetShadow:function(){var f=this.canvas.contextTop;f.shadowColor="",f.shadowBlur=f.shadowOffsetX=f.shadowOffsetY=0},_isOutSideCanvas:function(f){return f.x<0||f.x>this.canvas.getWidth()||f.y<0||f.y>this.canvas.getHeight()}}),function(){d.PencilBrush=d.util.createClass(d.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(f){this.canvas=f,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(f,n,o){var a=n.midPointFrom(o);return f.quadraticCurveTo(n.x,n.y,a.x,a.y),a},onMouseDown:function(f,n){this.canvas._isMainEvent(n.e)&&(this.drawStraightLine=n.e[this.straightLineKey],this._prepareForDrawing(f),this._captureDrawingPath(f),this._render())},onMouseMove:function(f,n){if(this.canvas._isMainEvent(n.e)&&(this.drawStraightLine=n.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(f))&&this._captureDrawingPath(f)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var o=this._points,a=o.length,t=this.canvas.contextTop;this._saveAndTransform(t),this.oldEnd&&(t.beginPath(),t.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(t,o[a-2],o[a-1],!0),t.stroke(),t.restore()}},onMouseUp:function(f){return this.canvas._isMainEvent(f.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(f){var n=new d.Point(f.x,f.y);this._reset(),this._addPoint(n),this.canvas.contextTop.moveTo(n.x,n.y)},_addPoint:function(f){return this._points.length>1&&f.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(f),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(f){var n=new d.Point(f.x,f.y);return this._addPoint(n)},_render:function(f){var n,o,a=this._points[0],t=this._points[1];if(f=f||this.canvas.contextTop,this._saveAndTransform(f),f.beginPath(),this._points.length===2&&a.x===t.x&&a.y===t.y){var i=this.width/1e3;a=new d.Point(a.x,a.y),t=new d.Point(t.x,t.y),a.x-=i,t.x+=i}for(f.moveTo(a.x,a.y),n=1,o=this._points.length;n<o;n++)this._drawSegment(f,a,t),a=this._points[n],t=this._points[n+1];f.lineTo(a.x,a.y),f.stroke(),f.restore()},convertPointsToSVGPath:function(f){var n=this.width/1e3;return d.util.getSmoothPathFromPoints(f,n)},_isEmptySVGPath:function(f){var n=d.util.joinPath(f);return n==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(f){var n=new d.Path(f,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,n.shadow=new d.Shadow(this.shadow)),n},decimatePoints:function(f,n){if(f.length<=2)return f;var o=this.canvas.getZoom(),a=Math.pow(n/o,2),t,i=f.length-1,r=f[0],e=[r],l;for(t=1;t<i-1;t++)l=Math.pow(r.x-f[t].x,2)+Math.pow(r.y-f[t].y,2),l>=a&&(r=f[t],e.push(r));return e.push(f[i]),e},_finalizeAndAddPath:function(){var f=this.canvas.contextTop;f.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var n=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(n)){this.canvas.requestRenderAll();return}var o=this.createPath(n);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:o}),this.canvas.add(o),this.canvas.requestRenderAll(),o.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:o})}})}(),d.CircleBrush=d.util.createClass(d.BaseBrush,{width:10,initialize:function(f){this.canvas=f,this.points=[]},drawDot:function(f){var n=this.addPoint(f),o=this.canvas.contextTop;this._saveAndTransform(o),this.dot(o,n),o.restore()},dot:function(f,n){f.fillStyle=n.fill,f.beginPath(),f.arc(n.x,n.y,n.radius,0,Math.PI*2,!1),f.closePath(),f.fill()},onMouseDown:function(f){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(f)},_render:function(){var f=this.canvas.contextTop,n,o,a=this.points;for(this._saveAndTransform(f),n=0,o=a.length;n<o;n++)this.dot(f,a[n]);f.restore()},onMouseMove:function(f){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(f)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(f),this._render()):this.drawDot(f))},onMouseUp:function(){var f=this.canvas.renderOnAddRemove,n,o;this.canvas.renderOnAddRemove=!1;var a=[];for(n=0,o=this.points.length;n<o;n++){var t=this.points[n],i=new d.Circle({radius:t.radius,left:t.x,top:t.y,originX:"center",originY:"center",fill:t.fill});this.shadow&&(i.shadow=new d.Shadow(this.shadow)),a.push(i)}var r=new d.Group(a);r.canvas=this.canvas,this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.fire("path:created",{path:r}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=f,this.canvas.requestRenderAll()},addPoint:function(f){var n=new d.Point(f.x,f.y),o=d.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,a=new d.Color(this.color).setAlpha(d.util.getRandomInt(0,100)/100).toRgba();return n.radius=o,n.fill=a,this.points.push(n),n}}),d.SprayBrush=d.util.createClass(d.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(f){this.canvas=f,this.sprayChunks=[]},onMouseDown:function(f){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(f),this.render(this.sprayChunkPoints)},onMouseMove:function(f){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(f)||(this.addSprayChunk(f),this.render(this.sprayChunkPoints))},onMouseUp:function(){var f=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var n=[],o=0,a=this.sprayChunks.length;o<a;o++)for(var t=this.sprayChunks[o],i=0,r=t.length;i<r;i++){var e=new d.Rect({width:t[i].width,height:t[i].width,left:t[i].x+1,top:t[i].y+1,originX:"center",originY:"center",fill:this.color});n.push(e)}this.optimizeOverlapping&&(n=this._getOptimizedRects(n));var l=new d.Group(n);this.shadow&&l.set("shadow",new d.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=f,this.canvas.requestRenderAll()},_getOptimizedRects:function(f){var n={},o,a,t;for(a=0,t=f.length;a<t;a++)o=f[a].left+""+f[a].top,n[o]||(n[o]=f[a]);var i=[];for(o in n)i.push(n[o]);return i},render:function(f){var n=this.canvas.contextTop,o,a;for(n.fillStyle=this.color,this._saveAndTransform(n),o=0,a=f.length;o<a;o++){var t=f[o];typeof t.opacity<"u"&&(n.globalAlpha=t.opacity),n.fillRect(t.x,t.y,t.width,t.width)}n.restore()},_render:function(){var f=this.canvas.contextTop,n,o;for(f.fillStyle=this.color,this._saveAndTransform(f),n=0,o=this.sprayChunks.length;n<o;n++)this.render(this.sprayChunks[n]);f.restore()},addSprayChunk:function(f){this.sprayChunkPoints=[];var n,o,a,t=this.width/2,i;for(i=0;i<this.density;i++){n=d.util.getRandomInt(f.x-t,f.x+t),o=d.util.getRandomInt(f.y-t,f.y+t),this.dotWidthVariance?a=d.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):a=this.dotWidth;var r=new d.Point(n,o);r.width=a,this.randomOpacity&&(r.opacity=d.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(r)}this.sprayChunks.push(this.sprayChunkPoints)}}),d.PatternBrush=d.util.createClass(d.PencilBrush,{getPatternSrc:function(){var f=20,n=5,o=d.util.createCanvasElement(),a=o.getContext("2d");return o.width=o.height=f+n,a.fillStyle=this.color,a.beginPath(),a.arc(f/2,f/2,f/2,0,Math.PI*2,!1),a.closePath(),a.fill(),o},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(f){return f.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(f){this.callSuper("_setBrushStyles",f),f.strokeStyle=this.getPattern(f)},createPath:function(f){var n=this.callSuper("createPath",f),o=n._getLeftTopCoords().scalarAdd(n.strokeWidth/2);return n.stroke=new d.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-o.x,offsetY:-o.y}),n}}),function(){var f=d.util.getPointer,n=d.util.degreesToRadians,o=d.util.isTouchEvent;d.Canvas=d.util.createClass(d.StaticCanvas,{initialize:function(t,i){i||(i={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,i),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=d.PencilBrush&&new d.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t=this.getActiveObjects(),i,r,e;if(t.length>0&&!this.preserveObjectStacking){r=[],e=[];for(var l=0,s=this._objects.length;l<s;l++)i=this._objects[l],t.indexOf(i)===-1?r.push(i):e.push(i);t.length>1&&(this._activeObject._objects=e),r.push.apply(r,e)}else r=this._objects;return r},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_normalizePointer:function(t,i){var r=t.calcTransformMatrix(),e=d.util.invertTransform(r),l=this.restorePointerVpt(i);return d.util.transformPoint(l,e)},isTargetTransparent:function(t,i,r){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var e=this._normalizePointer(t,{x:i,y:r}),l=Math.max(t.cacheTranslationX+e.x*t.zoomX,0),s=Math.max(t.cacheTranslationY+e.y*t.zoomY,0),p=d.util.isTransparent(t._cacheContext,Math.round(l),Math.round(s),this.targetFindTolerance);return p}var c=this.contextCache,u=t.selectionBackgroundColor,h=this.viewportTransform;t.selectionBackgroundColor="",this.clearContext(c),c.save(),c.transform(h[0],h[1],h[2],h[3],h[4],h[5]),t.render(c),c.restore(),t.selectionBackgroundColor=u;var p=d.util.isTransparent(c,i,r,this.targetFindTolerance);return p},_isSelectionKeyPressed:function(t){var i=!1;return Array.isArray(this.selectionKey)?i=!!this.selectionKey.find(function(r){return t[r]===!0}):i=t[this.selectionKey],i},_shouldClearSelection:function(t,i){var r=this.getActiveObjects(),e=this._activeObject;return!i||i&&e&&r.length>1&&r.indexOf(i)===-1&&e!==i&&!this._isSelectionKeyPressed(t)||i&&!i.evented||i&&!i.selectable&&e&&e!==i},_shouldCenterTransform:function(t,i,r){if(t){var e;return i==="scale"||i==="scaleX"||i==="scaleY"||i==="resizing"?e=this.centeredScaling||t.centeredScaling:i==="rotate"&&(e=this.centeredRotation||t.centeredRotation),e?!r:r}},_getOriginFromCorner:function(t,i){var r={x:t.originX,y:t.originY};return i==="ml"||i==="tl"||i==="bl"?r.x="right":(i==="mr"||i==="tr"||i==="br")&&(r.x="left"),i==="tl"||i==="mt"||i==="tr"?r.y="bottom":(i==="bl"||i==="mb"||i==="br")&&(r.y="top"),r},_getActionFromCorner:function(t,i,r,e){if(!i||!t)return"drag";var l=e.controls[i];return l.getActionName(r,l,e)},_setupCurrentTransform:function(t,i,r){if(i){var e=this.getPointer(t),l=i.__corner,s=i.controls[l],c=r&&l?s.getActionHandler(t,i,s):d.controlsUtils.dragHandler,u=this._getActionFromCorner(r,l,t,i),h=this._getOriginFromCorner(i,l),p=t[this.centeredKey],_={target:i,action:u,actionHandler:c,corner:l,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,offsetX:e.x-i.left,offsetY:e.y-i.top,originX:h.x,originY:h.y,ex:e.x,ey:e.y,lastX:e.x,lastY:e.y,theta:n(i.angle),width:i.width*i.scaleX,shiftKey:t.shiftKey,altKey:p,original:d.util.saveObjectTransform(i)};this._shouldCenterTransform(i,u,p)&&(_.originX="center",_.originY="center"),_.original.originX=h.x,_.original.originY=h.y,this._currentTransform=_,this._beforeTransform(t)}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var i=this._groupSelector,r=new d.Point(i.ex,i.ey),e=d.util.transformPoint(r,this.viewportTransform),l=new d.Point(i.ex+i.left,i.ey+i.top),s=d.util.transformPoint(l,this.viewportTransform),c=Math.min(e.x,s.x),u=Math.min(e.y,s.y),h=Math.max(e.x,s.x),p=Math.max(e.y,s.y),_=this.selectionLineWidth/2;this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(c,u,h-c,p-u)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,c+=_,u+=_,h-=_,p-=_,d.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(c,u,h-c,p-u))},findTarget:function(t,i){if(!this.skipTargetFind){var r=!0,e=this.getPointer(t,r),l=this._activeObject,s=this.getActiveObjects(),c,u,h=o(t),p=s.length>1&&!i||s.length===1;if(this.targets=[],p&&l._findTargetCorner(e,h)||s.length>1&&!i&&l===this._searchPossibleTargets([l],e))return l;if(s.length===1&&l===this._searchPossibleTargets([l],e))if(this.preserveObjectStacking)c=l,u=this.targets,this.targets=[];else return l;var _=this._searchPossibleTargets(this._objects,e);return t[this.altSelectionKey]&&_&&c&&_!==c&&(_=c,this.targets=u),_}},_checkTarget:function(t,i,r){if(i&&i.visible&&i.evented&&i.containsPoint(t))if((this.perPixelTargetFind||i.perPixelTargetFind)&&!i.isEditing){var e=this.isTargetTransparent(i,r.x,r.y);if(!e)return!0}else return!0},_searchPossibleTargets:function(t,i){for(var r,e=t.length,l;e--;){var s=t[e],c=s.group?this._normalizePointer(s.group,i):i;if(this._checkTarget(c,s,i)){r=t[e],r.subTargetCheck&&r instanceof d.Group&&(l=this._searchPossibleTargets(r._objects,i),l&&this.targets.push(l));break}}return r},restorePointerVpt:function(t){return d.util.transformPoint(t,d.util.invertTransform(this.viewportTransform))},getPointer:function(t,i){if(this._absolutePointer&&!i)return this._absolutePointer;if(this._pointer&&i)return this._pointer;var r=f(t),e=this.upperCanvasEl,l=e.getBoundingClientRect(),s=l.width||0,c=l.height||0,u;(!s||!c)&&("top"in l&&"bottom"in l&&(c=Math.abs(l.top-l.bottom)),"right"in l&&"left"in l&&(s=Math.abs(l.right-l.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,i||(r=this.restorePointerVpt(r));var h=this.getRetinaScaling();return h!==1&&(r.x/=h,r.y/=h),s===0||c===0?u={width:1,height:1}:u={width:e.width/s,height:e.height/c},{x:r.x*u.width,y:r.y*u.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),i=this.lowerCanvasEl,r=this.upperCanvasEl;r?r.className="":(r=this._createCanvasElement(),this.upperCanvasEl=r),d.util.addClass(r,"upper-canvas "+t),this.wrapperEl.appendChild(r),this._copyCanvasStyle(i,r),this._applyCanvasStyle(r),this.contextTop=r.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=d.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),d.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),d.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var i=this.width||t.width,r=this.height||t.height;d.util.setStyle(t,{position:"absolute",width:i+"px",height:r+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=i,t.height=r,d.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,i){i.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?t.type==="activeSelection"&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,i){var r=!1,e=this.getActiveObjects(),l=[],s=[];t.forEach(function(c){e.indexOf(c)===-1&&(r=!0,c.fire("deselected",{e:i,target:c}),s.push(c))}),e.forEach(function(c){t.indexOf(c)===-1&&(r=!0,c.fire("selected",{e:i,target:c}),l.push(c))}),t.length>0&&e.length>0?r&&this.fire("selection:updated",{e:i,selected:l,deselected:s}):e.length>0?this.fire("selection:created",{e:i,selected:l}):t.length>0&&this.fire("selection:cleared",{e:i,deselected:s})},setActiveObject:function(t,i){var r=this.getActiveObjects();return this._setActiveObject(t,i),this._fireSelectionEvents(r,i),this},_setActiveObject:function(t,i){return this._activeObject===t||!this._discardActiveObject(i,t)||t.onSelect({e:i})?!1:(this._activeObject=t,!0)},_discardActiveObject:function(t,i){var r=this._activeObject;if(r){if(r.onDeselect({e:t,object:i}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var i=this.getActiveObjects(),r=this.getActiveObject();return i.length&&this.fire("before:selection:cleared",{target:r,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(i,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(i){d.util.cleanUpJsdomNode(this[i]),this[i]=void 0}).bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,d.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var i=this._activeObject;i&&i._renderControls(t)},_toObject:function(t,i,r){var e=this._realizeGroupTransformOnObject(t),l=this.callSuper("_toObject",t,i,r);return this._unwindGroupTransformOnObject(t,e),l},_realizeGroupTransformOnObject:function(t){if(t.group&&t.group.type==="activeSelection"&&this._activeObject===t.group){var i=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],r={};return i.forEach(function(e){r[e]=t[e]}),d.util.addTransformToObject(t,this._activeObject.calcOwnMatrix()),r}else return null},_unwindGroupTransformOnObject:function(t,i){i&&t.set(i)},_setSVGObject:function(t,i,r){var e=this._realizeGroupTransformOnObject(i);this.callSuper("_setSVGObject",t,i,r),this._unwindGroupTransformOnObject(i,e)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),d.StaticCanvas.prototype.setViewportTransform.call(this,t)}});for(var a in d.StaticCanvas)a!=="prototype"&&(d.Canvas[a]=d.StaticCanvas[a])}(),function(){var f=d.util.addListener,n=d.util.removeListener,o=3,a=2,t=1,i={passive:!1};function r(e,l){return e.button&&e.button===l-1}d.util.object.extend(d.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(f,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(e,l){var s=this.upperCanvasEl,c=this._getEventPrefix();e(d.window,"resize",this._onResize),e(s,c+"down",this._onMouseDown),e(s,c+"move",this._onMouseMove,i),e(s,c+"out",this._onMouseOut),e(s,c+"enter",this._onMouseEnter),e(s,"wheel",this._onMouseWheel),e(s,"contextmenu",this._onContextMenu),e(s,"dblclick",this._onDoubleClick),e(s,"dragover",this._onDragOver),e(s,"dragenter",this._onDragEnter),e(s,"dragleave",this._onDragLeave),e(s,"drop",this._onDrop),this.enablePointerEvents||e(s,"touchstart",this._onTouchStart,i),typeof eventjs<"u"&&l in eventjs&&(eventjs[l](s,"gesture",this._onGesture),eventjs[l](s,"drag",this._onDrag),eventjs[l](s,"orientation",this._onOrientationChange),eventjs[l](s,"shake",this._onShake),eventjs[l](s,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(n,"remove");var e=this._getEventPrefix();n(d.document,e+"up",this._onMouseUp),n(d.document,"touchend",this._onTouchEnd,i),n(d.document,e+"move",this._onMouseMove,i),n(d.document,"touchmove",this._onMouseMove,i)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(e,l){this.__onTransformGesture&&this.__onTransformGesture(e,l)},_onDrag:function(e,l){this.__onDrag&&this.__onDrag(e,l)},_onMouseWheel:function(e){this.__onMouseWheel(e)},_onMouseOut:function(e){var l=this._hoveredTarget;this.fire("mouse:out",{target:l,e}),this._hoveredTarget=null,l&&l.fire("mouseout",{e});var s=this;this._hoveredTargets.forEach(function(c){s.fire("mouse:out",{target:l,e}),c&&l.fire("mouseout",{e})}),this._hoveredTargets=[]},_onMouseEnter:function(e){!this._currentTransform&&!this.findTarget(e)&&(this.fire("mouse:over",{target:null,e}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(e,l){this.__onOrientationChange&&this.__onOrientationChange(e,l)},_onShake:function(e,l){this.__onShake&&this.__onShake(e,l)},_onLongPress:function(e,l){this.__onLongPress&&this.__onLongPress(e,l)},_onDragOver:function(e){e.preventDefault();var l=this._simpleEventHandler("dragover",e);this._fireEnterLeaveEvents(l,e)},_onDrop:function(e){return this._simpleEventHandler("drop:before",e),this._simpleEventHandler("drop",e)},_onContextMenu:function(e){return this.stopContextMenu&&(e.stopPropagation(),e.preventDefault()),!1},_onDoubleClick:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData(e)},getPointerId:function(e){var l=e.changedTouches;return l?l[0]&&l[0].identifier:this.enablePointerEvents?e.pointerId:-1},_isMainEvent:function(e){return e.isPrimary===!0?!0:e.isPrimary===!1?!1:e.type==="touchend"&&e.touches.length===0?!0:e.changedTouches?e.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(e){e.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),this._resetTransformEventData();var l=this.upperCanvasEl,s=this._getEventPrefix();f(d.document,"touchend",this._onTouchEnd,i),f(d.document,"touchmove",this._onMouseMove,i),n(l,s+"down",this._onMouseDown)},_onMouseDown:function(e){this.__onMouseDown(e),this._resetTransformEventData();var l=this.upperCanvasEl,s=this._getEventPrefix();n(l,s+"move",this._onMouseMove,i),f(d.document,s+"up",this._onMouseUp),f(d.document,s+"move",this._onMouseMove,i)},_onTouchEnd:function(e){if(!(e.touches.length>0)){this.__onMouseUp(e),this._resetTransformEventData(),this.mainTouchId=null;var l=this._getEventPrefix();n(d.document,"touchend",this._onTouchEnd,i),n(d.document,"touchmove",this._onMouseMove,i);var s=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){f(s.upperCanvasEl,l+"down",s._onMouseDown),s._willAddMouseDown=0},400)}},_onMouseUp:function(e){this.__onMouseUp(e),this._resetTransformEventData();var l=this.upperCanvasEl,s=this._getEventPrefix();this._isMainEvent(e)&&(n(d.document,s+"up",this._onMouseUp),n(d.document,s+"move",this._onMouseMove,i),f(l,s+"move",this._onMouseMove,i))},_onMouseMove:function(e){!this.allowTouchScrolling&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)},_onResize:function(){this.calcOffset()},_shouldRender:function(e){var l=this._activeObject;return!!l!=!!e||l&&e&&l!==e?!0:(l&&l.isEditing,!1)},__onMouseUp:function(e){var l,s=this._currentTransform,c=this._groupSelector,u=!1,h=!c||c.left===0&&c.top===0;if(this._cacheTransformEventData(e),l=this._target,this._handleEvent(e,"up:before"),r(e,o)){this.fireRightClick&&this._handleEvent(e,"up",o,h);return}if(r(e,a)){this.fireMiddleClick&&this._handleEvent(e,"up",a,h),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(e);return}if(this._isMainEvent(e)){if(s&&(this._finalizeCurrentTransform(e),u=s.actionPerformed),!h){var p=l===this._activeObject;this._maybeGroupObjects(e),u||(u=this._shouldRender(l)||!p&&l===this._activeObject)}var _,w;if(l){if(_=l._findTargetCorner(this.getPointer(e,!0),d.util.isTouchEvent(e)),l.selectable&&l!==this._activeObject&&l.activeOn==="up")this.setActiveObject(l,e),u=!0;else{var S=l.controls[_],C=S&&S.getMouseUpHandler(e,l,S);C&&(w=this.getPointer(e),C(e,s,w.x,w.y))}l.isMoving=!1}if(s&&(s.target!==l||s.corner!==_)){var E=s.target&&s.target.controls[s.corner],k=E&&E.getMouseUpHandler(e,l,S);w=w||this.getPointer(e),k&&k(e,s,w.x,w.y)}this._setCursorFromEvent(e,l),this._handleEvent(e,"up",t,h),this._groupSelector=null,this._currentTransform=null,l&&(l.__corner=0),u?this.requestRenderAll():h||this.renderTop()}},_simpleEventHandler:function(e,l){var s=this.findTarget(l),c=this.targets,u={e:l,target:s,subTargets:c};if(this.fire(e,u),s&&s.fire(e,u),!c)return s;for(var h=0;h<c.length;h++)c[h].fire(e,u);return s},_handleEvent:function(e,l,s,c){var u=this._target,h=this.targets||[],p={e,target:u,subTargets:h,button:s||t,isClick:c||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};l==="up"&&(p.currentTarget=this.findTarget(e),p.currentSubTargets=this.targets),this.fire("mouse:"+l,p),u&&u.fire("mouse"+l,p);for(var _=0;_<h.length;_++)h[_].fire("mouse"+l,p)},_finalizeCurrentTransform:function(e){var l=this._currentTransform,s=l.target,c={e,target:s,transform:l,action:l.action};s._scaling&&(s._scaling=!1),s.setCoords(),(l.actionPerformed||this.stateful&&s.hasStateChanged())&&this._fire("modified",c)},_onMouseDownInDrawingMode:function(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(e).requestRenderAll();var l=this.getPointer(e);this.freeDrawingBrush.onMouseDown(l,{e,pointer:l}),this._handleEvent(e,"down")},_onMouseMoveInDrawingMode:function(e){if(this._isCurrentlyDrawing){var l=this.getPointer(e);this.freeDrawingBrush.onMouseMove(l,{e,pointer:l})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")},_onMouseUpInDrawingMode:function(e){var l=this.getPointer(e);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e,pointer:l}),this._handleEvent(e,"up")},__onMouseDown:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"down:before");var l=this._target;if(r(e,o)){this.fireRightClick&&this._handleEvent(e,"down",o);return}if(r(e,a)){this.fireMiddleClick&&this._handleEvent(e,"down",a);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(e);return}if(this._isMainEvent(e)&&!this._currentTransform){var s=this._pointer;this._previousPointer=s;var c=this._shouldRender(l),u=this._shouldGroup(e,l);if(this._shouldClearSelection(e,l)?this.discardActiveObject(e):u&&(this._handleGrouping(e,l),l=this._activeObject),this.selection&&(!l||!l.selectable&&!l.isEditing&&l!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),l){var h=l===this._activeObject;l.selectable&&l.activeOn==="down"&&this.setActiveObject(l,e);var p=l._findTargetCorner(this.getPointer(e,!0),d.util.isTouchEvent(e));if(l.__corner=p,l===this._activeObject&&(p||!u)){this._setupCurrentTransform(e,l,h);var _=l.controls[p],s=this.getPointer(e),w=_&&_.getMouseDownHandler(e,l,_);w&&w(e,this._currentTransform,s.x,s.y)}}this._handleEvent(e,"down"),(c||u)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(e){this._resetTransformEventData(),this._pointer=this.getPointer(e,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)||null},_beforeTransform:function(e){var l=this._currentTransform;this.stateful&&l.target.saveState(),this.fire("before:transform",{e,transform:l})},__onMouseMove:function(e){this._handleEvent(e,"move:before"),this._cacheTransformEventData(e);var l,s;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(e);return}if(this._isMainEvent(e)){var c=this._groupSelector;c?(s=this._absolutePointer,c.left=s.x-c.ex,c.top=s.y-c.ey,this.renderTop()):this._currentTransform?this._transformObject(e):(l=this.findTarget(e)||null,this._setCursorFromEvent(e,l),this._fireOverOutEvents(l,e)),this._handleEvent(e,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(e,l){var s=this._hoveredTarget,c=this._hoveredTargets,u=this.targets,h=Math.max(c.length,u.length);this.fireSyntheticInOutEvents(e,l,{oldTarget:s,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var p=0;p<h;p++)this.fireSyntheticInOutEvents(u[p],l,{oldTarget:c[p],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(e,l){var s=this._draggedoverTarget,c=this._hoveredTargets,u=this.targets,h=Math.max(c.length,u.length);this.fireSyntheticInOutEvents(e,l,{oldTarget:s,evtOut:"dragleave",evtIn:"dragenter"});for(var p=0;p<h;p++)this.fireSyntheticInOutEvents(u[p],l,{oldTarget:c[p],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=e},fireSyntheticInOutEvents:function(e,l,s){var c,u,h=s.oldTarget,p,_,w=h!==e,S=s.canvasEvtIn,C=s.canvasEvtOut;w&&(c={e:l,target:e,previousTarget:h},u={e:l,target:h,nextTarget:e}),_=e&&w,p=h&&w,p&&(C&&this.fire(C,u),h.fire(s.evtOut,u)),_&&(S&&this.fire(S,c),e.fire(s.evtIn,c))},__onMouseWheel:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()},_transformObject:function(e){var l=this.getPointer(e),s=this._currentTransform;s.reset=!1,s.shiftKey=e.shiftKey,s.altKey=e[this.centeredKey],this._performTransformAction(e,s,l),s.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(e,l,s){var c=s.x,u=s.y,h=l.action,p=!1,_=l.actionHandler;_&&(p=_(e,l,c,u)),h==="drag"&&p&&(l.target.isMoving=!0,this.setCursor(l.target.moveCursor||this.moveCursor)),l.actionPerformed=l.actionPerformed||p},_fire:d.controlsUtils.fireEvent,_setCursorFromEvent:function(e,l){if(!l)return this.setCursor(this.defaultCursor),!1;var s=l.hoverCursor||this.hoverCursor,c=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,u=(!c||!c.contains(l))&&l._findTargetCorner(this.getPointer(e,!0));u?this.setCursor(this.getCornerCursor(u,l,e)):(l.subTargetCheck&&this.targets.concat().reverse().map(function(h){s=h.hoverCursor||s}),this.setCursor(s))},getCornerCursor:function(e,l,s){var c=l.controls[e];return c.cursorStyleHandler(s,c,l)}})}(),function(){var f=Math.min,n=Math.max;d.util.object.extend(d.Canvas.prototype,{_shouldGroup:function(o,a){var t=this._activeObject;return t&&this._isSelectionKeyPressed(o)&&a&&a.selectable&&this.selection&&(t!==a||t.type==="activeSelection")&&!a.onSelect({e:o})},_handleGrouping:function(o,a){var t=this._activeObject;t.__corner||a===t&&(a=this.findTarget(o,!0),!a||!a.selectable)||(t&&t.type==="activeSelection"?this._updateActiveSelection(a,o):this._createActiveSelection(a,o))},_updateActiveSelection:function(o,a){var t=this._activeObject,i=t._objects.slice(0);t.contains(o)?(t.removeWithUpdate(o),this._hoveredTarget=o,this._hoveredTargets=this.targets.concat(),t.size()===1&&this._setActiveObject(t.item(0),a)):(t.addWithUpdate(o),this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(i,a)},_createActiveSelection:function(o,a){var t=this.getActiveObjects(),i=this._createGroup(o);this._hoveredTarget=i,this._setActiveObject(i,a),this._fireSelectionEvents(t,a)},_createGroup:function(o){var a=this._objects,t=a.indexOf(this._activeObject)<a.indexOf(o),i=t?[this._activeObject,o]:[o,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new d.ActiveSelection(i,{canvas:this})},_groupSelectedObjects:function(o){var a=this._collectObjects(o),t;a.length===1?this.setActiveObject(a[0],o):a.length>1&&(t=new d.ActiveSelection(a.reverse(),{canvas:this}),this.setActiveObject(t,o))},_collectObjects:function(o){for(var a=[],t,i=this._groupSelector.ex,r=this._groupSelector.ey,e=i+this._groupSelector.left,l=r+this._groupSelector.top,s=new d.Point(f(i,e),f(r,l)),c=new d.Point(n(i,e),n(r,l)),u=!this.selectionFullyContained,h=i===e&&r===l,p=this._objects.length;p--&&(t=this._objects[p],!(!(!t||!t.selectable||!t.visible)&&(u&&t.intersectsWithRect(s,c,!0)||t.isContainedWithinRect(s,c,!0)||u&&t.containsPoint(s,null,!0)||u&&t.containsPoint(c,null,!0))&&(a.push(t),h))););return a.length>1&&(a=a.filter(function(_){return!_.onSelect({e:o})})),a},_maybeGroupObjects:function(o){this.selection&&this._groupSelector&&this._groupSelectedObjects(o),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){d.util.object.extend(d.StaticCanvas.prototype,{toDataURL:function(f){f||(f={});var n=f.format||"png",o=f.quality||1,a=(f.multiplier||1)*(f.enableRetinaScaling?this.getRetinaScaling():1),t=this.toCanvasElement(a,f);return d.util.toDataURL(t,n,o)},toCanvasElement:function(f,n){f=f||1,n=n||{};var o=(n.width||this.width)*f,a=(n.height||this.height)*f,t=this.getZoom(),i=this.width,r=this.height,e=t*f,l=this.viewportTransform,s=(l[4]-(n.left||0))*f,c=(l[5]-(n.top||0))*f,u=this.interactive,h=[e,0,0,e,s,c],p=this.enableRetinaScaling,_=d.util.createCanvasElement(),w=this.contextTop;return _.width=o,_.height=a,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=h,this.width=o,this.height=a,this.calcViewportBoundaries(),this.renderCanvas(_.getContext("2d"),this._objects),this.viewportTransform=l,this.width=i,this.height=r,this.calcViewportBoundaries(),this.interactive=u,this.enableRetinaScaling=p,this.contextTop=w,_}})}(),d.util.object.extend(d.StaticCanvas.prototype,{loadFromJSON:function(f,n,o){if(f){var a=typeof f=="string"?JSON.parse(f):d.util.object.clone(f),t=this,i=a.clipPath,r=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete a.clipPath,this._enlivenObjects(a.objects,function(e){t.clear(),t._setBgOverlay(a,function(){i?t._enlivenObjects([i],function(l){t.clipPath=l[0],t.__setupCanvas.call(t,a,e,r,n)}):t.__setupCanvas.call(t,a,e,r,n)})},o),this}},__setupCanvas:function(f,n,o,a){var t=this;n.forEach(function(i,r){t.insertAt(i,r)}),this.renderOnAddRemove=o,delete f.objects,delete f.backgroundImage,delete f.overlayImage,delete f.background,delete f.overlay,this._setOptions(f),this.renderAll(),a&&a()},_setBgOverlay:function(f,n){var o={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!f.backgroundImage&&!f.overlayImage&&!f.background&&!f.overlay){n&&n();return}var a=function(){o.backgroundImage&&o.overlayImage&&o.backgroundColor&&o.overlayColor&&n&&n()};this.__setBgOverlay("backgroundImage",f.backgroundImage,o,a),this.__setBgOverlay("overlayImage",f.overlayImage,o,a),this.__setBgOverlay("backgroundColor",f.background,o,a),this.__setBgOverlay("overlayColor",f.overlay,o,a)},__setBgOverlay:function(f,n,o,a){var t=this;if(!n){o[f]=!0,a&&a();return}f==="backgroundImage"||f==="overlayImage"?d.util.enlivenObjects([n],function(i){t[f]=i[0],o[f]=!0,a&&a()}):this["set"+d.util.string.capitalize(f,!0)](n,function(){o[f]=!0,a&&a()})},_enlivenObjects:function(f,n,o){if(!f||f.length===0){n&&n([]);return}d.util.enlivenObjects(f,function(a){n&&n(a)},null,o)},_toDataURL:function(f,n){this.clone(function(o){n(o.toDataURL(f))})},_toDataURLWithMultiplier:function(f,n,o){this.clone(function(a){o(a.toDataURLWithMultiplier(f,n))})},clone:function(f,n){var o=JSON.stringify(this.toJSON(n));this.cloneWithoutData(function(a){a.loadFromJSON(o,function(){f&&f(a)})})},cloneWithoutData:function(f){var n=d.util.createCanvasElement();n.width=this.width,n.height=this.height;var o=new d.Canvas(n);this.backgroundImage?(o.setBackgroundImage(this.backgroundImage.src,function(){o.renderAll(),f&&f(o)}),o.backgroundImageOpacity=this.backgroundImageOpacity,o.backgroundImageStretch=this.backgroundImageStretch):f&&f(o)}}),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.extend,a=n.util.object.clone,t=n.util.toFixed,i=n.util.string.capitalize,r=n.util.degreesToRadians,e=!n.isLikelyNode,l=2;n.Object||(n.Object=n.util.createClass(n.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:e,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(s){s&&this.setOptions(s)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=n.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(s){var c=n.perfLimitSizeTotal,u=s.width,h=s.height,p=n.maxCacheSideLimit,_=n.minCacheSideLimit;if(u<=p&&h<=p&&u*h<=c)return u<_&&(s.width=_),h<_&&(s.height=_),s;var w=u/h,S=n.util.limitDimsByArea(w,c),C=n.util.capValue,E=C(_,S.x,p),k=C(_,S.y,p);return u>E&&(s.zoomX/=u/E,s.width=E,s.capped=!0),h>k&&(s.zoomY/=h/k,s.height=k,s.capped=!0),s},_getCacheCanvasDimensions:function(){var s=this.getTotalObjectScaling(),c=this._getTransformedDimensions(0,0),u=c.x*s.scaleX/this.scaleX,h=c.y*s.scaleY/this.scaleY;return{width:u+l,height:h+l,zoomX:s.scaleX,zoomY:s.scaleY,x:u,y:h}},_updateCacheCanvas:function(){var s=this.canvas;if(this.noScaleCache&&s&&s._currentTransform){var c=s._currentTransform.target,u=s._currentTransform.action;if(this===c&&u.slice&&u.slice(0,5)==="scale")return!1}var h=this._cacheCanvas,p=this._limitCacheSize(this._getCacheCanvasDimensions()),_=n.minCacheSideLimit,w=p.width,S=p.height,C,E,k=p.zoomX,O=p.zoomY,U=w!==this.cacheWidth||S!==this.cacheHeight,F=this.zoomX!==k||this.zoomY!==O,M=U||F,j=0,G=0,N=!1;if(U){var R=this._cacheCanvas.width,A=this._cacheCanvas.height,H=w>R||S>A,Z=(w<R*.9||S<A*.9)&&R>_&&A>_;N=H||Z,H&&!p.capped&&(w>_||S>_)&&(j=w*.1,G=S*.1)}return this instanceof n.Text&&this.path&&(M=!0,N=!0,j+=this.getHeightOfLine(0)*this.zoomX,G+=this.getHeightOfLine(0)*this.zoomY),M?(N?(h.width=Math.ceil(w+j),h.height=Math.ceil(S+G)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,h.width,h.height)),C=p.x/2,E=p.y/2,this.cacheTranslationX=Math.round(h.width/2-C)+C,this.cacheTranslationY=Math.round(h.height/2-E)+E,this.cacheWidth=w,this.cacheHeight=S,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(k,O),this.zoomX=k,this.zoomY=O,!0):!1},setOptions:function(s){this._setOptions(s),this._initGradient(s.fill,"fill"),this._initGradient(s.stroke,"stroke"),this._initPattern(s.fill,"fill"),this._initPattern(s.stroke,"stroke")},transform:function(s){var c=this.group&&!this.group._transformDone||this.group&&this.canvas&&s===this.canvas.contextTop,u=this.calcTransformMatrix(!c);s.transform(u[0],u[1],u[2],u[3],u[4],u[5])},toObject:function(s){var c=n.Object.NUM_FRACTION_DIGITS,u={type:this.type,version:n.version,originX:this.originX,originY:this.originY,left:t(this.left,c),top:t(this.top,c),width:t(this.width,c),height:t(this.height,c),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:t(this.strokeWidth,c),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:t(this.strokeMiterLimit,c),scaleX:t(this.scaleX,c),scaleY:t(this.scaleY,c),angle:t(this.angle,c),flipX:this.flipX,flipY:this.flipY,opacity:t(this.opacity,c),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:t(this.skewX,c),skewY:t(this.skewY,c)};return this.clipPath&&!this.clipPath.excludeFromExport&&(u.clipPath=this.clipPath.toObject(s),u.clipPath.inverted=this.clipPath.inverted,u.clipPath.absolutePositioned=this.clipPath.absolutePositioned),n.util.populateWithProperties(this,u,s),this.includeDefaultValues||(u=this._removeDefaultValues(u)),u},toDatalessObject:function(s){return this.toObject(s)},_removeDefaultValues:function(s){var c=n.util.getKlass(s.type).prototype,u=c.stateProperties;return u.forEach(function(h){h==="left"||h==="top"||(s[h]===c[h]&&delete s[h],Array.isArray(s[h])&&Array.isArray(c[h])&&s[h].length===0&&c[h].length===0&&delete s[h])}),s},toString:function(){return"#<fabric."+i(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var s=n.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(s.scaleX),scaleY:Math.abs(s.scaleY)}},getTotalObjectScaling:function(){var s=this.getObjectScaling(),c=s.scaleX,u=s.scaleY;if(this.canvas){var h=this.canvas.getZoom(),p=this.canvas.getRetinaScaling();c*=h*p,u*=h*p}return{scaleX:c,scaleY:u}},getObjectOpacity:function(){var s=this.opacity;return this.group&&(s*=this.group.getObjectOpacity()),s},_set:function(s,c){var u=s==="scaleX"||s==="scaleY",h=this[s]!==c,p=!1;return u&&(c=this._constrainScale(c)),s==="scaleX"&&c<0?(this.flipX=!this.flipX,c*=-1):s==="scaleY"&&c<0?(this.flipY=!this.flipY,c*=-1):s==="shadow"&&c&&!(c instanceof n.Shadow)?c=new n.Shadow(c):s==="dirty"&&this.group&&this.group.set("dirty",c),this[s]=c,h&&(p=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(s)>-1?(this.dirty=!0,p&&this.group.set("dirty",!0)):p&&this.stateProperties.indexOf(s)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:n.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(s){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(s.save(),this._setupCompositeOperation(s),this.drawSelectionBackground(s),this.transform(s),this._setOpacity(s),this._setShadow(s,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(s)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(s),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),s.restore())},renderCache:function(s){s=s||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,s.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(s,c){if(s.save(),c.inverted?s.globalCompositeOperation="destination-out":s.globalCompositeOperation="destination-in",c.absolutePositioned){var u=n.util.invertTransform(this.calcTransformMatrix());s.transform(u[0],u[1],u[2],u[3],u[4],u[5])}c.transform(s),s.scale(1/c.zoomX,1/c.zoomY),s.drawImage(c._cacheCanvas,-c.cacheTranslationX,-c.cacheTranslationY),s.restore()},drawObject:function(s,c){var u=this.fill,h=this.stroke;c?(this.fill="black",this.stroke="",this._setClippingProperties(s)):this._renderBackground(s),this._render(s),this._drawClipPath(s,this.clipPath),this.fill=u,this.stroke=h},_drawClipPath:function(s,c){c&&(c.canvas=this.canvas,c.shouldCache(),c._transformDone=!0,c.renderCache({forClipping:!0}),this.drawClipPathOnCache(s,c))},drawCacheOnCanvas:function(s){s.scale(1/this.zoomX,1/this.zoomY),s.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(s){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!s&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!s){var c=this.cacheWidth/this.zoomX,u=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-c/2,-u/2,c,u)}return!0}return!1},_renderBackground:function(s){if(this.backgroundColor){var c=this._getNonTransformedDimensions();s.fillStyle=this.backgroundColor,s.fillRect(-c.x/2,-c.y/2,c.x,c.y),this._removeShadow(s)}},_setOpacity:function(s){this.group&&!this.group._transformDone?s.globalAlpha=this.getObjectOpacity():s.globalAlpha*=this.opacity},_setStrokeStyles:function(s,c){var u=c.stroke;u&&(s.lineWidth=c.strokeWidth,s.lineCap=c.strokeLineCap,s.lineDashOffset=c.strokeDashOffset,s.lineJoin=c.strokeLineJoin,s.miterLimit=c.strokeMiterLimit,u.toLive?u.gradientUnits==="percentage"||u.gradientTransform||u.patternTransform?this._applyPatternForTransformedGradient(s,u):(s.strokeStyle=u.toLive(s,this),this._applyPatternGradientTransform(s,u)):s.strokeStyle=c.stroke)},_setFillStyles:function(s,c){var u=c.fill;u&&(u.toLive?(s.fillStyle=u.toLive(s,this),this._applyPatternGradientTransform(s,c.fill)):s.fillStyle=u)},_setClippingProperties:function(s){s.globalAlpha=1,s.strokeStyle="transparent",s.fillStyle="#000000"},_setLineDash:function(s,c){!c||c.length===0||(1&c.length&&c.push.apply(c,c),s.setLineDash(c))},_renderControls:function(s,c){var u=this.getViewportTransform(),h=this.calcTransformMatrix(),p,_,w;c=c||{},_=typeof c.hasBorders<"u"?c.hasBorders:this.hasBorders,w=typeof c.hasControls<"u"?c.hasControls:this.hasControls,h=n.util.multiplyTransformMatrices(u,h),p=n.util.qrDecompose(h),s.save(),s.translate(p.translateX,p.translateY),s.lineWidth=1*this.borderScaleFactor,this.group||(s.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),s.rotate(r(this.group?p.angle:this.angle)),c.forActiveSelection||this.group?_&&this.drawBordersInGroup(s,p,c):_&&this.drawBorders(s,c),w&&this.drawControls(s,c),s.restore()},_setShadow:function(s){if(this.shadow){var c=this.shadow,u=this.canvas,h,p=u&&u.viewportTransform[0]||1,_=u&&u.viewportTransform[3]||1;c.nonScaling?h={scaleX:1,scaleY:1}:h=this.getObjectScaling(),u&&u._isRetinaScaling()&&(p*=n.devicePixelRatio,_*=n.devicePixelRatio),s.shadowColor=c.color,s.shadowBlur=c.blur*n.browserShadowBlurConstant*(p+_)*(h.scaleX+h.scaleY)/4,s.shadowOffsetX=c.offsetX*p*h.scaleX,s.shadowOffsetY=c.offsetY*_*h.scaleY}},_removeShadow:function(s){this.shadow&&(s.shadowColor="",s.shadowBlur=s.shadowOffsetX=s.shadowOffsetY=0)},_applyPatternGradientTransform:function(s,c){if(!c||!c.toLive)return{offsetX:0,offsetY:0};var u=c.gradientTransform||c.patternTransform,h=-this.width/2+c.offsetX||0,p=-this.height/2+c.offsetY||0;return c.gradientUnits==="percentage"?s.transform(this.width,0,0,this.height,h,p):s.transform(1,0,0,1,h,p),u&&s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),{offsetX:h,offsetY:p}},_renderPaintInOrder:function(s){this.paintFirst==="stroke"?(this._renderStroke(s),this._renderFill(s)):(this._renderFill(s),this._renderStroke(s))},_render:function(){},_renderFill:function(s){this.fill&&(s.save(),this._setFillStyles(s,this),this.fillRule==="evenodd"?s.fill("evenodd"):s.fill(),s.restore())},_renderStroke:function(s){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(s),s.save(),this.strokeUniform&&this.group){var c=this.getObjectScaling();s.scale(1/c.scaleX,1/c.scaleY)}else this.strokeUniform&&s.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(s,this.strokeDashArray),this._setStrokeStyles(s,this),s.stroke(),s.restore()}},_applyPatternForTransformedGradient:function(s,c){var u=this._limitCacheSize(this._getCacheCanvasDimensions()),h=n.util.createCanvasElement(),p,_=this.canvas.getRetinaScaling(),w=u.x/this.scaleX/_,S=u.y/this.scaleY/_;h.width=w,h.height=S,p=h.getContext("2d"),p.beginPath(),p.moveTo(0,0),p.lineTo(w,0),p.lineTo(w,S),p.lineTo(0,S),p.closePath(),p.translate(w/2,S/2),p.scale(u.zoomX/this.scaleX/_,u.zoomY/this.scaleY/_),this._applyPatternGradientTransform(p,c),p.fillStyle=c.toLive(s),p.fill(),s.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),s.scale(_*this.scaleX/u.zoomX,_*this.scaleY/u.zoomY),s.strokeStyle=p.createPattern(h,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var s=n.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",s.scaleX),this.set("scaleY",s.scaleY),this.angle=s.angle,this.skewX=s.skewX,this.skewY=0}},_removeTransformMatrix:function(s){var c=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),c=n.util.transformPoint(c,this.transformMatrix)),this.transformMatrix=null,s&&(this.scaleX*=s.scaleX,this.scaleY*=s.scaleY,this.cropX=s.cropX,this.cropY=s.cropY,c.x+=s.offsetLeft,c.y+=s.offsetTop,this.width=s.width,this.height=s.height),this.setPositionByOrigin(c,"center","center")},clone:function(s,c){var u=this.toObject(c);this.constructor.fromObject?this.constructor.fromObject(u,s):n.Object._fromObject("Object",u,s)},cloneAsImage:function(s,c){var u=this.toCanvasElement(c);return s&&s(new n.Image(u)),this},toCanvasElement:function(s){s||(s={});var c=n.util,u=c.saveObjectTransform(this),h=this.group,p=this.shadow,_=Math.abs,w=(s.multiplier||1)*(s.enableRetinaScaling?n.devicePixelRatio:1);delete this.group,s.withoutTransform&&c.resetObjectTransform(this),s.withoutShadow&&(this.shadow=null);var S=n.util.createCanvasElement(),C=this.getBoundingRect(!0,!0),E=this.shadow,k,O={x:0,y:0},U,F,M;E&&(U=E.blur,E.nonScaling?k={scaleX:1,scaleY:1}:k=this.getObjectScaling(),O.x=2*Math.round(_(E.offsetX)+U)*_(k.scaleX),O.y=2*Math.round(_(E.offsetY)+U)*_(k.scaleY)),F=C.width+O.x,M=C.height+O.y,S.width=Math.ceil(F),S.height=Math.ceil(M);var j=new n.StaticCanvas(S,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});s.format==="jpeg"&&(j.backgroundColor="#fff"),this.setPositionByOrigin(new n.Point(j.width/2,j.height/2),"center","center");var G=this.canvas;j.add(this);var N=j.toCanvasElement(w||1,s);return this.shadow=p,this.set("canvas",G),h&&(this.group=h),this.set(u).setCoords(),j._objects=[],j.dispose(),j=null,N},toDataURL:function(s){return s||(s={}),n.util.toDataURL(this.toCanvasElement(s),s.format||"png",s.quality||1)},isType:function(s){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===s},complexity:function(){return 1},toJSON:function(s){return this.toObject(s)},rotate:function(s){var c=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return c&&this._setOriginToCenter(),this.set("angle",s),c&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(s,c){c=c||this.canvas.getPointer(s);var u=new n.Point(c.x,c.y),h=this._getLeftTopCoords();return this.angle&&(u=n.util.rotatePoint(u,h,r(-this.angle))),{x:u.x-h.x,y:u.y-h.y}},_setupCompositeOperation:function(s){this.globalCompositeOperation&&(s.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){n.runningAnimations&&n.runningAnimations.cancelByTarget(this)}}),n.util.createAccessors&&n.util.createAccessors(n.Object),o(n.Object.prototype,n.Observable),n.Object.NUM_FRACTION_DIGITS=2,n.Object.ENLIVEN_PROPS=["clipPath"],n.Object._fromObject=function(s,c,u,h){var p=n[s];c=a(c,!0),n.util.enlivenPatterns([c.fill,c.stroke],function(_){typeof _[0]<"u"&&(c.fill=_[0]),typeof _[1]<"u"&&(c.stroke=_[1]),n.util.enlivenObjectEnlivables(c,c,function(){var w=h?new p(c[h],c):new p(c);u&&u(w)})})},n.Object.__uid=0)}(v),function(){var f=d.util.degreesToRadians,n={left:-.5,center:0,right:.5},o={top:-.5,center:0,bottom:.5};d.util.object.extend(d.Object.prototype,{translateToGivenOrigin:function(a,t,i,r,e){var l=a.x,s=a.y,c,u,h;return typeof t=="string"?t=n[t]:t-=.5,typeof r=="string"?r=n[r]:r-=.5,c=r-t,typeof i=="string"?i=o[i]:i-=.5,typeof e=="string"?e=o[e]:e-=.5,u=e-i,(c||u)&&(h=this._getTransformedDimensions(),l=a.x+c*h.x,s=a.y+u*h.y),new d.Point(l,s)},translateToCenterPoint:function(a,t,i){var r=this.translateToGivenOrigin(a,t,i,"center","center");return this.angle?d.util.rotatePoint(r,a,f(this.angle)):r},translateToOriginPoint:function(a,t,i){var r=this.translateToGivenOrigin(a,"center","center",t,i);return this.angle?d.util.rotatePoint(r,a,f(this.angle)):r},getCenterPoint:function(){var a=new d.Point(this.left,this.top);return this.translateToCenterPoint(a,this.originX,this.originY)},getPointByOrigin:function(a,t){var i=this.getCenterPoint();return this.translateToOriginPoint(i,a,t)},toLocalPoint:function(a,t,i){var r=this.getCenterPoint(),e,l;return typeof t<"u"&&typeof i<"u"?e=this.translateToGivenOrigin(r,"center","center",t,i):e=new d.Point(this.left,this.top),l=new d.Point(a.x,a.y),this.angle&&(l=d.util.rotatePoint(l,r,-f(this.angle))),l.subtractEquals(e)},setPositionByOrigin:function(a,t,i){var r=this.translateToCenterPoint(a,t,i),e=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",e.x),this.set("top",e.y)},adjustPosition:function(a){var t=f(this.angle),i=this.getScaledWidth(),r=d.util.cos(t)*i,e=d.util.sin(t)*i,l,s;typeof this.originX=="string"?l=n[this.originX]:l=this.originX-.5,typeof a=="string"?s=n[a]:s=a-.5,this.left+=r*(s-l),this.top+=e*(s-l),this.setCoords(),this.originX=a},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var a=this.getCenterPoint();this.originX="center",this.originY="center",this.left=a.x,this.top=a.y},_resetOrigin:function(){var a=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=a.x,this.top=a.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function f(i){return[new d.Point(i.tl.x,i.tl.y),new d.Point(i.tr.x,i.tr.y),new d.Point(i.br.x,i.br.y),new d.Point(i.bl.x,i.bl.y)]}var n=d.util,o=n.degreesToRadians,a=n.multiplyTransformMatrices,t=n.transformPoint;n.object.extend(d.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(i,r){return r?i?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),i?this.aCoords:this.lineCoords)},getCoords:function(i,r){return f(this._getCoords(i,r))},intersectsWithRect:function(i,r,e,l){var s=this.getCoords(e,l),c=d.Intersection.intersectPolygonRectangle(s,i,r);return c.status==="Intersection"},intersectsWithObject:function(i,r,e){var l=d.Intersection.intersectPolygonPolygon(this.getCoords(r,e),i.getCoords(r,e));return l.status==="Intersection"||i.isContainedWithinObject(this,r,e)||this.isContainedWithinObject(i,r,e)},isContainedWithinObject:function(i,r,e){for(var l=this.getCoords(r,e),s=r?i.aCoords:i.lineCoords,c=0,u=i._getImageLines(s);c<4;c++)if(!i.containsPoint(l[c],u))return!1;return!0},isContainedWithinRect:function(i,r,e,l){var s=this.getBoundingRect(e,l);return s.left>=i.x&&s.left+s.width<=r.x&&s.top>=i.y&&s.top+s.height<=r.y},containsPoint:function(i,c,e,l){var s=this._getCoords(e,l),c=c||this._getImageLines(s),u=this._findCrossPoints(i,c);return u!==0&&u%2===1},isOnScreen:function(i){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,e=this.canvas.vptCoords.br,l=this.getCoords(!0,i);return l.some(function(s){return s.x<=e.x&&s.x>=r.x&&s.y<=e.y&&s.y>=r.y})||this.intersectsWithRect(r,e,!0,i)?!0:this._containsCenterOfCanvas(r,e,i)},_containsCenterOfCanvas:function(i,r,e){var l={x:(i.x+r.x)/2,y:(i.y+r.y)/2};return!!this.containsPoint(l,null,!0,e)},isPartiallyOnScreen:function(i){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,e=this.canvas.vptCoords.br;if(this.intersectsWithRect(r,e,!0,i))return!0;var l=this.getCoords(!0,i).every(function(s){return(s.x>=e.x||s.x<=r.x)&&(s.y>=e.y||s.y<=r.y)});return l&&this._containsCenterOfCanvas(r,e,i)},_getImageLines:function(i){var r={topline:{o:i.tl,d:i.tr},rightline:{o:i.tr,d:i.br},bottomline:{o:i.br,d:i.bl},leftline:{o:i.bl,d:i.tl}};return r},_findCrossPoints:function(i,r){var e,l,s,c,u,h=0,p;for(var _ in r)if(p=r[_],!(p.o.y<i.y&&p.d.y<i.y)&&!(p.o.y>=i.y&&p.d.y>=i.y)&&(p.o.x===p.d.x&&p.o.x>=i.x?u=p.o.x:(e=0,l=(p.d.y-p.o.y)/(p.d.x-p.o.x),s=i.y-e*i.x,c=p.o.y-l*p.o.x,u=-(s-c)/(e-l)),u>=i.x&&(h+=1),h===2))break;return h},getBoundingRect:function(i,r){var e=this.getCoords(i,r);return n.makeBoundingBoxFromPoints(e)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(i){return Math.abs(i)<this.minScaleLimit?i<0?-this.minScaleLimit:this.minScaleLimit:i===0?1e-4:i},scale:function(i){return this._set("scaleX",i),this._set("scaleY",i),this.setCoords()},scaleToWidth:function(i,r){var e=this.getBoundingRect(r).width/this.getScaledWidth();return this.scale(i/this.width/e)},scaleToHeight:function(i,r){var e=this.getBoundingRect(r).height/this.getScaledHeight();return this.scale(i/this.height/e)},calcLineCoords:function(){var i=this.getViewportTransform(),r=this.padding,e=o(this.angle),l=n.cos(e),s=n.sin(e),c=l*r,u=s*r,h=c+u,p=c-u,_=this.calcACoords(),w={tl:t(_.tl,i),tr:t(_.tr,i),bl:t(_.bl,i),br:t(_.br,i)};return r&&(w.tl.x-=p,w.tl.y-=h,w.tr.x+=h,w.tr.y-=p,w.bl.x-=h,w.bl.y+=p,w.br.x+=p,w.br.y+=h),w},calcOCoords:function(){var i=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),e=this.getViewportTransform(),l=a(e,r),s=a(l,i),s=a(s,[1/e[0],0,0,1/e[3],0,0]),c=this._calculateCurrentDimensions(),u={};return this.forEachControl(function(h,p,_){u[p]=h.positionHandler(c,s,_)}),u},calcACoords:function(){var i=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),e=a(r,i),l=this._getTransformedDimensions(),s=l.x/2,c=l.y/2;return{tl:t({x:-s,y:-c},e),tr:t({x:s,y:-c},e),bl:t({x:-s,y:c},e),br:t({x:s,y:c},e)}},setCoords:function(i){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),i?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return n.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var i=this.getCenterPoint();return[1,0,0,1,i.x,i.y]},transformMatrixKey:function(i){var r="_",e="";return!i&&this.group&&(e=this.group.transformMatrixKey(i)+r),e+this.top+r+this.left+r+this.scaleX+r+this.scaleY+r+this.skewX+r+this.skewY+r+this.angle+r+this.originX+r+this.originY+r+this.width+r+this.height+r+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(i){var r=this.calcOwnMatrix();if(i||!this.group)return r;var e=this.transformMatrixKey(i),l=this.matrixCache||(this.matrixCache={});return l.key===e?l.value:(this.group&&(r=a(this.group.calcTransformMatrix(!1),r)),l.key=e,l.value=r,r)},calcOwnMatrix:function(){var i=this.transformMatrixKey(!0),r=this.ownMatrixCache||(this.ownMatrixCache={});if(r.key===i)return r.value;var e=this._calcTranslateMatrix(),l={angle:this.angle,translateX:e[4],translateY:e[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return r.key=i,r.value=n.composeMatrix(l),r.value},_getNonTransformedDimensions:function(){var i=this.strokeWidth,r=this.width+i,e=this.height+i;return{x:r,y:e}},_getTransformedDimensions:function(i,r){typeof i>"u"&&(i=this.skewX),typeof r>"u"&&(r=this.skewY);var e,l,s,c=i===0&&r===0;if(this.strokeUniform?(l=this.width,s=this.height):(e=this._getNonTransformedDimensions(),l=e.x,s=e.y),c)return this._finalizeDimensions(l*this.scaleX,s*this.scaleY);var u=n.sizeAfterTransform(l,s,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:i,skewY:r});return this._finalizeDimensions(u.x,u.y)},_finalizeDimensions:function(i,r){return this.strokeUniform?{x:i+this.strokeWidth,y:r+this.strokeWidth}:{x:i,y:r}},_calculateCurrentDimensions:function(){var i=this.getViewportTransform(),r=this._getTransformedDimensions(),e=t(r,i,!0);return e.scalarAdd(2*this.padding)}})}(),d.util.object.extend(d.Object.prototype,{sendToBack:function(){return this.group?d.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?d.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(f){return this.group?d.StaticCanvas.prototype.sendBackwards.call(this.group,this,f):this.canvas&&this.canvas.sendBackwards(this,f),this},bringForward:function(f){return this.group?d.StaticCanvas.prototype.bringForward.call(this.group,this,f):this.canvas&&this.canvas.bringForward(this,f),this},moveTo:function(f){return this.group&&this.group.type!=="activeSelection"?d.StaticCanvas.prototype.moveTo.call(this.group,this,f):this.canvas&&this.canvas.moveTo(this,f),this}}),function(){function f(o,a){if(a){if(a.toLive)return o+": url(#SVGID_"+a.id+"); ";var t=new d.Color(a),i=o+": "+t.toRgb()+"; ",r=t.getAlpha();return r!==1&&(i+=o+"-opacity: "+r.toString()+"; "),i}else return o+": none; "}var n=d.util.toFixed;d.util.object.extend(d.Object.prototype,{getSvgStyles:function(o){var a=this.fillRule?this.fillRule:"nonzero",t=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):"none",r=this.strokeDashOffset?this.strokeDashOffset:"0",e=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",s=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=typeof this.opacity<"u"?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=o?"":this.getSvgFilter(),p=f("fill",this.fill),_=f("stroke",this.stroke);return[_,"stroke-width: ",t,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",e,"; ","stroke-dashoffset: ",r,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",s,"; ",p,"fill-rule: ",a,"; ","opacity: ",c,";",h,u].join("")},getSvgSpanStyles:function(o,a){var t="; ",r=o.fontFamily?"font-family: "+(o.fontFamily.indexOf("'")===-1&&o.fontFamily.indexOf('"')===-1?"'"+o.fontFamily+"'":o.fontFamily)+t:"",i=o.strokeWidth?"stroke-width: "+o.strokeWidth+t:"",r=r,e=o.fontSize?"font-size: "+o.fontSize+"px"+t:"",l=o.fontStyle?"font-style: "+o.fontStyle+t:"",s=o.fontWeight?"font-weight: "+o.fontWeight+t:"",c=o.fill?f("fill",o.fill):"",u=o.stroke?f("stroke",o.stroke):"",h=this.getSvgTextDecoration(o),p=o.deltaY?"baseline-shift: "+-o.deltaY+"; ":"";return h&&(h="text-decoration: "+h+t),[u,i,r,e,l,s,h,c,p,a?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(o){return["overline","underline","line-through"].filter(function(a){return o[a.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(o,a){var t=o?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'+d.util.matrixToSVG(t);return i+(a||"")+'" '},_setSVGBg:function(o){if(this.backgroundColor){var a=d.Object.NUM_FRACTION_DIGITS;o.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',n(-this.width/2,a),'" y="',n(-this.height/2,a),'" width="',n(this.width,a),'" height="',n(this.height,a),'"></rect>\n')}},toSVG:function(o){return this._createBaseSVGMarkup(this._toSVG(o),{reviver:o})},toClipPathSVG:function(o){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(o),{reviver:o})},_createBaseClipPathSVGMarkup:function(o,a){a=a||{};var t=a.reviver,i=a.additionalTransform||"",r=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),e=o.indexOf("COMMON_PARTS");return o[e]=r,t?t(o.join("")):o.join("")},_createBaseSVGMarkup:function(o,a){a=a||{};var t=a.noStyle,i=a.reviver,r=t?"":'style="'+this.getSvgStyles()+'" ',e=a.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,s=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=l&&l.absolutePositioned,u=this.stroke,h=this.fill,p=this.shadow,_,w=[],S,C=o.indexOf("COMMON_PARTS"),E=a.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+d.Object.__uid++,S='<clipPath id="'+l.clipPathId+'" >\n'+l.toClipPathSVG(i)+"</clipPath>\n"),c&&w.push("<g ",e,this.getSvgCommons()," >\n"),w.push("<g ",this.getSvgTransform(!1),c?"":e+this.getSvgCommons()," >\n"),_=[r,s,t?"":this.addPaintOrder()," ",E?'transform="'+E+'" ':""].join(""),o[C]=_,h&&h.toLive&&w.push(h.toSVG(this)),u&&u.toLive&&w.push(u.toSVG(this)),p&&w.push(p.toSVG(this)),l&&w.push(S),w.push(o.join("")),w.push("</g>\n"),c&&w.push("</g>\n"),i?i(w.join("")):w.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var f=d.util.object.extend,n="stateProperties";function o(t,i,r){var e={},l=!0;r.forEach(function(s){e[s]=t[s]}),f(t[i],e,l)}function a(t,i,r){if(t===i)return!0;if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var e=0,l=t.length;e<l;e++)if(!a(t[e],i[e]))return!1;return!0}else if(t&&typeof t=="object"){var s=Object.keys(t),c;if(!i||typeof i!="object"||!r&&s.length!==Object.keys(i).length)return!1;for(var e=0,l=s.length;e<l;e++)if(c=s[e],!(c==="canvas"||c==="group")&&!a(t[c],i[c]))return!1;return!0}}d.util.object.extend(d.Object.prototype,{hasStateChanged:function(t){t=t||n;var i="_"+t;return Object.keys(this[i]).length<this[t].length?!0:!a(this[i],this,!0)},saveState:function(t){var i=t&&t.propertySet||n,r="_"+i;return this[r]?(o(this,r,this[i]),t&&t.stateProperties&&o(this,r,t.stateProperties),this):this.setupState(t)},setupState:function(t){t=t||{};var i=t.propertySet||n;return t.propertySet=i,this["_"+i]={},this.saveState(t),this}})}(),function(){var f=d.util.degreesToRadians;d.util.object.extend(d.Object.prototype,{_findTargetCorner:function(n,o){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var a=n.x,t=n.y,i,r,e=Object.keys(this.oCoords),l=e.length-1,s;for(this.__corner=0;l>=0;l--)if(s=e[l],!!this.isControlVisible(s)&&(r=this._getImageLines(o?this.oCoords[s].touchCorner:this.oCoords[s].corner),i=this._findCrossPoints({x:a,y:t},r),i!==0&&i%2===1))return this.__corner=s,s;return!1},forEachControl:function(n){for(var o in this.controls)n(this.controls[o],o,this)},_setCornerCoords:function(){var n=this.oCoords;for(var o in n){var a=this.controls[o];n[o].corner=a.calcCornerCoords(this.angle,this.cornerSize,n[o].x,n[o].y,!1),n[o].touchCorner=a.calcCornerCoords(this.angle,this.touchCornerSize,n[o].x,n[o].y,!0)}},drawSelectionBackground:function(n){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;n.save();var o=this.getCenterPoint(),a=this._calculateCurrentDimensions(),t=this.canvas.viewportTransform;return n.translate(o.x,o.y),n.scale(1/t[0],1/t[3]),n.rotate(f(this.angle)),n.fillStyle=this.selectionBackgroundColor,n.fillRect(-a.x/2,-a.y/2,a.x,a.y),n.restore(),this},drawBorders:function(n,o){o=o||{};var a=this._calculateCurrentDimensions(),t=this.borderScaleFactor,i=a.x+t,r=a.y+t,e=typeof o.hasControls<"u"?o.hasControls:this.hasControls,l=!1;return n.save(),n.strokeStyle=o.borderColor||this.borderColor,this._setLineDash(n,o.borderDashArray||this.borderDashArray),n.strokeRect(-i/2,-r/2,i,r),e&&(n.beginPath(),this.forEachControl(function(s,c,u){s.withConnection&&s.getVisibility(u,c)&&(l=!0,n.moveTo(s.x*i,s.y*r),n.lineTo(s.x*i+s.offsetX,s.y*r+s.offsetY))}),l&&n.stroke()),n.restore(),this},drawBordersInGroup:function(n,o,a){a=a||{};var t=d.util.sizeAfterTransform(this.width,this.height,o),i=this.strokeWidth,r=this.strokeUniform,e=this.borderScaleFactor,l=t.x+i*(r?this.canvas.getZoom():o.scaleX)+e,s=t.y+i*(r?this.canvas.getZoom():o.scaleY)+e;return n.save(),this._setLineDash(n,a.borderDashArray||this.borderDashArray),n.strokeStyle=a.borderColor||this.borderColor,n.strokeRect(-l/2,-s/2,l,s),n.restore(),this},drawControls:function(n,o){o=o||{},n.save();var a=this.canvas.getRetinaScaling(),t,i;return n.setTransform(a,0,0,a,0,0),n.strokeStyle=n.fillStyle=o.cornerColor||this.cornerColor,this.transparentCorners||(n.strokeStyle=o.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(n,o.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(t=this.group.calcTransformMatrix()),this.forEachControl(function(r,e,l){i=l.oCoords[e],r.getVisibility(l,e)&&(t&&(i=d.util.transformPoint(i,t)),r.render(n,i.x,i.y,o,l))}),n.restore(),this},isControlVisible:function(n){return this.controls[n]&&this.controls[n].getVisibility(this,n)},setControlVisible:function(n,o){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[n]=o,this},setControlsVisibility:function(n){n||(n={});for(var o in n)this.setControlVisible(o,n[o]);return this},onDeselect:function(){},onSelect:function(){}})}(),d.util.object.extend(d.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(f,n){n=n||{};var o=function(){},a=n.onComplete||o,t=n.onChange||o,i=this;return d.util.animate({target:this,startValue:f.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(r){f.set("left",r),i.requestRenderAll(),t()},onComplete:function(){f.setCoords(),a()}})},fxCenterObjectV:function(f,n){n=n||{};var o=function(){},a=n.onComplete||o,t=n.onChange||o,i=this;return d.util.animate({target:this,startValue:f.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(r){f.set("top",r),i.requestRenderAll(),t()},onComplete:function(){f.setCoords(),a()}})},fxRemove:function(f,n){n=n||{};var o=function(){},a=n.onComplete||o,t=n.onChange||o,i=this;return d.util.animate({target:this,startValue:f.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(r){f.set("opacity",r),i.requestRenderAll(),t()},onComplete:function(){i.remove(f),a()}})}}),d.util.object.extend(d.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var f=[],n,o,a=[];for(n in arguments[0])f.push(n);for(var t=0,i=f.length;t<i;t++)n=f[t],o=t!==i-1,a.push(this._animate(n,arguments[0][n],arguments[1],o));return a}else return this._animate.apply(this,arguments)},_animate:function(f,n,o,a){var t=this,i;n=n.toString(),o?o=d.util.object.clone(o):o={},~f.indexOf(".")&&(i=f.split("."));var r=t.colorProperties.indexOf(f)>-1||i&&t.colorProperties.indexOf(i[1])>-1,e=i?this.get(i[0])[i[1]]:this.get(f);"from"in o||(o.from=e),r||(~n.indexOf("=")?n=e+parseFloat(n.replace("=","")):n=parseFloat(n));var l={target:this,startValue:o.from,endValue:n,byValue:o.by,easing:o.easing,duration:o.duration,abort:o.abort&&function(s,c,u){return o.abort.call(t,s,c,u)},onChange:function(s,c,u){i?t[i[0]][i[1]]=s:t.set(f,s),!a&&o.onChange&&o.onChange(s,c,u)},onComplete:function(s,c,u){a||(t.setCoords(),o.onComplete&&o.onComplete(s,c,u))}};return r?d.util.animateColor(l.startValue,l.endValue,l.duration,l):d.util.animate(l)}}),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.extend,a=n.util.object.clone,t={x1:1,x2:1,y1:1,y2:1};if(n.Line){n.warn("fabric.Line is already defined");return}n.Line=n.util.createClass(n.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:n.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(r,e){r||(r=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",r[0]),this.set("y1",r[1]),this.set("x2",r[2]),this.set("y2",r[3]),this._setWidthHeight(e)},_setWidthHeight:function(r){r||(r={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in r?r.left:this._getLeftToOriginX(),this.top="top"in r?r.top:this._getTopToOriginY()},_set:function(r,e){return this.callSuper("_set",r,e),typeof t[r]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:i({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:i({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(r){r.beginPath();var e=this.calcLinePoints();r.moveTo(e.x1,e.y1),r.lineTo(e.x2,e.y2),r.lineWidth=this.strokeWidth;var l=r.strokeStyle;r.strokeStyle=this.stroke||r.fillStyle,this.stroke&&this._renderStroke(r),r.strokeStyle=l},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(r){return o(this.callSuper("toObject",r),this.calcLinePoints())},_getNonTransformedDimensions:function(){var r=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(r.y-=this.strokeWidth),this.height===0&&(r.x-=this.strokeWidth)),r},calcLinePoints:function(){var r=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,l=r*this.width*.5,s=e*this.height*.5,c=r*this.width*-.5,u=e*this.height*-.5;return{x1:l,x2:c,y1:s,y2:u}},_toSVG:function(){var r=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,'" />\n']}}),n.Line.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),n.Line.fromElement=function(r,e,l){l=l||{};var s=n.parseAttributes(r,n.Line.ATTRIBUTE_NAMES),c=[s.x1||0,s.y1||0,s.x2||0,s.y2||0];e(new n.Line(c,o(s,l)))},n.Line.fromObject=function(r,e){function l(c){delete c.points,e&&e(c)}var s=a(r,!0);s.points=[r.x1,r.y1,r.x2,r.y2],n.Object._fromObject("Line",s,l,"points")};function i(r,e){var l=r.origin,s=r.axis1,c=r.axis2,u=r.dimension,h=e.nearest,p=e.center,_=e.farthest;return function(){switch(this.get(l)){case h:return Math.min(this.get(s),this.get(c));case p:return Math.min(this.get(s),this.get(c))+.5*this.get(u);case _:return Math.max(this.get(s),this.get(c))}}}}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.degreesToRadians;if(n.Circle){n.warn("fabric.Circle is already defined.");return}n.Circle=n.util.createClass(n.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:n.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,i){return this.callSuper("_set",t,i),t==="radius"&&this.setRadius(i),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},_toSVG:function(){var t,i=0,r=0,e=(this.endAngle-this.startAngle)%360;if(e===0)t=["<circle ","COMMON_PARTS",'cx="'+i+'" cy="'+r+'" ','r="',this.radius,'" />\n'];else{var l=o(this.startAngle),s=o(this.endAngle),c=this.radius,u=n.util.cos(l)*c,h=n.util.sin(l)*c,p=n.util.cos(s)*c,_=n.util.sin(s)*c,w=e>180?"1":"0";t=['<path d="M '+u+" "+h," A "+c+" "+c," 0 ",+w+" 1"," "+p+" "+_,'" ',"COMMON_PARTS"," />\n"]}return t},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,o(this.startAngle),o(this.endAngle),!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",t*2).set("height",t*2)}}),n.Circle.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),n.Circle.fromElement=function(t,i){var r=n.parseAttributes(t,n.Circle.ATTRIBUTE_NAMES);if(!a(r))throw new Error("value of `r` attribute is required and can not be negative");r.left=(r.left||0)-r.radius,r.top=(r.top||0)-r.radius,i(new n.Circle(r))};function a(t){return"radius"in t&&t.radius>=0}n.Circle.fromObject=function(t,i){n.Object._fromObject("Circle",t,i)}}(v),function(f){var n=f.fabric||(f.fabric={});if(n.Triangle){n.warn("fabric.Triangle is already defined");return}n.Triangle=n.util.createClass(n.Object,{type:"triangle",width:100,height:100,_render:function(o){var a=this.width/2,t=this.height/2;o.beginPath(),o.moveTo(-a,t),o.lineTo(0,-t),o.lineTo(a,t),o.closePath(),this._renderPaintInOrder(o)},_toSVG:function(){var o=this.width/2,a=this.height/2,t=[-o+" "+a,"0 "+-a,o+" "+a].join(",");return["<polygon ","COMMON_PARTS",'points="',t,'" />']}}),n.Triangle.fromObject=function(o,a){return n.Object._fromObject("Triangle",o,a)}}(v),function(f){var n=f.fabric||(f.fabric={}),o=Math.PI*2;if(n.Ellipse){n.warn("fabric.Ellipse is already defined.");return}n.Ellipse=n.util.createClass(n.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:n.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(a){this.callSuper("initialize",a),this.set("rx",a&&a.rx||0),this.set("ry",a&&a.ry||0)},_set:function(a,t){switch(this.callSuper("_set",a,t),a){case"rx":this.rx=t,this.set("width",t*2);break;case"ry":this.ry=t,this.set("height",t*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(a){return this.callSuper("toObject",["rx","ry"].concat(a))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(a){a.beginPath(),a.save(),a.transform(1,0,0,this.ry/this.rx,0,0),a.arc(0,0,this.rx,0,o,!1),a.restore(),this._renderPaintInOrder(a)}}),n.Ellipse.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),n.Ellipse.fromElement=function(a,t){var i=n.parseAttributes(a,n.Ellipse.ATTRIBUTE_NAMES);i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,t(new n.Ellipse(i))},n.Ellipse.fromObject=function(a,t){n.Object._fromObject("Ellipse",a,t)}}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.extend;if(n.Rect){n.warn("fabric.Rect is already defined");return}n.Rect=n.util.createClass(n.Object,{stateProperties:n.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:n.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(a){this.callSuper("initialize",a),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(a){var t=this.rx?Math.min(this.rx,this.width/2):0,i=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,e=this.height,l=-this.width/2,s=-this.height/2,c=t!==0||i!==0,u=1-.5522847498;a.beginPath(),a.moveTo(l+t,s),a.lineTo(l+r-t,s),c&&a.bezierCurveTo(l+r-u*t,s,l+r,s+u*i,l+r,s+i),a.lineTo(l+r,s+e-i),c&&a.bezierCurveTo(l+r,s+e-u*i,l+r-u*t,s+e,l+r-t,s+e),a.lineTo(l+t,s+e),c&&a.bezierCurveTo(l+u*t,s+e,l,s+e-u*i,l,s+e-i),a.lineTo(l,s+i),c&&a.bezierCurveTo(l,s+u*i,l+u*t,s,l+t,s),a.closePath(),this._renderPaintInOrder(a)},toObject:function(a){return this.callSuper("toObject",["rx","ry"].concat(a))},_toSVG:function(){var a=-this.width/2,t=-this.height/2;return["<rect ","COMMON_PARTS",'x="',a,'" y="',t,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),n.Rect.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),n.Rect.fromElement=function(a,t,i){if(!a)return t(null);i=i||{};var r=n.parseAttributes(a,n.Rect.ATTRIBUTE_NAMES);r.left=r.left||0,r.top=r.top||0,r.height=r.height||0,r.width=r.width||0;var e=new n.Rect(o(i?n.util.object.clone(i):{},r));e.visible=e.visible&&e.width>0&&e.height>0,t(e)},n.Rect.fromObject=function(a,t){return n.Object._fromObject("Rect",a,t)}}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.extend,a=n.util.array.min,t=n.util.array.max,i=n.util.toFixed,r=n.util.projectStrokeOnPoints;if(n.Polyline){n.warn("fabric.Polyline is already defined");return}n.Polyline=n.util.createClass(n.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:n.Object.prototype.cacheProperties.concat("points"),initialize:function(e,l){l=l||{},this.points=e||[],this.callSuper("initialize",l),this._setPositionDimensions(l)},_projectStrokeOnPoints:function(){return r(this.points,this,!0)},_setPositionDimensions:function(e){var l=this._calcDimensions(e),s,c=this.exactBoundingBox?this.strokeWidth:0;this.width=l.width-c,this.height=l.height-c,e.fromSVG||(s=this.translateToGivenOrigin({x:l.left-this.strokeWidth/2+c/2,y:l.top-this.strokeWidth/2+c/2},"left","top",this.originX,this.originY)),typeof e.left>"u"&&(this.left=e.fromSVG?l.left:s.x),typeof e.top>"u"&&(this.top=e.fromSVG?l.top:s.y),this.pathOffset={x:l.left+this.width/2+c/2,y:l.top+this.height/2+c/2}},_calcDimensions:function(){var e=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,l=a(e,"x")||0,s=a(e,"y")||0,c=t(e,"x")||0,u=t(e,"y")||0,h=c-l,p=u-s;return{left:l,top:s,width:h,height:p}},toObject:function(e){return o(this.callSuper("toObject",e),{points:this.points.concat()})},_toSVG:function(){for(var e=[],l=this.pathOffset.x,s=this.pathOffset.y,c=n.Object.NUM_FRACTION_DIGITS,u=0,h=this.points.length;u<h;u++)e.push(i(this.points[u].x-l,c),",",i(this.points[u].y-s,c)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',e.join(""),'" />\n']},commonRender:function(e){var l,s=this.points.length,c=this.pathOffset.x,u=this.pathOffset.y;if(!s||isNaN(this.points[s-1].y))return!1;e.beginPath(),e.moveTo(this.points[0].x-c,this.points[0].y-u);for(var h=0;h<s;h++)l=this.points[h],e.lineTo(l.x-c,l.y-u);return!0},_render:function(e){this.commonRender(e)&&this._renderPaintInOrder(e)},complexity:function(){return this.get("points").length}}),n.Polyline.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat(),n.Polyline.fromElementGenerator=function(e){return function(l,s,c){if(!l)return s(null);c||(c={});var u=n.parsePointsAttribute(l.getAttribute("points")),h=n.parseAttributes(l,n[e].ATTRIBUTE_NAMES);h.fromSVG=!0,s(new n[e](u,o(h,c)))}},n.Polyline.fromElement=n.Polyline.fromElementGenerator("Polyline"),n.Polyline.fromObject=function(e,l){return n.Object._fromObject("Polyline",e,l,"points")}}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.projectStrokeOnPoints;if(n.Polygon){n.warn("fabric.Polygon is already defined");return}n.Polygon=n.util.createClass(n.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return o(this.points,this)},_render:function(a){this.commonRender(a)&&(a.closePath(),this._renderPaintInOrder(a))}}),n.Polygon.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat(),n.Polygon.fromElement=n.Polyline.fromElementGenerator("Polygon"),n.Polygon.fromObject=function(a,t){n.Object._fromObject("Polygon",a,t,"points")}}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.array.min,a=n.util.array.max,t=n.util.object.extend,i=n.util.object.clone,r=n.util.toFixed;if(n.Path){n.warn("fabric.Path is already defined");return}n.Path=n.util.createClass(n.Object,{type:"path",path:null,cacheProperties:n.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:n.Object.prototype.stateProperties.concat("path"),initialize:function(e,l){l=i(l||{}),delete l.path,this.callSuper("initialize",l),this._setPath(e||[],l)},_setPath:function(e,l){this.path=n.util.makePathSimpler(Array.isArray(e)?e:n.util.parsePath(e)),n.Polyline.prototype._setPositionDimensions.call(this,l||{})},_renderPathCommands:function(e){var l,s=0,c=0,u=0,h=0,p=0,_=0,w=-this.pathOffset.x,S=-this.pathOffset.y;e.beginPath();for(var C=0,E=this.path.length;C<E;++C)switch(l=this.path[C],l[0]){case"L":u=l[1],h=l[2],e.lineTo(u+w,h+S);break;case"M":u=l[1],h=l[2],s=u,c=h,e.moveTo(u+w,h+S);break;case"C":u=l[5],h=l[6],p=l[3],_=l[4],e.bezierCurveTo(l[1]+w,l[2]+S,p+w,_+S,u+w,h+S);break;case"Q":e.quadraticCurveTo(l[1]+w,l[2]+S,l[3]+w,l[4]+S),u=l[3],h=l[4],p=l[1],_=l[2];break;case"z":case"Z":u=s,h=c,e.closePath();break}},_render:function(e){this._renderPathCommands(e),this._renderPaintInOrder(e)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(e){return t(this.callSuper("toObject",e),{path:this.path.map(function(l){return l.slice()})})},toDatalessObject:function(e){var l=this.toObject(["sourcePath"].concat(e));return l.sourcePath&&delete l.path,l},_toSVG:function(){var e=n.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',e,'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var e=n.Object.NUM_FRACTION_DIGITS;return" translate("+r(-this.pathOffset.x,e)+", "+r(-this.pathOffset.y,e)+")"},toClipPathSVG:function(e){var l=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:l})},toSVG:function(e){var l=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:l})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var e=[],l=[],s,c=0,u=0,h=0,p=0,_,w=0,S=this.path.length;w<S;++w){switch(s=this.path[w],s[0]){case"L":h=s[1],p=s[2],_=[];break;case"M":h=s[1],p=s[2],c=h,u=p,_=[];break;case"C":_=n.util.getBoundsOfCurve(h,p,s[1],s[2],s[3],s[4],s[5],s[6]),h=s[5],p=s[6];break;case"Q":_=n.util.getBoundsOfCurve(h,p,s[1],s[2],s[1],s[2],s[3],s[4]),h=s[3],p=s[4];break;case"z":case"Z":h=c,p=u;break}_.forEach(function(M){e.push(M.x),l.push(M.y)}),e.push(h),l.push(p)}var C=o(e)||0,E=o(l)||0,k=a(e)||0,O=a(l)||0,U=k-C,F=O-E;return{left:C,top:E,width:U,height:F}}}),n.Path.fromObject=function(e,l){if(typeof e.sourcePath=="string"){var s=e.sourcePath;n.loadSVGFromURL(s,function(c){var u=c[0];u.setOptions(e),e.clipPath?n.util.enlivenObjects([e.clipPath],function(h){u.clipPath=h[0],l&&l(u)}):l&&l(u)})}else n.Object._fromObject("Path",e,l,"path")},n.Path.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat(["d"]),n.Path.fromElement=function(e,l,s){var c=n.parseAttributes(e,n.Path.ATTRIBUTE_NAMES);c.fromSVG=!0,l(new n.Path(c.d,t(c,s)))}}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.array.min,a=n.util.array.max;n.Group||(n.Group=n.util.createClass(n.Object,n.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,i,r){i=i||{},this._objects=[],r&&this.callSuper("initialize",i),this._objects=t||[];for(var e=this._objects.length;e--;)this._objects[e].group=this;if(r)this._updateObjectsACoords();else{var l=i&&i.centerPoint;i.originX!==void 0&&(this.originX=i.originX),i.originY!==void 0&&(this.originY=i.originY),l||this._calcBounds(),this._updateObjectsCoords(l),delete i.centerPoint,this.callSuper("initialize",i)}this.setCoords()},_updateObjectsACoords:function(){for(var t=!0,i=this._objects.length;i--;)this._objects[i].setCoords(t)},_updateObjectsCoords:function(i){for(var i=i||this.getCenterPoint(),r=this._objects.length;r--;)this._updateObjectCoords(this._objects[r],i)},_updateObjectCoords:function(t,i){var r=t.left,e=t.top,l=!0;t.set({left:r-i.x,top:e-i.y}),t.group=this,t.setCoords(l)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){var i=!!this.group;return this._restoreObjectsState(),n.util.resetObjectTransform(this),t&&(i&&n.util.removeTransformFromObject(t,this.group.calcTransformMatrix()),this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,i?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(t){return this._restoreObjectsState(),n.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,i){var r=this._objects.length;if(this.useSetOnGroup)for(;r--;)this._objects[r].setOnGroup(t,i);if(t==="canvas")for(;r--;)this._objects[r]._set(t,i);n.Object.prototype._set.call(this,t,i)},toObject:function(t){var i=this.includeDefaultValues,r=this._objects.filter(function(l){return!l.excludeFromExport}).map(function(l){var s=l.includeDefaultValues;l.includeDefaultValues=i;var c=l.toObject(t);return l.includeDefaultValues=s,c}),e=n.Object.prototype.toObject.call(this,t);return e.objects=r,e},toDatalessObject:function(t){var i,r=this.sourcePath;if(r)i=r;else{var e=this.includeDefaultValues;i=this._objects.map(function(s){var c=s.includeDefaultValues;s.includeDefaultValues=e;var u=s.toDatalessObject(t);return s.includeDefaultValues=c,u})}var l=n.Object.prototype.toDatalessObject.call(this,t);return l.objects=i,l},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=n.Object.prototype.shouldCache.call(this);if(t){for(var i=0,r=this._objects.length;i<r;i++)if(this._objects[i].willDrawShadow())return this.ownCaching=!1,!1}return t},willDrawShadow:function(){if(n.Object.prototype.willDrawShadow.call(this))return!0;for(var t=0,i=this._objects.length;t<i;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var i=0,r=this._objects.length;i<r;i++)this._objects[i].render(t);this._drawClipPath(t,this.clipPath)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var i=0,r=this._objects.length;i<r;i++)if(this._objects[i].isCacheDirty(!0)){if(this._cacheCanvas){var e=this.cacheWidth/this.zoomX,l=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-l/2,e,l)}return!0}return!1},_restoreObjectsState:function(){var t=this.calcOwnMatrix();return this._objects.forEach(function(i){n.util.addTransformToObject(i,t),delete i.group,i.setCoords()}),this},destroy:function(){return this._objects.forEach(function(t){t.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(t){t.dispose&&t.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var t=this._objects,i=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var e=new n.ActiveSelection([]);return e.set(r),e.type="activeSelection",i.remove(this),t.forEach(function(l){l.group=e,l.dirty=!0,i.add(l)}),e.canvas=i,e._objects=t,i._activeObject=e,e.setCoords(),e}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var t=!0;return this.forEachObject(function(i){i.setCoords(t)}),this},_calcBounds:function(t){for(var i=[],r=[],e,l,s,c=["tr","br","bl","tl"],u=0,h=this._objects.length,p,_=c.length;u<h;++u){for(e=this._objects[u],s=e.calcACoords(),p=0;p<_;p++)l=c[p],i.push(s[l].x),r.push(s[l].y);e.aCoords=s}this._getBounds(i,r,t)},_getBounds:function(t,i,r){var e=new n.Point(o(t),o(i)),l=new n.Point(a(t),a(i)),s=e.y||0,c=e.x||0,u=l.x-e.x||0,h=l.y-e.y||0;this.width=u,this.height=h,r||this.setPositionByOrigin({x:c,y:s},"left","top")},_toSVG:function(t){for(var i=["<g ","COMMON_PARTS"," >\n"],r=0,e=this._objects.length;r<e;r++)i.push("		",this._objects[r].toSVG(t));return i.push("</g>\n"),i},getSvgStyles:function(){var t=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",i=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),i].join("")},toClipPathSVG:function(t){for(var i=[],r=0,e=this._objects.length;r<e;r++)i.push("	",this._objects[r].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(i,{reviver:t})}}),n.Group.fromObject=function(t,i){var r=t.objects,e=n.util.object.clone(t,!0);if(delete e.objects,typeof r=="string"){n.loadSVGFromURL(r,function(l){var s=n.util.groupSVGElements(l,t,r),c=e.clipPath;delete e.clipPath,s.set(e),c?n.util.enlivenObjects([c],function(u){s.clipPath=u[0],i&&i(s)}):i&&i(s)});return}n.util.enlivenObjects(r,function(l){n.util.enlivenObjectEnlivables(t,e,function(){i&&i(new n.Group(l,e,!0))})})})}(v),function(f){var n=f.fabric||(f.fabric={});n.ActiveSelection||(n.ActiveSelection=n.util.createClass(n.Group,{type:"activeSelection",initialize:function(o,a){a=a||{},this._objects=o||[];for(var t=this._objects.length;t--;)this._objects[t].group=this;a.originX&&(this.originX=a.originX),a.originY&&(this.originY=a.originY),this._calcBounds(),this._updateObjectsCoords(),n.Object.prototype.initialize.call(this,a),this.setCoords()},toGroup:function(){var o=this._objects.concat();this._objects=[];var a=n.Object.prototype.toObject.call(this),t=new n.Group([]);if(delete a.type,t.set(a),o.forEach(function(r){r.canvas.remove(r),r.group=t}),t._objects=o,!this.canvas)return t;var i=this.canvas;return i.add(t),i._activeObject=t,t.setCoords(),t},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(o,a,t){o.save(),o.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",o,a),t=t||{},typeof t.hasControls>"u"&&(t.hasControls=!1),t.forActiveSelection=!0;for(var i=0,r=this._objects.length;i<r;i++)this._objects[i]._renderControls(o,t);o.restore()}}),n.ActiveSelection.fromObject=function(o,a){n.util.enlivenObjects(o.objects,function(t){delete o.objects,a&&a(new n.ActiveSelection(t,o,!0))})})}(v),function(f){var n=d.util.object.extend;if(f.fabric||(f.fabric={}),f.fabric.Image){d.warn("fabric.Image is already defined.");return}d.Image=d.util.createClass(d.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:d.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:d.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(o,a){a||(a={}),this.filters=[],this.cacheKey="texture"+d.Object.__uid++,this.callSuper("initialize",a),this._initElement(o,a)},getElement:function(){return this._element||{}},setElement:function(o,a){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=o,this._originalElement=o,this._initConfig(a),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(o){var a=d.filterBackend;a&&a.evictCachesForKey&&a.evictCachesForKey(o)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(o){d.util.cleanUpJsdomNode(this[o]),this[o]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var o=this.getElement();return{width:o.naturalWidth||o.width,height:o.naturalHeight||o.height}},_stroke:function(o){if(!(!this.stroke||this.strokeWidth===0)){var a=this.width/2,t=this.height/2;o.beginPath(),o.moveTo(-a,-t),o.lineTo(a,-t),o.lineTo(a,t),o.lineTo(-a,t),o.lineTo(-a,-t),o.closePath()}},toObject:function(o){var a=[];this.filters.forEach(function(i){i&&a.push(i.toObject())});var t=n(this.callSuper("toObject",["cropX","cropY"].concat(o)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:a});return this.resizeFilter&&(t.resizeFilter=this.resizeFilter.toObject()),t},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var o=[],a=[],t,i=this._element,r=-this.width/2,e=-this.height/2,l="",s="";if(!i)return[];if(this.hasCrop()){var c=d.Object.__uid++;o.push('<clipPath id="imageCrop_'+c+'">\n','	<rect x="'+r+'" y="'+e+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),l=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(s='" image-rendering="optimizeSpeed'),a.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',r-this.cropX,'" y="',e-this.cropY,'" width="',i.width||i.naturalWidth,'" height="',i.height||i.height,s,'"',l,"></image>\n"),this.stroke||this.strokeDashArray){var u=this.fill;this.fill=null,t=["	<rect ",'x="',r,'" y="',e,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=u}return this.paintFirst!=="fill"?o=o.concat(t,a):o=o.concat(a,t),o},getSrc:function(o){var a=o?this._element:this._originalElement;return a?a.toDataURL?a.toDataURL():this.srcFromAttribute?a.getAttribute("src"):a.src:this.src||""},setSrc:function(o,a,t){return d.util.loadImage(o,function(i,r){this.setElement(i,t),this._setWidthHeight(),a&&a(this,r)},this,t&&t.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var o=this.resizeFilter,a=this.minimumScaleTrigger,t=this.getTotalObjectScaling(),i=t.scaleX,r=t.scaleY,e=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!o||i>a&&r>a){this._element=e,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,this._lastScaleY=r;return}d.filterBackend||(d.filterBackend=d.initFilterBackend());var l=d.util.createCanvasElement(),s=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,c=e.width,u=e.height;l.width=c,l.height=u,this._element=l,this._lastScaleX=o.scaleX=i,this._lastScaleY=o.scaleY=r,d.filterBackend.applyFilters([o],e,c,u,this._element,s),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height},applyFilters:function(o){if(o=o||this.filters||[],o=o.filter(function(e){return e&&!e.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),o.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var a=this._originalElement,t=a.naturalWidth||a.width,i=a.naturalHeight||a.height;if(this._element===this._originalElement){var r=d.util.createCanvasElement();r.width=t,r.height=i,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,t,i),this._lastScaleX=1,this._lastScaleY=1;return d.filterBackend||(d.filterBackend=d.initFilterBackend()),d.filterBackend.applyFilters(o,this._originalElement,t,i,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(o){d.util.setImageSmoothing(o,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(o),this._renderPaintInOrder(o)},drawCacheOnCanvas:function(o){d.util.setImageSmoothing(o,this.imageSmoothing),d.Object.prototype.drawCacheOnCanvas.call(this,o)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(o){var a=this._element;if(a){var t=this._filterScalingX,i=this._filterScalingY,r=this.width,e=this.height,l=Math.min,s=Math.max,c=s(this.cropX,0),u=s(this.cropY,0),h=a.naturalWidth||a.width,p=a.naturalHeight||a.height,_=c*t,w=u*i,S=l(r*t,h-_),C=l(e*i,p-w),E=-r/2,k=-e/2,O=l(r,h/t-c),U=l(e,p/i-u);a&&o.drawImage(a,_,w,S,C,E,k,O,U)}},_needsResize:function(){var o=this.getTotalObjectScaling();return o.scaleX!==this._lastScaleX||o.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(o,a){this.setElement(d.util.getById(o),a),d.util.addClass(this.getElement(),d.Image.CSS_CANVAS)},_initConfig:function(o){o||(o={}),this.setOptions(o),this._setWidthHeight(o)},_initFilters:function(o,a){o&&o.length?d.util.enlivenObjects(o,function(t){a&&a(t)},"fabric.Image.filters"):a&&a()},_setWidthHeight:function(o){o||(o={});var a=this.getElement();this.width=o.width||a.naturalWidth||a.width||0,this.height=o.height||a.naturalHeight||a.height||0},parsePreserveAspectRatioAttribute:function(){var o=d.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),a=this._element.width,t=this._element.height,i=1,r=1,e=0,l=0,s=0,c=0,u,h=this.width,p=this.height,_={width:h,height:p};return o&&(o.alignX!=="none"||o.alignY!=="none")?(o.meetOrSlice==="meet"&&(i=r=d.util.findScaleToFit(this._element,_),u=(h-a*i)/2,o.alignX==="Min"&&(e=-u),o.alignX==="Max"&&(e=u),u=(p-t*r)/2,o.alignY==="Min"&&(l=-u),o.alignY==="Max"&&(l=u)),o.meetOrSlice==="slice"&&(i=r=d.util.findScaleToCover(this._element,_),u=a-h/i,o.alignX==="Mid"&&(s=u/2),o.alignX==="Max"&&(s=u),u=t-p/r,o.alignY==="Mid"&&(c=u/2),o.alignY==="Max"&&(c=u),a=h/i,t=p/r)):(i=h/a,r=p/t),{width:a,height:t,scaleX:i,scaleY:r,offsetLeft:e,offsetTop:l,cropX:s,cropY:c}}}),d.Image.CSS_CANVAS="canvas-img",d.Image.prototype.getSvgSrc=d.Image.prototype.getSrc,d.Image.fromObject=function(o,a){var t=d.util.object.clone(o);d.util.loadImage(t.src,function(i,r){if(r){a&&a(null,!0);return}d.Image.prototype._initFilters.call(t,t.filters,function(e){t.filters=e||[],d.Image.prototype._initFilters.call(t,[t.resizeFilter],function(l){t.resizeFilter=l[0],d.util.enlivenObjectEnlivables(t,t,function(){var s=new d.Image(i,t);a(s,!1)})})})},null,t.crossOrigin)},d.Image.fromURL=function(o,a,t){d.util.loadImage(o,function(i,r){a&&a(new d.Image(i,t),r)},null,t&&t.crossOrigin)},d.Image.ATTRIBUTE_NAMES=d.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),d.Image.fromElement=function(o,a,t){var i=d.parseAttributes(o,d.Image.ATTRIBUTE_NAMES);d.Image.fromURL(i["xlink:href"],a,n(t?d.util.object.clone(t):{},i))}}(v),d.util.object.extend(d.Object.prototype,{_getAngleValueForStraighten:function(){var f=this.angle%360;return f>0?Math.round((f-1)/90)*90:Math.round(f/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(f){f=f||{};var n=function(){},o=f.onComplete||n,a=f.onChange||n,t=this;return d.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(i){t.rotate(i),a()},onComplete:function(){t.setCoords(),o()}})}}),d.util.object.extend(d.StaticCanvas.prototype,{straightenObject:function(f){return f.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(f){return f.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function f(o,a){var t="precision "+a+" float;\nvoid main(){}",i=o.createShader(o.FRAGMENT_SHADER);return o.shaderSource(i,t),o.compileShader(i),!!o.getShaderParameter(i,o.COMPILE_STATUS)}d.isWebglSupported=function(o){if(d.isLikelyNode)return!1;o=o||d.WebglFilterBackend.prototype.tileSize;var a=document.createElement("canvas"),t=a.getContext("webgl")||a.getContext("experimental-webgl"),i=!1;if(t){d.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),i=d.maxTextureSize>=o;for(var r=["highp","mediump","lowp"],e=0;e<3;e++)if(f(t,r[e])){d.webGlPrecision=r[e];break}}return this.isSupported=i,i},d.WebglFilterBackend=n;function n(o){o&&o.tileSize&&(this.tileSize=o.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}n.prototype={tileSize:2048,resources:{},setupGLContext:function(o,a){this.dispose(),this.createWebGLCanvas(o,a),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(o,a)},chooseFastestCopyGLTo2DMethod:function(o,a){var t=typeof window.performance<"u",i;try{new ImageData(1,1),i=!0}catch(_){i=!1}var r=typeof ArrayBuffer<"u",e=typeof Uint8ClampedArray<"u";if(t&&i&&r&&e){var l=d.util.createCanvasElement(),s=new ArrayBuffer(o*a*4);if(d.forceGLPutImageData){this.imageBuffer=s,this.copyGLTo2D=b;return}var c={imageBuffer:s,destinationWidth:o,destinationHeight:a,targetCanvas:l},u,h,p;l.width=o,l.height=a,u=window.performance.now(),g.call(c,this.gl,c),h=window.performance.now()-u,u=window.performance.now(),b.call(c,this.gl,c),p=window.performance.now()-u,h>p?(this.imageBuffer=s,this.copyGLTo2D=b):this.copyGLTo2D=g}},createWebGLCanvas:function(o,a){var t=d.util.createCanvasElement();t.width=o,t.height=a;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},r=t.getContext("webgl",i);r||(r=t.getContext("experimental-webgl",i)),r&&(r.clearColor(0,0,0,0),this.canvas=t,this.gl=r)},applyFilters:function(o,a,t,i,r,e){var l=this.gl,s;e&&(s=this.getCachedTexture(e,a));var c={originalWidth:a.width||a.originalWidth,originalHeight:a.height||a.originalHeight,sourceWidth:t,sourceHeight:i,destinationWidth:t,destinationHeight:i,context:l,sourceTexture:this.createTexture(l,t,i,!s&&a),targetTexture:this.createTexture(l,t,i),originalTexture:s||this.createTexture(l,t,i,!s&&a),passes:o.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},u=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,u),o.forEach(function(h){h&&h.applyTo(c)}),x(c),this.copyGLTo2D(l,c),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(c.sourceTexture),l.deleteTexture(c.targetTexture),l.deleteFramebuffer(u),r.getContext("2d").setTransform(1,0,0,1,0,0),c},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(o,a,t,i,r){var e=o.createTexture();return o.bindTexture(o.TEXTURE_2D,e),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,r||o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,r||o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),i?o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,i):o.texImage2D(o.TEXTURE_2D,0,o.RGBA,a,t,0,o.RGBA,o.UNSIGNED_BYTE,null),e},getCachedTexture:function(o,a){if(this.textureCache[o])return this.textureCache[o];var t=this.createTexture(this.gl,a.width,a.height,a);return this.textureCache[o]=t,t},evictCachesForKey:function(o){this.textureCache[o]&&(this.gl.deleteTexture(this.textureCache[o]),delete this.textureCache[o])},copyGLTo2D:g,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var o=this.gl,a={renderer:"",vendor:""};if(!o)return a;var t=o.getExtension("WEBGL_debug_renderer_info");if(t){var i=o.getParameter(t.UNMASKED_RENDERER_WEBGL),r=o.getParameter(t.UNMASKED_VENDOR_WEBGL);i&&(a.renderer=i.toLowerCase()),r&&(a.vendor=r.toLowerCase())}return this.gpuInfo=a,a}}}();function x(f){var n=f.targetCanvas,o=n.width,a=n.height,t=f.destinationWidth,i=f.destinationHeight;(o!==t||a!==i)&&(n.width=t,n.height=i)}function g(f,n){var o=f.canvas,a=n.targetCanvas,t=a.getContext("2d");t.translate(0,a.height),t.scale(1,-1);var i=o.height-a.height;t.drawImage(o,0,i,a.width,a.height,0,0,a.width,a.height)}function b(f,n){var o=n.targetCanvas,a=o.getContext("2d"),t=n.destinationWidth,i=n.destinationHeight,r=t*i*4,e=new Uint8Array(this.imageBuffer,0,r),l=new Uint8ClampedArray(this.imageBuffer,0,r);f.readPixels(0,0,t,i,f.RGBA,f.UNSIGNED_BYTE,e);var s=new ImageData(l,t,i);a.putImageData(s,0,0)}(function(){var f=function(){};d.Canvas2dFilterBackend=n;function n(){}n.prototype={evictCachesForKey:f,dispose:f,clearWebGLCaches:f,resources:{},applyFilters:function(o,a,t,i,r){var e=r.getContext("2d");e.drawImage(a,0,0,t,i);var l=e.getImageData(0,0,t,i),s=e.getImageData(0,0,t,i),c={sourceWidth:t,sourceHeight:i,imageData:l,originalEl:a,originalImageData:s,canvasEl:r,ctx:e,filterBackend:this};return o.forEach(function(u){u.applyTo(c)}),(c.imageData.width!==t||c.imageData.height!==i)&&(r.width=c.imageData.width,r.height=c.imageData.height),e.putImageData(c.imageData,0,0),c}}})(),d.Image=d.Image||{},d.Image.filters=d.Image.filters||{},d.Image.filters.BaseFilter=d.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(f){f&&this.setOptions(f)},setOptions:function(f){for(var n in f)this[n]=f[n]},createProgram:function(f,n,o){n=n||this.fragmentSource,o=o||this.vertexSource,d.webGlPrecision!=="highp"&&(n=n.replace(/precision highp float/g,"precision "+d.webGlPrecision+" float"));var a=f.createShader(f.VERTEX_SHADER);if(f.shaderSource(a,o),f.compileShader(a),!f.getShaderParameter(a,f.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+f.getShaderInfoLog(a));var t=f.createShader(f.FRAGMENT_SHADER);if(f.shaderSource(t,n),f.compileShader(t),!f.getShaderParameter(t,f.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+f.getShaderInfoLog(t));var i=f.createProgram();if(f.attachShader(i,a),f.attachShader(i,t),f.linkProgram(i),!f.getProgramParameter(i,f.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+f.getProgramInfoLog(i));var r=this.getAttributeLocations(f,i),e=this.getUniformLocations(f,i)||{};return e.uStepW=f.getUniformLocation(i,"uStepW"),e.uStepH=f.getUniformLocation(i,"uStepH"),{program:i,attributeLocations:r,uniformLocations:e}},getAttributeLocations:function(f,n){return{aPosition:f.getAttribLocation(n,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(f,n,o){var a=n.aPosition,t=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,t),f.enableVertexAttribArray(a),f.vertexAttribPointer(a,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,o,f.STATIC_DRAW)},_setupFrameBuffer:function(f){var n=f.context,o,a;f.passes>1?(o=f.destinationWidth,a=f.destinationHeight,(f.sourceWidth!==o||f.sourceHeight!==a)&&(n.deleteTexture(f.targetTexture),f.targetTexture=f.filterBackend.createTexture(n,o,a)),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,f.targetTexture,0)):(n.bindFramebuffer(n.FRAMEBUFFER,null),n.finish())},_swapTextures:function(f){f.passes--,f.pass++;var n=f.targetTexture;f.targetTexture=f.sourceTexture,f.sourceTexture=n},isNeutralState:function(){var f=this.mainParameter,n=d.Image.filters[this.type].prototype;if(f)if(Array.isArray(n[f])){for(var o=n[f].length;o--;)if(this[f][o]!==n[f][o])return!1;return!0}else return n[f]===this[f];else return!1},applyTo:function(f){f.webgl?(this._setupFrameBuffer(f),this.applyToWebGL(f),this._swapTextures(f)):this.applyTo2d(f)},retrieveShader:function(f){return f.programCache.hasOwnProperty(this.type)||(f.programCache[this.type]=this.createProgram(f.context)),f.programCache[this.type]},applyToWebGL:function(f){var n=f.context,o=this.retrieveShader(f);f.pass===0&&f.originalTexture?n.bindTexture(n.TEXTURE_2D,f.originalTexture):n.bindTexture(n.TEXTURE_2D,f.sourceTexture),n.useProgram(o.program),this.sendAttributeData(n,o.attributeLocations,f.aPosition),n.uniform1f(o.uniformLocations.uStepW,1/f.sourceWidth),n.uniform1f(o.uniformLocations.uStepH,1/f.sourceHeight),this.sendUniformData(n,o.uniformLocations),n.viewport(0,0,f.destinationWidth,f.destinationHeight),n.drawArrays(n.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(f,n,o){f.activeTexture(o),f.bindTexture(f.TEXTURE_2D,n),f.activeTexture(f.TEXTURE0)},unbindAdditionalTexture:function(f,n){f.activeTexture(n),f.bindTexture(f.TEXTURE_2D,null),f.activeTexture(f.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(f){this[this.mainParameter]=f},sendUniformData:function(){},createHelpLayer:function(f){if(!f.helpLayer){var n=document.createElement("canvas");n.width=f.sourceWidth,n.height=f.sourceHeight,f.helpLayer=n}},toObject:function(){var f={type:this.type},n=this.mainParameter;return n&&(f[n]=this[n]),f},toJSON:function(){return this.toObject()}}),d.Image.filters.BaseFilter.fromObject=function(f,n){var o=new d.Image.filters[f.type](f);return n&&n(o),o},function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.ColorMatrix=a(o.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var i=t.imageData,r=i.data,e=r.length,l=this.matrix,s,c,u,h,p,_=this.colorsOnly;for(p=0;p<e;p+=4)s=r[p],c=r[p+1],u=r[p+2],_?(r[p]=s*l[0]+c*l[1]+u*l[2]+l[4]*255,r[p+1]=s*l[5]+c*l[6]+u*l[7]+l[9]*255,r[p+2]=s*l[10]+c*l[11]+u*l[12]+l[14]*255):(h=r[p+3],r[p]=s*l[0]+c*l[1]+u*l[2]+h*l[3]+l[4]*255,r[p+1]=s*l[5]+c*l[6]+u*l[7]+h*l[8]+l[9]*255,r[p+2]=s*l[10]+c*l[11]+u*l[12]+h*l[13]+l[14]*255,r[p+3]=s*l[15]+c*l[16]+u*l[17]+h*l[18]+l[19]*255)},getUniformLocations:function(t,i){return{uColorMatrix:t.getUniformLocation(i,"uColorMatrix"),uConstants:t.getUniformLocation(i,"uConstants")}},sendUniformData:function(t,i){var r=this.matrix,e=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],l=[r[4],r[9],r[14],r[19]];t.uniformMatrix4fv(i.uColorMatrix,!1,e),t.uniform4fv(i.uConstants,l)}}),n.Image.filters.ColorMatrix.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Brightness=a(o.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(this.brightness!==0){var i=t.imageData,r=i.data,e,l=r.length,s=Math.round(this.brightness*255);for(e=0;e<l;e+=4)r[e]=r[e]+s,r[e+1]=r[e+1]+s,r[e+2]=r[e+2]+s}},getUniformLocations:function(t,i){return{uBrightness:t.getUniformLocation(i,"uBrightness")}},sendUniformData:function(t,i){t.uniform1f(i.uBrightness,this.brightness)}}),n.Image.filters.Brightness.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.extend,a=n.Image.filters,t=n.util.createClass;a.Convolute=t(a.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(i){var r=Math.sqrt(this.matrix.length),e=this.type+"_"+r+"_"+(this.opaque?1:0),l=this.fragmentSource[e];return i.programCache.hasOwnProperty(e)||(i.programCache[e]=this.createProgram(i.context,l)),i.programCache[e]},applyTo2d:function(i){var r=i.imageData,e=r.data,l=this.matrix,s=Math.round(Math.sqrt(l.length)),c=Math.floor(s/2),u=r.width,h=r.height,p=i.ctx.createImageData(u,h),_=p.data,w=this.opaque?1:0,S,C,E,k,O,U,F,M,j,G,N,R,A;for(N=0;N<h;N++)for(G=0;G<u;G++){for(O=(N*u+G)*4,S=0,C=0,E=0,k=0,A=0;A<s;A++)for(R=0;R<s;R++)F=N+A-c,U=G+R-c,!(F<0||F>=h||U<0||U>=u)&&(M=(F*u+U)*4,j=l[A*s+R],S+=e[M]*j,C+=e[M+1]*j,E+=e[M+2]*j,w||(k+=e[M+3]*j));_[O]=S,_[O+1]=C,_[O+2]=E,w?_[O+3]=e[O+3]:_[O+3]=k}i.imageData=p},getUniformLocations:function(i,r){return{uMatrix:i.getUniformLocation(r,"uMatrix"),uOpaque:i.getUniformLocation(r,"uOpaque"),uHalfSize:i.getUniformLocation(r,"uHalfSize"),uSize:i.getUniformLocation(r,"uSize")}},sendUniformData:function(i,r){i.uniform1fv(r.uMatrix,this.matrix)},toObject:function(){return o(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),n.Image.filters.Convolute.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Grayscale=a(o.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var i=t.imageData,r=i.data,e,l=r.length,s,c=this.mode;for(e=0;e<l;e+=4)c==="average"?s=(r[e]+r[e+1]+r[e+2])/3:c==="lightness"?s=(Math.min(r[e],r[e+1],r[e+2])+Math.max(r[e],r[e+1],r[e+2]))/2:c==="luminosity"&&(s=.21*r[e]+.72*r[e+1]+.07*r[e+2]),r[e]=s,r[e+1]=s,r[e+2]=s},retrieveShader:function(t){var i=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(i)){var r=this.fragmentSource[this.mode];t.programCache[i]=this.createProgram(t.context,r)}return t.programCache[i]},getUniformLocations:function(t,i){return{uMode:t.getUniformLocation(i,"uMode")}},sendUniformData:function(t,i){var r=1;t.uniform1i(i.uMode,r)},isNeutralState:function(){return!1}}),n.Image.filters.Grayscale.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Invert=a(o.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){var i=t.imageData,r=i.data,e,l=r.length;for(e=0;e<l;e+=4)r[e]=255-r[e],r[e+1]=255-r[e+1],r[e+2]=255-r[e+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,i){return{uInvert:t.getUniformLocation(i,"uInvert")}},sendUniformData:function(t,i){t.uniform1i(i.uInvert,this.invert)}}),n.Image.filters.Invert.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.extend,a=n.Image.filters,t=n.util.createClass;a.Noise=t(a.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(i){if(this.noise!==0){var r=i.imageData,e=r.data,l,s=e.length,c=this.noise,u;for(l=0,s=e.length;l<s;l+=4)u=(.5-Math.random())*c,e[l]+=u,e[l+1]+=u,e[l+2]+=u}},getUniformLocations:function(i,r){return{uNoise:i.getUniformLocation(r,"uNoise"),uSeed:i.getUniformLocation(r,"uSeed")}},sendUniformData:function(i,r){i.uniform1f(r.uNoise,this.noise/255),i.uniform1f(r.uSeed,Math.random())},toObject:function(){return o(this.callSuper("toObject"),{noise:this.noise})}}),n.Image.filters.Noise.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Pixelate=a(o.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){var i=t.imageData,r=i.data,e=i.height,l=i.width,s,c,u,h,p,_,w,S,C,E,k;for(c=0;c<e;c+=this.blocksize)for(u=0;u<l;u+=this.blocksize)for(s=c*4*l+u*4,h=r[s],p=r[s+1],_=r[s+2],w=r[s+3],E=Math.min(c+this.blocksize,e),k=Math.min(u+this.blocksize,l),S=c;S<E;S++)for(C=u;C<k;C++)s=S*4*l+C*4,r[s]=h,r[s+1]=p,r[s+2]=_,r[s+3]=w},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(t,i){return{uBlocksize:t.getUniformLocation(i,"uBlocksize"),uStepW:t.getUniformLocation(i,"uStepW"),uStepH:t.getUniformLocation(i,"uStepH")}},sendUniformData:function(t,i){t.uniform1f(i.uBlocksize,this.blocksize)}}),n.Image.filters.Pixelate.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.extend,a=n.Image.filters,t=n.util.createClass;a.RemoveColor=t(a.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(i){var r=i.imageData,e=r.data,l,s=this.distance*255,c,u,h,p=new n.Color(this.color).getSource(),_=[p[0]-s,p[1]-s,p[2]-s],w=[p[0]+s,p[1]+s,p[2]+s];for(l=0;l<e.length;l+=4)c=e[l],u=e[l+1],h=e[l+2],c>_[0]&&u>_[1]&&h>_[2]&&c<w[0]&&u<w[1]&&h<w[2]&&(e[l+3]=0)},getUniformLocations:function(i,r){return{uLow:i.getUniformLocation(r,"uLow"),uHigh:i.getUniformLocation(r,"uHigh")}},sendUniformData:function(i,r){var e=new n.Color(this.color).getSource(),l=parseFloat(this.distance),s=[0+e[0]/255-l,0+e[1]/255-l,0+e[2]/255-l,1],c=[e[0]/255+l,e[1]/255+l,e[2]/255+l,1];i.uniform4fv(r.uLow,s),i.uniform4fv(r.uHigh,c)},toObject:function(){return o(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),n.Image.filters.RemoveColor.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass,t={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var i in t)o[i]=a(o.ColorMatrix,{type:i,matrix:t[i],mainParameter:!1,colorsOnly:!0}),n.Image.filters[i].fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric,o=n.Image.filters,a=n.util.createClass;o.BlendColor=a(o.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var i=this.type+"_"+this.mode,r;return t.programCache.hasOwnProperty(i)||(r=this.buildSource(this.mode),t.programCache[i]=this.createProgram(t.context,r)),t.programCache[i]},applyTo2d:function(t){var i=t.imageData,r=i.data,e=r.length,l,s,c,u,h,p,_,w=1-this.alpha;_=new n.Color(this.color).getSource(),l=_[0]*this.alpha,s=_[1]*this.alpha,c=_[2]*this.alpha;for(var S=0;S<e;S+=4)switch(u=r[S],h=r[S+1],p=r[S+2],this.mode){case"multiply":r[S]=u*l/255,r[S+1]=h*s/255,r[S+2]=p*c/255;break;case"screen":r[S]=255-(255-u)*(255-l)/255,r[S+1]=255-(255-h)*(255-s)/255,r[S+2]=255-(255-p)*(255-c)/255;break;case"add":r[S]=u+l,r[S+1]=h+s,r[S+2]=p+c;break;case"diff":case"difference":r[S]=Math.abs(u-l),r[S+1]=Math.abs(h-s),r[S+2]=Math.abs(p-c);break;case"subtract":r[S]=u-l,r[S+1]=h-s,r[S+2]=p-c;break;case"darken":r[S]=Math.min(u,l),r[S+1]=Math.min(h,s),r[S+2]=Math.min(p,c);break;case"lighten":r[S]=Math.max(u,l),r[S+1]=Math.max(h,s),r[S+2]=Math.max(p,c);break;case"overlay":r[S]=l<128?2*u*l/255:255-2*(255-u)*(255-l)/255,r[S+1]=s<128?2*h*s/255:255-2*(255-h)*(255-s)/255,r[S+2]=c<128?2*p*c/255:255-2*(255-p)*(255-c)/255;break;case"exclusion":r[S]=l+u-2*l*u/255,r[S+1]=s+h-2*s*h/255,r[S+2]=c+p-2*c*p/255;break;case"tint":r[S]=l+u*w,r[S+1]=s+h*w,r[S+2]=c+p*w}},getUniformLocations:function(t,i){return{uColor:t.getUniformLocation(i,"uColor")}},sendUniformData:function(t,i){var r=new n.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,t.uniform4fv(i.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),n.Image.filters.BlendColor.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric,o=n.Image.filters,a=n.util.createClass;o.BlendImage=a(o.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var i=this.type+"_"+this.mode,r=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(i)||(t.programCache[i]=this.createProgram(t.context,r)),t.programCache[i]},applyToWebGL:function(t){var i=t.context,r=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(i,r,i.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(i,i.TEXTURE1)},createTexture:function(t,i){return t.getCachedTexture(i.cacheKey,i._element)},calculateMatrix:function(){var t=this.image,i=t._element.width,r=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/i,-t.top/r,1]},applyTo2d:function(t){var i=t.imageData,r=t.filterBackend.resources,e=i.data,l=e.length,s=i.width,c=i.height,u,h,p,_,w,S,C,E,k,O,U=this.image,F;r.blendImage||(r.blendImage=n.util.createCanvasElement()),k=r.blendImage,O=k.getContext("2d"),k.width!==s||k.height!==c?(k.width=s,k.height=c):O.clearRect(0,0,s,c),O.setTransform(U.scaleX,0,0,U.scaleY,U.left,U.top),O.drawImage(U._element,0,0,s,c),F=O.getImageData(0,0,s,c).data;for(var M=0;M<l;M+=4)switch(w=e[M],S=e[M+1],C=e[M+2],E=e[M+3],u=F[M],h=F[M+1],p=F[M+2],_=F[M+3],this.mode){case"multiply":e[M]=w*u/255,e[M+1]=S*h/255,e[M+2]=C*p/255,e[M+3]=E*_/255;break;case"mask":e[M+3]=_;break}},getUniformLocations:function(t,i){return{uTransformMatrix:t.getUniformLocation(i,"uTransformMatrix"),uImage:t.getUniformLocation(i,"uImage")}},sendUniformData:function(t,i){var r=this.calculateMatrix();t.uniform1i(i.uImage,1),t.uniformMatrix3fv(i.uTransformMatrix,!1,r)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),n.Image.filters.BlendImage.fromObject=function(t,i){n.Image.fromObject(t.image,function(r){var e=n.util.object.clone(t);e.image=r,i(new n.Image.filters.BlendImage(e))})}}(v),function(f){var n=f.fabric||(f.fabric={}),o=Math.pow,a=Math.floor,t=Math.sqrt,i=Math.abs,r=Math.round,e=Math.sin,l=Math.ceil,s=n.Image.filters,c=n.util.createClass;s.Resize=c(s.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(u,h){return{uDelta:u.getUniformLocation(h,"uDelta"),uTaps:u.getUniformLocation(h,"uTaps")}},sendUniformData:function(u,h){u.uniform2fv(h.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),u.uniform1fv(h.uTaps,this.taps)},retrieveShader:function(u){var h=this.getFilterWindow(),p=this.type+"_"+h;if(!u.programCache.hasOwnProperty(p)){var _=this.generateShader(h);u.programCache[p]=this.createProgram(u.context,_)}return u.programCache[p]},getFilterWindow:function(){var u=this.tempScale;return Math.ceil(this.lanczosLobes/u)},getTaps:function(){for(var u=this.lanczosCreate(this.lanczosLobes),h=this.tempScale,p=this.getFilterWindow(),_=new Array(p),w=1;w<=p;w++)_[w-1]=u(w*h);return _},generateShader:function(_){for(var h=new Array(_),p=this.fragmentSourceTOP,_,w=1;w<=_;w++)h[w-1]=w+".0 * uDelta";return p+="uniform float uTaps["+_+"];\n",p+="void main() {\n",p+="  vec4 color = texture2D(uTexture, vTexCoord);\n",p+="  float sum = 1.0;\n",h.forEach(function(S,C){p+="  color += texture2D(uTexture, vTexCoord + "+S+") * uTaps["+C+"];\n",p+="  color += texture2D(uTexture, vTexCoord - "+S+") * uTaps["+C+"];\n",p+="  sum += 2.0 * uTaps["+C+"];\n"}),p+="  gl_FragColor = color / sum;\n",p+="}",p},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(u){u.webgl?(u.passes++,this.width=u.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=u.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),u.destinationWidth=this.dW,this._setupFrameBuffer(u),this.applyToWebGL(u),this._swapTextures(u),u.sourceWidth=u.destinationWidth,this.height=u.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),u.destinationHeight=this.dH,this._setupFrameBuffer(u),this.applyToWebGL(u),this._swapTextures(u),u.sourceHeight=u.destinationHeight):this.applyTo2d(u)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(u){return function(h){if(h>=u||h<=-u)return 0;if(h<11920929e-14&&h>-11920929e-14)return 1;h*=Math.PI;var p=h/u;return e(h)/h*e(p)/p}},applyTo2d:function(u){var h=u.imageData,p=this.scaleX,_=this.scaleY;this.rcpScaleX=1/p,this.rcpScaleY=1/_;var w=h.width,S=h.height,C=r(w*p),E=r(S*_),k;this.resizeType==="sliceHack"?k=this.sliceByTwo(u,w,S,C,E):this.resizeType==="hermite"?k=this.hermiteFastResize(u,w,S,C,E):this.resizeType==="bilinear"?k=this.bilinearFiltering(u,w,S,C,E):this.resizeType==="lanczos"&&(k=this.lanczosResize(u,w,S,C,E)),u.imageData=k},sliceByTwo:function(u,h,p,_,w){var S=u.imageData,C=.5,E=!1,k=!1,O=h*C,U=p*C,F=n.filterBackend.resources,M,j,G=0,N=0,R=h,A=0;for(F.sliceByTwo||(F.sliceByTwo=document.createElement("canvas")),M=F.sliceByTwo,(M.width<h*1.5||M.height<p)&&(M.width=h*1.5,M.height=p),j=M.getContext("2d"),j.clearRect(0,0,h*1.5,p),j.putImageData(S,0,0),_=a(_),w=a(w);!E||!k;)h=O,p=U,_<a(O*C)?O=a(O*C):(O=_,E=!0),w<a(U*C)?U=a(U*C):(U=w,k=!0),j.drawImage(M,G,N,h,p,R,A,O,U),G=R,N=A,A+=U;return j.getImageData(G,N,_,w)},lanczosResize:function(u,h,p,_,w){function S(Z){var K,J,D,I,W,q,ne,le,ce,fe,he;for(A.x=(Z+.5)*U,H.x=a(A.x),K=0;K<w;K++){for(A.y=(K+.5)*F,H.y=a(A.y),W=0,q=0,ne=0,le=0,ce=0,J=H.x-G;J<=H.x+G;J++)if(!(J<0||J>=h)){fe=a(1e3*i(J-A.x)),R[fe]||(R[fe]={});for(var se=H.y-N;se<=H.y+N;se++)se<0||se>=p||(he=a(1e3*i(se-A.y)),R[fe][he]||(R[fe][he]=O(t(o(fe*M,2)+o(he*j,2))/1e3)),D=R[fe][he],D>0&&(I=(se*h+J)*4,W+=D,q+=D*C[I],ne+=D*C[I+1],le+=D*C[I+2],ce+=D*C[I+3]))}I=(K*_+Z)*4,k[I]=q/W,k[I+1]=ne/W,k[I+2]=le/W,k[I+3]=ce/W}return++Z<_?S(Z):E}var C=u.imageData.data,E=u.ctx.createImageData(_,w),k=E.data,O=this.lanczosCreate(this.lanczosLobes),U=this.rcpScaleX,F=this.rcpScaleY,M=2/this.rcpScaleX,j=2/this.rcpScaleY,G=l(U*this.lanczosLobes/2),N=l(F*this.lanczosLobes/2),R={},A={},H={};return S(0)},bilinearFiltering:function(u,h,p,_,w){var S,C,E,k,O,U,F,M,j,G,N,R,A=0,H,Z=this.rcpScaleX,K=this.rcpScaleY,J=4*(h-1),D=u.imageData,I=D.data,W=u.ctx.createImageData(_,w),q=W.data;for(F=0;F<w;F++)for(M=0;M<_;M++)for(O=a(Z*M),U=a(K*F),j=Z*M-O,G=K*F-U,H=4*(U*h+O),N=0;N<4;N++)S=I[H+N],C=I[H+4+N],E=I[H+J+N],k=I[H+J+4+N],R=S*(1-j)*(1-G)+C*j*(1-G)+E*G*(1-j)+k*j*G,q[A++]=R;return W},hermiteFastResize:function(u,h,p,_,w){for(var S=this.rcpScaleX,C=this.rcpScaleY,E=l(S/2),k=l(C/2),O=u.imageData,U=O.data,F=u.ctx.createImageData(_,w),M=F.data,j=0;j<w;j++)for(var G=0;G<_;G++){for(var N=(G+j*_)*4,R=0,A=0,H=0,Z=0,K=0,J=0,D=0,I=(j+.5)*C,W=a(j*C);W<(j+1)*C;W++)for(var q=i(I-(W+.5))/k,ne=(G+.5)*S,le=q*q,ce=a(G*S);ce<(G+1)*S;ce++){var fe=i(ne-(ce+.5))/E,he=t(le+fe*fe);he>1&&he<-1||(R=2*he*he*he-3*he*he+1,R>0&&(fe=4*(ce+W*h),D+=R*U[fe+3],H+=R,U[fe+3]<255&&(R=R*U[fe+3]/250),Z+=R*U[fe],K+=R*U[fe+1],J+=R*U[fe+2],A+=R))}M[N]=Z/A,M[N+1]=K/A,M[N+2]=J/A,M[N+3]=D/H}return F},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),n.Image.filters.Resize.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Contrast=a(o.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(this.contrast!==0){var i=t.imageData,r,l,e=i.data,l=e.length,s=Math.floor(this.contrast*255),c=259*(s+255)/(255*(259-s));for(r=0;r<l;r+=4)e[r]=c*(e[r]-128)+128,e[r+1]=c*(e[r+1]-128)+128,e[r+2]=c*(e[r+2]-128)+128}},getUniformLocations:function(t,i){return{uContrast:t.getUniformLocation(i,"uContrast")}},sendUniformData:function(t,i){t.uniform1f(i.uContrast,this.contrast)}}),n.Image.filters.Contrast.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Saturation=a(o.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(this.saturation!==0){var i=t.imageData,r=i.data,e=r.length,l=-this.saturation,s,c;for(s=0;s<e;s+=4)c=Math.max(r[s],r[s+1],r[s+2]),r[s]+=c!==r[s]?(c-r[s])*l:0,r[s+1]+=c!==r[s+1]?(c-r[s+1])*l:0,r[s+2]+=c!==r[s+2]?(c-r[s+2])*l:0}},getUniformLocations:function(t,i){return{uSaturation:t.getUniformLocation(i,"uSaturation")}},sendUniformData:function(t,i){t.uniform1f(i.uSaturation,-this.saturation)}}),n.Image.filters.Saturation.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Vibrance=a(o.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(t){if(this.vibrance!==0){var i=t.imageData,r=i.data,e=r.length,l=-this.vibrance,s,c,u,h;for(s=0;s<e;s+=4)c=Math.max(r[s],r[s+1],r[s+2]),u=(r[s]+r[s+1]+r[s+2])/3,h=Math.abs(c-u)*2/255*l,r[s]+=c!==r[s]?(c-r[s])*h:0,r[s+1]+=c!==r[s+1]?(c-r[s+1])*h:0,r[s+2]+=c!==r[s+2]?(c-r[s+2])*h:0}},getUniformLocations:function(t,i){return{uVibrance:t.getUniformLocation(i,"uVibrance")}},sendUniformData:function(t,i){t.uniform1f(i.uVibrance,-this.vibrance)}}),n.Image.filters.Vibrance.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Blur=a(o.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var i=t.filterBackend.resources,r,e,l=t.imageData.width,s=t.imageData.height;i.blurLayer1||(i.blurLayer1=n.util.createCanvasElement(),i.blurLayer2=n.util.createCanvasElement()),r=i.blurLayer1,e=i.blurLayer2,(r.width!==l||r.height!==s)&&(e.width=r.width=l,e.height=r.height=s);var c=r.getContext("2d"),u=e.getContext("2d"),h=15,p,_,w,S,C=this.blur*.06*.5;for(c.putImageData(t.imageData,0,0),u.clearRect(0,0,l,s),S=-h;S<=h;S++)p=(Math.random()-.5)/4,_=S/h,w=C*_*l+p,u.globalAlpha=1-Math.abs(_),u.drawImage(r,w,p),c.drawImage(e,0,0),u.globalAlpha=1,u.clearRect(0,0,e.width,e.height);for(S=-h;S<=h;S++)p=(Math.random()-.5)/4,_=S/h,w=C*_*s+p,u.globalAlpha=1-Math.abs(_),u.drawImage(r,p,w),c.drawImage(e,0,0),u.globalAlpha=1,u.clearRect(0,0,e.width,e.height);t.ctx.drawImage(r,0,0);var E=t.ctx.getImageData(0,0,r.width,r.height);return c.globalAlpha=1,c.clearRect(0,0,r.width,r.height),E},getUniformLocations:function(t,i){return{delta:t.getUniformLocation(i,"uDelta")}},sendUniformData:function(t,i){var r=this.chooseRightDelta();t.uniform2fv(i.delta,r)},chooseRightDelta:function(){var t=1,i=[0,0],r;return this.horizontal?this.aspectRatio>1&&(t=1/this.aspectRatio):this.aspectRatio<1&&(t=this.aspectRatio),r=t*this.blur*.12,this.horizontal?i[0]=r:i[1]=r,i}}),o.Blur.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Gamma=a(o.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],o.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var i=t.imageData,r=i.data,e=this.gamma,l=r.length,s=1/e[0],c=1/e[1],u=1/e[2],h;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),h=0,l=256;h<l;h++)this.rVals[h]=Math.pow(h/255,s)*255,this.gVals[h]=Math.pow(h/255,c)*255,this.bVals[h]=Math.pow(h/255,u)*255;for(h=0,l=r.length;h<l;h+=4)r[h]=this.rVals[r[h]],r[h+1]=this.gVals[r[h+1]],r[h+2]=this.bVals[r[h+2]]},getUniformLocations:function(t,i){return{uGamma:t.getUniformLocation(i,"uGamma")}},sendUniformData:function(t,i){t.uniform3fv(i.uGamma,this.gamma)}}),n.Image.filters.Gamma.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.Composed=a(o.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach(function(i){i.applyTo(t)})},toObject:function(){return n.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(t){return t.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(t){return!t.isNeutralState()})}}),n.Image.filters.Composed.fromObject=function(t,i){var r=t.subFilters||[],e=r.map(function(s){return new n.Image.filters[s.type](s)}),l=new n.Image.filters.Composed({subFilters:e});return i&&i(l),l}}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.Image.filters,a=n.util.createClass;o.HueRotation=a(o.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,i=n.util.cos(t),r=n.util.sin(t),e=1/3,l=Math.sqrt(e)*r,s=1-i;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=i+s/3,this.matrix[1]=e*s-l,this.matrix[2]=e*s+l,this.matrix[5]=e*s+l,this.matrix[6]=i+e*s,this.matrix[7]=e*s-l,this.matrix[10]=e*s-l,this.matrix[11]=e*s+l,this.matrix[12]=i+e*s},isNeutralState:function(t){return this.calculateMatrix(),o.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),o.BaseFilter.prototype.applyTo.call(this,t)}}),n.Image.filters.HueRotation.fromObject=n.Image.filters.BaseFilter.fromObject}(v),function(f){var n=f.fabric||(f.fabric={}),o=n.util.object.clone;if(n.Text){n.warn("fabric.Text is already defined");return}var a="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");n.Text=n.util.createClass(n.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:n.Object.prototype.stateProperties.concat(a),cacheProperties:n.Object.prototype.cacheProperties.concat(a),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,i){this.styles=i?i.styles||{}:{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",i),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var t=this.path;t&&(t.segmentsInfo=n.util.getPathSegmentsInfo(t.path))},getMeasuringContext:function(){return n._measuringContext||(n._measuringContext=this.canvas&&this.canvas.contextCache||n.util.createCanvasElement().getContext("2d")),n._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,i,r,e,l,s,c,u=0,h=this._textLines.length;u<h;u++)if(!(this.textAlign!=="justify"&&(u===h-1||this.isEndOfWrapping(u)))&&(e=0,l=this._textLines[u],i=this.getLineWidth(u),i<this.width&&(c=this.textLines[u].match(this._reSpacesAndTabs)))){r=c.length,t=(this.width-i)/r;for(var p=0,_=l.length;p<=_;p++)s=this.__charBounds[u][p],this._reSpaceAndTab.test(l[p])?(s.width+=t,s.kernedWidth+=t,s.left+=e,e+=t):s.left+=e}},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),i=this.fontSize;return t.width+=i*t.zoomX,t.height+=i*t.zoomY,t},_render:function(t){var i=this.path;i&&!i.isNotVisible()&&i._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){this.paintFirst==="stroke"?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,i,r){if(t.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":t.textBaseline="middle";break;case"ascender":t.textBaseline="top";break;case"descender":t.textBaseline="bottom";break}t.font=this._getFontDeclaration(i,r)},calcTextWidth:function(){for(var t=this.getLineWidth(0),i=1,r=this._textLines.length;i<r;i++){var e=this.getLineWidth(i);e>t&&(t=e)}return t},_renderTextLine:function(t,i,r,e,l,s){this._renderChars(t,i,r,e,l,s)},_renderTextLinesBackground:function(t){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var i,r,e=t.fillStyle,l,s,c=this._getLeftOffset(),u=this._getTopOffset(),h=0,p=0,_,w,S=this.path,C,E=0,k=this._textLines.length;E<k;E++){if(i=this.getHeightOfLine(E),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",E)){u+=i;continue}l=this._textLines[E],r=this._getLineLeftOffset(E),p=0,h=0,s=this.getValueOfPropertyAt(E,0,"textBackgroundColor");for(var O=0,U=l.length;O<U;O++)_=this.__charBounds[E][O],w=this.getValueOfPropertyAt(E,O,"textBackgroundColor"),S?(t.save(),t.translate(_.renderLeft,_.renderTop),t.rotate(_.angle),t.fillStyle=w,w&&t.fillRect(-_.width/2,-i/this.lineHeight*(1-this._fontSizeFraction),_.width,i/this.lineHeight),t.restore()):w!==s?(C=c+r+h,this.direction==="rtl"&&(C=this.width-C-p),t.fillStyle=s,s&&t.fillRect(C,u,p,i/this.lineHeight),h=_.left,p=_.width,s=w):p+=_.kernedWidth;w&&!S&&(C=c+r+h,this.direction==="rtl"&&(C=this.width-C-p),t.fillStyle=w,t.fillRect(C,u,p,i/this.lineHeight)),u+=i}t.fillStyle=e,this._removeShadow(t)}},getFontCache:function(t){var i=t.fontFamily.toLowerCase();n.charWidthsCache[i]||(n.charWidthsCache[i]={});var r=n.charWidthsCache[i],e=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return r[e]||(r[e]={}),r[e]},_measureChar:function(t,i,r,e){var l=this.getFontCache(i),s=this._getFontDeclaration(i),c=this._getFontDeclaration(e),u=r+t,h=s===c,p,_,w,S=i.fontSize/this.CACHE_FONT_SIZE,C;if(r&&l[r]!==void 0&&(w=l[r]),l[t]!==void 0&&(C=p=l[t]),h&&l[u]!==void 0&&(_=l[u],C=_-w),p===void 0||w===void 0||_===void 0){var E=this.getMeasuringContext();this._setTextStyles(E,i,!0)}return p===void 0&&(C=p=E.measureText(t).width,l[t]=p),w===void 0&&h&&r&&(w=E.measureText(r).width,l[r]=w),h&&_===void 0&&(_=E.measureText(u).width,l[u]=_,C=_-w),{width:p*S,kernedWidth:C*S}},getHeightOfChar:function(t,i){return this.getValueOfPropertyAt(t,i,"fontSize")},measureLine:function(t){var i=this._measureLine(t);return this.charSpacing!==0&&(i.width-=this._getWidthOfCharSpacing()),i.width<0&&(i.width=0),i},_measureLine:function(t){var i=0,r,e,l=this._textLines[t],s,c,u=0,h=new Array(l.length),p=0,_,w,S=this.path,C=this.pathSide==="right";for(this.__charBounds[t]=h,r=0;r<l.length;r++)e=l[r],c=this._getGraphemeBox(e,t,r,s),h[r]=c,i+=c.kernedWidth,s=e;if(h[r]={left:c?c.left+c.width:0,width:0,kernedWidth:0,height:this.fontSize},S){switch(w=S.segmentsInfo[S.segmentsInfo.length-1].length,_=n.util.getPointOnPath(S.path,0,S.segmentsInfo),_.x+=S.pathOffset.x,_.y+=S.pathOffset.y,this.textAlign){case"left":p=C?w-i:0;break;case"center":p=(w-i)/2;break;case"right":p=C?0:w-i;break}for(p+=this.pathStartOffset*(C?-1:1),r=C?l.length-1:0;C?r>=0:r<l.length;C?r--:r++)c=h[r],p>w?p%=w:p<0&&(p+=w),this._setGraphemeOnPath(p,c,_),p+=c.kernedWidth}return{width:i,numOfSpaces:u}},_setGraphemeOnPath:function(t,i,r){var e=t+i.kernedWidth/2,l=this.path,s=n.util.getPointOnPath(l.path,e,l.segmentsInfo);i.renderLeft=s.x-r.x,i.renderTop=s.y-r.y,i.angle=s.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(t,i,r,e,l){var s=this.getCompleteStyleDeclaration(i,r),c=e?this.getCompleteStyleDeclaration(i,r-1):{},u=this._measureChar(t,s,e,c),h=u.kernedWidth,p=u.width,_;this.charSpacing!==0&&(_=this._getWidthOfCharSpacing(),p+=_,h+=_);var w={width:p,left:0,height:s.fontSize,kernedWidth:h,deltaY:s.deltaY};if(r>0&&!l){var S=this.__charBounds[i][r-1];w.left=S.left+S.width+u.kernedWidth-u.width}return w},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var i=this._textLines[t],r=this.getHeightOfChar(t,0),e=1,l=i.length;e<l;e++)r=Math.max(this.getHeightOfChar(t,e),r);return this.__lineHeights[t]=r*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,i=0,r=0,e=this._textLines.length;r<e;r++)t=this.getHeightOfLine(r),i+=r===e-1?t/this.lineHeight:t;return i},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,i){t.save();for(var r=0,e=this._getLeftOffset(),l=this._getTopOffset(),s=0,c=this._textLines.length;s<c;s++){var u=this.getHeightOfLine(s),h=u/this.lineHeight,p=this._getLineLeftOffset(s);this._renderTextLine(i,t,this._textLines[s],e+p,l+r+h,s),r+=u}t.restore()},_renderTextFill:function(t){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,i,r,e,l,s){var c=this.getHeightOfLine(s),u=this.textAlign.indexOf("justify")!==-1,h,p,_="",w,S=0,C,E=this.path,k=!u&&this.charSpacing===0&&this.isEmptyStyles(s)&&!E,O=this.direction==="ltr",U=this.direction==="ltr"?1:-1,F,M=i.canvas.getAttribute("dir");if(i.save(),M!==this.direction&&(i.canvas.setAttribute("dir",O?"ltr":"rtl"),i.direction=O?"ltr":"rtl",i.textAlign=O?"left":"right"),l-=c*this._fontSizeFraction/this.lineHeight,k){this._renderChar(t,i,s,0,r.join(""),e,l,c),i.restore();return}for(var j=0,G=r.length-1;j<=G;j++)C=j===G||this.charSpacing||E,_+=r[j],w=this.__charBounds[s][j],S===0?(e+=U*(w.kernedWidth-w.width),S+=w.width):S+=w.kernedWidth,u&&!C&&this._reSpaceAndTab.test(r[j])&&(C=!0),C||(h=h||this.getCompleteStyleDeclaration(s,j),p=this.getCompleteStyleDeclaration(s,j+1),C=n.util.hasStyleChanged(h,p,!1)),C&&(E?(i.save(),i.translate(w.renderLeft,w.renderTop),i.rotate(w.angle),this._renderChar(t,i,s,j,_,-S/2,0,c),i.restore()):(F=e,this._renderChar(t,i,s,j,_,F,l,c)),_="",h=p,e+=U*S,S=0);i.restore()},_applyPatternGradientTransformText:function(t){var i=n.util.createCanvasElement(),r,e=this.width+this.strokeWidth,l=this.height+this.strokeWidth;return i.width=e,i.height=l,r=i.getContext("2d"),r.beginPath(),r.moveTo(0,0),r.lineTo(e,0),r.lineTo(e,l),r.lineTo(0,l),r.closePath(),r.translate(e/2,l/2),r.fillStyle=t.toLive(r),this._applyPatternGradientTransform(r,t),r.fill(),r.createPattern(i,"no-repeat")},handleFiller:function(t,i,r){var e,l;return r.toLive?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(e=-this.width/2,l=-this.height/2,t.translate(e,l),t[i]=this._applyPatternGradientTransformText(r),{offsetX:e,offsetY:l}):(t[i]=r.toLive(t,this),this._applyPatternGradientTransform(t,r)):(t[i]=r,{offsetX:0,offsetY:0})},_setStrokeStyles:function(t,i){return t.lineWidth=i.strokeWidth,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",i.stroke)},_setFillStyles:function(t,i){return this.handleFiller(t,"fillStyle",i.fill)},_renderChar:function(t,i,r,e,l,s,c){var u=this._getStyleDeclaration(r,e),h=this.getCompleteStyleDeclaration(r,e),p=t==="fillText"&&h.fill,_=t==="strokeText"&&h.stroke&&h.strokeWidth,w,S;!_&&!p||(i.save(),p&&(w=this._setFillStyles(i,h)),_&&(S=this._setStrokeStyles(i,h)),i.font=this._getFontDeclaration(h),u&&u.textBackgroundColor&&this._removeShadow(i),u&&u.deltaY&&(c+=u.deltaY),p&&i.fillText(l,s-w.offsetX,c-w.offsetY),_&&i.strokeText(l,s-S.offsetX,c-S.offsetY),i.restore())},setSuperscript:function(t,i){return this._setScript(t,i,this.superscript)},setSubscript:function(t,i){return this._setScript(t,i,this.subscript)},_setScript:function(t,i,r){var e=this.get2DCursorLocation(t,!0),l=this.getValueOfPropertyAt(e.lineIndex,e.charIndex,"fontSize"),s=this.getValueOfPropertyAt(e.lineIndex,e.charIndex,"deltaY"),c={fontSize:l*r.size,deltaY:s+l*r.baseline};return this.setSelectionStyles(c,t,i),this},_getLineLeftOffset:function(t){var i=this.getLineWidth(t),r=this.width-i,e=this.textAlign,l=this.direction,c,s=0,c=this.isEndOfWrapping(t);return e==="justify"||e==="justify-center"&&!c||e==="justify-right"&&!c||e==="justify-left"&&!c?0:(e==="center"&&(s=r/2),e==="right"&&(s=r),e==="justify-center"&&(s=r/2),e==="justify-right"&&(s=r),l==="rtl"&&(s-=r),s)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];var i=this.measureLine(t),r=i.width;return this.__lineWidths[t]=r,r},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,i,r){var e=this._getStyleDeclaration(t,i);return e&&typeof e[r]<"u"?e[r]:this[r]},_renderTextDecoration:function(t,i){if(!(!this[i]&&!this.styleHas(i))){for(var r,e,l,s,c,u,h,p,_=this._getLeftOffset(),w=this._getTopOffset(),S,C,E,k,O,U,F,M,j=this.path,G=this._getWidthOfCharSpacing(),N=this.offsets[i],R=0,A=this._textLines.length;R<A;R++){if(r=this.getHeightOfLine(R),!this[i]&&!this.styleHas(i,R)){w+=r;continue}h=this._textLines[R],U=r/this.lineHeight,s=this._getLineLeftOffset(R),C=0,E=0,p=this.getValueOfPropertyAt(R,0,i),M=this.getValueOfPropertyAt(R,0,"fill"),S=w+U*(1-this._fontSizeFraction),e=this.getHeightOfChar(R,0),c=this.getValueOfPropertyAt(R,0,"deltaY");for(var H=0,Z=h.length;H<Z;H++)if(k=this.__charBounds[R][H],O=this.getValueOfPropertyAt(R,H,i),F=this.getValueOfPropertyAt(R,H,"fill"),l=this.getHeightOfChar(R,H),u=this.getValueOfPropertyAt(R,H,"deltaY"),j&&O&&F)t.save(),t.fillStyle=M,t.translate(k.renderLeft,k.renderTop),t.rotate(k.angle),t.fillRect(-k.kernedWidth/2,N*l+u,k.kernedWidth,this.fontSize/15),t.restore();else if((O!==p||F!==M||l!==e||u!==c)&&E>0){var K=_+s+C;this.direction==="rtl"&&(K=this.width-K-E),p&&M&&(t.fillStyle=M,t.fillRect(K,S+N*e+c,E,this.fontSize/15)),C=k.left,E=k.width,p=O,M=F,e=l,c=u}else E+=k.kernedWidth;var K=_+s+C;this.direction==="rtl"&&(K=this.width-K-E),t.fillStyle=F,O&&F&&t.fillRect(K,S+N*e+c,E-G,this.fontSize/15),w+=r}this._removeShadow(t)}},_getFontDeclaration:function(t,i){var r=t||this,e=this.fontFamily,l=n.Text.genericFonts.indexOf(e.toLowerCase())>-1,s=e===void 0||e.indexOf("'")>-1||e.indexOf(",")>-1||e.indexOf('"')>-1||l?r.fontFamily:'"'+r.fontFamily+'"';return[n.isLikelyNode?r.fontWeight:r.fontStyle,n.isLikelyNode?r.fontStyle:r.fontWeight,i?this.CACHE_FONT_SIZE+"px":r.fontSize+"px",s].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var i=t.split(this._reNewline),r=new Array(i.length),e=["\n"],l=[],s=0;s<i.length;s++)r[s]=n.util.string.graphemeSplit(i[s]),l=l.concat(r[s],e);return l.pop(),{_unwrappedLines:r,lines:i,graphemeText:l,graphemeLines:r}},toObject:function(t){var i=a.concat(t),r=this.callSuper("toObject",i);return r.styles=n.util.stylesToArray(this.styles,this.text),r.path&&(r.path=this.path.toObject()),r},set:function(t,i){this.callSuper("set",t,i);var r=!1,e=!1;if(typeof t=="object")for(var l in t)l==="path"&&this.setPathInfo(),r=r||this._dimensionAffectingProps.indexOf(l)!==-1,e=e||l==="path";else r=this._dimensionAffectingProps.indexOf(t)!==-1,e=t==="path";return e&&this.setPathInfo(),r&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),n.Text.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),n.Text.DEFAULT_SVG_FONT_SIZE=16,n.Text.fromElement=function(t,i,r){if(!t)return i(null);var e=n.parseAttributes(t,n.Text.ATTRIBUTE_NAMES),l=e.textAnchor||"left";if(r=n.util.object.extend(r?o(r):{},e),r.top=r.top||0,r.left=r.left||0,e.textDecoration){var s=e.textDecoration;s.indexOf("underline")!==-1&&(r.underline=!0),s.indexOf("overline")!==-1&&(r.overline=!0),s.indexOf("line-through")!==-1&&(r.linethrough=!0),delete r.textDecoration}"dx"in e&&(r.left+=e.dx),"dy"in e&&(r.top+=e.dy),"fontSize"in r||(r.fontSize=n.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in t?c=t.textContent:"firstChild"in t&&t.firstChild!==null&&"data"in t.firstChild&&t.firstChild.data!==null&&(c=t.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var u=r.strokeWidth;r.strokeWidth=0;var h=new n.Text(c,r),p=h.getScaledHeight()/h.height,_=(h.height+h.strokeWidth)*h.lineHeight-h.height,w=_*p,S=h.getScaledHeight()+w,C=0;l==="center"&&(C=h.getScaledWidth()/2),l==="right"&&(C=h.getScaledWidth()),h.set({left:h.left-C,top:h.top-(S-h.fontSize*(.07+h._fontSizeFraction))/h.lineHeight,strokeWidth:typeof u<"u"?u:1}),i(h)},n.Text.fromObject=function(t,i){var r=o(t),e=t.path;return delete r.path,n.Object._fromObject("Text",r,function(l){l.styles=n.util.stylesFromArray(t.styles,t.text),e?n.Object._fromObject("Path",e,function(s){l.set("path",s),i(l)},"path"):i(l)},"text")},n.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],n.util.createAccessors&&n.util.createAccessors(n.Text)}(v),function(){d.util.object.extend(d.Text.prototype,{isEmptyStyles:function(f){if(!this.styles||typeof f<"u"&&!this.styles[f])return!0;var n=typeof f>"u"?this.styles:{line:this.styles[f]};for(var o in n)for(var a in n[o])for(var t in n[o][a])return!1;return!0},styleHas:function(f,n){if(!this.styles||!f||f===""||typeof n<"u"&&!this.styles[n])return!1;var o=typeof n>"u"?this.styles:{0:this.styles[n]};for(var a in o)for(var t in o[a])if(typeof o[a][t][f]<"u")return!0;return!1},cleanStyle:function(f){if(!this.styles||!f||f==="")return!1;var n=this.styles,o=0,a,t,i=!0,r=0,e;for(var l in n){a=0;for(var s in n[l]){var e=n[l][s],c=e.hasOwnProperty(f);o++,c?(t?e[f]!==t&&(i=!1):t=e[f],e[f]===this[f]&&delete e[f]):i=!1,Object.keys(e).length!==0?a++:delete n[l][s]}a===0&&delete n[l]}for(var u=0;u<this._textLines.length;u++)r+=this._textLines[u].length;i&&o===r&&(this[f]=t,this.removeStyle(f))},removeStyle:function(f){if(!(!this.styles||!f||f==="")){var n=this.styles,o,a,t;for(a in n){o=n[a];for(t in o)delete o[t][f],Object.keys(o[t]).length===0&&delete o[t];Object.keys(o).length===0&&delete n[a]}}},_extendStyles:function(f,n){var o=this.get2DCursorLocation(f);this._getLineStyle(o.lineIndex)||this._setLineStyle(o.lineIndex),this._getStyleDeclaration(o.lineIndex,o.charIndex)||this._setStyleDeclaration(o.lineIndex,o.charIndex,{}),d.util.object.extend(this._getStyleDeclaration(o.lineIndex,o.charIndex),n)},get2DCursorLocation:function(f,n){typeof f>"u"&&(f=this.selectionStart);for(var o=n?this._unwrappedTextLines:this._textLines,a=o.length,t=0;t<a;t++){if(f<=o[t].length)return{lineIndex:t,charIndex:f};f-=o[t].length+this.missingNewlineOffset(t)}return{lineIndex:t-1,charIndex:o[t-1].length<f?o[t-1].length:f}},getSelectionStyles:function(f,n,o){typeof f>"u"&&(f=this.selectionStart||0),typeof n>"u"&&(n=this.selectionEnd||f);for(var a=[],t=f;t<n;t++)a.push(this.getStyleAtPosition(t,o));return a},getStyleAtPosition:function(f,n){var o=this.get2DCursorLocation(f),a=n?this.getCompleteStyleDeclaration(o.lineIndex,o.charIndex):this._getStyleDeclaration(o.lineIndex,o.charIndex);return a||{}},setSelectionStyles:function(f,n,o){typeof n>"u"&&(n=this.selectionStart||0),typeof o>"u"&&(o=this.selectionEnd||n);for(var a=n;a<o;a++)this._extendStyles(a,f);return this._forceClearCache=!0,this},_getStyleDeclaration:function(f,n){var o=this.styles&&this.styles[f];return o?o[n]:null},getCompleteStyleDeclaration:function(f,n){for(var o=this._getStyleDeclaration(f,n)||{},a={},t,i=0;i<this._styleProperties.length;i++)t=this._styleProperties[i],a[t]=typeof o[t]>"u"?this[t]:o[t];return a},_setStyleDeclaration:function(f,n,o){this.styles[f][n]=o},_deleteStyleDeclaration:function(f,n){delete this.styles[f][n]},_getLineStyle:function(f){return!!this.styles[f]},_setLineStyle:function(f){this.styles[f]={}},_deleteLineStyle:function(f){delete this.styles[f]}})}(),function(){function f(n){n.textDecoration&&(n.textDecoration.indexOf("underline")>-1&&(n.underline=!0),n.textDecoration.indexOf("line-through")>-1&&(n.linethrough=!0),n.textDecoration.indexOf("overline")>-1&&(n.overline=!0),delete n.textDecoration)}d.IText=d.util.createClass(d.Text,d.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(n,o){this.callSuper("initialize",n,o),this.initBehavior()},setSelectionStart:function(n){n=Math.max(n,0),this._updateAndFire("selectionStart",n)},setSelectionEnd:function(n){n=Math.min(n,this.text.length),this._updateAndFire("selectionEnd",n)},_updateAndFire:function(n,o){this[n]!==o&&(this._fireSelectionChanged(),this[n]=o),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(n){this.clearContextTop(),this.callSuper("render",n),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(n){this.callSuper("_render",n)},clearContextTop:function(n){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var o=this.canvas.contextTop,a=this.canvas.viewportTransform;o.save(),o.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this.transform(o),this._clearTextArea(o),n||o.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var n=this._getCursorBoundaries(),o=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(n,o):this.renderSelection(n,o),o.restore()}},_clearTextArea:function(n){var o=this.width+4,a=this.height+4;n.clearRect(-o/2,-a/2,o,a)},_getCursorBoundaries:function(n){typeof n>"u"&&(n=this.selectionStart);var o=this._getLeftOffset(),a=this._getTopOffset(),t=this._getCursorBoundariesOffsets(n);return{left:o,top:a,leftOffset:t.left,topOffset:t.top}},_getCursorBoundariesOffsets:function(n){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var o,a,t,i=0,r=0,e,l=this.get2DCursorLocation(n);t=l.charIndex,a=l.lineIndex;for(var s=0;s<a;s++)i+=this.getHeightOfLine(s);o=this._getLineLeftOffset(a);var c=this.__charBounds[a][t];return c&&(r=c.left),this.charSpacing!==0&&t===this._textLines[a].length&&(r-=this._getWidthOfCharSpacing()),e={top:i,left:o+(r>0?r:0)},this.direction==="rtl"&&(e.left*=-1),this.cursorOffsetCache=e,this.cursorOffsetCache},renderCursor:function(n,o){var a=this.get2DCursorLocation(),t=a.lineIndex,i=a.charIndex>0?a.charIndex-1:0,r=this.getValueOfPropertyAt(t,i,"fontSize"),e=this.scaleX*this.canvas.getZoom(),l=this.cursorWidth/e,s=n.topOffset,c=this.getValueOfPropertyAt(t,i,"deltaY");s+=(1-this._fontSizeFraction)*this.getHeightOfLine(t)/this.lineHeight-r*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(n,o),o.fillStyle=this.cursorColor||this.getValueOfPropertyAt(t,i,"fill"),o.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,o.fillRect(n.left+n.leftOffset-l/2,s+n.top+c,l,r)},renderSelection:function(n,o){for(var a=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,t=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,i=this.textAlign.indexOf("justify")!==-1,r=this.get2DCursorLocation(a),e=this.get2DCursorLocation(t),l=r.lineIndex,s=e.lineIndex,c=r.charIndex<0?0:r.charIndex,u=e.charIndex<0?0:e.charIndex,h=l;h<=s;h++){var p=this._getLineLeftOffset(h)||0,_=this.getHeightOfLine(h),w=0,S=0,C=0;if(h===l&&(S=this.__charBounds[l][c].left),h>=l&&h<s)C=i&&!this.isEndOfWrapping(h)?this.width:this.getLineWidth(h)||5;else if(h===s)if(u===0)C=this.__charBounds[s][u].left;else{var E=this._getWidthOfCharSpacing();C=this.__charBounds[s][u-1].left+this.__charBounds[s][u-1].width-E}w=_,(this.lineHeight<1||h===s&&this.lineHeight>1)&&(_/=this.lineHeight);var k=n.left+p+S,O=C-S,U=_,F=0;this.inCompositionMode?(o.fillStyle=this.compositionColor||"black",U=1,F=_):o.fillStyle=this.selectionColor,this.direction==="rtl"&&(k=this.width-k-O),o.fillRect(k,n.top+n.topOffset+F,O,U),n.topOffset+=w}},getCurrentCharFontSize:function(){var n=this._getCurrentCharIndex();return this.getValueOfPropertyAt(n.l,n.c,"fontSize")},getCurrentCharColor:function(){var n=this._getCurrentCharIndex();return this.getValueOfPropertyAt(n.l,n.c,"fill")},_getCurrentCharIndex:function(){var n=this.get2DCursorLocation(this.selectionStart,!0),o=n.charIndex>0?n.charIndex-1:0;return{l:n.lineIndex,c:o}}}),d.IText.fromObject=function(n,o){var a=d.util.stylesFromArray(n.styles,n.text),t=Object.assign({},n,{styles:a});if(f(t),t.styles)for(var i in t.styles)for(var r in t.styles[i])f(t.styles[i][r]);d.Object._fromObject("IText",t,o,"text")}}(),function(){var f=d.util.object.clone;d.util.object.extend(d.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var n=this;this.on("added",function(){var o=n.canvas;o&&(o._hasITextHandlers||(o._hasITextHandlers=!0,n._initCanvasHandlers(o)),o._iTextInstances=o._iTextInstances||[],o._iTextInstances.push(n))})},initRemovedHandler:function(){var n=this;this.on("removed",function(){var o=n.canvas;o&&(o._iTextInstances=o._iTextInstances||[],d.util.removeFromArray(o._iTextInstances,n),o._iTextInstances.length===0&&(o._hasITextHandlers=!1,n._removeCanvasHandlers(o)))})},_initCanvasHandlers:function(n){n._mouseUpITextHandler=function(){n._iTextInstances&&n._iTextInstances.forEach(function(o){o.__isMousedown=!1})},n.on("mouse:up",n._mouseUpITextHandler)},_removeCanvasHandlers:function(n){n.off("mouse:up",n._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(n,o,a,t){var i;return i={isAborted:!1,abort:function(){this.isAborted=!0}},n.animate("_currentCursorOpacity",o,{duration:a,onComplete:function(){i.isAborted||n[t]()},onChange:function(){n.canvas&&n.selectionStart===n.selectionEnd&&n.renderCursorOrSelection()},abort:function(){return i.isAborted}}),i},_onTickComplete:function(){var n=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){n._currentTickCompleteState=n._animateCursor(n,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(n){var o=this,a=n?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){o._tick()},a)},abortCursorAnimation:function(){var n=this._currentTickState||this._currentTickCompleteState,o=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,n&&o&&o.clearContext(o.contextTop||o.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(n){var o=0,a=n-1;if(this._reSpace.test(this._text[a]))for(;this._reSpace.test(this._text[a]);)o++,a--;for(;/\S/.test(this._text[a])&&a>-1;)o++,a--;return n-o},findWordBoundaryRight:function(n){var o=0,a=n;if(this._reSpace.test(this._text[a]))for(;this._reSpace.test(this._text[a]);)o++,a++;for(;/\S/.test(this._text[a])&&a<this._text.length;)o++,a++;return n+o},findLineBoundaryLeft:function(n){for(var o=0,a=n-1;!/\n/.test(this._text[a])&&a>-1;)o++,a--;return n-o},findLineBoundaryRight:function(n){for(var o=0,a=n;!/\n/.test(this._text[a])&&a<this._text.length;)o++,a++;return n+o},searchWordBoundary:function(n,o){for(var a=this._text,t=this._reSpace.test(a[n])?n-1:n,i=a[t],r=d.reNonWord;!r.test(i)&&t>0&&t<a.length;)t+=o,i=a[t];return r.test(i)&&(t+=o===1?0:1),t},selectWord:function(n){n=n||this.selectionStart;var o=this.searchWordBoundary(n,-1),a=this.searchWordBoundary(n,1);this.selectionStart=o,this.selectionEnd=a,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(n){n=n||this.selectionStart;var o=this.findLineBoundaryLeft(n),a=this.findLineBoundaryRight(n);return this.selectionStart=o,this.selectionEnd=a,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(n){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(n),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(n){n._iTextInstances&&n._iTextInstances.forEach(function(o){o.selected=!1,o.isEditing&&o.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(n){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var o=this.getSelectionStartFromPointer(n.e),a=this.selectionStart,t=this.selectionEnd;(o!==this.__selectionStartOnMouseDown||a===t)&&(a===o||t===o)||(o>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=o):(this.selectionStart=o,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==a||this.selectionEnd!==t)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(n,o,a){var t=a.slice(0,n),i=d.util.string.graphemeSplit(t).length;if(n===o)return{selectionStart:i,selectionEnd:i};var r=a.slice(n,o),e=d.util.string.graphemeSplit(r).length;return{selectionStart:i,selectionEnd:i+e}},fromGraphemeToStringSelection:function(n,o,a){var t=a.slice(0,n),i=t.join("").length;if(n===o)return{selectionStart:i,selectionEnd:i};var r=a.slice(n,o),e=r.join("").length;return{selectionStart:i,selectionEnd:i+e}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var n=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=n.selectionStart,this.hiddenTextarea.selectionEnd=n.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var n=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=n.selectionEnd,this.inCompositionMode||(this.selectionStart=n.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var n=this._calcTextareaPosition();this.hiddenTextarea.style.left=n.left,this.hiddenTextarea.style.top=n.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var n=this.inCompositionMode?this.compositionStart:this.selectionStart,o=this._getCursorBoundaries(n),a=this.get2DCursorLocation(n),t=a.lineIndex,i=a.charIndex,r=this.getValueOfPropertyAt(t,i,"fontSize")*this.lineHeight,e=o.leftOffset,l=this.calcTransformMatrix(),s={x:o.left+e,y:o.top+o.topOffset+r},c=this.canvas.getRetinaScaling(),u=this.canvas.upperCanvasEl,h=u.width/c,p=u.height/c,_=h-r,w=p-r,S=u.clientWidth/h,C=u.clientHeight/p;return s=d.util.transformPoint(s,l),s=d.util.transformPoint(s,this.canvas.viewportTransform),s.x*=S,s.y*=C,s.x<0&&(s.x=0),s.x>_&&(s.x=_),s.y<0&&(s.y=0),s.y>w&&(s.y=w),s.x+=this.canvas._offset.left,s.y+=this.canvas._offset.top,{left:s.x+"px",top:s.y+"px",fontSize:r+"px",charHeight:r}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var n=this._textBeforeEdit!==this.text,o=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,o&&(o.blur&&o.blur(),o.parentNode&&o.parentNode.removeChild(o)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),n&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),n&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var n in this.styles)this._textLines[n]||delete this.styles[n]},removeStyleFromTo:function(n,o){var a=this.get2DCursorLocation(n,!0),t=this.get2DCursorLocation(o,!0),i=a.lineIndex,r=a.charIndex,e=t.lineIndex,l=t.charIndex,s,c;if(i!==e){if(this.styles[i])for(s=r;s<this._unwrappedTextLines[i].length;s++)delete this.styles[i][s];if(this.styles[e])for(s=l;s<this._unwrappedTextLines[e].length;s++)c=this.styles[e][s],c&&(this.styles[i]||(this.styles[i]={}),this.styles[i][r+s-l]=c);for(s=i+1;s<=e;s++)delete this.styles[s];this.shiftLineStyles(e,i-e)}else if(this.styles[i]){c=this.styles[i];var u=l-r,h,p;for(s=r;s<l;s++)delete c[s];for(p in this.styles[i])h=parseInt(p,10),h>=l&&(c[h-u]=c[p],delete c[p])}},shiftLineStyles:function(n,o){var a=f(this.styles);for(var t in this.styles){var i=parseInt(t,10);i>n&&(this.styles[i+o]=a[i],a[i-o]||delete this.styles[i])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(n,o,a,t){var i,r={},e=!1,l=this._unwrappedTextLines[n].length===o;a||(a=1),this.shiftLineStyles(n,a),this.styles[n]&&(i=this.styles[n][o===0?o:o-1]);for(var s in this.styles[n]){var c=parseInt(s,10);c>=o&&(e=!0,r[c-o]=this.styles[n][s],l&&o===0||delete this.styles[n][s])}var u=!1;for(e&&!l&&(this.styles[n+a]=r,u=!0),u&&a--;a>0;)t&&t[a-1]?this.styles[n+a]={0:f(t[a-1])}:i?this.styles[n+a]={0:f(i)}:delete this.styles[n+a],a--;this._forceClearCache=!0},insertCharStyleObject:function(n,o,a,t){this.styles||(this.styles={});var i=this.styles[n],r=i?f(i):{};a||(a=1);for(var e in r){var l=parseInt(e,10);l>=o&&(i[l+a]=r[l],r[l-a]||delete i[l])}if(this._forceClearCache=!0,t){for(;a--;)Object.keys(t[a]).length&&(this.styles[n]||(this.styles[n]={}),this.styles[n][o+a]=f(t[a]));return}if(i)for(var s=i[o?o-1:1];s&&a--;)this.styles[n][o+a]=f(s)},insertNewStyleBlock:function(n,o,a){for(var t=this.get2DCursorLocation(o,!0),i=[0],r=0,e=0;e<n.length;e++)n[e]==="\n"?(r++,i[r]=0):i[r]++;i[0]>0&&(this.insertCharStyleObject(t.lineIndex,t.charIndex,i[0],a),a=a&&a.slice(i[0]+1)),r&&this.insertNewlineStyleObject(t.lineIndex,t.charIndex+i[0],r);for(var e=1;e<r;e++)i[e]>0?this.insertCharStyleObject(t.lineIndex+e,0,i[e],a):a&&this.styles[t.lineIndex+e]&&a[0]&&(this.styles[t.lineIndex+e][0]=a[0]),a=a&&a.slice(i[e]+1);i[e]>0&&this.insertCharStyleObject(t.lineIndex+e,0,i[e],a)},setSelectionStartEndWithShift:function(n,o,a){a<=n?(o===n?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=n),this.selectionStart=a):a>n&&a<o?this._selectionDirection==="right"?this.selectionEnd=a:this.selectionStart=a:(o===n?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=o),this.selectionEnd=a)},setSelectionInBoundaries:function(){var n=this.text.length;this.selectionStart>n?this.selectionStart=n:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>n?this.selectionEnd=n:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),d.util.object.extend(d.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(f){if(this.canvas){this.__newClickTime=+new Date;var n=f.pointer;this.isTripleClick(n)&&(this.fire("tripleclick",f),this._stopEvent(f.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=n,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(f){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===f.x&&this.__lastPointer.y===f.y},_stopEvent:function(f){f.preventDefault&&f.preventDefault(),f.stopPropagation&&f.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(f){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(f.e))},tripleClickHandler:function(f){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(f.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(f){!this.canvas||!this.editable||f.e.button&&f.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(f.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(f){!this.canvas||!this.editable||f.e.button&&f.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(f){if(this.__isMousedown=!1,!(!this.editable||this.group||f.transform&&f.transform.actionPerformed||f.e.button&&f.e.button!==1)){if(this.canvas){var n=this.canvas._activeObject;if(n&&n!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(f.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(f){var n=this.getSelectionStartFromPointer(f),o=this.selectionStart,a=this.selectionEnd;f.shiftKey?this.setSelectionStartEndWithShift(o,a,n):(this.selectionStart=n,this.selectionEnd=n),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(f){for(var n=this.getLocalPointer(f),o=0,a=0,t=0,i=0,r=0,e,l,s=0,c=this._textLines.length;s<c&&t<=n.y;s++)t+=this.getHeightOfLine(s)*this.scaleY,r=s,s>0&&(i+=this._textLines[s-1].length+this.missingNewlineOffset(s-1));e=this._getLineLeftOffset(r),a=e*this.scaleX,l=this._textLines[r],this.direction==="rtl"&&(n.x=this.width*this.scaleX-n.x+a);for(var u=0,h=l.length;u<h&&(o=a,a+=this.__charBounds[r][u].kernedWidth*this.scaleX,a<=n.x);u++)i++;return this._getNewSelectionStartFromOffset(n,o,a,i,h)},_getNewSelectionStartFromOffset:function(f,n,o,a,t){var i=f.x-n,r=o-f.x,e=r>i||r<0?0:1,l=a+e;return this.flipX&&(l=t-l),l>this._text.length&&(l=this._text.length),l}}),d.util.object.extend(d.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=d.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var f=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+f.top+"; left: "+f.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+f.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):d.document.body.appendChild(this.hiddenTextarea),d.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),d.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),d.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),d.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),d.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),d.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),d.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),d.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),d.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(d.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(f){if(this.isEditing){var n=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(f.keyCode in n)this[n[f.keyCode]](f);else if(f.keyCode in this.ctrlKeysMapDown&&(f.ctrlKey||f.metaKey))this[this.ctrlKeysMapDown[f.keyCode]](f);else return;f.stopImmediatePropagation(),f.preventDefault(),f.keyCode>=33&&f.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(f){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(f.keyCode in this.ctrlKeysMapUp&&(f.ctrlKey||f.metaKey))this[this.ctrlKeysMapUp[f.keyCode]](f);else return;f.stopImmediatePropagation(),f.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(f){var n=this.fromPaste;if(this.fromPaste=!1,f&&f.stopPropagation(),!!this.isEditing){var o=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,a=this._text.length,t=o.length,i,r,e=t-a,l=this.selectionStart,s=this.selectionEnd,c=l!==s,u,h,p;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var _=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),w=l>_.selectionStart;c?(i=this._text.slice(l,s),e+=s-l):t<a&&(w?i=this._text.slice(s+e,s):i=this._text.slice(l,l-e)),r=o.slice(_.selectionEnd-e,_.selectionEnd),i&&i.length&&(r.length&&(u=this.getSelectionStyles(l,l+1,!1),u=r.map(function(){return u[0]})),c?(h=l,p=s):w?(h=s-i.length,p=s):(h=s,p=s+i.length),this.removeStyleFromTo(h,p)),r.length&&(n&&r.join("")===d.copiedText&&!d.disableStyleCopyPaste&&(u=d.copiedTextStyle),this.insertNewStyleBlock(r,l,u)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(f){this.compositionStart=f.target.selectionStart,this.compositionEnd=f.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(d.copiedText=this.getSelectedText(),d.disableStyleCopyPaste?d.copiedTextStyle=null:d.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(f){return f&&f.clipboardData||d.window.clipboardData},_getWidthBeforeCursor:function(f,n){var o=this._getLineLeftOffset(f),a;return n>0&&(a=this.__charBounds[f][n-1],o+=a.left+a.width),o},getDownCursorOffset:function(f,n){var o=this._getSelectionForOffset(f,n),a=this.get2DCursorLocation(o),t=a.lineIndex;if(t===this._textLines.length-1||f.metaKey||f.keyCode===34)return this._text.length-o;var i=a.charIndex,r=this._getWidthBeforeCursor(t,i),e=this._getIndexOnLine(t+1,r),l=this._textLines[t].slice(i);return l.length+e+1+this.missingNewlineOffset(t)},_getSelectionForOffset:function(f,n){return f.shiftKey&&this.selectionStart!==this.selectionEnd&&n?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(f,n){var o=this._getSelectionForOffset(f,n),a=this.get2DCursorLocation(o),t=a.lineIndex;if(t===0||f.metaKey||f.keyCode===33)return-o;var i=a.charIndex,r=this._getWidthBeforeCursor(t,i),e=this._getIndexOnLine(t-1,r),l=this._textLines[t].slice(0,i),s=this.missingNewlineOffset(t-1);return-this._textLines[t-1].length+e-l.length+(1-s)},_getIndexOnLine:function(f,n){for(var o=this._textLines[f],a=this._getLineLeftOffset(f),t=a,i=0,r,e,l=0,s=o.length;l<s;l++)if(r=this.__charBounds[f][l].width,t+=r,t>n){e=!0;var c=t-r,u=t,h=Math.abs(c-n),p=Math.abs(u-n);i=p<h?l:l-1;break}return e||(i=o.length-1),i},moveCursorDown:function(f){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",f)},moveCursorUp:function(f){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",f)},_moveCursorUpOrDown:function(f,n){var o="get"+f+"CursorOffset",a=this[o](n,this._selectionDirection==="right");n.shiftKey?this.moveCursorWithShift(a):this.moveCursorWithoutShift(a),a!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(f){var n=this._selectionDirection==="left"?this.selectionStart+f:this.selectionEnd+f;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,n),f!==0},moveCursorWithoutShift:function(f){return f<0?(this.selectionStart+=f,this.selectionEnd=this.selectionStart):(this.selectionEnd+=f,this.selectionStart=this.selectionEnd),f!==0},moveCursorLeft:function(f){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",f)},_move:function(f,n,o){var a;if(f.altKey)a=this["findWordBoundary"+o](this[n]);else if(f.metaKey||f.keyCode===35||f.keyCode===36)a=this["findLineBoundary"+o](this[n]);else return this[n]+=o==="Left"?-1:1,!0;if(typeof a<"u"&&this[n]!==a)return this[n]=a,!0},_moveLeft:function(f,n){return this._move(f,n,"Left")},_moveRight:function(f,n){return this._move(f,n,"Right")},moveCursorLeftWithoutShift:function(f){var n=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(n=this._moveLeft(f,"selectionStart")),this.selectionEnd=this.selectionStart,n},moveCursorLeftWithShift:function(f){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(f,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(f,"selectionStart")},moveCursorRight:function(f){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",f)},_moveCursorLeftOrRight:function(f,n){var o="moveCursor"+f+"With";this._currentCursorOpacity=1,n.shiftKey?o+="Shift":o+="outShift",this[o](n)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(f){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(f,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(f,"selectionEnd")},moveCursorRightWithoutShift:function(f){var n=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(n=this._moveRight(f,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,n},removeChars:function(f,n){typeof n>"u"&&(n=f+1),this.removeStyleFromTo(f,n),this._text.splice(f,n-f),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(f,n,o,a){typeof a>"u"&&(a=o),a>o&&this.removeStyleFromTo(o,a);var t=d.util.string.graphemeSplit(f);this.insertNewStyleBlock(t,o,n),this._text=[].concat(this._text.slice(0,o),t,this._text.slice(a)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var f=d.util.toFixed,n=/  +/g;d.util.object.extend(d.Text.prototype,{_toSVG:function(){var o=this._getSVGLeftTopOffsets(),a=this._getSVGTextAndBg(o.textTop,o.textLeft);return this._wrapSVGTextAndBg(a)},toSVG:function(o){return this._createBaseSVGMarkup(this._toSVG(),{reviver:o,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(o){var a=!0,t=this.getSvgTextDecoration(this);return[o.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",t?'text-decoration="'+t+'" ':"",'style="',this.getSvgStyles(a),'"',this.addPaintOrder()," >",o.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(o,a){var t=[],i=[],r=o,e;this._setSVGBg(i);for(var l=0,s=this._textLines.length;l<s;l++)e=this._getLineLeftOffset(l),(this.textBackgroundColor||this.styleHas("textBackgroundColor",l))&&this._setSVGTextLineBg(i,l,a+e,r),this._setSVGTextLineText(t,l,a+e,r),r+=this.getHeightOfLine(l);return{textSpans:t,textBgRects:i}},_createTextCharSpan:function(o,a,t,i){var r=o!==o.trim()||o.match(n),e=this.getSvgSpanStyles(a,r),l=e?'style="'+e+'"':"",s=a.deltaY,c="",u=d.Object.NUM_FRACTION_DIGITS;return s&&(c=' dy="'+f(s,u)+'" '),['<tspan x="',f(t,u),'" y="',f(i,u),'" ',c,l,">",d.util.string.escapeXml(o),"</tspan>"].join("")},_setSVGTextLineText:function(o,a,t,i){var r=this.getHeightOfLine(a),e=this.textAlign.indexOf("justify")!==-1,l,s,c="",u,h,p=0,_=this._textLines[a],w;i+=r*(1-this._fontSizeFraction)/this.lineHeight;for(var S=0,C=_.length-1;S<=C;S++)w=S===C||this.charSpacing,c+=_[S],u=this.__charBounds[a][S],p===0?(t+=u.kernedWidth-u.width,p+=u.width):p+=u.kernedWidth,e&&!w&&this._reSpaceAndTab.test(_[S])&&(w=!0),w||(l=l||this.getCompleteStyleDeclaration(a,S),s=this.getCompleteStyleDeclaration(a,S+1),w=d.util.hasStyleChanged(l,s,!0)),w&&(h=this._getStyleDeclaration(a,S)||{},o.push(this._createTextCharSpan(c,h,t,i)),c="",l=s,t+=p,p=0)},_pushTextBgRect:function(o,a,t,i,r,e){var l=d.Object.NUM_FRACTION_DIGITS;o.push("		<rect ",this._getFillAttributes(a),' x="',f(t,l),'" y="',f(i,l),'" width="',f(r,l),'" height="',f(e,l),'"></rect>\n')},_setSVGTextLineBg:function(o,a,t,i){for(var r=this._textLines[a],e=this.getHeightOfLine(a)/this.lineHeight,l=0,s=0,c,u,h=this.getValueOfPropertyAt(a,0,"textBackgroundColor"),p=0,_=r.length;p<_;p++)c=this.__charBounds[a][p],u=this.getValueOfPropertyAt(a,p,"textBackgroundColor"),u!==h?(h&&this._pushTextBgRect(o,h,t+s,i,l,e),s=c.left,l=c.width,h=u):l+=c.kernedWidth;u&&this._pushTextBgRect(o,u,t+s,i,l,e)},_getFillAttributes:function(o){var a=o&&typeof o=="string"?new d.Color(o):"";return!a||!a.getSource()||a.getAlpha()===1?'fill="'+o+'"':'opacity="'+a.getAlpha()+'" fill="'+a.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(o){for(var a=0,t=0,i=0;i<o;i++)a+=this.getHeightOfLine(i);return t=this.getHeightOfLine(i),{lineTop:a,offset:(this._fontSizeMult-this._fontSizeFraction)*t/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(o){var a=d.Object.prototype.getSvgStyles.call(this,o);return a+" white-space: pre;"}})}(),function(f){var n=f.fabric||(f.fabric={});n.Textbox=n.util.createClass(n.IText,n.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:n.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(o){for(var a=0,t=0,i=0,r={},e=0;e<o.graphemeLines.length;e++)o.graphemeText[i]==="\n"&&e>0?(t=0,i++,a++):!this.splitByGrapheme&&this._reSpaceAndTab.test(o.graphemeText[i])&&e>0&&(t++,i++),r[e]={line:a,offset:t},i+=o.graphemeLines[e].length,t+=o.graphemeLines[e].length;return r},styleHas:function(o,a){if(this._styleMap&&!this.isWrapping){var t=this._styleMap[a];t&&(a=t.line)}return n.Text.prototype.styleHas.call(this,o,a)},isEmptyStyles:function(o){if(!this.styles)return!0;var a=0,t=o+1,i,r,e=!1,l=this._styleMap[o],s=this._styleMap[o+1];l&&(o=l.line,a=l.offset),s&&(t=s.line,e=t===o,i=s.offset),r=typeof o>"u"?this.styles:{line:this.styles[o]};for(var c in r)for(var u in r[c])if(u>=a&&(!e||u<i))for(var h in r[c][u])return!1;return!0},_getStyleDeclaration:function(o,a){if(this._styleMap&&!this.isWrapping){var t=this._styleMap[o];if(!t)return null;o=t.line,a=t.offset+a}return this.callSuper("_getStyleDeclaration",o,a)},_setStyleDeclaration:function(o,a,t){var i=this._styleMap[o];o=i.line,a=i.offset+a,this.styles[o][a]=t},_deleteStyleDeclaration:function(o,a){var t=this._styleMap[o];o=t.line,a=t.offset+a,delete this.styles[o][a]},_getLineStyle:function(o){var a=this._styleMap[o];return!!this.styles[a.line]},_setLineStyle:function(o){var a=this._styleMap[o];this.styles[a.line]={}},_wrapText:function(o,a){var t=[],i;for(this.isWrapping=!0,i=0;i<o.length;i++)t=t.concat(this._wrapLine(o[i],i,a));return this.isWrapping=!1,t},_measureWord:function(o,a,t){var i=0,r,e=!0;t=t||0;for(var l=0,s=o.length;l<s;l++){var c=this._getGraphemeBox(o[l],a,l+t,r,e);i+=c.kernedWidth,r=o[l]}return i},_wrapLine:function(o,a,t,k){var r=0,e=this.splitByGrapheme,l=[],s=[],c=e?n.util.string.graphemeSplit(o):o.split(this._wordJoiners),u="",h=0,p=e?"":" ",_=0,w=0,S=0,C=!0,E=this._getWidthOfCharSpacing(),k=k||0;c.length===0&&c.push([]),t-=k;for(var O=0;O<c.length;O++)u=e?c[O]:n.util.string.graphemeSplit(c[O]),_=this._measureWord(u,a,h),h+=u.length,r+=w+_-E,r>t&&!C?(l.push(s),s=[],r=_,C=!0):r+=E,!C&&!e&&s.push(p),s=s.concat(u),w=e?0:this._measureWord([p],a,h),h++,C=!1,_>S&&(S=_);return O&&l.push(s),S+k>this.dynamicMinWidth&&(this.dynamicMinWidth=S-E+k),l},isEndOfWrapping:function(o){return!this._styleMap[o+1]||this._styleMap[o+1].line!==this._styleMap[o].line},missingNewlineOffset:function(o){return this.splitByGrapheme?this.isEndOfWrapping(o)?1:0:1},_splitTextIntoLines:function(o){for(var a=n.Text.prototype._splitTextIntoLines.call(this,o),t=this._wrapText(a.lines,this.width),i=new Array(t.length),r=0;r<t.length;r++)i[r]=t[r].join("");return a.lines=i,a.graphemeLines=t,a},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var o={};for(var a in this._styleMap)this._textLines[a]&&(o[this._styleMap[a].line]=1);for(var a in this.styles)o[a]||delete this.styles[a]},toObject:function(o){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(o))}}),n.Textbox.fromObject=function(o,a){var t=n.util.stylesFromArray(o.styles,o.text),i=Object.assign({},o,{styles:t});return n.Object._fromObject("Textbox",i,a,"text")}}(v),function(){var f=d.controlsUtils,n=f.scaleSkewCursorStyleHandler,o=f.scaleCursorStyleHandler,a=f.scalingEqually,t=f.scalingYOrSkewingX,i=f.scalingXOrSkewingY,r=f.scaleOrSkewActionName,e=d.Object.prototype.controls;if(e.ml=new d.Control({x:-.5,y:0,cursorStyleHandler:n,actionHandler:i,getActionName:r}),e.mr=new d.Control({x:.5,y:0,cursorStyleHandler:n,actionHandler:i,getActionName:r}),e.mb=new d.Control({x:0,y:.5,cursorStyleHandler:n,actionHandler:t,getActionName:r}),e.mt=new d.Control({x:0,y:-.5,cursorStyleHandler:n,actionHandler:t,getActionName:r}),e.tl=new d.Control({x:-.5,y:-.5,cursorStyleHandler:o,actionHandler:a}),e.tr=new d.Control({x:.5,y:-.5,cursorStyleHandler:o,actionHandler:a}),e.bl=new d.Control({x:-.5,y:.5,cursorStyleHandler:o,actionHandler:a}),e.br=new d.Control({x:.5,y:.5,cursorStyleHandler:o,actionHandler:a}),e.mtr=new d.Control({x:0,y:-.5,actionHandler:f.rotationWithSnapping,cursorStyleHandler:f.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),d.Textbox){var l=d.Textbox.prototype.controls={};l.mtr=e.mtr,l.tr=e.tr,l.br=e.br,l.tl=e.tl,l.bl=e.bl,l.mt=e.mt,l.mb=e.mb,l.mr=new d.Control({x:.5,y:0,actionHandler:f.changeWidth,cursorStyleHandler:n,actionName:"resizing"}),l.ml=new d.Control({x:-.5,y:0,actionHandler:f.changeWidth,cursorStyleHandler:n,actionName:"resizing"})}}()})(Me);const E1="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E",k1="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='iso-8859-1'%3F%3E%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 55.699 55.699' width='100px' height='100px' xml:space='preserve'%3E%3Cpath style='fill:%23010002;' d='M51.51,18.001c-0.006-0.085-0.022-0.167-0.05-0.248c-0.012-0.034-0.02-0.067-0.035-0.1 c-0.049-0.106-0.109-0.206-0.194-0.291v-0.001l0,0c0,0-0.001-0.001-0.001-0.002L34.161,0.293c-0.086-0.087-0.188-0.148-0.295-0.197 c-0.027-0.013-0.057-0.02-0.086-0.03c-0.086-0.029-0.174-0.048-0.265-0.053C33.494,0.011,33.475,0,33.453,0H22.177 c-3.678,0-6.669,2.992-6.669,6.67v1.674h-4.663c-3.678,0-6.67,2.992-6.67,6.67V49.03c0,3.678,2.992,6.669,6.67,6.669h22.677 c3.677,0,6.669-2.991,6.669-6.669v-1.675h4.664c3.678,0,6.669-2.991,6.669-6.669V18.069C51.524,18.045,51.512,18.025,51.51,18.001z M34.454,3.414l13.655,13.655h-8.985c-2.575,0-4.67-2.095-4.67-4.67V3.414z M38.191,49.029c0,2.574-2.095,4.669-4.669,4.669H10.845 c-2.575,0-4.67-2.095-4.67-4.669V15.014c0-2.575,2.095-4.67,4.67-4.67h5.663h4.614v10.399c0,3.678,2.991,6.669,6.668,6.669h10.4 v18.942L38.191,49.029L38.191,49.029z M36.777,25.412h-8.986c-2.574,0-4.668-2.094-4.668-4.669v-8.985L36.777,25.412z M44.855,45.355h-4.664V26.412c0-0.023-0.012-0.044-0.014-0.067c-0.006-0.085-0.021-0.167-0.049-0.249 c-0.012-0.033-0.021-0.066-0.036-0.1c-0.048-0.105-0.109-0.205-0.194-0.29l0,0l0,0c0-0.001-0.001-0.002-0.001-0.002L22.829,8.637 c-0.087-0.086-0.188-0.147-0.295-0.196c-0.029-0.013-0.058-0.021-0.088-0.031c-0.086-0.03-0.172-0.048-0.263-0.053 c-0.021-0.002-0.04-0.013-0.062-0.013h-4.614V6.67c0-2.575,2.095-4.67,4.669-4.67h10.277v10.4c0,3.678,2.992,6.67,6.67,6.67h10.399 v21.616C49.524,43.26,47.429,45.355,44.855,45.355z'/%3E%3C/svg%3E%0A";class Dn{constructor(d,y){Fe(this,"fabric");Fe(this,"that");this.fabric=d,this.that=y,this.init()}init(){const d=document.createElement("img");d.src=E1;const y=document.createElement("img");y.src=k1,this.fabric.Object.prototype.controls.deleteControl=new this.fabric.Control({x:.5,y:-.5,offsetY:-16,offsetX:16,cursorStyle:"pointer",mouseUpHandler:()=>this.deleteObject(this.that),render:this.renderIcon(d,24),sizeX:24,sizeY:24}),this.fabric.Object.prototype.controls.clone=new this.fabric.Control({x:-.5,y:-.5,offsetY:-16,offsetX:-16,cursorStyle:"pointer",mouseUpHandler:()=>this.cloneObject(this.that),render:this.renderIcon(y,24),sizeX:24,sizeY:24})}deleteObject(d){const y=d.canvas.getActiveObjects();return d.canvas.discardActiveObject(),d.canvas.remove(...y),d.recordOperate(...y),d.canvas.requestRenderAll(),!0}cloneObject(d){return d.copy(),d.paste(),!0}renderIcon(d,y){return(m,x,g,b,f)=>{m.save(),m.translate(x,g),m.rotate(this.fabric.util.degreesToRadians(f.angle)),m.drawImage(d,-y/2,-y/2,y,y),m.restore()}}}var el={exports:{}};(function(v,d){if((typeof y>"u"||!y)&&typeof self<"u")var y=self;(function(m){v.exports=m()})(function(){return function(){function m(x,g,b){function f(a,t){if(!g[a]){if(!x[a]){var i=typeof Qr=="function"&&Qr;if(!t&&i)return i(a,!0);if(n)return n(a,!0);var r=new Error("Cannot find module '"+a+"'");throw r.code="MODULE_NOT_FOUND",r}var e=g[a]={exports:{}};x[a][0].call(e.exports,function(l){var s=x[a][1][l];return f(s||l)},e,e.exports,m,x,g,b)}return g[a].exports}for(var n=typeof Qr=="function"&&Qr,o=0;o<b.length;o++)f(b[o]);return f}return m}()({1:[function(m,x,g){function b(f){if(Array.isArray(f))return f}x.exports=b},{}],2:[function(m,x,g){function b(f){if(Array.isArray(f)){for(var n=0,o=new Array(f.length);n<f.length;n++)o[n]=f[n];return o}}x.exports=b},{}],3:[function(m,x,g){function b(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}x.exports=b},{}],4:[function(m,x,g){function b(f,n){if(!(f instanceof n))throw new TypeError("Cannot call a class as a function")}x.exports=b},{}],5:[function(m,x,g){var b=m("./setPrototypeOf");function f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(o){return!1}}function n(o,a,t){return f()?x.exports=n=Reflect.construct:x.exports=n=function(r,e,l){var s=[null];s.push.apply(s,e);var c=Function.bind.apply(r,s),u=new c;return l&&b(u,l.prototype),u},n.apply(null,arguments)}x.exports=n},{"./setPrototypeOf":18}],6:[function(m,x,g){function b(n,o){for(var a=0;a<o.length;a++){var t=o[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function f(n,o,a){return o&&b(n.prototype,o),a&&b(n,a),n}x.exports=f},{}],7:[function(m,x,g){function b(f,n,o){return n in f?Object.defineProperty(f,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):f[n]=o,f}x.exports=b},{}],8:[function(m,x,g){function b(){return x.exports=b=Object.assign||function(f){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(f[a]=o[a])}return f},b.apply(this,arguments)}x.exports=b},{}],9:[function(m,x,g){function b(f){return x.exports=b=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},b(f)}x.exports=b},{}],10:[function(m,x,g){var b=m("./setPrototypeOf");function f(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),o&&b(n,o)}x.exports=f},{"./setPrototypeOf":18}],11:[function(m,x,g){function b(f){return f&&f.__esModule?f:{default:f}}x.exports=b},{}],12:[function(m,x,g){var b=m("../helpers/typeof");function f(){if(typeof WeakMap!="function")return null;var o=new WeakMap;return f=function(){return o},o}function n(o){if(o&&o.__esModule)return o;if(o===null||b(o)!=="object"&&typeof o!="function")return{default:o};var a=f();if(a&&a.has(o))return a.get(o);var t={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in o)if(Object.prototype.hasOwnProperty.call(o,r)){var e=i?Object.getOwnPropertyDescriptor(o,r):null;e&&(e.get||e.set)?Object.defineProperty(t,r,e):t[r]=o[r]}return t.default=o,a&&a.set(o,t),t}x.exports=n},{"../helpers/typeof":21}],13:[function(m,x,g){function b(f){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]")return Array.from(f)}x.exports=b},{}],14:[function(m,x,g){function b(f,n){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]"){var o=[],a=!0,t=!1,i=void 0;try{for(var r=f[Symbol.iterator](),e;!(a=(e=r.next()).done)&&(o.push(e.value),!(n&&o.length===n));a=!0);}catch(l){t=!0,i=l}finally{try{!a&&r.return!=null&&r.return()}finally{if(t)throw i}}return o}}x.exports=b},{}],15:[function(m,x,g){function b(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}x.exports=b},{}],16:[function(m,x,g){function b(){throw new TypeError("Invalid attempt to spread non-iterable instance")}x.exports=b},{}],17:[function(m,x,g){var b=m("../helpers/typeof"),f=m("./assertThisInitialized");function n(o,a){return a&&(b(a)==="object"||typeof a=="function")?a:f(o)}x.exports=n},{"../helpers/typeof":21,"./assertThisInitialized":3}],18:[function(m,x,g){function b(f,n){return x.exports=b=Object.setPrototypeOf||function(a,t){return a.__proto__=t,a},b(f,n)}x.exports=b},{}],19:[function(m,x,g){var b=m("./arrayWithHoles"),f=m("./iterableToArrayLimit"),n=m("./nonIterableRest");function o(a,t){return b(a)||f(a,t)||n()}x.exports=o},{"./arrayWithHoles":1,"./iterableToArrayLimit":14,"./nonIterableRest":15}],20:[function(m,x,g){var b=m("./arrayWithoutHoles"),f=m("./iterableToArray"),n=m("./nonIterableSpread");function o(a){return b(a)||f(a)||n()}x.exports=o},{"./arrayWithoutHoles":2,"./iterableToArray":13,"./nonIterableSpread":16}],21:[function(m,x,g){function b(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?b=function(a){return typeof a}:b=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b(n)}function f(n){return typeof Symbol=="function"&&b(Symbol.iterator)==="symbol"?x.exports=f=function(a){return b(a)}:x.exports=f=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":b(a)},f(n)}x.exports=f},{}],22:[function(m,x,g){x.exports=m("regenerator-runtime")},{"regenerator-runtime":153}],23:[function(m,x,g){var b=m("./src/converter");function f(n,o){var a=new b(n,o);return function(t){return a.convert(t)}}f.BIN="01",f.OCT="01234567",f.DEC="0123456789",f.HEX="0123456789abcdef",x.exports=f},{"./src/converter":24}],24:[function(m,x,g){function b(f,n){if(!f||!n||!f.length||!n.length)throw new Error("Bad alphabet");this.srcAlphabet=f,this.dstAlphabet=n}b.prototype.convert=function(f){var n,o,a,t={},i=this.srcAlphabet.length,r=this.dstAlphabet.length,e=f.length,l=typeof f=="string"?"":[];if(!this.isValid(f))throw new Error('Number "'+f+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return f;for(n=0;n<e;n++)t[n]=this.srcAlphabet.indexOf(f[n]);do{for(o=0,a=0,n=0;n<e;n++)o=o*i+t[n],o>=r?(t[a++]=parseInt(o/r,10),o=o%r):a>0&&(t[a++]=0);e=a,l=this.dstAlphabet.slice(o,o+1).concat(l)}while(a!==0);return l},b.prototype.isValid=function(f){for(var n=0;n<f.length;++n)if(this.srcAlphabet.indexOf(f[n])===-1)return!1;return!0},x.exports=b},{}],25:[function(m,x,g){(function(b){var f=m("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function n(N,R){if(N===R)return 0;for(var A=N.length,H=R.length,Z=0,K=Math.min(A,H);Z<K;++Z)if(N[Z]!==R[Z]){A=N[Z],H=R[Z];break}return A<H?-1:H<A?1:0}function o(N){return b.Buffer&&typeof b.Buffer.isBuffer=="function"?b.Buffer.isBuffer(N):!!(N!=null&&N._isBuffer)}var a=m("util/"),t=Object.prototype.hasOwnProperty,i=Array.prototype.slice,r=function(){return(function(){}).name==="foo"}();function e(N){return Object.prototype.toString.call(N)}function l(N){return o(N)||typeof b.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(N):N?!!(N instanceof DataView||N.buffer&&N.buffer instanceof ArrayBuffer):!1}var s=x.exports=S,c=/\s*function\s+([^\(\s]*)\s*/;function u(N){if(a.isFunction(N)){if(r)return N.name;var R=N.toString(),A=R.match(c);return A&&A[1]}}s.AssertionError=function(R){this.name="AssertionError",this.actual=R.actual,this.expected=R.expected,this.operator=R.operator,R.message?(this.message=R.message,this.generatedMessage=!1):(this.message=_(this),this.generatedMessage=!0);var A=R.stackStartFunction||w;if(Error.captureStackTrace)Error.captureStackTrace(this,A);else{var H=new Error;if(H.stack){var Z=H.stack,K=u(A),J=Z.indexOf("\n"+K);if(J>=0){var D=Z.indexOf("\n",J+1);Z=Z.substring(D+1)}this.stack=Z}}},a.inherits(s.AssertionError,Error);function h(N,R){return typeof N=="string"?N.length<R?N:N.slice(0,R):N}function p(N){if(r||!a.isFunction(N))return a.inspect(N);var R=u(N),A=R?": "+R:"";return"[Function"+A+"]"}function _(N){return h(p(N.actual),128)+" "+N.operator+" "+h(p(N.expected),128)}function w(N,R,A,H,Z){throw new s.AssertionError({message:A,actual:N,expected:R,operator:H,stackStartFunction:Z})}s.fail=w;function S(N,R){N||w(N,!0,R,"==",s.ok)}s.ok=S,s.equal=function(R,A,H){R!=A&&w(R,A,H,"==",s.equal)},s.notEqual=function(R,A,H){R==A&&w(R,A,H,"!=",s.notEqual)},s.deepEqual=function(R,A,H){C(R,A,!1)||w(R,A,H,"deepEqual",s.deepEqual)},s.deepStrictEqual=function(R,A,H){C(R,A,!0)||w(R,A,H,"deepStrictEqual",s.deepStrictEqual)};function C(N,R,A,H){if(N===R)return!0;if(o(N)&&o(R))return n(N,R)===0;if(a.isDate(N)&&a.isDate(R))return N.getTime()===R.getTime();if(a.isRegExp(N)&&a.isRegExp(R))return N.source===R.source&&N.global===R.global&&N.multiline===R.multiline&&N.lastIndex===R.lastIndex&&N.ignoreCase===R.ignoreCase;if((N===null||typeof N!="object")&&(R===null||typeof R!="object"))return A?N===R:N==R;if(l(N)&&l(R)&&e(N)===e(R)&&!(N instanceof Float32Array||N instanceof Float64Array))return n(new Uint8Array(N.buffer),new Uint8Array(R.buffer))===0;if(o(N)!==o(R))return!1;H=H||{actual:[],expected:[]};var Z=H.actual.indexOf(N);return Z!==-1&&Z===H.expected.indexOf(R)?!0:(H.actual.push(N),H.expected.push(R),k(N,R,A,H))}function E(N){return Object.prototype.toString.call(N)=="[object Arguments]"}function k(N,R,A,H){if(N==null||R===null||R===void 0)return!1;if(a.isPrimitive(N)||a.isPrimitive(R))return N===R;if(A&&Object.getPrototypeOf(N)!==Object.getPrototypeOf(R))return!1;var Z=E(N),K=E(R);if(Z&&!K||!Z&&K)return!1;if(Z)return N=i.call(N),R=i.call(R),C(N,R,A);var J=G(N),D=G(R),I,W;if(J.length!==D.length)return!1;for(J.sort(),D.sort(),W=J.length-1;W>=0;W--)if(J[W]!==D[W])return!1;for(W=J.length-1;W>=0;W--)if(I=J[W],!C(N[I],R[I],A,H))return!1;return!0}s.notDeepEqual=function(R,A,H){C(R,A,!1)&&w(R,A,H,"notDeepEqual",s.notDeepEqual)},s.notDeepStrictEqual=O;function O(N,R,A){C(N,R,!0)&&w(N,R,A,"notDeepStrictEqual",O)}s.strictEqual=function(R,A,H){R!==A&&w(R,A,H,"===",s.strictEqual)},s.notStrictEqual=function(R,A,H){R===A&&w(R,A,H,"!==",s.notStrictEqual)};function U(N,R){if(!N||!R)return!1;if(Object.prototype.toString.call(R)=="[object RegExp]")return R.test(N);try{if(N instanceof R)return!0}catch(A){}return Error.isPrototypeOf(R)?!1:R.call({},N)===!0}function F(N){var R;try{N()}catch(A){R=A}return R}function M(N,R,A,H){var Z;if(typeof R!="function")throw new TypeError('"block" argument must be a function');typeof A=="string"&&(H=A,A=null),Z=F(R),H=(A&&A.name?" ("+A.name+").":".")+(H?" "+H:"."),N&&!Z&&w(Z,A,"Missing expected exception"+H);var K=typeof H=="string",J=!N&&a.isError(Z),D=!N&&Z&&!A;if((J&&K&&U(Z,A)||D)&&w(Z,A,"Got unwanted exception"+H),N&&Z&&A&&!U(Z,A)||!N&&Z)throw Z}s.throws=function(N,R,A){M(!0,N,R,A)},s.doesNotThrow=function(N,R,A){M(!1,N,R,A)},s.ifError=function(N){if(N)throw N};function j(N,R){N||w(N,!0,R,"==",j)}s.strict=f(j,s,{equal:s.strictEqual,deepEqual:s.deepStrictEqual,notEqual:s.notStrictEqual,notDeepEqual:s.notDeepStrictEqual}),s.strict.strict=s.strict;var G=Object.keys||function(N){var R=[];for(var A in N)t.call(N,A)&&R.push(A);return R}}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{"object-assign":84,"util/":28}],26:[function(m,x,g){typeof Object.create=="function"?x.exports=function(f,n){f.super_=n,f.prototype=Object.create(n.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:x.exports=function(f,n){f.super_=n;var o=function(){};o.prototype=n.prototype,f.prototype=new o,f.prototype.constructor=f}},{}],27:[function(m,x,g){x.exports=function(f){return f&&typeof f=="object"&&typeof f.copy=="function"&&typeof f.fill=="function"&&typeof f.readUInt8=="function"}},{}],28:[function(m,x,g){(function(b,f){var n=/%[sdj%]/g;g.format=function(D){if(!k(D)){for(var I=[],W=0;W<arguments.length;W++)I.push(t(arguments[W]));return I.join(" ")}for(var W=1,q=arguments,ne=q.length,le=String(D).replace(n,function(fe){if(fe==="%%")return"%";if(W>=ne)return fe;switch(fe){case"%s":return String(q[W++]);case"%d":return Number(q[W++]);case"%j":try{return JSON.stringify(q[W++])}catch(he){return"[Circular]"}default:return fe}}),ce=q[W];W<ne;ce=q[++W])S(ce)||!M(ce)?le+=" "+ce:le+=" "+t(ce);return le},g.deprecate=function(D,I){if(U(f.process))return function(){return g.deprecate(D,I).apply(this,arguments)};if(b.noDeprecation===!0)return D;var W=!1;function q(){if(!W){if(b.throwDeprecation)throw new Error(I);b.traceDeprecation?console.trace(I):console.error(I),W=!0}return D.apply(this,arguments)}return q};var o={},a;g.debuglog=function(D){if(U(a)&&(a={TERM_PROGRAM:"vscode",NODE:"/usr/local/bin/node",INIT_CWD:"/Users/mac/workplace/h5/laser-cut-new/packages/laser-mobile",TERM:"xterm-256color",SHELL:"/bin/zsh",npm_config_metrics_registry:"https://registry.npm.taobao.org/",TMPDIR:"/var/folders/8h/6kht9rs15kd0_jl_jwkk7kfr0000gn/T/",npm_config_global_prefix:"/usr/local",TERM_PROGRAM_VERSION:"1.81.1",ZDOTDIR:"/Users/mac",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_registry:"https://registry.npm.taobao.org/",npm_config_local_prefix:"/Users/mac/workplace/h5/laser-cut-new",FLUTTER_GIT_URL:"https://gitee.com/mirrors/Flutter.git",USER:"mac",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/usr/local/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.2h59lhNQEm/Listeners",PUB_HOSTED_URL:"https://pub.flutter-io.cn",__CF_USER_TEXT_ENCODING:"0x1F5:0x19:0x34",npm_execpath:"/usr/local/lib/node_modules/npm/bin/npm-cli.js",PATH:"/Users/mac/workplace/h5/laser-cut-new/packages/laser-mobile/node_modules/.bin:/Users/mac/workplace/h5/laser-cut-new/packages/node_modules/.bin:/Users/mac/workplace/h5/laser-cut-new/node_modules/.bin:/Users/mac/workplace/h5/node_modules/.bin:/Users/mac/workplace/node_modules/.bin:/Users/mac/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/usr/local/opt/ruby/bin:/usr/local/opt/ruby/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/Apple/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin",npm_package_json:"/Users/mac/workplace/h5/laser-cut-new/packages/laser-mobile/package.json",_:"/usr/local/bin/vite",LaunchInstanceID:"2322B6CC-2171-4687-873A-5D3DD10A757F",npm_config_userconfig:"/Users/mac/.npmrc",npm_config_init_module:"/Users/mac/.npm-init.js",USER_ZDOTDIR:"/Users/mac",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/mac/workplace/h5/laser-cut-new/packages/laser-mobile",FLUTTER_STORAGE_BASE_URL:"https://storage.flutter-io.cn",VSCODE_NONCE:"7f738938-e670-42d6-9894-a8cf9ca0ea8a",npm_lifecycle_event:"build",EDITOR:"vi",FVM_GIT_CACHE:"https://gitee.com/mirrors/Flutter.git",npm_package_name:"laser-mobile",LANG:"zh_CN.UTF-8",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",XPC_FLAGS:"0x0",npm_config_electron_mirror:"https://npm.taobao.org/mirrors/electron/",npm_config_node_gyp:"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.04",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",SHLVL:"2",HOME:"/Users/mac",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",npm_config_cache:"/Users/mac/.npm",LOGNAME:"mac",npm_lifecycle_script:"vite build --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/8h/6kht9rs15kd0_jl_jwkk7kfr0000gn/T/vscode-git-667ad5f9c2.sock",npm_config_user_agent:"npm/8.19.2 node/v16.18.1 darwin x64 workspaces/true",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/Frameworks/Code Helper (Plugin).app/Contents/MacOS/Code Helper (Plugin)",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",SECURITYSESSIONID:"186a3",npm_node_execpath:"/usr/local/bin/node",npm_config_prefix:"/usr/local",COLORTERM:"truecolor",NODE_ENV:"production"}.NODE_DEBUG||""),D=D.toUpperCase(),!o[D])if(new RegExp("\\b"+D+"\\b","i").test(a)){var I=b.pid;o[D]=function(){var W=g.format.apply(g,arguments);console.error("%s %d: %s",D,I,W)}}else o[D]=function(){};return o[D]};function t(D,I){var W={seen:[],stylize:r};return arguments.length>=3&&(W.depth=arguments[2]),arguments.length>=4&&(W.colors=arguments[3]),w(I)?W.showHidden=I:I&&g._extend(W,I),U(W.showHidden)&&(W.showHidden=!1),U(W.depth)&&(W.depth=2),U(W.colors)&&(W.colors=!1),U(W.customInspect)&&(W.customInspect=!0),W.colors&&(W.stylize=i),l(W,D,W.depth)}g.inspect=t,t.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},t.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function i(D,I){var W=t.styles[I];return W?"\x1B["+t.colors[W][0]+"m"+D+"\x1B["+t.colors[W][1]+"m":D}function r(D,I){return D}function e(D){var I={};return D.forEach(function(W,q){I[W]=!0}),I}function l(D,I,W){if(D.customInspect&&I&&N(I.inspect)&&I.inspect!==g.inspect&&!(I.constructor&&I.constructor.prototype===I)){var q=I.inspect(W,D);return k(q)||(q=l(D,q,W)),q}var ne=s(D,I);if(ne)return ne;var le=Object.keys(I),ce=e(le);if(D.showHidden&&(le=Object.getOwnPropertyNames(I)),G(I)&&(le.indexOf("message")>=0||le.indexOf("description")>=0))return c(I);if(le.length===0){if(N(I)){var fe=I.name?": "+I.name:"";return D.stylize("[Function"+fe+"]","special")}if(F(I))return D.stylize(RegExp.prototype.toString.call(I),"regexp");if(j(I))return D.stylize(Date.prototype.toString.call(I),"date");if(G(I))return c(I)}var he="",se=!1,ie=["{","}"];if(_(I)&&(se=!0,ie=["[","]"]),N(I)){var Q=I.name?": "+I.name:"";he=" [Function"+Q+"]"}if(F(I)&&(he=" "+RegExp.prototype.toString.call(I)),j(I)&&(he=" "+Date.prototype.toUTCString.call(I)),G(I)&&(he=" "+c(I)),le.length===0&&(!se||I.length==0))return ie[0]+he+ie[1];if(W<0)return F(I)?D.stylize(RegExp.prototype.toString.call(I),"regexp"):D.stylize("[Object]","special");D.seen.push(I);var re;return se?re=u(D,I,W,ce,le):re=le.map(function(te){return h(D,I,W,ce,te,se)}),D.seen.pop(),p(re,he,ie)}function s(D,I){if(U(I))return D.stylize("undefined","undefined");if(k(I)){var W="'"+JSON.stringify(I).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return D.stylize(W,"string")}if(E(I))return D.stylize(""+I,"number");if(w(I))return D.stylize(""+I,"boolean");if(S(I))return D.stylize("null","null")}function c(D){return"["+Error.prototype.toString.call(D)+"]"}function u(D,I,W,q,ne){for(var le=[],ce=0,fe=I.length;ce<fe;++ce)J(I,String(ce))?le.push(h(D,I,W,q,String(ce),!0)):le.push("");return ne.forEach(function(he){he.match(/^\d+$/)||le.push(h(D,I,W,q,he,!0))}),le}function h(D,I,W,q,ne,le){var ce,fe,he;if(he=Object.getOwnPropertyDescriptor(I,ne)||{value:I[ne]},he.get?he.set?fe=D.stylize("[Getter/Setter]","special"):fe=D.stylize("[Getter]","special"):he.set&&(fe=D.stylize("[Setter]","special")),J(q,ne)||(ce="["+ne+"]"),fe||(D.seen.indexOf(he.value)<0?(S(W)?fe=l(D,he.value,null):fe=l(D,he.value,W-1),fe.indexOf("\n")>-1&&(le?fe=fe.split("\n").map(function(se){return"  "+se}).join("\n").substr(2):fe="\n"+fe.split("\n").map(function(se){return"   "+se}).join("\n"))):fe=D.stylize("[Circular]","special")),U(ce)){if(le&&ne.match(/^\d+$/))return fe;ce=JSON.stringify(""+ne),ce.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ce=ce.substr(1,ce.length-2),ce=D.stylize(ce,"name")):(ce=ce.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ce=D.stylize(ce,"string"))}return ce+": "+fe}function p(D,I,W){var q=D.reduce(function(ne,le){return le.indexOf("\n")>=0,ne+le.replace(/\u001b\[\d\d?m/g,"").length+1},0);return q>60?W[0]+(I===""?"":I+"\n ")+" "+D.join(",\n  ")+" "+W[1]:W[0]+I+" "+D.join(", ")+" "+W[1]}function _(D){return Array.isArray(D)}g.isArray=_;function w(D){return typeof D=="boolean"}g.isBoolean=w;function S(D){return D===null}g.isNull=S;function C(D){return D==null}g.isNullOrUndefined=C;function E(D){return typeof D=="number"}g.isNumber=E;function k(D){return typeof D=="string"}g.isString=k;function O(D){return typeof D=="symbol"}g.isSymbol=O;function U(D){return D===void 0}g.isUndefined=U;function F(D){return M(D)&&A(D)==="[object RegExp]"}g.isRegExp=F;function M(D){return typeof D=="object"&&D!==null}g.isObject=M;function j(D){return M(D)&&A(D)==="[object Date]"}g.isDate=j;function G(D){return M(D)&&(A(D)==="[object Error]"||D instanceof Error)}g.isError=G;function N(D){return typeof D=="function"}g.isFunction=N;function R(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"||typeof D=="symbol"||typeof D>"u"}g.isPrimitive=R,g.isBuffer=m("./support/isBuffer");function A(D){return Object.prototype.toString.call(D)}function H(D){return D<10?"0"+D.toString(10):D.toString(10)}var Z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function K(){var D=new Date,I=[H(D.getHours()),H(D.getMinutes()),H(D.getSeconds())].join(":");return[D.getDate(),Z[D.getMonth()],I].join(" ")}g.log=function(){console.log("%s - %s",K(),g.format.apply(g,arguments))},g.inherits=m("inherits"),g._extend=function(D,I){if(!I||!M(I))return D;for(var W=Object.keys(I),q=W.length;q--;)D[W[q]]=I[W[q]];return D};function J(D,I){return Object.prototype.hasOwnProperty.call(D,I)}}).call(this,m("_process"),typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{"./support/isBuffer":27,_process:133,inherits:26}],29:[function(m,x,g){g.byteLength=r,g.toByteArray=l,g.fromByteArray=u;for(var b=[],f=[],n=typeof Uint8Array<"u"?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,t=o.length;a<t;++a)b[a]=o[a],f[o.charCodeAt(a)]=a;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63;function i(h){var p=h.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _=h.indexOf("=");_===-1&&(_=p);var w=_===p?0:4-_%4;return[_,w]}function r(h){var p=i(h),_=p[0],w=p[1];return(_+w)*3/4-w}function e(h,p,_){return(p+_)*3/4-_}function l(h){var p,_=i(h),w=_[0],S=_[1],C=new n(e(h,w,S)),E=0,k=S>0?w-4:w,O;for(O=0;O<k;O+=4)p=f[h.charCodeAt(O)]<<18|f[h.charCodeAt(O+1)]<<12|f[h.charCodeAt(O+2)]<<6|f[h.charCodeAt(O+3)],C[E++]=p>>16&255,C[E++]=p>>8&255,C[E++]=p&255;return S===2&&(p=f[h.charCodeAt(O)]<<2|f[h.charCodeAt(O+1)]>>4,C[E++]=p&255),S===1&&(p=f[h.charCodeAt(O)]<<10|f[h.charCodeAt(O+1)]<<4|f[h.charCodeAt(O+2)]>>2,C[E++]=p>>8&255,C[E++]=p&255),C}function s(h){return b[h>>18&63]+b[h>>12&63]+b[h>>6&63]+b[h&63]}function c(h,p,_){for(var w,S=[],C=p;C<_;C+=3)w=(h[C]<<16&16711680)+(h[C+1]<<8&65280)+(h[C+2]&255),S.push(s(w));return S.join("")}function u(h){for(var p,_=h.length,w=_%3,S=[],C=16383,E=0,k=_-w;E<k;E+=C)S.push(c(h,E,E+C>k?k:E+C));return w===1?(p=h[_-1],S.push(b[p>>2]+b[p<<4&63]+"==")):w===2&&(p=(h[_-2]<<8)+h[_-1],S.push(b[p>>10]+b[p>>4&63]+b[p<<2&63]+"=")),S.join("")}},{}],30:[function(m,x,g){var b=m("./lib/encoder"),f=m("./lib/decoder");x.exports={encode:b,decode:f}},{"./lib/decoder":31,"./lib/encoder":32}],31:[function(m,x,g){(function(b){function f(n,o){if(this.pos=0,this.buffer=n,this.is_with_alpha=!!o,this.bottom_up=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),this.flag!="BM")throw new Error("Invalid BMP File");this.parseHeader(),this.parseRGBA()}f.prototype.parseHeader=function(){if(this.fileSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.reserved=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.offset=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.headerSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.width=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.height=this.buffer.readInt32LE(this.pos),this.pos+=4,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compress=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.rawSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.hr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.vr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.colors=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.importantColors=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var o=0;o<n;o++){var a=this.buffer.readUInt8(this.pos++),t=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++);this.palette[o]={red:i,green:t,blue:a,quad:r}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},f.prototype.parseRGBA=function(){var n="bit"+this.bitPP,o=this.width*this.height*4;this.data=new b(o),this[n]()},f.prototype.bit1=function(){for(var n=Math.ceil(this.width/8),o=n%4,a=this.height>=0?this.height-1:-this.height,a=this.height-1;a>=0;a--){for(var t=this.bottom_up?a:this.height-1-a,i=0;i<n;i++)for(var r=this.buffer.readUInt8(this.pos++),e=t*this.width*4+i*8*4,l=0;l<8&&i*8+l<this.width;l++){var s=this.palette[r>>7-l&1];this.data[e+l*4]=0,this.data[e+l*4+1]=s.blue,this.data[e+l*4+2]=s.green,this.data[e+l*4+3]=s.red}o!=0&&(this.pos+=4-o)}},f.prototype.bit4=function(){if(this.compress==2){let S=function(C){var E=this.palette[C];this.data[n]=0,this.data[n+1]=E.blue,this.data[n+2]=E.green,this.data[n+3]=E.red,n+=4};this.data.fill(255);for(var n=0,o=this.bottom_up?this.height-1:0,a=!1;n<this.data.length;){var t=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++);if(t==0)if(i==0){this.bottom_up?o--:o++,n=o*this.width*4,a=!1;continue}else{if(i==1)break;if(i==2){var r=this.buffer.readUInt8(this.pos++),e=this.buffer.readUInt8(this.pos++);this.bottom_up?o-=e:o+=e,n+=e*this.width*4+r*4}else{for(var l=this.buffer.readUInt8(this.pos++),s=0;s<i;s++)a?S.call(this,l&15):S.call(this,(l&240)>>4),s&1&&s+1<i&&(l=this.buffer.readUInt8(this.pos++)),a=!a;(i+1>>1&1)==1&&this.pos++}}else for(var s=0;s<t;s++)a?S.call(this,i&15):S.call(this,(i&240)>>4),a=!a}}else for(var c=Math.ceil(this.width/2),u=c%4,e=this.height-1;e>=0;e--){for(var h=this.bottom_up?e:this.height-1-e,r=0;r<c;r++){var i=this.buffer.readUInt8(this.pos++),n=h*this.width*4+r*2*4,p=i>>4,_=i&15,w=this.palette[p];if(this.data[n]=0,this.data[n+1]=w.blue,this.data[n+2]=w.green,this.data[n+3]=w.red,r*2+1>=this.width)break;w=this.palette[_],this.data[n+4]=0,this.data[n+4+1]=w.blue,this.data[n+4+2]=w.green,this.data[n+4+3]=w.red}u!=0&&(this.pos+=4-u)}},f.prototype.bit8=function(){if(this.compress==1){let h=function(p){var _=this.palette[p];this.data[n]=0,this.data[n+1]=_.blue,this.data[n+2]=_.green,this.data[n+3]=_.red,n+=4};this.data.fill(255);for(var n=0,o=this.bottom_up?this.height-1:0;n<this.data.length;){var a=this.buffer.readUInt8(this.pos++),t=this.buffer.readUInt8(this.pos++);if(a==0)if(t==0){this.bottom_up?o--:o++,n=o*this.width*4;continue}else{if(t==1)break;if(t==2){var i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++);this.bottom_up?o-=r:o+=r,n+=r*this.width*4+i*4}else{for(var e=0;e<t;e++){var l=this.buffer.readUInt8(this.pos++);h.call(this,l)}t&!0&&this.pos++}}else for(var e=0;e<a;e++)h.call(this,t)}}else for(var s=this.width%4,r=this.height-1;r>=0;r--){for(var c=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var t=this.buffer.readUInt8(this.pos++),n=c*this.width*4+i*4;if(t<this.palette.length){var u=this.palette[t];this.data[n]=0,this.data[n+1]=u.blue,this.data[n+2]=u.green,this.data[n+3]=u.red}else this.data[n]=0,this.data[n+1]=255,this.data[n+2]=255,this.data[n+3]=255}s!=0&&(this.pos+=4-s)}},f.prototype.bit15=function(){for(var n=this.width%3,o=parseInt("11111",2),a=o,t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var e=this.buffer.readUInt16LE(this.pos);this.pos+=2;var l=(e&a)/a*255|0,s=(e>>5&a)/a*255|0,c=(e>>10&a)/a*255|0,u=e>>15?255:0,h=i*this.width*4+r*4;this.data[h]=u,this.data[h+1]=l,this.data[h+2]=s,this.data[h+3]=c}this.pos+=n}},f.prototype.bit16=function(){var n=this.width%2*2;this.maskRed=31744,this.maskGreen=992,this.maskBlue=31,this.mask0=0,this.compress==3&&(this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4);for(var o=[0,0,0],a=0;a<16;a++)this.maskRed>>a&1&&o[0]++,this.maskGreen>>a&1&&o[1]++,this.maskBlue>>a&1&&o[2]++;o[1]+=o[0],o[2]+=o[1],o[0]=8-o[0],o[1]-=8,o[2]-=8;for(var t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var e=this.buffer.readUInt16LE(this.pos);this.pos+=2;var l=(e&this.maskBlue)<<o[0],s=(e&this.maskGreen)>>o[1],c=(e&this.maskRed)>>o[2],u=i*this.width*4+r*4;this.data[u]=0,this.data[u+1]=l,this.data[u+2]=s,this.data[u+3]=c}this.pos+=n}},f.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var o=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var t=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),e=o*this.width*4+a*4;this.data[e]=0,this.data[e+1]=t,this.data[e+2]=i,this.data[e+3]=r}this.pos+=this.width%4}},f.prototype.bit32=function(){if(this.compress==3){this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4;for(var n=this.height-1;n>=0;n--)for(var o=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var t=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),e=this.buffer.readUInt8(this.pos++),l=o*this.width*4+a*4;this.data[l]=t,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=e}}else for(var n=this.height-1;n>=0;n--)for(var o=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),e=this.buffer.readUInt8(this.pos++),t=this.buffer.readUInt8(this.pos++),l=o*this.width*4+a*4;this.data[l]=t,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=e}},f.prototype.getData=function(){return this.data},x.exports=function(n){var o=new f(n);return o}}).call(this,m("buffer").Buffer)},{buffer:48}],32:[function(m,x,g){(function(b){function f(n){this.buffer=n.data,this.width=n.width,this.height=n.height,this.extraBytes=this.width%4,this.rgbSize=this.height*(3*this.width+this.extraBytes),this.headerInfoSize=40,this.data=[],this.flag="BM",this.reserved=0,this.offset=54,this.fileSize=this.rgbSize+this.offset,this.planes=1,this.bitPP=24,this.compress=0,this.hr=0,this.vr=0,this.colors=0,this.importantColors=0}f.prototype.encode=function(){var n=new b(this.offset+this.rgbSize);this.pos=0,n.write(this.flag,this.pos,2),this.pos+=2,n.writeUInt32LE(this.fileSize,this.pos),this.pos+=4,n.writeUInt32LE(this.reserved,this.pos),this.pos+=4,n.writeUInt32LE(this.offset,this.pos),this.pos+=4,n.writeUInt32LE(this.headerInfoSize,this.pos),this.pos+=4,n.writeUInt32LE(this.width,this.pos),this.pos+=4,n.writeInt32LE(-this.height,this.pos),this.pos+=4,n.writeUInt16LE(this.planes,this.pos),this.pos+=2,n.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,n.writeUInt32LE(this.compress,this.pos),this.pos+=4,n.writeUInt32LE(this.rgbSize,this.pos),this.pos+=4,n.writeUInt32LE(this.hr,this.pos),this.pos+=4,n.writeUInt32LE(this.vr,this.pos),this.pos+=4,n.writeUInt32LE(this.colors,this.pos),this.pos+=4,n.writeUInt32LE(this.importantColors,this.pos),this.pos+=4;for(var o=0,a=3*this.width+this.extraBytes,t=0;t<this.height;t++){for(var i=0;i<this.width;i++){var r=this.pos+t*a+i*3;o++,n[r]=this.buffer[o++],n[r+1]=this.buffer[o++],n[r+2]=this.buffer[o++]}if(this.extraBytes>0){var e=this.pos+t*a+this.width*3;n.fill(0,e,e+this.extraBytes)}}return n},x.exports=function(n,o){var a=new f(n),t=a.encode();return{data:t,width:n.width,height:n.height}}}).call(this,m("buffer").Buffer)},{buffer:48}],33:[function(m,x,g){},{}],34:[function(m,x,g){(function(b,f){var n=m("assert"),o=m("pako/lib/zlib/zstream"),a=m("pako/lib/zlib/deflate.js"),t=m("pako/lib/zlib/inflate.js"),i=m("pako/lib/zlib/constants");for(var r in i)g[r]=i[r];g.NONE=0,g.DEFLATE=1,g.INFLATE=2,g.GZIP=3,g.GUNZIP=4,g.DEFLATERAW=5,g.INFLATERAW=6,g.UNZIP=7;var e=31,l=139;function s(c){if(typeof c!="number"||c<g.DEFLATE||c>g.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=c,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}s.prototype.close=function(){if(this.write_in_progress){this.pending_close=!0;return}this.pending_close=!1,n(this.init_done,"close before init"),n(this.mode<=g.UNZIP),this.mode===g.DEFLATE||this.mode===g.GZIP||this.mode===g.DEFLATERAW?a.deflateEnd(this.strm):(this.mode===g.INFLATE||this.mode===g.GUNZIP||this.mode===g.INFLATERAW||this.mode===g.UNZIP)&&t.inflateEnd(this.strm),this.mode=g.NONE,this.dictionary=null},s.prototype.write=function(c,u,h,p,_,w,S){return this._write(!0,c,u,h,p,_,w,S)},s.prototype.writeSync=function(c,u,h,p,_,w,S){return this._write(!1,c,u,h,p,_,w,S)},s.prototype._write=function(c,u,h,p,_,w,S,C){if(n.equal(arguments.length,8),n(this.init_done,"write before init"),n(this.mode!==g.NONE,"already finalized"),n.equal(!1,this.write_in_progress,"write already in progress"),n.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,n.equal(!1,u===void 0,"must provide flush value"),this.write_in_progress=!0,u!==g.Z_NO_FLUSH&&u!==g.Z_PARTIAL_FLUSH&&u!==g.Z_SYNC_FLUSH&&u!==g.Z_FULL_FLUSH&&u!==g.Z_FINISH&&u!==g.Z_BLOCK)throw new Error("Invalid flush value");if(h==null&&(h=f.alloc(0),_=0,p=0),this.strm.avail_in=_,this.strm.input=h,this.strm.next_in=p,this.strm.avail_out=C,this.strm.output=w,this.strm.next_out=S,this.flush=u,!c)return this._process(),this._checkError()?this._afterSync():void 0;var E=this;return b.nextTick(function(){E._process(),E._after()}),this},s.prototype._afterSync=function(){var c=this.strm.avail_out,u=this.strm.avail_in;return this.write_in_progress=!1,[u,c]},s.prototype._process=function(){var c=null;switch(this.mode){case g.DEFLATE:case g.GZIP:case g.DEFLATERAW:this.err=a.deflate(this.strm,this.flush);break;case g.UNZIP:switch(this.strm.avail_in>0&&(c=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(c===null)break;if(this.strm.input[c]===e){if(this.gzip_id_bytes_read=1,c++,this.strm.avail_in===1)break}else{this.mode=g.INFLATE;break}case 1:if(c===null)break;this.strm.input[c]===l?(this.gzip_id_bytes_read=2,this.mode=g.GUNZIP):this.mode=g.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case g.INFLATE:case g.GUNZIP:case g.INFLATERAW:for(this.err=t.inflate(this.strm,this.flush),this.err===g.Z_NEED_DICT&&this.dictionary&&(this.err=t.inflateSetDictionary(this.strm,this.dictionary),this.err===g.Z_OK?this.err=t.inflate(this.strm,this.flush):this.err===g.Z_DATA_ERROR&&(this.err=g.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===g.GUNZIP&&this.err===g.Z_STREAM_END&&this.strm.next_in[0]!==0;)this.reset(),this.err=t.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},s.prototype._checkError=function(){switch(this.err){case g.Z_OK:case g.Z_BUF_ERROR:if(this.strm.avail_out!==0&&this.flush===g.Z_FINISH)return this._error("unexpected end of file"),!1;break;case g.Z_STREAM_END:break;case g.Z_NEED_DICT:return this.dictionary==null?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},s.prototype._after=function(){if(this._checkError()){var c=this.strm.avail_out,u=this.strm.avail_in;this.write_in_progress=!1,this.callback(u,c),this.pending_close&&this.close()}},s.prototype._error=function(c){this.strm.msg&&(c=this.strm.msg),this.onerror(c,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},s.prototype.init=function(c,u,h,p,_){n(arguments.length===4||arguments.length===5,"init(windowBits, level, memLevel, strategy, [dictionary])"),n(c>=8&&c<=15,"invalid windowBits"),n(u>=-1&&u<=9,"invalid compression level"),n(h>=1&&h<=9,"invalid memlevel"),n(p===g.Z_FILTERED||p===g.Z_HUFFMAN_ONLY||p===g.Z_RLE||p===g.Z_FIXED||p===g.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(u,c,h,p,_),this._setDictionary()},s.prototype.params=function(){throw new Error("deflateParams Not supported")},s.prototype.reset=function(){this._reset(),this._setDictionary()},s.prototype._init=function(c,u,h,p,_){switch(this.level=c,this.windowBits=u,this.memLevel=h,this.strategy=p,this.flush=g.Z_NO_FLUSH,this.err=g.Z_OK,(this.mode===g.GZIP||this.mode===g.GUNZIP)&&(this.windowBits+=16),this.mode===g.UNZIP&&(this.windowBits+=32),(this.mode===g.DEFLATERAW||this.mode===g.INFLATERAW)&&(this.windowBits=-1*this.windowBits),this.strm=new o,this.mode){case g.DEFLATE:case g.GZIP:case g.DEFLATERAW:this.err=a.deflateInit2(this.strm,this.level,g.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case g.INFLATE:case g.GUNZIP:case g.INFLATERAW:case g.UNZIP:this.err=t.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==g.Z_OK&&this._error("Init error"),this.dictionary=_,this.write_in_progress=!1,this.init_done=!0},s.prototype._setDictionary=function(){if(this.dictionary!=null){switch(this.err=g.Z_OK,this.mode){case g.DEFLATE:case g.DEFLATERAW:this.err=a.deflateSetDictionary(this.strm,this.dictionary);break}this.err!==g.Z_OK&&this._error("Failed to set dictionary")}},s.prototype._reset=function(){switch(this.err=g.Z_OK,this.mode){case g.DEFLATE:case g.DEFLATERAW:case g.GZIP:this.err=a.deflateReset(this.strm);break;case g.INFLATE:case g.INFLATERAW:case g.GUNZIP:this.err=t.inflateReset(this.strm);break}this.err!==g.Z_OK&&this._error("Failed to reset stream")},g.Zlib=s}).call(this,m("_process"),m("buffer").Buffer)},{_process:133,assert:25,buffer:48,"pako/lib/zlib/constants":38,"pako/lib/zlib/deflate.js":40,"pako/lib/zlib/inflate.js":42,"pako/lib/zlib/zstream":46}],35:[function(m,x,g){(function(b){var f=m("buffer").Buffer,n=m("stream").Transform,o=m("./binding"),a=m("util"),t=m("assert").ok,i=m("buffer").kMaxLength,r="Cannot create final Buffer. It would be larger than 0x"+i.toString(16)+" bytes";o.Z_MIN_WINDOWBITS=8,o.Z_MAX_WINDOWBITS=15,o.Z_DEFAULT_WINDOWBITS=15,o.Z_MIN_CHUNK=64,o.Z_MAX_CHUNK=1/0,o.Z_DEFAULT_CHUNK=16*1024,o.Z_MIN_MEMLEVEL=1,o.Z_MAX_MEMLEVEL=9,o.Z_DEFAULT_MEMLEVEL=8,o.Z_MIN_LEVEL=-1,o.Z_MAX_LEVEL=9,o.Z_DEFAULT_LEVEL=o.Z_DEFAULT_COMPRESSION;for(var e=Object.keys(o),l=0;l<e.length;l++){var s=e[l];s.match(/^Z/)&&Object.defineProperty(g,s,{enumerable:!0,value:o[s],writable:!1})}for(var c={Z_OK:o.Z_OK,Z_STREAM_END:o.Z_STREAM_END,Z_NEED_DICT:o.Z_NEED_DICT,Z_ERRNO:o.Z_ERRNO,Z_STREAM_ERROR:o.Z_STREAM_ERROR,Z_DATA_ERROR:o.Z_DATA_ERROR,Z_MEM_ERROR:o.Z_MEM_ERROR,Z_BUF_ERROR:o.Z_BUF_ERROR,Z_VERSION_ERROR:o.Z_VERSION_ERROR},u=Object.keys(c),h=0;h<u.length;h++){var p=u[h];c[c[p]]=p}Object.defineProperty(g,"codes",{enumerable:!0,value:Object.freeze(c),writable:!1}),g.Deflate=S,g.Inflate=C,g.Gzip=E,g.Gunzip=k,g.DeflateRaw=O,g.InflateRaw=U,g.Unzip=F,g.createDeflate=function(R){return new S(R)},g.createInflate=function(R){return new C(R)},g.createDeflateRaw=function(R){return new O(R)},g.createInflateRaw=function(R){return new U(R)},g.createGzip=function(R){return new E(R)},g.createGunzip=function(R){return new k(R)},g.createUnzip=function(R){return new F(R)},g.deflate=function(R,A,H){return typeof A=="function"&&(H=A,A={}),_(new S(A),R,H)},g.deflateSync=function(R,A){return w(new S(A),R)},g.gzip=function(R,A,H){return typeof A=="function"&&(H=A,A={}),_(new E(A),R,H)},g.gzipSync=function(R,A){return w(new E(A),R)},g.deflateRaw=function(R,A,H){return typeof A=="function"&&(H=A,A={}),_(new O(A),R,H)},g.deflateRawSync=function(R,A){return w(new O(A),R)},g.unzip=function(R,A,H){return typeof A=="function"&&(H=A,A={}),_(new F(A),R,H)},g.unzipSync=function(R,A){return w(new F(A),R)},g.inflate=function(R,A,H){return typeof A=="function"&&(H=A,A={}),_(new C(A),R,H)},g.inflateSync=function(R,A){return w(new C(A),R)},g.gunzip=function(R,A,H){return typeof A=="function"&&(H=A,A={}),_(new k(A),R,H)},g.gunzipSync=function(R,A){return w(new k(A),R)},g.inflateRaw=function(R,A,H){return typeof A=="function"&&(H=A,A={}),_(new U(A),R,H)},g.inflateRawSync=function(R,A){return w(new U(A),R)};function _(R,A,H){var Z=[],K=0;R.on("error",D),R.on("end",I),R.end(A),J();function J(){for(var W;(W=R.read())!==null;)Z.push(W),K+=W.length;R.once("readable",J)}function D(W){R.removeListener("end",I),R.removeListener("readable",J),H(W)}function I(){var W,q=null;K>=i?q=new RangeError(r):W=f.concat(Z,K),Z=[],R.close(),H(q,W)}}function w(R,A){if(typeof A=="string"&&(A=f.from(A)),!f.isBuffer(A))throw new TypeError("Not a string or buffer");var H=R._finishFlushFlag;return R._processChunk(A,H)}function S(R){if(!(this instanceof S))return new S(R);j.call(this,R,o.DEFLATE)}function C(R){if(!(this instanceof C))return new C(R);j.call(this,R,o.INFLATE)}function E(R){if(!(this instanceof E))return new E(R);j.call(this,R,o.GZIP)}function k(R){if(!(this instanceof k))return new k(R);j.call(this,R,o.GUNZIP)}function O(R){if(!(this instanceof O))return new O(R);j.call(this,R,o.DEFLATERAW)}function U(R){if(!(this instanceof U))return new U(R);j.call(this,R,o.INFLATERAW)}function F(R){if(!(this instanceof F))return new F(R);j.call(this,R,o.UNZIP)}function M(R){return R===o.Z_NO_FLUSH||R===o.Z_PARTIAL_FLUSH||R===o.Z_SYNC_FLUSH||R===o.Z_FULL_FLUSH||R===o.Z_FINISH||R===o.Z_BLOCK}function j(R,A){var H=this;if(this._opts=R=R||{},this._chunkSize=R.chunkSize||g.Z_DEFAULT_CHUNK,n.call(this,R),R.flush&&!M(R.flush))throw new Error("Invalid flush flag: "+R.flush);if(R.finishFlush&&!M(R.finishFlush))throw new Error("Invalid flush flag: "+R.finishFlush);if(this._flushFlag=R.flush||o.Z_NO_FLUSH,this._finishFlushFlag=typeof R.finishFlush<"u"?R.finishFlush:o.Z_FINISH,R.chunkSize&&(R.chunkSize<g.Z_MIN_CHUNK||R.chunkSize>g.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+R.chunkSize);if(R.windowBits&&(R.windowBits<g.Z_MIN_WINDOWBITS||R.windowBits>g.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+R.windowBits);if(R.level&&(R.level<g.Z_MIN_LEVEL||R.level>g.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+R.level);if(R.memLevel&&(R.memLevel<g.Z_MIN_MEMLEVEL||R.memLevel>g.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+R.memLevel);if(R.strategy&&R.strategy!=g.Z_FILTERED&&R.strategy!=g.Z_HUFFMAN_ONLY&&R.strategy!=g.Z_RLE&&R.strategy!=g.Z_FIXED&&R.strategy!=g.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+R.strategy);if(R.dictionary&&!f.isBuffer(R.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new o.Zlib(A);var Z=this;this._hadError=!1,this._handle.onerror=function(D,I){G(Z),Z._hadError=!0;var W=new Error(D);W.errno=I,W.code=g.codes[I],Z.emit("error",W)};var K=g.Z_DEFAULT_COMPRESSION;typeof R.level=="number"&&(K=R.level);var J=g.Z_DEFAULT_STRATEGY;typeof R.strategy=="number"&&(J=R.strategy),this._handle.init(R.windowBits||g.Z_DEFAULT_WINDOWBITS,K,R.memLevel||g.Z_DEFAULT_MEMLEVEL,J,R.dictionary),this._buffer=f.allocUnsafe(this._chunkSize),this._offset=0,this._level=K,this._strategy=J,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!H._handle},configurable:!0,enumerable:!0})}a.inherits(j,n),j.prototype.params=function(R,A,H){if(R<g.Z_MIN_LEVEL||R>g.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+R);if(A!=g.Z_FILTERED&&A!=g.Z_HUFFMAN_ONLY&&A!=g.Z_RLE&&A!=g.Z_FIXED&&A!=g.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+A);if(this._level!==R||this._strategy!==A){var Z=this;this.flush(o.Z_SYNC_FLUSH,function(){t(Z._handle,"zlib binding closed"),Z._handle.params(R,A),Z._hadError||(Z._level=R,Z._strategy=A,H&&H())})}else b.nextTick(H)},j.prototype.reset=function(){return t(this._handle,"zlib binding closed"),this._handle.reset()},j.prototype._flush=function(R){this._transform(f.alloc(0),"",R)},j.prototype.flush=function(R,A){var H=this,Z=this._writableState;(typeof R=="function"||R===void 0&&!A)&&(A=R,R=o.Z_FULL_FLUSH),Z.ended?A&&b.nextTick(A):Z.ending?A&&this.once("end",A):Z.needDrain?A&&this.once("drain",function(){return H.flush(R,A)}):(this._flushFlag=R,this.write(f.alloc(0),"",A))},j.prototype.close=function(R){G(this,R),b.nextTick(N,this)};function G(R,A){A&&b.nextTick(A),R._handle&&(R._handle.close(),R._handle=null)}function N(R){R.emit("close")}j.prototype._transform=function(R,A,H){var Z,K=this._writableState,J=K.ending||K.ended,D=J&&(!R||K.length===R.length);if(R!==null&&!f.isBuffer(R))return H(new Error("invalid input"));if(!this._handle)return H(new Error("zlib binding closed"));D?Z=this._finishFlushFlag:(Z=this._flushFlag,R.length>=K.length&&(this._flushFlag=this._opts.flush||o.Z_NO_FLUSH)),this._processChunk(R,Z,H)},j.prototype._processChunk=function(R,A,H){var Z=R&&R.length,K=this._chunkSize-this._offset,J=0,D=this,I=typeof H=="function";if(!I){var W=[],q=0,ne;this.on("error",function(se){ne=se}),t(this._handle,"zlib binding closed");do var le=this._handle.writeSync(A,R,J,Z,this._buffer,this._offset,K);while(!this._hadError&&he(le[0],le[1]));if(this._hadError)throw ne;if(q>=i)throw G(this),new RangeError(r);var ce=f.concat(W,q);return G(this),ce}t(this._handle,"zlib binding closed");var fe=this._handle.write(A,R,J,Z,this._buffer,this._offset,K);fe.buffer=R,fe.callback=he;function he(se,ie){if(this&&(this.buffer=null,this.callback=null),!D._hadError){var Q=K-ie;if(t(Q>=0,"have should not go down"),Q>0){var re=D._buffer.slice(D._offset,D._offset+Q);D._offset+=Q,I?D.push(re):(W.push(re),q+=re.length)}if((ie===0||D._offset>=D._chunkSize)&&(K=D._chunkSize,D._offset=0,D._buffer=f.allocUnsafe(D._chunkSize)),ie===0){if(J+=Z-se,Z=se,!I)return!0;var te=D._handle.write(A,R,J,Z,D._buffer,D._offset,D._chunkSize);te.callback=he,te.buffer=R;return}if(!I)return!1;H()}}},a.inherits(S,j),a.inherits(C,j),a.inherits(E,j),a.inherits(k,j),a.inherits(O,j),a.inherits(U,j),a.inherits(F,j)}).call(this,m("_process"))},{"./binding":34,_process:133,assert:25,buffer:48,stream:155,util:186}],36:[function(m,x,g){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function f(a,t){return Object.prototype.hasOwnProperty.call(a,t)}g.assign=function(a){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(var r in i)f(i,r)&&(a[r]=i[r])}}return a},g.shrinkBuf=function(a,t){return a.length===t?a:a.subarray?a.subarray(0,t):(a.length=t,a)};var n={arraySet:function(a,t,i,r,e){if(t.subarray&&a.subarray){a.set(t.subarray(i,i+r),e);return}for(var l=0;l<r;l++)a[e+l]=t[i+l]},flattenChunks:function(a){var t,i,r,e,l,s;for(r=0,t=0,i=a.length;t<i;t++)r+=a[t].length;for(s=new Uint8Array(r),e=0,t=0,i=a.length;t<i;t++)l=a[t],s.set(l,e),e+=l.length;return s}},o={arraySet:function(a,t,i,r,e){for(var l=0;l<r;l++)a[e+l]=t[i+l]},flattenChunks:function(a){return[].concat.apply([],a)}};g.setTyped=function(a){a?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,n)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,o))},g.setTyped(b)},{}],37:[function(m,x,g){function b(f,n,o,a){for(var t=f&65535|0,i=f>>>16&65535|0,r=0;o!==0;){r=o>2e3?2e3:o,o-=r;do t=t+n[a++]|0,i=i+t|0;while(--r);t%=65521,i%=65521}return t|i<<16|0}x.exports=b},{}],38:[function(m,x,g){x.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],39:[function(m,x,g){function b(){for(var o,a=[],t=0;t<256;t++){o=t;for(var i=0;i<8;i++)o=o&1?3988292384^o>>>1:o>>>1;a[t]=o}return a}var f=b();function n(o,a,t,i){var r=f,e=i+t;o^=-1;for(var l=i;l<e;l++)o=o>>>8^r[(o^a[l])&255];return o^-1}x.exports=n},{}],40:[function(m,x,g){var b=m("../utils/common"),f=m("./trees"),n=m("./adler32"),o=m("./crc32"),a=m("./messages"),t=0,i=1,r=3,e=4,l=5,s=0,c=1,u=-2,h=-3,p=-5,_=-1,w=1,S=2,C=3,E=4,k=0,O=2,U=8,F=9,M=15,j=8,G=29,N=256,R=N+1+G,A=30,H=19,Z=2*R+1,K=15,J=3,D=258,I=D+J+1,W=32,q=42,ne=69,le=73,ce=91,fe=103,he=113,se=666,ie=1,Q=2,re=3,te=4,V=3;function z(T,me){return T.msg=a[me],me}function B(T){return(T<<1)-(T>4?9:0)}function ee(T){for(var me=T.length;--me>=0;)T[me]=0}function Y(T){var me=T.state,ye=me.pending;ye>T.avail_out&&(ye=T.avail_out),ye!==0&&(b.arraySet(T.output,me.pending_buf,me.pending_out,ye,T.next_out),T.next_out+=ye,me.pending_out+=ye,T.total_out+=ye,T.avail_out-=ye,me.pending-=ye,me.pending===0&&(me.pending_out=0))}function L(T,me){f._tr_flush_block(T,T.block_start>=0?T.block_start:-1,T.strstart-T.block_start,me),T.block_start=T.strstart,Y(T.strm)}function P(T,me){T.pending_buf[T.pending++]=me}function ae(T,me){T.pending_buf[T.pending++]=me>>>8&255,T.pending_buf[T.pending++]=me&255}function ue(T,me,ye,X){var de=T.avail_in;return de>X&&(de=X),de===0?0:(T.avail_in-=de,b.arraySet(me,T.input,T.next_in,de,ye),T.state.wrap===1?T.adler=n(T.adler,me,de,ye):T.state.wrap===2&&(T.adler=o(T.adler,me,de,ye)),T.next_in+=de,T.total_in+=de,de)}function ve(T,me){var ye=T.max_chain_length,X=T.strstart,de,xe,Pe=T.prev_length,Oe=T.nice_match,Ne=T.strstart>T.w_size-I?T.strstart-(T.w_size-I):0,je=T.window,bt=T.w_mask,Je=T.prev,Ye=T.strstart+D,it=je[X+Pe-1],ct=je[X+Pe];T.prev_length>=T.good_match&&(ye>>=2),Oe>T.lookahead&&(Oe=T.lookahead);do if(de=me,!(je[de+Pe]!==ct||je[de+Pe-1]!==it||je[de]!==je[X]||je[++de]!==je[X+1])){X+=2,de++;do;while(je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&X<Ye);if(xe=D-(Ye-X),X=Ye-D,xe>Pe){if(T.match_start=me,Pe=xe,xe>=Oe)break;it=je[X+Pe-1],ct=je[X+Pe]}}while((me=Je[me&bt])>Ne&&--ye!==0);return Pe<=T.lookahead?Pe:T.lookahead}function _e(T){var me=T.w_size,ye,X,de,xe,Pe;do{if(xe=T.window_size-T.lookahead-T.strstart,T.strstart>=me+(me-I)){b.arraySet(T.window,T.window,me,me,0),T.match_start-=me,T.strstart-=me,T.block_start-=me,X=T.hash_size,ye=X;do de=T.head[--ye],T.head[ye]=de>=me?de-me:0;while(--X);X=me,ye=X;do de=T.prev[--ye],T.prev[ye]=de>=me?de-me:0;while(--X);xe+=me}if(T.strm.avail_in===0)break;if(X=ue(T.strm,T.window,T.strstart+T.lookahead,xe),T.lookahead+=X,T.lookahead+T.insert>=J)for(Pe=T.strstart-T.insert,T.ins_h=T.window[Pe],T.ins_h=(T.ins_h<<T.hash_shift^T.window[Pe+1])&T.hash_mask;T.insert&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[Pe+J-1])&T.hash_mask,T.prev[Pe&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=Pe,Pe++,T.insert--,!(T.lookahead+T.insert<J)););}while(T.lookahead<I&&T.strm.avail_in!==0)}function Te(T,me){var ye=65535;for(ye>T.pending_buf_size-5&&(ye=T.pending_buf_size-5);;){if(T.lookahead<=1){if(_e(T),T.lookahead===0&&me===t)return ie;if(T.lookahead===0)break}T.strstart+=T.lookahead,T.lookahead=0;var X=T.block_start+ye;if((T.strstart===0||T.strstart>=X)&&(T.lookahead=T.strstart-X,T.strstart=X,L(T,!1),T.strm.avail_out===0)||T.strstart-T.block_start>=T.w_size-I&&(L(T,!1),T.strm.avail_out===0))return ie}return T.insert=0,me===e?(L(T,!0),T.strm.avail_out===0?re:te):(T.strstart>T.block_start&&(L(T,!1),T.strm.avail_out===0),ie)}function Re(T,me){for(var ye,X;;){if(T.lookahead<I){if(_e(T),T.lookahead<I&&me===t)return ie;if(T.lookahead===0)break}if(ye=0,T.lookahead>=J&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+J-1])&T.hash_mask,ye=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart),ye!==0&&T.strstart-ye<=T.w_size-I&&(T.match_length=ve(T,ye)),T.match_length>=J)if(X=f._tr_tally(T,T.strstart-T.match_start,T.match_length-J),T.lookahead-=T.match_length,T.match_length<=T.max_lazy_match&&T.lookahead>=J){T.match_length--;do T.strstart++,T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+J-1])&T.hash_mask,ye=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart;while(--T.match_length!==0);T.strstart++}else T.strstart+=T.match_length,T.match_length=0,T.ins_h=T.window[T.strstart],T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+1])&T.hash_mask;else X=f._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++;if(X&&(L(T,!1),T.strm.avail_out===0))return ie}return T.insert=T.strstart<J-1?T.strstart:J-1,me===e?(L(T,!0),T.strm.avail_out===0?re:te):T.last_lit&&(L(T,!1),T.strm.avail_out===0)?ie:Q}function Le(T,me){for(var ye,X,de;;){if(T.lookahead<I){if(_e(T),T.lookahead<I&&me===t)return ie;if(T.lookahead===0)break}if(ye=0,T.lookahead>=J&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+J-1])&T.hash_mask,ye=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart),T.prev_length=T.match_length,T.prev_match=T.match_start,T.match_length=J-1,ye!==0&&T.prev_length<T.max_lazy_match&&T.strstart-ye<=T.w_size-I&&(T.match_length=ve(T,ye),T.match_length<=5&&(T.strategy===w||T.match_length===J&&T.strstart-T.match_start>4096)&&(T.match_length=J-1)),T.prev_length>=J&&T.match_length<=T.prev_length){de=T.strstart+T.lookahead-J,X=f._tr_tally(T,T.strstart-1-T.prev_match,T.prev_length-J),T.lookahead-=T.prev_length-1,T.prev_length-=2;do++T.strstart<=de&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+J-1])&T.hash_mask,ye=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart);while(--T.prev_length!==0);if(T.match_available=0,T.match_length=J-1,T.strstart++,X&&(L(T,!1),T.strm.avail_out===0))return ie}else if(T.match_available){if(X=f._tr_tally(T,0,T.window[T.strstart-1]),X&&L(T,!1),T.strstart++,T.lookahead--,T.strm.avail_out===0)return ie}else T.match_available=1,T.strstart++,T.lookahead--}return T.match_available&&(X=f._tr_tally(T,0,T.window[T.strstart-1]),T.match_available=0),T.insert=T.strstart<J-1?T.strstart:J-1,me===e?(L(T,!0),T.strm.avail_out===0?re:te):T.last_lit&&(L(T,!1),T.strm.avail_out===0)?ie:Q}function Se(T,me){for(var ye,X,de,xe,Pe=T.window;;){if(T.lookahead<=D){if(_e(T),T.lookahead<=D&&me===t)return ie;if(T.lookahead===0)break}if(T.match_length=0,T.lookahead>=J&&T.strstart>0&&(de=T.strstart-1,X=Pe[de],X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de])){xe=T.strstart+D;do;while(X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&de<xe);T.match_length=D-(xe-de),T.match_length>T.lookahead&&(T.match_length=T.lookahead)}if(T.match_length>=J?(ye=f._tr_tally(T,1,T.match_length-J),T.lookahead-=T.match_length,T.strstart+=T.match_length,T.match_length=0):(ye=f._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++),ye&&(L(T,!1),T.strm.avail_out===0))return ie}return T.insert=0,me===e?(L(T,!0),T.strm.avail_out===0?re:te):T.last_lit&&(L(T,!1),T.strm.avail_out===0)?ie:Q}function Ee(T,me){for(var ye;;){if(T.lookahead===0&&(_e(T),T.lookahead===0)){if(me===t)return ie;break}if(T.match_length=0,ye=f._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++,ye&&(L(T,!1),T.strm.avail_out===0))return ie}return T.insert=0,me===e?(L(T,!0),T.strm.avail_out===0?re:te):T.last_lit&&(L(T,!1),T.strm.avail_out===0)?ie:Q}function Ce(T,me,ye,X,de){this.good_length=T,this.max_lazy=me,this.nice_length=ye,this.max_chain=X,this.func=de}var Ie;Ie=[new Ce(0,0,0,0,Te),new Ce(4,4,8,4,Re),new Ce(4,5,16,8,Re),new Ce(4,6,32,32,Re),new Ce(4,4,16,16,Le),new Ce(8,16,32,32,Le),new Ce(8,16,128,128,Le),new Ce(8,32,128,256,Le),new Ce(32,128,258,1024,Le),new Ce(32,258,258,4096,Le)];function Ae(T){T.window_size=2*T.w_size,ee(T.head),T.max_lazy_match=Ie[T.level].max_lazy,T.good_match=Ie[T.level].good_length,T.nice_match=Ie[T.level].nice_length,T.max_chain_length=Ie[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=J-1,T.match_available=0,T.ins_h=0}function $(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=U,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new b.Buf16(Z*2),this.dyn_dtree=new b.Buf16((2*A+1)*2),this.bl_tree=new b.Buf16((2*H+1)*2),ee(this.dyn_ltree),ee(this.dyn_dtree),ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new b.Buf16(K+1),this.heap=new b.Buf16(2*R+1),ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new b.Buf16(2*R+1),ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function be(T){var me;return!T||!T.state?z(T,u):(T.total_in=T.total_out=0,T.data_type=O,me=T.state,me.pending=0,me.pending_out=0,me.wrap<0&&(me.wrap=-me.wrap),me.status=me.wrap?q:he,T.adler=me.wrap===2?0:1,me.last_flush=t,f._tr_init(me),s)}function ge(T){var me=be(T);return me===s&&Ae(T.state),me}function ke(T,me){return!T||!T.state||T.state.wrap!==2?u:(T.state.gzhead=me,s)}function pe(T,me,ye,X,de,xe){if(!T)return u;var Pe=1;if(me===_&&(me=6),X<0?(Pe=0,X=-X):X>15&&(Pe=2,X-=16),de<1||de>F||ye!==U||X<8||X>15||me<0||me>9||xe<0||xe>E)return z(T,u);X===8&&(X=9);var Oe=new $;return T.state=Oe,Oe.strm=T,Oe.wrap=Pe,Oe.gzhead=null,Oe.w_bits=X,Oe.w_size=1<<Oe.w_bits,Oe.w_mask=Oe.w_size-1,Oe.hash_bits=de+7,Oe.hash_size=1<<Oe.hash_bits,Oe.hash_mask=Oe.hash_size-1,Oe.hash_shift=~~((Oe.hash_bits+J-1)/J),Oe.window=new b.Buf8(Oe.w_size*2),Oe.head=new b.Buf16(Oe.hash_size),Oe.prev=new b.Buf16(Oe.w_size),Oe.lit_bufsize=1<<de+6,Oe.pending_buf_size=Oe.lit_bufsize*4,Oe.pending_buf=new b.Buf8(Oe.pending_buf_size),Oe.d_buf=1*Oe.lit_bufsize,Oe.l_buf=(1+2)*Oe.lit_bufsize,Oe.level=me,Oe.strategy=xe,Oe.method=ye,ge(T)}function we(T,me){return pe(T,me,U,M,j,k)}function oe(T,me){var ye,X,de,xe;if(!T||!T.state||me>l||me<0)return T?z(T,u):u;if(X=T.state,!T.output||!T.input&&T.avail_in!==0||X.status===se&&me!==e)return z(T,T.avail_out===0?p:u);if(X.strm=T,ye=X.last_flush,X.last_flush=me,X.status===q)if(X.wrap===2)T.adler=0,P(X,31),P(X,139),P(X,8),X.gzhead?(P(X,(X.gzhead.text?1:0)+(X.gzhead.hcrc?2:0)+(X.gzhead.extra?4:0)+(X.gzhead.name?8:0)+(X.gzhead.comment?16:0)),P(X,X.gzhead.time&255),P(X,X.gzhead.time>>8&255),P(X,X.gzhead.time>>16&255),P(X,X.gzhead.time>>24&255),P(X,X.level===9?2:X.strategy>=S||X.level<2?4:0),P(X,X.gzhead.os&255),X.gzhead.extra&&X.gzhead.extra.length&&(P(X,X.gzhead.extra.length&255),P(X,X.gzhead.extra.length>>8&255)),X.gzhead.hcrc&&(T.adler=o(T.adler,X.pending_buf,X.pending,0)),X.gzindex=0,X.status=ne):(P(X,0),P(X,0),P(X,0),P(X,0),P(X,0),P(X,X.level===9?2:X.strategy>=S||X.level<2?4:0),P(X,V),X.status=he);else{var Pe=U+(X.w_bits-8<<4)<<8,Oe=-1;X.strategy>=S||X.level<2?Oe=0:X.level<6?Oe=1:X.level===6?Oe=2:Oe=3,Pe|=Oe<<6,X.strstart!==0&&(Pe|=W),Pe+=31-Pe%31,X.status=he,ae(X,Pe),X.strstart!==0&&(ae(X,T.adler>>>16),ae(X,T.adler&65535)),T.adler=1}if(X.status===ne)if(X.gzhead.extra){for(de=X.pending;X.gzindex<(X.gzhead.extra.length&65535)&&!(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),Y(T),de=X.pending,X.pending===X.pending_buf_size));)P(X,X.gzhead.extra[X.gzindex]&255),X.gzindex++;X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),X.gzindex===X.gzhead.extra.length&&(X.gzindex=0,X.status=le)}else X.status=le;if(X.status===le)if(X.gzhead.name){de=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),Y(T),de=X.pending,X.pending===X.pending_buf_size)){xe=1;break}X.gzindex<X.gzhead.name.length?xe=X.gzhead.name.charCodeAt(X.gzindex++)&255:xe=0,P(X,xe)}while(xe!==0);X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),xe===0&&(X.gzindex=0,X.status=ce)}else X.status=ce;if(X.status===ce)if(X.gzhead.comment){de=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),Y(T),de=X.pending,X.pending===X.pending_buf_size)){xe=1;break}X.gzindex<X.gzhead.comment.length?xe=X.gzhead.comment.charCodeAt(X.gzindex++)&255:xe=0,P(X,xe)}while(xe!==0);X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),xe===0&&(X.status=fe)}else X.status=fe;if(X.status===fe&&(X.gzhead.hcrc?(X.pending+2>X.pending_buf_size&&Y(T),X.pending+2<=X.pending_buf_size&&(P(X,T.adler&255),P(X,T.adler>>8&255),T.adler=0,X.status=he)):X.status=he),X.pending!==0){if(Y(T),T.avail_out===0)return X.last_flush=-1,s}else if(T.avail_in===0&&B(me)<=B(ye)&&me!==e)return z(T,p);if(X.status===se&&T.avail_in!==0)return z(T,p);if(T.avail_in!==0||X.lookahead!==0||me!==t&&X.status!==se){var Ne=X.strategy===S?Ee(X,me):X.strategy===C?Se(X,me):Ie[X.level].func(X,me);if((Ne===re||Ne===te)&&(X.status=se),Ne===ie||Ne===re)return T.avail_out===0&&(X.last_flush=-1),s;if(Ne===Q&&(me===i?f._tr_align(X):me!==l&&(f._tr_stored_block(X,0,0,!1),me===r&&(ee(X.head),X.lookahead===0&&(X.strstart=0,X.block_start=0,X.insert=0))),Y(T),T.avail_out===0))return X.last_flush=-1,s}return me!==e?s:X.wrap<=0?c:(X.wrap===2?(P(X,T.adler&255),P(X,T.adler>>8&255),P(X,T.adler>>16&255),P(X,T.adler>>24&255),P(X,T.total_in&255),P(X,T.total_in>>8&255),P(X,T.total_in>>16&255),P(X,T.total_in>>24&255)):(ae(X,T.adler>>>16),ae(X,T.adler&65535)),Y(T),X.wrap>0&&(X.wrap=-X.wrap),X.pending!==0?s:c)}function Ue(T){var me;return!T||!T.state?u:(me=T.state.status,me!==q&&me!==ne&&me!==le&&me!==ce&&me!==fe&&me!==he&&me!==se?z(T,u):(T.state=null,me===he?z(T,h):s))}function ze(T,me){var ye=me.length,X,de,xe,Pe,Oe,Ne,je,bt;if(!T||!T.state||(X=T.state,Pe=X.wrap,Pe===2||Pe===1&&X.status!==q||X.lookahead))return u;for(Pe===1&&(T.adler=n(T.adler,me,ye,0)),X.wrap=0,ye>=X.w_size&&(Pe===0&&(ee(X.head),X.strstart=0,X.block_start=0,X.insert=0),bt=new b.Buf8(X.w_size),b.arraySet(bt,me,ye-X.w_size,X.w_size,0),me=bt,ye=X.w_size),Oe=T.avail_in,Ne=T.next_in,je=T.input,T.avail_in=ye,T.next_in=0,T.input=me,_e(X);X.lookahead>=J;){de=X.strstart,xe=X.lookahead-(J-1);do X.ins_h=(X.ins_h<<X.hash_shift^X.window[de+J-1])&X.hash_mask,X.prev[de&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=de,de++;while(--xe);X.strstart=de,X.lookahead=J-1,_e(X)}return X.strstart+=X.lookahead,X.block_start=X.strstart,X.insert=X.lookahead,X.lookahead=0,X.match_length=X.prev_length=J-1,X.match_available=0,T.next_in=Ne,T.input=je,T.avail_in=Oe,X.wrap=Pe,s}g.deflateInit=we,g.deflateInit2=pe,g.deflateReset=ge,g.deflateResetKeep=be,g.deflateSetHeader=ke,g.deflate=oe,g.deflateEnd=Ue,g.deflateSetDictionary=ze,g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":36,"./adler32":37,"./crc32":39,"./messages":44,"./trees":45}],41:[function(m,x,g){var b=30,f=12;x.exports=function(o,a){var t,i,r,e,l,s,c,u,h,p,_,w,S,C,E,k,O,U,F,M,j,G,N,R,A;t=o.state,i=o.next_in,R=o.input,r=i+(o.avail_in-5),e=o.next_out,A=o.output,l=e-(a-o.avail_out),s=e+(o.avail_out-257),c=t.dmax,u=t.wsize,h=t.whave,p=t.wnext,_=t.window,w=t.hold,S=t.bits,C=t.lencode,E=t.distcode,k=(1<<t.lenbits)-1,O=(1<<t.distbits)-1;e:do{S<15&&(w+=R[i++]<<S,S+=8,w+=R[i++]<<S,S+=8),U=C[w&k];t:for(;;){if(F=U>>>24,w>>>=F,S-=F,F=U>>>16&255,F===0)A[e++]=U&65535;else if(F&16){M=U&65535,F&=15,F&&(S<F&&(w+=R[i++]<<S,S+=8),M+=w&(1<<F)-1,w>>>=F,S-=F),S<15&&(w+=R[i++]<<S,S+=8,w+=R[i++]<<S,S+=8),U=E[w&O];r:for(;;){if(F=U>>>24,w>>>=F,S-=F,F=U>>>16&255,F&16){if(j=U&65535,F&=15,S<F&&(w+=R[i++]<<S,S+=8,S<F&&(w+=R[i++]<<S,S+=8)),j+=w&(1<<F)-1,j>c){o.msg="invalid distance too far back",t.mode=b;break e}if(w>>>=F,S-=F,F=e-l,j>F){if(F=j-F,F>h&&t.sane){o.msg="invalid distance too far back",t.mode=b;break e}if(G=0,N=_,p===0){if(G+=u-F,F<M){M-=F;do A[e++]=_[G++];while(--F);G=e-j,N=A}}else if(p<F){if(G+=u+p-F,F-=p,F<M){M-=F;do A[e++]=_[G++];while(--F);if(G=0,p<M){F=p,M-=F;do A[e++]=_[G++];while(--F);G=e-j,N=A}}}else if(G+=p-F,F<M){M-=F;do A[e++]=_[G++];while(--F);G=e-j,N=A}for(;M>2;)A[e++]=N[G++],A[e++]=N[G++],A[e++]=N[G++],M-=3;M&&(A[e++]=N[G++],M>1&&(A[e++]=N[G++]))}else{G=e-j;do A[e++]=A[G++],A[e++]=A[G++],A[e++]=A[G++],M-=3;while(M>2);M&&(A[e++]=A[G++],M>1&&(A[e++]=A[G++]))}}else if(F&64){o.msg="invalid distance code",t.mode=b;break e}else{U=E[(U&65535)+(w&(1<<F)-1)];continue r}break}}else if(F&64)if(F&32){t.mode=f;break e}else{o.msg="invalid literal/length code",t.mode=b;break e}else{U=C[(U&65535)+(w&(1<<F)-1)];continue t}break}}while(i<r&&e<s);M=S>>3,i-=M,S-=M<<3,w&=(1<<S)-1,o.next_in=i,o.next_out=e,o.avail_in=i<r?5+(r-i):5-(i-r),o.avail_out=e<s?257+(s-e):257-(e-s),t.hold=w,t.bits=S}},{}],42:[function(m,x,g){var b=m("../utils/common"),f=m("./adler32"),n=m("./crc32"),o=m("./inffast"),a=m("./inftrees"),t=0,i=1,r=2,e=4,l=5,s=6,c=0,u=1,h=2,p=-2,_=-3,w=-4,S=-5,C=8,E=1,k=2,O=3,U=4,F=5,M=6,j=7,G=8,N=9,R=10,A=11,H=12,Z=13,K=14,J=15,D=16,I=17,W=18,q=19,ne=20,le=21,ce=22,fe=23,he=24,se=25,ie=26,Q=27,re=28,te=29,V=30,z=31,B=32,ee=852,Y=592,L=15,P=L;function ae(pe){return(pe>>>24&255)+(pe>>>8&65280)+((pe&65280)<<8)+((pe&255)<<24)}function ue(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ve(pe){var we;return!pe||!pe.state?p:(we=pe.state,pe.total_in=pe.total_out=we.total=0,pe.msg="",we.wrap&&(pe.adler=we.wrap&1),we.mode=E,we.last=0,we.havedict=0,we.dmax=32768,we.head=null,we.hold=0,we.bits=0,we.lencode=we.lendyn=new b.Buf32(ee),we.distcode=we.distdyn=new b.Buf32(Y),we.sane=1,we.back=-1,c)}function _e(pe){var we;return!pe||!pe.state?p:(we=pe.state,we.wsize=0,we.whave=0,we.wnext=0,ve(pe))}function Te(pe,we){var oe,Ue;return!pe||!pe.state||(Ue=pe.state,we<0?(oe=0,we=-we):(oe=(we>>4)+1,we<48&&(we&=15)),we&&(we<8||we>15))?p:(Ue.window!==null&&Ue.wbits!==we&&(Ue.window=null),Ue.wrap=oe,Ue.wbits=we,_e(pe))}function Re(pe,we){var oe,Ue;return pe?(Ue=new ue,pe.state=Ue,Ue.window=null,oe=Te(pe,we),oe!==c&&(pe.state=null),oe):p}function Le(pe){return Re(pe,P)}var Se=!0,Ee,Ce;function Ie(pe){if(Se){var we;for(Ee=new b.Buf32(512),Ce=new b.Buf32(32),we=0;we<144;)pe.lens[we++]=8;for(;we<256;)pe.lens[we++]=9;for(;we<280;)pe.lens[we++]=7;for(;we<288;)pe.lens[we++]=8;for(a(i,pe.lens,0,288,Ee,0,pe.work,{bits:9}),we=0;we<32;)pe.lens[we++]=5;a(r,pe.lens,0,32,Ce,0,pe.work,{bits:5}),Se=!1}pe.lencode=Ee,pe.lenbits=9,pe.distcode=Ce,pe.distbits=5}function Ae(pe,we,oe,Ue){var ze,T=pe.state;return T.window===null&&(T.wsize=1<<T.wbits,T.wnext=0,T.whave=0,T.window=new b.Buf8(T.wsize)),Ue>=T.wsize?(b.arraySet(T.window,we,oe-T.wsize,T.wsize,0),T.wnext=0,T.whave=T.wsize):(ze=T.wsize-T.wnext,ze>Ue&&(ze=Ue),b.arraySet(T.window,we,oe-Ue,ze,T.wnext),Ue-=ze,Ue?(b.arraySet(T.window,we,oe-Ue,Ue,0),T.wnext=Ue,T.whave=T.wsize):(T.wnext+=ze,T.wnext===T.wsize&&(T.wnext=0),T.whave<T.wsize&&(T.whave+=ze))),0}function $(pe,we){var oe,Ue,ze,T,me,ye,X,de,xe,Pe,Oe,Ne,je,bt,Je=0,Ye,it,ct,wt,ir,ar,ft,gt,dt=new b.Buf8(4),Ut,kt,Rr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!pe||!pe.state||!pe.output||!pe.input&&pe.avail_in!==0)return p;oe=pe.state,oe.mode===H&&(oe.mode=Z),me=pe.next_out,ze=pe.output,X=pe.avail_out,T=pe.next_in,Ue=pe.input,ye=pe.avail_in,de=oe.hold,xe=oe.bits,Pe=ye,Oe=X,gt=c;e:for(;;)switch(oe.mode){case E:if(oe.wrap===0){oe.mode=Z;break}for(;xe<16;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(oe.wrap&2&&de===35615){oe.check=0,dt[0]=de&255,dt[1]=de>>>8&255,oe.check=n(oe.check,dt,2,0),de=0,xe=0,oe.mode=k;break}if(oe.flags=0,oe.head&&(oe.head.done=!1),!(oe.wrap&1)||(((de&255)<<8)+(de>>8))%31){pe.msg="incorrect header check",oe.mode=V;break}if((de&15)!==C){pe.msg="unknown compression method",oe.mode=V;break}if(de>>>=4,xe-=4,ft=(de&15)+8,oe.wbits===0)oe.wbits=ft;else if(ft>oe.wbits){pe.msg="invalid window size",oe.mode=V;break}oe.dmax=1<<ft,pe.adler=oe.check=1,oe.mode=de&512?R:H,de=0,xe=0;break;case k:for(;xe<16;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(oe.flags=de,(oe.flags&255)!==C){pe.msg="unknown compression method",oe.mode=V;break}if(oe.flags&57344){pe.msg="unknown header flags set",oe.mode=V;break}oe.head&&(oe.head.text=de>>8&1),oe.flags&512&&(dt[0]=de&255,dt[1]=de>>>8&255,oe.check=n(oe.check,dt,2,0)),de=0,xe=0,oe.mode=O;case O:for(;xe<32;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}oe.head&&(oe.head.time=de),oe.flags&512&&(dt[0]=de&255,dt[1]=de>>>8&255,dt[2]=de>>>16&255,dt[3]=de>>>24&255,oe.check=n(oe.check,dt,4,0)),de=0,xe=0,oe.mode=U;case U:for(;xe<16;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}oe.head&&(oe.head.xflags=de&255,oe.head.os=de>>8),oe.flags&512&&(dt[0]=de&255,dt[1]=de>>>8&255,oe.check=n(oe.check,dt,2,0)),de=0,xe=0,oe.mode=F;case F:if(oe.flags&1024){for(;xe<16;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}oe.length=de,oe.head&&(oe.head.extra_len=de),oe.flags&512&&(dt[0]=de&255,dt[1]=de>>>8&255,oe.check=n(oe.check,dt,2,0)),de=0,xe=0}else oe.head&&(oe.head.extra=null);oe.mode=M;case M:if(oe.flags&1024&&(Ne=oe.length,Ne>ye&&(Ne=ye),Ne&&(oe.head&&(ft=oe.head.extra_len-oe.length,oe.head.extra||(oe.head.extra=new Array(oe.head.extra_len)),b.arraySet(oe.head.extra,Ue,T,Ne,ft)),oe.flags&512&&(oe.check=n(oe.check,Ue,Ne,T)),ye-=Ne,T+=Ne,oe.length-=Ne),oe.length))break e;oe.length=0,oe.mode=j;case j:if(oe.flags&2048){if(ye===0)break e;Ne=0;do ft=Ue[T+Ne++],oe.head&&ft&&oe.length<65536&&(oe.head.name+=String.fromCharCode(ft));while(ft&&Ne<ye);if(oe.flags&512&&(oe.check=n(oe.check,Ue,Ne,T)),ye-=Ne,T+=Ne,ft)break e}else oe.head&&(oe.head.name=null);oe.length=0,oe.mode=G;case G:if(oe.flags&4096){if(ye===0)break e;Ne=0;do ft=Ue[T+Ne++],oe.head&&ft&&oe.length<65536&&(oe.head.comment+=String.fromCharCode(ft));while(ft&&Ne<ye);if(oe.flags&512&&(oe.check=n(oe.check,Ue,Ne,T)),ye-=Ne,T+=Ne,ft)break e}else oe.head&&(oe.head.comment=null);oe.mode=N;case N:if(oe.flags&512){for(;xe<16;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(de!==(oe.check&65535)){pe.msg="header crc mismatch",oe.mode=V;break}de=0,xe=0}oe.head&&(oe.head.hcrc=oe.flags>>9&1,oe.head.done=!0),pe.adler=oe.check=0,oe.mode=H;break;case R:for(;xe<32;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}pe.adler=oe.check=ae(de),de=0,xe=0,oe.mode=A;case A:if(oe.havedict===0)return pe.next_out=me,pe.avail_out=X,pe.next_in=T,pe.avail_in=ye,oe.hold=de,oe.bits=xe,h;pe.adler=oe.check=1,oe.mode=H;case H:if(we===l||we===s)break e;case Z:if(oe.last){de>>>=xe&7,xe-=xe&7,oe.mode=Q;break}for(;xe<3;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}switch(oe.last=de&1,de>>>=1,xe-=1,de&3){case 0:oe.mode=K;break;case 1:if(Ie(oe),oe.mode=ne,we===s){de>>>=2,xe-=2;break e}break;case 2:oe.mode=I;break;case 3:pe.msg="invalid block type",oe.mode=V}de>>>=2,xe-=2;break;case K:for(de>>>=xe&7,xe-=xe&7;xe<32;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if((de&65535)!==(de>>>16^65535)){pe.msg="invalid stored block lengths",oe.mode=V;break}if(oe.length=de&65535,de=0,xe=0,oe.mode=J,we===s)break e;case J:oe.mode=D;case D:if(Ne=oe.length,Ne){if(Ne>ye&&(Ne=ye),Ne>X&&(Ne=X),Ne===0)break e;b.arraySet(ze,Ue,T,Ne,me),ye-=Ne,T+=Ne,X-=Ne,me+=Ne,oe.length-=Ne;break}oe.mode=H;break;case I:for(;xe<14;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(oe.nlen=(de&31)+257,de>>>=5,xe-=5,oe.ndist=(de&31)+1,de>>>=5,xe-=5,oe.ncode=(de&15)+4,de>>>=4,xe-=4,oe.nlen>286||oe.ndist>30){pe.msg="too many length or distance symbols",oe.mode=V;break}oe.have=0,oe.mode=W;case W:for(;oe.have<oe.ncode;){for(;xe<3;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}oe.lens[Rr[oe.have++]]=de&7,de>>>=3,xe-=3}for(;oe.have<19;)oe.lens[Rr[oe.have++]]=0;if(oe.lencode=oe.lendyn,oe.lenbits=7,Ut={bits:oe.lenbits},gt=a(t,oe.lens,0,19,oe.lencode,0,oe.work,Ut),oe.lenbits=Ut.bits,gt){pe.msg="invalid code lengths set",oe.mode=V;break}oe.have=0,oe.mode=q;case q:for(;oe.have<oe.nlen+oe.ndist;){for(;Je=oe.lencode[de&(1<<oe.lenbits)-1],Ye=Je>>>24,it=Je>>>16&255,ct=Je&65535,!(Ye<=xe);){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(ct<16)de>>>=Ye,xe-=Ye,oe.lens[oe.have++]=ct;else{if(ct===16){for(kt=Ye+2;xe<kt;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(de>>>=Ye,xe-=Ye,oe.have===0){pe.msg="invalid bit length repeat",oe.mode=V;break}ft=oe.lens[oe.have-1],Ne=3+(de&3),de>>>=2,xe-=2}else if(ct===17){for(kt=Ye+3;xe<kt;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}de>>>=Ye,xe-=Ye,ft=0,Ne=3+(de&7),de>>>=3,xe-=3}else{for(kt=Ye+7;xe<kt;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}de>>>=Ye,xe-=Ye,ft=0,Ne=11+(de&127),de>>>=7,xe-=7}if(oe.have+Ne>oe.nlen+oe.ndist){pe.msg="invalid bit length repeat",oe.mode=V;break}for(;Ne--;)oe.lens[oe.have++]=ft}}if(oe.mode===V)break;if(oe.lens[256]===0){pe.msg="invalid code -- missing end-of-block",oe.mode=V;break}if(oe.lenbits=9,Ut={bits:oe.lenbits},gt=a(i,oe.lens,0,oe.nlen,oe.lencode,0,oe.work,Ut),oe.lenbits=Ut.bits,gt){pe.msg="invalid literal/lengths set",oe.mode=V;break}if(oe.distbits=6,oe.distcode=oe.distdyn,Ut={bits:oe.distbits},gt=a(r,oe.lens,oe.nlen,oe.ndist,oe.distcode,0,oe.work,Ut),oe.distbits=Ut.bits,gt){pe.msg="invalid distances set",oe.mode=V;break}if(oe.mode=ne,we===s)break e;case ne:oe.mode=le;case le:if(ye>=6&&X>=258){pe.next_out=me,pe.avail_out=X,pe.next_in=T,pe.avail_in=ye,oe.hold=de,oe.bits=xe,o(pe,Oe),me=pe.next_out,ze=pe.output,X=pe.avail_out,T=pe.next_in,Ue=pe.input,ye=pe.avail_in,de=oe.hold,xe=oe.bits,oe.mode===H&&(oe.back=-1);break}for(oe.back=0;Je=oe.lencode[de&(1<<oe.lenbits)-1],Ye=Je>>>24,it=Je>>>16&255,ct=Je&65535,!(Ye<=xe);){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(it&&!(it&240)){for(wt=Ye,ir=it,ar=ct;Je=oe.lencode[ar+((de&(1<<wt+ir)-1)>>wt)],Ye=Je>>>24,it=Je>>>16&255,ct=Je&65535,!(wt+Ye<=xe);){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}de>>>=wt,xe-=wt,oe.back+=wt}if(de>>>=Ye,xe-=Ye,oe.back+=Ye,oe.length=ct,it===0){oe.mode=ie;break}if(it&32){oe.back=-1,oe.mode=H;break}if(it&64){pe.msg="invalid literal/length code",oe.mode=V;break}oe.extra=it&15,oe.mode=ce;case ce:if(oe.extra){for(kt=oe.extra;xe<kt;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}oe.length+=de&(1<<oe.extra)-1,de>>>=oe.extra,xe-=oe.extra,oe.back+=oe.extra}oe.was=oe.length,oe.mode=fe;case fe:for(;Je=oe.distcode[de&(1<<oe.distbits)-1],Ye=Je>>>24,it=Je>>>16&255,ct=Je&65535,!(Ye<=xe);){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(!(it&240)){for(wt=Ye,ir=it,ar=ct;Je=oe.distcode[ar+((de&(1<<wt+ir)-1)>>wt)],Ye=Je>>>24,it=Je>>>16&255,ct=Je&65535,!(wt+Ye<=xe);){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}de>>>=wt,xe-=wt,oe.back+=wt}if(de>>>=Ye,xe-=Ye,oe.back+=Ye,it&64){pe.msg="invalid distance code",oe.mode=V;break}oe.offset=ct,oe.extra=it&15,oe.mode=he;case he:if(oe.extra){for(kt=oe.extra;xe<kt;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}oe.offset+=de&(1<<oe.extra)-1,de>>>=oe.extra,xe-=oe.extra,oe.back+=oe.extra}if(oe.offset>oe.dmax){pe.msg="invalid distance too far back",oe.mode=V;break}oe.mode=se;case se:if(X===0)break e;if(Ne=Oe-X,oe.offset>Ne){if(Ne=oe.offset-Ne,Ne>oe.whave&&oe.sane){pe.msg="invalid distance too far back",oe.mode=V;break}Ne>oe.wnext?(Ne-=oe.wnext,je=oe.wsize-Ne):je=oe.wnext-Ne,Ne>oe.length&&(Ne=oe.length),bt=oe.window}else bt=ze,je=me-oe.offset,Ne=oe.length;Ne>X&&(Ne=X),X-=Ne,oe.length-=Ne;do ze[me++]=bt[je++];while(--Ne);oe.length===0&&(oe.mode=le);break;case ie:if(X===0)break e;ze[me++]=oe.length,X--,oe.mode=le;break;case Q:if(oe.wrap){for(;xe<32;){if(ye===0)break e;ye--,de|=Ue[T++]<<xe,xe+=8}if(Oe-=X,pe.total_out+=Oe,oe.total+=Oe,Oe&&(pe.adler=oe.check=oe.flags?n(oe.check,ze,Oe,me-Oe):f(oe.check,ze,Oe,me-Oe)),Oe=X,(oe.flags?de:ae(de))!==oe.check){pe.msg="incorrect data check",oe.mode=V;break}de=0,xe=0}oe.mode=re;case re:if(oe.wrap&&oe.flags){for(;xe<32;){if(ye===0)break e;ye--,de+=Ue[T++]<<xe,xe+=8}if(de!==(oe.total&4294967295)){pe.msg="incorrect length check",oe.mode=V;break}de=0,xe=0}oe.mode=te;case te:gt=u;break e;case V:gt=_;break e;case z:return w;case B:default:return p}return pe.next_out=me,pe.avail_out=X,pe.next_in=T,pe.avail_in=ye,oe.hold=de,oe.bits=xe,(oe.wsize||Oe!==pe.avail_out&&oe.mode<V&&(oe.mode<Q||we!==e))&&Ae(pe,pe.output,pe.next_out,Oe-pe.avail_out),Pe-=pe.avail_in,Oe-=pe.avail_out,pe.total_in+=Pe,pe.total_out+=Oe,oe.total+=Oe,oe.wrap&&Oe&&(pe.adler=oe.check=oe.flags?n(oe.check,ze,Oe,pe.next_out-Oe):f(oe.check,ze,Oe,pe.next_out-Oe)),pe.data_type=oe.bits+(oe.last?64:0)+(oe.mode===H?128:0)+(oe.mode===ne||oe.mode===J?256:0),(Pe===0&&Oe===0||we===e)&&gt===c&&(gt=S),gt}function be(pe){if(!pe||!pe.state)return p;var we=pe.state;return we.window&&(we.window=null),pe.state=null,c}function ge(pe,we){var oe;return!pe||!pe.state||(oe=pe.state,!(oe.wrap&2))?p:(oe.head=we,we.done=!1,c)}function ke(pe,we){var oe=we.length,Ue,ze,T;return!pe||!pe.state||(Ue=pe.state,Ue.wrap!==0&&Ue.mode!==A)?p:Ue.mode===A&&(ze=1,ze=f(ze,we,oe,0),ze!==Ue.check)?_:(T=Ae(pe,we,oe,oe),T?(Ue.mode=z,w):(Ue.havedict=1,c))}g.inflateReset=_e,g.inflateReset2=Te,g.inflateResetKeep=ve,g.inflateInit=Le,g.inflateInit2=Re,g.inflate=$,g.inflateEnd=be,g.inflateGetHeader=ge,g.inflateSetDictionary=ke,g.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":36,"./adler32":37,"./crc32":39,"./inffast":41,"./inftrees":43}],43:[function(m,x,g){var b=m("../utils/common"),f=15,n=852,o=592,a=0,t=1,i=2,r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];x.exports=function(u,h,p,_,w,S,C,E){var k=E.bits,O=0,U=0,F=0,M=0,j=0,G=0,N=0,R=0,A=0,H=0,Z,K,J,D,I,W=null,q=0,ne,le=new b.Buf16(f+1),ce=new b.Buf16(f+1),fe=null,he=0,se,ie,Q;for(O=0;O<=f;O++)le[O]=0;for(U=0;U<_;U++)le[h[p+U]]++;for(j=k,M=f;M>=1&&le[M]===0;M--);if(j>M&&(j=M),M===0)return w[S++]=1<<24|64<<16|0,w[S++]=1<<24|64<<16|0,E.bits=1,0;for(F=1;F<M&&le[F]===0;F++);for(j<F&&(j=F),R=1,O=1;O<=f;O++)if(R<<=1,R-=le[O],R<0)return-1;if(R>0&&(u===a||M!==1))return-1;for(ce[1]=0,O=1;O<f;O++)ce[O+1]=ce[O]+le[O];for(U=0;U<_;U++)h[p+U]!==0&&(C[ce[h[p+U]]++]=U);if(u===a?(W=fe=C,ne=19):u===t?(W=r,q-=257,fe=e,he-=257,ne=256):(W=l,fe=s,ne=-1),H=0,U=0,O=F,I=S,G=j,N=0,J=-1,A=1<<j,D=A-1,u===t&&A>n||u===i&&A>o)return 1;for(;;){se=O-N,C[U]<ne?(ie=0,Q=C[U]):C[U]>ne?(ie=fe[he+C[U]],Q=W[q+C[U]]):(ie=32+64,Q=0),Z=1<<O-N,K=1<<G,F=K;do K-=Z,w[I+(H>>N)+K]=se<<24|ie<<16|Q|0;while(K!==0);for(Z=1<<O-1;H&Z;)Z>>=1;if(Z!==0?(H&=Z-1,H+=Z):H=0,U++,--le[O]===0){if(O===M)break;O=h[p+C[U]]}if(O>j&&(H&D)!==J){for(N===0&&(N=j),I+=F,G=O-N,R=1<<G;G+N<M&&(R-=le[G+N],!(R<=0));)G++,R<<=1;if(A+=1<<G,u===t&&A>n||u===i&&A>o)return 1;J=H&D,w[J]=j<<24|G<<16|I-S|0}}return H!==0&&(w[I+H]=O-N<<24|64<<16|0),E.bits=j,0}},{"../utils/common":36}],44:[function(m,x,g){x.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],45:[function(m,x,g){var b=m("../utils/common"),f=4,n=0,o=1,a=2;function t($){for(var be=$.length;--be>=0;)$[be]=0}var i=0,r=1,e=2,l=3,s=258,c=29,u=256,h=u+1+c,p=30,_=19,w=2*h+1,S=15,C=16,E=7,k=256,O=16,U=17,F=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=512,A=new Array((h+2)*2);t(A);var H=new Array(p*2);t(H);var Z=new Array(R);t(Z);var K=new Array(s-l+1);t(K);var J=new Array(c);t(J);var D=new Array(p);t(D);function I($,be,ge,ke,pe){this.static_tree=$,this.extra_bits=be,this.extra_base=ge,this.elems=ke,this.max_length=pe,this.has_stree=$&&$.length}var W,q,ne;function le($,be){this.dyn_tree=$,this.max_code=0,this.stat_desc=be}function ce($){return $<256?Z[$]:Z[256+($>>>7)]}function fe($,be){$.pending_buf[$.pending++]=be&255,$.pending_buf[$.pending++]=be>>>8&255}function he($,be,ge){$.bi_valid>C-ge?($.bi_buf|=be<<$.bi_valid&65535,fe($,$.bi_buf),$.bi_buf=be>>C-$.bi_valid,$.bi_valid+=ge-C):($.bi_buf|=be<<$.bi_valid&65535,$.bi_valid+=ge)}function se($,be,ge){he($,ge[be*2],ge[be*2+1])}function ie($,be){var ge=0;do ge|=$&1,$>>>=1,ge<<=1;while(--be>0);return ge>>>1}function Q($){$.bi_valid===16?(fe($,$.bi_buf),$.bi_buf=0,$.bi_valid=0):$.bi_valid>=8&&($.pending_buf[$.pending++]=$.bi_buf&255,$.bi_buf>>=8,$.bi_valid-=8)}function re($,be){var ge=be.dyn_tree,ke=be.max_code,pe=be.stat_desc.static_tree,we=be.stat_desc.has_stree,oe=be.stat_desc.extra_bits,Ue=be.stat_desc.extra_base,ze=be.stat_desc.max_length,T,me,ye,X,de,xe,Pe=0;for(X=0;X<=S;X++)$.bl_count[X]=0;for(ge[$.heap[$.heap_max]*2+1]=0,T=$.heap_max+1;T<w;T++)me=$.heap[T],X=ge[ge[me*2+1]*2+1]+1,X>ze&&(X=ze,Pe++),ge[me*2+1]=X,!(me>ke)&&($.bl_count[X]++,de=0,me>=Ue&&(de=oe[me-Ue]),xe=ge[me*2],$.opt_len+=xe*(X+de),we&&($.static_len+=xe*(pe[me*2+1]+de)));if(Pe!==0){do{for(X=ze-1;$.bl_count[X]===0;)X--;$.bl_count[X]--,$.bl_count[X+1]+=2,$.bl_count[ze]--,Pe-=2}while(Pe>0);for(X=ze;X!==0;X--)for(me=$.bl_count[X];me!==0;)ye=$.heap[--T],!(ye>ke)&&(ge[ye*2+1]!==X&&($.opt_len+=(X-ge[ye*2+1])*ge[ye*2],ge[ye*2+1]=X),me--)}}function te($,be,ge){var ke=new Array(S+1),pe=0,we,oe;for(we=1;we<=S;we++)ke[we]=pe=pe+ge[we-1]<<1;for(oe=0;oe<=be;oe++){var Ue=$[oe*2+1];Ue!==0&&($[oe*2]=ie(ke[Ue]++,Ue))}}function V(){var $,be,ge,ke,pe,we=new Array(S+1);for(ge=0,ke=0;ke<c-1;ke++)for(J[ke]=ge,$=0;$<1<<M[ke];$++)K[ge++]=ke;for(K[ge-1]=ke,pe=0,ke=0;ke<16;ke++)for(D[ke]=pe,$=0;$<1<<j[ke];$++)Z[pe++]=ke;for(pe>>=7;ke<p;ke++)for(D[ke]=pe<<7,$=0;$<1<<j[ke]-7;$++)Z[256+pe++]=ke;for(be=0;be<=S;be++)we[be]=0;for($=0;$<=143;)A[$*2+1]=8,$++,we[8]++;for(;$<=255;)A[$*2+1]=9,$++,we[9]++;for(;$<=279;)A[$*2+1]=7,$++,we[7]++;for(;$<=287;)A[$*2+1]=8,$++,we[8]++;for(te(A,h+1,we),$=0;$<p;$++)H[$*2+1]=5,H[$*2]=ie($,5);W=new I(A,M,u+1,h,S),q=new I(H,j,0,p,S),ne=new I(new Array(0),G,0,_,E)}function z($){var be;for(be=0;be<h;be++)$.dyn_ltree[be*2]=0;for(be=0;be<p;be++)$.dyn_dtree[be*2]=0;for(be=0;be<_;be++)$.bl_tree[be*2]=0;$.dyn_ltree[k*2]=1,$.opt_len=$.static_len=0,$.last_lit=$.matches=0}function B($){$.bi_valid>8?fe($,$.bi_buf):$.bi_valid>0&&($.pending_buf[$.pending++]=$.bi_buf),$.bi_buf=0,$.bi_valid=0}function ee($,be,ge,ke){B($),ke&&(fe($,ge),fe($,~ge)),b.arraySet($.pending_buf,$.window,be,ge,$.pending),$.pending+=ge}function Y($,be,ge,ke){var pe=be*2,we=ge*2;return $[pe]<$[we]||$[pe]===$[we]&&ke[be]<=ke[ge]}function L($,be,ge){for(var ke=$.heap[ge],pe=ge<<1;pe<=$.heap_len&&(pe<$.heap_len&&Y(be,$.heap[pe+1],$.heap[pe],$.depth)&&pe++,!Y(be,ke,$.heap[pe],$.depth));)$.heap[ge]=$.heap[pe],ge=pe,pe<<=1;$.heap[ge]=ke}function P($,be,ge){var ke,pe,we=0,oe,Ue;if($.last_lit!==0)do ke=$.pending_buf[$.d_buf+we*2]<<8|$.pending_buf[$.d_buf+we*2+1],pe=$.pending_buf[$.l_buf+we],we++,ke===0?se($,pe,be):(oe=K[pe],se($,oe+u+1,be),Ue=M[oe],Ue!==0&&(pe-=J[oe],he($,pe,Ue)),ke--,oe=ce(ke),se($,oe,ge),Ue=j[oe],Ue!==0&&(ke-=D[oe],he($,ke,Ue)));while(we<$.last_lit);se($,k,be)}function ae($,be){var ge=be.dyn_tree,ke=be.stat_desc.static_tree,pe=be.stat_desc.has_stree,we=be.stat_desc.elems,oe,Ue,ze=-1,T;for($.heap_len=0,$.heap_max=w,oe=0;oe<we;oe++)ge[oe*2]!==0?($.heap[++$.heap_len]=ze=oe,$.depth[oe]=0):ge[oe*2+1]=0;for(;$.heap_len<2;)T=$.heap[++$.heap_len]=ze<2?++ze:0,ge[T*2]=1,$.depth[T]=0,$.opt_len--,pe&&($.static_len-=ke[T*2+1]);for(be.max_code=ze,oe=$.heap_len>>1;oe>=1;oe--)L($,ge,oe);T=we;do oe=$.heap[1],$.heap[1]=$.heap[$.heap_len--],L($,ge,1),Ue=$.heap[1],$.heap[--$.heap_max]=oe,$.heap[--$.heap_max]=Ue,ge[T*2]=ge[oe*2]+ge[Ue*2],$.depth[T]=($.depth[oe]>=$.depth[Ue]?$.depth[oe]:$.depth[Ue])+1,ge[oe*2+1]=ge[Ue*2+1]=T,$.heap[1]=T++,L($,ge,1);while($.heap_len>=2);$.heap[--$.heap_max]=$.heap[1],re($,be),te(ge,ze,$.bl_count)}function ue($,be,ge){var ke,pe=-1,we,oe=be[0*2+1],Ue=0,ze=7,T=4;for(oe===0&&(ze=138,T=3),be[(ge+1)*2+1]=65535,ke=0;ke<=ge;ke++)we=oe,oe=be[(ke+1)*2+1],!(++Ue<ze&&we===oe)&&(Ue<T?$.bl_tree[we*2]+=Ue:we!==0?(we!==pe&&$.bl_tree[we*2]++,$.bl_tree[O*2]++):Ue<=10?$.bl_tree[U*2]++:$.bl_tree[F*2]++,Ue=0,pe=we,oe===0?(ze=138,T=3):we===oe?(ze=6,T=3):(ze=7,T=4))}function ve($,be,ge){var ke,pe=-1,we,oe=be[0*2+1],Ue=0,ze=7,T=4;for(oe===0&&(ze=138,T=3),ke=0;ke<=ge;ke++)if(we=oe,oe=be[(ke+1)*2+1],!(++Ue<ze&&we===oe)){if(Ue<T)do se($,we,$.bl_tree);while(--Ue!==0);else we!==0?(we!==pe&&(se($,we,$.bl_tree),Ue--),se($,O,$.bl_tree),he($,Ue-3,2)):Ue<=10?(se($,U,$.bl_tree),he($,Ue-3,3)):(se($,F,$.bl_tree),he($,Ue-11,7));Ue=0,pe=we,oe===0?(ze=138,T=3):we===oe?(ze=6,T=3):(ze=7,T=4)}}function _e($){var be;for(ue($,$.dyn_ltree,$.l_desc.max_code),ue($,$.dyn_dtree,$.d_desc.max_code),ae($,$.bl_desc),be=_-1;be>=3&&$.bl_tree[N[be]*2+1]===0;be--);return $.opt_len+=3*(be+1)+5+5+4,be}function Te($,be,ge,ke){var pe;for(he($,be-257,5),he($,ge-1,5),he($,ke-4,4),pe=0;pe<ke;pe++)he($,$.bl_tree[N[pe]*2+1],3);ve($,$.dyn_ltree,be-1),ve($,$.dyn_dtree,ge-1)}function Re($){var be=4093624447,ge;for(ge=0;ge<=31;ge++,be>>>=1)if(be&1&&$.dyn_ltree[ge*2]!==0)return n;if($.dyn_ltree[9*2]!==0||$.dyn_ltree[10*2]!==0||$.dyn_ltree[13*2]!==0)return o;for(ge=32;ge<u;ge++)if($.dyn_ltree[ge*2]!==0)return o;return n}var Le=!1;function Se($){Le||(V(),Le=!0),$.l_desc=new le($.dyn_ltree,W),$.d_desc=new le($.dyn_dtree,q),$.bl_desc=new le($.bl_tree,ne),$.bi_buf=0,$.bi_valid=0,z($)}function Ee($,be,ge,ke){he($,(i<<1)+(ke?1:0),3),ee($,be,ge,!0)}function Ce($){he($,r<<1,3),se($,k,A),Q($)}function Ie($,be,ge,ke){var pe,we,oe=0;$.level>0?($.strm.data_type===a&&($.strm.data_type=Re($)),ae($,$.l_desc),ae($,$.d_desc),oe=_e($),pe=$.opt_len+3+7>>>3,we=$.static_len+3+7>>>3,we<=pe&&(pe=we)):pe=we=ge+5,ge+4<=pe&&be!==-1?Ee($,be,ge,ke):$.strategy===f||we===pe?(he($,(r<<1)+(ke?1:0),3),P($,A,H)):(he($,(e<<1)+(ke?1:0),3),Te($,$.l_desc.max_code+1,$.d_desc.max_code+1,oe+1),P($,$.dyn_ltree,$.dyn_dtree)),z($),ke&&B($)}function Ae($,be,ge){return $.pending_buf[$.d_buf+$.last_lit*2]=be>>>8&255,$.pending_buf[$.d_buf+$.last_lit*2+1]=be&255,$.pending_buf[$.l_buf+$.last_lit]=ge&255,$.last_lit++,be===0?$.dyn_ltree[ge*2]++:($.matches++,be--,$.dyn_ltree[(K[ge]+u+1)*2]++,$.dyn_dtree[ce(be)*2]++),$.last_lit===$.lit_bufsize-1}g._tr_init=Se,g._tr_stored_block=Ee,g._tr_flush_block=Ie,g._tr_tally=Ae,g._tr_align=Ce},{"../utils/common":36}],46:[function(m,x,g){function b(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}x.exports=b},{}],47:[function(m,x,g){arguments[4][33][0].apply(g,arguments)},{dup:33}],48:[function(m,x,g){(function(r){var f=m("base64-js"),n=m("ieee754"),o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;g.Buffer=r,g.SlowBuffer=S,g.INSPECT_MAX_BYTES=50;var a=2147483647;g.kMaxLength=a,r.TYPED_ARRAY_SUPPORT=t(),!r.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function t(){try{var Y=new Uint8Array(1),L={foo:function(){return 42}};return Object.setPrototypeOf(L,Uint8Array.prototype),Object.setPrototypeOf(Y,L),Y.foo()===42}catch(P){return!1}}Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}});function i(Y){if(Y>a)throw new RangeError('The value "'+Y+'" is invalid for option "size"');var L=new Uint8Array(Y);return Object.setPrototypeOf(L,r.prototype),L}function r(Y,L,P){if(typeof Y=="number"){if(typeof L=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return c(Y)}return e(Y,L,P)}typeof Symbol<"u"&&Symbol.species!=null&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192;function e(Y,L,P){if(typeof Y=="string")return u(Y,L);if(ArrayBuffer.isView(Y))return h(Y);if(Y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y);if(z(Y,ArrayBuffer)||Y&&z(Y.buffer,ArrayBuffer))return p(Y,L,P);if(typeof Y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ae=Y.valueOf&&Y.valueOf();if(ae!=null&&ae!==Y)return r.from(ae,L,P);var ue=_(Y);if(ue)return ue;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Y[Symbol.toPrimitive]=="function")return r.from(Y[Symbol.toPrimitive]("string"),L,P);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y)}r.from=function(Y,L,P){return e(Y,L,P)},Object.setPrototypeOf(r.prototype,Uint8Array.prototype),Object.setPrototypeOf(r,Uint8Array);function l(Y){if(typeof Y!="number")throw new TypeError('"size" argument must be of type number');if(Y<0)throw new RangeError('The value "'+Y+'" is invalid for option "size"')}function s(Y,L,P){return l(Y),Y<=0?i(Y):L!==void 0?typeof P=="string"?i(Y).fill(L,P):i(Y).fill(L):i(Y)}r.alloc=function(Y,L,P){return s(Y,L,P)};function c(Y){return l(Y),i(Y<0?0:w(Y)|0)}r.allocUnsafe=function(Y){return c(Y)},r.allocUnsafeSlow=function(Y){return c(Y)};function u(Y,L){if((typeof L!="string"||L==="")&&(L="utf8"),!r.isEncoding(L))throw new TypeError("Unknown encoding: "+L);var P=C(Y,L)|0,ae=i(P),ue=ae.write(Y,L);return ue!==P&&(ae=ae.slice(0,ue)),ae}function h(Y){for(var L=Y.length<0?0:w(Y.length)|0,P=i(L),ae=0;ae<L;ae+=1)P[ae]=Y[ae]&255;return P}function p(Y,L,P){if(L<0||Y.byteLength<L)throw new RangeError('"offset" is outside of buffer bounds');if(Y.byteLength<L+(P||0))throw new RangeError('"length" is outside of buffer bounds');var ae;return L===void 0&&P===void 0?ae=new Uint8Array(Y):P===void 0?ae=new Uint8Array(Y,L):ae=new Uint8Array(Y,L,P),Object.setPrototypeOf(ae,r.prototype),ae}function _(Y){if(r.isBuffer(Y)){var L=w(Y.length)|0,P=i(L);return P.length===0||Y.copy(P,0,0,L),P}if(Y.length!==void 0)return typeof Y.length!="number"||B(Y.length)?i(0):h(Y);if(Y.type==="Buffer"&&Array.isArray(Y.data))return h(Y.data)}function w(Y){if(Y>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return Y|0}function S(Y){return+Y!=Y&&(Y=0),r.alloc(+Y)}r.isBuffer=function(L){return L!=null&&L._isBuffer===!0&&L!==r.prototype},r.compare=function(L,P){if(z(L,Uint8Array)&&(L=r.from(L,L.offset,L.byteLength)),z(P,Uint8Array)&&(P=r.from(P,P.offset,P.byteLength)),!r.isBuffer(L)||!r.isBuffer(P))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(L===P)return 0;for(var ae=L.length,ue=P.length,ve=0,_e=Math.min(ae,ue);ve<_e;++ve)if(L[ve]!==P[ve]){ae=L[ve],ue=P[ve];break}return ae<ue?-1:ue<ae?1:0},r.isEncoding=function(L){switch(String(L).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(L,P){if(!Array.isArray(L))throw new TypeError('"list" argument must be an Array of Buffers');if(L.length===0)return r.alloc(0);var ae;if(P===void 0)for(P=0,ae=0;ae<L.length;++ae)P+=L[ae].length;var ue=r.allocUnsafe(P),ve=0;for(ae=0;ae<L.length;++ae){var _e=L[ae];if(z(_e,Uint8Array)&&(_e=r.from(_e)),!r.isBuffer(_e))throw new TypeError('"list" argument must be an Array of Buffers');_e.copy(ue,ve),ve+=_e.length}return ue};function C(Y,L){if(r.isBuffer(Y))return Y.length;if(ArrayBuffer.isView(Y)||z(Y,ArrayBuffer))return Y.byteLength;if(typeof Y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Y);var P=Y.length,ae=arguments.length>2&&arguments[2]===!0;if(!ae&&P===0)return 0;for(var ue=!1;;)switch(L){case"ascii":case"latin1":case"binary":return P;case"utf8":case"utf-8":return ie(Y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P*2;case"hex":return P>>>1;case"base64":return te(Y).length;default:if(ue)return ae?-1:ie(Y).length;L=(""+L).toLowerCase(),ue=!0}}r.byteLength=C;function E(Y,L,P){var ae=!1;if((L===void 0||L<0)&&(L=0),L>this.length||((P===void 0||P>this.length)&&(P=this.length),P<=0)||(P>>>=0,L>>>=0,P<=L))return"";for(Y||(Y="utf8");;)switch(Y){case"hex":return I(this,L,P);case"utf8":case"utf-8":return H(this,L,P);case"ascii":return J(this,L,P);case"latin1":case"binary":return D(this,L,P);case"base64":return A(this,L,P);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,L,P);default:if(ae)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase(),ae=!0}}r.prototype._isBuffer=!0;function k(Y,L,P){var ae=Y[L];Y[L]=Y[P],Y[P]=ae}r.prototype.swap16=function(){var L=this.length;if(L%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var P=0;P<L;P+=2)k(this,P,P+1);return this},r.prototype.swap32=function(){var L=this.length;if(L%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var P=0;P<L;P+=4)k(this,P,P+3),k(this,P+1,P+2);return this},r.prototype.swap64=function(){var L=this.length;if(L%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var P=0;P<L;P+=8)k(this,P,P+7),k(this,P+1,P+6),k(this,P+2,P+5),k(this,P+3,P+4);return this},r.prototype.toString=function(){var L=this.length;return L===0?"":arguments.length===0?H(this,0,L):E.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(L){if(!r.isBuffer(L))throw new TypeError("Argument must be a Buffer");return this===L?!0:r.compare(this,L)===0},r.prototype.inspect=function(){var L="",P=g.INSPECT_MAX_BYTES;return L=this.toString("hex",0,P).replace(/(.{2})/g,"$1 ").trim(),this.length>P&&(L+=" ... "),"<Buffer "+L+">"},o&&(r.prototype[o]=r.prototype.inspect),r.prototype.compare=function(L,P,ae,ue,ve){if(z(L,Uint8Array)&&(L=r.from(L,L.offset,L.byteLength)),!r.isBuffer(L))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof L);if(P===void 0&&(P=0),ae===void 0&&(ae=L?L.length:0),ue===void 0&&(ue=0),ve===void 0&&(ve=this.length),P<0||ae>L.length||ue<0||ve>this.length)throw new RangeError("out of range index");if(ue>=ve&&P>=ae)return 0;if(ue>=ve)return-1;if(P>=ae)return 1;if(P>>>=0,ae>>>=0,ue>>>=0,ve>>>=0,this===L)return 0;for(var _e=ve-ue,Te=ae-P,Re=Math.min(_e,Te),Le=this.slice(ue,ve),Se=L.slice(P,ae),Ee=0;Ee<Re;++Ee)if(Le[Ee]!==Se[Ee]){_e=Le[Ee],Te=Se[Ee];break}return _e<Te?-1:Te<_e?1:0};function O(Y,L,P,ae,ue){if(Y.length===0)return-1;if(typeof P=="string"?(ae=P,P=0):P>2147483647?P=2147483647:P<-2147483648&&(P=-2147483648),P=+P,B(P)&&(P=ue?0:Y.length-1),P<0&&(P=Y.length+P),P>=Y.length){if(ue)return-1;P=Y.length-1}else if(P<0)if(ue)P=0;else return-1;if(typeof L=="string"&&(L=r.from(L,ae)),r.isBuffer(L))return L.length===0?-1:U(Y,L,P,ae,ue);if(typeof L=="number")return L=L&255,typeof Uint8Array.prototype.indexOf=="function"?ue?Uint8Array.prototype.indexOf.call(Y,L,P):Uint8Array.prototype.lastIndexOf.call(Y,L,P):U(Y,[L],P,ae,ue);throw new TypeError("val must be string, number or Buffer")}function U(Y,L,P,ae,ue){var ve=1,_e=Y.length,Te=L.length;if(ae!==void 0&&(ae=String(ae).toLowerCase(),ae==="ucs2"||ae==="ucs-2"||ae==="utf16le"||ae==="utf-16le")){if(Y.length<2||L.length<2)return-1;ve=2,_e/=2,Te/=2,P/=2}function Re(Ie,Ae){return ve===1?Ie[Ae]:Ie.readUInt16BE(Ae*ve)}var Le;if(ue){var Se=-1;for(Le=P;Le<_e;Le++)if(Re(Y,Le)===Re(L,Se===-1?0:Le-Se)){if(Se===-1&&(Se=Le),Le-Se+1===Te)return Se*ve}else Se!==-1&&(Le-=Le-Se),Se=-1}else for(P+Te>_e&&(P=_e-Te),Le=P;Le>=0;Le--){for(var Ee=!0,Ce=0;Ce<Te;Ce++)if(Re(Y,Le+Ce)!==Re(L,Ce)){Ee=!1;break}if(Ee)return Le}return-1}r.prototype.includes=function(L,P,ae){return this.indexOf(L,P,ae)!==-1},r.prototype.indexOf=function(L,P,ae){return O(this,L,P,ae,!0)},r.prototype.lastIndexOf=function(L,P,ae){return O(this,L,P,ae,!1)};function F(Y,L,P,ae){P=Number(P)||0;var ue=Y.length-P;ae?(ae=Number(ae),ae>ue&&(ae=ue)):ae=ue;var ve=L.length;ae>ve/2&&(ae=ve/2);for(var _e=0;_e<ae;++_e){var Te=parseInt(L.substr(_e*2,2),16);if(B(Te))return _e;Y[P+_e]=Te}return _e}function M(Y,L,P,ae){return V(ie(L,Y.length-P),Y,P,ae)}function j(Y,L,P,ae){return V(Q(L),Y,P,ae)}function G(Y,L,P,ae){return j(Y,L,P,ae)}function N(Y,L,P,ae){return V(te(L),Y,P,ae)}function R(Y,L,P,ae){return V(re(L,Y.length-P),Y,P,ae)}r.prototype.write=function(L,P,ae,ue){if(P===void 0)ue="utf8",ae=this.length,P=0;else if(ae===void 0&&typeof P=="string")ue=P,ae=this.length,P=0;else if(isFinite(P))P=P>>>0,isFinite(ae)?(ae=ae>>>0,ue===void 0&&(ue="utf8")):(ue=ae,ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ve=this.length-P;if((ae===void 0||ae>ve)&&(ae=ve),L.length>0&&(ae<0||P<0)||P>this.length)throw new RangeError("Attempt to write outside buffer bounds");ue||(ue="utf8");for(var _e=!1;;)switch(ue){case"hex":return F(this,L,P,ae);case"utf8":case"utf-8":return M(this,L,P,ae);case"ascii":return j(this,L,P,ae);case"latin1":case"binary":return G(this,L,P,ae);case"base64":return N(this,L,P,ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,L,P,ae);default:if(_e)throw new TypeError("Unknown encoding: "+ue);ue=(""+ue).toLowerCase(),_e=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(Y,L,P){return L===0&&P===Y.length?f.fromByteArray(Y):f.fromByteArray(Y.slice(L,P))}function H(Y,L,P){P=Math.min(Y.length,P);for(var ae=[],ue=L;ue<P;){var ve=Y[ue],_e=null,Te=ve>239?4:ve>223?3:ve>191?2:1;if(ue+Te<=P){var Re,Le,Se,Ee;switch(Te){case 1:ve<128&&(_e=ve);break;case 2:Re=Y[ue+1],(Re&192)===128&&(Ee=(ve&31)<<6|Re&63,Ee>127&&(_e=Ee));break;case 3:Re=Y[ue+1],Le=Y[ue+2],(Re&192)===128&&(Le&192)===128&&(Ee=(ve&15)<<12|(Re&63)<<6|Le&63,Ee>2047&&(Ee<55296||Ee>57343)&&(_e=Ee));break;case 4:Re=Y[ue+1],Le=Y[ue+2],Se=Y[ue+3],(Re&192)===128&&(Le&192)===128&&(Se&192)===128&&(Ee=(ve&15)<<18|(Re&63)<<12|(Le&63)<<6|Se&63,Ee>65535&&Ee<1114112&&(_e=Ee))}}_e===null?(_e=65533,Te=1):_e>65535&&(_e-=65536,ae.push(_e>>>10&1023|55296),_e=56320|_e&1023),ae.push(_e),ue+=Te}return K(ae)}var Z=4096;function K(Y){var L=Y.length;if(L<=Z)return String.fromCharCode.apply(String,Y);for(var P="",ae=0;ae<L;)P+=String.fromCharCode.apply(String,Y.slice(ae,ae+=Z));return P}function J(Y,L,P){var ae="";P=Math.min(Y.length,P);for(var ue=L;ue<P;++ue)ae+=String.fromCharCode(Y[ue]&127);return ae}function D(Y,L,P){var ae="";P=Math.min(Y.length,P);for(var ue=L;ue<P;++ue)ae+=String.fromCharCode(Y[ue]);return ae}function I(Y,L,P){var ae=Y.length;(!L||L<0)&&(L=0),(!P||P<0||P>ae)&&(P=ae);for(var ue="",ve=L;ve<P;++ve)ue+=ee[Y[ve]];return ue}function W(Y,L,P){for(var ae=Y.slice(L,P),ue="",ve=0;ve<ae.length;ve+=2)ue+=String.fromCharCode(ae[ve]+ae[ve+1]*256);return ue}r.prototype.slice=function(L,P){var ae=this.length;L=~~L,P=P===void 0?ae:~~P,L<0?(L+=ae,L<0&&(L=0)):L>ae&&(L=ae),P<0?(P+=ae,P<0&&(P=0)):P>ae&&(P=ae),P<L&&(P=L);var ue=this.subarray(L,P);return Object.setPrototypeOf(ue,r.prototype),ue};function q(Y,L,P){if(Y%1!==0||Y<0)throw new RangeError("offset is not uint");if(Y+L>P)throw new RangeError("Trying to access beyond buffer length")}r.prototype.readUIntLE=function(L,P,ae){L=L>>>0,P=P>>>0,ae||q(L,P,this.length);for(var ue=this[L],ve=1,_e=0;++_e<P&&(ve*=256);)ue+=this[L+_e]*ve;return ue},r.prototype.readUIntBE=function(L,P,ae){L=L>>>0,P=P>>>0,ae||q(L,P,this.length);for(var ue=this[L+--P],ve=1;P>0&&(ve*=256);)ue+=this[L+--P]*ve;return ue},r.prototype.readUInt8=function(L,P){return L=L>>>0,P||q(L,1,this.length),this[L]},r.prototype.readUInt16LE=function(L,P){return L=L>>>0,P||q(L,2,this.length),this[L]|this[L+1]<<8},r.prototype.readUInt16BE=function(L,P){return L=L>>>0,P||q(L,2,this.length),this[L]<<8|this[L+1]},r.prototype.readUInt32LE=function(L,P){return L=L>>>0,P||q(L,4,this.length),(this[L]|this[L+1]<<8|this[L+2]<<16)+this[L+3]*16777216},r.prototype.readUInt32BE=function(L,P){return L=L>>>0,P||q(L,4,this.length),this[L]*16777216+(this[L+1]<<16|this[L+2]<<8|this[L+3])},r.prototype.readIntLE=function(L,P,ae){L=L>>>0,P=P>>>0,ae||q(L,P,this.length);for(var ue=this[L],ve=1,_e=0;++_e<P&&(ve*=256);)ue+=this[L+_e]*ve;return ve*=128,ue>=ve&&(ue-=Math.pow(2,8*P)),ue},r.prototype.readIntBE=function(L,P,ae){L=L>>>0,P=P>>>0,ae||q(L,P,this.length);for(var ue=P,ve=1,_e=this[L+--ue];ue>0&&(ve*=256);)_e+=this[L+--ue]*ve;return ve*=128,_e>=ve&&(_e-=Math.pow(2,8*P)),_e},r.prototype.readInt8=function(L,P){return L=L>>>0,P||q(L,1,this.length),this[L]&128?(255-this[L]+1)*-1:this[L]},r.prototype.readInt16LE=function(L,P){L=L>>>0,P||q(L,2,this.length);var ae=this[L]|this[L+1]<<8;return ae&32768?ae|4294901760:ae},r.prototype.readInt16BE=function(L,P){L=L>>>0,P||q(L,2,this.length);var ae=this[L+1]|this[L]<<8;return ae&32768?ae|4294901760:ae},r.prototype.readInt32LE=function(L,P){return L=L>>>0,P||q(L,4,this.length),this[L]|this[L+1]<<8|this[L+2]<<16|this[L+3]<<24},r.prototype.readInt32BE=function(L,P){return L=L>>>0,P||q(L,4,this.length),this[L]<<24|this[L+1]<<16|this[L+2]<<8|this[L+3]},r.prototype.readFloatLE=function(L,P){return L=L>>>0,P||q(L,4,this.length),n.read(this,L,!0,23,4)},r.prototype.readFloatBE=function(L,P){return L=L>>>0,P||q(L,4,this.length),n.read(this,L,!1,23,4)},r.prototype.readDoubleLE=function(L,P){return L=L>>>0,P||q(L,8,this.length),n.read(this,L,!0,52,8)},r.prototype.readDoubleBE=function(L,P){return L=L>>>0,P||q(L,8,this.length),n.read(this,L,!1,52,8)};function ne(Y,L,P,ae,ue,ve){if(!r.isBuffer(Y))throw new TypeError('"buffer" argument must be a Buffer instance');if(L>ue||L<ve)throw new RangeError('"value" argument is out of bounds');if(P+ae>Y.length)throw new RangeError("Index out of range")}r.prototype.writeUIntLE=function(L,P,ae,ue){if(L=+L,P=P>>>0,ae=ae>>>0,!ue){var ve=Math.pow(2,8*ae)-1;ne(this,L,P,ae,ve,0)}var _e=1,Te=0;for(this[P]=L&255;++Te<ae&&(_e*=256);)this[P+Te]=L/_e&255;return P+ae},r.prototype.writeUIntBE=function(L,P,ae,ue){if(L=+L,P=P>>>0,ae=ae>>>0,!ue){var ve=Math.pow(2,8*ae)-1;ne(this,L,P,ae,ve,0)}var _e=ae-1,Te=1;for(this[P+_e]=L&255;--_e>=0&&(Te*=256);)this[P+_e]=L/Te&255;return P+ae},r.prototype.writeUInt8=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,1,255,0),this[P]=L&255,P+1},r.prototype.writeUInt16LE=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,2,65535,0),this[P]=L&255,this[P+1]=L>>>8,P+2},r.prototype.writeUInt16BE=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,2,65535,0),this[P]=L>>>8,this[P+1]=L&255,P+2},r.prototype.writeUInt32LE=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,4,4294967295,0),this[P+3]=L>>>24,this[P+2]=L>>>16,this[P+1]=L>>>8,this[P]=L&255,P+4},r.prototype.writeUInt32BE=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,4,4294967295,0),this[P]=L>>>24,this[P+1]=L>>>16,this[P+2]=L>>>8,this[P+3]=L&255,P+4},r.prototype.writeIntLE=function(L,P,ae,ue){if(L=+L,P=P>>>0,!ue){var ve=Math.pow(2,8*ae-1);ne(this,L,P,ae,ve-1,-ve)}var _e=0,Te=1,Re=0;for(this[P]=L&255;++_e<ae&&(Te*=256);)L<0&&Re===0&&this[P+_e-1]!==0&&(Re=1),this[P+_e]=(L/Te>>0)-Re&255;return P+ae},r.prototype.writeIntBE=function(L,P,ae,ue){if(L=+L,P=P>>>0,!ue){var ve=Math.pow(2,8*ae-1);ne(this,L,P,ae,ve-1,-ve)}var _e=ae-1,Te=1,Re=0;for(this[P+_e]=L&255;--_e>=0&&(Te*=256);)L<0&&Re===0&&this[P+_e+1]!==0&&(Re=1),this[P+_e]=(L/Te>>0)-Re&255;return P+ae},r.prototype.writeInt8=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,1,127,-128),L<0&&(L=255+L+1),this[P]=L&255,P+1},r.prototype.writeInt16LE=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,2,32767,-32768),this[P]=L&255,this[P+1]=L>>>8,P+2},r.prototype.writeInt16BE=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,2,32767,-32768),this[P]=L>>>8,this[P+1]=L&255,P+2},r.prototype.writeInt32LE=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,4,2147483647,-2147483648),this[P]=L&255,this[P+1]=L>>>8,this[P+2]=L>>>16,this[P+3]=L>>>24,P+4},r.prototype.writeInt32BE=function(L,P,ae){return L=+L,P=P>>>0,ae||ne(this,L,P,4,2147483647,-2147483648),L<0&&(L=4294967295+L+1),this[P]=L>>>24,this[P+1]=L>>>16,this[P+2]=L>>>8,this[P+3]=L&255,P+4};function le(Y,L,P,ae,ue,ve){if(P+ae>Y.length)throw new RangeError("Index out of range");if(P<0)throw new RangeError("Index out of range")}function ce(Y,L,P,ae,ue){return L=+L,P=P>>>0,ue||le(Y,L,P,4),n.write(Y,L,P,ae,23,4),P+4}r.prototype.writeFloatLE=function(L,P,ae){return ce(this,L,P,!0,ae)},r.prototype.writeFloatBE=function(L,P,ae){return ce(this,L,P,!1,ae)};function fe(Y,L,P,ae,ue){return L=+L,P=P>>>0,ue||le(Y,L,P,8),n.write(Y,L,P,ae,52,8),P+8}r.prototype.writeDoubleLE=function(L,P,ae){return fe(this,L,P,!0,ae)},r.prototype.writeDoubleBE=function(L,P,ae){return fe(this,L,P,!1,ae)},r.prototype.copy=function(L,P,ae,ue){if(!r.isBuffer(L))throw new TypeError("argument should be a Buffer");if(ae||(ae=0),!ue&&ue!==0&&(ue=this.length),P>=L.length&&(P=L.length),P||(P=0),ue>0&&ue<ae&&(ue=ae),ue===ae||L.length===0||this.length===0)return 0;if(P<0)throw new RangeError("targetStart out of bounds");if(ae<0||ae>=this.length)throw new RangeError("Index out of range");if(ue<0)throw new RangeError("sourceEnd out of bounds");ue>this.length&&(ue=this.length),L.length-P<ue-ae&&(ue=L.length-P+ae);var ve=ue-ae;if(this===L&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(P,ae,ue);else if(this===L&&ae<P&&P<ue)for(var _e=ve-1;_e>=0;--_e)L[_e+P]=this[_e+ae];else Uint8Array.prototype.set.call(L,this.subarray(ae,ue),P);return ve},r.prototype.fill=function(L,P,ae,ue){if(typeof L=="string"){if(typeof P=="string"?(ue=P,P=0,ae=this.length):typeof ae=="string"&&(ue=ae,ae=this.length),ue!==void 0&&typeof ue!="string")throw new TypeError("encoding must be a string");if(typeof ue=="string"&&!r.isEncoding(ue))throw new TypeError("Unknown encoding: "+ue);if(L.length===1){var ve=L.charCodeAt(0);(ue==="utf8"&&ve<128||ue==="latin1")&&(L=ve)}}else typeof L=="number"?L=L&255:typeof L=="boolean"&&(L=Number(L));if(P<0||this.length<P||this.length<ae)throw new RangeError("Out of range index");if(ae<=P)return this;P=P>>>0,ae=ae===void 0?this.length:ae>>>0,L||(L=0);var _e;if(typeof L=="number")for(_e=P;_e<ae;++_e)this[_e]=L;else{var Te=r.isBuffer(L)?L:r.from(L,ue),Re=Te.length;if(Re===0)throw new TypeError('The value "'+L+'" is invalid for argument "value"');for(_e=0;_e<ae-P;++_e)this[_e+P]=Te[_e%Re]}return this};var he=/[^+/0-9A-Za-z-_]/g;function se(Y){if(Y=Y.split("=")[0],Y=Y.trim().replace(he,""),Y.length<2)return"";for(;Y.length%4!==0;)Y=Y+"=";return Y}function ie(Y,L){L=L||1/0;for(var P,ae=Y.length,ue=null,ve=[],_e=0;_e<ae;++_e){if(P=Y.charCodeAt(_e),P>55295&&P<57344){if(!ue){if(P>56319){(L-=3)>-1&&ve.push(239,191,189);continue}else if(_e+1===ae){(L-=3)>-1&&ve.push(239,191,189);continue}ue=P;continue}if(P<56320){(L-=3)>-1&&ve.push(239,191,189),ue=P;continue}P=(ue-55296<<10|P-56320)+65536}else ue&&(L-=3)>-1&&ve.push(239,191,189);if(ue=null,P<128){if((L-=1)<0)break;ve.push(P)}else if(P<2048){if((L-=2)<0)break;ve.push(P>>6|192,P&63|128)}else if(P<65536){if((L-=3)<0)break;ve.push(P>>12|224,P>>6&63|128,P&63|128)}else if(P<1114112){if((L-=4)<0)break;ve.push(P>>18|240,P>>12&63|128,P>>6&63|128,P&63|128)}else throw new Error("Invalid code point")}return ve}function Q(Y){for(var L=[],P=0;P<Y.length;++P)L.push(Y.charCodeAt(P)&255);return L}function re(Y,L){for(var P,ae,ue,ve=[],_e=0;_e<Y.length&&!((L-=2)<0);++_e)P=Y.charCodeAt(_e),ae=P>>8,ue=P%256,ve.push(ue),ve.push(ae);return ve}function te(Y){return f.toByteArray(se(Y))}function V(Y,L,P,ae){for(var ue=0;ue<ae&&!(ue+P>=L.length||ue>=Y.length);++ue)L[ue+P]=Y[ue];return ue}function z(Y,L){return Y instanceof L||Y!=null&&Y.constructor!=null&&Y.constructor.name!=null&&Y.constructor.name===L.name}function B(Y){return Y!==Y}var ee=function(){for(var Y="0123456789abcdef",L=new Array(256),P=0;P<16;++P)for(var ae=P*16,ue=0;ue<16;++ue)L[ae+ue]=Y[P]+Y[ue];return L}()}).call(this,m("buffer").Buffer)},{"base64-js":29,buffer:48,ieee754:73}],49:[function(m,x,g){var b=m("buffer").Buffer;x.exports=function(f,n){if(b.isBuffer(f)&&b.isBuffer(n)){if(typeof f.equals=="function")return f.equals(n);if(f.length!==n.length)return!1;for(var o=0;o<f.length;o++)if(f[o]!==n[o])return!1;return!0}}},{buffer:48}],50:[function(m,x,g){x.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],51:[function(m,x,g){(function(b){function f(w){return Array.isArray?Array.isArray(w):_(w)==="[object Array]"}g.isArray=f;function n(w){return typeof w=="boolean"}g.isBoolean=n;function o(w){return w===null}g.isNull=o;function a(w){return w==null}g.isNullOrUndefined=a;function t(w){return typeof w=="number"}g.isNumber=t;function i(w){return typeof w=="string"}g.isString=i;function r(w){return typeof w=="symbol"}g.isSymbol=r;function e(w){return w===void 0}g.isUndefined=e;function l(w){return _(w)==="[object RegExp]"}g.isRegExp=l;function s(w){return typeof w=="object"&&w!==null}g.isObject=s;function c(w){return _(w)==="[object Date]"}g.isDate=c;function u(w){return _(w)==="[object Error]"||w instanceof Error}g.isError=u;function h(w){return typeof w=="function"}g.isFunction=h;function p(w){return w===null||typeof w=="boolean"||typeof w=="number"||typeof w=="string"||typeof w=="symbol"||typeof w>"u"}g.isPrimitive=p,g.isBuffer=b.isBuffer;function _(w){return Object.prototype.toString.call(w)}}).call(this,{isBuffer:m("../../is-buffer/index.js")})},{"../../is-buffer/index.js":76}],52:[function(m,x,g){var b=Object.create||O,f=Object.keys||U,n=Function.prototype.bind||F;function o(){(!this._events||!Object.prototype.hasOwnProperty.call(this,"_events"))&&(this._events=b(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}x.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0;var a=10,t;try{var i={};Object.defineProperty&&Object.defineProperty(i,"x",{value:0}),t=i.x===0}catch(M){t=!1}t?Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(M){if(typeof M!="number"||M<0||M!==M)throw new TypeError('"defaultMaxListeners" must be a positive number');a=M}}):o.defaultMaxListeners=a,o.prototype.setMaxListeners=function(j){if(typeof j!="number"||j<0||isNaN(j))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=j,this};function r(M){return M._maxListeners===void 0?o.defaultMaxListeners:M._maxListeners}o.prototype.getMaxListeners=function(){return r(this)};function e(M,j,G){if(j)M.call(G);else for(var N=M.length,R=E(M,N),A=0;A<N;++A)R[A].call(G)}function l(M,j,G,N){if(j)M.call(G,N);else for(var R=M.length,A=E(M,R),H=0;H<R;++H)A[H].call(G,N)}function s(M,j,G,N,R){if(j)M.call(G,N,R);else for(var A=M.length,H=E(M,A),Z=0;Z<A;++Z)H[Z].call(G,N,R)}function c(M,j,G,N,R,A){if(j)M.call(G,N,R,A);else for(var H=M.length,Z=E(M,H),K=0;K<H;++K)Z[K].call(G,N,R,A)}function u(M,j,G,N){if(j)M.apply(G,N);else for(var R=M.length,A=E(M,R),H=0;H<R;++H)A[H].apply(G,N)}o.prototype.emit=function(j){var G,N,R,A,H,Z,K=j==="error";if(Z=this._events,Z)K=K&&Z.error==null;else if(!K)return!1;if(K){if(arguments.length>1&&(G=arguments[1]),G instanceof Error)throw G;var J=new Error('Unhandled "error" event. ('+G+")");throw J.context=G,J}if(N=Z[j],!N)return!1;var D=typeof N=="function";switch(R=arguments.length,R){case 1:e(N,D,this);break;case 2:l(N,D,this,arguments[1]);break;case 3:s(N,D,this,arguments[1],arguments[2]);break;case 4:c(N,D,this,arguments[1],arguments[2],arguments[3]);break;default:for(A=new Array(R-1),H=1;H<R;H++)A[H-1]=arguments[H];u(N,D,this,A)}return!0};function h(M,j,G,N){var R,A,H;if(typeof G!="function")throw new TypeError('"listener" argument must be a function');if(A=M._events,A?(A.newListener&&(M.emit("newListener",j,G.listener?G.listener:G),A=M._events),H=A[j]):(A=M._events=b(null),M._eventsCount=0),!H)H=A[j]=G,++M._eventsCount;else if(typeof H=="function"?H=A[j]=N?[G,H]:[H,G]:N?H.unshift(G):H.push(G),!H.warned&&(R=r(M),R&&R>0&&H.length>R)){H.warned=!0;var Z=new Error("Possible EventEmitter memory leak detected. "+H.length+' "'+String(j)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');Z.name="MaxListenersExceededWarning",Z.emitter=M,Z.type=j,Z.count=H.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",Z.name,Z.message)}return M}o.prototype.addListener=function(j,G){return h(this,j,G,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(j,G){return h(this,j,G,!0)};function p(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var M=new Array(arguments.length),j=0;j<M.length;++j)M[j]=arguments[j];this.listener.apply(this.target,M)}}function _(M,j,G){var N={fired:!1,wrapFn:void 0,target:M,type:j,listener:G},R=n.call(p,N);return R.listener=G,N.wrapFn=R,R}o.prototype.once=function(j,G){if(typeof G!="function")throw new TypeError('"listener" argument must be a function');return this.on(j,_(this,j,G)),this},o.prototype.prependOnceListener=function(j,G){if(typeof G!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(j,_(this,j,G)),this},o.prototype.removeListener=function(j,G){var N,R,A,H,Z;if(typeof G!="function")throw new TypeError('"listener" argument must be a function');if(R=this._events,!R)return this;if(N=R[j],!N)return this;if(N===G||N.listener===G)--this._eventsCount===0?this._events=b(null):(delete R[j],R.removeListener&&this.emit("removeListener",j,N.listener||G));else if(typeof N!="function"){for(A=-1,H=N.length-1;H>=0;H--)if(N[H]===G||N[H].listener===G){Z=N[H].listener,A=H;break}if(A<0)return this;A===0?N.shift():C(N,A),N.length===1&&(R[j]=N[0]),R.removeListener&&this.emit("removeListener",j,Z||G)}return this},o.prototype.removeAllListeners=function(j){var G,N,R;if(N=this._events,!N)return this;if(!N.removeListener)return arguments.length===0?(this._events=b(null),this._eventsCount=0):N[j]&&(--this._eventsCount===0?this._events=b(null):delete N[j]),this;if(arguments.length===0){var A=f(N),H;for(R=0;R<A.length;++R)H=A[R],H!=="removeListener"&&this.removeAllListeners(H);return this.removeAllListeners("removeListener"),this._events=b(null),this._eventsCount=0,this}if(G=N[j],typeof G=="function")this.removeListener(j,G);else if(G)for(R=G.length-1;R>=0;R--)this.removeListener(j,G[R]);return this};function w(M,j,G){var N=M._events;if(!N)return[];var R=N[j];return R?typeof R=="function"?G?[R.listener||R]:[R]:G?k(R):E(R,R.length):[]}o.prototype.listeners=function(j){return w(this,j,!0)},o.prototype.rawListeners=function(j){return w(this,j,!1)},o.listenerCount=function(M,j){return typeof M.listenerCount=="function"?M.listenerCount(j):S.call(M,j)},o.prototype.listenerCount=S;function S(M){var j=this._events;if(j){var G=j[M];if(typeof G=="function")return 1;if(G)return G.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function C(M,j){for(var G=j,N=G+1,R=M.length;N<R;G+=1,N+=1)M[G]=M[N];M.pop()}function E(M,j){for(var G=new Array(j),N=0;N<j;++N)G[N]=M[N];return G}function k(M){for(var j=new Array(M.length),G=0;G<j.length;++G)j[G]=M[G].listener||M[G];return j}function O(M){var j=function(){};return j.prototype=M,new j}function U(M){for(var j in M)Object.prototype.hasOwnProperty.call(M,j);return j}function F(M){var j=this;return function(){return j.apply(M,arguments)}}},{}],53:[function(m,x,g){var b=m("./lib/parser");function f(){return(0,eval)("this")}x.exports={create:function(n,o){if(o=o||f(),n instanceof o.ArrayBuffer){var a=m("./lib/dom-bufferstream");return new b(new a(n,0,n.byteLength,!0,o))}else{var t=m("./lib/bufferstream");return new b(new t(n,0,n.length,!0))}}}},{"./lib/bufferstream":54,"./lib/dom-bufferstream":56,"./lib/parser":60}],54:[function(m,x,g){function b(f,n,o,a){this.buffer=f,this.offset=n||0,o=typeof o=="number"?o:f.length,this.endPosition=this.offset+o,this.setBigEndian(a)}b.prototype={setBigEndian:function(f){this.bigEndian=!!f},nextUInt8:function(){var f=this.buffer.readUInt8(this.offset);return this.offset+=1,f},nextInt8:function(){var f=this.buffer.readInt8(this.offset);return this.offset+=1,f},nextUInt16:function(){var f=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,f},nextUInt32:function(){var f=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,f},nextInt16:function(){var f=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,f},nextInt32:function(){var f=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,f},nextFloat:function(){var f=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,f},nextDouble:function(){var f=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,f},nextBuffer:function(f){var n=this.buffer.slice(this.offset,this.offset+f);return this.offset+=f,n},remainingLength:function(){return this.endPosition-this.offset},nextString:function(f){var n=this.buffer.toString("utf8",this.offset,this.offset+f);return this.offset+=f,n},mark:function(){var f=this;return{openWithOffset:function(n){return n=(n||0)+this.offset,new b(f.buffer,n,f.endPosition-n,f.bigEndian)},offset:this.offset}},offsetFrom:function(f){return this.offset-f.offset},skip:function(f){this.offset+=f},branch:function(f,n){return n=typeof n=="number"?n:this.endPosition-(this.offset+f),new b(this.buffer,this.offset+f,n,this.bigEndian)}},x.exports=b},{}],55:[function(m,x,g){function b(r){return parseInt(r,10)}var f=3600,n=60;function o(r,e){r=r.map(b),e=e.map(b);var l=r[0],s=r[1]-1,c=r[2],u=e[0],h=e[1],p=e[2],_=Date.UTC(l,s,c,u,h,p,0),w=_/1e3;return w}function a(r){var e=r.substr(0,10).split("-"),l=r.substr(11,8).split(":"),s=r.substr(19,6),c=s.split(":").map(b),u=c[0]*f+c[1]*n,h=o(e,l);if(h-=u,typeof h=="number"&&!isNaN(h))return h}function t(r){var e=r.split(" "),l=e[0].split(":"),s=e[1].split(":"),c=o(l,s);if(typeof c=="number"&&!isNaN(c))return c}function i(r){var e=r.length===19&&r.charAt(4)===":",l=r.length===25&&r.charAt(10)==="T";if(l)return a(r);if(e)return t(r)}x.exports={parseDateWithSpecFormat:t,parseDateWithTimezoneFormat:a,parseExifDate:i}},{}],56:[function(m,x,g){function b(f,n,o,a,t,i){this.global=t,n=n||0,o=o||f.byteLength-n,this.arrayBuffer=f.slice(n,n+o),this.view=new t.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(a),this.offset=0,this.parentOffset=(i||0)+n}b.prototype={setBigEndian:function(f){this.littleEndian=!f},nextUInt8:function(){var f=this.view.getUint8(this.offset);return this.offset+=1,f},nextInt8:function(){var f=this.view.getInt8(this.offset);return this.offset+=1,f},nextUInt16:function(){var f=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,f},nextUInt32:function(){var f=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,f},nextInt16:function(){var f=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,f},nextInt32:function(){var f=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,f},nextFloat:function(){var f=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,f},nextDouble:function(){var f=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,f},nextBuffer:function(f){var n=this.arrayBuffer.slice(this.offset,this.offset+f);return this.offset+=f,n},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(f){var n=this.arrayBuffer.slice(this.offset,this.offset+f);return n=String.fromCharCode.apply(null,new this.global.Uint8Array(n)),this.offset+=f,n},mark:function(){var f=this;return{openWithOffset:function(n){return n=(n||0)+this.offset,new b(f.arrayBuffer,n,f.arrayBuffer.byteLength-n,!f.littleEndian,f.global,f.parentOffset)},offset:this.offset,getParentOffset:function(){return f.parentOffset}}},offsetFrom:function(f){return this.parentOffset+this.offset-(f.offset+f.getParentOffset())},skip:function(f){this.offset+=f},branch:function(f,n){return n=typeof n=="number"?n:this.arrayBuffer.byteLength-(this.offset+f),new b(this.arrayBuffer,this.offset+f,n,!this.littleEndian,this.global,this.parentOffset)}},x.exports=b},{}],57:[function(m,x,g){x.exports={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}}},{}],58:[function(m,x,g){function b(t,i){switch(t){case 1:return i.nextUInt8();case 3:return i.nextUInt16();case 4:return i.nextUInt32();case 5:return[i.nextUInt32(),i.nextUInt32()];case 6:return i.nextInt8();case 8:return i.nextUInt16();case 9:return i.nextUInt32();case 10:return[i.nextInt32(),i.nextInt32()];case 11:return i.nextFloat();case 12:return i.nextDouble();default:throw new Error("Invalid format while decoding: "+t)}}function f(t){switch(t){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function n(t,i){var r=i.nextUInt16(),e=i.nextUInt16(),l=f(e),s=i.nextUInt32(),c=l*s,u,h;if(c>4&&(i=t.openWithOffset(i.nextUInt32())),e===2){u=i.nextString(s);var p=u.indexOf("\0");p!==-1&&(u=u.substr(0,p))}else if(e===7)u=i.nextBuffer(s);else if(e!==0)for(u=[],h=0;h<s;++h)u.push(b(e,i));return c<4&&i.skip(4-c),[r,u,e]}function o(t,i,r){var e=i.nextUInt16(),l,s;for(s=0;s<e;++s)l=n(t,i),r(l[0],l[1],l[2])}function a(t){var i=t.nextString(6);if(i!=="Exif\0\0")throw new Error("Invalid EXIF header");var r=t.mark(),e=t.nextUInt16();if(e===18761)t.setBigEndian(!1);else if(e===19789)t.setBigEndian(!0);else throw new Error("Invalid TIFF header");if(t.nextUInt16()!==42)throw new Error("Invalid TIFF data");return r}x.exports={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(t,i){var r;try{r=a(t)}catch(E){return!1}var e,l,s,c=r.openWithOffset(t.nextUInt32()),u=this.IFD0;o(r,c,function(E,k,O){switch(E){case 34853:l=k[0];break;case 34665:e=k[0];break;default:i(u,E,k,O);break}});var h=c.nextUInt32();if(h!==0){var p=r.openWithOffset(h);o(r,p,i.bind(null,this.IFD1))}if(l){var _=r.openWithOffset(l);o(r,_,i.bind(null,this.GPSIFD))}if(e){var w=r.openWithOffset(e),S=this.InteropIFD;o(r,w,function(E,k,O){E===40965?s=k[0]:i(S,E,k,O)})}if(s){var C=r.openWithOffset(s);o(r,C,i.bind(null,this.InteropIFD))}return!0}}},{}],59:[function(m,x,g){x.exports={parseSections:function(b,f){var n,o;for(b.setBigEndian(!0);b.remainingLength()>0&&o!==218;){if(b.nextUInt8()!==255)throw new Error("Invalid JPEG section offset");o=b.nextUInt8(),o>=208&&o<=217||o===218?n=0:n=b.nextUInt16()-2,f(o,b.branch(0,n)),b.skip(n)}},getSizeFromSOFSection:function(b){return b.skip(1),{height:b.nextUInt16(),width:b.nextUInt16()}},getSectionName:function(b){var f,n;switch(b){case 216:f="SOI";break;case 196:f="DHT";break;case 219:f="DQT";break;case 221:f="DRI";break;case 218:f="SOS";break;case 254:f="COM";break;case 217:f="EOI";break;default:b>=224&&b<=239?(f="APP",n=b-224):b>=192&&b<=207&&b!==196&&b!==200&&b!==204?(f="SOF",n=b-192):b>=208&&b<=215&&(f="RST",n=b-208);break}var o={name:f};return typeof n=="number"&&(o.index=n),o}}},{}],60:[function(m,x,g){var b=m("./jpeg"),f=m("./exif"),n=m("./simplify");function o(t,i,r,e,l,s,c){this.startMarker=t,this.tags=i,this.imageSize=r,this.thumbnailOffset=e,this.thumbnailLength=l,this.thumbnailType=s,this.app1Offset=c}o.prototype={hasThumbnail:function(t){return!this.thumbnailOffset||!this.thumbnailLength?!1:typeof t!="string"?!0:t.toLowerCase().trim()==="image/jpeg"?this.thumbnailType===6:t.toLowerCase().trim()==="image/tiff"?this.thumbnailType===1:!1},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var t=this._getThumbnailStream(),i;return b.parseSections(t,function(r,e){b.getSectionName(r).name==="SOF"&&(i=b.getSizeFromSOFSection(e))}),i}};function a(t){this.stream=t,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}a.prototype={enableBinaryFields:function(t){return this.flags.readBinaryTags=!!t,this},enablePointers:function(t){return this.flags.hidePointers=!t,this},enableTagNames:function(t){return this.flags.resolveTagNames=!!t,this},enableImageSize:function(t){return this.flags.imageSize=!!t,this},enableReturnTags:function(t){return this.flags.returnTags=!!t,this},enableSimpleValues:function(t){return this.flags.simplifyValues=!!t,this},parse:function(){var t=this.stream.mark(),i=t.openWithOffset(0),r=this.flags,e,l,s,c,u,h,p,_,w;return r.resolveTagNames&&(p=m("./exif-tags")),r.resolveTagNames?(e={},_=function(S){return e[S.name]},w=function(S,C){e[S.name]=C}):(e=[],_=function(S){var C;for(C=0;C<e.length;++C)if(e[C].type===S.type&&e[C].section===S.section)return e.value},w=function(S,C){var E;for(E=0;E<e.length;++E)if(e[E].type===S.type&&e[E].section===S.section){e.value=C;return}}),b.parseSections(i,function(S,C){var E,k=C.offsetFrom(t);S===225?(E=f.parseTags(C,function(O,U,F,M){if(!(!r.readBinaryTags&&M===7)){if(U===513){if(s=F[0],r.hidePointers)return}else if(U===514){if(c=F[0],r.hidePointers)return}else if(U===259&&(u=F[0],r.hidePointers))return;if(r.returnTags)if(r.simplifyValues&&(F=n.simplifyValue(F,M)),r.resolveTagNames){var j=O===f.GPSIFD?p.gps:p.exif,G=j[U];G||(G=p.exif[U]),e.hasOwnProperty(G)||(e[G]=F)}else e.push({section:O,type:U,value:F})}}),E&&(h=k)):r.imageSize&&b.getSectionName(S).name==="SOF"&&(l=b.getSizeFromSOFSection(C))}),r.simplifyValues&&(n.castDegreeValues(_,w),n.castDateValues(_,w)),new o(t,e,l,s,c,u,h)}},x.exports=a},{"./exif":58,"./exif-tags":57,"./jpeg":59,"./simplify":61}],61:[function(m,x,g){var b=m("./exif"),f=m("./date"),n=[{section:b.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:b.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],o=[{section:b.SubIFD,type:306,name:"ModifyDate"},{section:b.SubIFD,type:36867,name:"DateTimeOriginal"},{section:b.SubIFD,type:36868,name:"CreateDate"},{section:b.SubIFD,type:306,name:"ModifyDate"}];x.exports={castDegreeValues:function(a,t){n.forEach(function(i){var r=a(i);if(r){var e=a({section:i.section,type:i.refType,name:i.refName}),l=e===i.posVal?1:-1,s=(r[0]+r[1]/60+r[2]/3600)*l;t(i,s)}})},castDateValues:function(a,t){o.forEach(function(i){var r=a(i);if(r){var e=f.parseExifDate(r);typeof e<"u"&&t(i,e)}})},simplifyValue:function(a,t){return Array.isArray(a)&&(a=a.map(function(i){return t===10||t===5?i[0]/i[1]:i}),a.length===1&&(a=a[0])),a}}},{"./date":55,"./exif":58}],62:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault"),f=b(m("@babel/runtime/helpers/toConsumableArray")),n=function(r){return(0,f.default)(r).map(function(e){return e.charCodeAt(0)})},o=n("META-INF/mozilla.rsa"),a=n("[Content_Types].xml"),t=n("_rels/.rels");x.exports=function(i){var r=i instanceof Uint8Array?i:new Uint8Array(i);if(!(r&&r.length>1))return null;var e=function(O,U){U=Object.assign({offset:0},U);for(var F=0;F<O.length;F++)if(U.mask){if(O[F]!==(U.mask[F]&r[F+U.offset]))return!1}else if(O[F]!==r[F+U.offset])return!1;return!0},l=function(O,U){return e(n(O),U)};if(e([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(e([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(e([71,73,70]))return{ext:"gif",mime:"image/gif"};if(e([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(e([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((e([73,73,42,0])||e([77,77,0,42]))&&e([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(e([73,73,42,0])||e([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(e([66,77]))return{ext:"bmp",mime:"image/bmp"};if(e([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(e([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(e([80,75,3,4])){if(e([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(e(o,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(l("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(l("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(l("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};var s=function(O){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return O.findIndex(function(F,M,j){return M>=U&&j[M]===80&&j[M+1]===75&&j[M+2]===3&&j[M+3]===4})},c=0,u=!1,h=null;do{var p=c+30;if(u||(u=e(a,{offset:p})||e(t,{offset:p})),h||(l("word/",{offset:p})?h={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:l("ppt/",{offset:p})?h={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:l("xl/",{offset:p})&&(h={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),u&&h)return h;c=s(r,p)}while(c>=0);if(h)return h}if(e([80,75])&&(r[2]===3||r[2]===5||r[2]===7)&&(r[3]===4||r[3]===6||r[3]===8))return{ext:"zip",mime:"application/zip"};if(e([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(e([82,97,114,33,26,7])&&(r[6]===0||r[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(e([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(e([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(e([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(e([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(e([51,103,112,53])||e([0,0,0])&&e([102,116,121,112],{offset:4})&&(e([109,112,52,49],{offset:8})||e([109,112,52,50],{offset:8})||e([105,115,111,109],{offset:8})||e([105,115,111,50],{offset:8})||e([109,109,112,52],{offset:8})||e([77,52,86],{offset:8})||e([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(e([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(e([26,69,223,163])){var _=r.subarray(4,4100),w=_.findIndex(function(k,O,U){return U[O]===66&&U[O+1]===130});if(w!==-1){var S=w+3,C=function(O){return(0,f.default)(O).every(function(U,F){return _[S+F]===U.charCodeAt(0)})};if(C("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(C("webm"))return{ext:"webm",mime:"video/webm"}}}if(e([0,0,0,20,102,116,121,112,113,116,32,32])||e([102,114,101,101],{offset:4})||e([102,116,121,112,113,116,32,32],{offset:4})||e([109,100,97,116],{offset:4})||e([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(e([82,73,70,70])){if(e([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(e([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(e([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(e([48,38,178,117,142,102,207,17,166,217]))return{ext:"wmv",mime:"video/x-ms-wmv"};if(e([0,0,1,186])||e([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(e([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(var E=0;E<2&&E<r.length-16;E++){if(e([73,68,51],{offset:E})||e([255,226],{offset:E,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(e([255,228],{offset:E,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(e([255,248],{offset:E,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(e([255,240],{offset:E,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(e([102,116,121,112,77,52,65],{offset:4})||e([77,52,65,32]))return{ext:"m4a",mime:"audio/mp4"};if(e([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(e([79,103,103,83]))return e([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:e([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:e([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:e([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:e([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(e([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(e([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(e([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(e([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(e([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(e([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((r[0]===67||r[0]===70)&&e([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(e([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(e([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(e([119,79,70,70])&&(e([0,1,0,0],{offset:4})||e([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(e([119,79,70,50])&&(e([0,1,0,0],{offset:4})||e([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(e([76,80],{offset:34})&&(e([0,0,1],{offset:8})||e([1,0,2],{offset:8})||e([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(e([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(e([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(e([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(e([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(e([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(e([37,33]))return{ext:"ps",mime:"application/postscript"};if(e([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(e([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(e([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(e([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(e([77,83,67,70])||e([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(e([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(e([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(e([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(e([31,160])||e([31,157]))return{ext:"Z",mime:"application/x-compress"};if(e([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(e([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(e([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(e([71],{offset:4})&&(e([71],{offset:192})||e([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(e([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(e([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(e([0,0,0,12,106,80,32,32,13,10,135,10])){if(e([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(e([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(e([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(e([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(e([70,79,82,77,0]))return{ext:"aif",mime:"audio/aiff"};if(l("<?xml "))return{ext:"xml",mime:"application/xml"};if(e([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(e([102,116,121,112],{offset:4})){if(e([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(e([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(e([104,101,105,99],{offset:8})||e([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(e([104,101,118,99],{offset:8})||e([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return e([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:null}},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/toConsumableArray":20}],63:[function(m,x,g){var b=m("is-callable"),f=Object.prototype.toString,n=Object.prototype.hasOwnProperty,o=function(e,l,s){for(var c=0,u=e.length;c<u;c++)n.call(e,c)&&(s==null?l(e[c],c,e):l.call(s,e[c],c,e))},a=function(e,l,s){for(var c=0,u=e.length;c<u;c++)s==null?l(e.charAt(c),c,e):l.call(s,e.charAt(c),c,e)},t=function(e,l,s){for(var c in e)n.call(e,c)&&(s==null?l(e[c],c,e):l.call(s,e[c],c,e))},i=function(e,l,s){if(!b(l))throw new TypeError("iterator must be a function");var c;arguments.length>=3&&(c=s),f.call(e)==="[object Array]"?o(e,l,c):typeof e=="string"?a(e,l,c):t(e,l,c)};x.exports=i},{"is-callable":77}],64:[function(m,x,g){function b(a,t,i,l){var e=0,l=l===void 0?{}:l,s=l.loop===void 0?null:l.loop,c=l.palette===void 0?null:l.palette;if(t<=0||i<=0||t>65535||i>65535)throw new Error("Width/Height invalid.");function u(k){var O=k.length;if(O<2||O>256||O&O-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return O}a[e++]=71,a[e++]=73,a[e++]=70,a[e++]=56,a[e++]=57,a[e++]=97;var h=0,p=0;if(c!==null){for(var _=u(c);_>>=1;)++h;if(_=1<<h,--h,l.background!==void 0){if(p=l.background,p>=_)throw new Error("Background index out of range.");if(p===0)throw new Error("Background index explicitly passed as 0.")}}if(a[e++]=t&255,a[e++]=t>>8&255,a[e++]=i&255,a[e++]=i>>8&255,a[e++]=(c!==null?128:0)|h,a[e++]=p,a[e++]=0,c!==null)for(var w=0,S=c.length;w<S;++w){var C=c[w];a[e++]=C>>16&255,a[e++]=C>>8&255,a[e++]=C&255}if(s!==null){if(s<0||s>65535)throw new Error("Loop count invalid.");a[e++]=33,a[e++]=255,a[e++]=11,a[e++]=78,a[e++]=69,a[e++]=84,a[e++]=83,a[e++]=67,a[e++]=65,a[e++]=80,a[e++]=69,a[e++]=50,a[e++]=46,a[e++]=48,a[e++]=3,a[e++]=1,a[e++]=s&255,a[e++]=s>>8&255,a[e++]=0}var E=!1;this.addFrame=function(k,O,U,F,M,j){if(E===!0&&(--e,E=!1),j=j===void 0?{}:j,k<0||O<0||k>65535||O>65535)throw new Error("x/y invalid.");if(U<=0||F<=0||U>65535||F>65535)throw new Error("Width/Height invalid.");if(M.length<U*F)throw new Error("Not enough pixels for the frame size.");var G=!0,N=j.palette;if(N==null&&(G=!1,N=c),N==null)throw new Error("Must supply either a local or global palette.");for(var R=u(N),A=0;R>>=1;)++A;R=1<<A;var H=j.delay===void 0?0:j.delay,Z=j.disposal===void 0?0:j.disposal;if(Z<0||Z>3)throw new Error("Disposal out of range.");var K=!1,J=0;if(j.transparent!==void 0&&j.transparent!==null&&(K=!0,J=j.transparent,J<0||J>=R))throw new Error("Transparent color index.");if((Z!==0||K||H!==0)&&(a[e++]=33,a[e++]=249,a[e++]=4,a[e++]=Z<<2|(K===!0?1:0),a[e++]=H&255,a[e++]=H>>8&255,a[e++]=J,a[e++]=0),a[e++]=44,a[e++]=k&255,a[e++]=k>>8&255,a[e++]=O&255,a[e++]=O>>8&255,a[e++]=U&255,a[e++]=U>>8&255,a[e++]=F&255,a[e++]=F>>8&255,a[e++]=G===!0?128|A-1:0,G===!0)for(var D=0,I=N.length;D<I;++D){var W=N[D];a[e++]=W>>16&255,a[e++]=W>>8&255,a[e++]=W&255}return e=f(a,e,A<2?2:A,M),e},this.end=function(){return E===!1&&(a[e++]=59,E=!0),e},this.getOutputBuffer=function(){return a},this.setOutputBuffer=function(k){a=k},this.getOutputBufferPosition=function(){return e},this.setOutputBufferPosition=function(k){e=k}}function f(a,t,i,r){a[t++]=i;var e=t++,l=1<<i,s=l-1,c=l+1,u=c+1,h=i+1,p=0,_=0;function w(j){for(;p>=j;)a[t++]=_&255,_>>=8,p-=8,t===e+256&&(a[e]=255,e=t++)}function S(j){_|=j<<p,p+=h,w(8)}var C=r[0]&s,E={};S(l);for(var k=1,O=r.length;k<O;++k){var U=r[k]&s,F=C<<8|U,M=E[F];if(M===void 0){for(_|=C<<p,p+=h;p>=8;)a[t++]=_&255,_>>=8,p-=8,t===e+256&&(a[e]=255,e=t++);u===4096?(S(l),u=c+1,h=i+1,E={}):(u>=1<<h&&++h,E[F]=u++),C=U}else C=M}return S(C),S(c),w(1),e+1===t?a[e]=0:(a[e]=t-e-1,a[t++]=0),t}function n(a){var t=0;if(a[t++]!==71||a[t++]!==73||a[t++]!==70||a[t++]!==56||(a[t++]+1&253)!==56||a[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var i=a[t++]|a[t++]<<8,r=a[t++]|a[t++]<<8,e=a[t++],l=e>>7,s=e&7,c=1<<s+1;a[t++],a[t++];var u=null,h=null;l&&(u=t,h=c,t+=c*3);var p=!0,_=[],w=0,S=null,C=0,E=null;for(this.width=i,this.height=r;p&&t<a.length;)switch(a[t++]){case 33:switch(a[t++]){case 255:if(a[t]!==11||a[t+1]==78&&a[t+2]==69&&a[t+3]==84&&a[t+4]==83&&a[t+5]==67&&a[t+6]==65&&a[t+7]==80&&a[t+8]==69&&a[t+9]==50&&a[t+10]==46&&a[t+11]==48&&a[t+12]==3&&a[t+13]==1&&a[t+16]==0)t+=14,E=a[t++]|a[t++]<<8,t++;else for(t+=12;;){var k=a[t++];if(!(k>=0))throw Error("Invalid block size");if(k===0)break;t+=k}break;case 249:if(a[t++]!==4||a[t+4]!==0)throw new Error("Invalid graphics extension block.");var O=a[t++];w=a[t++]|a[t++]<<8,S=a[t++],O&1||(S=null),C=O>>2&7,t++;break;case 254:for(;;){var k=a[t++];if(!(k>=0))throw Error("Invalid block size");if(k===0)break;t+=k}break;default:throw new Error("Unknown graphic control label: 0x"+a[t-1].toString(16))}break;case 44:var U=a[t++]|a[t++]<<8,F=a[t++]|a[t++]<<8,M=a[t++]|a[t++]<<8,j=a[t++]|a[t++]<<8,G=a[t++],N=G>>7,R=G>>6&1,A=G&7,H=1<<A+1,Z=u,K=h,J=!1;if(N){var J=!0;Z=t,K=H,t+=H*3}var D=t;for(t++;;){var k=a[t++];if(!(k>=0))throw Error("Invalid block size");if(k===0)break;t+=k}_.push({x:U,y:F,width:M,height:j,has_local_palette:J,palette_offset:Z,palette_size:K,data_offset:D,data_length:t-D,transparent_index:S,interlaced:!!R,delay:w,disposal:C});break;case 59:p=!1;break;default:throw new Error("Unknown gif block: 0x"+a[t-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return E},this.frameInfo=function(I){if(I<0||I>=_.length)throw new Error("Frame index out of range.");return _[I]},this.decodeAndBlitFrameBGRA=function(I,W){var q=this.frameInfo(I),ne=q.width*q.height,le=new Uint8Array(ne);o(a,q.data_offset,le,ne);var ce=q.palette_offset,fe=q.transparent_index;fe===null&&(fe=256);var he=q.width,se=i-he,ie=he,Q=(q.y*i+q.x)*4,re=((q.y+q.height)*i+q.x)*4,te=Q,V=se*4;q.interlaced===!0&&(V+=i*4*7);for(var z=8,B=0,ee=le.length;B<ee;++B){var Y=le[B];if(ie===0&&(te+=V,ie=he,te>=re&&(V=se*4+i*4*(z-1),te=Q+(he+se)*(z<<1),z>>=1)),Y===fe)te+=4;else{var L=a[ce+Y*3],P=a[ce+Y*3+1],ae=a[ce+Y*3+2];W[te++]=ae,W[te++]=P,W[te++]=L,W[te++]=255}--ie}},this.decodeAndBlitFrameRGBA=function(I,W){var q=this.frameInfo(I),ne=q.width*q.height,le=new Uint8Array(ne);o(a,q.data_offset,le,ne);var ce=q.palette_offset,fe=q.transparent_index;fe===null&&(fe=256);var he=q.width,se=i-he,ie=he,Q=(q.y*i+q.x)*4,re=((q.y+q.height)*i+q.x)*4,te=Q,V=se*4;q.interlaced===!0&&(V+=i*4*7);for(var z=8,B=0,ee=le.length;B<ee;++B){var Y=le[B];if(ie===0&&(te+=V,ie=he,te>=re&&(V=se*4+i*4*(z-1),te=Q+(he+se)*(z<<1),z>>=1)),Y===fe)te+=4;else{var L=a[ce+Y*3],P=a[ce+Y*3+1],ae=a[ce+Y*3+2];W[te++]=L,W[te++]=P,W[te++]=ae,W[te++]=255}--ie}}}function o(a,t,i,r){for(var e=a[t++],l=1<<e,s=l+1,c=s+1,u=e+1,h=(1<<u)-1,p=0,_=0,w=0,S=a[t++],C=new Int32Array(4096),E=null;;){for(;p<16&&S!==0;)_|=a[t++]<<p,p+=8,S===1?S=a[t++]:--S;if(p<u)break;var k=_&h;if(_>>=u,p-=u,k===l){c=s+1,u=e+1,h=(1<<u)-1,E=null;continue}else if(k===s)break;for(var O=k<c?k:E,U=0,F=O;F>l;)F=C[F]>>8,++U;var M=F,j=w+U+(O!==k?1:0);if(j>r){console.log("Warning, gif stream longer than expected.");return}i[w++]=M,w+=U;var G=w;for(O!==k&&(i[w++]=M),F=O;U--;)F=C[F],i[--G]=F&255,F>>=8;E!==null&&c<4096&&(C[c++]=E<<8|M,c>=h+1&&u<12&&(++u,h=h<<1|1)),E=k}return w!==r&&console.log("Warning, gif stream shorter than expected."),i}try{g.GifWriter=b,g.GifReader=n}catch(a){}},{}],65:[function(m,x,g){(function(b){class f{constructor(...o){if(o.length===0)throw new Error("constructor requires parameters");const a=o[0];if(a!==null&&typeof a=="object")if(a instanceof f){const t=a.bitmap;this.bitmap={width:t.width,height:t.height,data:new b(t.width*t.height*4)},t.data.copy(this.bitmap.data)}else if(a.width&&a.height&&a.data)this.bitmap=a;else throw new Error("unrecognized constructor parameters");else if(typeof a=="number"&&typeof o[1]=="number"){const t=a,i=o[1],r=o[2];this.bitmap={width:t,height:i},b.isBuffer(r)?this.bitmap.data=r:(this.bitmap.data=new b(t*i*4),typeof r=="number"&&this.fillRGBA(r))}else throw new Error("unrecognized constructor parameters")}blit(o,a,t,i,r,e,l){if(i+e>this.bitmap.width)throw new Error("copy exceeds width of source bitmap");if(a+e>o.bitmap.width)throw new Error("copy exceeds width of target bitmap");if(r+l>this.bitmap.height)throw new Error("copy exceeds height of source bitmap");if(t+l>o.bitmap.height)throw new Erro("copy exceeds height of target bitmap");const s=this.bitmap.data,c=o.bitmap.data,u=this.bitmap.width*4,h=o.bitmap.width*4,p=e*4;let _=r*u+i*4,w=t*h+a*4;for(;--l>=0;)s.copy(c,w,_,_+p),_+=u,w+=h;return this}fillRGBA(o){const a=this.bitmap.data,t=this.bitmap.height*4;let i=0;for(;i<t;)a.writeUInt32BE(o,i),i+=4;for(;i<a.length;)a.copy(a,i,0,t),i+=t;return this}getRGBA(o,a){const t=(a*this.bitmap.width+o)*4;return this.bitmap.data.readUInt32BE(t)}getRGBASet(){const o=new Set,a=this.bitmap.data;for(let t=0;t<a.length;t+=4)o.add(a.readUInt32BE(t,!0));return o}greyscale(){const o=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,(a,t,i)=>{const r=Math.round(.299*o[i]+.587*o[i+1]+.114*o[i+2]);o[i]=r,o[i+1]=r,o[i+2]=r}),this}reframe(o,a,t,i,r){const e=o<0?0:o,l=a<0?0:a,s=t+e>this.bitmap.width?this.bitmap.width-e:t,c=i+l>this.bitmap.height?this.bitmap.height-l:i,u=o<0?-o:0,h=a<0?-a:0;let p;if(r===void 0){if(e!==o||l!=a||s!==t||c!==i)throw new GifError("fillRGBA required for this reframing");p=new f(t,i)}else p=new f(t,i,r);return this.blit(p,u,h,e,l,s,c),this.bitmap=p.bitmap,this}scale(o){if(o===1)return;if(!Number.isInteger(o)||o<1)throw new Error("the scale must be an integer >= 1");const a=this.bitmap.width,t=this.bitmap.height,i=a*o*4,r=this.bitmap.data,e=new b(t*i*o);let l=0,s,c=0;for(let u=0;u<t;++u){s=c;for(let h=0;h<a;++h){const p=r.readUInt32BE(l,!0);for(let _=0;_<o;++_)e.writeUInt32BE(p,c),c+=4;l+=4}for(let h=1;h<o;++h)e.copy(e,c,s,c),c+=i,s+=i}return this.bitmap={width:a*o,height:t*o,data:e},this}scanAllCoords(o){const a=this.bitmap.width,t=this.bitmap.data.length;let i=0,r=0;for(let e=0;e<t;e+=4)o(i,r,e),++i===a&&(i=0,++r)}scanAllIndexes(o){const a=this.bitmap.data.length;for(let t=0;t<a;t+=4)o(t)}}x.exports=f}).call(this,m("buffer").Buffer)},{buffer:48}],66:[function(m,x,g){class b{constructor(o,a,t){this.width=t.width,this.height=t.height,this.loops=t.loops,this.usesTransparency=t.usesTransparency,this.colorScope=t.colorScope,this.frames=a,this.buffer=o}}b.GlobalColorsPreferred=0,b.GlobalColorsOnly=1,b.LocalColorsOnly=2;class f extends Error{constructor(o){super(o),o instanceof Error&&(this.stack="Gif"+o.stack)}}g.Gif=b,g.GifError=f},{}],67:[function(m,x,g){(function(b,f){const n=m("omggif"),{Gif:o,GifError:a}=m("./gif");let t;b.nextTick(()=>{t=m("./gifutil")});const{GifFrame:i}=m("./gifframe"),r=200,e=100;class l{constructor(k={}){this._transparentRGB=null,typeof k.transparentRGB=="number"&&k.transparentRGB!==0&&(this._transparentRGBA=k.transparentRGB*256),this._testInitialBufferSize=0}decodeGif(k){try{let O;try{O=new n.GifReader(k)}catch(j){throw new a(j)}const U=O.numFrames(),F=[],M={width:O.width,height:O.height,loops:O.loopCount()};M.usesTransparency=!1;for(let j=0;j<U;++j){const G=this._decodeFrame(O,j,M.usesTransparency);F.push(G.frame),G.usesTransparency&&(M.usesTransparency=!0)}return Promise.resolve(new o(k,F,M))}catch(O){return Promise.reject(O)}}encodeGif(k,O={}){try{if(k===null||k.length===0)throw new a("there are no frames");const U=t.getMaxDimensions(k);return O=Object.assign({},O),O.width=U.maxWidth,O.height=U.maxHeight,O.loops=O.loops||0,O.colorScope=O.colorScope||o.GlobalColorsPreferred,Promise.resolve(this._encodeGif(k,O))}catch(U){return Promise.reject(U)}}_decodeFrame(k,O,U){let F,M;try{if(F=k.frameInfo(O),M=new f(k.width*k.height*4),k.decodeAndBlitFrameRGBA(O,M),F.width!==k.width||F.height!==k.height){if(F.y&&(M=M.slice(F.y*k.width*4)),k.width>F.width)for(let N=0;N<F.height;++N)M.copy(M,N*F.width*4,(F.x+N*k.width)*4,(F.x+N*k.width)*4+F.width*4);M=M.slice(0,F.width*F.height*4)}}catch(N){throw new a(N)}let j=!1;if(this._transparentRGBA===null){if(!U)for(let N=3;N<M.length;N+=4)M[N]===0&&(j=!0,N=M.length)}else for(let N=3;N<M.length;N+=4)M[N]===0&&(M.writeUInt32BE(this._transparentRGBA,N-3),j=!0);return{frame:new i(F.width,F.height,M,{xOffset:F.x,yOffset:F.y,disposalMethod:F.disposal,interlaced:F.interlaced,delayCentisecs:F.delay}),usesTransparency:j}}_encodeGif(k,O){let U;if(O.colorScope===o.LocalColorsOnly)U=t.getColorInfo(k,0);else if(U=t.getColorInfo(k,256),!U.colors){if(O.colorScope===o.GlobalColorsOnly)throw new a("Too many color indexes for global color table");O.colorScope=o.LocalColorsOnly}O.usesTransparency=U.usesTransparency;const F=U.palettes;return O.colorScope===o.LocalColorsOnly?h(k,O,2e3,F):u(k,O,2e3,U)}_getSizeEstimateGlobal(k,O){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let U=r+3*256;const F=S(k);return O.forEach(M=>{U+=_(M,F)}),U}_getSizeEstimateLocal(k,O){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let U=r;for(let F=0;F<O.length;++F){const M=k[F],j=S(M);U+=_(O[F],j)}return U}}g.GifCodec=l;function s(E,k){const O=E.indexOf(k);return O===-1?null:O}function c(E,k){for(var O=0,U=E.length-1,F;O<=U;)if(F=Math.floor((O+U)/2),E[F]>k)U=F-1;else if(E[F]<k)O=F+1;else return F;return null}function u(E,k,O,U){const F={colors:U.colors.slice(),usesTransparency:U.usesTransparency};p(F);const M={palette:F.colors,loop:k.loops};let j=new f(O),G;try{G=new n.GifWriter(j,k.width,k.height,M)}catch(N){throw new a(N)}for(let N=0;N<E.length;++N)j=C(G,N,E[N],U,!1);return new o(j.slice(0,G.end()),E,k)}function h(E,k,O,U){const F={loop:k.loops};let M=new f(O),j;try{j=new n.GifWriter(M,k.width,k.height,F)}catch(G){throw new a(G)}for(let G=0;G<E.length;++G)M=C(j,G,E[G],U[G],!0);return new o(M.slice(0,j.end()),E,k)}function p(E){const k=E.colors;E.usesTransparency&&k.push(0);const O=k.length;let U=2;for(;O>U;)U<<=1;k.length=U,k.fill(0,O)}function _(E,k){let O=E.bitmap.width*E.bitmap.height;return O=Math.ceil(O*k/8),O+=Math.ceil(O/255),e+O+3*256}function w(E,k,O){const U=O.colors,F=U.length<=8?s:c,M=k.bitmap.data,j=new f(M.length/4);let G=U.length,N=0,R=0;for(;N<M.length;){if(M[N+3]!==0){const A=M.readUInt32BE(N,!0)>>8&16777215;j[R]=F(U,A)}else j[R]=G;N+=4,++R}if(O.usesTransparency){if(G===256)throw new a("Frame ".concat(E," already has 256 colors")+"and so can't use transparency")}else G=null;return{buffer:j,transparentIndex:G}}function S(E){let k=E.indexCount,O=0;for(--k;k;)++O,k>>=1;return O>0?O:1}function C(E,k,O,U,F){if(O.interlaced)throw new a("writing interlaced GIFs is not supported");const M=w(k,O,U),j={delay:O.delayCentisecs,disposal:O.disposalMethod,transparent:M.transparentIndex};F&&(p(U),j.palette=U.colors);try{let G=E.getOutputBuffer(),N=E.getOutputBufferPosition(),R,A=!0;for(;A;)if(R=E.addFrame(O.xOffset,O.yOffset,O.bitmap.width,O.bitmap.height,M.buffer,j),A=!1,R>=G.length-1){const H=new f(G.length*1.5);G.copy(H),E.setOutputBuffer(H),E.setOutputBufferPosition(N),G=H,A=!0}return G}catch(G){throw new a(G)}}}).call(this,m("_process"),m("buffer").Buffer)},{"./gif":66,"./gifframe":68,"./gifutil":69,_process:133,buffer:48,omggif:64}],68:[function(m,x,g){const b=m("./bitmapimage");m("./gif");class f extends b{constructor(...o){if(super(...o),o[0]instanceof f){const a=o[0];this.xOffset=a.xOffset,this.yOffset=a.yOffset,this.disposalMethod=a.disposalMethod,this.delayCentisecs=a.delayCentisecs,this.interlaced=a.interlaced}else{const a=o[o.length-1];let t={};typeof a=="object"&&!(a instanceof b)&&(t=a),this.xOffset=t.xOffset||0,this.yOffset=t.yOffset||0,this.disposalMethod=t.disposalMethod!==void 0?t.disposalMethod:f.DisposeToBackgroundColor,this.delayCentisecs=t.delayCentisecs||8,this.interlaced=t.interlaced||!1}}getPalette(){const o=new Set,a=this.bitmap.data;let t=0,i=!1;for(;t<a.length;){if(a[t+3]===0)i=!0;else{const s=a.readUInt32BE(t,!0)>>8&16777215;o.add(s)}t+=4}const r=new Array(o.size),e=o.values();for(t=0;t<r.length;++t)r[t]=e.next().value;r.sort((s,c)=>s-c);let l=r.length;return i&&++l,{colors:r,usesTransparency:i,indexCount:l}}}f.DisposeToAnything=0,f.DisposeNothing=1,f.DisposeToBackgroundColor=2,f.DisposeToPrevious=3,g.GifFrame=f},{"./bitmapimage":65,"./gif":66}],69:[function(m,x,g){(function(b){const f=m("fs"),n=m("image-q"),o=m("./bitmapimage"),{GifFrame:a}=m("./gifframe"),{GifError:t}=m("./gif"),{GifCodec:i}=m("./gifcodec"),r=[".jpg",".jpeg",".png",".bmp"],e=new i;g.cloneFrames=function(u){let h=[];return u.forEach(p=>{h.push(new a(p))}),h},g.getColorInfo=function(u,h){let p=!1;const _=[];for(let k=0;k<u.length;++k){let O=u[k].getPalette();if(O.usesTransparency&&(p=!0),O.indexCount>256)throw new t("Frame ".concat(k," uses more than 256 color indexes"));_.push(O)}if(h===0)return{usesTransparency:p,palettes:_};const w=new Set;_.forEach(k=>{k.colors.forEach(O=>{w.add(O)})});let S=w.size;if(p&&++S,h&&S>h)return{usesTransparency:p,palettes:_};const C=new Array(w.size),E=w.values();for(let k=0;k<C.length;++k)C[k]=E.next().value;return C.sort((k,O)=>k-O),{colors:C,indexCount:S,usesTransparency:p,palettes:_}},g.copyAsJimp=function(u,h){return g.shareAsJimp(u,new o(h))},g.getMaxDimensions=function(u){let h=0,p=0;return u.forEach(_=>{const w=_.xOffset+_.bitmap.width;w>h&&(h=w);const S=_.yOffset+_.bitmap.height;S>p&&(p=S)}),{maxWidth:h,maxHeight:p}},g.quantizeDekker=function(u,h,p){h=h||256,l(u,"NeuQuantFloat",h,0,p)},g.quantizeSorokin=function(u,h,p,_){h=h||256,p=p||"min-pop";let w;switch(p){case"min-pop":w=2;break;case"top-pop":w=1;break;default:throw new Error("Invalid quantizeSorokin histogram '".concat(p,"'"))}l(u,"RGBQuant",h,w,_)},g.quantizeWu=function(u,h,p,_){if(h=h||256,p=p||5,p<1||p>8)throw new Error("Invalid quantization quality");l(u,"WuQuant",h,p,_)},g.read=function(u,h){return h=h||e,b.isBuffer(u)?h.decodeGif(u):s(u).then(p=>h.decodeGif(p))},g.shareAsJimp=function(u,h){const p=new u(h.bitmap.width,h.bitmap.height,0);return p.bitmap.data=h.bitmap.data,p},g.write=function(u,h,p,_){_=_||e;const w=u.match(/\.[a-zA-Z]+$/);if(w!==null&&r.includes(w[0].toLowerCase()))throw new Error("GIF '".concat(u,"' has an unexpected suffix"));return _.encodeGif(h,p).then(S=>c(u,S.buffer).then(()=>S))};function l(u,h,p,_,w){const S=Array.isArray(u)?u:[u],C=["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"];if(w){if(C.indexOf(w.ditherAlgorithm)<0)throw new Error("Invalid ditherAlgorithm '".concat(w.ditherAlgorithm,"'"));w.serpentine===void 0&&(w.serpentine=!0),w.minimumColorDistanceToDither===void 0&&(w.minimumColorDistanceToDither=0),w.calculateErrorLikeGIMP===void 0&&(w.calculateErrorLikeGIMP=!1)}const E=new n.distance.Euclidean,k=new n.palette[h](E,p,_);let O;w?O=new n.image.ErrorDiffusionArray(E,n.image.ErrorDiffusionArrayKernel[w.ditherAlgorithm],w.serpentine,w.minimumColorDistanceToDither,w.calculateErrorLikeGIMP):O=new n.image.NearestColor(E);const U=[];S.forEach(M=>{const j=M.bitmap.data,G=new ArrayBuffer(j.length),N=new Uint32Array(G);for(let A=0,H=0;A<j.length;A+=4,++H)N[H]=j.readUInt32LE(A,!0);const R=n.utils.PointContainer.fromUint32Array(N,M.bitmap.width,M.bitmap.height);k.sample(R),U.push(R)});const F=k.quantize();for(let M=0;M<S.length;++M){const j=S[M].bitmap.data,N=O.quantize(U[M],F).toUint32Array();for(let R=0,A=0;R<j.length;R+=4,++A)j.writeUInt32LE(N[A],R)}}function s(u){return new Promise((h,p)=>{f.readFile(u,(_,w)=>_?p(_):h(w))})}function c(u,h){return new Promise((p,_)=>{f.writeFile(u,h,w=>w?_(w):p())})}}).call(this,{isBuffer:m("../../is-buffer/index.js")})},{"../../is-buffer/index.js":76,"./bitmapimage":65,"./gif":66,"./gifcodec":67,"./gifframe":68,fs:47,"image-q":74}],70:[function(m,x,g){const b=m("./bitmapimage"),{Gif:f,GifError:n}=m("./gif"),{GifCodec:o}=m("./gifcodec"),{GifFrame:a}=m("./gifframe"),t=m("./gifutil");x.exports={BitmapImage:b,Gif:f,GifCodec:o,GifFrame:a,GifUtil:t,GifError:n}},{"./bitmapimage":65,"./gif":66,"./gifcodec":67,"./gifframe":68,"./gifutil":69}],71:[function(m,x,g){(function(b){var f;typeof y<"u"?f=y:typeof b<"u"?f=b:typeof self<"u"?f=self:f={},x.exports=f}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{}],72:[function(m,x,g){var b=m("http"),f=m("url"),n=x.exports;for(var o in b)b.hasOwnProperty(o)&&(n[o]=b[o]);n.request=function(t,i){return t=a(t),b.request.call(this,t,i)},n.get=function(t,i){return t=a(t),b.get.call(this,t,i)};function a(t){if(typeof t=="string"&&(t=f.parse(t)),t.protocol||(t.protocol="https:"),t.protocol!=="https:")throw new Error('Protocol "'+t.protocol+'" not supported. Expected "https:"');return t}},{http:156,url:180}],73:[function(m,x,g){g.read=function(b,f,n,o,a){var t,i,r=a*8-o-1,e=(1<<r)-1,l=e>>1,s=-7,c=n?a-1:0,u=n?-1:1,h=b[f+c];for(c+=u,t=h&(1<<-s)-1,h>>=-s,s+=r;s>0;t=t*256+b[f+c],c+=u,s-=8);for(i=t&(1<<-s)-1,t>>=-s,s+=o;s>0;i=i*256+b[f+c],c+=u,s-=8);if(t===0)t=1-l;else{if(t===e)return i?NaN:(h?-1:1)*(1/0);i=i+Math.pow(2,o),t=t-l}return(h?-1:1)*i*Math.pow(2,t-o)},g.write=function(b,f,n,o,a,t){var i,r,e,l=t*8-a-1,s=(1<<l)-1,c=s>>1,u=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=o?0:t-1,p=o?1:-1,_=f<0||f===0&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(r=isNaN(f)?1:0,i=s):(i=Math.floor(Math.log(f)/Math.LN2),f*(e=Math.pow(2,-i))<1&&(i--,e*=2),i+c>=1?f+=u/e:f+=u*Math.pow(2,1-c),f*e>=2&&(i++,e/=2),i+c>=s?(r=0,i=s):i+c>=1?(r=(f*e-1)*Math.pow(2,a),i=i+c):(r=f*Math.pow(2,c-1)*Math.pow(2,a),i=0));a>=8;b[n+h]=r&255,h+=p,r/=256,a-=8);for(i=i<<a|r,l+=a;l>0;b[n+h]=i&255,h+=p,i/=256,l-=8);b[n+h-p]|=_*128}},{}],74:[function(m,x,g){(function(f,n){typeof g=="object"&&typeof x=="object"?x.exports=n():typeof g=="object"?g.iq=n():f.iq=n()})(this,function(){return function(b){var f={};function n(o){if(f[o])return f[o].exports;var a=f[o]={exports:{},id:o,loaded:!1};return b[o].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=b,n.c=f,n.p="",n(0)}([function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 */var o=n(1);f.constants=o;var a=n(3);f.conversion=a;var t=n(12);f.distance=t;var i=n(20);f.palette=i;var r=n(30);f.image=r;var e=n(35);f.quality=e;var l=n(37);f.utils=l},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * constants.ts - part of Image Quantization Library
 */var o=n(2);f.bt709=o},function(b,f){var n;(function(t){t[t.RED=.2126]="RED",t[t.GREEN=.7152]="GREEN",t[t.BLUE=.0722]="BLUE",t[t.WHITE=1]="WHITE"})(n||(n={})),f.Y=n;var o;(function(t){t[t.RED=.64]="RED",t[t.GREEN=.3]="GREEN",t[t.BLUE=.15]="BLUE",t[t.WHITE=.3127]="WHITE"})(o||(o={})),f.x=o;var a;(function(t){t[t.RED=.33]="RED",t[t.GREEN=.6]="GREEN",t[t.BLUE=.06]="BLUE",t[t.WHITE=.329]="WHITE"})(a||(a={})),f.y=a},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 */var o=n(4);f.rgb2xyz=o.rgb2xyz;var a=n(5);f.rgb2hsl=a.rgb2hsl;var t=n(7);f.rgb2lab=t.rgb2lab;var i=n(9);f.lab2xyz=i.lab2xyz;var r=n(10);f.lab2rgb=r.lab2rgb;var e=n(8);f.xyz2lab=e.xyz2lab;var l=n(11);f.xyz2rgb=l.xyz2rgb},function(b,f){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2xyz.ts - part of Image Quantization Library
 */function n(a){return a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92}function o(a,t,i){return a=n(a/255),t=n(t/255),i=n(i/255),{x:a*.4124+t*.3576+i*.1805,y:a*.2126+t*.7152+i*.0722,z:a*.0193+t*.1192+i*.9505}}f.rgb2xyz=o},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2hsl.ts - part of Image Quantization Library
 */var o=n(6);function a(t,i,r){var e=o.min3(t,i,r),l=o.max3(t,i,r),s=l-e,c=(e+l)/510,u=0;c>0&&c<1&&(u=s/(c<.5?l+e:510-l-e));var h=0;return s>0&&(l===t?h=(i-r)/s:l===i?h=2+(r-t)/s:h=4+(t-i)/s,h*=60,h<0&&(h+=360)),{h,s:u,l:c}}f.rgb2hsl=a},function(b,f){function n(l){return l*(Math.PI/180)}f.degrees2radians=n;function o(l,s,c){var u=l;return u<s&&(u=s),u<c&&(u=c),u}f.max3=o;function a(l,s,c){var u=l;return u>s&&(u=s),u>c&&(u=c),u}f.min3=a;function t(l,s,c){return l>c&&(l=c),l<s&&(l=s),l|0}f.intInRange=t;function i(l){return l=Math.round(l),l>255?l=255:l<0&&(l=0),l}f.inRange0to255Rounded=i;function r(l){return l>255?l=255:l<0&&(l=0),l}f.inRange0to255=r;function e(l,s){var c=typeof l[0],u;if(c==="number"||c==="string"){for(var h=Object.create(null),p=0,_=l.length;p<_;p++){var w=l[p];h[w]||h[w]===0||(h[w]=p)}u=l.sort(function(C,E){return s(C,E)||h[C]-h[E]})}else{var S=l.slice(0);u=l.sort(function(C,E){return s(C,E)||S.indexOf(C)-S.indexOf(E)})}return u}f.stableSort=e},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2lab.ts - part of Image Quantization Library
 */var o=n(4),a=n(8);function t(i,r,e){var l=o.rgb2xyz(i,r,e);return a.xyz2lab(l.x,l.y,l.z)}f.rgb2lab=t},function(b,f){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2lab.ts - part of Image Quantization Library
 */var n=.95047,o=1,a=1.08883;function t(r){return r>.008856?Math.pow(r,1/3):7.787*r+16/116}function i(r,e,l){if(r=t(r/n),e=t(e/o),l=t(l/a),116*e-16<0)throw new Error("xxx");return{L:Math.max(0,116*e-16),a:500*(r-e),b:200*(e-l)}}f.xyz2lab=i},function(b,f){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2xyz.ts - part of Image Quantization Library
 */var n=.95047,o=1,a=1.08883;function t(r){return r>.206893034?Math.pow(r,3):(r-16/116)/7.787}function i(r,e,l){var s=(r+16)/116,c=e/500+s,u=s-l/200;return{x:n*t(c),y:o*t(s),z:a*t(u)}}f.lab2xyz=i},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2rgb.ts - part of Image Quantization Library
 */var o=n(9),a=n(11);function t(i,r,e){var l=o.lab2xyz(i,r,e);return a.xyz2rgb(l.x,l.y,l.z)}f.lab2rgb=t},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2rgb.ts - part of Image Quantization Library
 */var o=n(6);function a(i){return i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i}function t(i,r,e){var l=a(i*3.2406+r*-1.5372+e*-.4986),s=a(i*-.9689+r*1.8758+e*.0415),c=a(i*.0557+r*-.204+e*1.057);return{r:o.inRange0to255Rounded(l*255),g:o.inRange0to255Rounded(s*255),b:o.inRange0to255Rounded(c*255)}}f.xyz2rgb=t},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 */var o=n(13);f.AbstractDistanceCalculator=o.AbstractDistanceCalculator;var a=n(14);f.CIE94Textiles=a.CIE94Textiles,f.CIE94GraphicArts=a.CIE94GraphicArts;var t=n(15);f.CIEDE2000=t.CIEDE2000;var i=n(16);f.CMETRIC=i.CMETRIC;var r=n(17);f.AbstractEuclidean=r.AbstractEuclidean,f.Euclidean=r.Euclidean,f.EuclideanRgbQuantWOAlpha=r.EuclideanRgbQuantWOAlpha,f.EuclideanRgbQuantWithAlpha=r.EuclideanRgbQuantWithAlpha;var e=n(18);f.AbstractManhattan=e.AbstractManhattan,f.Manhattan=e.Manhattan,f.ManhattanSRGB=e.ManhattanSRGB,f.ManhattanNommyde=e.ManhattanNommyde;var l=n(19);f.PNGQUANT=l.PNGQUANT},function(b,f){var n=function(){function o(){this._setDefaults(),this.setWhitePoint(255,255,255,255)}return o.prototype.setWhitePoint=function(a,t,i,r){this._whitePoint={r:a>0?255/a:0,g:t>0?255/t:0,b:i>0?255/i:0,a:r>0?255/r:0},this._maxDistance=this.calculateRaw(a,t,i,r,0,0,0,0)},o.prototype.calculateNormalized=function(a,t){return this.calculateRaw(a.r,a.g,a.b,a.a,t.r,t.g,t.b,t.a)/this._maxDistance},o.prototype._setDefaults=function(){},o}();f.AbstractDistanceCalculator=n},function(b,f,n){var o=this&&this.__extends||function(s,c){for(var u in c)c.hasOwnProperty(u)&&(s[u]=c[u]);function h(){this.constructor=s}s.prototype=c===null?Object.create(c):(h.prototype=c.prototype,new h)};/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cie94.ts - part of Image Quantization Library
 */var a=n(13),t=n(7),i=n(6),r=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype.calculateRaw=function(u,h,p,_,w,S,C,E){var k=t.rgb2lab(i.inRange0to255(u*this._whitePoint.r),i.inRange0to255(h*this._whitePoint.g),i.inRange0to255(p*this._whitePoint.b)),O=t.rgb2lab(i.inRange0to255(w*this._whitePoint.r),i.inRange0to255(S*this._whitePoint.g),i.inRange0to255(C*this._whitePoint.b)),U=k.L-O.L,F=k.a-O.a,M=k.b-O.b,j=Math.sqrt(k.a*k.a+k.b*k.b),G=Math.sqrt(O.a*O.a+O.b*O.b),N=j-G,R=F*F+M*M-N*N;R=R<0?0:Math.sqrt(R);var A=(E-_)*this._whitePoint.a*this._kA;return Math.sqrt(Math.pow(U/this._Kl,2)+Math.pow(N/(1+this._K1*j),2)+Math.pow(R/(1+this._K2*j),2)+Math.pow(A,2))},c}(a.AbstractDistanceCalculator);f.AbstractCIE94=r;var e=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype._setDefaults=function(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=.25*50/255},c}(r);f.CIE94Textiles=e;var l=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype._setDefaults=function(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=.25*100/255},c}(r);f.CIE94GraphicArts=l},function(b,f,n){var o=this&&this.__extends||function(e,l){for(var s in l)l.hasOwnProperty(s)&&(e[s]=l[s]);function c(){this.constructor=e}e.prototype=l===null?Object.create(l):(c.prototype=l.prototype,new c)};/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ciede2000.ts - part of Image Quantization Library
 */var a=n(13),t=n(7),i=n(6),r=function(e){o(l,e);function l(){e.apply(this,arguments)}return l.prototype.calculateRaw=function(s,c,u,h,p,_,w,S){var C=t.rgb2lab(i.inRange0to255(s*this._whitePoint.r),i.inRange0to255(c*this._whitePoint.g),i.inRange0to255(u*this._whitePoint.b)),E=t.rgb2lab(i.inRange0to255(p*this._whitePoint.r),i.inRange0to255(_*this._whitePoint.g),i.inRange0to255(w*this._whitePoint.b)),k=(S-h)*this._whitePoint.a*l._kA,O=this.calculateRawInLab(C,E);return Math.sqrt(O+k*k)},l.prototype.calculateRawInLab=function(s,c){var u=s.L,h=s.a,p=s.b,_=c.L,w=c.a,S=c.b,C=Math.sqrt(h*h+p*p),E=Math.sqrt(w*w+S*S),k=Math.pow((C+E)/2,7),O=.5*(1-Math.sqrt(k/(k+l._pow25to7))),U=(1+O)*h,F=(1+O)*w,M=Math.sqrt(U*U+p*p),j=Math.sqrt(F*F+S*S),G=M*j,N=l._calculatehp(p,U),R=l._calculatehp(S,F),A=Math.abs(N-R),H=_-u,Z=j-M,K=l._calculate_dHp(G,A,R,N),J=l._calculate_ahp(G,A,N,R),D=l._calculateT(J),I=(M+j)/2,W=Math.pow((u+_)/2-50,2),q=1+.015*W/Math.sqrt(20+W),ne=1+.045*I,le=1+.015*D*I,ce=l._calculateRT(J,I),fe=H/q,he=Z/ne,se=K/le;return Math.pow(fe,2)+Math.pow(he,2)+Math.pow(se,2)+ce*he*se},l._calculatehp=function(s,c){var u=Math.atan2(s,c);return u>=0?u:u+l._deg360InRad},l._calculateRT=function(s,c){var u=Math.pow(c,7),h=2*Math.sqrt(u/(u+l._pow25to7)),p=l._deg30InRad*Math.exp(-Math.pow((s-l._deg275InRad)/l._deg25InRad,2));return-Math.sin(2*p)*h},l._calculateT=function(s){return 1-.17*Math.cos(s-l._deg30InRad)+.24*Math.cos(s*2)+.32*Math.cos(s*3+l._deg6InRad)-.2*Math.cos(s*4-l._deg63InRad)},l._calculate_ahp=function(s,c,u,h){var p=u+h;return s==0?p:c<=l._deg180InRad?p/2:p<l._deg360InRad?(p+l._deg360InRad)/2:(p-l._deg360InRad)/2},l._calculate_dHp=function(s,c,u,h){var p;return s==0?p=0:c<=l._deg180InRad?p=u-h:u<=h?p=u-h+l._deg360InRad:p=u-h-l._deg360InRad,2*Math.sqrt(s)*Math.sin(p/2)},l._kA=.25*100/255,l._pow25to7=Math.pow(25,7),l._deg360InRad=i.degrees2radians(360),l._deg180InRad=i.degrees2radians(180),l._deg30InRad=i.degrees2radians(30),l._deg6InRad=i.degrees2radians(6),l._deg63InRad=i.degrees2radians(63),l._deg275InRad=i.degrees2radians(275),l._deg25InRad=i.degrees2radians(25),l}(a.AbstractDistanceCalculator);f.CIEDE2000=r},function(b,f,n){var o=this&&this.__extends||function(i,r){for(var e in r)r.hasOwnProperty(e)&&(i[e]=r[e]);function l(){this.constructor=i}i.prototype=r===null?Object.create(r):(l.prototype=r.prototype,new l)};/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cmetric.ts - part of Image Quantization Library
 */var a=n(13),t=function(i){o(r,i);function r(){i.apply(this,arguments)}return r.prototype.calculateRaw=function(e,l,s,c,u,h,p,_){var w=(e+u)/2*this._whitePoint.r,S=(e-u)*this._whitePoint.r,C=(l-h)*this._whitePoint.g,E=(s-p)*this._whitePoint.b,k=((512+w)*S*S>>8)+4*C*C+((767-w)*E*E>>8),O=(_-c)*this._whitePoint.a;return Math.sqrt(k+O*O)},r}(a.AbstractDistanceCalculator);f.CMETRIC=t},function(b,f,n){var o=this&&this.__extends||function(s,c){for(var u in c)c.hasOwnProperty(u)&&(s[u]=c[u]);function h(){this.constructor=s}s.prototype=c===null?Object.create(c):(h.prototype=c.prototype,new h)};/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * euclidean.ts - part of Image Quantization Library
 */var a=n(13),t=n(2),i=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype.calculateRaw=function(u,h,p,_,w,S,C,E){var k=w-u,O=S-h,U=C-p,F=E-_;return Math.sqrt(this._kR*k*k+this._kG*O*O+this._kB*U*U+this._kA*F*F)},c}(a.AbstractDistanceCalculator);f.AbstractEuclidean=i;var r=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype._setDefaults=function(){this._kR=1,this._kG=1,this._kB=1,this._kA=1},c}(i);f.Euclidean=r;var e=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype._setDefaults=function(){this._kR=t.Y.RED,this._kG=t.Y.GREEN,this._kB=t.Y.BLUE,this._kA=1},c}(i);f.EuclideanRgbQuantWithAlpha=e;var l=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype._setDefaults=function(){this._kR=t.Y.RED,this._kG=t.Y.GREEN,this._kB=t.Y.BLUE,this._kA=0},c}(i);f.EuclideanRgbQuantWOAlpha=l},function(b,f,n){var o=this&&this.__extends||function(s,c){for(var u in c)c.hasOwnProperty(u)&&(s[u]=c[u]);function h(){this.constructor=s}s.prototype=c===null?Object.create(c):(h.prototype=c.prototype,new h)};/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * manhattanNeuQuant.ts - part of Image Quantization Library
 */var a=n(13),t=n(2),i=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype.calculateRaw=function(u,h,p,_,w,S,C,E){var k=w-u,O=S-h,U=C-p,F=E-_;return k<0&&(k=0-k),O<0&&(O=0-O),U<0&&(U=0-U),F<0&&(F=0-F),this._kR*k+this._kG*O+this._kB*U+this._kA*F},c}(a.AbstractDistanceCalculator);f.AbstractManhattan=i;var r=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype._setDefaults=function(){this._kR=1,this._kG=1,this._kB=1,this._kA=1},c}(i);f.Manhattan=r;var e=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype._setDefaults=function(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1},c}(i);f.ManhattanNommyde=e;var l=function(s){o(c,s);function c(){s.apply(this,arguments)}return c.prototype._setDefaults=function(){this._kR=t.Y.RED,this._kG=t.Y.GREEN,this._kB=t.Y.BLUE,this._kA=1},c}(i);f.ManhattanSRGB=l},function(b,f,n){var o=this&&this.__extends||function(i,r){for(var e in r)r.hasOwnProperty(e)&&(i[e]=r[e]);function l(){this.constructor=i}i.prototype=r===null?Object.create(r):(l.prototype=r.prototype,new l)};/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pngQuant.ts - part of Image Quantization Library
 */var a=n(13),t=function(i){o(r,i);function r(){i.apply(this,arguments)}return r.prototype.calculateRaw=function(e,l,s,c,u,h,p,_){var w=(_-c)*this._whitePoint.a;return this._colordifference_ch(e*this._whitePoint.r,u*this._whitePoint.r,w)+this._colordifference_ch(l*this._whitePoint.g,h*this._whitePoint.g,w)+this._colordifference_ch(s*this._whitePoint.b,p*this._whitePoint.b,w)},r.prototype._colordifference_ch=function(e,l,s){var c=e-l,u=c+s;return c*c+u*u},r}(a.AbstractDistanceCalculator);f.PNGQUANT=t},function(b,f,n){var o=n(21);f.NeuQuant=o.NeuQuant;var a=n(25);f.NeuQuantFloat=a.NeuQuantFloat;var t=n(26);f.RGBQuant=t.RGBQuant;var i=n(27);f.ColorHistogram=i.ColorHistogram;var r=n(29);f.WuQuant=r.WuQuant,f.WuColorCube=r.WuColorCube},function(b,f,n){/**
 * @preserve TypeScript port:
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * neuquant.ts - part of Image Quantization Library
 */var o=n(22),a=n(24),t=3,i=function(){function e(l){this.r=this.g=this.b=this.a=l}return e.prototype.toPoint=function(){return a.Point.createByRGBA(this.r>>t,this.g>>t,this.b>>t,this.a>>t)},e.prototype.subtract=function(l,s,c,u){this.r-=l|0,this.g-=s|0,this.b-=c|0,this.a-=u|0},e}(),r=function(){function e(l,s){s===void 0&&(s=256),this._distance=l,this._pointArray=[],this._sampleFactor=1,this._networkSize=s,this._distance.setWhitePoint(255<<t,255<<t,255<<t,255<<t)}return e.prototype.sample=function(l){this._pointArray=this._pointArray.concat(l.getPointArray())},e.prototype.quantize=function(){return this._init(),this._learn(),this._buildPalette()},e.prototype._init=function(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(var l=0;l<this._networkSize;l++)this._network[l]=new i((l<<t+8)/this._networkSize|0),this._freq[l]=e._initialBias/this._networkSize|0,this._bias[l]=0},e.prototype._learn=function(){var l=this._sampleFactor,s=this._pointArray.length;s<e._minpicturebytes&&(l=1);var c=30+(l-1)/3|0,u=s/l|0,h=u/e._nCycles|0,p=e._initAlpha,_=(this._networkSize>>3)*e._radiusBias,w=_>>e._radiusBiasShift;w<=1&&(w=0);for(var S=0;S<w;S++)this._radPower[S]=p*((w*w-S*S)*e._radBias/(w*w))>>>0;var C;s<e._minpicturebytes?C=1:s%e._prime1!=0?C=e._prime1:s%e._prime2!=0?C=e._prime2:s%e._prime3!=0?C=e._prime3:C=e._prime4;for(var S=0,E=0;S<u;){var k=this._pointArray[E],O=k.b<<t,U=k.g<<t,F=k.r<<t,M=k.a<<t,j=this._contest(O,U,F,M);if(this._alterSingle(p,j,O,U,F,M),w!==0&&this._alterNeighbour(w,j,O,U,F,M),E+=C,E>=s&&(E-=s),S++,h===0&&(h=1),S%h===0){p-=p/c|0,_-=_/e._radiusDecrease|0,w=_>>e._radiusBiasShift,w<=1&&(w=0);for(var G=0;G<w;G++)this._radPower[G]=p*((w*w-G*G)*e._radBias/(w*w))>>>0}}},e.prototype._buildPalette=function(){var l=new o.Palette;return this._network.forEach(function(s){l.add(s.toPoint())}),l.sort(),l},e.prototype._alterNeighbour=function(l,s,c,u,h,p){var _=s-l;_<-1&&(_=-1);var w=s+l;w>this._networkSize&&(w=this._networkSize);for(var S=s+1,C=s-1,E=1;S<w||C>_;){var k=this._radPower[E++]/e._alphaRadBias;if(S<w){var O=this._network[S++];O.subtract(k*(O.r-h),k*(O.g-u),k*(O.b-c),k*(O.a-p))}if(C>_){var O=this._network[C--];O.subtract(k*(O.r-h),k*(O.g-u),k*(O.b-c),k*(O.a-p))}}},e.prototype._alterSingle=function(l,s,c,u,h,p){l/=e._initAlpha;var _=this._network[s];_.subtract(l*(_.r-h),l*(_.g-u),l*(_.b-c),l*(_.a-p))},e.prototype._contest=function(l,s,c,u){for(var h=1020<<t,p=~(1<<31),_=p,w=-1,S=w,C=0;C<this._networkSize;C++){var E=this._network[C],k=this._distance.calculateNormalized(E,{r:c,g:s,b:l,a:u})*h|0;k<p&&(p=k,w=C);var O=k-(this._bias[C]>>e._initialBiasShift-t);O<_&&(_=O,S=C);var U=this._freq[C]>>e._betaShift;this._freq[C]-=U,this._bias[C]+=U<<e._gammaShift}return this._freq[w]+=e._beta,this._bias[w]-=e._betaGamma,S},e._prime1=499,e._prime2=491,e._prime3=487,e._prime4=503,e._minpicturebytes=e._prime4,e._nCycles=100,e._initialBiasShift=16,e._initialBias=1<<e._initialBiasShift,e._gammaShift=10,e._betaShift=10,e._beta=e._initialBias>>e._betaShift,e._betaGamma=e._initialBias<<e._gammaShift-e._betaShift,e._radiusBiasShift=6,e._radiusBias=1<<e._radiusBiasShift,e._radiusDecrease=30,e._alphaBiasShift=10,e._initAlpha=1<<e._alphaBiasShift,e._radBiasShift=8,e._radBias=1<<e._radBiasShift,e._alphaRadBiasShift=e._alphaBiasShift+e._radBiasShift,e._alphaRadBias=1<<e._alphaRadBiasShift,e}();f.NeuQuant=r},function(b,f,n){var o=n(23),a=n(5),t=10;function i(e,l){for(var s=360,c=s/l,u=c/2,h=1,p=c-u;h<l;h++,p+=c)if(e>=p&&e<p+c)return h;return 0}f.hueGroup=i;var r=function(){function e(){this._pointArray=[],this._i32idx={},this._pointContainer=new o.PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}return e.prototype.add=function(l){this._pointArray.push(l),this._pointContainer.setWidth(this._pointArray.length)},e.prototype.has=function(l){for(var s=this._pointArray.length-1;s>=0;s--)if(l.uint32===this._pointArray[s].uint32)return!0;return!1},e.prototype.getNearestColor=function(l,s){return this._pointArray[this.getNearestIndex(l,s)|0]},e.prototype.getPointContainer=function(){return this._pointContainer},e.prototype._nearestPointFromCache=function(l){return typeof this._i32idx[l]=="number"?this._i32idx[l]:-1},e.prototype.getNearestIndex=function(l,s){var c=this._nearestPointFromCache(""+s.uint32);if(c>=0)return c;var u=Number.MAX_VALUE;c=0;for(var h=0,p=this._pointArray.length;h<p;h++){var _=this._pointArray[h],w=l.calculateRaw(s.r,s.g,s.b,s.a,_.r,_.g,_.b,_.a);w<u&&(u=w,c=h)}return this._i32idx[s.uint32]=c,c},e.prototype.sort=function(){this._i32idx={},this._pointArray.sort(function(l,s){var c=a.rgb2hsl(l.r,l.g,l.b),u=a.rgb2hsl(s.r,s.g,s.b),h=l.r===l.g&&l.g===l.b?0:1+i(c.h,t),p=s.r===s.g&&s.g===s.b?0:1+i(u.h,t),_=p-h;if(_)return-_;var w=l.getLuminosity(!0),S=s.getLuminosity(!0);if(S-w!==0)return S-w;var C=(u.s*100|0)-(c.s*100|0);return C?-C:0})},e}();f.Palette=r},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pointContainer.ts - part of Image Quantization Library
 */var o=n(24),a=function(){function t(){this._width=0,this._height=0,this._pointArray=[]}return t.prototype.getWidth=function(){return this._width},t.prototype.getHeight=function(){return this._height},t.prototype.setWidth=function(i){this._width=i},t.prototype.setHeight=function(i){this._height=i},t.prototype.getPointArray=function(){return this._pointArray},t.prototype.clone=function(){var i=new t;i._width=this._width,i._height=this._height;for(var r=0,e=this._pointArray.length;r<e;r++)i._pointArray[r]=o.Point.createByUint32(this._pointArray[r].uint32|0);return i},t.prototype.toUint32Array=function(){for(var i=this._pointArray.length,r=new Uint32Array(i),e=0;e<i;e++)r[e]=this._pointArray[e].uint32;return r},t.prototype.toUint8Array=function(){return new Uint8Array(this.toUint32Array().buffer)},t.fromHTMLImageElement=function(i){var r=i.naturalWidth,e=i.naturalHeight,l=document.createElement("canvas");l.width=r,l.height=e;var s=l.getContext("2d");return s.drawImage(i,0,0,r,e,0,0,r,e),t.fromHTMLCanvasElement(l)},t.fromHTMLCanvasElement=function(i){var r=i.width,e=i.height,l=i.getContext("2d"),s=l.getImageData(0,0,r,e);return t.fromImageData(s)},t.fromNodeCanvas=function(i){return t.fromHTMLCanvasElement(i)},t.fromImageData=function(i){var r=i.width,e=i.height;return t.fromCanvasPixelArray(i.data,r,e)},t.fromArray=function(i,r,e){var l=new Uint8Array(i);return t.fromUint8Array(l,r,e)},t.fromCanvasPixelArray=function(i,r,e){return t.fromArray(i,r,e)},t.fromUint8Array=function(i,r,e){return t.fromUint32Array(new Uint32Array(i.buffer),r,e)},t.fromUint32Array=function(i,r,e){var l=new t;l._width=r,l._height=e;for(var s=0,c=i.length;s<c;s++)l._pointArray[s]=o.Point.createByUint32(i[s]|0);return l},t}();f.PointContainer=a},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * point.ts - part of Image Quantization Library
 */var o=n(2),a=function(){function t(){this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}return t.createByQuadruplet=function(i){var r=new t;return r.r=i[0]|0,r.g=i[1]|0,r.b=i[2]|0,r.a=i[3]|0,r._loadUINT32(),r._loadQuadruplet(),r},t.createByRGBA=function(i,r,e,l){var s=new t;return s.r=i|0,s.g=r|0,s.b=e|0,s.a=l|0,s._loadUINT32(),s._loadQuadruplet(),s},t.createByUint32=function(i){var r=new t;return r.uint32=i>>>0,r._loadRGBA(),r._loadQuadruplet(),r},t.prototype.from=function(i){this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.uint32=i.uint32,this.rgba[0]=i.r,this.rgba[1]=i.g,this.rgba[2]=i.b,this.rgba[3]=i.a},t.prototype.getLuminosity=function(i){var r=this.r,e=this.g,l=this.b;return i&&(r=Math.min(255,255-this.a+this.a*r/255),e=Math.min(255,255-this.a+this.a*e/255),l=Math.min(255,255-this.a+this.a*l/255)),r*o.Y.RED+e*o.Y.GREEN+l*o.Y.BLUE},t.prototype._loadUINT32=function(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0},t.prototype._loadRGBA=function(){this.r=this.uint32&255,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255},t.prototype._loadQuadruplet=function(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a},t}();f.Point=a},function(b,f,n){/**
 * @preserve TypeScript port:
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * neuquant.ts - part of Image Quantization Library
 */var o=n(22),a=n(24),t=3,i=function(){function e(l){this.r=this.g=this.b=this.a=l}return e.prototype.toPoint=function(){return a.Point.createByRGBA(this.r>>t,this.g>>t,this.b>>t,this.a>>t)},e.prototype.subtract=function(l,s,c,u){this.r-=l,this.g-=s,this.b-=c,this.a-=u},e}(),r=function(){function e(l,s){s===void 0&&(s=256),this._distance=l,this._pointArray=[],this._sampleFactor=1,this._networkSize=s,this._distance.setWhitePoint(255<<t,255<<t,255<<t,255<<t)}return e.prototype.sample=function(l){this._pointArray=this._pointArray.concat(l.getPointArray())},e.prototype.quantize=function(){return this._init(),this._learn(),this._buildPalette()},e.prototype._init=function(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(var l=0;l<this._networkSize;l++)this._network[l]=new i((l<<t+8)/this._networkSize),this._freq[l]=e._initialBias/this._networkSize,this._bias[l]=0},e.prototype._learn=function(){var l=this._sampleFactor,s=this._pointArray.length;s<e._minpicturebytes&&(l=1);var c=30+(l-1)/3,u=s/l,h=u/e._nCycles|0,p=e._initAlpha,_=(this._networkSize>>3)*e._radiusBias,w=_>>e._radiusBiasShift;w<=1&&(w=0);for(var S=0;S<w;S++)this._radPower[S]=p*((w*w-S*S)*e._radBias/(w*w));var C;s<e._minpicturebytes?C=1:s%e._prime1!=0?C=e._prime1:s%e._prime2!=0?C=e._prime2:s%e._prime3!=0?C=e._prime3:C=e._prime4;for(var S=0,E=0;S<u;){var k=this._pointArray[E],O=k.b<<t,U=k.g<<t,F=k.r<<t,M=k.a<<t,j=this._contest(O,U,F,M);if(this._alterSingle(p,j,O,U,F,M),w!=0&&this._alterNeighbour(w,j,O,U,F,M),E+=C,E>=s&&(E-=s),S++,h==0&&(h=1),S%h==0){p-=p/c,_-=_/e._radiusDecrease,w=_>>e._radiusBiasShift,w<=1&&(w=0);for(var G=0;G<w;G++)this._radPower[G]=p*((w*w-G*G)*e._radBias/(w*w))}}},e.prototype._buildPalette=function(){var l=new o.Palette;return this._network.forEach(function(s){l.add(s.toPoint())}),l.sort(),l},e.prototype._alterNeighbour=function(l,s,c,u,h,p){var _=s-l;_<-1&&(_=-1);var w=s+l;w>this._networkSize&&(w=this._networkSize);for(var S=s+1,C=s-1,E=1;S<w||C>_;){var k=this._radPower[E++]/e._alphaRadBias;if(S<w){var O=this._network[S++];O.subtract(k*(O.r-h),k*(O.g-u),k*(O.b-c),k*(O.a-p))}if(C>_){var O=this._network[C--];O.subtract(k*(O.r-h),k*(O.g-u),k*(O.b-c),k*(O.a-p))}}},e.prototype._alterSingle=function(l,s,c,u,h,p){l/=e._initAlpha;var _=this._network[s];_.subtract(l*(_.r-h),l*(_.g-u),l*(_.b-c),l*(_.a-p))},e.prototype._contest=function(l,s,c,u){for(var h=1020<<t,p=~(1<<31),_=p,w=-1,S=w,C=0;C<this._networkSize;C++){var E=this._network[C],k=this._distance.calculateNormalized(E,{r:c,g:s,b:l,a:u})*h;k<p&&(p=k,w=C);var O=k-(this._bias[C]>>e._initialBiasShift-t);O<_&&(_=O,S=C);var U=this._freq[C]>>e._betaShift;this._freq[C]-=U,this._bias[C]+=U<<e._gammaShift}return this._freq[w]+=e._beta,this._bias[w]-=e._betaGamma,S},e._prime1=499,e._prime2=491,e._prime3=487,e._prime4=503,e._minpicturebytes=e._prime4,e._nCycles=100,e._initialBiasShift=16,e._initialBias=1<<e._initialBiasShift,e._gammaShift=10,e._betaShift=10,e._beta=e._initialBias>>e._betaShift,e._betaGamma=e._initialBias<<e._gammaShift-e._betaShift,e._radiusBiasShift=6,e._radiusBias=1<<e._radiusBiasShift,e._radiusDecrease=30,e._alphaBiasShift=10,e._initAlpha=1<<e._alphaBiasShift,e._radBiasShift=8,e._radBias=1<<e._radBiasShift,e._alphaRadBiasShift=e._alphaBiasShift+e._radBiasShift,e._alphaRadBias=1<<e._alphaRadBiasShift,e}();f.NeuQuantFloat=r},function(b,f,n){/**
 * @preserve TypeScript port:
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgbquant.ts - part of Image Quantization Library
 */var o=n(22),a=n(24),t=n(27),i=n(6),r=function(){function l(s,c,u){this.index=s,this.color=c,this.distance=u}return l}(),e=function(){function l(s,c,u){c===void 0&&(c=256),u===void 0&&(u=2),this._distance=s,this._colors=c,this._histogram=new t.ColorHistogram(u,c),this._initialDistance=.01,this._distanceIncrement=.005}return l.prototype.sample=function(s){this._histogram.sample(s)},l.prototype.quantize=function(){var s=this._histogram.getImportanceSortedColorsIDXI32();if(s.length===0)throw new Error("No colors in image");var c=this._buildPalette(s);return c.sort(),c},l.prototype._buildPalette=function(s){for(var c=new o.Palette,u=c.getPointContainer().getPointArray(),h=new Array(s.length),p=0;p<s.length;p++)u.push(a.Point.createByUint32(s[p])),h[p]=1;for(var _=u.length,w=[],S=_,C=this._initialDistance;S>this._colors;){w.length=0;for(var p=0;p<_;p++)if(h[p]!==0){for(var E=u[p],k=p+1;k<_;k++)if(h[k]!==0){var O=u[k],U=this._distance.calculateNormalized(E,O);U<C&&(w.push(new r(k,O,U)),h[k]=0,S--)}}C+=S>this._colors*3?this._initialDistance:this._distanceIncrement}if(S<this._colors){i.stableSort(w,function(N,R){return R.distance-N.distance});for(var F=0;S<this._colors&&F<w.length;){var M=w[F];h[M.index]=1,S++,F++}}for(var j=u.length,G=j-1;G>=0;G--)h[G]===0&&(G!==j-1&&(u[G]=u[j-1]),--j);return u.length=j,c},l}();f.RGBQuant=e},function(b,f,n){/**
 * @preserve TypeScript port:
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * colorHistogram.ts - part of Image Quantization Library
 */var o=n(28),a=n(6),t=function(){function i(r,e){this._method=r,this._minHueCols=e<<2,this._initColors=e<<2,this._hueStats=new o.HueStatistics(i._hueGroups,this._minHueCols),this._histogram=Object.create(null)}return i.prototype.sample=function(r){switch(this._method){case 1:this._colorStats1D(r);break;case 2:this._colorStats2D(r);break}},i.prototype.getImportanceSortedColorsIDXI32=function(){var r=this,e=a.stableSort(Object.keys(this._histogram),function(_,w){return r._histogram[w]-r._histogram[_]});if(e.length===0)return[];var l;switch(this._method){case 1:var s=Math.min(e.length,this._initColors),c=e[s-1],u=this._histogram[c];l=e.slice(0,s);for(var h=s,p=e.length;h<p&&this._histogram[e[h]]==u;)l.push(e[h++]);this._hueStats.injectIntoArray(l);break;case 2:l=e;break;default:throw new Error("Incorrect method")}return l.map(function(_){return+_})},i.prototype._colorStats1D=function(r){for(var e=this._histogram,l=r.getPointArray(),s=l.length,c=0;c<s;c++){var u=l[c].uint32;this._hueStats.check(u),u in e?e[u]++:e[u]=1}},i.prototype._colorStats2D=function(r){var e=this,l=r.getWidth(),s=r.getHeight(),c=r.getPointArray(),u=i._boxSize[0],h=i._boxSize[1],p=u*h,_=this._makeBoxes(l,s,u,h),w=this._histogram;_.forEach(function(S){var C=Math.round(S.w*S.h/p)*i._boxPixels;C<2&&(C=2);var E={};e._iterateBox(S,l,function(k){var O=c[k].uint32;e._hueStats.check(O),O in w?w[O]++:O in E?++E[O]>=C&&(w[O]=E[O]):E[O]=1})}),this._hueStats.injectIntoDictionary(w)},i.prototype._iterateBox=function(r,e,l){var s=r,c=s.y*e+s.x,u=(s.y+s.h-1)*e+(s.x+s.w-1),h=e-s.w+1,p=0,_=c;do l.call(this,_),_+=++p%s.w==0?h:1;while(_<=u)},i.prototype._makeBoxes=function(r,e,l,s){for(var c=r%l,u=e%s,h=r-c,p=e-u,_=[],w=0;w<e;w+=s)for(var S=0;S<r;S+=l)_.push({x:S,y:w,w:S==h?c:l,h:w==p?u:s});return _},i._boxSize=[64,64],i._boxPixels=2,i._hueGroups=10,i}();f.ColorHistogram=t},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * hueStatistics.ts - part of Image Quantization Library
 */var o=n(5),a=n(22),t=function(){function r(){this.num=0,this.cols=[]}return r}(),i=function(){function r(e,l){this._numGroups=e,this._minCols=l,this._stats=[];for(var s=0;s<=e;s++)this._stats[s]=new t;this._groupsFull=0}return r.prototype.check=function(e){this._groupsFull==this._numGroups+1&&(this.check=function(){});var l=e&255,s=e>>>8&255,c=e>>>16&255,u=l==s&&s==c?0:1+a.hueGroup(o.rgb2hsl(l,s,c).h,this._numGroups),h=this._stats[u],p=this._minCols;h.num++,!(h.num>p)&&(h.num==p&&this._groupsFull++,h.num<=p&&this._stats[u].cols.push(e))},r.prototype.injectIntoDictionary=function(e){for(var l=0;l<=this._numGroups;l++)this._stats[l].num<=this._minCols&&this._stats[l].cols.forEach(function(s){e[s]?e[s]++:e[s]=1})},r.prototype.injectIntoArray=function(e){for(var l=0;l<=this._numGroups;l++)this._stats[l].num<=this._minCols&&this._stats[l].cols.forEach(function(s){e.indexOf(s)==-1&&e.push(s)})},r}();f.HueStatistics=i},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * wuQuant.ts - part of Image Quantization Library
 */var o=n(22),a=n(24);function t(u){for(var h=[],p=0;p<u;p++)h[p]=0;return h}function i(u,h,p,_){for(var w=new Array(u),S=0;S<u;S++){w[S]=new Array(h);for(var C=0;C<h;C++){w[S][C]=new Array(p);for(var E=0;E<p;E++){w[S][C][E]=new Array(_);for(var k=0;k<_;k++)w[S][C][E][k]=0}}}return w}function r(u,h,p){for(var _=new Array(u),w=0;w<u;w++){_[w]=new Array(h);for(var S=0;S<h;S++){_[w][S]=new Array(p);for(var C=0;C<p;C++)_[w][S][C]=0}}return _}function e(u,h,p,_,w){for(var S=0;S<h;S++){u[S]=[];for(var C=0;C<p;C++){u[S][C]=[];for(var E=0;E<_;E++)u[S][C][E]=w}}}function l(u,h,p){for(var _=0;_<h;_++)u[_]=p}var s=function(){function u(){}return u}();f.WuColorCube=s;var c=function(){function u(h,p,_){p===void 0&&(p=256),_===void 0&&(_=5),this._distance=h,this._setQuality(_),this._initialize(p)}return u.prototype.sample=function(h){for(var p=h.getPointArray(),_=0,w=p.length;_<w;_++)this._addColor(p[_]);this._pixels=this._pixels.concat(p)},u.prototype.quantize=function(){this._preparePalette();for(var h=new o.Palette,p=0;p<this._colors;p++)if(this._sums[p]>0){var _=this._sums[p],w=this._reds[p]/_,S=this._greens[p]/_,C=this._blues[p]/_,E=this._alphas[p]/_,k=a.Point.createByRGBA(w|0,S|0,C|0,E|0);h.add(k)}return h.sort(),h},u.prototype._preparePalette=function(){this._calculateMoments();for(var h=0,p=t(this._colors),_=1;_<this._colors;++_){this._cut(this._cubes[h],this._cubes[_])?(p[h]=this._cubes[h].volume>1?this._calculateVariance(this._cubes[h]):0,p[_]=this._cubes[_].volume>1?this._calculateVariance(this._cubes[_]):0):(p[h]=0,_--),h=0;for(var w=p[0],S=1;S<=_;++S)p[S]>w&&(w=p[S],h=S);if(w<=0){this._colors=_+1;break}}for(var C=[],E=[],k=[],O=[],U=0;U<this._colors;++U){var F=u._volume(this._cubes[U],this._weights);F>0?(C[U]=u._volume(this._cubes[U],this._momentsRed)/F|0,E[U]=u._volume(this._cubes[U],this._momentsGreen)/F|0,k[U]=u._volume(this._cubes[U],this._momentsBlue)/F|0,O[U]=u._volume(this._cubes[U],this._momentsAlpha)/F|0):(C[U]=0,E[U]=0,k[U]=0,O[U]=0)}this._reds=t(this._colors+1),this._greens=t(this._colors+1),this._blues=t(this._colors+1),this._alphas=t(this._colors+1),this._sums=t(this._colors+1);for(var S=0,M=this._pixels.length;S<M;S++){for(var j=this._pixels[S],G=-1,N=G,R=Number.MAX_VALUE,A=0;A<this._colors;A++){var H=C[A],Z=E[A],K=k[A],J=O[A],D=this._distance.calculateRaw(H,Z,K,J,j.r,j.g,j.b,j.a);D<R&&(R=D,N=A)}this._reds[N]+=j.r,this._greens[N]+=j.g,this._blues[N]+=j.b,this._alphas[N]+=j.a,this._sums[N]++}},u.prototype._addColor=function(h){var p=8-this._significantBitsPerChannel,_=(h.r>>p)+1,w=(h.g>>p)+1,S=(h.b>>p)+1,C=(h.a>>p)+1;this._weights[C][_][w][S]++,this._momentsRed[C][_][w][S]+=h.r,this._momentsGreen[C][_][w][S]+=h.g,this._momentsBlue[C][_][w][S]+=h.b,this._momentsAlpha[C][_][w][S]+=h.a,this._moments[C][_][w][S]+=this._table[h.r]+this._table[h.g]+this._table[h.b]+this._table[h.a]},u.prototype._calculateMoments=function(){for(var h=[],p=[],_=[],w=[],S=[],C=[],E=r(this._sideSize,this._sideSize,this._sideSize),k=r(this._sideSize,this._sideSize,this._sideSize),O=r(this._sideSize,this._sideSize,this._sideSize),U=r(this._sideSize,this._sideSize,this._sideSize),F=r(this._sideSize,this._sideSize,this._sideSize),M=r(this._sideSize,this._sideSize,this._sideSize),j=1;j<=this._alphaMaxSideIndex;++j){e(E,this._sideSize,this._sideSize,this._sideSize,0),e(k,this._sideSize,this._sideSize,this._sideSize,0),e(O,this._sideSize,this._sideSize,this._sideSize,0),e(U,this._sideSize,this._sideSize,this._sideSize,0),e(F,this._sideSize,this._sideSize,this._sideSize,0),e(M,this._sideSize,this._sideSize,this._sideSize,0);for(var G=1;G<=this._maxSideIndex;++G){l(h,this._sideSize,0),l(p,this._sideSize,0),l(_,this._sideSize,0),l(w,this._sideSize,0),l(S,this._sideSize,0),l(C,this._sideSize,0);for(var N=1;N<=this._maxSideIndex;++N)for(var R=0,A=0,H=0,Z=0,K=0,J=0,D=1;D<=this._maxSideIndex;++D)R+=this._weights[j][G][N][D],A+=this._momentsRed[j][G][N][D],H+=this._momentsGreen[j][G][N][D],Z+=this._momentsBlue[j][G][N][D],K+=this._momentsAlpha[j][G][N][D],J+=this._moments[j][G][N][D],h[D]+=R,p[D]+=A,_[D]+=H,w[D]+=Z,S[D]+=K,C[D]+=J,E[G][N][D]=E[G-1][N][D]+h[D],k[G][N][D]=k[G-1][N][D]+p[D],O[G][N][D]=O[G-1][N][D]+_[D],U[G][N][D]=U[G-1][N][D]+w[D],F[G][N][D]=F[G-1][N][D]+S[D],M[G][N][D]=M[G-1][N][D]+C[D],this._weights[j][G][N][D]=this._weights[j-1][G][N][D]+E[G][N][D],this._momentsRed[j][G][N][D]=this._momentsRed[j-1][G][N][D]+k[G][N][D],this._momentsGreen[j][G][N][D]=this._momentsGreen[j-1][G][N][D]+O[G][N][D],this._momentsBlue[j][G][N][D]=this._momentsBlue[j-1][G][N][D]+U[G][N][D],this._momentsAlpha[j][G][N][D]=this._momentsAlpha[j-1][G][N][D]+F[G][N][D],this._moments[j][G][N][D]=this._moments[j-1][G][N][D]+M[G][N][D]}}},u._volumeFloat=function(h,p){return p[h.alphaMaximum][h.redMaximum][h.greenMaximum][h.blueMaximum]-p[h.alphaMaximum][h.redMaximum][h.greenMinimum][h.blueMaximum]-p[h.alphaMaximum][h.redMinimum][h.greenMaximum][h.blueMaximum]+p[h.alphaMaximum][h.redMinimum][h.greenMinimum][h.blueMaximum]-p[h.alphaMinimum][h.redMaximum][h.greenMaximum][h.blueMaximum]+p[h.alphaMinimum][h.redMaximum][h.greenMinimum][h.blueMaximum]+p[h.alphaMinimum][h.redMinimum][h.greenMaximum][h.blueMaximum]-p[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMaximum]-(p[h.alphaMaximum][h.redMaximum][h.greenMaximum][h.blueMinimum]-p[h.alphaMinimum][h.redMaximum][h.greenMaximum][h.blueMinimum]-p[h.alphaMaximum][h.redMaximum][h.greenMinimum][h.blueMinimum]+p[h.alphaMinimum][h.redMaximum][h.greenMinimum][h.blueMinimum]-p[h.alphaMaximum][h.redMinimum][h.greenMaximum][h.blueMinimum]+p[h.alphaMinimum][h.redMinimum][h.greenMaximum][h.blueMinimum]+p[h.alphaMaximum][h.redMinimum][h.greenMinimum][h.blueMinimum]-p[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMinimum])},u._volume=function(h,p){return u._volumeFloat(h,p)|0},u._top=function(h,p,_,w){var S;switch(p){case u.alpha:S=w[_][h.redMaximum][h.greenMaximum][h.blueMaximum]-w[_][h.redMaximum][h.greenMinimum][h.blueMaximum]-w[_][h.redMinimum][h.greenMaximum][h.blueMaximum]+w[_][h.redMinimum][h.greenMinimum][h.blueMaximum]-(w[_][h.redMaximum][h.greenMaximum][h.blueMinimum]-w[_][h.redMaximum][h.greenMinimum][h.blueMinimum]-w[_][h.redMinimum][h.greenMaximum][h.blueMinimum]+w[_][h.redMinimum][h.greenMinimum][h.blueMinimum]);break;case u.red:S=w[h.alphaMaximum][_][h.greenMaximum][h.blueMaximum]-w[h.alphaMaximum][_][h.greenMinimum][h.blueMaximum]-w[h.alphaMinimum][_][h.greenMaximum][h.blueMaximum]+w[h.alphaMinimum][_][h.greenMinimum][h.blueMaximum]-(w[h.alphaMaximum][_][h.greenMaximum][h.blueMinimum]-w[h.alphaMaximum][_][h.greenMinimum][h.blueMinimum]-w[h.alphaMinimum][_][h.greenMaximum][h.blueMinimum]+w[h.alphaMinimum][_][h.greenMinimum][h.blueMinimum]);break;case u.green:S=w[h.alphaMaximum][h.redMaximum][_][h.blueMaximum]-w[h.alphaMaximum][h.redMinimum][_][h.blueMaximum]-w[h.alphaMinimum][h.redMaximum][_][h.blueMaximum]+w[h.alphaMinimum][h.redMinimum][_][h.blueMaximum]-(w[h.alphaMaximum][h.redMaximum][_][h.blueMinimum]-w[h.alphaMaximum][h.redMinimum][_][h.blueMinimum]-w[h.alphaMinimum][h.redMaximum][_][h.blueMinimum]+w[h.alphaMinimum][h.redMinimum][_][h.blueMinimum]);break;case u.blue:S=w[h.alphaMaximum][h.redMaximum][h.greenMaximum][_]-w[h.alphaMaximum][h.redMaximum][h.greenMinimum][_]-w[h.alphaMaximum][h.redMinimum][h.greenMaximum][_]+w[h.alphaMaximum][h.redMinimum][h.greenMinimum][_]-(w[h.alphaMinimum][h.redMaximum][h.greenMaximum][_]-w[h.alphaMinimum][h.redMaximum][h.greenMinimum][_]-w[h.alphaMinimum][h.redMinimum][h.greenMaximum][_]+w[h.alphaMinimum][h.redMinimum][h.greenMinimum][_]);break;default:throw new Error("impossible")}return S|0},u._bottom=function(h,p,_){switch(p){case u.alpha:return-_[h.alphaMinimum][h.redMaximum][h.greenMaximum][h.blueMaximum]+_[h.alphaMinimum][h.redMaximum][h.greenMinimum][h.blueMaximum]+_[h.alphaMinimum][h.redMinimum][h.greenMaximum][h.blueMaximum]-_[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMaximum]-(-_[h.alphaMinimum][h.redMaximum][h.greenMaximum][h.blueMinimum]+_[h.alphaMinimum][h.redMaximum][h.greenMinimum][h.blueMinimum]+_[h.alphaMinimum][h.redMinimum][h.greenMaximum][h.blueMinimum]-_[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMinimum]);case u.red:return-_[h.alphaMaximum][h.redMinimum][h.greenMaximum][h.blueMaximum]+_[h.alphaMaximum][h.redMinimum][h.greenMinimum][h.blueMaximum]+_[h.alphaMinimum][h.redMinimum][h.greenMaximum][h.blueMaximum]-_[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMaximum]-(-_[h.alphaMaximum][h.redMinimum][h.greenMaximum][h.blueMinimum]+_[h.alphaMaximum][h.redMinimum][h.greenMinimum][h.blueMinimum]+_[h.alphaMinimum][h.redMinimum][h.greenMaximum][h.blueMinimum]-_[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMinimum]);case u.green:return-_[h.alphaMaximum][h.redMaximum][h.greenMinimum][h.blueMaximum]+_[h.alphaMaximum][h.redMinimum][h.greenMinimum][h.blueMaximum]+_[h.alphaMinimum][h.redMaximum][h.greenMinimum][h.blueMaximum]-_[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMaximum]-(-_[h.alphaMaximum][h.redMaximum][h.greenMinimum][h.blueMinimum]+_[h.alphaMaximum][h.redMinimum][h.greenMinimum][h.blueMinimum]+_[h.alphaMinimum][h.redMaximum][h.greenMinimum][h.blueMinimum]-_[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMinimum]);case u.blue:return-_[h.alphaMaximum][h.redMaximum][h.greenMaximum][h.blueMinimum]+_[h.alphaMaximum][h.redMaximum][h.greenMinimum][h.blueMinimum]+_[h.alphaMaximum][h.redMinimum][h.greenMaximum][h.blueMinimum]-_[h.alphaMaximum][h.redMinimum][h.greenMinimum][h.blueMinimum]-(-_[h.alphaMinimum][h.redMaximum][h.greenMaximum][h.blueMinimum]+_[h.alphaMinimum][h.redMaximum][h.greenMinimum][h.blueMinimum]+_[h.alphaMinimum][h.redMinimum][h.greenMaximum][h.blueMinimum]-_[h.alphaMinimum][h.redMinimum][h.greenMinimum][h.blueMinimum]);default:return 0}},u.prototype._calculateVariance=function(h){var p=u._volume(h,this._momentsRed),_=u._volume(h,this._momentsGreen),w=u._volume(h,this._momentsBlue),S=u._volume(h,this._momentsAlpha),C=u._volumeFloat(h,this._moments),E=u._volume(h,this._weights),k=p*p+_*_+w*w+S*S;return C-k/E},u.prototype._maximize=function(h,p,_,w,S,C,E,k,O){for(var U=u._bottom(h,p,this._momentsRed)|0,F=u._bottom(h,p,this._momentsGreen)|0,M=u._bottom(h,p,this._momentsBlue)|0,j=u._bottom(h,p,this._momentsAlpha)|0,G=u._bottom(h,p,this._weights)|0,N=0,R=-1,A=_;A<w;++A){var H=U+u._top(h,p,A,this._momentsRed),Z=F+u._top(h,p,A,this._momentsGreen),K=M+u._top(h,p,A,this._momentsBlue),J=j+u._top(h,p,A,this._momentsAlpha),D=G+u._top(h,p,A,this._weights);if(D!=0){var I=H*H+Z*Z+K*K+J*J,W=I/D;H=S-H,Z=C-Z,K=E-K,J=k-J,D=O-D,D!=0&&(I=H*H+Z*Z+K*K+J*J,W+=I/D,W>N&&(N=W,R=A))}}return{max:N,position:R}},u.prototype._cut=function(h,p){var _,w=u._volume(h,this._momentsRed),S=u._volume(h,this._momentsGreen),C=u._volume(h,this._momentsBlue),E=u._volume(h,this._momentsAlpha),k=u._volume(h,this._weights),O=this._maximize(h,u.red,h.redMinimum+1,h.redMaximum,w,S,C,E,k),U=this._maximize(h,u.green,h.greenMinimum+1,h.greenMaximum,w,S,C,E,k),F=this._maximize(h,u.blue,h.blueMinimum+1,h.blueMaximum,w,S,C,E,k),M=this._maximize(h,u.alpha,h.alphaMinimum+1,h.alphaMaximum,w,S,C,E,k);if(M.max>=O.max&&M.max>=U.max&&M.max>=F.max){if(_=u.alpha,M.position<0)return!1}else O.max>=M.max&&O.max>=U.max&&O.max>=F.max?_=u.red:U.max>=M.max&&U.max>=O.max&&U.max>=F.max?_=u.green:_=u.blue;switch(p.redMaximum=h.redMaximum,p.greenMaximum=h.greenMaximum,p.blueMaximum=h.blueMaximum,p.alphaMaximum=h.alphaMaximum,_){case u.red:p.redMinimum=h.redMaximum=O.position,p.greenMinimum=h.greenMinimum,p.blueMinimum=h.blueMinimum,p.alphaMinimum=h.alphaMinimum;break;case u.green:p.greenMinimum=h.greenMaximum=U.position,p.redMinimum=h.redMinimum,p.blueMinimum=h.blueMinimum,p.alphaMinimum=h.alphaMinimum;break;case u.blue:p.blueMinimum=h.blueMaximum=F.position,p.redMinimum=h.redMinimum,p.greenMinimum=h.greenMinimum,p.alphaMinimum=h.alphaMinimum;break;case u.alpha:p.alphaMinimum=h.alphaMaximum=M.position,p.blueMinimum=h.blueMinimum,p.redMinimum=h.redMinimum,p.greenMinimum=h.greenMinimum;break}return h.volume=(h.redMaximum-h.redMinimum)*(h.greenMaximum-h.greenMinimum)*(h.blueMaximum-h.blueMinimum)*(h.alphaMaximum-h.alphaMinimum),p.volume=(p.redMaximum-p.redMinimum)*(p.greenMaximum-p.greenMinimum)*(p.blueMaximum-p.blueMinimum)*(p.alphaMaximum-p.alphaMinimum),!0},u.prototype._initialize=function(h){this._colors=h,this._cubes=[];for(var p=0;p<h;p++)this._cubes[p]=new s;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=i(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=i(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=i(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=i(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=i(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=i(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(var _=0;_<256;++_)this._table[_]=_*_;this._pixels=[]},u.prototype._setQuality=function(h){h===void 0&&(h=5),this._significantBitsPerChannel=h,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1},u.alpha=3,u.red=2,u.green=1,u.blue=0,u}();f.WuQuant=c},function(b,f,n){var o=n(31);f.NearestColor=o.NearestColor;var a=n(32);f.ErrorDiffusionArray=a.ErrorDiffusionArray,f.ErrorDiffusionArrayKernel=a.ErrorDiffusionArrayKernel;var t=n(33);f.ErrorDiffusionRiemersma=t.ErrorDiffusionRiemersma},function(b,f){var n=function(){function o(a){this._distance=a}return o.prototype.quantize=function(a,t){for(var i=a.getPointArray(),r=a.getWidth(),e=a.getHeight(),l=0;l<e;l++)for(var s=0,c=l*r;s<r;s++,c++){var u=i[c];u.from(t.getNearestColor(this._distance,u))}return a},o}();f.NearestColor=n},function(b,f,n){var o=n(24),a=n(6);(function(r){r[r.FloydSteinberg=0]="FloydSteinberg",r[r.FalseFloydSteinberg=1]="FalseFloydSteinberg",r[r.Stucki=2]="Stucki",r[r.Atkinson=3]="Atkinson",r[r.Jarvis=4]="Jarvis",r[r.Burkes=5]="Burkes",r[r.Sierra=6]="Sierra",r[r.TwoSierra=7]="TwoSierra",r[r.SierraLite=8]="SierraLite"})(f.ErrorDiffusionArrayKernel||(f.ErrorDiffusionArrayKernel={}));var t=f.ErrorDiffusionArrayKernel,i=function(){function r(e,l,s,c,u){s===void 0&&(s=!0),c===void 0&&(c=0),u===void 0&&(u=!1),this._setKernel(l),this._distance=e,this._minColorDistance=c,this._serpentine=s,this._calculateErrorLikeGIMP=u}return r.prototype.quantize=function(e,l){for(var s=e.getPointArray(),c=new o.Point,u=e.getWidth(),h=e.getHeight(),p=[],_=1,w=1,S=0;S<this._kernel.length;S++){var C=this._kernel[S][2]+1;w<C&&(w=C)}for(var S=0;S<w;S++)this._fillErrorLine(p[S]=[],u);for(var E=0;E<h;E++){this._serpentine&&(_=_*-1);var k=E*u,O=_==1?0:u-1,U=_==1?u:-1;this._fillErrorLine(p[0],u),p.push(p.shift());for(var F=p[0],M=O,j=k+O;M!==U;M+=_,j+=_){var G=s[j],N=F[M];c.from(G);var R=o.Point.createByRGBA(a.inRange0to255Rounded(G.r+N[0]),a.inRange0to255Rounded(G.g+N[1]),a.inRange0to255Rounded(G.b+N[2]),a.inRange0to255Rounded(G.a+N[3])),A=l.getNearestColor(this._distance,R);if(G.from(A),this._minColorDistance){var H=this._distance.calculateNormalized(G,A);if(H<this._minColorDistance)continue}var Z=void 0,K=void 0,J=void 0,D=void 0;this._calculateErrorLikeGIMP?(Z=R.r-A.r,K=R.g-A.g,J=R.b-A.b,D=R.a-A.a):(Z=c.r-A.r,K=c.g-A.g,J=c.b-A.b,D=c.a-A.a);for(var I=_==1?0:this._kernel.length-1,W=_==1?this._kernel.length:-1,S=I;S!==W;S+=_){var q=this._kernel[S][1]*_,ne=this._kernel[S][2];if(q+M>=0&&q+M<u&&ne+E>=0&&ne+E<h){var le=this._kernel[S][0],ce=p[ne][q+M];ce[0]=ce[0]+Z*le,ce[1]=ce[1]+K*le,ce[2]=ce[2]+J*le,ce[3]=ce[3]+D*le}}}}return e},r.prototype._fillErrorLine=function(e,l){e.length>l&&(e.length=l);for(var s=e.length,c=0;c<s;c++){var u=e[c];u[0]=u[1]=u[2]=u[3]=0}for(var c=s;c<l;c++)e[c]=[0,0,0,0]},r.prototype._setKernel=function(e){switch(e){case t.FloydSteinberg:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case t.FalseFloydSteinberg:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case t.Stucki:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case t.Atkinson:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case t.Jarvis:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case t.Burkes:this._kernel=[[8/32,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[8/32,0,1],[4/32,1,1],[2/32,2,1]];break;case t.Sierra:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case t.TwoSierra:this._kernel=[[4/16,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case t.SierraLite:this._kernel=[[2/4,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error("ErrorDiffusionArray: unknown kernel = "+e)}},r}();f.ErrorDiffusionArray=i},function(b,f,n){var o=n(34),a=n(24),t=n(6),i=function(){function r(e,l,s){l===void 0&&(l=16),s===void 0&&(s=1),this._distance=e,this._errorPropagation=s,this._errorQueueSize=l,this._max=this._errorQueueSize,this._createWeights()}return r.prototype.quantize=function(e,l){for(var s=this,c=new o.HilbertCurveBase,u=e.getPointArray(),h=e.getWidth(),p=e.getHeight(),_=[],w=0,S=0;S<this._errorQueueSize;S++)_[S]={r:0,g:0,b:0,a:0};return c.walk(h,p,function(C,E){for(var k=u[C+E*h],O=k.r,U=k.g,F=k.b,M=k.a,j=0;j<s._errorQueueSize;j++){var G=s._weights[j],N=_[(j+w)%s._errorQueueSize];O+=N.r*G,U+=N.g*G,F+=N.b*G,M+=N.a*G}var R=a.Point.createByRGBA(t.inRange0to255Rounded(O),t.inRange0to255Rounded(U),t.inRange0to255Rounded(F),t.inRange0to255Rounded(M)),A=l.getNearestColor(s._distance,R);w=(w+1)%s._errorQueueSize;var H=(w+s._errorQueueSize-1)%s._errorQueueSize;_[H].r=k.r-A.r,_[H].g=k.g-A.g,_[H].b=k.b-A.b,_[H].a=k.a-A.a,k.from(A)}),e},r.prototype._createWeights=function(){this._weights=[];for(var e=Math.exp(Math.log(this._max)/(this._errorQueueSize-1)),l=0,s=1;l<this._errorQueueSize;l++)this._weights[l]=(s+.5|0)/this._max*this._errorPropagation,s*=e},r}();f.ErrorDiffusionRiemersma=i},function(b,f){var n;(function(a){a[a.NONE=0]="NONE",a[a.UP=1]="UP",a[a.LEFT=2]="LEFT",a[a.RIGHT=3]="RIGHT",a[a.DOWN=4]="DOWN"})(n||(n={}));var o=function(){function a(){}return a.prototype.walk=function(t,i,r){this._x=0,this._y=0,this._d=0,this._width=t,this._height=i,this._callback=r;var e=Math.max(t,i);this._level=Math.log(e)/Math.log(2)+1|0,this._walkHilbert(n.UP),this._visit(n.NONE)},a.prototype._walkHilbert=function(t){if(!(this._level<1)){switch(this._level--,t){case n.LEFT:this._walkHilbert(n.UP),this._visit(n.RIGHT),this._walkHilbert(n.LEFT),this._visit(n.DOWN),this._walkHilbert(n.LEFT),this._visit(n.LEFT),this._walkHilbert(n.DOWN);break;case n.RIGHT:this._walkHilbert(n.DOWN),this._visit(n.LEFT),this._walkHilbert(n.RIGHT),this._visit(n.UP),this._walkHilbert(n.RIGHT),this._visit(n.RIGHT),this._walkHilbert(n.UP);break;case n.UP:this._walkHilbert(n.LEFT),this._visit(n.DOWN),this._walkHilbert(n.UP),this._visit(n.RIGHT),this._walkHilbert(n.UP),this._visit(n.UP),this._walkHilbert(n.RIGHT);break;case n.DOWN:this._walkHilbert(n.RIGHT),this._visit(n.UP),this._walkHilbert(n.DOWN),this._visit(n.LEFT),this._walkHilbert(n.DOWN),this._visit(n.DOWN),this._walkHilbert(n.LEFT);break}this._level++}},a.prototype._visit=function(t){switch(this._x>=0&&this._x<this._width&&this._y>=0&&this._y<this._height&&(this._callback(this._x,this._y,this._d),this._d++),t){case n.LEFT:this._x--;break;case n.RIGHT:this._x++;break;case n.UP:this._y--;break;case n.DOWN:this._y++;break}},a}();f.HilbertCurveBase=o},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 */var o=n(36);f.SSIM=o.SSIM},function(b,f,n){var o=n(2),a=.01,t=.03,i=function(){function r(){}return r.prototype.compare=function(e,l){if(e.getHeight()!==l.getHeight()||e.getWidth()!==l.getWidth())throw new Error("Images have different sizes!");var s=8,c=(1<<s)-1,u=Math.pow(a*c,2),h=Math.pow(t*c,2),p=0,_=0;return this._iterate(e,l,function(w,S,C,E){for(var k=0,O=0,U=0,F=0;F<w.length;F++)O+=Math.pow(w[F]-C,2),U+=Math.pow(S[F]-E,2),k+=(w[F]-C)*(S[F]-E);var M=w.length-1;O/=M,U/=M,k/=M;var j=(2*C*E+u)*(2*k+h),G=(Math.pow(C,2)+Math.pow(E,2)+u)*(O+U+h),N=j/G;_+=N,p++}),_/p},r.prototype._iterate=function(e,l,s){for(var c=8,u=e.getWidth(),h=e.getHeight(),p=0;p<h;p+=c)for(var _=0;_<u;_+=c){var w=Math.min(c,u-_),S=Math.min(c,h-p),C=this._calculateLumaValuesForWindow(e,_,p,w,S),E=this._calculateLumaValuesForWindow(l,_,p,w,S),k=this._calculateAverageLuma(C),O=this._calculateAverageLuma(E);s(C,E,k,O)}},r.prototype._calculateLumaValuesForWindow=function(e,l,s,c,u){for(var h=e.getPointArray(),p=[],_=0,w=s;w<s+u;w++)for(var S=w*e.getWidth(),C=l;C<l+c;C++){var E=h[S+C];p[_]=E.r*o.Y.RED+E.g*o.Y.GREEN+E.b*o.Y.BLUE,_++}return p},r.prototype._calculateAverageLuma=function(e){for(var l=0,s=0;s<e.length;s++)l+=e[s];return l/e.length},r}();f.SSIM=i},function(b,f,n){/**
 * @preserve
 * Copyright 2015-2016 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 */var o=n(6);f.arithmetic=o;var a=n(28);f.HueStatistics=a.HueStatistics;var t=n(22);f.Palette=t.Palette;var i=n(24);f.Point=i.Point;var r=n(23);f.PointContainer=r.PointContainer}])})},{}],75:[function(m,x,g){typeof Object.create=="function"?x.exports=function(f,n){n&&(f.super_=n,f.prototype=Object.create(n.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}))}:x.exports=function(f,n){if(n){f.super_=n;var o=function(){};o.prototype=n.prototype,f.prototype=new o,f.prototype.constructor=f}}},{}],76:[function(m,x,g){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */x.exports=function(n){return n!=null&&(b(n)||f(n)||!!n._isBuffer)};function b(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function f(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&b(n.slice(0,0))}},{}],77:[function(m,x,g){var b=Function.prototype.toString,f=/^\s*class\b/,n=function(l){try{var s=b.call(l);return f.test(s)}catch(c){return!1}},o=function(l){try{return n(l)?!1:(b.call(l),!0)}catch(s){return!1}},a=Object.prototype.toString,t="[object Function]",i="[object GeneratorFunction]",r=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol";x.exports=function(l){if(!l||typeof l!="function"&&typeof l!="object")return!1;if(typeof l=="function"&&!l.prototype)return!0;if(r)return o(l);if(n(l))return!1;var s=a.call(l);return s===t||s===i}},{}],78:[function(m,x,g){x.exports=f;var b=Object.prototype.toString;function f(n){var o=b.call(n);return o==="[object Function]"||typeof n=="function"&&o!=="[object RegExp]"||typeof y<"u"&&(n===y.setTimeout||n===y.alert||n===y.confirm||n===y.prompt)}},{}],79:[function(m,x,g){var b={}.toString;x.exports=Array.isArray||function(f){return b.call(f)=="[object Array]"}},{}],80:[function(m,x,g){var b=m("./lib/encoder"),f=m("./lib/decoder");x.exports={encode:b,decode:f}},{"./lib/decoder":81,"./lib/encoder":82}],81:[function(m,x,g){(function(b){var f=function(){var a=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,i=799,r=3406,e=2276,l=1567,s=3784,c=5793,u=2896;function h(){}function p(O,U){for(var F=0,M=[],j,G,N=16;N>0&&!O[N-1];)N--;M.push({children:[],index:0});var R=M[0],A;for(j=0;j<N;j++){for(G=0;G<O[j];G++){for(R=M.pop(),R.children[R.index]=U[F];R.index>0;){if(M.length===0)throw new Error("Could not recreate Huffman Table");R=M.pop()}for(R.index++,M.push(R);M.length<=j;)M.push(A={children:[],index:0}),R.children[R.index]=A.children,R=A;F++}j+1<N&&(M.push(A={children:[],index:0}),R.children[R.index]=A.children,R=A)}return M[0].children}function _(O,U,F,M,j,G,N,R,A,H){F.precision,F.samplesPerLine,F.scanLines;var Z=F.mcusPerLine,K=F.progressive;F.maxH,F.maxV;var J=U,D=0,I=0;function W(){if(I>0)return I--,D>>I&1;if(D=O[U++],D==255){var Se=O[U++];if(Se)throw new Error("unexpected marker: "+(D<<8|Se).toString(16))}return I=7,D>>>7}function q(Se){for(var Ee=Se,Ce;(Ce=W())!==null;){if(Ee=Ee[Ce],typeof Ee=="number")return Ee;if(typeof Ee!="object")throw new Error("invalid huffman sequence")}return null}function ne(Se){for(var Ee=0;Se>0;){var Ce=W();if(Ce===null)return;Ee=Ee<<1|Ce,Se--}return Ee}function le(Se){var Ee=ne(Se);return Ee>=1<<Se-1?Ee:Ee+(-1<<Se)+1}function ce(Se,Ee){var Ce=q(Se.huffmanTableDC),Ie=Ce===0?0:le(Ce);Ee[0]=Se.pred+=Ie;for(var Ae=1;Ae<64;){var $=q(Se.huffmanTableAC),be=$&15,ge=$>>4;if(be===0){if(ge<15)break;Ae+=16;continue}Ae+=ge;var ke=a[Ae];Ee[ke]=le(be),Ae++}}function fe(Se,Ee){var Ce=q(Se.huffmanTableDC),Ie=Ce===0?0:le(Ce)<<A;Ee[0]=Se.pred+=Ie}function he(Se,Ee){Ee[0]|=W()<<A}var se=0;function ie(Se,Ee){if(se>0){se--;return}for(var Ce=G,Ie=N;Ce<=Ie;){var Ae=q(Se.huffmanTableAC),$=Ae&15,be=Ae>>4;if($===0){if(be<15){se=ne(be)+(1<<be)-1;break}Ce+=16;continue}Ce+=be;var ge=a[Ce];Ee[ge]=le($)*(1<<A),Ce++}}var Q=0,re;function te(Se,Ee){for(var Ce=G,Ie=N,Ae=0;Ce<=Ie;){var $=a[Ce],be=Ee[$]<0?-1:1;switch(Q){case 0:var ge=q(Se.huffmanTableAC),ke=ge&15,Ae=ge>>4;if(ke===0)Ae<15?(se=ne(Ae)+(1<<Ae),Q=4):(Ae=16,Q=1);else{if(ke!==1)throw new Error("invalid ACn encoding");re=le(ke),Q=Ae?2:3}continue;case 1:case 2:Ee[$]?Ee[$]+=(W()<<A)*be:(Ae--,Ae===0&&(Q=Q==2?3:0));break;case 3:Ee[$]?Ee[$]+=(W()<<A)*be:(Ee[$]=re<<A,Q=0);break;case 4:Ee[$]&&(Ee[$]+=(W()<<A)*be);break}Ce++}Q===4&&(se--,se===0&&(Q=0))}function V(Se,Ee,Ce,Ie,Ae){var $=Ce/Z|0,be=Ce%Z,ge=$*Se.v+Ie,ke=be*Se.h+Ae;Se.blocks[ge]===void 0&&H.tolerantDecoding||Ee(Se,Se.blocks[ge][ke])}function z(Se,Ee,Ce){var Ie=Ce/Se.blocksPerLine|0,Ae=Ce%Se.blocksPerLine;Se.blocks[Ie]===void 0&&H.tolerantDecoding||Ee(Se,Se.blocks[Ie][Ae])}var B=M.length,ee,Y,L,P,ae,ue;K?G===0?ue=R===0?fe:he:ue=R===0?ie:te:ue=ce;var ve=0,_e,Te;B==1?Te=M[0].blocksPerLine*M[0].blocksPerColumn:Te=Z*F.mcusPerColumn,j||(j=Te);for(var Re,Le;ve<Te;){for(Y=0;Y<B;Y++)M[Y].pred=0;if(se=0,B==1)for(ee=M[0],ae=0;ae<j;ae++)z(ee,ue,ve),ve++;else for(ae=0;ae<j;ae++){for(Y=0;Y<B;Y++)for(ee=M[Y],Re=ee.h,Le=ee.v,L=0;L<Le;L++)for(P=0;P<Re;P++)V(ee,ue,ve,L,P);if(ve++,ve===Te)break}if(ve===Te)do{if(O[U]===255&&O[U+1]!==0)break;U+=1}while(U<O.length-2);if(I=0,_e=O[U]<<8|O[U+1],_e<65280)throw new Error("marker was not found");if(_e>=65488&&_e<=65495)U+=2;else break}return U-J}function w(O,U){var F=[],M=U.blocksPerLine,j=U.blocksPerColumn,G=M<<3,N=new Int32Array(64),R=new Uint8Array(64);function A(ne,le,ce){var fe=U.quantizationTable,he,se,ie,Q,re,te,V,z,B,ee=ce,Y;for(Y=0;Y<64;Y++)ee[Y]=ne[Y]*fe[Y];for(Y=0;Y<8;++Y){var L=8*Y;if(ee[1+L]==0&&ee[2+L]==0&&ee[3+L]==0&&ee[4+L]==0&&ee[5+L]==0&&ee[6+L]==0&&ee[7+L]==0){B=c*ee[0+L]+512>>10,ee[0+L]=B,ee[1+L]=B,ee[2+L]=B,ee[3+L]=B,ee[4+L]=B,ee[5+L]=B,ee[6+L]=B,ee[7+L]=B;continue}he=c*ee[0+L]+128>>8,se=c*ee[4+L]+128>>8,ie=ee[2+L],Q=ee[6+L],re=u*(ee[1+L]-ee[7+L])+128>>8,z=u*(ee[1+L]+ee[7+L])+128>>8,te=ee[3+L]<<4,V=ee[5+L]<<4,B=he-se+1>>1,he=he+se+1>>1,se=B,B=ie*s+Q*l+128>>8,ie=ie*l-Q*s+128>>8,Q=B,B=re-V+1>>1,re=re+V+1>>1,V=B,B=z+te+1>>1,te=z-te+1>>1,z=B,B=he-Q+1>>1,he=he+Q+1>>1,Q=B,B=se-ie+1>>1,se=se+ie+1>>1,ie=B,B=re*e+z*r+2048>>12,re=re*r-z*e+2048>>12,z=B,B=te*i+V*t+2048>>12,te=te*t-V*i+2048>>12,V=B,ee[0+L]=he+z,ee[7+L]=he-z,ee[1+L]=se+V,ee[6+L]=se-V,ee[2+L]=ie+te,ee[5+L]=ie-te,ee[3+L]=Q+re,ee[4+L]=Q-re}for(Y=0;Y<8;++Y){var P=Y;if(ee[8+P]==0&&ee[16+P]==0&&ee[24+P]==0&&ee[32+P]==0&&ee[40+P]==0&&ee[48+P]==0&&ee[56+P]==0){B=c*ce[Y+0]+8192>>14,ee[0+P]=B,ee[8+P]=B,ee[16+P]=B,ee[24+P]=B,ee[32+P]=B,ee[40+P]=B,ee[48+P]=B,ee[56+P]=B;continue}he=c*ee[0+P]+2048>>12,se=c*ee[32+P]+2048>>12,ie=ee[16+P],Q=ee[48+P],re=u*(ee[8+P]-ee[56+P])+2048>>12,z=u*(ee[8+P]+ee[56+P])+2048>>12,te=ee[24+P],V=ee[40+P],B=he-se+1>>1,he=he+se+1>>1,se=B,B=ie*s+Q*l+2048>>12,ie=ie*l-Q*s+2048>>12,Q=B,B=re-V+1>>1,re=re+V+1>>1,V=B,B=z+te+1>>1,te=z-te+1>>1,z=B,B=he-Q+1>>1,he=he+Q+1>>1,Q=B,B=se-ie+1>>1,se=se+ie+1>>1,ie=B,B=re*e+z*r+2048>>12,re=re*r-z*e+2048>>12,z=B,B=te*i+V*t+2048>>12,te=te*t-V*i+2048>>12,V=B,ee[0+P]=he+z,ee[56+P]=he-z,ee[8+P]=se+V,ee[48+P]=se-V,ee[16+P]=ie+te,ee[40+P]=ie-te,ee[24+P]=Q+re,ee[32+P]=Q-re}for(Y=0;Y<64;++Y){var ae=128+(ee[Y]+8>>4);le[Y]=ae<0?0:ae>255?255:ae}}k(G*j*8);for(var H,Z,K=0;K<j;K++){var J=K<<3;for(H=0;H<8;H++)F.push(new Uint8Array(G));for(var D=0;D<M;D++){A(U.blocks[K][D],R,N);var I=0,W=D<<3;for(Z=0;Z<8;Z++){var q=F[J+Z];for(H=0;H<8;H++)q[W+H]=R[I++]}}}return F}function S(O){return O<0?0:O>255?255:O}h.prototype={load:function(U){var F=new XMLHttpRequest;F.open("GET",U,!0),F.responseType="arraybuffer",F.onload=(function(){var M=new Uint8Array(F.response||F.mozResponseArrayBuffer);this.parse(M),this.onload&&this.onload()}).bind(this),F.send(null)},parse:function(U){var F=this.opts.maxResolutionInMP*1e3*1e3,M=0;U.length;function j(){var Ae=U[M]<<8|U[M+1];return M+=2,Ae}function G(){var Ae=j(),$=U.subarray(M,M+Ae-2);return M+=$.length,$}function N(Ae){var $=0,be=0,ge,ke;for(ke in Ae.components)Ae.components.hasOwnProperty(ke)&&(ge=Ae.components[ke],$<ge.h&&($=ge.h),be<ge.v&&(be=ge.v));var pe=Math.ceil(Ae.samplesPerLine/8/$),we=Math.ceil(Ae.scanLines/8/be);for(ke in Ae.components)if(Ae.components.hasOwnProperty(ke)){ge=Ae.components[ke];var oe=Math.ceil(Math.ceil(Ae.samplesPerLine/8)*ge.h/$),Ue=Math.ceil(Math.ceil(Ae.scanLines/8)*ge.v/be),ze=pe*ge.h,T=we*ge.v,me=T*ze,ye=[];k(me*256);for(var X=0;X<T;X++){for(var de=[],xe=0;xe<ze;xe++)de.push(new Int32Array(64));ye.push(de)}ge.blocksPerLine=oe,ge.blocksPerColumn=Ue,ge.blocks=ye}Ae.maxH=$,Ae.maxV=be,Ae.mcusPerLine=pe,Ae.mcusPerColumn=we}var R=null,A=null,H,Z,K=[],J=[],D=[],I=[],W=j();if(W!=65496)throw new Error("SOI not found");for(W=j();W!=65497;){var q,ne;switch(W){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var le=G();W===65504&&le[0]===74&&le[1]===70&&le[2]===73&&le[3]===70&&le[4]===0&&(R={version:{major:le[5],minor:le[6]},densityUnits:le[7],xDensity:le[8]<<8|le[9],yDensity:le[10]<<8|le[11],thumbWidth:le[12],thumbHeight:le[13],thumbData:le.subarray(14,14+3*le[12]*le[13])}),W===65505&&le[0]===69&&le[1]===120&&le[2]===105&&le[3]===102&&le[4]===0&&(this.exifBuffer=le.subarray(5,le.length)),W===65518&&le[0]===65&&le[1]===100&&le[2]===111&&le[3]===98&&le[4]===101&&le[5]===0&&(A={version:le[6],flags0:le[7]<<8|le[8],flags1:le[9]<<8|le[10],transformCode:le[11]});break;case 65499:for(var ce=j(),fe=ce+M-2;M<fe;){var he=U[M++];k(256);var se=new Int32Array(64);if(he>>4)if(he>>4===1)for(ne=0;ne<64;ne++){var ie=a[ne];se[ie]=j()}else throw new Error("DQT: invalid table spec");else for(ne=0;ne<64;ne++){var ie=a[ne];se[ie]=U[M++]}K[he&15]=se}break;case 65472:case 65473:case 65474:j(),H={},H.extended=W===65473,H.progressive=W===65474,H.precision=U[M++],H.scanLines=j(),H.samplesPerLine=j(),H.components={},H.componentsOrder=[];var Q=H.scanLines*H.samplesPerLine;if(Q>F){var re=Math.ceil((Q-F)/1e6);throw new Error("maxResolutionInMP limit exceeded by ".concat(re,"MP"))}var te=U[M++],V;for(q=0;q<te;q++){V=U[M];var z=U[M+1]>>4,B=U[M+1]&15,ee=U[M+2];H.componentsOrder.push(V),H.components[V]={h:z,v:B,quantizationIdx:ee},M+=3}N(H),J.push(H);break;case 65476:var Y=j();for(q=2;q<Y;){var L=U[M++],P=new Uint8Array(16),ae=0;for(ne=0;ne<16;ne++,M++)ae+=P[ne]=U[M];k(16+ae);var ue=new Uint8Array(ae);for(ne=0;ne<ae;ne++,M++)ue[ne]=U[M];q+=17+ae,(L>>4?D:I)[L&15]=p(P,ue)}break;case 65501:j(),Z=j();break;case 65498:j();var ve=U[M++],_e=[],Te;for(q=0;q<ve;q++){Te=H.components[U[M++]];var Re=U[M++];Te.huffmanTableDC=I[Re>>4],Te.huffmanTableAC=D[Re&15],_e.push(Te)}var Le=U[M++],Se=U[M++],Ee=U[M++],Ce=_(U,M,H,_e,Z,Le,Se,Ee>>4,Ee&15,this.opts);M+=Ce;break;case 65535:U[M]!==255&&M--;break;default:if(U[M-3]==255&&U[M-2]>=192&&U[M-2]<=254){M-=3;break}throw new Error("unknown JPEG marker "+W.toString(16))}W=j()}if(J.length!=1)throw new Error("only single frame JPEGs supported");for(var q=0;q<J.length;q++){var Ie=J[q].components;for(var ne in Ie)Ie[ne].quantizationTable=K[Ie[ne].quantizationIdx],delete Ie[ne].quantizationIdx}this.width=H.samplesPerLine,this.height=H.scanLines,this.jfif=R,this.adobe=A,this.components=[];for(var q=0;q<H.componentsOrder.length;q++){var Te=H.components[H.componentsOrder[q]];this.components.push({lines:w(H,Te),scaleX:Te.h/H.maxH,scaleY:Te.v/H.maxV})}},getData:function(U,F){var M=this.width/U,j=this.height/F,G,N,R,A,H,Z,K,J,D,I,W=0,q,ne,le,ce,fe,he,se,ie,Q,re,te,V=U*F*this.components.length;k(V);var z=new Uint8Array(V);switch(this.components.length){case 1:for(G=this.components[0],I=0;I<F;I++)for(H=G.lines[0|I*G.scaleY*j],D=0;D<U;D++)q=H[0|D*G.scaleX*M],z[W++]=q;break;case 2:for(G=this.components[0],N=this.components[1],I=0;I<F;I++)for(H=G.lines[0|I*G.scaleY*j],Z=N.lines[0|I*N.scaleY*j],D=0;D<U;D++)q=H[0|D*G.scaleX*M],z[W++]=q,q=Z[0|D*N.scaleX*M],z[W++]=q;break;case 3:for(te=!0,this.adobe&&this.adobe.transformCode?te=!0:typeof this.opts.colorTransform<"u"&&(te=!!this.opts.colorTransform),G=this.components[0],N=this.components[1],R=this.components[2],I=0;I<F;I++)for(H=G.lines[0|I*G.scaleY*j],Z=N.lines[0|I*N.scaleY*j],K=R.lines[0|I*R.scaleY*j],D=0;D<U;D++)te?(q=H[0|D*G.scaleX*M],ne=Z[0|D*N.scaleX*M],le=K[0|D*R.scaleX*M],ie=S(q+1.402*(le-128)),Q=S(q-.3441363*(ne-128)-.71413636*(le-128)),re=S(q+1.772*(ne-128))):(ie=H[0|D*G.scaleX*M],Q=Z[0|D*N.scaleX*M],re=K[0|D*R.scaleX*M]),z[W++]=ie,z[W++]=Q,z[W++]=re;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(te=!1,this.adobe&&this.adobe.transformCode?te=!0:typeof this.opts.colorTransform<"u"&&(te=!!this.opts.colorTransform),G=this.components[0],N=this.components[1],R=this.components[2],A=this.components[3],I=0;I<F;I++)for(H=G.lines[0|I*G.scaleY*j],Z=N.lines[0|I*N.scaleY*j],K=R.lines[0|I*R.scaleY*j],J=A.lines[0|I*A.scaleY*j],D=0;D<U;D++)te?(q=H[0|D*G.scaleX*M],ne=Z[0|D*N.scaleX*M],le=K[0|D*R.scaleX*M],ce=J[0|D*A.scaleX*M],fe=255-S(q+1.402*(le-128)),he=255-S(q-.3441363*(ne-128)-.71413636*(le-128)),se=255-S(q+1.772*(ne-128))):(fe=H[0|D*G.scaleX*M],he=Z[0|D*N.scaleX*M],se=K[0|D*R.scaleX*M],ce=J[0|D*A.scaleX*M]),z[W++]=255-fe,z[W++]=255-he,z[W++]=255-se,z[W++]=255-ce;break;default:throw new Error("Unsupported color mode")}return z},copyToImageData:function(U,F){var M=U.width,j=U.height,G=U.data,N=this.getData(M,j),R=0,A=0,H,Z,K,J,D,I,W,q,ne;switch(this.components.length){case 1:for(Z=0;Z<j;Z++)for(H=0;H<M;H++)K=N[R++],G[A++]=K,G[A++]=K,G[A++]=K,F&&(G[A++]=255);break;case 3:for(Z=0;Z<j;Z++)for(H=0;H<M;H++)W=N[R++],q=N[R++],ne=N[R++],G[A++]=W,G[A++]=q,G[A++]=ne,F&&(G[A++]=255);break;case 4:for(Z=0;Z<j;Z++)for(H=0;H<M;H++)D=N[R++],I=N[R++],K=N[R++],J=N[R++],W=255-S(D*(1-J/255)+J),q=255-S(I*(1-J/255)+J),ne=255-S(K*(1-J/255)+J),G[A++]=W,G[A++]=q,G[A++]=ne,F&&(G[A++]=255);break;default:throw new Error("Unsupported color mode")}}};var C=0,E=0;function k(O=0){var U=C+O;if(U>E){var F=Math.ceil((U-E)/1024/1024);throw new Error("maxMemoryUsageInMB limit exceeded by at least ".concat(F,"MB"))}C=U}return h.resetMaxMemoryUsage=function(O){C=0,E=O},h.getBytesAllocated=function(){return C},h.requestMemoryAllocation=k,h}();typeof x<"u"?x.exports=n:typeof y<"u"&&(y["jpeg-js"]=y["jpeg-js"]||{},y["jpeg-js"].decode=n);function n(o,a={}){var t={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},i={...t,...a},r=new Uint8Array(o),e=new f;e.opts=i,f.resetMaxMemoryUsage(i.maxMemoryUsageInMB*1024*1024),e.parse(r);var l=i.formatAsRGBA?4:3,s=e.width*e.height*l;try{f.requestMemoryAllocation(s);var c={width:e.width,height:e.height,exifBuffer:e.exifBuffer,data:i.useTArray?new Uint8Array(s):new b(s)}}catch(u){throw u instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+s):u}return e.copyToImageData(c,i.formatAsRGBA),c}}).call(this,m("buffer").Buffer)},{buffer:48}],82:[function(m,x,g){(function(b){function f(o){var a=Math.floor,t=new Array(64),i=new Array(64),r=new Array(64),e=new Array(64),l,s,c,u,h=new Array(65535),p=new Array(65535),_=new Array(64),w=new Array(64),S=[],C=0,E=7,k=new Array(64),O=new Array(64),U=new Array(64),F=new Array(256),M=new Array(2048),j,G=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],N=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],H=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Z=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],K=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],D=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function I(P){for(var ae=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ue=0;ue<64;ue++){var ve=a((ae[ue]*P+50)/100);ve<1?ve=1:ve>255&&(ve=255),t[G[ue]]=ve}for(var _e=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Te=0;Te<64;Te++){var Re=a((_e[Te]*P+50)/100);Re<1?Re=1:Re>255&&(Re=255),i[G[Te]]=Re}for(var Le=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Se=0,Ee=0;Ee<8;Ee++)for(var Ce=0;Ce<8;Ce++)r[Se]=1/(t[G[Se]]*Le[Ee]*Le[Ce]*8),e[Se]=1/(i[G[Se]]*Le[Ee]*Le[Ce]*8),Se++}function W(P,ae){for(var ue=0,ve=0,_e=new Array,Te=1;Te<=16;Te++){for(var Re=1;Re<=P[Te];Re++)_e[ae[ve]]=[],_e[ae[ve]][0]=ue,_e[ae[ve]][1]=Te,ve++,ue++;ue*=2}return _e}function q(){l=W(N,R),s=W(Z,K),c=W(A,H),u=W(J,D)}function ne(){for(var P=1,ae=2,ue=1;ue<=15;ue++){for(var ve=P;ve<ae;ve++)p[32767+ve]=ue,h[32767+ve]=[],h[32767+ve][1]=ue,h[32767+ve][0]=ve;for(var _e=-(ae-1);_e<=-P;_e++)p[32767+_e]=ue,h[32767+_e]=[],h[32767+_e][1]=ue,h[32767+_e][0]=ae-1+_e;P<<=1,ae<<=1}}function le(){for(var P=0;P<256;P++)M[P]=19595*P,M[P+256>>0]=38470*P,M[P+512>>0]=7471*P+32768,M[P+768>>0]=-11059*P,M[P+1024>>0]=-21709*P,M[P+1280>>0]=32768*P+8421375,M[P+1536>>0]=-27439*P,M[P+1792>>0]=-5329*P}function ce(P){for(var ae=P[0],ue=P[1]-1;ue>=0;)ae&1<<ue&&(C|=1<<E),ue--,E--,E<0&&(C==255?(fe(255),fe(0)):fe(C),E=7,C=0)}function fe(P){S.push(P)}function he(P){fe(P>>8&255),fe(P&255)}function se(P,ae){var ue,ve,_e,Te,Re,Le,Se,Ee,Ce=0,Ie,Ae=8,$=64;for(Ie=0;Ie<Ae;++Ie){ue=P[Ce],ve=P[Ce+1],_e=P[Ce+2],Te=P[Ce+3],Re=P[Ce+4],Le=P[Ce+5],Se=P[Ce+6],Ee=P[Ce+7];var be=ue+Ee,ge=ue-Ee,ke=ve+Se,pe=ve-Se,we=_e+Le,oe=_e-Le,Ue=Te+Re,ze=Te-Re,T=be+Ue,me=be-Ue,ye=ke+we,X=ke-we;P[Ce]=T+ye,P[Ce+4]=T-ye;var de=(X+me)*.707106781;P[Ce+2]=me+de,P[Ce+6]=me-de,T=ze+oe,ye=oe+pe,X=pe+ge;var xe=(T-X)*.382683433,Pe=.5411961*T+xe,Oe=1.306562965*X+xe,Ne=ye*.707106781,je=ge+Ne,bt=ge-Ne;P[Ce+5]=bt+Pe,P[Ce+3]=bt-Pe,P[Ce+1]=je+Oe,P[Ce+7]=je-Oe,Ce+=8}for(Ce=0,Ie=0;Ie<Ae;++Ie){ue=P[Ce],ve=P[Ce+8],_e=P[Ce+16],Te=P[Ce+24],Re=P[Ce+32],Le=P[Ce+40],Se=P[Ce+48],Ee=P[Ce+56];var Je=ue+Ee,Ye=ue-Ee,it=ve+Se,ct=ve-Se,wt=_e+Le,ir=_e-Le,ar=Te+Re,ft=Te-Re,gt=Je+ar,dt=Je-ar,Ut=it+wt,kt=it-wt;P[Ce]=gt+Ut,P[Ce+32]=gt-Ut;var Rr=(kt+dt)*.707106781;P[Ce+16]=dt+Rr,P[Ce+48]=dt-Rr,gt=ft+ir,Ut=ir+ct,kt=ct+Ye;var Na=(gt-kt)*.382683433,za=.5411961*gt+Na,ja=1.306562965*kt+Na,Ha=Ut*.707106781,Ga=Ye+Ha,Wa=Ye-Ha;P[Ce+40]=Wa+za,P[Ce+24]=Wa-za,P[Ce+8]=Ga+ja,P[Ce+56]=Ga-ja,Ce++}var qr;for(Ie=0;Ie<$;++Ie)qr=P[Ie]*ae[Ie],_[Ie]=qr>0?qr+.5|0:qr-.5|0;return _}function ie(){he(65504),he(16),fe(74),fe(70),fe(73),fe(70),fe(0),fe(1),fe(1),fe(0),he(1),he(1),fe(0),fe(0)}function Q(P){if(P){he(65505),P[0]===69&&P[1]===120&&P[2]===105&&P[3]===102?he(P.length+2):(he(P.length+5+2),fe(69),fe(120),fe(105),fe(102),fe(0));for(var ae=0;ae<P.length;ae++)fe(P[ae])}}function re(P,ae){he(65472),he(17),fe(8),he(ae),he(P),fe(3),fe(1),fe(17),fe(0),fe(2),fe(17),fe(1),fe(3),fe(17),fe(1)}function te(){he(65499),he(132),fe(0);for(var P=0;P<64;P++)fe(t[P]);fe(1);for(var ae=0;ae<64;ae++)fe(i[ae])}function V(){he(65476),he(418),fe(0);for(var P=0;P<16;P++)fe(N[P+1]);for(var ae=0;ae<=11;ae++)fe(R[ae]);fe(16);for(var ue=0;ue<16;ue++)fe(A[ue+1]);for(var ve=0;ve<=161;ve++)fe(H[ve]);fe(1);for(var _e=0;_e<16;_e++)fe(Z[_e+1]);for(var Te=0;Te<=11;Te++)fe(K[Te]);fe(17);for(var Re=0;Re<16;Re++)fe(J[Re+1]);for(var Le=0;Le<=161;Le++)fe(D[Le])}function z(){he(65498),he(12),fe(3),fe(1),fe(0),fe(2),fe(17),fe(3),fe(17),fe(0),fe(63),fe(0)}function B(P,ae,ue,ve,_e){for(var Te=_e[0],Re=_e[240],Le,Se=16,Ee=63,Ce=64,Ie=se(P,ae),Ae=0;Ae<Ce;++Ae)w[G[Ae]]=Ie[Ae];var $=w[0]-ue;ue=w[0],$==0?ce(ve[0]):(Le=32767+$,ce(ve[p[Le]]),ce(h[Le]));for(var be=63;be>0&&w[be]==0;be--);if(be==0)return ce(Te),ue;for(var ge=1,ke;ge<=be;){for(var pe=ge;w[ge]==0&&ge<=be;++ge);var we=ge-pe;if(we>=Se){ke=we>>4;for(var oe=1;oe<=ke;++oe)ce(Re);we=we&15}Le=32767+w[ge],ce(_e[(we<<4)+p[Le]]),ce(h[Le]),ge++}return be!=Ee&&ce(Te),ue}function ee(){for(var P=String.fromCharCode,ae=0;ae<256;ae++)F[ae]=P(ae)}this.encode=function(P,ae){new Date().getTime(),ae&&Y(ae),S=new Array,C=0,E=7,he(65496),ie(),Q(P.exifBuffer),te(),re(P.width,P.height),V(),z();var ue=0,ve=0,_e=0;C=0,E=7,this.encode.displayName="_encode_";for(var Te=P.data,Re=P.width,Le=P.height,Se=Re*4,Ee,Ce=0,Ie,Ae,$,be,ge,ke,pe,we;Ce<Le;){for(Ee=0;Ee<Se;){for(be=Se*Ce+Ee,ge=be,ke=-1,pe=0,we=0;we<64;we++)pe=we>>3,ke=(we&7)*4,ge=be+pe*Se+ke,Ce+pe>=Le&&(ge-=Se*(Ce+1+pe-Le)),Ee+ke>=Se&&(ge-=Ee+ke-Se+4),Ie=Te[ge++],Ae=Te[ge++],$=Te[ge++],k[we]=(M[Ie]+M[Ae+256>>0]+M[$+512>>0]>>16)-128,O[we]=(M[Ie+768>>0]+M[Ae+1024>>0]+M[$+1280>>0]>>16)-128,U[we]=(M[Ie+1280>>0]+M[Ae+1536>>0]+M[$+1792>>0]>>16)-128;ue=B(k,r,ue,l,c),ve=B(O,e,ve,s,u),_e=B(U,e,_e,s,u),Ee+=32}Ce+=8}if(E>=0){var oe=[];oe[1]=E+1,oe[0]=(1<<E+1)-1,ce(oe)}return he(65497),typeof x>"u"?new Uint8Array(S):new b(S)};function Y(P){if(P<=0&&(P=1),P>100&&(P=100),j!=P){var ae=0;P<50?ae=Math.floor(5e3/P):ae=Math.floor(200-P*2),I(ae),j=P}}function L(){var P=new Date().getTime();o||(o=50),ee(),q(),ne(),le(),Y(o),new Date().getTime()-P}L()}typeof x<"u"?x.exports=n:typeof y<"u"&&(y["jpeg-js"]=y["jpeg-js"]||{},y["jpeg-js"].encode=n);function n(o,a){typeof a>"u"&&(a=50);var t=new f(a),i=t.encode(o,a);return{data:i,width:o.width,height:o.height}}}).call(this,m("buffer").Buffer)},{buffer:48}],83:[function(m,x,g){(function(b){var f=m("path"),n=m("fs"),o=parseInt("0777",8);x.exports=a.mkdirp=a.mkdirP=a;function a(t,i,r,e){typeof i=="function"?(r=i,i={}):(!i||typeof i!="object")&&(i={mode:i});var l=i.mode,s=i.fs||n;l===void 0&&(l=o&~b.umask()),e||(e=null);var c=r||function(){};t=f.resolve(t),s.mkdir(t,l,function(u){if(!u)return e=e||t,c(null,e);switch(u.code){case"ENOENT":a(f.dirname(t),i,function(h,p){h?c(h,p):a(t,i,c,p)});break;default:s.stat(t,function(h,p){h||!p.isDirectory()?c(u,e):c(null,e)});break}})}a.sync=function t(i,r,e){(!r||typeof r!="object")&&(r={mode:r});var l=r.mode,s=r.fs||n;l===void 0&&(l=o&~b.umask()),e||(e=null),i=f.resolve(i);try{s.mkdirSync(i,l),e=e||i}catch(u){switch(u.code){case"ENOENT":e=t(f.dirname(i),r,e),t(i,r,e);break;default:var c;try{c=s.statSync(i)}catch(h){throw u}if(!c.isDirectory())throw u;break}}return e}}).call(this,m("_process"))},{_process:133,fs:47,path:107}],84:[function(m,x,g){var b=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function o(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function a(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var i={},r=0;r<10;r++)i["_"+String.fromCharCode(r)]=r;var e=Object.getOwnPropertyNames(i).map(function(s){return i[s]});if(e.join("")!=="0123456789")return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(s){l[s]=s}),Object.keys(Object.assign({},l)).join("")==="abcdefghijklmnopqrst"}catch(s){return!1}}x.exports=a()?Object.assign:function(t,i){for(var r,e=o(t),l,s=1;s<arguments.length;s++){r=Object(arguments[s]);for(var c in r)f.call(r,c)&&(e[c]=r[c]);if(b){l=b(r);for(var u=0;u<l.length;u++)n.call(r,l[u])&&(e[l[u]]=r[l[u]])}}return e}},{}],85:[function(m,x,g){arguments[4][64][0].apply(g,arguments)},{dup:64}],86:[function(m,x,g){var b=m("./lib/utils/common").assign,f=m("./lib/deflate"),n=m("./lib/inflate"),o=m("./lib/zlib/constants"),a={};b(a,f,n,o),x.exports=a},{"./lib/deflate":87,"./lib/inflate":88,"./lib/utils/common":89,"./lib/zlib/constants":92}],87:[function(m,x,g){var b=m("./zlib/deflate"),f=m("./utils/common"),n=m("./utils/strings"),o=m("./zlib/messages"),a=m("./zlib/zstream"),t=Object.prototype.toString,i=0,r=4,e=0,l=1,s=2,c=-1,u=0,h=8;function p(C){if(!(this instanceof p))return new p(C);this.options=f.assign({level:c,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},C||{});var E=this.options;E.raw&&E.windowBits>0?E.windowBits=-E.windowBits:E.gzip&&E.windowBits>0&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var k=b.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(k!==e)throw new Error(o[k]);if(E.header&&b.deflateSetHeader(this.strm,E.header),E.dictionary){var O;if(typeof E.dictionary=="string"?O=n.string2buf(E.dictionary):t.call(E.dictionary)==="[object ArrayBuffer]"?O=new Uint8Array(E.dictionary):O=E.dictionary,k=b.deflateSetDictionary(this.strm,O),k!==e)throw new Error(o[k]);this._dict_set=!0}}p.prototype.push=function(C,E){var k=this.strm,O=this.options.chunkSize,U,F;if(this.ended)return!1;F=E===~~E?E:E===!0?r:i,typeof C=="string"?k.input=n.string2buf(C):t.call(C)==="[object ArrayBuffer]"?k.input=new Uint8Array(C):k.input=C,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new f.Buf8(O),k.next_out=0,k.avail_out=O),U=b.deflate(k,F),U!==l&&U!==e)return this.onEnd(U),this.ended=!0,!1;(k.avail_out===0||k.avail_in===0&&(F===r||F===s))&&(this.options.to==="string"?this.onData(n.buf2binstring(f.shrinkBuf(k.output,k.next_out))):this.onData(f.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&U!==l);return F===r?(U=b.deflateEnd(this.strm),this.onEnd(U),this.ended=!0,U===e):(F===s&&(this.onEnd(e),k.avail_out=0),!0)},p.prototype.onData=function(C){this.chunks.push(C)},p.prototype.onEnd=function(C){C===e&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=C,this.msg=this.strm.msg};function _(C,E){var k=new p(E);if(k.push(C,!0),k.err)throw k.msg||o[k.err];return k.result}function w(C,E){return E=E||{},E.raw=!0,_(C,E)}function S(C,E){return E=E||{},E.gzip=!0,_(C,E)}g.Deflate=p,g.deflate=_,g.deflateRaw=w,g.gzip=S},{"./utils/common":89,"./utils/strings":90,"./zlib/deflate":94,"./zlib/messages":99,"./zlib/zstream":101}],88:[function(m,x,g){var b=m("./zlib/inflate"),f=m("./utils/common"),n=m("./utils/strings"),o=m("./zlib/constants"),a=m("./zlib/messages"),t=m("./zlib/zstream"),i=m("./zlib/gzheader"),r=Object.prototype.toString;function e(c){if(!(this instanceof e))return new e(c);this.options=f.assign({chunkSize:16384,windowBits:0,to:""},c||{});var u=this.options;u.raw&&u.windowBits>=0&&u.windowBits<16&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),u.windowBits>=0&&u.windowBits<16&&!(c&&c.windowBits)&&(u.windowBits+=32),u.windowBits>15&&u.windowBits<48&&(u.windowBits&15||(u.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new t,this.strm.avail_out=0;var h=b.inflateInit2(this.strm,u.windowBits);if(h!==o.Z_OK)throw new Error(a[h]);this.header=new i,b.inflateGetHeader(this.strm,this.header)}e.prototype.push=function(c,u){var h=this.strm,p=this.options.chunkSize,_=this.options.dictionary,w,S,C,E,k,O,U=!1;if(this.ended)return!1;S=u===~~u?u:u===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof c=="string"?h.input=n.binstring2buf(c):r.call(c)==="[object ArrayBuffer]"?h.input=new Uint8Array(c):h.input=c,h.next_in=0,h.avail_in=h.input.length;do{if(h.avail_out===0&&(h.output=new f.Buf8(p),h.next_out=0,h.avail_out=p),w=b.inflate(h,o.Z_NO_FLUSH),w===o.Z_NEED_DICT&&_&&(typeof _=="string"?O=n.string2buf(_):r.call(_)==="[object ArrayBuffer]"?O=new Uint8Array(_):O=_,w=b.inflateSetDictionary(this.strm,O)),w===o.Z_BUF_ERROR&&U===!0&&(w=o.Z_OK,U=!1),w!==o.Z_STREAM_END&&w!==o.Z_OK)return this.onEnd(w),this.ended=!0,!1;h.next_out&&(h.avail_out===0||w===o.Z_STREAM_END||h.avail_in===0&&(S===o.Z_FINISH||S===o.Z_SYNC_FLUSH))&&(this.options.to==="string"?(C=n.utf8border(h.output,h.next_out),E=h.next_out-C,k=n.buf2string(h.output,C),h.next_out=E,h.avail_out=p-E,E&&f.arraySet(h.output,h.output,C,E,0),this.onData(k)):this.onData(f.shrinkBuf(h.output,h.next_out))),h.avail_in===0&&h.avail_out===0&&(U=!0)}while((h.avail_in>0||h.avail_out===0)&&w!==o.Z_STREAM_END);return w===o.Z_STREAM_END&&(S=o.Z_FINISH),S===o.Z_FINISH?(w=b.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===o.Z_OK):(S===o.Z_SYNC_FLUSH&&(this.onEnd(o.Z_OK),h.avail_out=0),!0)},e.prototype.onData=function(c){this.chunks.push(c)},e.prototype.onEnd=function(c){c===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg};function l(c,u){var h=new e(u);if(h.push(c,!0),h.err)throw h.msg||a[h.err];return h.result}function s(c,u){return u=u||{},u.raw=!0,l(c,u)}g.Inflate=e,g.inflate=l,g.inflateRaw=s,g.ungzip=l},{"./utils/common":89,"./utils/strings":90,"./zlib/constants":92,"./zlib/gzheader":95,"./zlib/inflate":97,"./zlib/messages":99,"./zlib/zstream":101}],89:[function(m,x,g){arguments[4][36][0].apply(g,arguments)},{dup:36}],90:[function(m,x,g){var b=m("./common"),f=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch(i){f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(i){n=!1}for(var o=new b.Buf8(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;o[254]=o[254]=1,g.string2buf=function(i){var r,e,l,s,c,u=i.length,h=0;for(s=0;s<u;s++)e=i.charCodeAt(s),(e&64512)===55296&&s+1<u&&(l=i.charCodeAt(s+1),(l&64512)===56320&&(e=65536+(e-55296<<10)+(l-56320),s++)),h+=e<128?1:e<2048?2:e<65536?3:4;for(r=new b.Buf8(h),c=0,s=0;c<h;s++)e=i.charCodeAt(s),(e&64512)===55296&&s+1<u&&(l=i.charCodeAt(s+1),(l&64512)===56320&&(e=65536+(e-55296<<10)+(l-56320),s++)),e<128?r[c++]=e:e<2048?(r[c++]=192|e>>>6,r[c++]=128|e&63):e<65536?(r[c++]=224|e>>>12,r[c++]=128|e>>>6&63,r[c++]=128|e&63):(r[c++]=240|e>>>18,r[c++]=128|e>>>12&63,r[c++]=128|e>>>6&63,r[c++]=128|e&63);return r};function t(i,r){if(r<65537&&(i.subarray&&n||!i.subarray&&f))return String.fromCharCode.apply(null,b.shrinkBuf(i,r));for(var e="",l=0;l<r;l++)e+=String.fromCharCode(i[l]);return e}g.buf2binstring=function(i){return t(i,i.length)},g.binstring2buf=function(i){for(var r=new b.Buf8(i.length),e=0,l=r.length;e<l;e++)r[e]=i.charCodeAt(e);return r},g.buf2string=function(i,r){var e,l,s,c,u=r||i.length,h=new Array(u*2);for(l=0,e=0;e<u;){if(s=i[e++],s<128){h[l++]=s;continue}if(c=o[s],c>4){h[l++]=65533,e+=c-1;continue}for(s&=c===2?31:c===3?15:7;c>1&&e<u;)s=s<<6|i[e++]&63,c--;if(c>1){h[l++]=65533;continue}s<65536?h[l++]=s:(s-=65536,h[l++]=55296|s>>10&1023,h[l++]=56320|s&1023)}return t(h,l)},g.utf8border=function(i,r){var e;for(r=r||i.length,r>i.length&&(r=i.length),e=r-1;e>=0&&(i[e]&192)===128;)e--;return e<0||e===0?r:e+o[i[e]]>r?e:r}},{"./common":89}],91:[function(m,x,g){arguments[4][37][0].apply(g,arguments)},{dup:37}],92:[function(m,x,g){arguments[4][38][0].apply(g,arguments)},{dup:38}],93:[function(m,x,g){arguments[4][39][0].apply(g,arguments)},{dup:39}],94:[function(m,x,g){var b=m("../utils/common"),f=m("./trees"),n=m("./adler32"),o=m("./crc32"),a=m("./messages"),t=0,i=1,r=3,e=4,l=5,s=0,c=1,u=-2,h=-3,p=-5,_=-1,w=1,S=2,C=3,E=4,k=0,O=2,U=8,F=9,M=15,j=8,G=29,N=256,R=N+1+G,A=30,H=19,Z=2*R+1,K=15,J=3,D=258,I=D+J+1,W=32,q=42,ne=69,le=73,ce=91,fe=103,he=113,se=666,ie=1,Q=2,re=3,te=4,V=3;function z(T,me){return T.msg=a[me],me}function B(T){return(T<<1)-(T>4?9:0)}function ee(T){for(var me=T.length;--me>=0;)T[me]=0}function Y(T){var me=T.state,ye=me.pending;ye>T.avail_out&&(ye=T.avail_out),ye!==0&&(b.arraySet(T.output,me.pending_buf,me.pending_out,ye,T.next_out),T.next_out+=ye,me.pending_out+=ye,T.total_out+=ye,T.avail_out-=ye,me.pending-=ye,me.pending===0&&(me.pending_out=0))}function L(T,me){f._tr_flush_block(T,T.block_start>=0?T.block_start:-1,T.strstart-T.block_start,me),T.block_start=T.strstart,Y(T.strm)}function P(T,me){T.pending_buf[T.pending++]=me}function ae(T,me){T.pending_buf[T.pending++]=me>>>8&255,T.pending_buf[T.pending++]=me&255}function ue(T,me,ye,X){var de=T.avail_in;return de>X&&(de=X),de===0?0:(T.avail_in-=de,b.arraySet(me,T.input,T.next_in,de,ye),T.state.wrap===1?T.adler=n(T.adler,me,de,ye):T.state.wrap===2&&(T.adler=o(T.adler,me,de,ye)),T.next_in+=de,T.total_in+=de,de)}function ve(T,me){var ye=T.max_chain_length,X=T.strstart,de,xe,Pe=T.prev_length,Oe=T.nice_match,Ne=T.strstart>T.w_size-I?T.strstart-(T.w_size-I):0,je=T.window,bt=T.w_mask,Je=T.prev,Ye=T.strstart+D,it=je[X+Pe-1],ct=je[X+Pe];T.prev_length>=T.good_match&&(ye>>=2),Oe>T.lookahead&&(Oe=T.lookahead);do if(de=me,!(je[de+Pe]!==ct||je[de+Pe-1]!==it||je[de]!==je[X]||je[++de]!==je[X+1])){X+=2,de++;do;while(je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&je[++X]===je[++de]&&X<Ye);if(xe=D-(Ye-X),X=Ye-D,xe>Pe){if(T.match_start=me,Pe=xe,xe>=Oe)break;it=je[X+Pe-1],ct=je[X+Pe]}}while((me=Je[me&bt])>Ne&&--ye!==0);return Pe<=T.lookahead?Pe:T.lookahead}function _e(T){var me=T.w_size,ye,X,de,xe,Pe;do{if(xe=T.window_size-T.lookahead-T.strstart,T.strstart>=me+(me-I)){b.arraySet(T.window,T.window,me,me,0),T.match_start-=me,T.strstart-=me,T.block_start-=me,X=T.hash_size,ye=X;do de=T.head[--ye],T.head[ye]=de>=me?de-me:0;while(--X);X=me,ye=X;do de=T.prev[--ye],T.prev[ye]=de>=me?de-me:0;while(--X);xe+=me}if(T.strm.avail_in===0)break;if(X=ue(T.strm,T.window,T.strstart+T.lookahead,xe),T.lookahead+=X,T.lookahead+T.insert>=J)for(Pe=T.strstart-T.insert,T.ins_h=T.window[Pe],T.ins_h=(T.ins_h<<T.hash_shift^T.window[Pe+1])&T.hash_mask;T.insert&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[Pe+J-1])&T.hash_mask,T.prev[Pe&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=Pe,Pe++,T.insert--,!(T.lookahead+T.insert<J)););}while(T.lookahead<I&&T.strm.avail_in!==0)}function Te(T,me){var ye=65535;for(ye>T.pending_buf_size-5&&(ye=T.pending_buf_size-5);;){if(T.lookahead<=1){if(_e(T),T.lookahead===0&&me===t)return ie;if(T.lookahead===0)break}T.strstart+=T.lookahead,T.lookahead=0;var X=T.block_start+ye;if((T.strstart===0||T.strstart>=X)&&(T.lookahead=T.strstart-X,T.strstart=X,L(T,!1),T.strm.avail_out===0)||T.strstart-T.block_start>=T.w_size-I&&(L(T,!1),T.strm.avail_out===0))return ie}return T.insert=0,me===e?(L(T,!0),T.strm.avail_out===0?re:te):(T.strstart>T.block_start&&(L(T,!1),T.strm.avail_out===0),ie)}function Re(T,me){for(var ye,X;;){if(T.lookahead<I){if(_e(T),T.lookahead<I&&me===t)return ie;if(T.lookahead===0)break}if(ye=0,T.lookahead>=J&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+J-1])&T.hash_mask,ye=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart),ye!==0&&T.strstart-ye<=T.w_size-I&&(T.match_length=ve(T,ye)),T.match_length>=J)if(X=f._tr_tally(T,T.strstart-T.match_start,T.match_length-J),T.lookahead-=T.match_length,T.match_length<=T.max_lazy_match&&T.lookahead>=J){T.match_length--;do T.strstart++,T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+J-1])&T.hash_mask,ye=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart;while(--T.match_length!==0);T.strstart++}else T.strstart+=T.match_length,T.match_length=0,T.ins_h=T.window[T.strstart],T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+1])&T.hash_mask;else X=f._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++;if(X&&(L(T,!1),T.strm.avail_out===0))return ie}return T.insert=T.strstart<J-1?T.strstart:J-1,me===e?(L(T,!0),T.strm.avail_out===0?re:te):T.last_lit&&(L(T,!1),T.strm.avail_out===0)?ie:Q}function Le(T,me){for(var ye,X,de;;){if(T.lookahead<I){if(_e(T),T.lookahead<I&&me===t)return ie;if(T.lookahead===0)break}if(ye=0,T.lookahead>=J&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+J-1])&T.hash_mask,ye=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart),T.prev_length=T.match_length,T.prev_match=T.match_start,T.match_length=J-1,ye!==0&&T.prev_length<T.max_lazy_match&&T.strstart-ye<=T.w_size-I&&(T.match_length=ve(T,ye),T.match_length<=5&&(T.strategy===w||T.match_length===J&&T.strstart-T.match_start>4096)&&(T.match_length=J-1)),T.prev_length>=J&&T.match_length<=T.prev_length){de=T.strstart+T.lookahead-J,X=f._tr_tally(T,T.strstart-1-T.prev_match,T.prev_length-J),T.lookahead-=T.prev_length-1,T.prev_length-=2;do++T.strstart<=de&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+J-1])&T.hash_mask,ye=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart);while(--T.prev_length!==0);if(T.match_available=0,T.match_length=J-1,T.strstart++,X&&(L(T,!1),T.strm.avail_out===0))return ie}else if(T.match_available){if(X=f._tr_tally(T,0,T.window[T.strstart-1]),X&&L(T,!1),T.strstart++,T.lookahead--,T.strm.avail_out===0)return ie}else T.match_available=1,T.strstart++,T.lookahead--}return T.match_available&&(X=f._tr_tally(T,0,T.window[T.strstart-1]),T.match_available=0),T.insert=T.strstart<J-1?T.strstart:J-1,me===e?(L(T,!0),T.strm.avail_out===0?re:te):T.last_lit&&(L(T,!1),T.strm.avail_out===0)?ie:Q}function Se(T,me){for(var ye,X,de,xe,Pe=T.window;;){if(T.lookahead<=D){if(_e(T),T.lookahead<=D&&me===t)return ie;if(T.lookahead===0)break}if(T.match_length=0,T.lookahead>=J&&T.strstart>0&&(de=T.strstart-1,X=Pe[de],X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de])){xe=T.strstart+D;do;while(X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&X===Pe[++de]&&de<xe);T.match_length=D-(xe-de),T.match_length>T.lookahead&&(T.match_length=T.lookahead)}if(T.match_length>=J?(ye=f._tr_tally(T,1,T.match_length-J),T.lookahead-=T.match_length,T.strstart+=T.match_length,T.match_length=0):(ye=f._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++),ye&&(L(T,!1),T.strm.avail_out===0))return ie}return T.insert=0,me===e?(L(T,!0),T.strm.avail_out===0?re:te):T.last_lit&&(L(T,!1),T.strm.avail_out===0)?ie:Q}function Ee(T,me){for(var ye;;){if(T.lookahead===0&&(_e(T),T.lookahead===0)){if(me===t)return ie;break}if(T.match_length=0,ye=f._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++,ye&&(L(T,!1),T.strm.avail_out===0))return ie}return T.insert=0,me===e?(L(T,!0),T.strm.avail_out===0?re:te):T.last_lit&&(L(T,!1),T.strm.avail_out===0)?ie:Q}function Ce(T,me,ye,X,de){this.good_length=T,this.max_lazy=me,this.nice_length=ye,this.max_chain=X,this.func=de}var Ie;Ie=[new Ce(0,0,0,0,Te),new Ce(4,4,8,4,Re),new Ce(4,5,16,8,Re),new Ce(4,6,32,32,Re),new Ce(4,4,16,16,Le),new Ce(8,16,32,32,Le),new Ce(8,16,128,128,Le),new Ce(8,32,128,256,Le),new Ce(32,128,258,1024,Le),new Ce(32,258,258,4096,Le)];function Ae(T){T.window_size=2*T.w_size,ee(T.head),T.max_lazy_match=Ie[T.level].max_lazy,T.good_match=Ie[T.level].good_length,T.nice_match=Ie[T.level].nice_length,T.max_chain_length=Ie[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=J-1,T.match_available=0,T.ins_h=0}function $(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=U,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new b.Buf16(Z*2),this.dyn_dtree=new b.Buf16((2*A+1)*2),this.bl_tree=new b.Buf16((2*H+1)*2),ee(this.dyn_ltree),ee(this.dyn_dtree),ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new b.Buf16(K+1),this.heap=new b.Buf16(2*R+1),ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new b.Buf16(2*R+1),ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function be(T){var me;return!T||!T.state?z(T,u):(T.total_in=T.total_out=0,T.data_type=O,me=T.state,me.pending=0,me.pending_out=0,me.wrap<0&&(me.wrap=-me.wrap),me.status=me.wrap?q:he,T.adler=me.wrap===2?0:1,me.last_flush=t,f._tr_init(me),s)}function ge(T){var me=be(T);return me===s&&Ae(T.state),me}function ke(T,me){return!T||!T.state||T.state.wrap!==2?u:(T.state.gzhead=me,s)}function pe(T,me,ye,X,de,xe){if(!T)return u;var Pe=1;if(me===_&&(me=6),X<0?(Pe=0,X=-X):X>15&&(Pe=2,X-=16),de<1||de>F||ye!==U||X<8||X>15||me<0||me>9||xe<0||xe>E)return z(T,u);X===8&&(X=9);var Oe=new $;return T.state=Oe,Oe.strm=T,Oe.wrap=Pe,Oe.gzhead=null,Oe.w_bits=X,Oe.w_size=1<<Oe.w_bits,Oe.w_mask=Oe.w_size-1,Oe.hash_bits=de+7,Oe.hash_size=1<<Oe.hash_bits,Oe.hash_mask=Oe.hash_size-1,Oe.hash_shift=~~((Oe.hash_bits+J-1)/J),Oe.window=new b.Buf8(Oe.w_size*2),Oe.head=new b.Buf16(Oe.hash_size),Oe.prev=new b.Buf16(Oe.w_size),Oe.lit_bufsize=1<<de+6,Oe.pending_buf_size=Oe.lit_bufsize*4,Oe.pending_buf=new b.Buf8(Oe.pending_buf_size),Oe.d_buf=1*Oe.lit_bufsize,Oe.l_buf=(1+2)*Oe.lit_bufsize,Oe.level=me,Oe.strategy=xe,Oe.method=ye,ge(T)}function we(T,me){return pe(T,me,U,M,j,k)}function oe(T,me){var ye,X,de,xe;if(!T||!T.state||me>l||me<0)return T?z(T,u):u;if(X=T.state,!T.output||!T.input&&T.avail_in!==0||X.status===se&&me!==e)return z(T,T.avail_out===0?p:u);if(X.strm=T,ye=X.last_flush,X.last_flush=me,X.status===q)if(X.wrap===2)T.adler=0,P(X,31),P(X,139),P(X,8),X.gzhead?(P(X,(X.gzhead.text?1:0)+(X.gzhead.hcrc?2:0)+(X.gzhead.extra?4:0)+(X.gzhead.name?8:0)+(X.gzhead.comment?16:0)),P(X,X.gzhead.time&255),P(X,X.gzhead.time>>8&255),P(X,X.gzhead.time>>16&255),P(X,X.gzhead.time>>24&255),P(X,X.level===9?2:X.strategy>=S||X.level<2?4:0),P(X,X.gzhead.os&255),X.gzhead.extra&&X.gzhead.extra.length&&(P(X,X.gzhead.extra.length&255),P(X,X.gzhead.extra.length>>8&255)),X.gzhead.hcrc&&(T.adler=o(T.adler,X.pending_buf,X.pending,0)),X.gzindex=0,X.status=ne):(P(X,0),P(X,0),P(X,0),P(X,0),P(X,0),P(X,X.level===9?2:X.strategy>=S||X.level<2?4:0),P(X,V),X.status=he);else{var Pe=U+(X.w_bits-8<<4)<<8,Oe=-1;X.strategy>=S||X.level<2?Oe=0:X.level<6?Oe=1:X.level===6?Oe=2:Oe=3,Pe|=Oe<<6,X.strstart!==0&&(Pe|=W),Pe+=31-Pe%31,X.status=he,ae(X,Pe),X.strstart!==0&&(ae(X,T.adler>>>16),ae(X,T.adler&65535)),T.adler=1}if(X.status===ne)if(X.gzhead.extra){for(de=X.pending;X.gzindex<(X.gzhead.extra.length&65535)&&!(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),Y(T),de=X.pending,X.pending===X.pending_buf_size));)P(X,X.gzhead.extra[X.gzindex]&255),X.gzindex++;X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),X.gzindex===X.gzhead.extra.length&&(X.gzindex=0,X.status=le)}else X.status=le;if(X.status===le)if(X.gzhead.name){de=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),Y(T),de=X.pending,X.pending===X.pending_buf_size)){xe=1;break}X.gzindex<X.gzhead.name.length?xe=X.gzhead.name.charCodeAt(X.gzindex++)&255:xe=0,P(X,xe)}while(xe!==0);X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),xe===0&&(X.gzindex=0,X.status=ce)}else X.status=ce;if(X.status===ce)if(X.gzhead.comment){de=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),Y(T),de=X.pending,X.pending===X.pending_buf_size)){xe=1;break}X.gzindex<X.gzhead.comment.length?xe=X.gzhead.comment.charCodeAt(X.gzindex++)&255:xe=0,P(X,xe)}while(xe!==0);X.gzhead.hcrc&&X.pending>de&&(T.adler=o(T.adler,X.pending_buf,X.pending-de,de)),xe===0&&(X.status=fe)}else X.status=fe;if(X.status===fe&&(X.gzhead.hcrc?(X.pending+2>X.pending_buf_size&&Y(T),X.pending+2<=X.pending_buf_size&&(P(X,T.adler&255),P(X,T.adler>>8&255),T.adler=0,X.status=he)):X.status=he),X.pending!==0){if(Y(T),T.avail_out===0)return X.last_flush=-1,s}else if(T.avail_in===0&&B(me)<=B(ye)&&me!==e)return z(T,p);if(X.status===se&&T.avail_in!==0)return z(T,p);if(T.avail_in!==0||X.lookahead!==0||me!==t&&X.status!==se){var Ne=X.strategy===S?Ee(X,me):X.strategy===C?Se(X,me):Ie[X.level].func(X,me);if((Ne===re||Ne===te)&&(X.status=se),Ne===ie||Ne===re)return T.avail_out===0&&(X.last_flush=-1),s;if(Ne===Q&&(me===i?f._tr_align(X):me!==l&&(f._tr_stored_block(X,0,0,!1),me===r&&(ee(X.head),X.lookahead===0&&(X.strstart=0,X.block_start=0,X.insert=0))),Y(T),T.avail_out===0))return X.last_flush=-1,s}return me!==e?s:X.wrap<=0?c:(X.wrap===2?(P(X,T.adler&255),P(X,T.adler>>8&255),P(X,T.adler>>16&255),P(X,T.adler>>24&255),P(X,T.total_in&255),P(X,T.total_in>>8&255),P(X,T.total_in>>16&255),P(X,T.total_in>>24&255)):(ae(X,T.adler>>>16),ae(X,T.adler&65535)),Y(T),X.wrap>0&&(X.wrap=-X.wrap),X.pending!==0?s:c)}function Ue(T){var me;return!T||!T.state?u:(me=T.state.status,me!==q&&me!==ne&&me!==le&&me!==ce&&me!==fe&&me!==he&&me!==se?z(T,u):(T.state=null,me===he?z(T,h):s))}function ze(T,me){var ye=me.length,X,de,xe,Pe,Oe,Ne,je,bt;if(!T||!T.state||(X=T.state,Pe=X.wrap,Pe===2||Pe===1&&X.status!==q||X.lookahead))return u;for(Pe===1&&(T.adler=n(T.adler,me,ye,0)),X.wrap=0,ye>=X.w_size&&(Pe===0&&(ee(X.head),X.strstart=0,X.block_start=0,X.insert=0),bt=new b.Buf8(X.w_size),b.arraySet(bt,me,ye-X.w_size,X.w_size,0),me=bt,ye=X.w_size),Oe=T.avail_in,Ne=T.next_in,je=T.input,T.avail_in=ye,T.next_in=0,T.input=me,_e(X);X.lookahead>=J;){de=X.strstart,xe=X.lookahead-(J-1);do X.ins_h=(X.ins_h<<X.hash_shift^X.window[de+J-1])&X.hash_mask,X.prev[de&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=de,de++;while(--xe);X.strstart=de,X.lookahead=J-1,_e(X)}return X.strstart+=X.lookahead,X.block_start=X.strstart,X.insert=X.lookahead,X.lookahead=0,X.match_length=X.prev_length=J-1,X.match_available=0,T.next_in=Ne,T.input=je,T.avail_in=Oe,X.wrap=Pe,s}g.deflateInit=we,g.deflateInit2=pe,g.deflateReset=ge,g.deflateResetKeep=be,g.deflateSetHeader=ke,g.deflate=oe,g.deflateEnd=Ue,g.deflateSetDictionary=ze,g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":89,"./adler32":91,"./crc32":93,"./messages":99,"./trees":100}],95:[function(m,x,g){function b(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}x.exports=b},{}],96:[function(m,x,g){arguments[4][41][0].apply(g,arguments)},{dup:41}],97:[function(m,x,g){arguments[4][42][0].apply(g,arguments)},{"../utils/common":89,"./adler32":91,"./crc32":93,"./inffast":96,"./inftrees":98,dup:42}],98:[function(m,x,g){arguments[4][43][0].apply(g,arguments)},{"../utils/common":89,dup:43}],99:[function(m,x,g){arguments[4][44][0].apply(g,arguments)},{dup:44}],100:[function(m,x,g){var b=m("../utils/common"),f=4,n=0,o=1,a=2;function t($){for(var be=$.length;--be>=0;)$[be]=0}var i=0,r=1,e=2,l=3,s=258,c=29,u=256,h=u+1+c,p=30,_=19,w=2*h+1,S=15,C=16,E=7,k=256,O=16,U=17,F=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=512,A=new Array((h+2)*2);t(A);var H=new Array(p*2);t(H);var Z=new Array(R);t(Z);var K=new Array(s-l+1);t(K);var J=new Array(c);t(J);var D=new Array(p);t(D);function I($,be,ge,ke,pe){this.static_tree=$,this.extra_bits=be,this.extra_base=ge,this.elems=ke,this.max_length=pe,this.has_stree=$&&$.length}var W,q,ne;function le($,be){this.dyn_tree=$,this.max_code=0,this.stat_desc=be}function ce($){return $<256?Z[$]:Z[256+($>>>7)]}function fe($,be){$.pending_buf[$.pending++]=be&255,$.pending_buf[$.pending++]=be>>>8&255}function he($,be,ge){$.bi_valid>C-ge?($.bi_buf|=be<<$.bi_valid&65535,fe($,$.bi_buf),$.bi_buf=be>>C-$.bi_valid,$.bi_valid+=ge-C):($.bi_buf|=be<<$.bi_valid&65535,$.bi_valid+=ge)}function se($,be,ge){he($,ge[be*2],ge[be*2+1])}function ie($,be){var ge=0;do ge|=$&1,$>>>=1,ge<<=1;while(--be>0);return ge>>>1}function Q($){$.bi_valid===16?(fe($,$.bi_buf),$.bi_buf=0,$.bi_valid=0):$.bi_valid>=8&&($.pending_buf[$.pending++]=$.bi_buf&255,$.bi_buf>>=8,$.bi_valid-=8)}function re($,be){var ge=be.dyn_tree,ke=be.max_code,pe=be.stat_desc.static_tree,we=be.stat_desc.has_stree,oe=be.stat_desc.extra_bits,Ue=be.stat_desc.extra_base,ze=be.stat_desc.max_length,T,me,ye,X,de,xe,Pe=0;for(X=0;X<=S;X++)$.bl_count[X]=0;for(ge[$.heap[$.heap_max]*2+1]=0,T=$.heap_max+1;T<w;T++)me=$.heap[T],X=ge[ge[me*2+1]*2+1]+1,X>ze&&(X=ze,Pe++),ge[me*2+1]=X,!(me>ke)&&($.bl_count[X]++,de=0,me>=Ue&&(de=oe[me-Ue]),xe=ge[me*2],$.opt_len+=xe*(X+de),we&&($.static_len+=xe*(pe[me*2+1]+de)));if(Pe!==0){do{for(X=ze-1;$.bl_count[X]===0;)X--;$.bl_count[X]--,$.bl_count[X+1]+=2,$.bl_count[ze]--,Pe-=2}while(Pe>0);for(X=ze;X!==0;X--)for(me=$.bl_count[X];me!==0;)ye=$.heap[--T],!(ye>ke)&&(ge[ye*2+1]!==X&&($.opt_len+=(X-ge[ye*2+1])*ge[ye*2],ge[ye*2+1]=X),me--)}}function te($,be,ge){var ke=new Array(S+1),pe=0,we,oe;for(we=1;we<=S;we++)ke[we]=pe=pe+ge[we-1]<<1;for(oe=0;oe<=be;oe++){var Ue=$[oe*2+1];Ue!==0&&($[oe*2]=ie(ke[Ue]++,Ue))}}function V(){var $,be,ge,ke,pe,we=new Array(S+1);for(ge=0,ke=0;ke<c-1;ke++)for(J[ke]=ge,$=0;$<1<<M[ke];$++)K[ge++]=ke;for(K[ge-1]=ke,pe=0,ke=0;ke<16;ke++)for(D[ke]=pe,$=0;$<1<<j[ke];$++)Z[pe++]=ke;for(pe>>=7;ke<p;ke++)for(D[ke]=pe<<7,$=0;$<1<<j[ke]-7;$++)Z[256+pe++]=ke;for(be=0;be<=S;be++)we[be]=0;for($=0;$<=143;)A[$*2+1]=8,$++,we[8]++;for(;$<=255;)A[$*2+1]=9,$++,we[9]++;for(;$<=279;)A[$*2+1]=7,$++,we[7]++;for(;$<=287;)A[$*2+1]=8,$++,we[8]++;for(te(A,h+1,we),$=0;$<p;$++)H[$*2+1]=5,H[$*2]=ie($,5);W=new I(A,M,u+1,h,S),q=new I(H,j,0,p,S),ne=new I(new Array(0),G,0,_,E)}function z($){var be;for(be=0;be<h;be++)$.dyn_ltree[be*2]=0;for(be=0;be<p;be++)$.dyn_dtree[be*2]=0;for(be=0;be<_;be++)$.bl_tree[be*2]=0;$.dyn_ltree[k*2]=1,$.opt_len=$.static_len=0,$.last_lit=$.matches=0}function B($){$.bi_valid>8?fe($,$.bi_buf):$.bi_valid>0&&($.pending_buf[$.pending++]=$.bi_buf),$.bi_buf=0,$.bi_valid=0}function ee($,be,ge,ke){B($),ke&&(fe($,ge),fe($,~ge)),b.arraySet($.pending_buf,$.window,be,ge,$.pending),$.pending+=ge}function Y($,be,ge,ke){var pe=be*2,we=ge*2;return $[pe]<$[we]||$[pe]===$[we]&&ke[be]<=ke[ge]}function L($,be,ge){for(var ke=$.heap[ge],pe=ge<<1;pe<=$.heap_len&&(pe<$.heap_len&&Y(be,$.heap[pe+1],$.heap[pe],$.depth)&&pe++,!Y(be,ke,$.heap[pe],$.depth));)$.heap[ge]=$.heap[pe],ge=pe,pe<<=1;$.heap[ge]=ke}function P($,be,ge){var ke,pe,we=0,oe,Ue;if($.last_lit!==0)do ke=$.pending_buf[$.d_buf+we*2]<<8|$.pending_buf[$.d_buf+we*2+1],pe=$.pending_buf[$.l_buf+we],we++,ke===0?se($,pe,be):(oe=K[pe],se($,oe+u+1,be),Ue=M[oe],Ue!==0&&(pe-=J[oe],he($,pe,Ue)),ke--,oe=ce(ke),se($,oe,ge),Ue=j[oe],Ue!==0&&(ke-=D[oe],he($,ke,Ue)));while(we<$.last_lit);se($,k,be)}function ae($,be){var ge=be.dyn_tree,ke=be.stat_desc.static_tree,pe=be.stat_desc.has_stree,we=be.stat_desc.elems,oe,Ue,ze=-1,T;for($.heap_len=0,$.heap_max=w,oe=0;oe<we;oe++)ge[oe*2]!==0?($.heap[++$.heap_len]=ze=oe,$.depth[oe]=0):ge[oe*2+1]=0;for(;$.heap_len<2;)T=$.heap[++$.heap_len]=ze<2?++ze:0,ge[T*2]=1,$.depth[T]=0,$.opt_len--,pe&&($.static_len-=ke[T*2+1]);for(be.max_code=ze,oe=$.heap_len>>1;oe>=1;oe--)L($,ge,oe);T=we;do oe=$.heap[1],$.heap[1]=$.heap[$.heap_len--],L($,ge,1),Ue=$.heap[1],$.heap[--$.heap_max]=oe,$.heap[--$.heap_max]=Ue,ge[T*2]=ge[oe*2]+ge[Ue*2],$.depth[T]=($.depth[oe]>=$.depth[Ue]?$.depth[oe]:$.depth[Ue])+1,ge[oe*2+1]=ge[Ue*2+1]=T,$.heap[1]=T++,L($,ge,1);while($.heap_len>=2);$.heap[--$.heap_max]=$.heap[1],re($,be),te(ge,ze,$.bl_count)}function ue($,be,ge){var ke,pe=-1,we,oe=be[0*2+1],Ue=0,ze=7,T=4;for(oe===0&&(ze=138,T=3),be[(ge+1)*2+1]=65535,ke=0;ke<=ge;ke++)we=oe,oe=be[(ke+1)*2+1],!(++Ue<ze&&we===oe)&&(Ue<T?$.bl_tree[we*2]+=Ue:we!==0?(we!==pe&&$.bl_tree[we*2]++,$.bl_tree[O*2]++):Ue<=10?$.bl_tree[U*2]++:$.bl_tree[F*2]++,Ue=0,pe=we,oe===0?(ze=138,T=3):we===oe?(ze=6,T=3):(ze=7,T=4))}function ve($,be,ge){var ke,pe=-1,we,oe=be[0*2+1],Ue=0,ze=7,T=4;for(oe===0&&(ze=138,T=3),ke=0;ke<=ge;ke++)if(we=oe,oe=be[(ke+1)*2+1],!(++Ue<ze&&we===oe)){if(Ue<T)do se($,we,$.bl_tree);while(--Ue!==0);else we!==0?(we!==pe&&(se($,we,$.bl_tree),Ue--),se($,O,$.bl_tree),he($,Ue-3,2)):Ue<=10?(se($,U,$.bl_tree),he($,Ue-3,3)):(se($,F,$.bl_tree),he($,Ue-11,7));Ue=0,pe=we,oe===0?(ze=138,T=3):we===oe?(ze=6,T=3):(ze=7,T=4)}}function _e($){var be;for(ue($,$.dyn_ltree,$.l_desc.max_code),ue($,$.dyn_dtree,$.d_desc.max_code),ae($,$.bl_desc),be=_-1;be>=3&&$.bl_tree[N[be]*2+1]===0;be--);return $.opt_len+=3*(be+1)+5+5+4,be}function Te($,be,ge,ke){var pe;for(he($,be-257,5),he($,ge-1,5),he($,ke-4,4),pe=0;pe<ke;pe++)he($,$.bl_tree[N[pe]*2+1],3);ve($,$.dyn_ltree,be-1),ve($,$.dyn_dtree,ge-1)}function Re($){var be=4093624447,ge;for(ge=0;ge<=31;ge++,be>>>=1)if(be&1&&$.dyn_ltree[ge*2]!==0)return n;if($.dyn_ltree[9*2]!==0||$.dyn_ltree[10*2]!==0||$.dyn_ltree[13*2]!==0)return o;for(ge=32;ge<u;ge++)if($.dyn_ltree[ge*2]!==0)return o;return n}var Le=!1;function Se($){Le||(V(),Le=!0),$.l_desc=new le($.dyn_ltree,W),$.d_desc=new le($.dyn_dtree,q),$.bl_desc=new le($.bl_tree,ne),$.bi_buf=0,$.bi_valid=0,z($)}function Ee($,be,ge,ke){he($,(i<<1)+(ke?1:0),3),ee($,be,ge,!0)}function Ce($){he($,r<<1,3),se($,k,A),Q($)}function Ie($,be,ge,ke){var pe,we,oe=0;$.level>0?($.strm.data_type===a&&($.strm.data_type=Re($)),ae($,$.l_desc),ae($,$.d_desc),oe=_e($),pe=$.opt_len+3+7>>>3,we=$.static_len+3+7>>>3,we<=pe&&(pe=we)):pe=we=ge+5,ge+4<=pe&&be!==-1?Ee($,be,ge,ke):$.strategy===f||we===pe?(he($,(r<<1)+(ke?1:0),3),P($,A,H)):(he($,(e<<1)+(ke?1:0),3),Te($,$.l_desc.max_code+1,$.d_desc.max_code+1,oe+1),P($,$.dyn_ltree,$.dyn_dtree)),z($),ke&&B($)}function Ae($,be,ge){return $.pending_buf[$.d_buf+$.last_lit*2]=be>>>8&255,$.pending_buf[$.d_buf+$.last_lit*2+1]=be&255,$.pending_buf[$.l_buf+$.last_lit]=ge&255,$.last_lit++,be===0?$.dyn_ltree[ge*2]++:($.matches++,be--,$.dyn_ltree[(K[ge]+u+1)*2]++,$.dyn_dtree[ce(be)*2]++),$.last_lit===$.lit_bufsize-1}g._tr_init=Se,g._tr_stored_block=Ee,g._tr_flush_block=Ie,g._tr_tally=Ae,g._tr_align=Ce},{"../utils/common":89}],101:[function(m,x,g){arguments[4][46][0].apply(g,arguments)},{dup:46}],102:[function(m,x,g){x.exports=function(a){if(!a)throw new Error("no data provided");a=a.toString().trim();var t={pages:[],chars:[],kernings:[]},i=a.split(/\r\n?|\n/g);if(i.length===0)throw new Error("no data in BMFont file");for(var r=0;r<i.length;r++){var e=b(i[r],r);if(e)if(e.key==="page"){if(typeof e.data.id!="number")throw new Error("malformed file at line "+r+" -- needs page id=N");if(typeof e.data.file!="string")throw new Error("malformed file at line "+r+' -- needs page file="path"');t.pages[e.data.id]=e.data.file}else e.key==="chars"||e.key==="kernings"||(e.key==="char"?t.chars.push(e.data):e.key==="kerning"?t.kernings.push(e.data):t[e.key]=e.data)}return t};function b(o,a){if(o=o.replace(/\t+/g," ").trim(),!o)return null;var t=o.indexOf(" ");if(t===-1)throw new Error("no named row at line "+a);var i=o.substring(0,t);o=o.substring(t+1),o=o.replace(/letter=[\'\"]\S+[\'\"]/gi,""),o=o.split("="),o=o.map(function(c){return c.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var r=[],e=0;e<o.length;e++){var l=o[e];e===0?r.push({key:l[0],data:""}):e===o.length-1?r[r.length-1].data=f(l[0]):(r[r.length-1].data=f(l[0]),r.push({key:l[1],data:""}))}var s={key:i,data:{}};return r.forEach(function(c){s.data[c.key]=c.data}),s}function f(o){return!o||o.length===0?"":o.indexOf('"')===0||o.indexOf("'")===0?o.substring(1,o.length-1):o.indexOf(",")!==-1?n(o):parseInt(o,10)}function n(o){return o.split(",").map(function(a){return parseInt(a,10)})}},{}],103:[function(m,x,g){var b=[66,77,70];x.exports=function(s){if(s.length<6)throw new Error("invalid buffer length for BMFont");var c=b.every(function(w,S){return s.readUInt8(S)===w});if(!c)throw new Error("BMFont missing BMF byte header");var u=3,h=s.readUInt8(u++);if(h>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var p={kernings:[],chars:[]},_=0;_<5;_++)u+=f(p,s,u);return p};function f(l,s,c){if(c>s.length-1)return 0;var u=s.readUInt8(c++),h=s.readInt32LE(c);switch(c+=4,u){case 1:l.info=n(s,c);break;case 2:l.common=o(s,c);break;case 3:l.pages=a(s,c,h);break;case 4:l.chars=t(s,c,h);break;case 5:l.kernings=i(s,c,h);break}return 5+h}function n(l,s){var c={};c.size=l.readInt16LE(s);var u=l.readUInt8(s+2);return c.smooth=u>>7&1,c.unicode=u>>6&1,c.italic=u>>5&1,c.bold=u>>4&1,u>>3&1&&(c.fixedHeight=1),c.charset=l.readUInt8(s+3)||"",c.stretchH=l.readUInt16LE(s+4),c.aa=l.readUInt8(s+6),c.padding=[l.readInt8(s+7),l.readInt8(s+8),l.readInt8(s+9),l.readInt8(s+10)],c.spacing=[l.readInt8(s+11),l.readInt8(s+12)],c.outline=l.readUInt8(s+13),c.face=e(l,s+14),c}function o(l,s){var c={};return c.lineHeight=l.readUInt16LE(s),c.base=l.readUInt16LE(s+2),c.scaleW=l.readUInt16LE(s+4),c.scaleH=l.readUInt16LE(s+6),c.pages=l.readUInt16LE(s+8),l.readUInt8(s+10),c.packed=0,c.alphaChnl=l.readUInt8(s+11),c.redChnl=l.readUInt8(s+12),c.greenChnl=l.readUInt8(s+13),c.blueChnl=l.readUInt8(s+14),c}function a(l,s,c){for(var u=[],h=r(l,s),p=h.length+1,_=c/p,w=0;w<_;w++)u[w]=l.slice(s,s+h.length).toString("utf8"),s+=p;return u}function t(l,s,c){for(var u=[],h=c/20,p=0;p<h;p++){var _={},w=p*20;_.id=l.readUInt32LE(s+0+w),_.x=l.readUInt16LE(s+4+w),_.y=l.readUInt16LE(s+6+w),_.width=l.readUInt16LE(s+8+w),_.height=l.readUInt16LE(s+10+w),_.xoffset=l.readInt16LE(s+12+w),_.yoffset=l.readInt16LE(s+14+w),_.xadvance=l.readInt16LE(s+16+w),_.page=l.readUInt8(s+18+w),_.chnl=l.readUInt8(s+19+w),u[p]=_}return u}function i(l,s,c){for(var u=[],h=c/10,p=0;p<h;p++){var _={},w=p*10;_.first=l.readUInt32LE(s+0+w),_.second=l.readUInt32LE(s+4+w),_.amount=l.readInt16LE(s+8+w),u[p]=_}return u}function r(l,s){for(var c=s;c<l.length&&l[c]!==0;c++);return l.slice(s,c)}function e(l,s){return r(l,s).toString("utf8")}},{}],104:[function(m,x,g){var b=m("./parse-attribs"),f=m("xml-parse-from-string"),n={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};x.exports=function(r){r=r.toString();var e=f(r),l={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(w){var S=e.getElementsByTagName(w)[0];S&&(l[w]=b(o(S)))});var s=e.getElementsByTagName("pages")[0];if(!s)throw new Error("malformed file -- no <pages> element");for(var c=s.getElementsByTagName("page"),u=0;u<c.length;u++){var h=c[u],p=parseInt(h.getAttribute("id"),10),_=h.getAttribute("file");if(isNaN(p))throw new Error('malformed file -- page "id" attribute is NaN');if(!_)throw new Error('malformed file -- needs page "file" attribute');l.pages[parseInt(p,10)]=_}return["chars","kernings"].forEach(function(w){var S=e.getElementsByTagName(w)[0];if(S)for(var C=w.substring(0,w.length-1),E=S.getElementsByTagName(C),k=0;k<E.length;k++){var O=E[k];l[w].push(b(o(O)))}}),l};function o(i){var r=a(i);return r.reduce(function(e,l){var s=t(l.nodeName);return e[s]=l.nodeValue,e},{})}function a(i){for(var r=[],e=0;e<i.attributes.length;e++)r.push(i.attributes[e]);return r}function t(i){return n[i.toLowerCase()]||i}},{"./parse-attribs":105,"xml-parse-from-string":188}],105:[function(m,x,g){var b="chasrset";x.exports=function(o){b in o&&(o.charset=o[b],delete o[b]);for(var a in o)a==="face"||a==="charset"||(a==="padding"||a==="spacing"?o[a]=f(o[a]):o[a]=parseInt(o[a],10));return o};function f(n){return n.split(",").map(function(o){return parseInt(o,10)})}},{}],106:[function(m,x,g){var b=m("trim"),f=m("for-each"),n=function(o){return Object.prototype.toString.call(o)==="[object Array]"};x.exports=function(o){if(!o)return{};var a={};return f(b(o).split("\n"),function(t){var i=t.indexOf(":"),r=b(t.slice(0,i)).toLowerCase(),e=b(t.slice(i+1));typeof a[r]>"u"?a[r]=e:n(a[r])?a[r].push(e):a[r]=[a[r],e]}),a}},{"for-each":63,trim:179}],107:[function(m,x,g){(function(b){function f(t,i){for(var r=0,e=t.length-1;e>=0;e--){var l=t[e];l==="."?t.splice(e,1):l===".."?(t.splice(e,1),r++):r&&(t.splice(e,1),r--)}if(i)for(;r--;r)t.unshift("..");return t}g.resolve=function(){for(var t="",i=!1,r=arguments.length-1;r>=-1&&!i;r--){var e=r>=0?arguments[r]:b.cwd();if(typeof e!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!e)continue;t=e+"/"+t,i=e.charAt(0)==="/"}return t=f(o(t.split("/"),function(l){return!!l}),!i).join("/"),(i?"/":"")+t||"."},g.normalize=function(t){var i=g.isAbsolute(t),r=a(t,-1)==="/";return t=f(o(t.split("/"),function(e){return!!e}),!i).join("/"),!t&&!i&&(t="."),t&&r&&(t+="/"),(i?"/":"")+t},g.isAbsolute=function(t){return t.charAt(0)==="/"},g.join=function(){var t=Array.prototype.slice.call(arguments,0);return g.normalize(o(t,function(i,r){if(typeof i!="string")throw new TypeError("Arguments to path.join must be strings");return i}).join("/"))},g.relative=function(t,i){t=g.resolve(t).substr(1),i=g.resolve(i).substr(1);function r(p){for(var _=0;_<p.length&&p[_]==="";_++);for(var w=p.length-1;w>=0&&p[w]==="";w--);return _>w?[]:p.slice(_,w-_+1)}for(var e=r(t.split("/")),l=r(i.split("/")),s=Math.min(e.length,l.length),c=s,u=0;u<s;u++)if(e[u]!==l[u]){c=u;break}for(var h=[],u=c;u<e.length;u++)h.push("..");return h=h.concat(l.slice(c)),h.join("/")},g.sep="/",g.delimiter=":",g.dirname=function(t){if(typeof t!="string"&&(t=t+""),t.length===0)return".";for(var i=t.charCodeAt(0),r=i===47,e=-1,l=!0,s=t.length-1;s>=1;--s)if(i=t.charCodeAt(s),i===47){if(!l){e=s;break}}else l=!1;return e===-1?r?"/":".":r&&e===1?"/":t.slice(0,e)};function n(t){typeof t!="string"&&(t=t+"");var i=0,r=-1,e=!0,l;for(l=t.length-1;l>=0;--l)if(t.charCodeAt(l)===47){if(!e){i=l+1;break}}else r===-1&&(e=!1,r=l+1);return r===-1?"":t.slice(i,r)}g.basename=function(t,i){var r=n(t);return i&&r.substr(-1*i.length)===i&&(r=r.substr(0,r.length-i.length)),r},g.extname=function(t){typeof t!="string"&&(t=t+"");for(var i=-1,r=0,e=-1,l=!0,s=0,c=t.length-1;c>=0;--c){var u=t.charCodeAt(c);if(u===47){if(!l){r=c+1;break}continue}e===-1&&(l=!1,e=c+1),u===46?i===-1?i=c:s!==1&&(s=1):i!==-1&&(s=-1)}return i===-1||e===-1||s===0||s===1&&i===e-1&&i===r+1?"":t.slice(i,e)};function o(t,i){if(t.filter)return t.filter(i);for(var r=[],e=0;e<t.length;e++)i(t[e],e,t)&&r.push(t[e]);return r}var a="ab".substr(-1)==="b"?function(t,i,r){return t.substr(i,r)}:function(t,i,r){return i<0&&(i=t.length+i),t.substr(i,r)}}).call(this,m("_process"))},{_process:133}],108:[function(m,x,g){(function(b){var f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},n=m("http"),o=m("https"),a=m("url"),t=m("querystring"),i=m("zlib"),r=m("util"),e=function(s,c){if(typeof s!="string"&&!s.hasOwnProperty("url"))throw new Error("Missing url option from options for request method.");var u=(typeof s>"u"?"undefined":f(s))==="object"?a.parse(s.url):a.parse(s),h={hostname:u.hostname,port:u.port||(u.protocol.toLowerCase()==="http:"?80:443),path:u.path,method:"GET",headers:{},auth:u.auth||null,parse:"none",stream:!1};if((typeof s>"u"?"undefined":f(s))==="object"&&(h=Object.assign(h,s)),h.port=Number(h.port),h.hasOwnProperty("timeout")&&delete h.timeout,h.compressed===!0&&(h.headers["accept-encoding"]="gzip, deflate"),s.hasOwnProperty("form")){if(f(s.form)!=="object")throw new Error("phin 'form' option must be of type Object if present.");var p=t.stringify(s.form);h.headers["Content-Type"]="application/x-www-form-urlencoded",h.headers["Content-Length"]=b.byteLength(p),s.data=p}var _=void 0,w=function(k){var O=k;h.compressed===!0&&(k.headers["content-encoding"]==="gzip"?O=k.pipe(i.createGunzip()):k.headers["content-encoding"]==="deflate"&&(O=k.pipe(i.createInflate()))),h.stream===!0?(k.stream=O,c(null,k)):(k.body=new b([]),O.on("data",function(U){k.body=b.concat([k.body,U])}),O.on("end",function(){if(c){if(h.parse==="json")try{k.body=JSON.parse(k.body.toString())}catch(U){c("Invalid JSON received.",k);return}c(null,k)}}))};switch(u.protocol.toLowerCase()){case"http:":_=n.request(h,w);break;case"https:":_=o.request(h,w);break;default:c&&c(new Error("Invalid / unknown URL protocol. Expected HTTP or HTTPS."),null);return}if(typeof s.timeout=="number"&&_.setTimeout(s.timeout,function(){_.abort(),c(new Error("Timeout has been reached."),null),c=null}),_.on("error",function(E){c&&c(E,null)}),s.hasOwnProperty("data")){var S=s.data;if(!(s.data instanceof b)&&f(s.data)==="object"){var C=h.headers["content-type"]||h.headers["Content-Type"];if(C==="application/x-www-form-urlencoded")S=t.stringify(s.data);else try{S=JSON.stringify(s.data)}catch(E){c(new Error("Couldn't stringify object. (Likely due to a circular reference.)"),null)}}_.write(S)}_.end()};e.promisified=function(l,s){return new Promise(function(c,u){e(l,function(h,p){h?u(h):c(p)})})},r.promisify&&(e[r.promisify.custom]=e.promisified),x.exports=e}).call(this,m("buffer").Buffer)},{buffer:48,http:156,https:72,querystring:137,url:180,util:186,zlib:35}],109:[function(m,x,g){x.exports=b;function b(l,s,c,u,h,p){p||(p={});for(var _=p.threshold===void 0?.1:p.threshold,w=35215*_*_,S=0,C=0;C<h;C++)for(var E=0;E<u;E++){var k=(C*u+E)*4,O=n(l,s,k,k);if(O>w)!p.includeAA&&(f(l,E,C,u,h,s)||f(s,E,C,u,h,l))?c&&r(c,k,255,255,0):(c&&r(c,k,255,0,0),S++);else if(c){var U=i(e(l,k),.1);r(c,k,U,U,U)}}return S}function f(l,s,c,u,h,p){for(var _=Math.max(s-1,0),w=Math.max(c-1,0),S=Math.min(s+1,u-1),C=Math.min(c+1,h-1),E=(c*u+s)*4,k=0,O=0,U=0,F=0,M=0,j,G,N,R,A=_;A<=S;A++)for(var H=w;H<=C;H++)if(!(A===s&&H===c)){var Z=n(l,l,E,(H*u+A)*4,!0);if(Z===0?k++:Z<0?U++:Z>0&&O++,k>2)return!1;p&&(Z<F&&(F=Z,j=A,G=H),Z>M&&(M=Z,N=A,R=H))}return p?U===0||O===0?!1:!f(l,j,G,u,h)&&!f(p,j,G,u,h)||!f(l,N,R,u,h)&&!f(p,N,R,u,h):!0}function n(l,s,c,u,h){var p=l[c+3]/255,_=s[u+3]/255,w=i(l[c+0],p),S=i(l[c+1],p),C=i(l[c+2],p),E=i(s[u+0],_),k=i(s[u+1],_),O=i(s[u+2],_),U=o(w,S,C)-o(E,k,O);if(h)return U;var F=a(w,S,C)-a(E,k,O),M=t(w,S,C)-t(E,k,O);return .5053*U*U+.299*F*F+.1957*M*M}function o(l,s,c){return l*.29889531+s*.58662247+c*.11448223}function a(l,s,c){return l*.59597799-s*.2741761-c*.32180189}function t(l,s,c){return l*.21147017-s*.52261711+c*.31114694}function i(l,s){return 255+(l-255)*s}function r(l,s,c,u,h){l[s+0]=c,l[s+1]=u,l[s+2]=h,l[s+3]=255}function e(l,s){var c=l[s+3]/255,u=i(l[s+0],c),h=i(l[s+1],c),p=i(l[s+2],c);return o(u,h,p)}},{}],110:[function(m,x,g){(function(b){var f=m("./interlace"),n={1:{0:0,1:0,2:0,3:255},2:{0:0,1:0,2:0,3:1},3:{0:0,1:1,2:2,3:255},4:{0:0,1:1,2:2,3:3}};function o(i,r){var e=[],l=0;function s(){if(l===i.length)throw new Error("Ran out of data");var c=i[l];l++;var u,h,p,_,w,S,C,E;switch(r){default:throw new Error("unrecognised depth");case 16:C=i[l],l++,e.push((c<<8)+C);break;case 4:C=c&15,E=c>>4,e.push(E,C);break;case 2:w=c&3,S=c>>2&3,C=c>>4&3,E=c>>6&3,e.push(E,C,S,w);break;case 1:u=c&1,h=c>>1&1,p=c>>2&1,_=c>>3&1,w=c>>4&1,S=c>>5&1,C=c>>6&1,E=c>>7&1,e.push(E,C,S,w,_,p,h,u);break}}return{get:function(c){for(;e.length<c;)s();var u=e.slice(0,c);return e=e.slice(c),u},resetAfterLine:function(){e.length=0},end:function(){if(l!==i.length)throw new Error("extra data found")}}}function a(i,r,e,l,s,c){for(var u=i.width,h=i.height,p=i.index,_=0;_<h;_++)for(var w=0;w<u;w++){for(var S=e(w,_,p),C=0;C<4;C++){var E=n[l][C];if(E===255)r[S+C]=255;else{var k=E+c;if(k===s.length)throw new Error("Ran out of data");r[S+C]=s[k]}}c+=l}return c}function t(i,r,e,l,s,c){for(var u=i.width,h=i.height,p=i.index,_=0;_<h;_++){for(var w=0;w<u;w++)for(var S=s.get(l),C=e(w,_,p),E=0;E<4;E++){var k=n[l][E];r[C+E]=k!==255?S[k]:c}s.resetAfterLine()}}g.dataToBitMap=function(i,r){var e=r.width,l=r.height,s=r.depth,c=r.bpp,u=r.interlace;if(s!==8)var h=o(i,s);var p;s<=8?p=new b(e*l*4):p=new Uint16Array(e*l*4);var _=Math.pow(2,s)-1,w=0,S,C;if(u)S=f.getImagePasses(e,l),C=f.getInterlaceIterator(e,l);else{var E=0;C=function(){var O=E;return E+=4,O},S=[{width:e,height:l}]}for(var k=0;k<S.length;k++)s===8?w=a(S[k],p,C,c,i,w):t(S[k],p,C,c,h,_);if(s===8){if(w!==i.length)throw new Error("extra data found")}else h.end();return p}}).call(this,m("buffer").Buffer)},{"./interlace":120,buffer:48}],111:[function(m,x,g){(function(b){var f=m("./constants");x.exports=function(n,o,a,t){var i=[f.COLORTYPE_COLOR_ALPHA,f.COLORTYPE_ALPHA].indexOf(t.colorType)!==-1;if(t.colorType===t.inputColorType){var r=function(){var O=new ArrayBuffer(2);return new DataView(O).setInt16(0,256,!0),new Int16Array(O)[0]!==256}();if(t.bitDepth===8||t.bitDepth===16&&r)return n}var e=t.bitDepth!==16?n:new Uint16Array(n.buffer),l=255,s=f.COLORTYPE_TO_BPP_MAP[t.inputColorType];s==4&&!t.inputHasAlpha&&(s=3);var c=f.COLORTYPE_TO_BPP_MAP[t.colorType];t.bitDepth===16&&(l=65535,c*=2);var u=new b(o*a*c),h=0,p=0,_=t.bgColor||{};_.red===void 0&&(_.red=l),_.green===void 0&&(_.green=l),_.blue===void 0&&(_.blue=l);function w(O,U){var F,M,j,G=l;switch(t.inputColorType){case f.COLORTYPE_COLOR_ALPHA:G=O[U+3],F=O[U],M=O[U+1],j=O[U+2];break;case f.COLORTYPE_COLOR:F=O[U],M=O[U+1],j=O[U+2];break;case f.COLORTYPE_ALPHA:G=O[U+1],F=O[U],M=F,j=F;break;case f.COLORTYPE_GRAYSCALE:F=O[U],M=F,j=F;break;default:throw new Error("input color type:"+t.inputColorType+" is not supported at present")}return t.inputHasAlpha&&(i||(G/=l,F=Math.min(Math.max(Math.round((1-G)*_.red+G*F),0),l),M=Math.min(Math.max(Math.round((1-G)*_.green+G*M),0),l),j=Math.min(Math.max(Math.round((1-G)*_.blue+G*j),0),l))),{red:F,green:M,blue:j,alpha:G}}for(var S=0;S<a;S++)for(var C=0;C<o;C++){var E=w(e,h);switch(t.colorType){case f.COLORTYPE_COLOR_ALPHA:case f.COLORTYPE_COLOR:t.bitDepth===8?(u[p]=E.red,u[p+1]=E.green,u[p+2]=E.blue,i&&(u[p+3]=E.alpha)):(u.writeUInt16BE(E.red,p),u.writeUInt16BE(E.green,p+2),u.writeUInt16BE(E.blue,p+4),i&&u.writeUInt16BE(E.alpha,p+6));break;case f.COLORTYPE_ALPHA:case f.COLORTYPE_GRAYSCALE:var k=(E.red+E.green+E.blue)/3;t.bitDepth===8?(u[p]=k,i&&(u[p+1]=E.alpha)):(u.writeUInt16BE(k,p),i&&u.writeUInt16BE(E.alpha,p+2));break}h+=s,p+=c}return u}}).call(this,m("buffer").Buffer)},{"./constants":113,buffer:48}],112:[function(m,x,g){(function(b,f){var n=m("util"),o=m("stream"),a=x.exports=function(){o.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};n.inherits(a,o),a.prototype.read=function(t,i){this._reads.push({length:Math.abs(t),allowLess:t<0,func:i}),b.nextTick((function(){this._process(),this._paused&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}).bind(this))},a.prototype.write=function(t,i){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;var r;return f.isBuffer(t)?r=t:r=new f(t,i||this._encoding),this._buffers.push(r),this._buffered+=r.length,this._process(),this._reads&&this._reads.length===0&&(this._paused=!0),this.writable&&!this._paused},a.prototype.end=function(t,i){t&&this.write(t,i),this.writable=!1,this._buffers&&(this._buffers.length===0?this._end():(this._buffers.push(null),this._process()))},a.prototype.destroySoon=a.prototype.end,a.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("There are some read requests waiting on finished stream")),this.destroy()},a.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},a.prototype._processReadAllowingLess=function(t){this._reads.shift();var i=this._buffers[0];i.length>t.length?(this._buffered-=t.length,this._buffers[0]=i.slice(t.length),t.func.call(this,i.slice(0,t.length))):(this._buffered-=i.length,this._buffers.shift(),t.func.call(this,i))},a.prototype._processRead=function(t){this._reads.shift();for(var i=0,r=0,e=new f(t.length);i<t.length;){var l=this._buffers[r++],s=Math.min(l.length,t.length-i);l.copy(e,i,0,s),i+=s,s!==l.length&&(this._buffers[--r]=l.slice(s))}r>0&&this._buffers.splice(0,r),this._buffered-=t.length,t.func.call(this,e)},a.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){var t=this._reads[0];if(t.allowLess)this._processReadAllowingLess(t);else if(this._buffered>=t.length)this._processRead(t);else break}this._buffers&&this._buffers.length>0&&this._buffers[0]===null&&this._end()}catch(i){this.emit("error",i)}}}).call(this,m("_process"),m("buffer").Buffer)},{_process:133,buffer:48,stream:155,util:186}],113:[function(m,x,g){x.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},{}],114:[function(m,x,g){var b=[];(function(){for(var n=0;n<256;n++){for(var o=n,a=0;a<8;a++)o&1?o=3988292384^o>>>1:o=o>>>1;b[n]=o}})();var f=x.exports=function(){this._crc=-1};f.prototype.write=function(n){for(var o=0;o<n.length;o++)this._crc=b[(this._crc^n[o])&255]^this._crc>>>8;return!0},f.prototype.crc32=function(){return this._crc^-1},f.crc32=function(n){for(var o=-1,a=0;a<n.length;a++)o=b[(o^n[a])&255]^o>>>8;return o^-1}},{}],115:[function(m,x,g){(function(b){var f=m("./paeth-predictor");function n(p,_,w,S,C){for(var E=0;E<w;E++)S[C+E]=p[_+E]}function o(p,_,w){for(var S=0,C=_+w,E=_;E<C;E++)S+=Math.abs(p[E]);return S}function a(p,_,w,S,C,E){for(var k=0;k<w;k++){var O=k>=E?p[_+k-E]:0,U=p[_+k]-O;S[C+k]=U}}function t(p,_,w,S){for(var C=0,E=0;E<w;E++){var k=E>=S?p[_+E-S]:0,O=p[_+E]-k;C+=Math.abs(O)}return C}function i(p,_,w,S,C){for(var E=0;E<w;E++){var k=_>0?p[_+E-w]:0,O=p[_+E]-k;S[C+E]=O}}function r(p,_,w){for(var S=0,C=_+w,E=_;E<C;E++){var k=_>0?p[E-w]:0,O=p[E]-k;S+=Math.abs(O)}return S}function e(p,_,w,S,C,E){for(var k=0;k<w;k++){var O=k>=E?p[_+k-E]:0,U=_>0?p[_+k-w]:0,F=p[_+k]-(O+U>>1);S[C+k]=F}}function l(p,_,w,S){for(var C=0,E=0;E<w;E++){var k=E>=S?p[_+E-S]:0,O=_>0?p[_+E-w]:0,U=p[_+E]-(k+O>>1);C+=Math.abs(U)}return C}function s(p,_,w,S,C,E){for(var k=0;k<w;k++){var O=k>=E?p[_+k-E]:0,U=_>0?p[_+k-w]:0,F=_>0&&k>=E?p[_+k-(w+E)]:0,M=p[_+k]-f(O,U,F);S[C+k]=M}}function c(p,_,w,S){for(var C=0,E=0;E<w;E++){var k=E>=S?p[_+E-S]:0,O=_>0?p[_+E-w]:0,U=_>0&&E>=S?p[_+E-(w+S)]:0,F=p[_+E]-f(k,O,U);C+=Math.abs(F)}return C}var u={0:n,1:a,2:i,3:e,4:s},h={0:o,1:t,2:r,3:l,4:c};x.exports=function(p,_,w,S,C){var E;if(!("filterType"in S)||S.filterType===-1)E=[0,1,2,3,4];else if(typeof S.filterType=="number")E=[S.filterType];else throw new Error("unrecognised filter types");S.bitDepth===16&&(C*=2);for(var k=_*C,O=0,U=0,F=new b((k+1)*w),M=E[0],j=0;j<w;j++){if(E.length>1)for(var G=1/0,N=0;N<E.length;N++){var R=h[E[N]](p,U,k,C);R<G&&(M=E[N],G=R)}F[O]=M,O++,u[M](p,U,k,F,O,C),O+=k,U+=k}return F}}).call(this,m("buffer").Buffer)},{"./paeth-predictor":124,buffer:48}],116:[function(m,x,g){(function(b){var f=m("util"),n=m("./chunkstream"),o=m("./filter-parse"),a=x.exports=function(t){n.call(this);var i=[],r=this;this._filter=new o(t,{read:this.read.bind(this),write:function(e){i.push(e)},complete:function(){r.emit("complete",b.concat(i))}}),this._filter.start()};f.inherits(a,n)}).call(this,m("buffer").Buffer)},{"./chunkstream":112,"./filter-parse":118,buffer:48,util:186}],117:[function(m,x,g){(function(b){var f=m("./sync-reader"),n=m("./filter-parse");g.process=function(o,a){var t=[],i=new f(o),r=new n(a,{read:i.read.bind(i),write:function(e){t.push(e)},complete:function(){}});return r.start(),i.process(),b.concat(t)}}).call(this,m("buffer").Buffer)},{"./filter-parse":118,"./sync-reader":131,buffer:48}],118:[function(m,x,g){(function(b){var f=m("./interlace"),n=m("./paeth-predictor");function o(t,i,r){var e=t*i;return r!==8&&(e=Math.ceil(e/(8/r))),e}var a=x.exports=function(t,i){var r=t.width,e=t.height,l=t.interlace,s=t.bpp,c=t.depth;if(this.read=i.read,this.write=i.write,this.complete=i.complete,this._imageIndex=0,this._images=[],l)for(var u=f.getImagePasses(r,e),h=0;h<u.length;h++)this._images.push({byteWidth:o(u[h].width,s,c),height:u[h].height,lineIndex:0});else this._images.push({byteWidth:o(r,s,c),height:e,lineIndex:0});c===8?this._xComparison=s:c===16?this._xComparison=s*2:this._xComparison=1};a.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},a.prototype._unFilterType1=function(t,i,r){for(var e=this._xComparison,l=e-1,s=0;s<r;s++){var c=t[1+s],u=s>l?i[s-e]:0;i[s]=c+u}},a.prototype._unFilterType2=function(t,i,r){for(var e=this._lastLine,l=0;l<r;l++){var s=t[1+l],c=e?e[l]:0;i[l]=s+c}},a.prototype._unFilterType3=function(t,i,r){for(var e=this._xComparison,l=e-1,s=this._lastLine,c=0;c<r;c++){var u=t[1+c],h=s?s[c]:0,p=c>l?i[c-e]:0,_=Math.floor((p+h)/2);i[c]=u+_}},a.prototype._unFilterType4=function(t,i,r){for(var e=this._xComparison,l=e-1,s=this._lastLine,c=0;c<r;c++){var u=t[1+c],h=s?s[c]:0,p=c>l?i[c-e]:0,_=c>l&&s?s[c-e]:0,w=n(p,h,_);i[c]=u+w}},a.prototype._reverseFilterLine=function(t){var i=t[0],r,e=this._images[this._imageIndex],l=e.byteWidth;if(i===0)r=t.slice(1,l+1);else switch(r=new b(l),i){case 1:this._unFilterType1(t,r,l);break;case 2:this._unFilterType2(t,r,l);break;case 3:this._unFilterType3(t,r,l);break;case 4:this._unFilterType4(t,r,l);break;default:throw new Error("Unrecognised filter type - "+i)}this.write(r),e.lineIndex++,e.lineIndex>=e.height?(this._lastLine=null,this._imageIndex++,e=this._images[this._imageIndex]):this._lastLine=r,e?this.read(e.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this,m("buffer").Buffer)},{"./interlace":120,"./paeth-predictor":124,buffer:48}],119:[function(m,x,g){(function(b){function f(a,t,i,r,e){for(var l=0,s=0;s<r;s++)for(var c=0;c<i;c++){var u=e[a[l]];if(!u)throw new Error("index "+a[l]+" not in palette");for(var h=0;h<4;h++)t[l+h]=u[h];l+=4}}function n(a,t,i,r,e){for(var l=0,s=0;s<r;s++)for(var c=0;c<i;c++){var u=!1;if(e.length===1?e[0]===a[l]&&(u=!0):e[0]===a[l]&&e[1]===a[l+1]&&e[2]===a[l+2]&&(u=!0),u)for(var h=0;h<4;h++)t[l+h]=0;l+=4}}function o(a,t,i,r,e){for(var l=255,s=Math.pow(2,e)-1,c=0,u=0;u<r;u++)for(var h=0;h<i;h++){for(var p=0;p<4;p++)t[c+p]=Math.floor(a[c+p]*l/s+.5);c+=4}}x.exports=function(a,t){var i=t.depth,r=t.width,e=t.height,l=t.colorType,s=t.transColor,c=t.palette,u=a;return l===3?f(a,u,r,e,c):(s&&n(a,u,r,e,s),i!==8&&(i===16&&(u=new b(r*e*4)),o(a,u,r,e,i))),u}}).call(this,m("buffer").Buffer)},{buffer:48}],120:[function(m,x,g){var b=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];g.getImagePasses=function(f,n){for(var o=[],a=f%8,t=n%8,i=(f-a)/8,r=(n-t)/8,e=0;e<b.length;e++){for(var l=b[e],s=i*l.x.length,c=r*l.y.length,u=0;u<l.x.length&&l.x[u]<a;u++)s++;for(u=0;u<l.y.length&&l.y[u]<t;u++)c++;s>0&&c>0&&o.push({width:s,height:c,index:e})}return o},g.getInterlaceIterator=function(f){return function(n,o,a){var t=n%b[a].x.length,i=(n-t)/b[a].x.length*8+b[a].x[t],r=o%b[a].y.length,e=(o-r)/b[a].y.length*8+b[a].y[r];return i*4+e*f*4}}},{}],121:[function(m,x,g){(function(b){var f=m("util"),n=m("stream"),o=m("./constants"),a=m("./packer"),t=x.exports=function(i){n.call(this);var r=i||{};this._packer=new a(r),this._deflate=this._packer.createDeflate(),this.readable=!0};f.inherits(t,n),t.prototype.pack=function(i,r,e,l){this.emit("data",new b(o.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(r,e)),l&&this.emit("data",this._packer.packGAMA(l));var s=this._packer.filterData(i,r,e);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",(function(c){this.emit("data",this._packer.packIDAT(c))}).bind(this)),this._deflate.on("end",(function(){this.emit("data",this._packer.packIEND()),this.emit("end")}).bind(this)),this._deflate.end(s)}}).call(this,m("buffer").Buffer)},{"./constants":113,"./packer":123,buffer:48,stream:155,util:186}],122:[function(m,x,g){(function(b){var f=!0,n=m("zlib");n.deflateSync||(f=!1);var o=m("./constants"),a=m("./packer");x.exports=function(t,i){if(!f)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var r=i||{},e=new a(r),l=[];l.push(new b(o.PNG_SIGNATURE)),l.push(e.packIHDR(t.width,t.height)),t.gamma&&l.push(e.packGAMA(t.gamma));var s=e.filterData(t.data,t.width,t.height),c=n.deflateSync(s,e.getDeflateOptions());if(s=null,!c||!c.length)throw new Error("bad png - invalid compressed data response");return l.push(e.packIDAT(c)),l.push(e.packIEND()),b.concat(l)}}).call(this,m("buffer").Buffer)},{"./constants":113,"./packer":123,buffer:48,zlib:35}],123:[function(m,x,g){(function(b){var f=m("./constants"),n=m("./crc"),o=m("./bitpacker"),a=m("./filter-pack"),t=m("zlib"),i=x.exports=function(r){if(this._options=r,r.deflateChunkSize=r.deflateChunkSize||32*1024,r.deflateLevel=r.deflateLevel!=null?r.deflateLevel:9,r.deflateStrategy=r.deflateStrategy!=null?r.deflateStrategy:3,r.inputHasAlpha=r.inputHasAlpha!=null?r.inputHasAlpha:!0,r.deflateFactory=r.deflateFactory||t.createDeflate,r.bitDepth=r.bitDepth||8,r.colorType=typeof r.colorType=="number"?r.colorType:f.COLORTYPE_COLOR_ALPHA,r.inputColorType=typeof r.inputColorType=="number"?r.inputColorType:f.COLORTYPE_COLOR_ALPHA,[f.COLORTYPE_GRAYSCALE,f.COLORTYPE_COLOR,f.COLORTYPE_COLOR_ALPHA,f.COLORTYPE_ALPHA].indexOf(r.colorType)===-1)throw new Error("option color type:"+r.colorType+" is not supported at present");if([f.COLORTYPE_GRAYSCALE,f.COLORTYPE_COLOR,f.COLORTYPE_COLOR_ALPHA,f.COLORTYPE_ALPHA].indexOf(r.inputColorType)===-1)throw new Error("option input color type:"+r.inputColorType+" is not supported at present");if(r.bitDepth!==8&&r.bitDepth!==16)throw new Error("option bit depth:"+r.bitDepth+" is not supported at present")};i.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},i.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},i.prototype.filterData=function(r,e,l){var s=o(r,e,l,this._options),c=f.COLORTYPE_TO_BPP_MAP[this._options.colorType],u=a(s,e,l,this._options,c);return u},i.prototype._packChunk=function(r,e){var l=e?e.length:0,s=new b(l+12);return s.writeUInt32BE(l,0),s.writeUInt32BE(r,4),e&&e.copy(s,8),s.writeInt32BE(n.crc32(s.slice(4,s.length-4)),s.length-4),s},i.prototype.packGAMA=function(r){var e=new b(4);return e.writeUInt32BE(Math.floor(r*f.GAMMA_DIVISION),0),this._packChunk(f.TYPE_gAMA,e)},i.prototype.packIHDR=function(r,e){var l=new b(13);return l.writeUInt32BE(r,0),l.writeUInt32BE(e,4),l[8]=this._options.bitDepth,l[9]=this._options.colorType,l[10]=0,l[11]=0,l[12]=0,this._packChunk(f.TYPE_IHDR,l)},i.prototype.packIDAT=function(r){return this._packChunk(f.TYPE_IDAT,r)},i.prototype.packIEND=function(){return this._packChunk(f.TYPE_IEND,null)}}).call(this,m("buffer").Buffer)},{"./bitpacker":111,"./constants":113,"./crc":114,"./filter-pack":115,buffer:48,zlib:35}],124:[function(m,x,g){x.exports=function(f,n,o){var a=f+n-o,t=Math.abs(a-f),i=Math.abs(a-n),r=Math.abs(a-o);return t<=i&&t<=r?f:i<=r?n:o}},{}],125:[function(m,x,g){var b=m("util"),f=m("zlib"),n=m("./chunkstream"),o=m("./filter-parse-async"),a=m("./parser"),t=m("./bitmapper"),i=m("./format-normaliser"),r=x.exports=function(e){n.call(this),this._parser=new a(e,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this)}),this._options=e,this.writable=!0,this._parser.start()};b.inherits(r,n),r.prototype._handleError=function(e){this.emit("error",e),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},r.prototype._inflateData=function(e){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=f.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{var l=(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1,s=l*this._bitmapInfo.height,c=Math.max(s,f.Z_MIN_CHUNK);this._inflate=f.createInflate({chunkSize:c});var u=s,h=this.emit.bind(this,"error");this._inflate.on("error",function(_){u&&h(_)}),this._filter.on("complete",this._complete.bind(this));var p=this._filter.write.bind(this._filter);this._inflate.on("data",function(_){u&&(_.length>u&&(_=_.slice(0,u)),u-=_.length,p(_))}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(e)},r.prototype._handleMetaData=function(e){this.emit("metadata",e),this._bitmapInfo=Object.create(e),this._filter=new o(this._bitmapInfo)},r.prototype._handleTransColor=function(e){this._bitmapInfo.transColor=e},r.prototype._handlePalette=function(e){this._bitmapInfo.palette=e},r.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"),this.destroySoon())},r.prototype._complete=function(e){if(!this.errord){try{var l=t.dataToBitMap(e,this._bitmapInfo),s=i(l,this._bitmapInfo);l=null}catch(c){this._handleError(c);return}this.emit("parsed",s)}}},{"./bitmapper":110,"./chunkstream":112,"./filter-parse-async":116,"./format-normaliser":119,"./parser":127,util:186,zlib:35}],126:[function(m,x,g){(function(b){var f=!0,n=m("zlib"),o=m("./sync-inflate");n.deflateSync||(f=!1);var a=m("./sync-reader"),t=m("./filter-parse-sync"),i=m("./parser"),r=m("./bitmapper"),e=m("./format-normaliser");x.exports=function(l,s){if(!f)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var c;function u(H){c=H}var h;function p(H){h=H}function _(H){h.transColor=H}function w(H){h.palette=H}var S;function C(H){S=H}var E=[];function k(H){E.push(H)}var O=new a(l),U=new i(s,{read:O.read.bind(O),error:u,metadata:p,gamma:C,palette:w,transColor:_,inflateData:k});if(U.start(),O.process(),c)throw c;var F=b.concat(E);E.length=0;var M;if(h.interlace)M=n.inflateSync(F);else{var j=(h.width*h.bpp*h.depth+7>>3)+1,G=j*h.height;M=o(F,{chunkSize:G,maxLength:G})}if(F=null,!M||!M.length)throw new Error("bad png - invalid inflate data response");var N=t.process(M,h);F=null;var R=r.dataToBitMap(N,h);N=null;var A=e(R,h);return h.data=A,h.gamma=S||0,h}}).call(this,m("buffer").Buffer)},{"./bitmapper":110,"./filter-parse-sync":117,"./format-normaliser":119,"./parser":127,"./sync-inflate":130,"./sync-reader":131,buffer:48,zlib:35}],127:[function(m,x,g){(function(b){var f=m("./constants"),n=m("./crc"),o=x.exports=function(a,t){this._options=a,a.checkCRC=a.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[f.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[f.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[f.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[f.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[f.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[f.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=t.read,this.error=t.error,this.metadata=t.metadata,this.gamma=t.gamma,this.transColor=t.transColor,this.palette=t.palette,this.parsed=t.parsed,this.inflateData=t.inflateData,this.finished=t.finished};o.prototype.start=function(){this.read(f.PNG_SIGNATURE.length,this._parseSignature.bind(this))},o.prototype._parseSignature=function(a){for(var t=f.PNG_SIGNATURE,i=0;i<t.length;i++)if(a[i]!==t[i]){this.error(new Error("Invalid file signature"));return}this.read(8,this._parseChunkBegin.bind(this))},o.prototype._parseChunkBegin=function(a){for(var t=a.readUInt32BE(0),i=a.readUInt32BE(4),r="",e=4;e<8;e++)r+=String.fromCharCode(a[e]);var l=!!(a[4]&32);if(!this._hasIHDR&&i!==f.TYPE_IHDR){this.error(new Error("Expected IHDR on beggining"));return}if(this._crc=new n,this._crc.write(new b(r)),this._chunks[i])return this._chunks[i](t);if(!l){this.error(new Error("Unsupported critical chunk type "+r));return}this.read(t+4,this._skipChunk.bind(this))},o.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},o.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},o.prototype._parseChunkEnd=function(a){var t=a.readInt32BE(0),i=this._crc.crc32();if(this._options.checkCRC&&i!==t){this.error(new Error("Crc error - "+t+" - "+i));return}this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},o.prototype._handleIHDR=function(a){this.read(a,this._parseIHDR.bind(this))},o.prototype._parseIHDR=function(a){this._crc.write(a);var t=a.readUInt32BE(0),i=a.readUInt32BE(4),r=a[8],e=a[9],l=a[10],s=a[11],c=a[12];if(r!==8&&r!==4&&r!==2&&r!==1&&r!==16){this.error(new Error("Unsupported bit depth "+r));return}if(!(e in f.COLORTYPE_TO_BPP_MAP)){this.error(new Error("Unsupported color type"));return}if(l!==0){this.error(new Error("Unsupported compression method"));return}if(s!==0){this.error(new Error("Unsupported filter method"));return}if(c!==0&&c!==1){this.error(new Error("Unsupported interlace method"));return}this._colorType=e;var u=f.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:t,height:i,depth:r,interlace:!!c,palette:!!(e&f.COLORTYPE_PALETTE),color:!!(e&f.COLORTYPE_COLOR),alpha:!!(e&f.COLORTYPE_ALPHA),bpp:u,colorType:e}),this._handleChunkEnd()},o.prototype._handlePLTE=function(a){this.read(a,this._parsePLTE.bind(this))},o.prototype._parsePLTE=function(a){this._crc.write(a);for(var t=Math.floor(a.length/3),i=0;i<t;i++)this._palette.push([a[i*3],a[i*3+1],a[i*3+2],255]);this.palette(this._palette),this._handleChunkEnd()},o.prototype._handleTRNS=function(a){this.read(a,this._parseTRNS.bind(this))},o.prototype._parseTRNS=function(a){if(this._crc.write(a),this._colorType===f.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0){this.error(new Error("Transparency chunk must be after palette"));return}if(a.length>this._palette.length){this.error(new Error("More transparent colors than palette size"));return}for(var t=0;t<a.length;t++)this._palette[t][3]=a[t];this.palette(this._palette)}this._colorType===f.COLORTYPE_GRAYSCALE&&this.transColor([a.readUInt16BE(0)]),this._colorType===f.COLORTYPE_COLOR&&this.transColor([a.readUInt16BE(0),a.readUInt16BE(2),a.readUInt16BE(4)]),this._handleChunkEnd()},o.prototype._handleGAMA=function(a){this.read(a,this._parseGAMA.bind(this))},o.prototype._parseGAMA=function(a){this._crc.write(a),this.gamma(a.readUInt32BE(0)/f.GAMMA_DIVISION),this._handleChunkEnd()},o.prototype._handleIDAT=function(a){this.read(-a,this._parseIDAT.bind(this,a))},o.prototype._parseIDAT=function(a,t){if(this._crc.write(t),this._colorType===f.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData(t);var i=a-t.length;i>0?this._handleIDAT(i):this._handleChunkEnd()},o.prototype._handleIEND=function(a){this.read(a,this._parseIEND.bind(this))},o.prototype._parseIEND=function(a){this._crc.write(a),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this,m("buffer").Buffer)},{"./constants":113,"./crc":114,buffer:48}],128:[function(m,x,g){var b=m("./parser-sync"),f=m("./packer-sync");g.read=function(n,o){return b(n,o||{})},g.write=function(n,o){return f(n,o)}},{"./packer-sync":122,"./parser-sync":126}],129:[function(m,x,g){(function(b,f){var n=m("util"),o=m("stream"),a=m("./parser-async"),t=m("./packer-async"),i=m("./png-sync"),r=g.PNG=function(e){o.call(this),e=e||{},this.width=e.width|0,this.height=e.height|0,this.data=this.width>0&&this.height>0?new f(4*this.width*this.height):null,e.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new a(e),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",(function(l){this.data=l,this.emit("parsed",l)}).bind(this)),this._packer=new t(e),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};n.inherits(r,o),r.sync=i,r.prototype.pack=function(){return!this.data||!this.data.length?(this.emit("error","No data provided"),this):(b.nextTick((function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}).bind(this)),this)},r.prototype.parse=function(e,l){if(l){var s,c;s=(function(u){this.removeListener("error",c),this.data=u,l(null,this)}).bind(this),c=(function(u){this.removeListener("parsed",s),l(u,null)}).bind(this),this.once("parsed",s),this.once("error",c)}return this.end(e),this},r.prototype.write=function(e){return this._parser.write(e),!0},r.prototype.end=function(e){this._parser.end(e)},r.prototype._metadata=function(e){this.width=e.width,this.height=e.height,this.emit("metadata",e)},r.prototype._gamma=function(e){this.gamma=e},r.prototype._handleClose=function(){!this._parser.writable&&!this._packer.readable&&this.emit("close")},r.bitblt=function(e,l,s,c,u,h,p,_){if(s|=0,c|=0,u|=0,h|=0,p|=0,_|=0,s>e.width||c>e.height||s+u>e.width||c+h>e.height)throw new Error("bitblt reading outside image");if(p>l.width||_>l.height||p+u>l.width||_+h>l.height)throw new Error("bitblt writing outside image");for(var w=0;w<h;w++)e.data.copy(l.data,(_+w)*l.width+p<<2,(c+w)*e.width+s<<2,(c+w)*e.width+s+u<<2)},r.prototype.bitblt=function(e,l,s,c,u,h,p){return r.bitblt(this,e,l,s,c,u,h,p),this},r.adjustGamma=function(e){if(e.gamma){for(var l=0;l<e.height;l++)for(var s=0;s<e.width;s++)for(var c=e.width*l+s<<2,u=0;u<3;u++){var h=e.data[c+u]/255;h=Math.pow(h,1/2.2/e.gamma),e.data[c+u]=Math.round(h*255)}e.gamma=0}},r.prototype.adjustGamma=function(){r.adjustGamma(this)}}).call(this,m("_process"),m("buffer").Buffer)},{"./packer-async":121,"./parser-async":125,"./png-sync":128,_process:133,buffer:48,stream:155,util:186}],130:[function(m,x,g){(function(b,f){var n=m("assert").ok,o=m("zlib"),a=m("util"),t=m("buffer").kMaxLength;function i(c){if(!(this instanceof i))return new i(c);c&&c.chunkSize<o.Z_MIN_CHUNK&&(c.chunkSize=o.Z_MIN_CHUNK),o.Inflate.call(this,c),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,c&&c.maxLength!=null&&(this._maxLength=c.maxLength)}function r(c){return new i(c)}function e(c,u){u&&b.nextTick(u),c._handle&&(c._handle.close(),c._handle=null)}i.prototype._processChunk=function(c,u,h){if(typeof h=="function")return o.Inflate._processChunk.call(this,c,u,h);var p=this,_=c&&c.length,w=this._chunkSize-this._offset,S=this._maxLength,C=0,E=[],k=0,O;this.on("error",function(j){O=j});function U(j,G){if(!p._hadError){var N=w-G;if(n(N>=0,"have should not go down"),N>0){var R=p._buffer.slice(p._offset,p._offset+N);if(p._offset+=N,R.length>S&&(R=R.slice(0,S)),E.push(R),k+=R.length,S-=R.length,S===0)return!1}return(G===0||p._offset>=p._chunkSize)&&(w=p._chunkSize,p._offset=0,p._buffer=f.allocUnsafe(p._chunkSize)),G===0?(C+=_-j,_=j,!0):!1}}n(this._handle,"zlib binding closed");do{var F=this._handle.writeSync(u,c,C,_,this._buffer,this._offset,w);F=F||this._writeState}while(!this._hadError&&U(F[0],F[1]));if(this._hadError)throw O;if(k>=t)throw e(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+t.toString(16)+" bytes");var M=f.concat(E,k);return e(this),M},a.inherits(i,o.Inflate);function l(c,u){if(typeof u=="string"&&(u=f.from(u)),!(u instanceof f))throw new TypeError("Not a string or buffer");var h=c._finishFlushFlag;return h==null&&(h=o.Z_FINISH),c._processChunk(u,h)}function s(c,u){return l(new i(u),c)}x.exports=g=s,g.Inflate=i,g.createInflate=r,g.inflateSync=s}).call(this,m("_process"),m("buffer").Buffer)},{_process:133,assert:25,buffer:48,util:186,zlib:35}],131:[function(m,x,g){var b=x.exports=function(f){this._buffer=f,this._reads=[]};b.prototype.read=function(f,n){this._reads.push({length:Math.abs(f),allowLess:f<0,func:n})},b.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){var f=this._reads[0];if(this._buffer.length&&(this._buffer.length>=f.length||f.allowLess)){this._reads.shift();var n=this._buffer;this._buffer=n.slice(f.length),f.func.call(this,n.slice(0,f.length))}else break}if(this._reads.length>0)return new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)return new Error("unrecognised content at end of stream")}},{}],132:[function(m,x,g){(function(b){typeof b>"u"||"1.0.04".indexOf("v0.")===0||"1.0.04".indexOf("v1.")===0&&"1.0.04".indexOf("v1.8.")!==0?x.exports={nextTick:f}:x.exports=b;function f(n,o,a,t){if(typeof n!="function")throw new TypeError('"callback" argument must be a function');var i=arguments.length,r,e;switch(i){case 0:case 1:return b.nextTick(n);case 2:return b.nextTick(function(){n.call(null,o)});case 3:return b.nextTick(function(){n.call(null,o,a)});case 4:return b.nextTick(function(){n.call(null,o,a,t)});default:for(r=new Array(i-1),e=0;e<r.length;)r[e++]=arguments[e];return b.nextTick(function(){n.apply(null,r)})}}}).call(this,m("_process"))},{_process:133}],133:[function(m,x,g){var b=x.exports={},f,n;function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?f=setTimeout:f=o}catch(_){f=o}try{typeof clearTimeout=="function"?n=clearTimeout:n=a}catch(_){n=a}})();function t(_){if(f===setTimeout)return setTimeout(_,0);if((f===o||!f)&&setTimeout)return f=setTimeout,setTimeout(_,0);try{return f(_,0)}catch(w){try{return f.call(null,_,0)}catch(S){return f.call(this,_,0)}}}function i(_){if(n===clearTimeout)return clearTimeout(_);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(_);try{return n(_)}catch(w){try{return n.call(null,_)}catch(S){return n.call(this,_)}}}var r=[],e=!1,l,s=-1;function c(){!e||!l||(e=!1,l.length?r=l.concat(r):s=-1,r.length&&u())}function u(){if(!e){var _=t(c);e=!0;for(var w=r.length;w;){for(l=r,r=[];++s<w;)l&&l[s].run();s=-1,w=r.length}l=null,e=!1,i(_)}}b.nextTick=function(_){var w=new Array(arguments.length-1);if(arguments.length>1)for(var S=1;S<arguments.length;S++)w[S-1]=arguments[S];r.push(new h(_,w)),r.length===1&&!e&&t(u)};function h(_,w){this.fun=_,this.array=w}h.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={};function p(){}b.on=p,b.addListener=p,b.once=p,b.off=p,b.removeListener=p,b.removeAllListeners=p,b.emit=p,b.prependListener=p,b.prependOnceListener=p,b.listeners=function(_){return[]},b.binding=function(_){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(_){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}},{}],134:[function(m,x,g){(function(b){(function(f){var n=typeof g=="object"&&g&&!g.nodeType&&g,o=typeof x=="object"&&x&&!x.nodeType&&x,a=typeof b=="object"&&b;(a.global===a||a.window===a||a.self===a)&&(f=a);var t,i=2147483647,r=36,e=1,l=26,s=38,c=700,u=72,h=128,p="-",_=/^xn--/,w=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=r-e,k=Math.floor,O=String.fromCharCode,U;function F(I){throw new RangeError(C[I])}function M(I,W){for(var q=I.length,ne=[];q--;)ne[q]=W(I[q]);return ne}function j(I,W){var q=I.split("@"),ne="";q.length>1&&(ne=q[0]+"@",I=q[1]),I=I.replace(S,".");var le=I.split("."),ce=M(le,W).join(".");return ne+ce}function G(I){for(var W=[],q=0,ne=I.length,le,ce;q<ne;)le=I.charCodeAt(q++),le>=55296&&le<=56319&&q<ne?(ce=I.charCodeAt(q++),(ce&64512)==56320?W.push(((le&1023)<<10)+(ce&1023)+65536):(W.push(le),q--)):W.push(le);return W}function N(I){return M(I,function(W){var q="";return W>65535&&(W-=65536,q+=O(W>>>10&1023|55296),W=56320|W&1023),q+=O(W),q}).join("")}function R(I){return I-48<10?I-22:I-65<26?I-65:I-97<26?I-97:r}function A(I,W){return I+22+75*(I<26)-((W!=0)<<5)}function H(I,W,q){var ne=0;for(I=q?k(I/c):I>>1,I+=k(I/W);I>E*l>>1;ne+=r)I=k(I/E);return k(ne+(E+1)*I/(I+s))}function Z(I){var W=[],q=I.length,ne,le=0,ce=h,fe=u,he,se,ie,Q,re,te,V,z,B;for(he=I.lastIndexOf(p),he<0&&(he=0),se=0;se<he;++se)I.charCodeAt(se)>=128&&F("not-basic"),W.push(I.charCodeAt(se));for(ie=he>0?he+1:0;ie<q;){for(Q=le,re=1,te=r;ie>=q&&F("invalid-input"),V=R(I.charCodeAt(ie++)),(V>=r||V>k((i-le)/re))&&F("overflow"),le+=V*re,z=te<=fe?e:te>=fe+l?l:te-fe,!(V<z);te+=r)B=r-z,re>k(i/B)&&F("overflow"),re*=B;ne=W.length+1,fe=H(le-Q,ne,Q==0),k(le/ne)>i-ce&&F("overflow"),ce+=k(le/ne),le%=ne,W.splice(le++,0,ce)}return N(W)}function K(I){var W,q,ne,le,ce,fe,he,se,ie,Q,re,te=[],V,z,B,ee;for(I=G(I),V=I.length,W=h,q=0,ce=u,fe=0;fe<V;++fe)re=I[fe],re<128&&te.push(O(re));for(ne=le=te.length,le&&te.push(p);ne<V;){for(he=i,fe=0;fe<V;++fe)re=I[fe],re>=W&&re<he&&(he=re);for(z=ne+1,he-W>k((i-q)/z)&&F("overflow"),q+=(he-W)*z,W=he,fe=0;fe<V;++fe)if(re=I[fe],re<W&&++q>i&&F("overflow"),re==W){for(se=q,ie=r;Q=ie<=ce?e:ie>=ce+l?l:ie-ce,!(se<Q);ie+=r)ee=se-Q,B=r-Q,te.push(O(A(Q+ee%B,0))),se=k(ee/B);te.push(O(A(se,0))),ce=H(q,z,ne==le),q=0,++ne}++q,++W}return te.join("")}function J(I){return j(I,function(W){return _.test(W)?Z(W.slice(4).toLowerCase()):W})}function D(I){return j(I,function(W){return w.test(W)?"xn--"+K(W):W})}if(t={version:"1.4.1",ucs2:{decode:G,encode:N},decode:Z,encode:K,toASCII:D,toUnicode:J},n&&o)if(x.exports==n)o.exports=t;else for(U in t)t.hasOwnProperty(U)&&(n[U]=t[U]);else f.punycode=t})(this)}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{}],135:[function(m,x,g){function b(n,o){return Object.prototype.hasOwnProperty.call(n,o)}x.exports=function(n,o,a,t){o=o||"&",a=a||"=";var i={};if(typeof n!="string"||n.length===0)return i;var r=/\+/g;n=n.split(o);var e=1e3;t&&typeof t.maxKeys=="number"&&(e=t.maxKeys);var l=n.length;e>0&&l>e&&(l=e);for(var s=0;s<l;++s){var c=n[s].replace(r,"%20"),u=c.indexOf(a),h,p,_,w;u>=0?(h=c.substr(0,u),p=c.substr(u+1)):(h=c,p=""),_=decodeURIComponent(h),w=decodeURIComponent(p),b(i,_)?f(i[_])?i[_].push(w):i[_]=[i[_],w]:i[_]=w}return i};var f=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"}},{}],136:[function(m,x,g){var b=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};x.exports=function(a,t,i,r){return t=t||"&",i=i||"=",a===null&&(a=void 0),typeof a=="object"?n(o(a),function(e){var l=encodeURIComponent(b(e))+i;return f(a[e])?n(a[e],function(s){return l+encodeURIComponent(b(s))}).join(t):l+encodeURIComponent(b(a[e]))}).join(t):r?encodeURIComponent(b(r))+i+encodeURIComponent(b(a)):""};var f=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function n(a,t){if(a.map)return a.map(t);for(var i=[],r=0;r<a.length;r++)i.push(t(a[r],r));return i}var o=Object.keys||function(a){var t=[];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&t.push(i);return t}},{}],137:[function(m,x,g){g.decode=g.parse=m("./decode"),g.encode=g.stringify=m("./encode")},{"./decode":135,"./encode":136}],138:[function(m,x,g){x.exports=m("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":139}],139:[function(m,x,g){var b=m("process-nextick-args"),f=Object.keys||function(c){var u=[];for(var h in c)u.push(h);return u};x.exports=e;var n=m("core-util-is");n.inherits=m("inherits");var o=m("./_stream_readable"),a=m("./_stream_writable");n.inherits(e,o);for(var t=f(a.prototype),i=0;i<t.length;i++){var r=t[i];e.prototype[r]||(e.prototype[r]=a.prototype[r])}function e(c){if(!(this instanceof e))return new e(c);o.call(this,c),a.call(this,c),c&&c.readable===!1&&(this.readable=!1),c&&c.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,c&&c.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",l)}Object.defineProperty(e.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function l(){this.allowHalfOpen||this._writableState.ended||b.nextTick(s,this)}function s(c){c.end()}Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(c){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=c,this._writableState.destroyed=c)}}),e.prototype._destroy=function(c,u){this.push(null),this.end(),b.nextTick(u,c)}},{"./_stream_readable":141,"./_stream_writable":143,"core-util-is":51,inherits:75,"process-nextick-args":132}],140:[function(m,x,g){x.exports=n;var b=m("./_stream_transform"),f=m("core-util-is");f.inherits=m("inherits"),f.inherits(n,b);function n(o){if(!(this instanceof n))return new n(o);b.call(this,o)}n.prototype._transform=function(o,a,t){t(null,o)}},{"./_stream_transform":142,"core-util-is":51,inherits:75}],141:[function(m,x,g){(function(b,f){var n=m("process-nextick-args");x.exports=k;var o=m("isarray"),a;k.ReadableState=E,m("events").EventEmitter;var t=function(Q,re){return Q.listeners(re).length},i=m("./internal/streams/stream"),r=m("safe-buffer").Buffer,e=f.Uint8Array||function(){};function l(Q){return r.from(Q)}function s(Q){return r.isBuffer(Q)||Q instanceof e}var c=m("core-util-is");c.inherits=m("inherits");var u=m("util"),h=void 0;u&&u.debuglog?h=u.debuglog("stream"):h=function(){};var p=m("./internal/streams/BufferList"),_=m("./internal/streams/destroy"),w;c.inherits(k,i);var S=["error","close","destroy","pause","resume"];function C(Q,re,te){if(typeof Q.prependListener=="function")return Q.prependListener(re,te);!Q._events||!Q._events[re]?Q.on(re,te):o(Q._events[re])?Q._events[re].unshift(te):Q._events[re]=[te,Q._events[re]]}function E(Q,re){a=a||m("./_stream_duplex"),Q=Q||{};var te=re instanceof a;this.objectMode=!!Q.objectMode,te&&(this.objectMode=this.objectMode||!!Q.readableObjectMode);var V=Q.highWaterMark,z=Q.readableHighWaterMark,B=this.objectMode?16:16*1024;V||V===0?this.highWaterMark=V:te&&(z||z===0)?this.highWaterMark=z:this.highWaterMark=B,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=Q.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Q.encoding&&(w||(w=m("string_decoder/").StringDecoder),this.decoder=new w(Q.encoding),this.encoding=Q.encoding)}function k(Q){if(a=a||m("./_stream_duplex"),!(this instanceof k))return new k(Q);this._readableState=new E(Q,this),this.readable=!0,Q&&(typeof Q.read=="function"&&(this._read=Q.read),typeof Q.destroy=="function"&&(this._destroy=Q.destroy)),i.call(this)}Object.defineProperty(k.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Q){this._readableState&&(this._readableState.destroyed=Q)}}),k.prototype.destroy=_.destroy,k.prototype._undestroy=_.undestroy,k.prototype._destroy=function(Q,re){this.push(null),re(Q)},k.prototype.push=function(Q,re){var te=this._readableState,V;return te.objectMode?V=!0:typeof Q=="string"&&(re=re||te.defaultEncoding,re!==te.encoding&&(Q=r.from(Q,re),re=""),V=!0),O(this,Q,re,!1,V)},k.prototype.unshift=function(Q){return O(this,Q,null,!0,!1)};function O(Q,re,te,V,z){var B=Q._readableState;if(re===null)B.reading=!1,R(Q,B);else{var ee;z||(ee=F(B,re)),ee?Q.emit("error",ee):B.objectMode||re&&re.length>0?(typeof re!="string"&&!B.objectMode&&Object.getPrototypeOf(re)!==r.prototype&&(re=l(re)),V?B.endEmitted?Q.emit("error",new Error("stream.unshift() after end event")):U(Q,B,re,!0):B.ended?Q.emit("error",new Error("stream.push() after EOF")):(B.reading=!1,B.decoder&&!te?(re=B.decoder.write(re),B.objectMode||re.length!==0?U(Q,B,re,!1):Z(Q,B)):U(Q,B,re,!1))):V||(B.reading=!1)}return M(B)}function U(Q,re,te,V){re.flowing&&re.length===0&&!re.sync?(Q.emit("data",te),Q.read(0)):(re.length+=re.objectMode?1:te.length,V?re.buffer.unshift(te):re.buffer.push(te),re.needReadable&&A(Q)),Z(Q,re)}function F(Q,re){var te;return!s(re)&&typeof re!="string"&&re!==void 0&&!Q.objectMode&&(te=new TypeError("Invalid non-string/buffer chunk")),te}function M(Q){return!Q.ended&&(Q.needReadable||Q.length<Q.highWaterMark||Q.length===0)}k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(Q){return w||(w=m("string_decoder/").StringDecoder),this._readableState.decoder=new w(Q),this._readableState.encoding=Q,this};var j=8388608;function G(Q){return Q>=j?Q=j:(Q--,Q|=Q>>>1,Q|=Q>>>2,Q|=Q>>>4,Q|=Q>>>8,Q|=Q>>>16,Q++),Q}function N(Q,re){return Q<=0||re.length===0&&re.ended?0:re.objectMode?1:Q!==Q?re.flowing&&re.length?re.buffer.head.data.length:re.length:(Q>re.highWaterMark&&(re.highWaterMark=G(Q)),Q<=re.length?Q:re.ended?re.length:(re.needReadable=!0,0))}k.prototype.read=function(Q){h("read",Q),Q=parseInt(Q,10);var re=this._readableState,te=Q;if(Q!==0&&(re.emittedReadable=!1),Q===0&&re.needReadable&&(re.length>=re.highWaterMark||re.ended))return h("read: emitReadable",re.length,re.ended),re.length===0&&re.ended?he(this):A(this),null;if(Q=N(Q,re),Q===0&&re.ended)return re.length===0&&he(this),null;var V=re.needReadable;h("need readable",V),(re.length===0||re.length-Q<re.highWaterMark)&&(V=!0,h("length less than watermark",V)),re.ended||re.reading?(V=!1,h("reading or ended",V)):V&&(h("do read"),re.reading=!0,re.sync=!0,re.length===0&&(re.needReadable=!0),this._read(re.highWaterMark),re.sync=!1,re.reading||(Q=N(te,re)));var z;return Q>0?z=ne(Q,re):z=null,z===null?(re.needReadable=!0,Q=0):re.length-=Q,re.length===0&&(re.ended||(re.needReadable=!0),te!==Q&&re.ended&&he(this)),z!==null&&this.emit("data",z),z};function R(Q,re){if(!re.ended){if(re.decoder){var te=re.decoder.end();te&&te.length&&(re.buffer.push(te),re.length+=re.objectMode?1:te.length)}re.ended=!0,A(Q)}}function A(Q){var re=Q._readableState;re.needReadable=!1,re.emittedReadable||(h("emitReadable",re.flowing),re.emittedReadable=!0,re.sync?n.nextTick(H,Q):H(Q))}function H(Q){h("emit readable"),Q.emit("readable"),q(Q)}function Z(Q,re){re.readingMore||(re.readingMore=!0,n.nextTick(K,Q,re))}function K(Q,re){for(var te=re.length;!re.reading&&!re.flowing&&!re.ended&&re.length<re.highWaterMark&&(h("maybeReadMore read 0"),Q.read(0),te!==re.length);)te=re.length;re.readingMore=!1}k.prototype._read=function(Q){this.emit("error",new Error("_read() is not implemented"))},k.prototype.pipe=function(Q,re){var te=this,V=this._readableState;switch(V.pipesCount){case 0:V.pipes=Q;break;case 1:V.pipes=[V.pipes,Q];break;default:V.pipes.push(Q);break}V.pipesCount+=1,h("pipe count=%d opts=%j",V.pipesCount,re);var z=(!re||re.end!==!1)&&Q!==b.stdout&&Q!==b.stderr,B=z?Y:Le;V.endEmitted?n.nextTick(B):te.once("end",B),Q.on("unpipe",ee);function ee(Se,Ee){h("onunpipe"),Se===te&&Ee&&Ee.hasUnpiped===!1&&(Ee.hasUnpiped=!0,ae())}function Y(){h("onend"),Q.end()}var L=J(te);Q.on("drain",L);var P=!1;function ae(){h("cleanup"),Q.removeListener("close",Te),Q.removeListener("finish",Re),Q.removeListener("drain",L),Q.removeListener("error",_e),Q.removeListener("unpipe",ee),te.removeListener("end",Y),te.removeListener("end",Le),te.removeListener("data",ve),P=!0,V.awaitDrain&&(!Q._writableState||Q._writableState.needDrain)&&L()}var ue=!1;te.on("data",ve);function ve(Se){h("ondata"),ue=!1;var Ee=Q.write(Se);Ee===!1&&!ue&&((V.pipesCount===1&&V.pipes===Q||V.pipesCount>1&&ie(V.pipes,Q)!==-1)&&!P&&(h("false write response, pause",te._readableState.awaitDrain),te._readableState.awaitDrain++,ue=!0),te.pause())}function _e(Se){h("onerror",Se),Le(),Q.removeListener("error",_e),t(Q,"error")===0&&Q.emit("error",Se)}C(Q,"error",_e);function Te(){Q.removeListener("finish",Re),Le()}Q.once("close",Te);function Re(){h("onfinish"),Q.removeListener("close",Te),Le()}Q.once("finish",Re);function Le(){h("unpipe"),te.unpipe(Q)}return Q.emit("pipe",te),V.flowing||(h("pipe resume"),te.resume()),Q};function J(Q){return function(){var re=Q._readableState;h("pipeOnDrain",re.awaitDrain),re.awaitDrain&&re.awaitDrain--,re.awaitDrain===0&&t(Q,"data")&&(re.flowing=!0,q(Q))}}k.prototype.unpipe=function(Q){var re=this._readableState,te={hasUnpiped:!1};if(re.pipesCount===0)return this;if(re.pipesCount===1)return Q&&Q!==re.pipes?this:(Q||(Q=re.pipes),re.pipes=null,re.pipesCount=0,re.flowing=!1,Q&&Q.emit("unpipe",this,te),this);if(!Q){var V=re.pipes,z=re.pipesCount;re.pipes=null,re.pipesCount=0,re.flowing=!1;for(var B=0;B<z;B++)V[B].emit("unpipe",this,te);return this}var ee=ie(re.pipes,Q);return ee===-1?this:(re.pipes.splice(ee,1),re.pipesCount-=1,re.pipesCount===1&&(re.pipes=re.pipes[0]),Q.emit("unpipe",this,te),this)},k.prototype.on=function(Q,re){var te=i.prototype.on.call(this,Q,re);if(Q==="data")this._readableState.flowing!==!1&&this.resume();else if(Q==="readable"){var V=this._readableState;!V.endEmitted&&!V.readableListening&&(V.readableListening=V.needReadable=!0,V.emittedReadable=!1,V.reading?V.length&&A(this):n.nextTick(D,this))}return te},k.prototype.addListener=k.prototype.on;function D(Q){h("readable nexttick read 0"),Q.read(0)}k.prototype.resume=function(){var Q=this._readableState;return Q.flowing||(h("resume"),Q.flowing=!0,I(this,Q)),this};function I(Q,re){re.resumeScheduled||(re.resumeScheduled=!0,n.nextTick(W,Q,re))}function W(Q,re){re.reading||(h("resume read 0"),Q.read(0)),re.resumeScheduled=!1,re.awaitDrain=0,Q.emit("resume"),q(Q),re.flowing&&!re.reading&&Q.read(0)}k.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function q(Q){var re=Q._readableState;for(h("flow",re.flowing);re.flowing&&Q.read()!==null;);}k.prototype.wrap=function(Q){var re=this,te=this._readableState,V=!1;Q.on("end",function(){if(h("wrapped end"),te.decoder&&!te.ended){var ee=te.decoder.end();ee&&ee.length&&re.push(ee)}re.push(null)}),Q.on("data",function(ee){if(h("wrapped data"),te.decoder&&(ee=te.decoder.write(ee)),!(te.objectMode&&ee==null)&&!(!te.objectMode&&(!ee||!ee.length))){var Y=re.push(ee);Y||(V=!0,Q.pause())}});for(var z in Q)this[z]===void 0&&typeof Q[z]=="function"&&(this[z]=function(ee){return function(){return Q[ee].apply(Q,arguments)}}(z));for(var B=0;B<S.length;B++)Q.on(S[B],this.emit.bind(this,S[B]));return this._read=function(ee){h("wrapped _read",ee),V&&(V=!1,Q.resume())},this},Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),k._fromList=ne;function ne(Q,re){if(re.length===0)return null;var te;return re.objectMode?te=re.buffer.shift():!Q||Q>=re.length?(re.decoder?te=re.buffer.join(""):re.buffer.length===1?te=re.buffer.head.data:te=re.buffer.concat(re.length),re.buffer.clear()):te=le(Q,re.buffer,re.decoder),te}function le(Q,re,te){var V;return Q<re.head.data.length?(V=re.head.data.slice(0,Q),re.head.data=re.head.data.slice(Q)):Q===re.head.data.length?V=re.shift():V=te?ce(Q,re):fe(Q,re),V}function ce(Q,re){var te=re.head,V=1,z=te.data;for(Q-=z.length;te=te.next;){var B=te.data,ee=Q>B.length?B.length:Q;if(ee===B.length?z+=B:z+=B.slice(0,Q),Q-=ee,Q===0){ee===B.length?(++V,te.next?re.head=te.next:re.head=re.tail=null):(re.head=te,te.data=B.slice(ee));break}++V}return re.length-=V,z}function fe(Q,re){var te=r.allocUnsafe(Q),V=re.head,z=1;for(V.data.copy(te),Q-=V.data.length;V=V.next;){var B=V.data,ee=Q>B.length?B.length:Q;if(B.copy(te,te.length-Q,0,ee),Q-=ee,Q===0){ee===B.length?(++z,V.next?re.head=V.next:re.head=re.tail=null):(re.head=V,V.data=B.slice(ee));break}++z}return re.length-=z,te}function he(Q){var re=Q._readableState;if(re.length>0)throw new Error('"endReadable()" called on non-empty stream');re.endEmitted||(re.ended=!0,n.nextTick(se,re,Q))}function se(Q,re){!Q.endEmitted&&Q.length===0&&(Q.endEmitted=!0,re.readable=!1,re.emit("end"))}function ie(Q,re){for(var te=0,V=Q.length;te<V;te++)if(Q[te]===re)return te;return-1}}).call(this,m("_process"),typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{"./_stream_duplex":139,"./internal/streams/BufferList":144,"./internal/streams/destroy":145,"./internal/streams/stream":146,_process:133,"core-util-is":51,events:52,inherits:75,isarray:79,"process-nextick-args":132,"safe-buffer":147,"string_decoder/":148,util:33}],142:[function(m,x,g){x.exports=o;var b=m("./_stream_duplex"),f=m("core-util-is");f.inherits=m("inherits"),f.inherits(o,b);function n(i,r){var e=this._transformState;e.transforming=!1;var l=e.writecb;if(!l)return this.emit("error",new Error("write callback called multiple times"));e.writechunk=null,e.writecb=null,r!=null&&this.push(r),l(i);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function o(i){if(!(this instanceof o))return new o(i);b.call(this,i),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,i&&(typeof i.transform=="function"&&(this._transform=i.transform),typeof i.flush=="function"&&(this._flush=i.flush)),this.on("prefinish",a)}function a(){var i=this;typeof this._flush=="function"?this._flush(function(r,e){t(i,r,e)}):t(this,null,null)}o.prototype.push=function(i,r){return this._transformState.needTransform=!1,b.prototype.push.call(this,i,r)},o.prototype._transform=function(i,r,e){throw new Error("_transform() is not implemented")},o.prototype._write=function(i,r,e){var l=this._transformState;if(l.writecb=e,l.writechunk=i,l.writeencoding=r,!l.transforming){var s=this._readableState;(l.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},o.prototype._read=function(i){var r=this._transformState;r.writechunk!==null&&r.writecb&&!r.transforming?(r.transforming=!0,this._transform(r.writechunk,r.writeencoding,r.afterTransform)):r.needTransform=!0},o.prototype._destroy=function(i,r){var e=this;b.prototype._destroy.call(this,i,function(l){r(l),e.emit("close")})};function t(i,r,e){if(r)return i.emit("error",r);if(e!=null&&i.push(e),i._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(i._transformState.transforming)throw new Error("Calling transform done when still transforming");return i.push(null)}},{"./_stream_duplex":139,"core-util-is":51,inherits:75}],143:[function(m,x,g){(function(b,f,n){var o=m("process-nextick-args");x.exports=C;function a(W){var q=this;this.next=null,this.entry=null,this.finish=function(){I(q,W)}}var t=!b.browser&&["v0.10","v0.9."].indexOf("1.0.04".slice(0,5))>-1?n:o.nextTick,i;C.WritableState=w;var r=m("core-util-is");r.inherits=m("inherits");var e={deprecate:m("util-deprecate")},l=m("./internal/streams/stream"),s=m("safe-buffer").Buffer,c=f.Uint8Array||function(){};function u(W){return s.from(W)}function h(W){return s.isBuffer(W)||W instanceof c}var p=m("./internal/streams/destroy");r.inherits(C,l);function _(){}function w(W,q){i=i||m("./_stream_duplex"),W=W||{};var ne=q instanceof i;this.objectMode=!!W.objectMode,ne&&(this.objectMode=this.objectMode||!!W.writableObjectMode);var le=W.highWaterMark,ce=W.writableHighWaterMark,fe=this.objectMode?16:16*1024;le||le===0?this.highWaterMark=le:ne&&(ce||ce===0)?this.highWaterMark=ce:this.highWaterMark=fe,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var he=W.decodeStrings===!1;this.decodeStrings=!he,this.defaultEncoding=W.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(se){G(q,se)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}w.prototype.getBuffer=function(){for(var q=this.bufferedRequest,ne=[];q;)ne.push(q),q=q.next;return ne},function(){try{Object.defineProperty(w.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(W){}}();var S;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(S=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(W){return S.call(this,W)?!0:this!==C?!1:W&&W._writableState instanceof w}})):S=function(W){return W instanceof this};function C(W){if(i=i||m("./_stream_duplex"),!S.call(C,this)&&!(this instanceof i))return new C(W);this._writableState=new w(W,this),this.writable=!0,W&&(typeof W.write=="function"&&(this._write=W.write),typeof W.writev=="function"&&(this._writev=W.writev),typeof W.destroy=="function"&&(this._destroy=W.destroy),typeof W.final=="function"&&(this._final=W.final)),l.call(this)}C.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function E(W,q){var ne=new Error("write after end");W.emit("error",ne),o.nextTick(q,ne)}function k(W,q,ne,le){var ce=!0,fe=!1;return ne===null?fe=new TypeError("May not write null values to stream"):typeof ne!="string"&&ne!==void 0&&!q.objectMode&&(fe=new TypeError("Invalid non-string/buffer chunk")),fe&&(W.emit("error",fe),o.nextTick(le,fe),ce=!1),ce}C.prototype.write=function(W,q,ne){var le=this._writableState,ce=!1,fe=!le.objectMode&&h(W);return fe&&!s.isBuffer(W)&&(W=u(W)),typeof q=="function"&&(ne=q,q=null),fe?q="buffer":q||(q=le.defaultEncoding),typeof ne!="function"&&(ne=_),le.ended?E(this,ne):(fe||k(this,le,W,ne))&&(le.pendingcb++,ce=U(this,le,fe,W,q,ne)),ce},C.prototype.cork=function(){var W=this._writableState;W.corked++},C.prototype.uncork=function(){var W=this._writableState;W.corked&&(W.corked--,!W.writing&&!W.corked&&!W.finished&&!W.bufferProcessing&&W.bufferedRequest&&A(this,W))},C.prototype.setDefaultEncoding=function(q){if(typeof q=="string"&&(q=q.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((q+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+q);return this._writableState.defaultEncoding=q,this};function O(W,q,ne){return!W.objectMode&&W.decodeStrings!==!1&&typeof q=="string"&&(q=s.from(q,ne)),q}Object.defineProperty(C.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function U(W,q,ne,le,ce,fe){if(!ne){var he=O(q,le,ce);le!==he&&(ne=!0,ce="buffer",le=he)}var se=q.objectMode?1:le.length;q.length+=se;var ie=q.length<q.highWaterMark;if(ie||(q.needDrain=!0),q.writing||q.corked){var Q=q.lastBufferedRequest;q.lastBufferedRequest={chunk:le,encoding:ce,isBuf:ne,callback:fe,next:null},Q?Q.next=q.lastBufferedRequest:q.bufferedRequest=q.lastBufferedRequest,q.bufferedRequestCount+=1}else F(W,q,!1,se,le,ce,fe);return ie}function F(W,q,ne,le,ce,fe,he){q.writelen=le,q.writecb=he,q.writing=!0,q.sync=!0,ne?W._writev(ce,q.onwrite):W._write(ce,fe,q.onwrite),q.sync=!1}function M(W,q,ne,le,ce){--q.pendingcb,ne?(o.nextTick(ce,le),o.nextTick(J,W,q),W._writableState.errorEmitted=!0,W.emit("error",le)):(ce(le),W._writableState.errorEmitted=!0,W.emit("error",le),J(W,q))}function j(W){W.writing=!1,W.writecb=null,W.length-=W.writelen,W.writelen=0}function G(W,q){var ne=W._writableState,le=ne.sync,ce=ne.writecb;if(j(ne),q)M(W,ne,le,q,ce);else{var fe=H(ne);!fe&&!ne.corked&&!ne.bufferProcessing&&ne.bufferedRequest&&A(W,ne),le?t(N,W,ne,fe,ce):N(W,ne,fe,ce)}}function N(W,q,ne,le){ne||R(W,q),q.pendingcb--,le(),J(W,q)}function R(W,q){q.length===0&&q.needDrain&&(q.needDrain=!1,W.emit("drain"))}function A(W,q){q.bufferProcessing=!0;var ne=q.bufferedRequest;if(W._writev&&ne&&ne.next){var le=q.bufferedRequestCount,ce=new Array(le),fe=q.corkedRequestsFree;fe.entry=ne;for(var he=0,se=!0;ne;)ce[he]=ne,ne.isBuf||(se=!1),ne=ne.next,he+=1;ce.allBuffers=se,F(W,q,!0,q.length,ce,"",fe.finish),q.pendingcb++,q.lastBufferedRequest=null,fe.next?(q.corkedRequestsFree=fe.next,fe.next=null):q.corkedRequestsFree=new a(q),q.bufferedRequestCount=0}else{for(;ne;){var ie=ne.chunk,Q=ne.encoding,re=ne.callback,te=q.objectMode?1:ie.length;if(F(W,q,!1,te,ie,Q,re),ne=ne.next,q.bufferedRequestCount--,q.writing)break}ne===null&&(q.lastBufferedRequest=null)}q.bufferedRequest=ne,q.bufferProcessing=!1}C.prototype._write=function(W,q,ne){ne(new Error("_write() is not implemented"))},C.prototype._writev=null,C.prototype.end=function(W,q,ne){var le=this._writableState;typeof W=="function"?(ne=W,W=null,q=null):typeof q=="function"&&(ne=q,q=null),W!=null&&this.write(W,q),le.corked&&(le.corked=1,this.uncork()),!le.ending&&!le.finished&&D(this,le,ne)};function H(W){return W.ending&&W.length===0&&W.bufferedRequest===null&&!W.finished&&!W.writing}function Z(W,q){W._final(function(ne){q.pendingcb--,ne&&W.emit("error",ne),q.prefinished=!0,W.emit("prefinish"),J(W,q)})}function K(W,q){!q.prefinished&&!q.finalCalled&&(typeof W._final=="function"?(q.pendingcb++,q.finalCalled=!0,o.nextTick(Z,W,q)):(q.prefinished=!0,W.emit("prefinish")))}function J(W,q){var ne=H(q);return ne&&(K(W,q),q.pendingcb===0&&(q.finished=!0,W.emit("finish"))),ne}function D(W,q,ne){q.ending=!0,J(W,q),ne&&(q.finished?o.nextTick(ne):W.once("finish",ne)),q.ended=!0,W.writable=!1}function I(W,q,ne){var le=W.entry;for(W.entry=null;le;){var ce=le.callback;q.pendingcb--,ce(ne),le=le.next}q.corkedRequestsFree?q.corkedRequestsFree.next=W:q.corkedRequestsFree=W}Object.defineProperty(C.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(W){this._writableState&&(this._writableState.destroyed=W)}}),C.prototype.destroy=p.destroy,C.prototype._undestroy=p.undestroy,C.prototype._destroy=function(W,q){this.end(),q(W)}}).call(this,m("_process"),typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{},m("timers").setImmediate)},{"./_stream_duplex":139,"./internal/streams/destroy":145,"./internal/streams/stream":146,_process:133,"core-util-is":51,inherits:75,"process-nextick-args":132,"safe-buffer":147,timers:176,"util-deprecate":183}],144:[function(m,x,g){function b(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var f=m("safe-buffer").Buffer,n=m("util");function o(a,t,i){a.copy(t,i)}x.exports=function(){function a(){b(this,a),this.head=null,this.tail=null,this.length=0}return a.prototype.push=function(i){var r={data:i,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length},a.prototype.unshift=function(i){var r={data:i,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length},a.prototype.shift=function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}},a.prototype.clear=function(){this.head=this.tail=null,this.length=0},a.prototype.join=function(i){if(this.length===0)return"";for(var r=this.head,e=""+r.data;r=r.next;)e+=i+r.data;return e},a.prototype.concat=function(i){if(this.length===0)return f.alloc(0);if(this.length===1)return this.head.data;for(var r=f.allocUnsafe(i>>>0),e=this.head,l=0;e;)o(e.data,r,l),l+=e.data.length,e=e.next;return r},a}(),n&&n.inspect&&n.inspect.custom&&(x.exports.prototype[n.inspect.custom]=function(){var a=n.inspect({length:this.length});return this.constructor.name+" "+a})},{"safe-buffer":147,util:33}],145:[function(m,x,g){var b=m("process-nextick-args");function f(a,t){var i=this,r=this._readableState&&this._readableState.destroyed,e=this._writableState&&this._writableState.destroyed;return r||e?(t?t(a):a&&(!this._writableState||!this._writableState.errorEmitted)&&b.nextTick(o,this,a),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(l){!t&&l?(b.nextTick(o,i,l),i._writableState&&(i._writableState.errorEmitted=!0)):t&&t(l)}),this)}function n(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function o(a,t){a.emit("error",t)}x.exports={destroy:f,undestroy:n}},{"process-nextick-args":132}],146:[function(m,x,g){x.exports=m("events").EventEmitter},{events:52}],147:[function(m,x,g){var b=m("buffer"),f=b.Buffer;function n(a,t){for(var i in a)t[i]=a[i]}f.from&&f.alloc&&f.allocUnsafe&&f.allocUnsafeSlow?x.exports=b:(n(b,g),g.Buffer=o);function o(a,t,i){return f(a,t,i)}n(f,o),o.from=function(a,t,i){if(typeof a=="number")throw new TypeError("Argument must not be a number");return f(a,t,i)},o.alloc=function(a,t,i){if(typeof a!="number")throw new TypeError("Argument must be a number");var r=f(a);return t!==void 0?typeof i=="string"?r.fill(t,i):r.fill(t):r.fill(0),r},o.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return f(a)},o.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return b.SlowBuffer(a)}},{buffer:48}],148:[function(m,x,g){var b=m("safe-buffer").Buffer,f=b.isEncoding||function(S){switch(S=""+S,S&&S.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(S){if(!S)return"utf8";for(var C;;)switch(S){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return S;default:if(C)return;S=(""+S).toLowerCase(),C=!0}}function o(S){var C=n(S);if(typeof C!="string"&&(b.isEncoding===f||!f(S)))throw new Error("Unknown encoding: "+S);return C||S}g.StringDecoder=a;function a(S){this.encoding=o(S);var C;switch(this.encoding){case"utf16le":this.text=c,this.end=u,C=4;break;case"utf8":this.fillLast=e,C=4;break;case"base64":this.text=h,this.end=p,C=3;break;default:this.write=_,this.end=w;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=b.allocUnsafe(C)}a.prototype.write=function(S){if(S.length===0)return"";var C,E;if(this.lastNeed){if(C=this.fillLast(S),C===void 0)return"";E=this.lastNeed,this.lastNeed=0}else E=0;return E<S.length?C?C+this.text(S,E):this.text(S,E):C||""},a.prototype.end=s,a.prototype.text=l,a.prototype.fillLast=function(S){if(this.lastNeed<=S.length)return S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,S.length),this.lastNeed-=S.length};function t(S){return S<=127?0:S>>5===6?2:S>>4===14?3:S>>3===30?4:S>>6===2?-1:-2}function i(S,C,E){var k=C.length-1;if(k<E)return 0;var O=t(C[k]);return O>=0?(O>0&&(S.lastNeed=O-1),O):--k<E||O===-2?0:(O=t(C[k]),O>=0?(O>0&&(S.lastNeed=O-2),O):--k<E||O===-2?0:(O=t(C[k]),O>=0?(O>0&&(O===2?O=0:S.lastNeed=O-3),O):0))}function r(S,C,E){if((C[0]&192)!==128)return S.lastNeed=0,"�";if(S.lastNeed>1&&C.length>1){if((C[1]&192)!==128)return S.lastNeed=1,"�";if(S.lastNeed>2&&C.length>2&&(C[2]&192)!==128)return S.lastNeed=2,"�"}}function e(S){var C=this.lastTotal-this.lastNeed,E=r(this,S);if(E!==void 0)return E;if(this.lastNeed<=S.length)return S.copy(this.lastChar,C,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);S.copy(this.lastChar,C,0,S.length),this.lastNeed-=S.length}function l(S,C){var E=i(this,S,C);if(!this.lastNeed)return S.toString("utf8",C);this.lastTotal=E;var k=S.length-(E-this.lastNeed);return S.copy(this.lastChar,0,k),S.toString("utf8",C,k)}function s(S){var C=S&&S.length?this.write(S):"";return this.lastNeed?C+"�":C}function c(S,C){if((S.length-C)%2===0){var E=S.toString("utf16le",C);if(E){var k=E.charCodeAt(E.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1],E.slice(0,-1)}return E}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=S[S.length-1],S.toString("utf16le",C,S.length-1)}function u(S){var C=S&&S.length?this.write(S):"";if(this.lastNeed){var E=this.lastTotal-this.lastNeed;return C+this.lastChar.toString("utf16le",0,E)}return C}function h(S,C){var E=(S.length-C)%3;return E===0?S.toString("base64",C):(this.lastNeed=3-E,this.lastTotal=3,E===1?this.lastChar[0]=S[S.length-1]:(this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1]),S.toString("base64",C,S.length-E))}function p(S){var C=S&&S.length?this.write(S):"";return this.lastNeed?C+this.lastChar.toString("base64",0,3-this.lastNeed):C}function _(S){return S.toString(this.encoding)}function w(S){return S&&S.length?this.write(S):""}},{"safe-buffer":147}],149:[function(m,x,g){x.exports=m("./readable").PassThrough},{"./readable":150}],150:[function(m,x,g){g=x.exports=m("./lib/_stream_readable.js"),g.Stream=g,g.Readable=g,g.Writable=m("./lib/_stream_writable.js"),g.Duplex=m("./lib/_stream_duplex.js"),g.Transform=m("./lib/_stream_transform.js"),g.PassThrough=m("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":139,"./lib/_stream_passthrough.js":140,"./lib/_stream_readable.js":141,"./lib/_stream_transform.js":142,"./lib/_stream_writable.js":143}],151:[function(m,x,g){x.exports=m("./readable").Transform},{"./readable":150}],152:[function(m,x,g){x.exports=m("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":143}],153:[function(m,x,g){var b=function(f){var n=Object.prototype,o=n.hasOwnProperty,a,t=typeof Symbol=="function"?Symbol:{},i=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",e=t.toStringTag||"@@toStringTag";function l(K,J,D,I){var W=J&&J.prototype instanceof w?J:w,q=Object.create(W.prototype),ne=new A(I||[]);return q._invoke=j(K,D,ne),q}f.wrap=l;function s(K,J,D){try{return{type:"normal",arg:K.call(J,D)}}catch(I){return{type:"throw",arg:I}}}var c="suspendedStart",u="suspendedYield",h="executing",p="completed",_={};function w(){}function S(){}function C(){}var E={};E[i]=function(){return this};var k=Object.getPrototypeOf,O=k&&k(k(H([])));O&&O!==n&&o.call(O,i)&&(E=O);var U=C.prototype=w.prototype=Object.create(E);S.prototype=U.constructor=C,C.constructor=S,C[e]=S.displayName="GeneratorFunction";function F(K){["next","throw","return"].forEach(function(J){K[J]=function(D){return this._invoke(J,D)}})}f.isGeneratorFunction=function(K){var J=typeof K=="function"&&K.constructor;return J?J===S||(J.displayName||J.name)==="GeneratorFunction":!1},f.mark=function(K){return Object.setPrototypeOf?Object.setPrototypeOf(K,C):(K.__proto__=C,e in K||(K[e]="GeneratorFunction")),K.prototype=Object.create(U),K},f.awrap=function(K){return{__await:K}};function M(K){function J(W,q,ne,le){var ce=s(K[W],K,q);if(ce.type==="throw")le(ce.arg);else{var fe=ce.arg,he=fe.value;return he&&typeof he=="object"&&o.call(he,"__await")?Promise.resolve(he.__await).then(function(se){J("next",se,ne,le)},function(se){J("throw",se,ne,le)}):Promise.resolve(he).then(function(se){fe.value=se,ne(fe)},function(se){return J("throw",se,ne,le)})}}var D;function I(W,q){function ne(){return new Promise(function(le,ce){J(W,q,le,ce)})}return D=D?D.then(ne,ne):ne()}this._invoke=I}F(M.prototype),M.prototype[r]=function(){return this},f.AsyncIterator=M,f.async=function(K,J,D,I){var W=new M(l(K,J,D,I));return f.isGeneratorFunction(J)?W:W.next().then(function(q){return q.done?q.value:W.next()})};function j(K,J,D){var I=c;return function(q,ne){if(I===h)throw new Error("Generator is already running");if(I===p){if(q==="throw")throw ne;return Z()}for(D.method=q,D.arg=ne;;){var le=D.delegate;if(le){var ce=G(le,D);if(ce){if(ce===_)continue;return ce}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(I===c)throw I=p,D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);I=h;var fe=s(K,J,D);if(fe.type==="normal"){if(I=D.done?p:u,fe.arg===_)continue;return{value:fe.arg,done:D.done}}else fe.type==="throw"&&(I=p,D.method="throw",D.arg=fe.arg)}}}function G(K,J){var D=K.iterator[J.method];if(D===a){if(J.delegate=null,J.method==="throw"){if(K.iterator.return&&(J.method="return",J.arg=a,G(K,J),J.method==="throw"))return _;J.method="throw",J.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var I=s(D,K.iterator,J.arg);if(I.type==="throw")return J.method="throw",J.arg=I.arg,J.delegate=null,_;var W=I.arg;if(!W)return J.method="throw",J.arg=new TypeError("iterator result is not an object"),J.delegate=null,_;if(W.done)J[K.resultName]=W.value,J.next=K.nextLoc,J.method!=="return"&&(J.method="next",J.arg=a);else return W;return J.delegate=null,_}F(U),U[e]="Generator",U[i]=function(){return this},U.toString=function(){return"[object Generator]"};function N(K){var J={tryLoc:K[0]};1 in K&&(J.catchLoc=K[1]),2 in K&&(J.finallyLoc=K[2],J.afterLoc=K[3]),this.tryEntries.push(J)}function R(K){var J=K.completion||{};J.type="normal",delete J.arg,K.completion=J}function A(K){this.tryEntries=[{tryLoc:"root"}],K.forEach(N,this),this.reset(!0)}f.keys=function(K){var J=[];for(var D in K)J.push(D);return J.reverse(),function I(){for(;J.length;){var W=J.pop();if(W in K)return I.value=W,I.done=!1,I}return I.done=!0,I}};function H(K){if(K){var J=K[i];if(J)return J.call(K);if(typeof K.next=="function")return K;if(!isNaN(K.length)){var D=-1,I=function W(){for(;++D<K.length;)if(o.call(K,D))return W.value=K[D],W.done=!1,W;return W.value=a,W.done=!0,W};return I.next=I}}return{next:Z}}f.values=H;function Z(){return{value:a,done:!0}}return A.prototype={constructor:A,reset:function(K){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(R),!K)for(var J in this)J.charAt(0)==="t"&&o.call(this,J)&&!isNaN(+J.slice(1))&&(this[J]=a)},stop:function(){this.done=!0;var K=this.tryEntries[0],J=K.completion;if(J.type==="throw")throw J.arg;return this.rval},dispatchException:function(K){if(this.done)throw K;var J=this;function D(ce,fe){return q.type="throw",q.arg=K,J.next=ce,fe&&(J.method="next",J.arg=a),!!fe}for(var I=this.tryEntries.length-1;I>=0;--I){var W=this.tryEntries[I],q=W.completion;if(W.tryLoc==="root")return D("end");if(W.tryLoc<=this.prev){var ne=o.call(W,"catchLoc"),le=o.call(W,"finallyLoc");if(ne&&le){if(this.prev<W.catchLoc)return D(W.catchLoc,!0);if(this.prev<W.finallyLoc)return D(W.finallyLoc)}else if(ne){if(this.prev<W.catchLoc)return D(W.catchLoc,!0)}else if(le){if(this.prev<W.finallyLoc)return D(W.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(K,J){for(var D=this.tryEntries.length-1;D>=0;--D){var I=this.tryEntries[D];if(I.tryLoc<=this.prev&&o.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var W=I;break}}W&&(K==="break"||K==="continue")&&W.tryLoc<=J&&J<=W.finallyLoc&&(W=null);var q=W?W.completion:{};return q.type=K,q.arg=J,W?(this.method="next",this.next=W.finallyLoc,_):this.complete(q)},complete:function(K,J){if(K.type==="throw")throw K.arg;return K.type==="break"||K.type==="continue"?this.next=K.arg:K.type==="return"?(this.rval=this.arg=K.arg,this.method="return",this.next="end"):K.type==="normal"&&J&&(this.next=J),_},finish:function(K){for(var J=this.tryEntries.length-1;J>=0;--J){var D=this.tryEntries[J];if(D.finallyLoc===K)return this.complete(D.completion,D.afterLoc),R(D),_}},catch:function(K){for(var J=this.tryEntries.length-1;J>=0;--J){var D=this.tryEntries[J];if(D.tryLoc===K){var I=D.completion;if(I.type==="throw"){var W=I.arg;R(D)}return W}}throw new Error("illegal catch attempt")},delegateYield:function(K,J,D){return this.delegate={iterator:H(K),resultName:J,nextLoc:D},this.method==="next"&&(this.arg=a),_}},f}(typeof x=="object"?x.exports:{});try{regeneratorRuntime=b}catch(f){Function("r","regeneratorRuntime = r")(b)}},{}],154:[function(m,x,g){var b=m("buffer"),f=b.Buffer;function n(a,t){for(var i in a)t[i]=a[i]}f.from&&f.alloc&&f.allocUnsafe&&f.allocUnsafeSlow?x.exports=b:(n(b,g),g.Buffer=o);function o(a,t,i){return f(a,t,i)}o.prototype=Object.create(f.prototype),n(f,o),o.from=function(a,t,i){if(typeof a=="number")throw new TypeError("Argument must not be a number");return f(a,t,i)},o.alloc=function(a,t,i){if(typeof a!="number")throw new TypeError("Argument must be a number");var r=f(a);return t!==void 0?typeof i=="string"?r.fill(t,i):r.fill(t):r.fill(0),r},o.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return f(a)},o.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return b.SlowBuffer(a)}},{buffer:48}],155:[function(m,x,g){x.exports=n;var b=m("events").EventEmitter,f=m("inherits");f(n,b),n.Readable=m("readable-stream/readable.js"),n.Writable=m("readable-stream/writable.js"),n.Duplex=m("readable-stream/duplex.js"),n.Transform=m("readable-stream/transform.js"),n.PassThrough=m("readable-stream/passthrough.js"),n.Stream=n;function n(){b.call(this)}n.prototype.pipe=function(o,a){var t=this;function i(h){o.writable&&o.write(h)===!1&&t.pause&&t.pause()}t.on("data",i);function r(){t.readable&&t.resume&&t.resume()}o.on("drain",r),!o._isStdio&&(!a||a.end!==!1)&&(t.on("end",l),t.on("close",s));var e=!1;function l(){e||(e=!0,o.end())}function s(){e||(e=!0,typeof o.destroy=="function"&&o.destroy())}function c(h){if(u(),b.listenerCount(this,"error")===0)throw h}t.on("error",c),o.on("error",c);function u(){t.removeListener("data",i),o.removeListener("drain",r),t.removeListener("end",l),t.removeListener("close",s),t.removeListener("error",c),o.removeListener("error",c),t.removeListener("end",u),t.removeListener("close",u),o.removeListener("close",u)}return t.on("end",u),t.on("close",u),o.on("close",u),o.emit("pipe",t),o}},{events:52,inherits:75,"readable-stream/duplex.js":138,"readable-stream/passthrough.js":149,"readable-stream/readable.js":150,"readable-stream/transform.js":151,"readable-stream/writable.js":152}],156:[function(m,x,g){(function(b){var f=m("./lib/request"),n=m("./lib/response"),o=m("xtend"),a=m("builtin-status-codes"),t=m("url"),i=g;i.request=function(r,e){typeof r=="string"?r=t.parse(r):r=o(r);var l=b.location.protocol.search(/^https?:$/)===-1?"http:":"",s=r.protocol||l,c=r.hostname||r.host,u=r.port,h=r.path||"/";c&&c.indexOf(":")!==-1&&(c="["+c+"]"),r.url=(c?s+"//"+c:"")+(u?":"+u:"")+h,r.method=(r.method||"GET").toUpperCase(),r.headers=r.headers||{};var p=new f(r);return e&&p.on("response",e),p},i.get=function(e,l){var s=i.request(e,l);return s.end(),s},i.ClientRequest=f,i.IncomingMessage=n.IncomingMessage,i.Agent=function(){},i.Agent.defaultMaxSockets=4,i.globalAgent=new i.Agent,i.STATUS_CODES=a,i.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{"./lib/request":158,"./lib/response":159,"builtin-status-codes":50,url:180,xtend:189}],157:[function(m,x,g){(function(b){g.fetch=a(b.fetch)&&a(b.ReadableStream),g.writableStream=a(b.WritableStream),g.abortController=a(b.AbortController);var f;function n(){if(f!==void 0)return f;if(b.XMLHttpRequest){f=new b.XMLHttpRequest;try{f.open("GET",b.XDomainRequest?"/":"https://example.com")}catch(t){f=null}}else f=null;return f}function o(t){var i=n();if(!i)return!1;try{return i.responseType=t,i.responseType===t}catch(r){}return!1}g.arraybuffer=g.fetch||o("arraybuffer"),g.msstream=!g.fetch&&o("ms-stream"),g.mozchunkedarraybuffer=!g.fetch&&o("moz-chunked-arraybuffer"),g.overrideMimeType=g.fetch||(n()?a(n().overrideMimeType):!1);function a(t){return typeof t=="function"}f=null}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{}],158:[function(m,x,g){(function(b,f,n){var o=m("./capability"),a=m("inherits"),t=m("./response"),i=m("readable-stream"),r=t.IncomingMessage,e=t.readyStates;function l(h,p){return o.fetch&&p?"fetch":o.mozchunkedarraybuffer?"moz-chunked-arraybuffer":o.msstream?"ms-stream":o.arraybuffer&&h?"arraybuffer":"text"}var s=x.exports=function(h){var p=this;i.Writable.call(p),p._opts=h,p._body=[],p._headers={},h.auth&&p.setHeader("Authorization","Basic "+n.from(h.auth).toString("base64")),Object.keys(h.headers).forEach(function(S){p.setHeader(S,h.headers[S])});var _,w=!0;if(h.mode==="disable-fetch"||"requestTimeout"in h&&!o.abortController)w=!1,_=!0;else if(h.mode==="prefer-streaming")_=!1;else if(h.mode==="allow-wrong-content-type")_=!o.overrideMimeType;else if(!h.mode||h.mode==="default"||h.mode==="prefer-fast")_=!0;else throw new Error("Invalid value for opts.mode");p._mode=l(_,w),p._fetchTimer=null,p.on("finish",function(){p._onFinish()})};a(s,i.Writable),s.prototype.setHeader=function(h,p){var _=this,w=h.toLowerCase();u.indexOf(w)===-1&&(_._headers[w]={name:h,value:p})},s.prototype.getHeader=function(h){var p=this._headers[h.toLowerCase()];return p?p.value:null},s.prototype.removeHeader=function(h){var p=this;delete p._headers[h.toLowerCase()]},s.prototype._onFinish=function(){var h=this;if(!h._destroyed){var p=h._opts,_=h._headers,w=null;p.method!=="GET"&&p.method!=="HEAD"&&(w=new Blob(h._body,{type:(_["content-type"]||{}).value||""}));var S=[];if(Object.keys(_).forEach(function(O){var U=_[O].name,F=_[O].value;Array.isArray(F)?F.forEach(function(M){S.push([U,M])}):S.push([U,F])}),h._mode==="fetch"){var C=null;if(o.abortController){var E=new AbortController;C=E.signal,h._fetchAbortController=E,"requestTimeout"in p&&p.requestTimeout!==0&&(h._fetchTimer=f.setTimeout(function(){h.emit("requestTimeout"),h._fetchAbortController&&h._fetchAbortController.abort()},p.requestTimeout))}f.fetch(h._opts.url,{method:h._opts.method,headers:S,body:w||void 0,mode:"cors",credentials:p.withCredentials?"include":"same-origin",signal:C}).then(function(O){h._fetchResponse=O,h._connect()},function(O){f.clearTimeout(h._fetchTimer),h._destroyed||h.emit("error",O)})}else{var k=h._xhr=new f.XMLHttpRequest;try{k.open(h._opts.method,h._opts.url,!0)}catch(O){b.nextTick(function(){h.emit("error",O)});return}"responseType"in k&&(k.responseType=h._mode),"withCredentials"in k&&(k.withCredentials=!!p.withCredentials),h._mode==="text"&&"overrideMimeType"in k&&k.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in p&&(k.timeout=p.requestTimeout,k.ontimeout=function(){h.emit("requestTimeout")}),S.forEach(function(O){k.setRequestHeader(O[0],O[1])}),h._response=null,k.onreadystatechange=function(){switch(k.readyState){case e.LOADING:case e.DONE:h._onXHRProgress();break}},h._mode==="moz-chunked-arraybuffer"&&(k.onprogress=function(){h._onXHRProgress()}),k.onerror=function(){h._destroyed||h.emit("error",new Error("XHR error"))};try{k.send(w)}catch(O){b.nextTick(function(){h.emit("error",O)});return}}}};function c(h){try{var p=h.status;return p!==null&&p!==0}catch(_){return!1}}s.prototype._onXHRProgress=function(){var h=this;!c(h._xhr)||h._destroyed||(h._response||h._connect(),h._response._onXHRProgress())},s.prototype._connect=function(){var h=this;h._destroyed||(h._response=new r(h._xhr,h._fetchResponse,h._mode,h._fetchTimer),h._response.on("error",function(p){h.emit("error",p)}),h.emit("response",h._response))},s.prototype._write=function(h,p,_){var w=this;w._body.push(h),_()},s.prototype.abort=s.prototype.destroy=function(){var h=this;h._destroyed=!0,f.clearTimeout(h._fetchTimer),h._response&&(h._response._destroyed=!0),h._xhr?h._xhr.abort():h._fetchAbortController&&h._fetchAbortController.abort()},s.prototype.end=function(h,p,_){var w=this;typeof h=="function"&&(_=h,h=void 0),i.Writable.prototype.end.call(w,h,p,_)},s.prototype.flushHeaders=function(){},s.prototype.setTimeout=function(){},s.prototype.setNoDelay=function(){},s.prototype.setSocketKeepAlive=function(){};var u=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,m("_process"),typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{},m("buffer").Buffer)},{"./capability":157,"./response":159,_process:133,buffer:48,inherits:75,"readable-stream":174}],159:[function(m,x,g){(function(b,f,n){var o=m("./capability"),a=m("inherits"),t=m("readable-stream"),i=g.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},r=g.IncomingMessage=function(e,l,s,c){var u=this;if(t.Readable.call(u),u._mode=s,u.headers={},u.rawHeaders=[],u.trailers={},u.rawTrailers=[],u.on("end",function(){b.nextTick(function(){u.emit("close")})}),s==="fetch"){let C=function(){p.read().then(function(E){if(!u._destroyed){if(E.done){f.clearTimeout(c),u.push(null);return}u.push(n.from(E.value)),C()}}).catch(function(E){f.clearTimeout(c),u._destroyed||u.emit("error",E)})};if(u._fetchResponse=l,u.url=l.url,u.statusCode=l.status,u.statusMessage=l.statusText,l.headers.forEach(function(E,k){u.headers[k.toLowerCase()]=E,u.rawHeaders.push(k,E)}),o.writableStream){var h=new WritableStream({write:function(E){return new Promise(function(k,O){u._destroyed?O():u.push(n.from(E))?k():u._resumeFetch=k})},close:function(){f.clearTimeout(c),u._destroyed||u.push(null)},abort:function(E){u._destroyed||u.emit("error",E)}});try{l.body.pipeTo(h).catch(function(E){f.clearTimeout(c),u._destroyed||u.emit("error",E)});return}catch(E){}}var p=l.body.getReader();C()}else{u._xhr=e,u._pos=0,u.url=e.responseURL,u.statusCode=e.status,u.statusMessage=e.statusText;var _=e.getAllResponseHeaders().split(/\r?\n/);if(_.forEach(function(C){var E=C.match(/^([^:]+):\s*(.*)/);if(E){var k=E[1].toLowerCase();k==="set-cookie"?(u.headers[k]===void 0&&(u.headers[k]=[]),u.headers[k].push(E[2])):u.headers[k]!==void 0?u.headers[k]+=", "+E[2]:u.headers[k]=E[2],u.rawHeaders.push(E[1],E[2])}}),u._charset="x-user-defined",!o.overrideMimeType){var w=u.rawHeaders["mime-type"];if(w){var S=w.match(/;\s*charset=([^;])(;|$)/);S&&(u._charset=S[1].toLowerCase())}u._charset||(u._charset="utf-8")}}};a(r,t.Readable),r.prototype._read=function(){var e=this,l=e._resumeFetch;l&&(e._resumeFetch=null,l())},r.prototype._onXHRProgress=function(){var e=this,l=e._xhr,s=null;switch(e._mode){case"text":if(s=l.responseText,s.length>e._pos){var c=s.substr(e._pos);if(e._charset==="x-user-defined"){for(var u=n.alloc(c.length),h=0;h<c.length;h++)u[h]=c.charCodeAt(h)&255;e.push(u)}else e.push(c,e._charset);e._pos=s.length}break;case"arraybuffer":if(l.readyState!==i.DONE||!l.response)break;s=l.response,e.push(n.from(new Uint8Array(s)));break;case"moz-chunked-arraybuffer":if(s=l.response,l.readyState!==i.LOADING||!s)break;e.push(n.from(new Uint8Array(s)));break;case"ms-stream":if(s=l.response,l.readyState!==i.LOADING)break;var p=new f.MSStreamReader;p.onprogress=function(){p.result.byteLength>e._pos&&(e.push(n.from(new Uint8Array(p.result.slice(e._pos)))),e._pos=p.result.byteLength)},p.onload=function(){e.push(null)},p.readAsArrayBuffer(s);break}e._xhr.readyState===i.DONE&&e._mode!=="ms-stream"&&e.push(null)}}).call(this,m("_process"),typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{},m("buffer").Buffer)},{"./capability":157,_process:133,buffer:48,inherits:75,"readable-stream":174}],160:[function(m,x,g){function b(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var f={};function n(r,e,l){l||(l=Error);function s(u,h,p){return typeof e=="string"?e:e(u,h,p)}var c=function(u){b(h,u);function h(p,_,w){return u.call(this,s(p,_,w))||this}return h}(l);c.prototype.name=l.name,c.prototype.code=r,f[r]=c}function o(r,e){if(Array.isArray(r)){var l=r.length;return r=r.map(function(s){return String(s)}),l>2?"one of ".concat(e," ").concat(r.slice(0,l-1).join(", "),", or ")+r[l-1]:l===2?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}else return"of ".concat(e," ").concat(String(r))}function a(r,e,l){return r.substr(!l||l<0?0:+l,e.length)===e}function t(r,e,l){return(l===void 0||l>r.length)&&(l=r.length),r.substring(l-e.length,l)===e}function i(r,e,l){return typeof l!="number"&&(l=0),l+e.length>r.length?!1:r.indexOf(e,l)!==-1}n("ERR_INVALID_OPT_VALUE",function(r,e){return'The value "'+e+'" is invalid for option "'+r+'"'},TypeError),n("ERR_INVALID_ARG_TYPE",function(r,e,l){var s;typeof e=="string"&&a(e,"not ")?(s="must not be",e=e.replace(/^not /,"")):s="must be";var c;if(t(r," argument"))c="The ".concat(r," ").concat(s," ").concat(o(e,"type"));else{var u=i(r,".")?"property":"argument";c='The "'.concat(r,'" ').concat(u," ").concat(s," ").concat(o(e,"type"))}return c+=". Received type ".concat(typeof l),c},TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),x.exports.codes=f},{}],161:[function(m,x,g){(function(b){var f=new Set;function n(a){if(!f.has(a)){var t=a+" is an experimental feature. This feature could change at any time";f.add(a),b.emitWarning(t,"ExperimentalWarning")}}function o(){}x.exports.emitExperimentalWarning=b.emitWarning?n:o}).call(this,m("_process"))},{_process:133}],162:[function(m,x,g){(function(b){var f=Object.keys||function(s){var c=[];for(var u in s)c.push(u);return c};x.exports=r;var n=m("./_stream_readable"),o=m("./_stream_writable");m("inherits")(r,n);for(var a=f(o.prototype),t=0;t<a.length;t++){var i=a[t];r.prototype[i]||(r.prototype[i]=o.prototype[i])}function r(s){if(!(this instanceof r))return new r(s);n.call(this,s),o.call(this,s),this.allowHalfOpen=!0,s&&(s.readable===!1&&(this.readable=!1),s.writable===!1&&(this.writable=!1),s.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",e)))}Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function e(){this._writableState.ended||b.nextTick(l,this)}function l(s){s.end()}Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(c){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=c,this._writableState.destroyed=c)}})}).call(this,m("_process"))},{"./_stream_readable":164,"./_stream_writable":166,_process:133,inherits:75}],163:[function(m,x,g){x.exports=f;var b=m("./_stream_transform");m("inherits")(f,b);function f(n){if(!(this instanceof f))return new f(n);b.call(this,n)}f.prototype._transform=function(n,o,a){a(null,n)}},{"./_stream_transform":165,inherits:75}],164:[function(m,x,g){(function(b,f){x.exports=N;var n;N.ReadableState=G,m("events").EventEmitter;var o=function(B,ee){return B.listeners(ee).length},a=m("./internal/streams/stream"),t=m("buffer").Buffer,i=f.Uint8Array||function(){};function r(z){return t.from(z)}function e(z){return t.isBuffer(z)||z instanceof i}var l=m("util"),s;l&&l.debuglog?s=l.debuglog("stream"):s=function(){};var c=m("./internal/streams/buffer_list"),u=m("./internal/streams/destroy"),h=m("./internal/streams/state"),p=h.getHighWaterMark,_=m("../errors").codes,w=_.ERR_INVALID_ARG_TYPE,S=_.ERR_STREAM_PUSH_AFTER_EOF,C=_.ERR_METHOD_NOT_IMPLEMENTED,E=_.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,k=m("../experimentalWarning"),O=k.emitExperimentalWarning,U,F;m("inherits")(N,a);var M=["error","close","destroy","pause","resume"];function j(z,B,ee){if(typeof z.prependListener=="function")return z.prependListener(B,ee);!z._events||!z._events[B]?z.on(B,ee):Array.isArray(z._events[B])?z._events[B].unshift(ee):z._events[B]=[ee,z._events[B]]}function G(z,B,ee){n=n||m("./_stream_duplex"),z=z||{},typeof ee!="boolean"&&(ee=B instanceof n),this.objectMode=!!z.objectMode,ee&&(this.objectMode=this.objectMode||!!z.readableObjectMode),this.highWaterMark=p(this,z,"readableHighWaterMark",ee),this.buffer=new c,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=z.emitClose!==!1,this.destroyed=!1,this.defaultEncoding=z.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,z.encoding&&(U||(U=m("string_decoder/").StringDecoder),this.decoder=new U(z.encoding),this.encoding=z.encoding)}function N(z){if(n=n||m("./_stream_duplex"),!(this instanceof N))return new N(z);var B=this instanceof n;this._readableState=new G(z,this,B),this.readable=!0,z&&(typeof z.read=="function"&&(this._read=z.read),typeof z.destroy=="function"&&(this._destroy=z.destroy)),a.call(this)}Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),N.prototype.destroy=u.destroy,N.prototype._undestroy=u.undestroy,N.prototype._destroy=function(z,B){B(z)},N.prototype.push=function(z,B){var ee=this._readableState,Y;return ee.objectMode?Y=!0:typeof z=="string"&&(B=B||ee.defaultEncoding,B!==ee.encoding&&(z=t.from(z,B),B=""),Y=!0),R(this,z,B,!1,Y)},N.prototype.unshift=function(z){return R(this,z,null,!0,!1)};function R(z,B,ee,Y,L){s("readableAddChunk",B);var P=z._readableState;if(B===null)P.reading=!1,D(z,P);else{var ae;if(L||(ae=H(P,B)),ae)z.emit("error",ae);else if(P.objectMode||B&&B.length>0)if(typeof B!="string"&&!P.objectMode&&Object.getPrototypeOf(B)!==t.prototype&&(B=r(B)),Y)P.endEmitted?z.emit("error",new E):A(z,P,B,!0);else if(P.ended)z.emit("error",new S);else{if(P.destroyed)return!1;P.reading=!1,P.decoder&&!ee?(B=P.decoder.write(B),P.objectMode||B.length!==0?A(z,P,B,!1):q(z,P)):A(z,P,B,!1)}else Y||(P.reading=!1,q(z,P))}return!P.ended&&(P.length<P.highWaterMark||P.length===0)}function A(z,B,ee,Y){B.flowing&&B.length===0&&!B.sync?(B.awaitDrain=0,z.emit("data",ee)):(B.length+=B.objectMode?1:ee.length,Y?B.buffer.unshift(ee):B.buffer.push(ee),B.needReadable&&I(z)),q(z,B)}function H(z,B){var ee;return!e(B)&&typeof B!="string"&&B!==void 0&&!z.objectMode&&(ee=new w("chunk",["string","Buffer","Uint8Array"],B)),ee}N.prototype.isPaused=function(){return this._readableState.flowing===!1},N.prototype.setEncoding=function(z){return U||(U=m("string_decoder/").StringDecoder),this._readableState.decoder=new U(z),this._readableState.encoding=this._readableState.decoder.encoding,this};var Z=8388608;function K(z){return z>=Z?z=Z:(z--,z|=z>>>1,z|=z>>>2,z|=z>>>4,z|=z>>>8,z|=z>>>16,z++),z}function J(z,B){return z<=0||B.length===0&&B.ended?0:B.objectMode?1:z!==z?B.flowing&&B.length?B.buffer.head.data.length:B.length:(z>B.highWaterMark&&(B.highWaterMark=K(z)),z<=B.length?z:B.ended?B.length:(B.needReadable=!0,0))}N.prototype.read=function(z){s("read",z),z=parseInt(z,10);var B=this._readableState,ee=z;if(z!==0&&(B.emittedReadable=!1),z===0&&B.needReadable&&((B.highWaterMark!==0?B.length>=B.highWaterMark:B.length>0)||B.ended))return s("read: emitReadable",B.length,B.ended),B.length===0&&B.ended?re(this):I(this),null;if(z=J(z,B),z===0&&B.ended)return B.length===0&&re(this),null;var Y=B.needReadable;s("need readable",Y),(B.length===0||B.length-z<B.highWaterMark)&&(Y=!0,s("length less than watermark",Y)),B.ended||B.reading?(Y=!1,s("reading or ended",Y)):Y&&(s("do read"),B.reading=!0,B.sync=!0,B.length===0&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(z=J(ee,B)));var L;return z>0?L=Q(z,B):L=null,L===null?(B.needReadable=!0,z=0):(B.length-=z,B.awaitDrain=0),B.length===0&&(B.ended||(B.needReadable=!0),ee!==z&&B.ended&&re(this)),L!==null&&this.emit("data",L),L};function D(z,B){if(!B.ended){if(B.decoder){var ee=B.decoder.end();ee&&ee.length&&(B.buffer.push(ee),B.length+=B.objectMode?1:ee.length)}B.ended=!0,B.sync?I(z):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,W(z)))}}function I(z){var B=z._readableState;B.needReadable=!1,B.emittedReadable||(s("emitReadable",B.flowing),B.emittedReadable=!0,b.nextTick(W,z))}function W(z){var B=z._readableState;s("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&z.emit("readable"),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,ie(z)}function q(z,B){B.readingMore||(B.readingMore=!0,b.nextTick(ne,z,B))}function ne(z,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&B.length===0);){var ee=B.length;if(s("maybeReadMore read 0"),z.read(0),ee===B.length)break}B.readingMore=!1}N.prototype._read=function(z){this.emit("error",new C("_read()"))},N.prototype.pipe=function(z,B){var ee=this,Y=this._readableState;switch(Y.pipesCount){case 0:Y.pipes=z;break;case 1:Y.pipes=[Y.pipes,z];break;default:Y.pipes.push(z);break}Y.pipesCount+=1,s("pipe count=%d opts=%j",Y.pipesCount,B);var L=(!B||B.end!==!1)&&z!==b.stdout&&z!==b.stderr,P=L?ue:Ce;Y.endEmitted?b.nextTick(P):ee.once("end",P),z.on("unpipe",ae);function ae(Ie,Ae){s("onunpipe"),Ie===ee&&Ae&&Ae.hasUnpiped===!1&&(Ae.hasUnpiped=!0,Te())}function ue(){s("onend"),z.end()}var ve=le(ee);z.on("drain",ve);var _e=!1;function Te(){s("cleanup"),z.removeListener("close",Se),z.removeListener("finish",Ee),z.removeListener("drain",ve),z.removeListener("error",Le),z.removeListener("unpipe",ae),ee.removeListener("end",ue),ee.removeListener("end",Ce),ee.removeListener("data",Re),_e=!0,Y.awaitDrain&&(!z._writableState||z._writableState.needDrain)&&ve()}ee.on("data",Re);function Re(Ie){s("ondata");var Ae=z.write(Ie);s("dest.write",Ae),Ae===!1&&((Y.pipesCount===1&&Y.pipes===z||Y.pipesCount>1&&V(Y.pipes,z)!==-1)&&!_e&&(s("false write response, pause",Y.awaitDrain),Y.awaitDrain++),ee.pause())}function Le(Ie){s("onerror",Ie),Ce(),z.removeListener("error",Le),o(z,"error")===0&&z.emit("error",Ie)}j(z,"error",Le);function Se(){z.removeListener("finish",Ee),Ce()}z.once("close",Se);function Ee(){s("onfinish"),z.removeListener("close",Se),Ce()}z.once("finish",Ee);function Ce(){s("unpipe"),ee.unpipe(z)}return z.emit("pipe",ee),Y.flowing||(s("pipe resume"),ee.resume()),z};function le(z){return function(){var ee=z._readableState;s("pipeOnDrain",ee.awaitDrain),ee.awaitDrain&&ee.awaitDrain--,ee.awaitDrain===0&&o(z,"data")&&(ee.flowing=!0,ie(z))}}N.prototype.unpipe=function(z){var B=this._readableState,ee={hasUnpiped:!1};if(B.pipesCount===0)return this;if(B.pipesCount===1)return z&&z!==B.pipes?this:(z||(z=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,z&&z.emit("unpipe",this,ee),this);if(!z){var Y=B.pipes,L=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var P=0;P<L;P++)Y[P].emit("unpipe",this,{hasUnpiped:!1});return this}var ae=V(B.pipes,z);return ae===-1?this:(B.pipes.splice(ae,1),B.pipesCount-=1,B.pipesCount===1&&(B.pipes=B.pipes[0]),z.emit("unpipe",this,ee),this)},N.prototype.on=function(z,B){var ee=a.prototype.on.call(this,z,B),Y=this._readableState;return z==="data"?(Y.readableListening=this.listenerCount("readable")>0,Y.flowing!==!1&&this.resume()):z==="readable"&&!Y.endEmitted&&!Y.readableListening&&(Y.readableListening=Y.needReadable=!0,Y.flowing=!1,Y.emittedReadable=!1,s("on readable",Y.length,Y.reading),Y.length?I(this):Y.reading||b.nextTick(fe,this)),ee},N.prototype.addListener=N.prototype.on,N.prototype.removeListener=function(z,B){var ee=a.prototype.removeListener.call(this,z,B);return z==="readable"&&b.nextTick(ce,this),ee},N.prototype.removeAllListeners=function(z){var B=a.prototype.removeAllListeners.apply(this,arguments);return(z==="readable"||z===void 0)&&b.nextTick(ce,this),B};function ce(z){var B=z._readableState;B.readableListening=z.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:z.listenerCount("data")>0&&z.resume()}function fe(z){s("readable nexttick read 0"),z.read(0)}N.prototype.resume=function(){var z=this._readableState;return z.flowing||(s("resume"),z.flowing=!z.readableListening,he(this,z)),z.paused=!1,this};function he(z,B){B.resumeScheduled||(B.resumeScheduled=!0,b.nextTick(se,z,B))}function se(z,B){s("resume",B.reading),B.reading||z.read(0),B.resumeScheduled=!1,z.emit("resume"),ie(z),B.flowing&&!B.reading&&z.read(0)}N.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function ie(z){var B=z._readableState;for(s("flow",B.flowing);B.flowing&&z.read()!==null;);}N.prototype.wrap=function(z){var B=this,ee=this._readableState,Y=!1;z.on("end",function(){if(s("wrapped end"),ee.decoder&&!ee.ended){var ae=ee.decoder.end();ae&&ae.length&&B.push(ae)}B.push(null)}),z.on("data",function(ae){if(s("wrapped data"),ee.decoder&&(ae=ee.decoder.write(ae)),!(ee.objectMode&&ae==null)&&!(!ee.objectMode&&(!ae||!ae.length))){var ue=B.push(ae);ue||(Y=!0,z.pause())}});for(var L in z)this[L]===void 0&&typeof z[L]=="function"&&(this[L]=function(ue){return function(){return z[ue].apply(z,arguments)}}(L));for(var P=0;P<M.length;P++)z.on(M[P],this.emit.bind(this,M[P]));return this._read=function(ae){s("wrapped _read",ae),Y&&(Y=!1,z.resume())},this},typeof Symbol=="function"&&(N.prototype[Symbol.asyncIterator]=function(){return O("Readable[Symbol.asyncIterator]"),F===void 0&&(F=m("./internal/streams/async_iterator")),F(this)}),Object.defineProperty(N.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(N.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(N.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),N._fromList=Q,Object.defineProperty(N.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Q(z,B){if(B.length===0)return null;var ee;return B.objectMode?ee=B.buffer.shift():!z||z>=B.length?(B.decoder?ee=B.buffer.join(""):B.buffer.length===1?ee=B.buffer.first():ee=B.buffer.concat(B.length),B.buffer.clear()):ee=B.buffer.consume(z,B.decoder),ee}function re(z){var B=z._readableState;s("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,b.nextTick(te,B,z))}function te(z,B){s("endReadableNT",z.endEmitted,z.length),!z.endEmitted&&z.length===0&&(z.endEmitted=!0,B.readable=!1,B.emit("end"))}function V(z,B){for(var ee=0,Y=z.length;ee<Y;ee++)if(z[ee]===B)return ee;return-1}}).call(this,m("_process"),typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{"../errors":160,"../experimentalWarning":161,"./_stream_duplex":162,"./internal/streams/async_iterator":167,"./internal/streams/buffer_list":168,"./internal/streams/destroy":169,"./internal/streams/state":172,"./internal/streams/stream":173,_process:133,buffer:48,events:52,inherits:75,"string_decoder/":175,util:33}],165:[function(m,x,g){x.exports=r;var b=m("../errors").codes,f=b.ERR_METHOD_NOT_IMPLEMENTED,n=b.ERR_MULTIPLE_CALLBACK,o=b.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=b.ERR_TRANSFORM_WITH_LENGTH_0,t=m("./_stream_duplex");m("inherits")(r,t);function i(s,c){var u=this._transformState;u.transforming=!1;var h=u.writecb;if(h===null)return this.emit("error",new n);u.writechunk=null,u.writecb=null,c!=null&&this.push(c),h(s);var p=this._readableState;p.reading=!1,(p.needReadable||p.length<p.highWaterMark)&&this._read(p.highWaterMark)}function r(s){if(!(this instanceof r))return new r(s);t.call(this,s),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,s&&(typeof s.transform=="function"&&(this._transform=s.transform),typeof s.flush=="function"&&(this._flush=s.flush)),this.on("prefinish",e)}function e(){var s=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(c,u){l(s,c,u)}):l(this,null,null)}r.prototype.push=function(s,c){return this._transformState.needTransform=!1,t.prototype.push.call(this,s,c)},r.prototype._transform=function(s,c,u){u(new f("_transform()"))},r.prototype._write=function(s,c,u){var h=this._transformState;if(h.writecb=u,h.writechunk=s,h.writeencoding=c,!h.transforming){var p=this._readableState;(h.needTransform||p.needReadable||p.length<p.highWaterMark)&&this._read(p.highWaterMark)}},r.prototype._read=function(s){var c=this._transformState;c.writechunk!==null&&!c.transforming?(c.transforming=!0,this._transform(c.writechunk,c.writeencoding,c.afterTransform)):c.needTransform=!0},r.prototype._destroy=function(s,c){t.prototype._destroy.call(this,s,function(u){c(u)})};function l(s,c,u){if(c)return s.emit("error",c);if(u!=null&&s.push(u),s._writableState.length)throw new a;if(s._transformState.transforming)throw new o;return s.push(null)}},{"../errors":160,"./_stream_duplex":162,inherits:75}],166:[function(m,x,g){(function(b,f){x.exports=j;function n(se){var ie=this;this.next=null,this.entry=null,this.finish=function(){he(ie,se)}}var o;j.WritableState=F;var a={deprecate:m("util-deprecate")},t=m("./internal/streams/stream"),i=m("buffer").Buffer,r=f.Uint8Array||function(){};function e(se){return i.from(se)}function l(se){return i.isBuffer(se)||se instanceof r}var s=m("./internal/streams/destroy"),c=m("./internal/streams/state"),u=c.getHighWaterMark,h=m("../errors").codes,p=h.ERR_INVALID_ARG_TYPE,_=h.ERR_METHOD_NOT_IMPLEMENTED,w=h.ERR_MULTIPLE_CALLBACK,S=h.ERR_STREAM_CANNOT_PIPE,C=h.ERR_STREAM_DESTROYED,E=h.ERR_STREAM_NULL_VALUES,k=h.ERR_STREAM_WRITE_AFTER_END,O=h.ERR_UNKNOWN_ENCODING;m("inherits")(j,t);function U(){}function F(se,ie,Q){o=o||m("./_stream_duplex"),se=se||{},typeof Q!="boolean"&&(Q=ie instanceof o),this.objectMode=!!se.objectMode,Q&&(this.objectMode=this.objectMode||!!se.writableObjectMode),this.highWaterMark=u(this,se,"writableHighWaterMark",Q),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var re=se.decodeStrings===!1;this.decodeStrings=!re,this.defaultEncoding=se.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(te){J(ie,te)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=se.emitClose!==!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}F.prototype.getBuffer=function(){for(var ie=this.bufferedRequest,Q=[];ie;)Q.push(ie),ie=ie.next;return Q},function(){try{Object.defineProperty(F.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(se){}}();var M;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(M=Function.prototype[Symbol.hasInstance],Object.defineProperty(j,Symbol.hasInstance,{value:function(ie){return M.call(this,ie)?!0:this!==j?!1:ie&&ie._writableState instanceof F}})):M=function(ie){return ie instanceof this};function j(se){o=o||m("./_stream_duplex");var ie=this instanceof o;if(!ie&&!M.call(j,this))return new j(se);this._writableState=new F(se,this,ie),this.writable=!0,se&&(typeof se.write=="function"&&(this._write=se.write),typeof se.writev=="function"&&(this._writev=se.writev),typeof se.destroy=="function"&&(this._destroy=se.destroy),typeof se.final=="function"&&(this._final=se.final)),t.call(this)}j.prototype.pipe=function(){this.emit("error",new S)};function G(se,ie){var Q=new k;se.emit("error",Q),b.nextTick(ie,Q)}function N(se,ie,Q,re){var te;return Q===null?te=new E:typeof Q!="string"&&!ie.objectMode&&(te=new p("chunk",["string","Buffer"],Q)),te?(se.emit("error",te),b.nextTick(re,te),!1):!0}j.prototype.write=function(se,ie,Q){var re=this._writableState,te=!1,V=!re.objectMode&&l(se);return V&&!i.isBuffer(se)&&(se=e(se)),typeof ie=="function"&&(Q=ie,ie=null),V?ie="buffer":ie||(ie=re.defaultEncoding),typeof Q!="function"&&(Q=U),re.ending?G(this,Q):(V||N(this,re,se,Q))&&(re.pendingcb++,te=A(this,re,V,se,ie,Q)),te},j.prototype.cork=function(){this._writableState.corked++},j.prototype.uncork=function(){var se=this._writableState;se.corked&&(se.corked--,!se.writing&&!se.corked&&!se.bufferProcessing&&se.bufferedRequest&&W(this,se))},j.prototype.setDefaultEncoding=function(ie){if(typeof ie=="string"&&(ie=ie.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ie+"").toLowerCase())>-1))throw new O(ie);return this._writableState.defaultEncoding=ie,this},Object.defineProperty(j.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function R(se,ie,Q){return!se.objectMode&&se.decodeStrings!==!1&&typeof ie=="string"&&(ie=i.from(ie,Q)),ie}Object.defineProperty(j.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function A(se,ie,Q,re,te,V){if(!Q){var z=R(ie,re,te);re!==z&&(Q=!0,te="buffer",re=z)}var B=ie.objectMode?1:re.length;ie.length+=B;var ee=ie.length<ie.highWaterMark;if(ee||(ie.needDrain=!0),ie.writing||ie.corked){var Y=ie.lastBufferedRequest;ie.lastBufferedRequest={chunk:re,encoding:te,isBuf:Q,callback:V,next:null},Y?Y.next=ie.lastBufferedRequest:ie.bufferedRequest=ie.lastBufferedRequest,ie.bufferedRequestCount+=1}else H(se,ie,!1,B,re,te,V);return ee}function H(se,ie,Q,re,te,V,z){ie.writelen=re,ie.writecb=z,ie.writing=!0,ie.sync=!0,ie.destroyed?ie.onwrite(new C("write")):Q?se._writev(te,ie.onwrite):se._write(te,V,ie.onwrite),ie.sync=!1}function Z(se,ie,Q,re,te){--ie.pendingcb,Q?(b.nextTick(te,re),b.nextTick(ce,se,ie),se._writableState.errorEmitted=!0,se.emit("error",re)):(te(re),se._writableState.errorEmitted=!0,se.emit("error",re),ce(se,ie))}function K(se){se.writing=!1,se.writecb=null,se.length-=se.writelen,se.writelen=0}function J(se,ie){var Q=se._writableState,re=Q.sync,te=Q.writecb;if(typeof te!="function")throw new w;if(K(Q),ie)Z(se,Q,re,ie,te);else{var V=q(Q)||se.destroyed;!V&&!Q.corked&&!Q.bufferProcessing&&Q.bufferedRequest&&W(se,Q),re?b.nextTick(D,se,Q,V,te):D(se,Q,V,te)}}function D(se,ie,Q,re){Q||I(se,ie),ie.pendingcb--,re(),ce(se,ie)}function I(se,ie){ie.length===0&&ie.needDrain&&(ie.needDrain=!1,se.emit("drain"))}function W(se,ie){ie.bufferProcessing=!0;var Q=ie.bufferedRequest;if(se._writev&&Q&&Q.next){var re=ie.bufferedRequestCount,te=new Array(re),V=ie.corkedRequestsFree;V.entry=Q;for(var z=0,B=!0;Q;)te[z]=Q,Q.isBuf||(B=!1),Q=Q.next,z+=1;te.allBuffers=B,H(se,ie,!0,ie.length,te,"",V.finish),ie.pendingcb++,ie.lastBufferedRequest=null,V.next?(ie.corkedRequestsFree=V.next,V.next=null):ie.corkedRequestsFree=new n(ie),ie.bufferedRequestCount=0}else{for(;Q;){var ee=Q.chunk,Y=Q.encoding,L=Q.callback,P=ie.objectMode?1:ee.length;if(H(se,ie,!1,P,ee,Y,L),Q=Q.next,ie.bufferedRequestCount--,ie.writing)break}Q===null&&(ie.lastBufferedRequest=null)}ie.bufferedRequest=Q,ie.bufferProcessing=!1}j.prototype._write=function(se,ie,Q){Q(new _("_write()"))},j.prototype._writev=null,j.prototype.end=function(se,ie,Q){var re=this._writableState;return typeof se=="function"?(Q=se,se=null,ie=null):typeof ie=="function"&&(Q=ie,ie=null),se!=null&&this.write(se,ie),re.corked&&(re.corked=1,this.uncork()),re.ending||fe(this,re,Q),this},Object.defineProperty(j.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function q(se){return se.ending&&se.length===0&&se.bufferedRequest===null&&!se.finished&&!se.writing}function ne(se,ie){se._final(function(Q){ie.pendingcb--,Q&&se.emit("error",Q),ie.prefinished=!0,se.emit("prefinish"),ce(se,ie)})}function le(se,ie){!ie.prefinished&&!ie.finalCalled&&(typeof se._final=="function"&&!ie.destroyed?(ie.pendingcb++,ie.finalCalled=!0,b.nextTick(ne,se,ie)):(ie.prefinished=!0,se.emit("prefinish")))}function ce(se,ie){var Q=q(ie);return Q&&(le(se,ie),ie.pendingcb===0&&(ie.finished=!0,se.emit("finish"))),Q}function fe(se,ie,Q){ie.ending=!0,ce(se,ie),Q&&(ie.finished?b.nextTick(Q):se.once("finish",Q)),ie.ended=!0,se.writable=!1}function he(se,ie,Q){var re=se.entry;for(se.entry=null;re;){var te=re.callback;ie.pendingcb--,te(Q),re=re.next}ie.corkedRequestsFree.next=se}Object.defineProperty(j.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(ie){this._writableState&&(this._writableState.destroyed=ie)}}),j.prototype.destroy=s.destroy,j.prototype._undestroy=s.undestroy,j.prototype._destroy=function(se,ie){ie(se)}}).call(this,m("_process"),typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{"../errors":160,"./_stream_duplex":162,"./internal/streams/destroy":169,"./internal/streams/state":172,"./internal/streams/stream":173,_process:133,buffer:48,inherits:75,"util-deprecate":183}],167:[function(m,x,g){(function(b){var f;function n(C,E,k){return E in C?Object.defineProperty(C,E,{value:k,enumerable:!0,configurable:!0,writable:!0}):C[E]=k,C}var o=m("./end-of-stream"),a=Symbol("lastResolve"),t=Symbol("lastReject"),i=Symbol("error"),r=Symbol("ended"),e=Symbol("lastPromise"),l=Symbol("handlePromise"),s=Symbol("stream");function c(C,E){return{value:C,done:E}}function u(C){var E=C[a];if(E!==null){var k=C[s].read();k!==null&&(C[e]=null,C[a]=null,C[t]=null,E(c(k,!1)))}}function h(C){b.nextTick(u,C)}function p(C,E){return function(k,O){C.then(function(){if(E[r]){k(c(void 0,!0));return}E[l](k,O)},O)}}var _=Object.getPrototypeOf(function(){}),w=Object.setPrototypeOf((f={get stream(){return this[s]},next:function(){var E=this,k=this[i];if(k!==null)return Promise.reject(k);if(this[r])return Promise.resolve(c(void 0,!0));if(this[s].destroyed)return new Promise(function(M,j){b.nextTick(function(){E[i]?j(E[i]):M(c(void 0,!0))})});var O=this[e],U;if(O)U=new Promise(p(O,this));else{var F=this[s].read();if(F!==null)return Promise.resolve(c(F,!1));U=new Promise(this[l])}return this[e]=U,U}},n(f,Symbol.asyncIterator,function(){return this}),n(f,"return",function(){var E=this;return new Promise(function(k,O){E[s].destroy(null,function(U){if(U){O(U);return}k(c(void 0,!0))})})}),f),_),S=function(E){var k,O=Object.create(w,(k={},n(k,s,{value:E,writable:!0}),n(k,a,{value:null,writable:!0}),n(k,t,{value:null,writable:!0}),n(k,i,{value:null,writable:!0}),n(k,r,{value:E._readableState.endEmitted,writable:!0}),n(k,l,{value:function(F,M){var j=O[s].read();j?(O[e]=null,O[a]=null,O[t]=null,F(c(j,!1))):(O[a]=F,O[t]=M)},writable:!0}),k));return O[e]=null,o(E,function(U){if(U&&U.code!=="ERR_STREAM_PREMATURE_CLOSE"){var F=O[t];F!==null&&(O[e]=null,O[a]=null,O[t]=null,F(U)),O[i]=U;return}var M=O[a];M!==null&&(O[e]=null,O[a]=null,O[t]=null,M(c(void 0,!0))),O[r]=!0}),E.on("readable",h.bind(null,O)),O};x.exports=S}).call(this,m("_process"))},{"./end-of-stream":170,_process:133}],168:[function(m,x,g){function b(e){for(var l=1;l<arguments.length;l++){var s=arguments[l]!=null?arguments[l]:{},c=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(s).filter(function(u){return Object.getOwnPropertyDescriptor(s,u).enumerable}))),c.forEach(function(u){f(e,u,s[u])})}return e}function f(e,l,s){return l in e?Object.defineProperty(e,l,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[l]=s,e}var n=m("buffer"),o=n.Buffer,a=m("util"),t=a.inspect,i=t&&t.custom||"inspect";function r(e,l,s){o.prototype.copy.call(e,l,s)}x.exports=function(){function e(){this.head=null,this.tail=null,this.length=0}var l=e.prototype;return l.push=function(c){var u={data:c,next:null};this.length>0?this.tail.next=u:this.head=u,this.tail=u,++this.length},l.unshift=function(c){var u={data:c,next:this.head};this.length===0&&(this.tail=u),this.head=u,++this.length},l.shift=function(){if(this.length!==0){var c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}},l.clear=function(){this.head=this.tail=null,this.length=0},l.join=function(c){if(this.length===0)return"";for(var u=this.head,h=""+u.data;u=u.next;)h+=c+u.data;return h},l.concat=function(c){if(this.length===0)return o.alloc(0);for(var u=o.allocUnsafe(c>>>0),h=this.head,p=0;h;)r(h.data,u,p),p+=h.data.length,h=h.next;return u},l.consume=function(c,u){var h;return c<this.head.data.length?(h=this.head.data.slice(0,c),this.head.data=this.head.data.slice(c)):c===this.head.data.length?h=this.shift():h=u?this._getString(c):this._getBuffer(c),h},l.first=function(){return this.head.data},l._getString=function(c){var u=this.head,h=1,p=u.data;for(c-=p.length;u=u.next;){var _=u.data,w=c>_.length?_.length:c;if(w===_.length?p+=_:p+=_.slice(0,c),c-=w,c===0){w===_.length?(++h,u.next?this.head=u.next:this.head=this.tail=null):(this.head=u,u.data=_.slice(w));break}++h}return this.length-=h,p},l._getBuffer=function(c){var u=o.allocUnsafe(c),h=this.head,p=1;for(h.data.copy(u),c-=h.data.length;h=h.next;){var _=h.data,w=c>_.length?_.length:c;if(_.copy(u,u.length-c,0,w),c-=w,c===0){w===_.length?(++p,h.next?this.head=h.next:this.head=this.tail=null):(this.head=h,h.data=_.slice(w));break}++p}return this.length-=p,u},l[i]=function(s,c){return t(this,b({},c,{depth:0,customInspect:!1}))},e}()},{buffer:48,util:33}],169:[function(m,x,g){(function(b){function f(i,r){var e=this,l=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return l||s?(r?r(i):i&&(!this._writableState||!this._writableState.errorEmitted)&&b.nextTick(t,this,i),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(c){!r&&c?(b.nextTick(n,e,c),e._writableState&&(e._writableState.errorEmitted=!0)):r?(b.nextTick(o,e),r(c)):b.nextTick(o,e)}),this)}function n(i,r){t(i,r),o(i)}function o(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function t(i,r){i.emit("error",r)}x.exports={destroy:f,undestroy:a}}).call(this,m("_process"))},{_process:133}],170:[function(m,x,g){var b=m("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function f(t){var i=!1;return function(){if(!i){i=!0;for(var r=arguments.length,e=new Array(r),l=0;l<r;l++)e[l]=arguments[l];t.apply(this,e)}}}function n(){}function o(t){return t.setHeader&&typeof t.abort=="function"}function a(t,i,r){if(typeof i=="function")return a(t,null,i);i||(i={}),r=f(r||n);var e=i.readable||i.readable!==!1&&t.readable,l=i.writable||i.writable!==!1&&t.writable,s=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){l=!1,c=!0,e||r.call(t)},h=t._readableState&&t._readableState.endEmitted,p=function(){e=!1,h=!0,l||r.call(t)},_=function(E){r.call(t,E)},w=function(){var E;if(e&&!h)return(!t._readableState||!t._readableState.ended)&&(E=new b),r.call(t,E);if(l&&!c)return(!t._writableState||!t._writableState.ended)&&(E=new b),r.call(t,E)},S=function(){t.req.on("finish",u)};return o(t)?(t.on("complete",u),t.on("abort",w),t.req?S():t.on("request",S)):l&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",p),t.on("finish",u),i.error!==!1&&t.on("error",_),t.on("close",w),function(){t.removeListener("complete",u),t.removeListener("abort",w),t.removeListener("request",S),t.req&&t.req.removeListener("finish",u),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",u),t.removeListener("end",p),t.removeListener("error",_),t.removeListener("close",w)}}x.exports=a},{"../../../errors":160}],171:[function(m,x,g){var b;function f(u){var h=!1;return function(){h||(h=!0,u.apply(void 0,arguments))}}var n=m("../../../errors").codes,o=n.ERR_MISSING_ARGS,a=n.ERR_STREAM_DESTROYED;function t(u){if(u)throw u}function i(u){return u.setHeader&&typeof u.abort=="function"}function r(u,h,p,_){_=f(_);var w=!1;u.on("close",function(){w=!0}),b===void 0&&(b=m("./end-of-stream")),b(u,{readable:h,writable:p},function(C){if(C)return _(C);w=!0,_()});var S=!1;return function(C){if(!w&&!S){if(S=!0,i(u))return u.abort();if(typeof u.destroy=="function")return u.destroy();_(C||new a("pipe"))}}}function e(u){u()}function l(u,h){return u.pipe(h)}function s(u){return!u.length||typeof u[u.length-1]!="function"?t:u.pop()}function c(){for(var u=arguments.length,h=new Array(u),p=0;p<u;p++)h[p]=arguments[p];var _=s(h);if(Array.isArray(h[0])&&(h=h[0]),h.length<2)throw new o("streams");var w,S=h.map(function(C,E){var k=E<h.length-1,O=E>0;return r(C,k,O,function(U){w||(w=U),U&&S.forEach(e),!k&&(S.forEach(e),_(w))})});return h.reduce(l)}x.exports=c},{"../../../errors":160,"./end-of-stream":170}],172:[function(m,x,g){var b=m("../../../errors").codes.ERR_INVALID_OPT_VALUE;function f(o,a,t){return o.highWaterMark!=null?o.highWaterMark:a?o[t]:null}function n(o,a,t,i){var r=f(a,i,t);if(r!=null){if(!(isFinite(r)&&Math.floor(r)===r)||r<0){var e=i?t:"highWaterMark";throw new b(e,r)}return Math.floor(r)}return o.objectMode?16:16*1024}x.exports={getHighWaterMark:n}},{"../../../errors":160}],173:[function(m,x,g){arguments[4][146][0].apply(g,arguments)},{dup:146,events:52}],174:[function(m,x,g){g=x.exports=m("./lib/_stream_readable.js"),g.Stream=g,g.Readable=g,g.Writable=m("./lib/_stream_writable.js"),g.Duplex=m("./lib/_stream_duplex.js"),g.Transform=m("./lib/_stream_transform.js"),g.PassThrough=m("./lib/_stream_passthrough.js"),g.finished=m("./lib/internal/streams/end-of-stream.js"),g.pipeline=m("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":162,"./lib/_stream_passthrough.js":163,"./lib/_stream_readable.js":164,"./lib/_stream_transform.js":165,"./lib/_stream_writable.js":166,"./lib/internal/streams/end-of-stream.js":170,"./lib/internal/streams/pipeline.js":171}],175:[function(m,x,g){arguments[4][148][0].apply(g,arguments)},{dup:148,"safe-buffer":154}],176:[function(m,x,g){(function(b,f){var n=m("process/browser.js").nextTick,o=Function.prototype.apply,a=Array.prototype.slice,t={},i=0;g.setTimeout=function(){return new r(o.call(setTimeout,y,arguments),clearTimeout)},g.setInterval=function(){return new r(o.call(setInterval,y,arguments),clearInterval)},g.clearTimeout=g.clearInterval=function(e){e.close()};function r(e,l){this._id=e,this._clearFn=l}r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(y,this._id)},g.enroll=function(e,l){clearTimeout(e._idleTimeoutId),e._idleTimeout=l},g.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},g._unrefActive=g.active=function(e){clearTimeout(e._idleTimeoutId);var l=e._idleTimeout;l>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},l))},g.setImmediate=typeof b=="function"?b:function(e){var l=i++,s=arguments.length<2?!1:a.call(arguments,1);return t[l]=!0,n(function(){t[l]&&(s?e.apply(null,s):e.call(null),g.clearImmediate(l))}),l},g.clearImmediate=typeof f=="function"?f:function(e){delete t[e]}}).call(this,m("timers").setImmediate,m("timers").clearImmediate)},{"process/browser.js":133,timers:176}],177:[function(m,x,g){(function(b){Object.defineProperty(g,"__esModule",{value:!0});var f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R};g.clone=i,g.addLast=l,g.addFirst=s,g.removeLast=c,g.removeFirst=u,g.insert=h,g.removeAt=p,g.replaceAt=_,g.getIn=w,g.set=S,g.setIn=E,g.update=k,g.updateIn=O,g.merge=U,g.mergeDeep=F,g.mergeIn=M,g.omit=j,g.addDefaults=G;/*!
 * Timm
 *
 * Immutability helpers with fast reads and acceptable writes.
 *
 * @copyright Guillermo Grau Panea 2016
 * @license MIT
 */var n="INVALID_ARGS";function o(R){throw new Error(R)}function a(R){var A=Object.keys(R);return Object.getOwnPropertySymbols?A.concat(Object.getOwnPropertySymbols(R)):A}var t={}.hasOwnProperty;function i(R){if(Array.isArray(R))return R.slice();for(var A=a(R),H={},Z=0;Z<A.length;Z++){var K=A[Z];H[K]=R[K]}return H}function r(R,A,H){var Z=H;Z==null&&o(n);for(var K=!1,J=arguments.length,D=Array(J>3?J-3:0),I=3;I<J;I++)D[I-3]=arguments[I];for(var W=0;W<D.length;W++){var q=D[W];if(q!=null){var ne=a(q);if(ne.length)for(var le=0;le<=ne.length;le++){var ce=ne[le];if(!(R&&Z[ce]!==void 0)){var fe=q[ce];A&&e(Z[ce])&&e(fe)&&(fe=r(R,A,Z[ce],fe)),!(fe===void 0||fe===Z[ce])&&(K||(K=!0,Z=i(Z)),Z[ce]=fe)}}}}return Z}function e(R){var A=typeof R>"u"?"undefined":f(R);return R!=null&&A==="object"}function l(R,A){return Array.isArray(A)?R.concat(A):R.concat([A])}function s(R,A){return Array.isArray(A)?A.concat(R):[A].concat(R)}function c(R){return R.length?R.slice(0,R.length-1):R}function u(R){return R.length?R.slice(1):R}function h(R,A,H){return R.slice(0,A).concat(Array.isArray(H)?H:[H]).concat(R.slice(A))}function p(R,A){return A>=R.length||A<0?R:R.slice(0,A).concat(R.slice(A+1))}function _(R,A,H){if(R[A]===H)return R;for(var Z=R.length,K=Array(Z),J=0;J<Z;J++)K[J]=R[J];return K[A]=H,K}function w(R,A){if(!Array.isArray(A)&&o(n),R!=null){for(var H=R,Z=0;Z<A.length;Z++){var K=A[Z];if(H=H!=null?H[K]:void 0,H===void 0)return H}return H}}function S(R,A,H){var Z=typeof A=="number"?[]:{},K=R==null?Z:R;if(K[A]===H)return K;var J=i(K);return J[A]=H,J}function C(R,A,H,Z){var K=void 0,J=A[Z];if(Z===A.length-1)K=H;else{var D=e(R)&&e(R[J])?R[J]:typeof A[Z+1]=="number"?[]:{};K=C(D,A,H,Z+1)}return S(R,J,K)}function E(R,A,H){return A.length?C(R,A,H,0):H}function k(R,A,H){var Z=R==null?void 0:R[A],K=H(Z);return S(R,A,K)}function O(R,A,H){var Z=w(R,A),K=H(Z);return E(R,A,K)}function U(R,A,H,Z,K,J){for(var D=arguments.length,I=Array(D>6?D-6:0),W=6;W<D;W++)I[W-6]=arguments[W];return I.length?r.call.apply(r,[null,!1,!1,R,A,H,Z,K,J].concat(I)):r(!1,!1,R,A,H,Z,K,J)}function F(R,A,H,Z,K,J){for(var D=arguments.length,I=Array(D>6?D-6:0),W=6;W<D;W++)I[W-6]=arguments[W];return I.length?r.call.apply(r,[null,!1,!0,R,A,H,Z,K,J].concat(I)):r(!1,!0,R,A,H,Z,K,J)}function M(R,A,H,Z,K,J,D){var I=w(R,A);I==null&&(I={});for(var W=void 0,q=arguments.length,ne=Array(q>7?q-7:0),le=7;le<q;le++)ne[le-7]=arguments[le];return ne.length?W=r.call.apply(r,[null,!1,!1,I,H,Z,K,J,D].concat(ne)):W=r(!1,!1,I,H,Z,K,J,D),E(R,A,W)}function j(R,A){for(var H=Array.isArray(A)?A:[A],Z=!1,K=0;K<H.length;K++)if(t.call(R,H[K])){Z=!0;break}if(!Z)return R;for(var J={},D=a(R),I=0;I<D.length;I++){var W=D[I];H.indexOf(W)>=0||(J[W]=R[W])}return J}function G(R,A,H,Z,K,J){for(var D=arguments.length,I=Array(D>6?D-6:0),W=6;W<D;W++)I[W-6]=arguments[W];return I.length?r.call.apply(r,[null,!0,!1,R,A,H,Z,K,J].concat(I)):r(!0,!1,R,A,H,Z,K,J)}var N={clone:i,addLast:l,addFirst:s,removeLast:c,removeFirst:u,insert:h,removeAt:p,replaceAt:_,getIn:w,set:S,setIn:E,update:k,updateIn:O,merge:U,mergeDeep:F,mergeIn:M,omit:j,addDefaults:G};g.default=N}).call(this,m("_process"))},{_process:133}],178:[function(m,x,g){(function(b){var f=/^\s+/,n=/\s+$/,o=0,a=b.round,t=b.min,i=b.max,r=b.random;function e(V,z){if(V=V||"",z=z||{},V instanceof e)return V;if(!(this instanceof e))return new e(V,z);var B=l(V);this._originalInput=V,this._r=B.r,this._g=B.g,this._b=B.b,this._a=B.a,this._roundA=a(100*this._a)/100,this._format=z.format||B.format,this._gradientType=z.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=B.ok,this._tc_id=o++}e.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var V=this.toRgb();return(V.r*299+V.g*587+V.b*114)/1e3},getLuminance:function(){var V=this.toRgb(),z,B,ee,Y,L,P;return z=V.r/255,B=V.g/255,ee=V.b/255,z<=.03928?Y=z/12.92:Y=b.pow((z+.055)/1.055,2.4),B<=.03928?L=B/12.92:L=b.pow((B+.055)/1.055,2.4),ee<=.03928?P=ee/12.92:P=b.pow((ee+.055)/1.055,2.4),.2126*Y+.7152*L+.0722*P},setAlpha:function(V){return this._a=D(V),this._roundA=a(100*this._a)/100,this},toHsv:function(){var V=h(this._r,this._g,this._b);return{h:V.h*360,s:V.s,v:V.v,a:this._a}},toHsvString:function(){var V=h(this._r,this._g,this._b),z=a(V.h*360),B=a(V.s*100),ee=a(V.v*100);return this._a==1?"hsv("+z+", "+B+"%, "+ee+"%)":"hsva("+z+", "+B+"%, "+ee+"%, "+this._roundA+")"},toHsl:function(){var V=c(this._r,this._g,this._b);return{h:V.h*360,s:V.s,l:V.l,a:this._a}},toHslString:function(){var V=c(this._r,this._g,this._b),z=a(V.h*360),B=a(V.s*100),ee=a(V.l*100);return this._a==1?"hsl("+z+", "+B+"%, "+ee+"%)":"hsla("+z+", "+B+"%, "+ee+"%, "+this._roundA+")"},toHex:function(V){return _(this._r,this._g,this._b,V)},toHexString:function(V){return"#"+this.toHex(V)},toHex8:function(V){return w(this._r,this._g,this._b,this._a,V)},toHex8String:function(V){return"#"+this.toHex8(V)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(I(this._r,255)*100)+"%",g:a(I(this._g,255)*100)+"%",b:a(I(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(I(this._r,255)*100)+"%, "+a(I(this._g,255)*100)+"%, "+a(I(this._b,255)*100)+"%)":"rgba("+a(I(this._r,255)*100)+"%, "+a(I(this._g,255)*100)+"%, "+a(I(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:K[_(this._r,this._g,this._b,!0)]||!1},toFilter:function(V){var z="#"+S(this._r,this._g,this._b,this._a),B=z,ee=this._gradientType?"GradientType = 1, ":"";if(V){var Y=e(V);B="#"+S(Y._r,Y._g,Y._b,Y._a)}return"progid:DXImageTransform.Microsoft.gradient("+ee+"startColorstr="+z+",endColorstr="+B+")"},toString:function(V){var z=!!V;V=V||this._format;var B=!1,ee=this._a<1&&this._a>=0,Y=!z&&ee&&(V==="hex"||V==="hex6"||V==="hex3"||V==="hex4"||V==="hex8"||V==="name");return Y?V==="name"&&this._a===0?this.toName():this.toRgbString():(V==="rgb"&&(B=this.toRgbString()),V==="prgb"&&(B=this.toPercentageRgbString()),(V==="hex"||V==="hex6")&&(B=this.toHexString()),V==="hex3"&&(B=this.toHexString(!0)),V==="hex4"&&(B=this.toHex8String(!0)),V==="hex8"&&(B=this.toHex8String()),V==="name"&&(B=this.toName()),V==="hsl"&&(B=this.toHslString()),V==="hsv"&&(B=this.toHsvString()),B||this.toHexString())},clone:function(){return e(this.toString())},_applyModification:function(V,z){var B=V.apply(null,[this].concat([].slice.call(z)));return this._r=B._r,this._g=B._g,this._b=B._b,this.setAlpha(B._a),this},lighten:function(){return this._applyModification(O,arguments)},brighten:function(){return this._applyModification(U,arguments)},darken:function(){return this._applyModification(F,arguments)},desaturate:function(){return this._applyModification(C,arguments)},saturate:function(){return this._applyModification(E,arguments)},greyscale:function(){return this._applyModification(k,arguments)},spin:function(){return this._applyModification(M,arguments)},_applyCombination:function(V,z){return V.apply(null,[this].concat([].slice.call(z)))},analogous:function(){return this._applyCombination(A,arguments)},complement:function(){return this._applyCombination(j,arguments)},monochromatic:function(){return this._applyCombination(H,arguments)},splitcomplement:function(){return this._applyCombination(R,arguments)},triad:function(){return this._applyCombination(G,arguments)},tetrad:function(){return this._applyCombination(N,arguments)}},e.fromRatio=function(V,z){if(typeof V=="object"){var B={};for(var ee in V)V.hasOwnProperty(ee)&&(ee==="a"?B[ee]=V[ee]:B[ee]=fe(V[ee]));V=B}return e(V,z)};function l(V){var z={r:0,g:0,b:0},B=1,ee=null,Y=null,L=null,P=!1,ae=!1;return typeof V=="string"&&(V=re(V)),typeof V=="object"&&(Q(V.r)&&Q(V.g)&&Q(V.b)?(z=s(V.r,V.g,V.b),P=!0,ae=String(V.r).substr(-1)==="%"?"prgb":"rgb"):Q(V.h)&&Q(V.s)&&Q(V.v)?(ee=fe(V.s),Y=fe(V.v),z=p(V.h,ee,Y),P=!0,ae="hsv"):Q(V.h)&&Q(V.s)&&Q(V.l)&&(ee=fe(V.s),L=fe(V.l),z=u(V.h,ee,L),P=!0,ae="hsl"),V.hasOwnProperty("a")&&(B=V.a)),B=D(B),{ok:P,format:V.format||ae,r:t(255,i(z.r,0)),g:t(255,i(z.g,0)),b:t(255,i(z.b,0)),a:B}}function s(V,z,B){return{r:I(V,255)*255,g:I(z,255)*255,b:I(B,255)*255}}function c(V,z,B){V=I(V,255),z=I(z,255),B=I(B,255);var ee=i(V,z,B),Y=t(V,z,B),L,P,ae=(ee+Y)/2;if(ee==Y)L=P=0;else{var ue=ee-Y;switch(P=ae>.5?ue/(2-ee-Y):ue/(ee+Y),ee){case V:L=(z-B)/ue+(z<B?6:0);break;case z:L=(B-V)/ue+2;break;case B:L=(V-z)/ue+4;break}L/=6}return{h:L,s:P,l:ae}}function u(V,z,B){var ee,Y,L;V=I(V,360),z=I(z,100),B=I(B,100);function P(ve,_e,Te){return Te<0&&(Te+=1),Te>1&&(Te-=1),Te<1/6?ve+(_e-ve)*6*Te:Te<1/2?_e:Te<2/3?ve+(_e-ve)*(2/3-Te)*6:ve}if(z===0)ee=Y=L=B;else{var ae=B<.5?B*(1+z):B+z-B*z,ue=2*B-ae;ee=P(ue,ae,V+1/3),Y=P(ue,ae,V),L=P(ue,ae,V-1/3)}return{r:ee*255,g:Y*255,b:L*255}}function h(V,z,B){V=I(V,255),z=I(z,255),B=I(B,255);var ee=i(V,z,B),Y=t(V,z,B),L,P,ae=ee,ue=ee-Y;if(P=ee===0?0:ue/ee,ee==Y)L=0;else{switch(ee){case V:L=(z-B)/ue+(z<B?6:0);break;case z:L=(B-V)/ue+2;break;case B:L=(V-z)/ue+4;break}L/=6}return{h:L,s:P,v:ae}}function p(V,z,B){V=I(V,360)*6,z=I(z,100),B=I(B,100);var ee=b.floor(V),Y=V-ee,L=B*(1-z),P=B*(1-Y*z),ae=B*(1-(1-Y)*z),ue=ee%6,ve=[B,P,L,L,ae,B][ue],_e=[ae,B,B,P,L,L][ue],Te=[L,L,ae,B,B,P][ue];return{r:ve*255,g:_e*255,b:Te*255}}function _(V,z,B,ee){var Y=[ce(a(V).toString(16)),ce(a(z).toString(16)),ce(a(B).toString(16))];return ee&&Y[0].charAt(0)==Y[0].charAt(1)&&Y[1].charAt(0)==Y[1].charAt(1)&&Y[2].charAt(0)==Y[2].charAt(1)?Y[0].charAt(0)+Y[1].charAt(0)+Y[2].charAt(0):Y.join("")}function w(V,z,B,ee,Y){var L=[ce(a(V).toString(16)),ce(a(z).toString(16)),ce(a(B).toString(16)),ce(he(ee))];return Y&&L[0].charAt(0)==L[0].charAt(1)&&L[1].charAt(0)==L[1].charAt(1)&&L[2].charAt(0)==L[2].charAt(1)&&L[3].charAt(0)==L[3].charAt(1)?L[0].charAt(0)+L[1].charAt(0)+L[2].charAt(0)+L[3].charAt(0):L.join("")}function S(V,z,B,ee){var Y=[ce(he(ee)),ce(a(V).toString(16)),ce(a(z).toString(16)),ce(a(B).toString(16))];return Y.join("")}e.equals=function(V,z){return!V||!z?!1:e(V).toRgbString()==e(z).toRgbString()},e.random=function(){return e.fromRatio({r:r(),g:r(),b:r()})};function C(V,z){z=z===0?0:z||10;var B=e(V).toHsl();return B.s-=z/100,B.s=W(B.s),e(B)}function E(V,z){z=z===0?0:z||10;var B=e(V).toHsl();return B.s+=z/100,B.s=W(B.s),e(B)}function k(V){return e(V).desaturate(100)}function O(V,z){z=z===0?0:z||10;var B=e(V).toHsl();return B.l+=z/100,B.l=W(B.l),e(B)}function U(V,z){z=z===0?0:z||10;var B=e(V).toRgb();return B.r=i(0,t(255,B.r-a(255*-(z/100)))),B.g=i(0,t(255,B.g-a(255*-(z/100)))),B.b=i(0,t(255,B.b-a(255*-(z/100)))),e(B)}function F(V,z){z=z===0?0:z||10;var B=e(V).toHsl();return B.l-=z/100,B.l=W(B.l),e(B)}function M(V,z){var B=e(V).toHsl(),ee=(B.h+z)%360;return B.h=ee<0?360+ee:ee,e(B)}function j(V){var z=e(V).toHsl();return z.h=(z.h+180)%360,e(z)}function G(V){var z=e(V).toHsl(),B=z.h;return[e(V),e({h:(B+120)%360,s:z.s,l:z.l}),e({h:(B+240)%360,s:z.s,l:z.l})]}function N(V){var z=e(V).toHsl(),B=z.h;return[e(V),e({h:(B+90)%360,s:z.s,l:z.l}),e({h:(B+180)%360,s:z.s,l:z.l}),e({h:(B+270)%360,s:z.s,l:z.l})]}function R(V){var z=e(V).toHsl(),B=z.h;return[e(V),e({h:(B+72)%360,s:z.s,l:z.l}),e({h:(B+216)%360,s:z.s,l:z.l})]}function A(V,z,B){z=z||6,B=B||30;var ee=e(V).toHsl(),Y=360/B,L=[e(V)];for(ee.h=(ee.h-(Y*z>>1)+720)%360;--z;)ee.h=(ee.h+Y)%360,L.push(e(ee));return L}function H(V,z){z=z||6;for(var B=e(V).toHsv(),ee=B.h,Y=B.s,L=B.v,P=[],ae=1/z;z--;)P.push(e({h:ee,s:Y,v:L})),L=(L+ae)%1;return P}e.mix=function(V,z,B){B=B===0?0:B||50;var ee=e(V).toRgb(),Y=e(z).toRgb(),L=B/100,P={r:(Y.r-ee.r)*L+ee.r,g:(Y.g-ee.g)*L+ee.g,b:(Y.b-ee.b)*L+ee.b,a:(Y.a-ee.a)*L+ee.a};return e(P)},e.readability=function(V,z){var B=e(V),ee=e(z);return(b.max(B.getLuminance(),ee.getLuminance())+.05)/(b.min(B.getLuminance(),ee.getLuminance())+.05)},e.isReadable=function(V,z,B){var ee=e.readability(V,z),Y,L;switch(L=!1,Y=te(B),Y.level+Y.size){case"AAsmall":case"AAAlarge":L=ee>=4.5;break;case"AAlarge":L=ee>=3;break;case"AAAsmall":L=ee>=7;break}return L},e.mostReadable=function(V,z,B){var ee=null,Y=0,L,P,ae,ue;B=B||{},P=B.includeFallbackColors,ae=B.level,ue=B.size;for(var ve=0;ve<z.length;ve++)L=e.readability(V,z[ve]),L>Y&&(Y=L,ee=e(z[ve]));return e.isReadable(V,ee,{level:ae,size:ue})||!P?ee:(B.includeFallbackColors=!1,e.mostReadable(V,["#fff","#000"],B))};var Z=e.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},K=e.hexNames=J(Z);function J(V){var z={};for(var B in V)V.hasOwnProperty(B)&&(z[V[B]]=B);return z}function D(V){return V=parseFloat(V),(isNaN(V)||V<0||V>1)&&(V=1),V}function I(V,z){ne(V)&&(V="100%");var B=le(V);return V=t(z,i(0,parseFloat(V))),B&&(V=parseInt(V*z,10)/100),b.abs(V-z)<1e-6?1:V%z/parseFloat(z)}function W(V){return t(1,i(0,V))}function q(V){return parseInt(V,16)}function ne(V){return typeof V=="string"&&V.indexOf(".")!=-1&&parseFloat(V)===1}function le(V){return typeof V=="string"&&V.indexOf("%")!=-1}function ce(V){return V.length==1?"0"+V:""+V}function fe(V){return V<=1&&(V=V*100+"%"),V}function he(V){return b.round(parseFloat(V)*255).toString(16)}function se(V){return q(V)/255}var ie=function(){var V="[-\\+]?\\d+%?",z="[-\\+]?\\d*\\.\\d+%?",B="(?:"+z+")|(?:"+V+")",ee="[\\s|\\(]+("+B+")[,|\\s]+("+B+")[,|\\s]+("+B+")\\s*\\)?",Y="[\\s|\\(]+("+B+")[,|\\s]+("+B+")[,|\\s]+("+B+")[,|\\s]+("+B+")\\s*\\)?";return{CSS_UNIT:new RegExp(B),rgb:new RegExp("rgb"+ee),rgba:new RegExp("rgba"+Y),hsl:new RegExp("hsl"+ee),hsla:new RegExp("hsla"+Y),hsv:new RegExp("hsv"+ee),hsva:new RegExp("hsva"+Y),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Q(V){return!!ie.CSS_UNIT.exec(V)}function re(V){V=V.replace(f,"").replace(n,"").toLowerCase();var z=!1;if(Z[V])V=Z[V],z=!0;else if(V=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var B;return(B=ie.rgb.exec(V))?{r:B[1],g:B[2],b:B[3]}:(B=ie.rgba.exec(V))?{r:B[1],g:B[2],b:B[3],a:B[4]}:(B=ie.hsl.exec(V))?{h:B[1],s:B[2],l:B[3]}:(B=ie.hsla.exec(V))?{h:B[1],s:B[2],l:B[3],a:B[4]}:(B=ie.hsv.exec(V))?{h:B[1],s:B[2],v:B[3]}:(B=ie.hsva.exec(V))?{h:B[1],s:B[2],v:B[3],a:B[4]}:(B=ie.hex8.exec(V))?{r:q(B[1]),g:q(B[2]),b:q(B[3]),a:se(B[4]),format:z?"name":"hex8"}:(B=ie.hex6.exec(V))?{r:q(B[1]),g:q(B[2]),b:q(B[3]),format:z?"name":"hex"}:(B=ie.hex4.exec(V))?{r:q(B[1]+""+B[1]),g:q(B[2]+""+B[2]),b:q(B[3]+""+B[3]),a:se(B[4]+""+B[4]),format:z?"name":"hex8"}:(B=ie.hex3.exec(V))?{r:q(B[1]+""+B[1]),g:q(B[2]+""+B[2]),b:q(B[3]+""+B[3]),format:z?"name":"hex"}:!1}function te(V){var z,B;return V=V||{level:"AA",size:"small"},z=(V.level||"AA").toUpperCase(),B=(V.size||"small").toLowerCase(),z!=="AA"&&z!=="AAA"&&(z="AA"),B!=="small"&&B!=="large"&&(B="small"),{level:z,size:B}}typeof x<"u"&&x.exports?x.exports=e:y.tinycolor=e})(Math)},{}],179:[function(m,x,g){g=x.exports=b;function b(f){return f.replace(/^\s*|\s*$/g,"")}g.left=function(f){return f.replace(/^\s*/,"")},g.right=function(f){return f.replace(/\s*$/,"")}},{}],180:[function(m,x,g){var b=m("punycode"),f=m("./util");g.parse=C,g.resolve=k,g.resolveObject=O,g.format=E,g.Url=n;function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,t=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,i=["<",">",'"',"`"," ","\r","\n","	"],r=["{","}","|","\\","^","`"].concat(i),e=["'"].concat(r),l=["%","/","?",";","#"].concat(e),s=["/","?","#"],c=255,u=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},_={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=m("querystring");function C(U,F,M){if(U&&f.isObject(U)&&U instanceof n)return U;var j=new n;return j.parse(U,F,M),j}n.prototype.parse=function(U,F,M){if(!f.isString(U))throw new TypeError("Parameter 'url' must be a string, not "+typeof U);var j=U.indexOf("?"),G=j!==-1&&j<U.indexOf("#")?"?":"#",N=U.split(G),R=/\\/g;N[0]=N[0].replace(R,"/"),U=N.join(G);var A=U;if(A=A.trim(),!M&&U.split("#").length===1){var H=t.exec(A);if(H)return this.path=A,this.href=A,this.pathname=H[1],H[2]?(this.search=H[2],F?this.query=S.parse(this.search.substr(1)):this.query=this.search.substr(1)):F&&(this.search="",this.query={}),this}var Z=o.exec(A);if(Z){Z=Z[0];var K=Z.toLowerCase();this.protocol=K,A=A.substr(Z.length)}if(M||Z||A.match(/^\/\/[^@\/]+@[^@\/]+/)){var J=A.substr(0,2)==="//";J&&!(Z&&_[Z])&&(A=A.substr(2),this.slashes=!0)}if(!_[Z]&&(J||Z&&!w[Z])){for(var D=-1,I=0;I<s.length;I++){var W=A.indexOf(s[I]);W!==-1&&(D===-1||W<D)&&(D=W)}var q,ne;D===-1?ne=A.lastIndexOf("@"):ne=A.lastIndexOf("@",D),ne!==-1&&(q=A.slice(0,ne),A=A.slice(ne+1),this.auth=decodeURIComponent(q)),D=-1;for(var I=0;I<l.length;I++){var W=A.indexOf(l[I]);W!==-1&&(D===-1||W<D)&&(D=W)}D===-1&&(D=A.length),this.host=A.slice(0,D),A=A.slice(D),this.parseHost(),this.hostname=this.hostname||"";var le=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!le)for(var ce=this.hostname.split(/\./),I=0,fe=ce.length;I<fe;I++){var he=ce[I];if(he&&!he.match(u)){for(var se="",ie=0,Q=he.length;ie<Q;ie++)he.charCodeAt(ie)>127?se+="x":se+=he[ie];if(!se.match(u)){var re=ce.slice(0,I),te=ce.slice(I+1),V=he.match(h);V&&(re.push(V[1]),te.unshift(V[2])),te.length&&(A="/"+te.join(".")+A),this.hostname=re.join(".");break}}}this.hostname.length>c?this.hostname="":this.hostname=this.hostname.toLowerCase(),le||(this.hostname=b.toASCII(this.hostname));var z=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+z,this.href+=this.host,le&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),A[0]!=="/"&&(A="/"+A))}if(!p[K])for(var I=0,fe=e.length;I<fe;I++){var ee=e[I];if(A.indexOf(ee)!==-1){var Y=encodeURIComponent(ee);Y===ee&&(Y=escape(ee)),A=A.split(ee).join(Y)}}var L=A.indexOf("#");L!==-1&&(this.hash=A.substr(L),A=A.slice(0,L));var P=A.indexOf("?");if(P!==-1?(this.search=A.substr(P),this.query=A.substr(P+1),F&&(this.query=S.parse(this.query)),A=A.slice(0,P)):F&&(this.search="",this.query={}),A&&(this.pathname=A),w[K]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",ae=this.search||"";this.path=z+ae}return this.href=this.format(),this};function E(U){return f.isString(U)&&(U=C(U)),U instanceof n?U.format():n.prototype.format.call(U)}n.prototype.format=function(){var U=this.auth||"";U&&(U=encodeURIComponent(U),U=U.replace(/%3A/i,":"),U+="@");var F=this.protocol||"",M=this.pathname||"",j=this.hash||"",G=!1,N="";this.host?G=U+this.host:this.hostname&&(G=U+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(G+=":"+this.port)),this.query&&f.isObject(this.query)&&Object.keys(this.query).length&&(N=S.stringify(this.query));var R=this.search||N&&"?"+N||"";return F&&F.substr(-1)!==":"&&(F+=":"),this.slashes||(!F||w[F])&&G!==!1?(G="//"+(G||""),M&&M.charAt(0)!=="/"&&(M="/"+M)):G||(G=""),j&&j.charAt(0)!=="#"&&(j="#"+j),R&&R.charAt(0)!=="?"&&(R="?"+R),M=M.replace(/[?#]/g,function(A){return encodeURIComponent(A)}),R=R.replace("#","%23"),F+G+M+R+j};function k(U,F){return C(U,!1,!0).resolve(F)}n.prototype.resolve=function(U){return this.resolveObject(C(U,!1,!0)).format()};function O(U,F){return U?C(U,!1,!0).resolveObject(F):F}n.prototype.resolveObject=function(U){if(f.isString(U)){var F=new n;F.parse(U,!1,!0),U=F}for(var M=new n,j=Object.keys(this),G=0;G<j.length;G++){var N=j[G];M[N]=this[N]}if(M.hash=U.hash,U.href==="")return M.href=M.format(),M;if(U.slashes&&!U.protocol){for(var R=Object.keys(U),A=0;A<R.length;A++){var H=R[A];H!=="protocol"&&(M[H]=U[H])}return w[M.protocol]&&M.hostname&&!M.pathname&&(M.path=M.pathname="/"),M.href=M.format(),M}if(U.protocol&&U.protocol!==M.protocol){if(!w[U.protocol]){for(var Z=Object.keys(U),K=0;K<Z.length;K++){var J=Z[K];M[J]=U[J]}return M.href=M.format(),M}if(M.protocol=U.protocol,!U.host&&!_[U.protocol]){for(var fe=(U.pathname||"").split("/");fe.length&&!(U.host=fe.shift()););U.host||(U.host=""),U.hostname||(U.hostname=""),fe[0]!==""&&fe.unshift(""),fe.length<2&&fe.unshift(""),M.pathname=fe.join("/")}else M.pathname=U.pathname;if(M.search=U.search,M.query=U.query,M.host=U.host||"",M.auth=U.auth,M.hostname=U.hostname||U.host,M.port=U.port,M.pathname||M.search){var D=M.pathname||"",I=M.search||"";M.path=D+I}return M.slashes=M.slashes||U.slashes,M.href=M.format(),M}var W=M.pathname&&M.pathname.charAt(0)==="/",q=U.host||U.pathname&&U.pathname.charAt(0)==="/",ne=q||W||M.host&&U.pathname,le=ne,ce=M.pathname&&M.pathname.split("/")||[],fe=U.pathname&&U.pathname.split("/")||[],he=M.protocol&&!w[M.protocol];if(he&&(M.hostname="",M.port=null,M.host&&(ce[0]===""?ce[0]=M.host:ce.unshift(M.host)),M.host="",U.protocol&&(U.hostname=null,U.port=null,U.host&&(fe[0]===""?fe[0]=U.host:fe.unshift(U.host)),U.host=null),ne=ne&&(fe[0]===""||ce[0]==="")),q)M.host=U.host||U.host===""?U.host:M.host,M.hostname=U.hostname||U.hostname===""?U.hostname:M.hostname,M.search=U.search,M.query=U.query,ce=fe;else if(fe.length)ce||(ce=[]),ce.pop(),ce=ce.concat(fe),M.search=U.search,M.query=U.query;else if(!f.isNullOrUndefined(U.search)){if(he){M.hostname=M.host=ce.shift();var se=M.host&&M.host.indexOf("@")>0?M.host.split("@"):!1;se&&(M.auth=se.shift(),M.host=M.hostname=se.shift())}return M.search=U.search,M.query=U.query,(!f.isNull(M.pathname)||!f.isNull(M.search))&&(M.path=(M.pathname?M.pathname:"")+(M.search?M.search:"")),M.href=M.format(),M}if(!ce.length)return M.pathname=null,M.search?M.path="/"+M.search:M.path=null,M.href=M.format(),M;for(var ie=ce.slice(-1)[0],Q=(M.host||U.host||ce.length>1)&&(ie==="."||ie==="..")||ie==="",re=0,te=ce.length;te>=0;te--)ie=ce[te],ie==="."?ce.splice(te,1):ie===".."?(ce.splice(te,1),re++):re&&(ce.splice(te,1),re--);if(!ne&&!le)for(;re--;re)ce.unshift("..");ne&&ce[0]!==""&&(!ce[0]||ce[0].charAt(0)!=="/")&&ce.unshift(""),Q&&ce.join("/").substr(-1)!=="/"&&ce.push("");var V=ce[0]===""||ce[0]&&ce[0].charAt(0)==="/";if(he){M.hostname=M.host=V?"":ce.length?ce.shift():"";var se=M.host&&M.host.indexOf("@")>0?M.host.split("@"):!1;se&&(M.auth=se.shift(),M.host=M.hostname=se.shift())}return ne=ne||M.host&&ce.length,ne&&!V&&ce.unshift(""),ce.length?M.pathname=ce.join("/"):(M.pathname=null,M.path=null),(!f.isNull(M.pathname)||!f.isNull(M.search))&&(M.path=(M.pathname?M.pathname:"")+(M.search?M.search:"")),M.auth=U.auth||M.auth,M.slashes=M.slashes||U.slashes,M.href=M.format(),M},n.prototype.parseHost=function(){var U=this.host,F=a.exec(U);F&&(F=F[0],F!==":"&&(this.port=F.substr(1)),U=U.substr(0,U.length-F.length)),U&&(this.hostname=U)}},{"./util":181,punycode:134,querystring:137}],181:[function(m,x,g){x.exports={isString:function(b){return typeof b=="string"},isObject:function(b){return typeof b=="object"&&b!==null},isNull:function(b){return b===null},isNullOrUndefined:function(b){return b==null}}},{}],182:[function(m,x,g){(function(b){(function(){var f={};typeof x=="object"?x.exports=f:self.UTIF=f;var n;typeof m=="function"?n=m("pako"):n=self.pako;function o(){typeof b>"u"&&console.log.apply(console,arguments)}(function(a,t){(function(){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},r=function(){function l(s){this.message="JPEG error: "+s}return l.prototype=Error(),l.prototype.name="JpegError",l.constructor=l}(),e=function(){function l(s,c){this.message=s,this.g=c}return l.prototype=Error(),l.prototype.name="DNLMarkerError",l.constructor=l}();(function(){function l(){this.M=null,this.B=-1}function s(_,w){for(var S=0,C=[],E,k,O=16;0<O&&!_[O-1];)O--;C.push({children:[],index:0});var U=C[0],F;for(E=0;E<O;E++){for(k=0;k<_[E];k++){for(U=C.pop(),U.children[U.index]=w[S];0<U.index;)U=C.pop();for(U.index++,C.push(U);C.length<=E;)C.push(F={children:[],index:0}),U.children[U.index]=F.children,U=F;S++}E+1<O&&(C.push(F={children:[],index:0}),U.children[U.index]=F.children,U=F)}return C[0].children}function c(_,w,S,C,E,k,O,U,F){function M(){if(0<q)return q--,W>>q&1;if(W=_[w++],W===255){var L=_[w++];if(L){if(L===220&&J){w+=2;var P=_[w++]<<8|_[w++];if(0<P&&P!==S.g)throw new e("Found DNL marker (0xFFDC) while parsing scan data",P)}throw new r("unexpected marker "+(W<<8|L).toString(16))}}return q=7,W>>>7}function j(L){for(;;){if(L=L[M()],typeof L=="number")return L;if((typeof L>"u"?"undefined":i(L))!=="object")throw new r("invalid huffman sequence")}}function G(L){for(var P=0;0<L;)P=P<<1|M(),L--;return P}function N(L){if(L===1)return M()===1?1:-1;var P=G(L);return P>=1<<L-1?P:P+(-1<<L)+1}function R(L,P){var ae=j(L.D);for(ae=ae===0?0:N(ae),L.a[P]=L.m+=ae,ae=1;64>ae;){var ue=j(L.o),ve=ue&15;if(ue>>=4,ve===0){if(15>ue)break;ae+=16}else ae+=ue,L.a[P+p[ae]]=N(ve),ae++}}function A(L,P){var ae=j(L.D);ae=ae===0?0:N(ae)<<F,L.a[P]=L.m+=ae}function H(L,P){L.a[P]|=M()<<F}function Z(L,P){if(0<ne)ne--;else for(var ae=k;ae<=O;){var ue=j(L.o),ve=ue&15;if(ue>>=4,ve===0){if(15>ue){ne=G(ue)+(1<<ue)-1;break}ae+=16}else ae+=ue,L.a[P+p[ae]]=N(ve)*(1<<F),ae++}}function K(L,P){for(var ae=k,ue=0,ve;ae<=O;){ve=P+p[ae];var _e=0>L.a[ve]?-1:1;switch(le){case 0:if(ue=j(L.o),ve=ue&15,ue>>=4,ve===0)15>ue?(ne=G(ue)+(1<<ue),le=4):(ue=16,le=1);else{if(ve!==1)throw new r("invalid ACn encoding");ce=N(ve),le=ue?2:3}continue;case 1:case 2:L.a[ve]?L.a[ve]+=_e*(M()<<F):(ue--,ue===0&&(le=le===2?3:0));break;case 3:L.a[ve]?L.a[ve]+=_e*(M()<<F):(L.a[ve]=ce<<F,le=0);break;case 4:L.a[ve]&&(L.a[ve]+=_e*(M()<<F))}ae++}le===4&&(ne--,ne===0&&(le=0))}for(var J=9<arguments.length&&arguments[9]!==void 0?arguments[9]:!1,D=S.P,I=w,W=0,q=0,ne=0,le=0,ce,fe=C.length,he,se,ie,Q,re=S.S?k===0?U===0?A:H:U===0?Z:K:R,te=0,V=fe===1?C[0].c*C[0].l:D*S.O,z,B;te<V;){var ee=E?Math.min(V-te,E):V;for(he=0;he<fe;he++)C[he].m=0;if(ne=0,fe===1){var Y=C[0];for(Q=0;Q<ee;Q++)re(Y,64*((Y.c+1)*(te/Y.c|0)+te%Y.c)),te++}else for(Q=0;Q<ee;Q++){for(he=0;he<fe;he++)for(Y=C[he],z=Y.h,B=Y.j,se=0;se<B;se++)for(ie=0;ie<z;ie++)re(Y,64*((Y.c+1)*((te/D|0)*Y.j+se)+(te%D*Y.h+ie)));te++}if(q=0,(Y=h(_,w))&&Y.f&&((0,_util.warn)("decodeScan - unexpected MCU data, current marker is: "+Y.f),w=Y.offset),Y=Y&&Y.F,!Y||65280>=Y)throw new r("marker was not found");if(65488<=Y&&65495>=Y)w+=2;else break}return(Y=h(_,w))&&Y.f&&((0,_util.warn)("decodeScan - unexpected Scan data, current marker is: "+Y.f),w=Y.offset),w-I}function u(_,w){for(var S=w.c,C=w.l,E=new Int16Array(64),k=0;k<C;k++)for(var O=0;O<S;O++){var U=64*((w.c+1)*k+O),F=E,M=w.G,j=w.a;if(!M)throw new r("missing required Quantization Table.");for(var G=0;64>G;G+=8){var N=j[U+G],R=j[U+G+1],A=j[U+G+2],H=j[U+G+3],Z=j[U+G+4],K=j[U+G+5],J=j[U+G+6],D=j[U+G+7];if(N*=M[G],!(R|A|H|Z|K|J|D))N=5793*N+512>>10,F[G]=N,F[G+1]=N,F[G+2]=N,F[G+3]=N,F[G+4]=N,F[G+5]=N,F[G+6]=N,F[G+7]=N;else{R*=M[G+1],A*=M[G+2],H*=M[G+3],Z*=M[G+4],K*=M[G+5],J*=M[G+6],D*=M[G+7];var I=5793*N+128>>8,W=5793*Z+128>>8,q=A,ne=J;Z=2896*(R-D)+128>>8,D=2896*(R+D)+128>>8,H<<=4,K<<=4,I=I+W+1>>1,W=I-W,N=3784*q+1567*ne+128>>8,q=1567*q-3784*ne+128>>8,ne=N,Z=Z+K+1>>1,K=Z-K,D=D+H+1>>1,H=D-H,I=I+ne+1>>1,ne=I-ne,W=W+q+1>>1,q=W-q,N=2276*Z+3406*D+2048>>12,Z=3406*Z-2276*D+2048>>12,D=N,N=799*H+4017*K+2048>>12,H=4017*H-799*K+2048>>12,K=N,F[G]=I+D,F[G+7]=I-D,F[G+1]=W+K,F[G+6]=W-K,F[G+2]=q+H,F[G+5]=q-H,F[G+3]=ne+Z,F[G+4]=ne-Z}}for(M=0;8>M;++M)N=F[M],R=F[M+8],A=F[M+16],H=F[M+24],Z=F[M+32],K=F[M+40],J=F[M+48],D=F[M+56],R|A|H|Z|K|J|D?(I=5793*N+2048>>12,W=5793*Z+2048>>12,q=A,ne=J,Z=2896*(R-D)+2048>>12,D=2896*(R+D)+2048>>12,I=(I+W+1>>1)+4112,W=I-W,N=3784*q+1567*ne+2048>>12,q=1567*q-3784*ne+2048>>12,ne=N,Z=Z+K+1>>1,K=Z-K,D=D+H+1>>1,H=D-H,I=I+ne+1>>1,ne=I-ne,W=W+q+1>>1,q=W-q,N=2276*Z+3406*D+2048>>12,Z=3406*Z-2276*D+2048>>12,D=N,N=799*H+4017*K+2048>>12,H=4017*H-799*K+2048>>12,K=N,N=I+D,D=I-D,R=W+K,J=W-K,A=q+H,K=q-H,H=ne+Z,Z=ne-Z,N=16>N?0:4080<=N?255:N>>4,R=16>R?0:4080<=R?255:R>>4,A=16>A?0:4080<=A?255:A>>4,H=16>H?0:4080<=H?255:H>>4,Z=16>Z?0:4080<=Z?255:Z>>4,K=16>K?0:4080<=K?255:K>>4,J=16>J?0:4080<=J?255:J>>4,D=16>D?0:4080<=D?255:D>>4,j[U+M]=N,j[U+M+8]=R,j[U+M+16]=A,j[U+M+24]=H,j[U+M+32]=Z,j[U+M+40]=K,j[U+M+48]=J,j[U+M+56]=D):(N=5793*N+8192>>14,N=-2040>N?0:2024<=N?255:N+2056>>4,j[U+M]=N,j[U+M+8]=N,j[U+M+16]=N,j[U+M+24]=N,j[U+M+32]=N,j[U+M+40]=N,j[U+M+48]=N,j[U+M+56]=N)}return w.a}function h(_,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:w,C=_.length-1;if(S=S<w?S:w,w>=C)return null;var E=_[w]<<8|_[w+1];if(65472<=E&&65534>=E)return{f:null,F:E,offset:w};for(var k=_[S]<<8|_[S+1];!(65472<=k&&65534>=k);){if(++S>=C)return null;k=_[S]<<8|_[S+1]}return{f:E.toString(16),F:k,offset:S}}var p=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);l.prototype={parse:function(_){function w(){var q=_[O]<<8|_[O+1];return O+=2,q}function S(){var q=w();q=O+q-2;var ne=h(_,q,O);return ne&&ne.f&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+ne.f),q=ne.offset),q=_.subarray(O,q),O+=q.length,q}function C(q){for(var ne=Math.ceil(q.v/8/q.s),le=Math.ceil(q.g/8/q.u),ce=0;ce<q.b.length;ce++){I=q.b[ce];var fe=Math.ceil(Math.ceil(q.v/8)*I.h/q.s),he=Math.ceil(Math.ceil(q.g/8)*I.j/q.u);I.a=new Int16Array(64*le*I.j*(ne*I.h+1)),I.c=fe,I.l=he}q.P=ne,q.O=le}var E=(1<arguments.length&&arguments[1]!==void 0?arguments[1]:{}).N,k=E===void 0?null:E,O=0,U=null,F=0;E=[];var M=[],j=[],G=w();if(G!==65496)throw new r("SOI not found");for(G=w();G!==65497;){switch(G){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var N=S();G===65518&&N[0]===65&&N[1]===100&&N[2]===111&&N[3]===98&&N[4]===101&&(U={version:N[5]<<8|N[6],Y:N[7]<<8|N[8],Z:N[9]<<8|N[10],W:N[11]});break;case 65499:G=w()+O-2;for(var R;O<G;){var A=_[O++],H=new Uint16Array(64);if(A>>4)if(A>>4===1)for(N=0;64>N;N++)R=p[N],H[R]=w();else throw new r("DQT - invalid table spec");else for(N=0;64>N;N++)R=p[N],H[R]=_[O++];E[A&15]=H}break;case 65472:case 65473:case 65474:if(Z)throw new r("Only single frame JPEGs supported");w();var Z={};for(Z.X=G===65473,Z.S=G===65474,Z.precision=_[O++],G=w(),Z.g=k||G,Z.v=w(),Z.b=[],Z.C={},N=_[O++],G=H=A=0;G<N;G++){R=_[O];var K=_[O+1]>>4,J=_[O+1]&15;A<K&&(A=K),H<J&&(H=J),K=Z.b.push({h:K,j:J,T:_[O+2],G:null}),Z.C[R]=K-1,O+=3}Z.s=A,Z.u=H,C(Z);break;case 65476:for(R=w(),G=2;G<R;){for(A=_[O++],H=new Uint8Array(16),N=K=0;16>N;N++,O++)K+=H[N]=_[O];for(J=new Uint8Array(K),N=0;N<K;N++,O++)J[N]=_[O];G+=17+K,(A>>4?M:j)[A&15]=s(H,J)}break;case 65501:w();var D=w();break;case 65498:for(N=++F===1&&!k,w(),A=_[O++],R=[],G=0;G<A;G++){H=Z.C[_[O++]];var I=Z.b[H];H=_[O++],I.D=j[H>>4],I.o=M[H&15],R.push(I)}G=_[O++],A=_[O++],H=_[O++];try{var W=c(_,O,Z,R,D,G,A,H>>4,H&15,N);O+=W}catch(q){if(q instanceof e)return(0,_util.warn)('Attempting to re-parse JPEG image using "scanLines" parameter found in DNL marker (0xFFDC) segment.'),this.parse(_,{N:q.g});throw q}break;case 65500:O+=4;break;case 65535:_[O]!==255&&O--;break;default:if(_[O-3]===255&&192<=_[O-2]&&254>=_[O-2])O-=3;else if((N=h(_,O-2))&&N.f)(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+N.f),O=N.offset;else throw new r("unknown marker "+G.toString(16))}G=w()}for(this.width=Z.v,this.height=Z.g,this.A=U,this.b=[],G=0;G<Z.b.length;G++)I=Z.b[G],(D=E[I.T])&&(I.G=D),this.b.push({R:u(Z,I),U:I.h/Z.s,V:I.j/Z.u,c:I.c,l:I.l});this.i=this.b.length},L:function(_,w){var S=this.width/_,C=this.height/w,E,k,O=this.b.length,U=_*w*O,F=new Uint8ClampedArray(U),M=new Uint32Array(_);for(k=0;k<O;k++){var j=this.b[k],G=j.U*S,N=j.V*C,R=k,A=j.R,H=j.c+1<<3;for(E=0;E<_;E++)j=0|E*G,M[E]=(j&4294967288)<<3|j&7;for(G=0;G<w;G++)for(j=0|G*N,j=H*(j&4294967288)|(j&7)<<3,E=0;E<_;E++)F[R]=A[j+M[E]],R+=O}if(C=this.M)for(k=0;k<U;)for(S=j=0;j<O;j++,k++,S+=2)F[k]=(F[k]*C[S]>>8)+C[S+1];return F},w:function(){return this.A?!!this.A.W:this.i===3?this.B!==0:this.B===1},I:function(_){for(var w,S,C,E=0,k=_.length;E<k;E+=3)w=_[E],S=_[E+1],C=_[E+2],_[E]=w-179.456+1.402*C,_[E+1]=w+135.459-.344*S-.714*C,_[E+2]=w-226.816+1.772*S;return _},K:function(_){for(var w,S,C,E,k=0,O=0,U=_.length;O<U;O+=4)w=_[O],S=_[O+1],C=_[O+2],E=_[O+3],_[k++]=-122.67195406894+S*(-660635669420364e-19*S+.000437130475926232*C-54080610064599e-18*w+.00048449797120281*E-.154362151871126)+C*(-.000957964378445773*C+.000817076911346625*w-.00477271405408747*E+1.53380253221734)+w*(.000961250184130688*w-.00266257332283933*E+.48357088451265)+E*(-.000336197177618394*E+.484791561490776),_[k++]=107.268039397724+S*(219927104525741e-19*S-.000640992018297945*C+.000659397001245577*w+.000426105652938837*E-.176491792462875)+C*(-.000778269941513683*C+.00130872261408275*w+.000770482631801132*E-.151051492775562)+w*(.00126935368114843*w-.00265090189010898*E+.25802910206845)+E*(-.000318913117588328*E-.213742400323665),_[k++]=-20.810012546947+S*(-.000570115196973677*S-263409051004589e-19*C+.0020741088115012*w-.00288260236853442*E+.814272968359295)+C*(-153496057440975e-19*C-.000132689043961446*w+.000560833691242812*E-.195152027534049)+w*(.00174418132927582*w-.00255243321439347*E+.116935020465145)+E*(-.000343531996510555*E+.24165260232407);return _.subarray(0,k)},J:function(_){for(var w,S,C,E=0,k=_.length;E<k;E+=4)w=_[E],S=_[E+1],C=_[E+2],_[E]=434.456-w-1.402*C,_[E+1]=119.541-w+.344*S+.714*C,_[E+2]=481.816-w-1.772*S;return _},H:function(_){for(var w,S,C,E,k=0,O=1/255,U=0,F=_.length;U<F;U+=4)w=_[U]*O,S=_[U+1]*O,C=_[U+2]*O,E=_[U+3]*O,_[k++]=255+w*(-4.387332384609988*w+54.48615194189176*S+18.82290502165302*C+212.25662451639585*E-285.2331026137004)+S*(1.7149763477362134*S-5.6096736904047315*C-17.873870861415444*E-5.497006427196366)+C*(-2.5217340131683033*C-21.248923337353073*E+17.5119270841813)-E*(21.86122147463605*E+189.48180835922747),_[k++]=255+w*(8.841041422036149*w+60.118027045597366*S+6.871425592049007*C+31.159100130055922*E-79.2970844816548)+S*(-15.310361306967817*S+17.575251261109482*C+131.35250912493976*E-190.9453302588951)+C*(4.444339102852739*C+9.8632861493405*E-24.86741582555878)-E*(20.737325471181034*E+187.80453709719578),_[k++]=255+w*(.8842522430003296*w+8.078677503112928*S+30.89978309703729*C-.23883238689178934*E-14.183576799673286)+S*(10.49593273432072*S+63.02378494754052*C+50.606957656360734*E-112.23884253719248)+C*(.03296041114873217*C+115.60384449646641*E-193.58209356861505)-E*(22.33816807309886*E+180.12613974708367);return _.subarray(0,k)},getData:function(_,w,S){if(4<this.i)throw new r("Unsupported color mode");if(_=this.L(_,w),this.i===1&&S){S=_.length,w=new Uint8ClampedArray(3*S);for(var C=0,E=0;E<S;E++){var k=_[E];w[C++]=k,w[C++]=k,w[C++]=k}return w}if(this.i===3&&this.w())return this.I(_);if(this.i===4){if(this.w())return S?this.K(_):this.J(_);if(S)return this.H(_)}return _}},a.JpegDecoder=l})()})(),a.encodeImage=function(i,r,e,l){var s={t256:[r],t257:[e],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[e],t279:[r*e*4],t282:[1],t283:[1],t284:[1],t286:[0],t287:[0],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(l)for(var c in l)s[c]=l[c];for(var u=new Uint8Array(a.encode([s])),h=new Uint8Array(i),p=new Uint8Array(1e3+r*e*4),c=0;c<u.length;c++)p[c]=u[c];for(var c=0;c<h.length;c++)p[1e3+c]=h[c];return p.buffer},a.encode=function(i){var r=new Uint8Array(2e4),e=4,l=a._binBE;r[0]=77,r[1]=77,r[3]=42;var s=8;l.writeUint(r,e,s),e+=4;for(var c=0;c<i.length;c++){var u=a._writeIFD(l,r,s,i[c]);s=u[1],c<i.length-1&&l.writeUint(r,u[0],s)}return r.slice(0,s).buffer},a.decode=function(i){a.decode._decodeG3.allow2D=null;var r=new Uint8Array(i),e=0,l=a._binBE.readASCII(r,e,2);e+=2;var s=l=="II"?a._binLE:a._binBE;s.readUshort(r,e),e+=2;var c=s.readUint(r,e);e+=4;for(var u=[];;){var h=a._readIFD(s,r,c,u);if(c=s.readUint(r,h),c==0)break}return u},a.decodeImages=function(i,r){for(var e=new Uint8Array(i),l=a._binBE.readASCII(e,0,2),s=0;s<r.length;s++){var c=r[s];if(c.t256!=null){c.isLE=l=="II",c.width=c.t256[0],c.height=c.t257[0];var u=c.t259?c.t259[0]:1,h=c.t266?c.t266[0]:1;c.t284&&c.t284[0]==2&&o("PlanarConfiguration 2 should not be used!");var p=(c.t258?Math.min(32,c.t258[0]):1)*(c.t277?c.t277[0]:1),_=Math.ceil(c.width*p/8)*8,w=c.t273;w==null&&(w=c.t324);var S=c.t279;u==1&&w.length==1&&(S=[c.height*(_>>>3)]),S==null&&(S=c.t325);var C=new Uint8Array(c.height*(_>>>3)),E=0;if(c.t322!=null){for(var k=c.t322[0],O=c.t323[0],U=Math.floor((c.width+k-1)/k),F=Math.floor((c.height+O-1)/O),M=new Uint8Array(Math.ceil(k*O*p/8)|0),j=0;j<F;j++)for(var G=0;G<U;G++){for(var N=j*U+G,R=0;R<M.length;R++)M[R]=0;a.decode._decompress(c,e,w[N],S[N],u,M,0,h),u==6?C=M:a._copyTile(M,Math.ceil(k*p/8)|0,O,C,Math.ceil(c.width*p/8)|0,c.height,Math.ceil(G*k*p/8)|0,j*O)}E=C.length*8}else{var A=c.t278?c.t278[0]:c.height;A=Math.min(A,c.height);for(var N=0;N<w.length;N++)a.decode._decompress(c,e,w[N],S[N],u,C,Math.ceil(E/8)|0,h),E+=_*A;E=Math.min(E,C.length*8)}c.data=new Uint8Array(C.buffer,0,Math.ceil(E/8)|0)}}},a.decode._decompress=function(i,r,e,l,s,c,u,h){if(s==1)for(var p=0;p<l;p++)c[u+p]=r[e+p];else if(s==3)a.decode._decodeG3(r,e,l,c,u,i.width,h);else if(s==4)a.decode._decodeG4(r,e,l,c,u,i.width,h);else if(s==5)a.decode._decodeLZW(r,e,c,u);else if(s==6)a.decode._decodeOldJPEG(i,r,e,l,c,u);else if(s==7)a.decode._decodeNewJPEG(i,r,e,l,c,u);else if(s==8)for(var _=new Uint8Array(r.buffer,e,l),w=t.inflate(_),S=0;S<w.length;S++)c[u+S]=w[S];else s==32773?a.decode._decodePackBits(r,e,l,c,u):s==32809?a.decode._decodeThunder(r,e,l,c,u):o("Unknown compression",s);if(i.t317&&i.t317[0]==2)for(var C=i.t277?i.t277[0]:1,E=i.t278?i.t278[0]:i.height,k=i.width*C,O=0;O<E;O++){var U=u+O*k;if(C==3)for(var p=3;p<k;p+=3)c[U+p]=c[U+p]+c[U+p-3]&255,c[U+p+1]=c[U+p+1]+c[U+p-2]&255,c[U+p+2]=c[U+p+2]+c[U+p-1]&255;else for(var p=C;p<k;p++)c[U+p]=c[U+p]+c[U+p-C]&255}},a.decode._decodeNikon=function(i,r,h,l,s){var c,u,h;o(i.slice(r,r+100)),c=i[r],r++,u=i[r],r++,o(c.toString(16),u.toString(16),h)},a.decode._decodeNewJPEG=function(i,r,e,l,s,c){var u=i.t347,h=u?u.length:0,p=new Uint8Array(h+l);if(u){for(var _=216,w=217,S=0,C=0;C<h-1&&!(u[C]==255&&u[C+1]==w);C++)p[S++]=u[C];var E=r[e],k=r[e+1];(E!=255||k!=_)&&(p[S++]=E,p[S++]=k);for(var C=2;C<l;C++)p[S++]=r[e+C]}else for(var C=0;C<l;C++)p[C]=r[e+C];if(i.t262==32803){var O=i.t258[0],U=new LosslessJpegDecoder,F=U.decode(p),M=F.length;if(O==16)for(var C=0;C<M;C++)s[c++]=F[C]&255,s[c++]=F[C]>>>8;else if(O==12)for(var C=0;C<M;C+=2)s[c++]=F[C]>>>4,s[c++]=(F[C]<<4|F[C+1]>>>8)&255,s[c++]=F[C+1]&255;else throw new Error("unsupported bit depth "+O)}else{var j=new a.JpegDecoder;j.parse(p);for(var G=j.getData(j.width,j.height),C=0;C<G.length;C++)s[c+C]=G[C]}i.t262[0]==6&&(i.t262[0]=2)},a.decode._decodeOldJPEGInit=function(i,r,e,l){var s=216,c=219,u=196,h=221,p=192,_=218,w=0,S=0,C,E,k=!1,O,U,F,M=i.t513,j=M?M[0]:0,G=i.t514,N=G?G[0]:0,R=i.t324||i.t273||M,A=i.t530,H=0,Z=0,K=i.t277?i.t277[0]:1,J=i.t515;if(R&&(S=R[0],k=R.length>1),!k){if(r[e]==255&&r[e+1]==s)return{jpegOffset:e};if(M!=null&&(r[e+j]==255&&r[e+j+1]==s?w=e+j:o("JPEGInterchangeFormat does not point to SOI"),G==null?o("JPEGInterchangeFormatLength field is missing"):(j>=S||j+N<=S)&&o("JPEGInterchangeFormatLength field value is invalid"),w!=null))return{jpegOffset:w}}if(A!=null&&(H=A[0],Z=A[1]),M!=null&&G!=null)if(N>=2&&j+N<=S){for(r[e+j+N-2]==255&&r[e+j+N-1]==s?C=new Uint8Array(N-2):C=new Uint8Array(N),O=0;O<C.length;O++)C[O]=r[e+j+O];o("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else o("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(C==null){var D=0,I=[];I[D++]=255,I[D++]=s;var W=i.t519;if(W==null)throw new Error("JPEGQTables tag is missing");for(O=0;O<W.length;O++)for(I[D++]=255,I[D++]=c,I[D++]=0,I[D++]=67,I[D++]=O,U=0;U<64;U++)I[D++]=r[e+W[O]+U];for(F=0;F<2;F++){var q=i[F==0?"t520":"t521"];if(q==null)throw new Error((F==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(O=0;O<q.length;O++){I[D++]=255,I[D++]=u;var ne=19;for(U=0;U<16;U++)ne+=r[e+q[O]+U];for(I[D++]=ne>>>8,I[D++]=ne&255,I[D++]=O|F<<4,U=0;U<16;U++)I[D++]=r[e+q[O]+U];for(U=0;U<ne;U++)I[D++]=r[e+q[O]+16+U]}}if(I[D++]=255,I[D++]=p,I[D++]=0,I[D++]=8+3*K,I[D++]=8,I[D++]=i.height>>>8&255,I[D++]=i.height&255,I[D++]=i.width>>>8&255,I[D++]=i.width&255,I[D++]=K,K==1)I[D++]=1,I[D++]=17,I[D++]=0;else for(O=0;O<3;O++)I[D++]=O+1,I[D++]=O!=0?17:(H&15)<<4|Z&15,I[D++]=O;J!=null&&J[0]!=0&&(I[D++]=255,I[D++]=h,I[D++]=0,I[D++]=4,I[D++]=J[0]>>>8&255,I[D++]=J[0]&255),C=new Uint8Array(I)}var le=-1;for(O=0;O<C.length-1;){if(C[O]==255&&C[O+1]==p){le=O;break}O++}if(le==-1){var ce=new Uint8Array(C.length+10+3*K);ce.set(C);var fe=C.length;if(le=C.length,C=ce,C[fe++]=255,C[fe++]=p,C[fe++]=0,C[fe++]=8+3*K,C[fe++]=8,C[fe++]=i.height>>>8&255,C[fe++]=i.height&255,C[fe++]=i.width>>>8&255,C[fe++]=i.width&255,C[fe++]=K,K==1)C[fe++]=1,C[fe++]=17,C[fe++]=0;else for(O=0;O<3;O++)C[fe++]=O+1,C[fe++]=O!=0?17:(H&15)<<4|Z&15,C[fe++]=O}if(r[S]==255&&r[S+1]==_){var he=r[S+2]<<8|r[S+3];for(E=new Uint8Array(he+2),E[0]=r[S],E[1]=r[S+1],E[2]=r[S+2],E[3]=r[S+3],O=0;O<he-2;O++)E[O+4]=r[S+O+4]}else{E=new Uint8Array(2+6+2*K);var se=0;if(E[se++]=255,E[se++]=_,E[se++]=0,E[se++]=6+2*K,E[se++]=K,K==1)E[se++]=1,E[se++]=0;else for(O=0;O<3;O++)E[se++]=O+1,E[se++]=O<<4|O;E[se++]=0,E[se++]=63,E[se++]=0}return{jpegOffset:e,tables:C,sosMarker:E,sofPosition:le}},a.decode._decodeOldJPEG=function(i,r,e,l,s,c){var u,h,p,_,w=a.decode._decodeOldJPEGInit(i,r,e,l);if(w.jpegOffset!=null)for(h=e+l-w.jpegOffset,_=new Uint8Array(h),u=0;u<h;u++)_[u]=r[w.jpegOffset+u];else{for(p=w.tables.length,_=new Uint8Array(p+w.sosMarker.length+l+2),_.set(w.tables),_[w.sofPosition+5]=i.height>>>8&255,_[w.sofPosition+6]=i.height&255,_[w.sofPosition+7]=i.width>>>8&255,_[w.sofPosition+8]=i.width&255,(r[e]!=255||r[e+1]!=SOS)&&(_.set(w.sosMarker,bufoff),bufoff+=sosMarker.length),u=0;u<l;u++)_[bufoff++]=r[e+u];_[bufoff++]=255,_[bufoff++]=EOI}var S=new a.JpegDecoder;S.parse(_);for(var C=S.getData(S.width,S.height),u=0;u<C.length;u++)s[c+u]=C[u];i.t262[0]==6&&(i.t262[0]=2)},a.decode._decodePackBits=function(i,r,e,l,s){for(var c=new Int8Array(i.buffer),u=new Int8Array(l.buffer),h=r+e;r<h;){var p=c[r];if(r++,p>=0&&p<128)for(var _=0;_<p+1;_++)u[s]=c[r],s++,r++;if(p>=-127&&p<0){for(var _=0;_<-p+1;_++)u[s]=c[r],s++;r++}}},a.decode._decodeThunder=function(i,r,e,l,s){for(var c=[0,1,0,-1],u=[0,1,2,3,0,-3,-2,-1],h=r+e,p=s*2,_=0;r<h;){var w=i[r],S=w>>>6,C=w&63;if(r++,S==3&&(_=C&15,l[p>>>1]|=_<<4*(1-p&1),p++),S==0)for(var E=0;E<C;E++)l[p>>>1]|=_<<4*(1-p&1),p++;if(S==2)for(var E=0;E<2;E++){var k=C>>>3*(1-E)&7;k!=4&&(_+=u[k],l[p>>>1]|=_<<4*(1-p&1),p++)}if(S==1)for(var E=0;E<3;E++){var k=C>>>2*(2-E)&3;k!=2&&(_+=c[k],l[p>>>1]|=_<<4*(1-p&1),p++)}}},a.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},a.decode._lens=function(){var i=function(p,_,w,S){for(var C=0;C<_.length;C++)p[_[C]]=w+C*S},r="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",e="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",l="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",s="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",c="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";r=r.split(","),e=e.split(","),l=l.split(","),s=s.split(","),c=c.split(",");var u={},h={};return i(u,r,0,1),i(u,l,64,64),i(u,c,1792,64),i(h,e,0,1),i(h,s,64,64),i(h,c,1792,64),[u,h]}(),a.decode._decodeG4=function(i,r,e,l,s,c,u){for(var h=a.decode,p=r<<3,_=0,w="",S=[],C=[],E=0;E<c;E++)C.push(0);C=h._makeDiff(C);for(var k=0,O=0,U=0,F=0,M=0,j=0,G="",N=0,R=Math.ceil(c/8)*8;p>>>3<r+e;){U=h._findDiff(C,k+(k==0?0:1),1-M),F=h._findDiff(C,U,M);var A=0;if(u==1&&(A=i[p>>>3]>>>7-(p&7)&1),u==2&&(A=i[p>>>3]>>>(p&7)&1),p++,w+=A,G=="H"){if(h._lens[M][w]!=null){var H=h._lens[M][w];w="",_+=H,H<64&&(h._addNtimes(S,_,M),k+=_,M=1-M,_=0,N--,N==0&&(G=""))}}else w=="0001"&&(w="",h._addNtimes(S,F-k,M),k=F),w=="001"&&(w="",G="H",N=2),h._dmap[w]!=null&&(O=U+h._dmap[w],h._addNtimes(S,O-k,M),k=O,w="",M=1-M);S.length==c&&G==""&&(h._writeBits(S,l,s*8+j*R),M=0,j++,k=0,C=h._makeDiff(S),S=[])}},a.decode._findDiff=function(i,r,e){for(var l=0;l<i.length;l+=2)if(i[l]>=r&&i[l+1]==e)return i[l]},a.decode._makeDiff=function(i){var r=[];i[0]==1&&r.push(0,1);for(var e=1;e<i.length;e++)i[e-1]!=i[e]&&r.push(e,i[e]);return r.push(i.length,0,i.length,1),r},a.decode._decodeG3=function(i,r,e,l,s,c,u){for(var h=a.decode,p=r<<3,_=0,w="",S=[],C=[],E=0;E<c;E++)S.push(0);for(var k=0,O=0,U=0,F=0,M=0,j=-1,G="",N=0,R=!1,A=Math.ceil(c/8)*8;p>>>3<r+e;){U=h._findDiff(C,k+(k==0?0:1),1-M),F=h._findDiff(C,U,M);var H=0;if(u==1&&(H=i[p>>>3]>>>7-(p&7)&1),u==2&&(H=i[p>>>3]>>>(p&7)&1),p++,w+=H,R){if(h._lens[M][w]!=null){var Z=h._lens[M][w];w="",_+=Z,Z<64&&(h._addNtimes(S,_,M),M=1-M,_=0)}}else if(G=="H"){if(h._lens[M][w]!=null){var Z=h._lens[M][w];w="",_+=Z,Z<64&&(h._addNtimes(S,_,M),k+=_,M=1-M,_=0,N--,N==0&&(G=""))}}else w=="0001"&&(w="",h._addNtimes(S,F-k,M),k=F),w=="001"&&(w="",G="H",N=2),h._dmap[w]!=null&&(O=U+h._dmap[w],h._addNtimes(S,O-k,M),k=O,w="",M=1-M);w.endsWith("000000000001")&&(j>=0&&h._writeBits(S,l,s*8+j*A),u==1&&(R=(i[p>>>3]>>>7-(p&7)&1)==1),u==2&&(R=(i[p>>>3]>>>(p&7)&1)==1),p++,h._decodeG3.allow2D==null&&(h._decodeG3.allow2D=R),h._decodeG3.allow2D||(R=!0,p--),w="",M=0,j++,k=0,C=h._makeDiff(S),S=[])}S.length==c&&h._writeBits(S,l,s*8+j*A)},a.decode._addNtimes=function(i,r,e){for(var l=0;l<r;l++)i.push(e)},a.decode._writeBits=function(i,r,e){for(var l=0;l<i.length;l++)r[e+l>>>3]|=i[l]<<7-(e+l&7)},a.decode._decodeLZW=function(i,r,e,l){if(a.decode._lzwTab==null){for(var s=new Uint32Array(65535),c=new Uint16Array(65535),w=new Uint8Array(2e6),u=0;u<256;u++)w[u<<2]=u,s[u]=u<<2,c[u]=1;a.decode._lzwTab=[s,c,w]}for(var h=a.decode._copyData,p=a.decode._lzwTab[0],_=a.decode._lzwTab[1],w=a.decode._lzwTab[2],S=258,C=1032,E=9,k=r<<3,O=256,U=257,F=0,M=0,j=0;F=i[k>>>3]<<16|i[k+8>>>3]<<8|i[k+16>>>3],M=F>>24-(k&7)-E&(1<<E)-1,k+=E,M!=U;){if(M==O){if(E=9,S=258,C=1032,F=i[k>>>3]<<16|i[k+8>>>3]<<8|i[k+16>>>3],M=F>>24-(k&7)-E&(1<<E)-1,k+=E,M==U)break;e[l]=M,l++}else if(M<S){var G=p[M],N=_[M];if(h(w,G,e,l,N),l+=N,j>=S)p[S]=C,w[p[S]]=G[0],_[S]=1,C=C+1+3&-4,S++;else{p[S]=C;var R=p[j],A=_[j];h(w,R,w,C,A),w[C+A]=w[G],A++,_[S]=A,S++,C=C+A+3&-4}S+1==1<<E&&E++}else{if(j>=S)p[S]=C,_[S]=0,S++;else{p[S]=C;var R=p[j],A=_[j];h(w,R,w,C,A),w[C+A]=w[C],A++,_[S]=A,S++,h(w,C,e,l,A),l+=A,C=C+A+3&-4}S+1==1<<E&&E++}j=M}},a.decode._copyData=function(i,r,e,l,s){for(var c=0;c<s;c+=4)e[l+c]=i[r+c],e[l+c+1]=i[r+c+1],e[l+c+2]=i[r+c+2],e[l+c+3]=i[r+c+3]},a.tags={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffset",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",296:"ResolutionUnit",297:"PageNumber",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffset",325:"TileByteCounts",330:"SubIFDs",336:"DotRange",338:"ExtraSample",339:"SampleFormat",347:"JPEGTables",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",700:"XMP",33421:"CFARepeatPatternDim",33422:"CFAPattern",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33723:"IPTC/NAA",34377:"Photoshop",34665:"ExifIFD",34675:"ICC Profile",34850:"ExposureProgram",34853:"GPSInfo",34855:"ISOSpeedRatings",34858:"TimeZoneOffset",34859:"SelfTimeMode",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37377:"ShutterSpeedValue",37378:"ApertureValue",37380:"ExposureBiasValue",37383:"MeteringMode",37385:"Flash",37386:"FocalLength",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37398:"TIFF/EPStandardID",37399:"SensingMethod",37500:"MakerNote",37510:"UserComment",37724:"ImageSourceData",40092:"XPComment",40094:"XPKeywords",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelXDimension",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50733:"BayerGreenSplit",50738:"AntiAliasStrength",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50727:"AnalogBalance",50728:"AsShotNeutral",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50827:"OriginalRawFileName",50829:"ActiveArea",50830:"MaskedAreas",50931:"CameraCalibrationSignature",50932:"ProfileCalibrationSignature",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualityFinalSize",51091:"OriginalDefaultCropSize",51125:"DefaultUserCrop"},a.ttypes={256:3,257:3,258:3,259:3,262:3,273:4,274:3,277:3,278:4,279:4,282:5,283:5,284:3,286:5,287:5,296:3,305:2,306:2,338:3,513:4,514:4,34665:4},a._readIFD=function(i,r,e,l){var s=i.readUshort(r,e);e+=2;var c={};l.push(c);for(var u=0;u<s;u++){var h=i.readUshort(r,e);e+=2;var p=i.readUshort(r,e);e+=2;var _=i.readUint(r,e);e+=4;var w=i.readUint(r,e);e+=4;var S=[];if(c["t"+h]=S,p==1||p==7)for(var C=0;C<_;C++)S.push(r[(_<5?e-4:w)+C]);if(p==2&&S.push(i.readASCII(r,_<5?e-4:w,_-1)),p==3)for(var C=0;C<_;C++)S.push(i.readUshort(r,(_<3?e-4:w)+2*C));if(p==4)for(var C=0;C<_;C++)S.push(i.readUint(r,(_<2?e-4:w)+4*C));if(p==5)for(var C=0;C<_;C++)S.push(i.readUint(r,w+C*8)/i.readUint(r,w+C*8+4));if(p==8)for(var C=0;C<_;C++)S.push(i.readShort(r,(_<3?e-4:w)+2*C));if(p==9)for(var C=0;C<_;C++)S.push(i.readInt(r,(_<2?e-4:w)+4*C));if(p==10)for(var C=0;C<_;C++)S.push(i.readInt(r,w+C*8)/i.readInt(r,w+C*8+4));if(p==11)for(var C=0;C<_;C++)S.push(i.readFloat(r,w+C*4));if(p==12)for(var C=0;C<_;C++)S.push(i.readDouble(r,w+C*8));if(_!=0&&S.length==0&&o("unknown TIFF tag type: ",p,"num:",_),h==330)for(var C=0;C<_;C++)a._readIFD(i,r,S[C],l)}return e},a._writeIFD=function(i,r,e,l){var s=Object.keys(l);i.writeUshort(r,e,s.length),e+=2;for(var c=e+s.length*12+4,u=0;u<s.length;u++){var h=s[u],p=parseInt(h.slice(1)),_=a.ttypes[p];if(_==null)throw new Error("unknown type of tag: "+p);var w=l[h];_==2&&(w=w[0]+"\0");var S=w.length;i.writeUshort(r,e,p),e+=2,i.writeUshort(r,e,_),e+=2,i.writeUint(r,e,S),e+=4;var C=[-1,1,1,2,4,8,0,0,0,0,0,0,8][_]*S,E=e;if(C>4&&(i.writeUint(r,e,c),E=c),_==2&&i.writeASCII(r,E,w),_==3)for(var k=0;k<S;k++)i.writeUshort(r,E+2*k,w[k]);if(_==4)for(var k=0;k<S;k++)i.writeUint(r,E+4*k,w[k]);if(_==5)for(var k=0;k<S;k++)i.writeUint(r,E+8*k,Math.round(w[k]*1e4)),i.writeUint(r,E+8*k+4,1e4);if(_==12)for(var k=0;k<S;k++)i.writeDouble(r,E+8*k,w[k]);C>4&&(C+=C&1,c+=C),e+=4}return[e,c]},a.toRGBA8=function(i){var r=i.width,e=i.height,l=r*e,s=l*4,c=i.data,u=new Uint8Array(l*4),h=i.t262[0],p=i.t258?Math.min(32,i.t258[0]):1,_=i.isLE?1:0;if(h==0)for(var w=Math.ceil(p*r/8),S=0;S<e;S++){var C=S*w,E=S*r;if(p==1)for(var k=0;k<r;k++){var O=E+k<<2,U=c[C+(k>>3)]>>7-(k&7)&1;u[O]=u[O+1]=u[O+2]=(1-U)*255,u[O+3]=255}if(p==4)for(var k=0;k<r;k++){var O=E+k<<2,U=c[C+(k>>1)]>>4-4*(k&1)&15;u[O]=u[O+1]=u[O+2]=(15-U)*17,u[O+3]=255}if(p==8)for(var k=0;k<r;k++){var O=E+k<<2,U=c[C+k];u[O]=u[O+1]=u[O+2]=255-U,u[O+3]=255}}else if(h==1)for(var w=Math.ceil(p*r/8),S=0;S<e;S++){var C=S*w,E=S*r;if(p==1)for(var k=0;k<r;k++){var O=E+k<<2,U=c[C+(k>>3)]>>7-(k&7)&1;u[O]=u[O+1]=u[O+2]=U*255,u[O+3]=255}if(p==2)for(var k=0;k<r;k++){var O=E+k<<2,U=c[C+(k>>2)]>>6-2*(k&3)&3;u[O]=u[O+1]=u[O+2]=U*85,u[O+3]=255}if(p==8)for(var k=0;k<r;k++){var O=E+k<<2,U=c[C+k];u[O]=u[O+1]=u[O+2]=U,u[O+3]=255}if(p==16)for(var k=0;k<r;k++){var O=E+k<<2,U=c[C+(2*k+_)];u[O]=u[O+1]=u[O+2]=Math.min(255,U),u[O+3]=255}}else if(h==2)if(p==8)if(i.t338)if(i.t338[0]>0)for(var k=0;k<s;k++)u[k]=c[k];else for(var k=0;k<s;k+=4)u[k]=c[k],u[k+1]=c[k+1],u[k+2]=c[k+2],u[k+3]=255;else{var F=i.t258?i.t258.length:3;if(F==4)for(var k=0;k<s;k++)u[k]=c[k];if(F==3)for(var k=0;k<l;k++){var O=k<<2,M=k*3;u[O]=c[M],u[O+1]=c[M+1],u[O+2]=c[M+2],u[O+3]=255}}else for(var k=0;k<l;k++){var O=k<<2,M=k*6;u[O]=c[M],u[O+1]=c[M+2],u[O+2]=c[M+4],u[O+3]=255}else if(h==3)for(var j=i.t320,k=0;k<l;k++){var O=k<<2,G=c[k];u[O]=j[G]>>8,u[O+1]=j[256+G]>>8,u[O+2]=j[512+G]>>8,u[O+3]=255}else if(h==5)for(var F=i.t258?i.t258.length:4,N=F>4?1:0,k=0;k<l;k++){var O=k<<2,R=k*F,A=255-c[R],H=255-c[R+1],Z=255-c[R+2],K=(255-c[R+3])*(1/255);u[O]=~~(A*K+.5),u[O+1]=~~(H*K+.5),u[O+2]=~~(Z*K+.5),u[O+3]=255*(1-N)+c[R+4]*N}else o("Unknown Photometric interpretation: "+h);return u},a.replaceIMG=function(){for(var i=document.getElementsByTagName("img"),r=0;r<i.length;r++){var e=i[r],l=e.getAttribute("src");if(l!=null){var s=l.split(".").pop().toLowerCase();if(!(s!="tif"&&s!="tiff")){var c=new XMLHttpRequest;a._xhrs.push(c),a._imgs.push(e),c.open("GET",l),c.responseType="arraybuffer",c.onload=a._imgLoaded,c.send()}}}},a._xhrs=[],a._imgs=[],a._imgLoaded=function(i){var r=i.target.response,e=a.decode(r),l=e[0];a.decodeImages(r,e);var s=a.toRGBA8(l),c=l.width,u=l.height,h=a._xhrs.indexOf(i.target),p=a._imgs[h];a._xhrs.splice(h,1),a._imgs.splice(h,1);var _=document.createElement("canvas");_.width=c,_.height=u;for(var w=_.getContext("2d"),S=w.createImageData(c,u),C=0;C<s.length;C++)S.data[C]=s[C];w.putImageData(S,0,0);for(var E=["style","class","id"],C=0;C<E.length;C++)_.setAttribute(E[C],p.getAttribute(E[C]));p.parentNode.replaceChild(_,p)},a._binBE={nextZero:function(i,r){for(;i[r]!=0;)r++;return r},readUshort:function(i,r){return i[r]<<8|i[r+1]},readShort:function(i,r){var e=a._binBE.ui8;return e[0]=i[r+1],e[1]=i[r+0],a._binBE.i16[0]},readInt:function(i,r){var e=a._binBE.ui8;return e[0]=i[r+3],e[1]=i[r+2],e[2]=i[r+1],e[3]=i[r+0],a._binBE.i32[0]},readUint:function(i,r){var e=a._binBE.ui8;return e[0]=i[r+3],e[1]=i[r+2],e[2]=i[r+1],e[3]=i[r+0],a._binBE.ui32[0]},readASCII:function(i,r,e){for(var l="",s=0;s<e;s++)l+=String.fromCharCode(i[r+s]);return l},readFloat:function(i,r){for(var e=a._binBE.ui8,l=0;l<4;l++)e[l]=i[r+3-l];return a._binBE.fl32[0]},readDouble:function(i,r){for(var e=a._binBE.ui8,l=0;l<8;l++)e[l]=i[r+7-l];return a._binBE.fl64[0]},writeUshort:function(i,r,e){i[r]=e>>8&255,i[r+1]=e&255},writeUint:function(i,r,e){i[r]=e>>24&255,i[r+1]=e>>16&255,i[r+2]=e>>8&255,i[r+3]=e>>0&255},writeASCII:function(i,r,e){for(var l=0;l<e.length;l++)i[r+l]=e.charCodeAt(l)},writeDouble:function(i,r,e){a._binBE.fl64[0]=e;for(var l=0;l<8;l++)i[r+l]=a._binBE.ui8[7-l]}},a._binBE.ui8=new Uint8Array(8),a._binBE.i16=new Int16Array(a._binBE.ui8.buffer),a._binBE.i32=new Int32Array(a._binBE.ui8.buffer),a._binBE.ui32=new Uint32Array(a._binBE.ui8.buffer),a._binBE.fl32=new Float32Array(a._binBE.ui8.buffer),a._binBE.fl64=new Float64Array(a._binBE.ui8.buffer),a._binLE={nextZero:a._binBE.nextZero,readUshort:function(i,r){return i[r+1]<<8|i[r]},readShort:function(i,r){var e=a._binBE.ui8;return e[0]=i[r+0],e[1]=i[r+1],a._binBE.i16[0]},readInt:function(i,r){var e=a._binBE.ui8;return e[0]=i[r+0],e[1]=i[r+1],e[2]=i[r+2],e[3]=i[r+3],a._binBE.i32[0]},readUint:function(i,r){var e=a._binBE.ui8;return e[0]=i[r+0],e[1]=i[r+1],e[2]=i[r+2],e[3]=i[r+3],a._binBE.ui32[0]},readASCII:a._binBE.readASCII,readFloat:function(i,r){for(var e=a._binBE.ui8,l=0;l<4;l++)e[l]=i[r+l];return a._binBE.fl32[0]},readDouble:function(i,r){for(var e=a._binBE.ui8,l=0;l<8;l++)e[l]=i[r+l];return a._binBE.fl64[0]}},a._copyTile=function(i,r,e,l,s,c,u,h){for(var p=Math.min(r,s-u),_=Math.min(e,c-h),w=0;w<_;w++)for(var S=(h+w)*s+u,C=w*r,E=0;E<p;E++)l[S+E]=i[C+E]}})(f,n)})()}).call(this,m("_process"))},{_process:133,pako:86}],183:[function(m,x,g){(function(b){x.exports=f;function f(o,a){if(n("noDeprecation"))return o;var t=!1;function i(){if(!t){if(n("throwDeprecation"))throw new Error(a);n("traceDeprecation")?console.trace(a):console.warn(a),t=!0}return o.apply(this,arguments)}return i}function n(o){try{if(!b.localStorage)return!1}catch(t){return!1}var a=b.localStorage[o];return a==null?!1:String(a).toLowerCase()==="true"}}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof y<"u"?y:{})},{}],184:[function(m,x,g){arguments[4][26][0].apply(g,arguments)},{dup:26}],185:[function(m,x,g){arguments[4][27][0].apply(g,arguments)},{dup:27}],186:[function(m,x,g){arguments[4][28][0].apply(g,arguments)},{"./support/isBuffer":185,_process:133,dup:28,inherits:184}],187:[function(m,x,g){var b=m("global/window"),f=m("is-function"),n=m("parse-headers"),o=m("xtend");x.exports=r,x.exports.default=r,r.XMLHttpRequest=b.XMLHttpRequest||s,r.XDomainRequest="withCredentials"in new r.XMLHttpRequest?r.XMLHttpRequest:b.XDomainRequest,a(["get","put","post","patch","head","delete"],function(c){r[c==="delete"?"del":c]=function(u,h,p){return h=i(u,h,p),h.method=c.toUpperCase(),e(h)}});function a(c,u){for(var h=0;h<c.length;h++)u(c[h])}function t(c){for(var u in c)if(c.hasOwnProperty(u))return!1;return!0}function i(c,u,h){var p=c;return f(u)?(h=u,typeof c=="string"&&(p={uri:c})):p=o(u,{uri:c}),p.callback=h,p}function r(c,u,h){return u=i(c,u,h),e(u)}function e(c){if(typeof c.callback>"u")throw new Error("callback argument missing");var u=!1,h=function(H,Z,K){u||(u=!0,c.callback(H,Z,K))};function p(){C.readyState===4&&setTimeout(S,0)}function _(){var A=void 0;if(C.response?A=C.response:A=C.responseText||l(C),G)try{A=JSON.parse(A)}catch(H){}return A}function w(A){return clearTimeout(N),A instanceof Error||(A=new Error(""+(A||"Unknown XMLHttpRequest Error"))),A.statusCode=0,h(A,R)}function S(){if(!k){var A;clearTimeout(N),c.useXDR&&C.status===void 0?A=200:A=C.status===1223?204:C.status;var H=R,Z=null;return A!==0?(H={body:_(),statusCode:A,method:U,headers:{},url:O,rawRequest:C},C.getAllResponseHeaders&&(H.headers=n(C.getAllResponseHeaders()))):Z=new Error("Internal XMLHttpRequest Error"),h(Z,H,H.body)}}var C=c.xhr||null;C||(c.cors||c.useXDR?C=new r.XDomainRequest:C=new r.XMLHttpRequest);var E,k,O=C.url=c.uri||c.url,U=C.method=c.method||"GET",F=c.body||c.data,M=C.headers=c.headers||{},j=!!c.sync,G=!1,N,R={body:void 0,headers:{},statusCode:0,method:U,url:O,rawRequest:C};if("json"in c&&c.json!==!1&&(G=!0,M.accept||M.Accept||(M.Accept="application/json"),U!=="GET"&&U!=="HEAD"&&(M["content-type"]||M["Content-Type"]||(M["Content-Type"]="application/json"),F=JSON.stringify(c.json===!0?F:c.json))),C.onreadystatechange=p,C.onload=S,C.onerror=w,C.onprogress=function(){},C.onabort=function(){k=!0},C.ontimeout=w,C.open(U,O,!j,c.username,c.password),j||(C.withCredentials=!!c.withCredentials),!j&&c.timeout>0&&(N=setTimeout(function(){if(!k){k=!0,C.abort("timeout");var A=new Error("XMLHttpRequest timeout");A.code="ETIMEDOUT",w(A)}},c.timeout)),C.setRequestHeader)for(E in M)M.hasOwnProperty(E)&&C.setRequestHeader(E,M[E]);else if(c.headers&&!t(c.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in c&&(C.responseType=c.responseType),"beforeSend"in c&&typeof c.beforeSend=="function"&&c.beforeSend(C),C.send(F||null),C}function l(c){try{if(c.responseType==="document")return c.responseXML;var u=c.responseXML&&c.responseXML.documentElement.nodeName==="parsererror";if(c.responseType===""&&!u)return c.responseXML}catch(h){}return null}function s(){}},{"global/window":71,"is-function":78,"parse-headers":106,xtend:189}],188:[function(m,x,g){x.exports=function(){return typeof self.DOMParser<"u"?function(f){var n=new self.DOMParser;return n.parseFromString(f,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(f){var n=new self.ActiveXObject("Microsoft.XMLDOM");return n.async="false",n.loadXML(f),n}:function(f){var n=document.createElement("div");return n.innerHTML=f,n}}()},{}],189:[function(m,x,g){x.exports=f;var b=Object.prototype.hasOwnProperty;function f(){for(var n={},o=0;o<arguments.length;o++){var a=arguments[o];for(var t in a)b.call(a,t)&&(n[t]=a[t])}return n}},{}],190:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.srcOver=b,g.dstOver=f,g.multiply=n,g.add=o,g.screen=a,g.overlay=t,g.darken=i,g.lighten=r,g.hardLight=e,g.difference=l,g.exclusion=s;function b(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=(c.r*c.a+u.r*u.a*(1-c.a))/p,w=(c.g*c.a+u.g*u.a*(1-c.a))/p,S=(c.b*c.a+u.b*u.a*(1-c.a))/p;return{r:_,g:w,b:S,a:p}}function f(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=(u.r*u.a+c.r*c.a*(1-u.a))/p,w=(u.g*u.a+c.g*c.a*(1-u.a))/p,S=(u.b*u.a+c.b*c.a*(1-u.a))/p;return{r:_,g:w,b:S,a:p}}function n(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(_*C+_*(1-u.a)+C*(1-c.a))/p,U=(w*E+w*(1-u.a)+E*(1-c.a))/p,F=(S*k+S*(1-u.a)+k*(1-c.a))/p;return{r:O,g:U,b:F,a:p}}function o(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(_+C)/p,U=(w+E)/p,F=(S+k)/p;return{r:O,g:U,b:F,a:p}}function a(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(_*u.a+C*c.a-_*C+_*(1-u.a)+C*(1-c.a))/p,U=(w*u.a+E*c.a-w*E+w*(1-u.a)+E*(1-c.a))/p,F=(S*u.a+k*c.a-S*k+S*(1-u.a)+k*(1-c.a))/p;return{r:O,g:U,b:F,a:p}}function t(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(2*C<=u.a?2*_*C+_*(1-u.a)+C*(1-c.a):_*(1+u.a)+C*(1+c.a)-2*C*_-u.a*c.a)/p,U=(2*E<=u.a?2*w*E+w*(1-u.a)+E*(1-c.a):w*(1+u.a)+E*(1+c.a)-2*E*w-u.a*c.a)/p,F=(2*k<=u.a?2*S*k+S*(1-u.a)+k*(1-c.a):S*(1+u.a)+k*(1+c.a)-2*k*S-u.a*c.a)/p;return{r:O,g:U,b:F,a:p}}function i(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(Math.min(_*u.a,C*c.a)+_*(1-u.a)+C*(1-c.a))/p,U=(Math.min(w*u.a,E*c.a)+w*(1-u.a)+E*(1-c.a))/p,F=(Math.min(S*u.a,k*c.a)+S*(1-u.a)+k*(1-c.a))/p;return{r:O,g:U,b:F,a:p}}function r(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(Math.max(_*u.a,C*c.a)+_*(1-u.a)+C*(1-c.a))/p,U=(Math.max(w*u.a,E*c.a)+w*(1-u.a)+E*(1-c.a))/p,F=(Math.max(S*u.a,k*c.a)+S*(1-u.a)+k*(1-c.a))/p;return{r:O,g:U,b:F,a:p}}function e(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(2*_<=c.a?2*_*C+_*(1-u.a)+C*(1-c.a):_*(1+u.a)+C*(1+c.a)-2*C*_-u.a*c.a)/p,U=(2*w<=c.a?2*w*E+w*(1-u.a)+E*(1-c.a):w*(1+u.a)+E*(1+c.a)-2*E*w-u.a*c.a)/p,F=(2*S<=c.a?2*S*k+S*(1-u.a)+k*(1-c.a):S*(1+u.a)+k*(1+c.a)-2*k*S-u.a*c.a)/p;return{r:O,g:U,b:F,a:p}}function l(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(_+C-2*Math.min(_*u.a,C*c.a))/p,U=(w+E-2*Math.min(w*u.a,E*c.a))/p,F=(S+k-2*Math.min(S*u.a,k*c.a))/p;return{r:O,g:U,b:F,a:p}}function s(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;c.a*=h;var p=u.a+c.a-u.a*c.a,_=c.r*c.a,w=c.g*c.a,S=c.b*c.a,C=u.r*u.a,E=u.g*u.a,k=u.b*u.a,O=(_*u.a+C*c.a-2*_*C+_*(1-u.a)+C*(1-c.a))/p,U=(w*u.a+E*c.a-2*w*E+w*(1-u.a)+E*(1-c.a))/p,F=(S*u.a+k*c.a-2*S*k+S*(1-u.a)+k*(1-c.a))/p;return{r:O,g:U,b:F,a:p}}},{}],191:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(g,"__esModule",{value:!0}),g.default=a;var f=m("@jimp/utils"),n=b(m("../constants")),o=b(m("./composite-modes"));function a(t,i,r){var e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=arguments.length>4?arguments[4]:void 0;if(typeof e=="function"&&(l=e,e={}),!(t instanceof this.constructor))return f.throwError.call(this,"The source must be a Jimp image",l);if(typeof i!="number"||typeof r!="number")return f.throwError.call(this,"x and y must be numbers",l);var s=e,c=s.mode,u=s.opacitySource,h=s.opacityDest;c||(c=n.BLEND_SOURCE_OVER),(typeof u!="number"||u<0||u>1)&&(u=1),(typeof h!="number"||h<0||h>1)&&(h=1);var p=o[c];i=Math.round(i),r=Math.round(r);var _=this;return h!==1&&_.opacity(h),t.scanQuiet(0,0,t.bitmap.width,t.bitmap.height,function(w,S,C){var E=_.getPixelIndex(i+w,r+S,n.EDGE_CROP),k=p({r:this.bitmap.data[C+0]/255,g:this.bitmap.data[C+1]/255,b:this.bitmap.data[C+2]/255,a:this.bitmap.data[C+3]/255},{r:_.bitmap.data[E+0]/255,g:_.bitmap.data[E+1]/255,b:_.bitmap.data[E+2]/255,a:_.bitmap.data[E+3]/255},u);_.bitmap.data[E+0]=this.constructor.limit255(k.r*255),_.bitmap.data[E+1]=this.constructor.limit255(k.g*255),_.bitmap.data[E+2]=this.constructor.limit255(k.b*255),_.bitmap.data[E+3]=this.constructor.limit255(k.a*255)}),(0,f.isNodePattern)(l)&&l.call(this,null,this),this}x.exports=g.default},{"../constants":192,"./composite-modes":190,"@babel/runtime/helpers/interopRequireWildcard":12,"@jimp/utils":235}],192:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.EDGE_CROP=g.EDGE_WRAP=g.EDGE_EXTEND=g.BLEND_EXCLUSION=g.BLEND_DIFFERENCE=g.BLEND_HARDLIGHT=g.BLEND_LIGHTEN=g.BLEND_DARKEN=g.BLEND_OVERLAY=g.BLEND_SCREEN=g.BLEND_ADD=g.BLEND_MULTIPLY=g.BLEND_DESTINATION_OVER=g.BLEND_SOURCE_OVER=g.VERTICAL_ALIGN_BOTTOM=g.VERTICAL_ALIGN_MIDDLE=g.VERTICAL_ALIGN_TOP=g.HORIZONTAL_ALIGN_RIGHT=g.HORIZONTAL_ALIGN_CENTER=g.HORIZONTAL_ALIGN_LEFT=g.AUTO=void 0;var b=-1;g.AUTO=b;var f=1;g.HORIZONTAL_ALIGN_LEFT=f;var n=2;g.HORIZONTAL_ALIGN_CENTER=n;var o=4;g.HORIZONTAL_ALIGN_RIGHT=o;var a=8;g.VERTICAL_ALIGN_TOP=a;var t=16;g.VERTICAL_ALIGN_MIDDLE=t;var i=32;g.VERTICAL_ALIGN_BOTTOM=i;var r="srcOver";g.BLEND_SOURCE_OVER=r;var e="dstOver";g.BLEND_DESTINATION_OVER=e;var l="multiply";g.BLEND_MULTIPLY=l;var s="add";g.BLEND_ADD=s;var c="screen";g.BLEND_SCREEN=c;var u="overlay";g.BLEND_OVERLAY=u;var h="darken";g.BLEND_DARKEN=h;var p="lighten";g.BLEND_LIGHTEN=p;var _="hardLight";g.BLEND_HARDLIGHT=_;var w="difference";g.BLEND_DIFFERENCE=w;var S="exclusion";g.BLEND_EXCLUSION=S;var C=1;g.EDGE_EXTEND=C;var E=2;g.EDGE_WRAP=E;var k=3;g.EDGE_CROP=k},{}],193:[function(m,x,g){(function(b){var f=m("@babel/runtime/helpers/interopRequireWildcard"),n=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.addConstants=fe,g.addJimpMethods=he,g.jimpEvMethod=se,g.jimpEvChange=ie,Object.defineProperty(g,"addType",{enumerable:!0,get:function(){return j.addType}}),g.default=void 0;for(var o=n(m("@babel/runtime/helpers/construct")),a=n(m("@babel/runtime/helpers/slicedToArray")),t=n(m("@babel/runtime/helpers/classCallCheck")),i=n(m("@babel/runtime/helpers/createClass")),r=n(m("@babel/runtime/helpers/possibleConstructorReturn")),e=n(m("@babel/runtime/helpers/getPrototypeOf")),l=n(m("@babel/runtime/helpers/assertThisInitialized")),s=n(m("@babel/runtime/helpers/inherits")),c=n(m("@babel/runtime/helpers/defineProperty")),u=n(m("@babel/runtime/helpers/typeof")),h=n(m("fs")),p=n(m("path")),_=n(m("events")),w=m("@jimp/utils"),S=n(m("any-base")),C=n(m("mkdirp")),E=n(m("pixelmatch")),k=n(m("tinycolor2")),O=n(m("./modules/phash")),U=n(m("./request")),F=n(m("./composite")),M=n(m("./utils/promisify")),j=f(m("./utils/mime")),G=m("./utils/image-bitmap"),N=f(m("./constants")),R="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",A=[NaN,NaN],H=2;H<65;H++){var Z=(0,S.default)(S.default.BIN,R.slice(0,H))(new Array(65).join("1"));A.push(Z.length)}function K(){}function J(te){return Object.prototype.toString.call(te).toLowerCase().indexOf("arraybuffer")>-1}function D(te){for(var V=b.alloc(te.byteLength),z=new Uint8Array(te),B=0;B<V.length;++B)V[B]=z[B];return V}function I(te,V){(0,U.default)(te,function(z,B,ee){if(z)return V(z);if("headers"in B&&"location"in B.headers)return te.url=B.headers.location,I(te,V);if((0,u.default)(ee)==="object"&&b.isBuffer(ee))return V(null,ee);var Y="Could not load Buffer from <"+te.url+"> (HTTP: "+B.statusCode+")";return new Error(Y)})}function W(te,V){h.default&&typeof h.default.readFile=="function"&&!te.match(/^(http|ftp)s?:\/\/./)?h.default.readFile(te,V):I({url:te},V)}function q(te){return te&&(0,u.default)(te)==="object"&&typeof te.width=="number"&&typeof te.height=="number"&&(b.isBuffer(te.data)||te.data instanceof Uint8Array||typeof Uint8ClampedArray=="function"&&te.data instanceof Uint8ClampedArray)&&(te.data.length===te.width*te.height*4||te.data.length===te.width*te.height*3)}function ne(te){if(te.length%3!==0)throw new Error("Buffer length is incorrect");for(var V=b.allocUnsafe(te.length/3*4),z=0,B=0;B<te.length;B++)V[z]=te[B],(B+1)%3===0&&(V[++z]=255),z++;return V}var le={data:null,width:null,height:null},ce=function(te){(0,s.default)(V,te);function V(){for(var z,B=arguments.length,ee=new Array(B),Y=0;Y<B;Y++)ee[Y]=arguments[Y];(0,t.default)(this,V),z=(0,r.default)(this,(0,e.default)(V).call(this)),(0,c.default)((0,l.default)(z),"bitmap",le),(0,c.default)((0,l.default)(z),"_background",0),(0,c.default)((0,l.default)(z),"_originalMime",V.MIME_PNG),(0,c.default)((0,l.default)(z),"_exif",null),(0,c.default)((0,l.default)(z),"_rgba",!0),(0,c.default)((0,l.default)(z),"writeAsync",function(Ae){return(0,M.default)(z.write,(0,l.default)(z),Ae)}),(0,c.default)((0,l.default)(z),"getBase64Async",function(Ae){return(0,M.default)(z.getBase64,(0,l.default)(z),Ae)}),(0,c.default)((0,l.default)(z),"getBuffer",G.getBuffer),(0,c.default)((0,l.default)(z),"getBufferAsync",G.getBufferAsync),(0,c.default)((0,l.default)(z),"getPixelColour",z.getPixelColor),(0,c.default)((0,l.default)(z),"setPixelColour",z.setPixelColor);var L=(0,l.default)(z),P=K;J(ee[0])&&(ee[0]=D(ee[0]));function ae(){for(var Ae=arguments.length,$=new Array(Ae),be=0;be<Ae;be++)$[be]=arguments[be];var ge=$[0],ke=ge||{};ke.methodName="constructor",setTimeout(function(){var pe;ge&&P===K?L.emitError("constructor",ge):ge||L.emitMulti("constructor","initialized"),(pe=P).call.apply(pe,[L].concat($))},1)}if(typeof ee[0]=="number"&&typeof ee[1]=="number"||parseInt(ee[0],10)&&parseInt(ee[1],10)){var ue=parseInt(ee[0],10),ve=parseInt(ee[1],10);if(P=ee[2],typeof ee[2]=="number"&&(z._background=ee[2],P=ee[3]),typeof ee[2]=="string"&&(z._background=V.cssColorToHex(ee[2]),P=ee[3]),typeof P>"u"&&(P=K),typeof P!="function")return(0,r.default)(z,w.throwError.call((0,l.default)(z),"cb must be a function",ae));z.bitmap={data:b.alloc(ue*ve*4),width:ue,height:ve};for(var _e=0;_e<z.bitmap.data.length;_e+=4)z.bitmap.data.writeUInt32BE(z._background,_e);ae(null,(0,l.default)(z))}else if((0,u.default)(ee[0])==="object"&&ee[0].url){if(P=ee[1]||K,typeof P!="function")return(0,r.default)(z,w.throwError.call((0,l.default)(z),"cb must be a function",ae));I(ee[0],function(Ae,$){if(Ae)return w.throwError.call((0,l.default)(z),Ae,ae);z.parseBitmap($,ee[0].url,ae)})}else if(ee[0]instanceof V){var Te=ee[0];if(P=ee[1],typeof P>"u"&&(P=K),typeof P!="function")return(0,r.default)(z,w.throwError.call((0,l.default)(z),"cb must be a function",ae));z.bitmap={data:b.from(Te.bitmap.data),width:Te.bitmap.width,height:Te.bitmap.height},z._quality=Te._quality,z._deflateLevel=Te._deflateLevel,z._deflateStrategy=Te._deflateStrategy,z._filterType=Te._filterType,z._rgba=Te._rgba,z._background=Te._background,z._originalMime=Te._originalMime,ae(null,(0,l.default)(z))}else if(q(ee[0])){var Re=ee[0];P=ee[1]||K;var Le=Re.width*Re.height*4===Re.data.length,Se=Le?b.from(Re.data):ne(Re.data);z.bitmap={data:Se,width:Re.width,height:Re.height},ae(null,(0,l.default)(z))}else if(typeof ee[0]=="string"){var Ee=ee[0];if(P=ee[1],typeof P>"u"&&(P=K),typeof P!="function")return(0,r.default)(z,w.throwError.call((0,l.default)(z),"cb must be a function",ae));W(Ee,function(Ae,$){if(Ae)return w.throwError.call((0,l.default)(z),Ae,ae);z.parseBitmap($,Ee,ae)})}else if((0,u.default)(ee[0])==="object"&&b.isBuffer(ee[0])){var Ce=ee[0];if(P=ee[1],typeof P!="function")return(0,r.default)(z,w.throwError.call((0,l.default)(z),"cb must be a function",ae));z.parseBitmap(Ce,null,ae)}else{P=ee[ee.length-1],typeof P!="function"&&(P=ee[ee.length-2],typeof P!="function"&&(P=K));var Ie=V.__extraConstructors.find(function(Ae){return Ae.test.apply(Ae,ee)});if(Ie)new Promise(function(Ae,$){var be;return(be=Ie.run).call.apply(be,[(0,l.default)(z),Ae,$].concat(ee))}).then(function(){return ae(null,(0,l.default)(z))}).catch(ae);else return(0,r.default)(z,w.throwError.call((0,l.default)(z),"No matching constructor overloading was found. Please see the docs for how to call the Jimp constructor.",ae))}return z}return(0,i.default)(V,[{key:"parseBitmap",value:function(B,ee,Y){G.parseBitmap.call(this,B,null,Y)}},{key:"rgba",value:function(B,ee){return typeof B!="boolean"?w.throwError.call(this,"bool must be a boolean, true for RGBA or false for RGB",ee):(this._rgba=B,(0,w.isNodePattern)(ee)&&ee.call(this,null,this),this)}},{key:"emitMulti",value:function(B,ee){var Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Y=Object.assign(Y,{methodName:B,eventName:ee}),this.emit("any",Y),B&&this.emit(B,Y),this.emit(ee,Y)}},{key:"emitError",value:function(B,ee){this.emitMulti(B,"error",ee)}},{key:"getHeight",value:function(){return this.bitmap.height}},{key:"getWidth",value:function(){return this.bitmap.width}},{key:"inspect",value:function(){return"<Jimp "+(this.bitmap===le?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}},{key:"toString",value:function(){return"[object Jimp]"}},{key:"getMIME",value:function(){var B=this._originalMime||V.MIME_PNG;return B}},{key:"getExtension",value:function(){var B=this.getMIME();return j.getExtension(B)}},{key:"write",value:function(B,ee){var Y=this;if(!h.default||!h.default.createWriteStream)throw new Error("Cant access the filesystem. You can use the getBase64 method.");if(typeof B!="string")return w.throwError.call(this,"path must be a string",ee);if(typeof ee>"u"&&(ee=K),typeof ee!="function")return w.throwError.call(this,"cb must be a function",ee);var L=j.getType(B)||this.getMIME(),P=p.default.parse(B);return P.dir&&C.default.sync(P.dir),this.getBuffer(L,function(ae,ue){if(ae)return w.throwError.call(Y,ae,ee);var ve=h.default.createWriteStream(B);ve.on("open",function(){ve.write(ue),ve.end()}).on("error",function(_e){return w.throwError.call(Y,_e,ee)}),ve.on("finish",function(){ee.call(Y,null,Y)})}),this}},{key:"getBase64",value:function(B,ee){return B===V.AUTO&&(B=this.getMIME()),typeof B!="string"?w.throwError.call(this,"mime must be a string",ee):typeof ee!="function"?w.throwError.call(this,"cb must be a function",ee):(this.getBuffer(B,function(Y,L){if(Y)return w.throwError.call(this,Y,ee);var P="data:"+B+";base64,"+L.toString("base64");ee.call(this,null,P)}),this)}},{key:"hash",value:function(B,ee){if(B=B||64,typeof B=="function"&&(ee=B,B=64),typeof B!="number")return w.throwError.call(this,"base must be a number",ee);if(B<2||B>64)return w.throwError.call(this,"base must be a number between 2 and 64",ee);var Y=this.pHash();for(Y=(0,S.default)(S.default.BIN,R.slice(0,B))(Y);Y.length<A[B];)Y="0"+Y;return(0,w.isNodePattern)(ee)&&ee.call(this,null,Y),Y}},{key:"pHash",value:function(){var B=new O.default;return B.getHash(this)}},{key:"distanceFromHash",value:function(B){var ee=new O.default,Y=ee.getHash(this);return ee.distance(Y,B)}},{key:"getPixelIndex",value:function(B,ee,Y,L){var P,ae;if(typeof Y=="function"&&typeof L>"u"&&(L=Y,Y=null),Y||(Y=V.EDGE_EXTEND),typeof B!="number"||typeof ee!="number")return w.throwError.call(this,"x and y must be numbers",L);B=Math.round(B),ee=Math.round(ee),P=B,ae=ee,Y===V.EDGE_EXTEND&&(B<0&&(P=0),B>=this.bitmap.width&&(P=this.bitmap.width-1),ee<0&&(ae=0),ee>=this.bitmap.height&&(ae=this.bitmap.height-1)),Y===V.EDGE_WRAP&&(B<0&&(P=this.bitmap.width+B),B>=this.bitmap.width&&(P=B%this.bitmap.width),ee<0&&(P=this.bitmap.height+ee),ee>=this.bitmap.height&&(ae=ee%this.bitmap.height));var ue=this.bitmap.width*ae+P<<2;return(P<0||P>=this.bitmap.width)&&(ue=-1),(ae<0||ae>=this.bitmap.height)&&(ue=-1),(0,w.isNodePattern)(L)&&L.call(this,null,ue),ue}},{key:"getPixelColor",value:function(B,ee,Y){if(typeof B!="number"||typeof ee!="number")return w.throwError.call(this,"x and y must be numbers",Y);B=Math.round(B),ee=Math.round(ee);var L=this.getPixelIndex(B,ee),P=this.bitmap.data.readUInt32BE(L);return(0,w.isNodePattern)(Y)&&Y.call(this,null,P),P}},{key:"setPixelColor",value:function(B,ee,Y,L){if(typeof B!="number"||typeof ee!="number"||typeof Y!="number")return w.throwError.call(this,"hex, x and y must be numbers",L);ee=Math.round(ee),Y=Math.round(Y);var P=this.getPixelIndex(ee,Y);return this.bitmap.data.writeUInt32BE(B,P),(0,w.isNodePattern)(L)&&L.call(this,null,this),this}},{key:"hasAlpha",value:function(){for(var B=0;B<this.bitmap.height;B++)for(var ee=0;ee<this.bitmap.width;ee++){var Y=this.bitmap.width*B+ee<<2,L=this.bitmap.data[Y+3];if(L!==255)return!0}return!1}},{key:"scanIterator",value:function(B,ee,Y,L){return typeof B!="number"||typeof ee!="number"?w.throwError.call(this,"x and y must be numbers"):typeof Y!="number"||typeof L!="number"?w.throwError.call(this,"w and h must be numbers"):(0,w.scanIterator)(this,B,ee,Y,L)}}]),V}(_.default);function fe(te){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ce;Object.entries(te).forEach(function(z){var B=(0,a.default)(z,2),ee=B[0],Y=B[1];V[ee]=Y})}function he(te){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ce;Object.entries(te).forEach(function(z){var B=(0,a.default)(z,2),ee=B[0],Y=B[1];V.prototype[ee]=Y})}fe(N),he({composite:F.default}),ce.__extraConstructors=[],ce.appendConstructorOption=function(te,V,z){ce.__extraConstructors.push({name:te,test:V,run:z})},ce.read=function(){for(var te=arguments.length,V=new Array(te),z=0;z<te;z++)V[z]=arguments[z];return new Promise(function(B,ee){(0,o.default)(ce,V.concat([function(Y,L){Y?ee(Y):B(L)}]))})},ce.create=ce.read,ce.rgbaToInt=function(te,V,z,B,ee){if(typeof te!="number"||typeof V!="number"||typeof z!="number"||typeof B!="number")return w.throwError.call(this,"r, g, b and a must be numbers",ee);if(te<0||te>255)return w.throwError.call(this,"r must be between 0 and 255",ee);if((V<0||V>255)&&w.throwError.call(this,"g must be between 0 and 255",ee),z<0||z>255)return w.throwError.call(this,"b must be between 0 and 255",ee);if(B<0||B>255)return w.throwError.call(this,"a must be between 0 and 255",ee);te=Math.round(te),z=Math.round(z),V=Math.round(V),B=Math.round(B);var Y=te*Math.pow(256,3)+V*Math.pow(256,2)+z*Math.pow(256,1)+B*Math.pow(256,0);return(0,w.isNodePattern)(ee)&&ee.call(this,null,Y),Y},ce.intToRGBA=function(te,V){if(typeof te!="number")return w.throwError.call(this,"i must be a number",V);var z={};return z.r=Math.floor(te/Math.pow(256,3)),z.g=Math.floor((te-z.r*Math.pow(256,3))/Math.pow(256,2)),z.b=Math.floor((te-z.r*Math.pow(256,3)-z.g*Math.pow(256,2))/Math.pow(256,1)),z.a=Math.floor((te-z.r*Math.pow(256,3)-z.g*Math.pow(256,2)-z.b*Math.pow(256,1))/Math.pow(256,0)),(0,w.isNodePattern)(V)&&V.call(this,null,z),z},ce.cssColorToHex=function(te){return te=te||0,typeof te=="number"?Number(te):parseInt((0,k.default)(te).toHex8(),16)},ce.limit255=function(te){return te=Math.max(te,0),te=Math.min(te,255),te},ce.diff=function(te,V){var z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.1;if(!(te instanceof ce)||!(V instanceof ce))return w.throwError.call(this,"img1 and img2 must be an Jimp images");var B=te.bitmap,ee=V.bitmap;if((B.width!==ee.width||B.height!==ee.height)&&(B.width*B.height>ee.width*ee.height?te=te.cloneQuiet().resize(ee.width,ee.height):V=V.cloneQuiet().resize(B.width,B.height)),typeof z!="number"||z<0||z>1)return w.throwError.call(this,"threshold must be a number between 0 and 1");var Y=new ce(B.width,B.height,4294967295),L=(0,E.default)(B.data,ee.data,Y.bitmap.data,Y.bitmap.width,Y.bitmap.height,{threshold:z});return{percent:L/(Y.bitmap.width*Y.bitmap.height),image:Y}},ce.distance=function(te,V){var z=new O.default,B=z.getHash(te),ee=z.getHash(V);return z.distance(B,ee)},ce.compareHashes=function(te,V){var z=new O.default;return z.distance(te,V)},ce.colorDiff=function(te,V){var z=function(L){return Math.pow(L,2)},B=Math.max,ee=255*255*3;return te.a!==0&&!te.a&&(te.a=255),V.a!==0&&!V.a&&(V.a=255),(B(z(te.r-V.r),z(te.r-V.r-te.a+V.a))+B(z(te.g-V.g),z(te.g-V.g-te.a+V.a))+B(z(te.b-V.b),z(te.b-V.b-te.a+V.a)))/ee};function se(te,V,z){var B="before-"+V,ee=V.replace(/e$/,"")+"ed";ce.prototype[te]=function(){for(var Y,L=arguments.length,P=new Array(L),ae=0;ae<L;ae++)P[ae]=arguments[ae];var ue=P[z.length-1],ve=this;typeof ue=="function"?(Y=function(){for(var Re=arguments.length,Le=new Array(Re),Se=0;Se<Re;Se++)Le[Se]=arguments[Se];var Ee=Le[0],Ce=Le[1];Ee?ve.emitError(te,Ee):ve.emitMulti(te,ee,(0,c.default)({},te,Ce)),ue.apply(this,Le)},P[P.length-1]=Y):Y=!1,this.emitMulti(te,B);var _e;try{_e=z.apply(this,P),Y||this.emitMulti(te,ee,(0,c.default)({},te,_e))}catch(Te){Te.methodName=te,this.emitError(te,Te)}return _e},ce.prototype[te+"Quiet"]=z}se("clone","clone",function(te){var V=new ce(this);return(0,w.isNodePattern)(te)&&te.call(V,null,V),V});function ie(te,V){se(te,"change",V)}ie("background",function(te,V){return typeof te!="number"?w.throwError.call(this,"hex must be a hexadecimal rgba value",V):(this._background=te,(0,w.isNodePattern)(V)&&V.call(this,null,this),this)}),ie("scan",function(te,V,z,B,ee,Y){if(typeof te!="number"||typeof V!="number")return w.throwError.call(this,"x and y must be numbers",Y);if(typeof z!="number"||typeof B!="number")return w.throwError.call(this,"w and h must be numbers",Y);if(typeof ee!="function")return w.throwError.call(this,"f must be a function",Y);var L=(0,w.scan)(this,te,V,z,B,ee);return(0,w.isNodePattern)(Y)&&Y.call(this,null,L),L});{var Q;typeof y<"u"&&(typeof y>"u"?"undefined":(0,u.default)(y))==="object"&&(Q=y),typeof self<"u"&&(typeof self>"u"?"undefined":(0,u.default)(self))==="object"&&(Q=self),Q.Jimp=ce,Q.Buffer=b}var re=ce;g.default=re}).call(this,m("buffer").Buffer)},{"./composite":191,"./constants":192,"./modules/phash":194,"./request":195,"./utils/image-bitmap":196,"./utils/mime":197,"./utils/promisify":198,"@babel/runtime/helpers/assertThisInitialized":3,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/construct":5,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/getPrototypeOf":9,"@babel/runtime/helpers/inherits":10,"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/interopRequireWildcard":12,"@babel/runtime/helpers/possibleConstructorReturn":17,"@babel/runtime/helpers/slicedToArray":19,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235,"any-base":23,buffer:48,events:52,fs:47,mkdirp:83,path:107,pixelmatch:109,tinycolor2:178}],194:[function(m,x,g){function b(t,i){this.size=this.size||t,this.smallerSize=this.smallerSize||i,o(this.size)}b.prototype.size=32,b.prototype.smallerSize=8,b.prototype.distance=function(t,i){for(var r=0,e=0;e<t.length;e++)t[e]!==i[e]&&r++;return r/t.length},b.prototype.getHash=function(t){t=t.clone().resize(this.size,this.size),t.grayscale();for(var i=[],r=0;r<t.bitmap.width;r++){i[r]=[];for(var e=0;e<t.bitmap.height;e++)i[r][e]=f(t.getPixelColor(r,e)).b}for(var l=a(i,this.size),s=0,c=0;c<this.smallerSize;c++)for(var u=0;u<this.smallerSize;u++)s+=l[c][u];for(var h=s/(this.smallerSize*this.smallerSize),p="",_=0;_<this.smallerSize;_++)for(var w=0;w<this.smallerSize;w++)p+=l[_][w]>h?"1":"0";return p};function f(t){var i={};return i.r=Math.floor(t/Math.pow(256,3)),i.g=Math.floor((t-i.r*Math.pow(256,3))/Math.pow(256,2)),i.b=Math.floor((t-i.r*Math.pow(256,3)-i.g*Math.pow(256,2))/Math.pow(256,1)),i.a=Math.floor((t-i.r*Math.pow(256,3)-i.g*Math.pow(256,2)-i.b*Math.pow(256,1))/Math.pow(256,0)),i}var n=[];function o(t){for(var i=1;i<t;i++)n[i]=1;n[0]=1/Math.sqrt(2)}function a(t,i){for(var r=i,e=[],l=0;l<r;l++){e[l]=[];for(var s=0;s<r;s++){for(var c=0,u=0;u<r;u++)for(var h=0;h<r;h++)c+=Math.cos((2*u+1)/(2*r)*l*Math.PI)*Math.cos((2*h+1)/(2*r)*s*Math.PI)*t[u][h];c*=n[l]*n[s]/4,e[l][s]=c}}return e}x.exports=b},{}],195:[function(m,x,g){(function(b,f){var n=m("@babel/runtime/helpers/interopRequireDefault"),o=n(m("@babel/runtime/helpers/defineProperty")),a=n(m("@babel/runtime/helpers/extends"));function t(r,e){var l=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(r,c).enumerable})),l.push.apply(l,s)}return l}function i(r){for(var e=1;e<arguments.length;e++){var l=arguments[e]!=null?arguments[e]:{};e%2?t(l,!0).forEach(function(s){(0,o.default)(r,s,l[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(l)):t(l).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(l,s))})}return r}b.browser,x.exports=function(r,e){var l=new XMLHttpRequest;l.open("GET",r.url,!0),l.responseType="arraybuffer",l.addEventListener("load",function(){if(l.status<400)try{var s=f.from(this.response);e(null,l,s)}catch(c){return e(new Error("Response is not a buffer for url "+r.url+". Error: "+c.message))}else e(new Error("HTTP Status "+l.status+" for url "+r.url))}),l.addEventListener("error",function(s){e(s)}),l.send()}}).call(this,m("_process"),m("buffer").Buffer)},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/extends":8,"@babel/runtime/helpers/interopRequireDefault":11,_process:133,buffer:48,phin:108}],196:[function(m,x,g){(function(b){var f=m("@babel/runtime/helpers/interopRequireWildcard"),n=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.parseBitmap=_,g.getBuffer=S,g.getBufferAsync=C;var o=n(m("@babel/runtime/helpers/slicedToArray")),a=n(m("file-type")),t=n(m("exif-parser")),i=m("@jimp/utils"),r=f(m("../constants")),e=f(m("./mime")),l=n(m("./promisify"));function s(E,k){var O=(0,a.default)(E);return O?O.mime:k?e.getType(k):null}function c(E){return E._exif&&E._exif.tags&&E._exif.tags.Orientation||1}function u(E){var k=E.getWidth(),O=E.getHeight();switch(c(E)){case 1:return null;case 2:return function(U,F){return[k-U-1,F]};case 3:return function(U,F){return[k-U-1,O-F-1]};case 4:return function(U,F){return[U,O-F-1]};case 5:return function(U,F){return[F,U]};case 6:return function(U,F){return[F,O-U-1]};case 7:return function(U,F){return[k-F-1,O-U-1]};case 8:return function(U,F){return[k-F-1,U]};default:return null}}function h(E,k,O,U){for(var F=E.bitmap.data,M=E.bitmap.width,j=b.alloc(F.length),G=0;G<k;G++)for(var N=0;N<O;N++){var R=U(G,N),A=(0,o.default)(R,2),H=A[0],Z=A[1],K=k*N+G<<2,J=M*Z+H<<2,D=F.readUInt32BE(J);j.writeUInt32BE(D,K)}E.bitmap.data=j,E.bitmap.width=k,E.bitmap.height=O}function p(E){if(!(c(E)<2)){var k=u(E),O=c(E)>4,U=O?E.bitmap.height:E.bitmap.width,F=O?E.bitmap.width:E.bitmap.height;h(E,U,F,k)}}function _(E,k,O){var U=s(E,k);if(typeof U!="string")return O(new Error("Could not find MIME for Buffer <"+k+">"));this._originalMime=U.toLowerCase();try{var F=this.getMIME();if(this.constructor.decoders[F])this.bitmap=this.constructor.decoders[F](E);else return i.throwError.call(this,"Unsupported MIME type: "+F,O)}catch(M){return O.call(this,M,this)}try{this._exif=t.default.create(E).parse(),p(this)}catch(M){}return O.call(this,null,this),this}function w(E,k){return new E(k.bitmap.width,k.bitmap.height,k._background).composite(k,0,0).bitmap}function S(E,k){if(E===r.AUTO&&(E=this.getMIME()),typeof E!="string")return i.throwError.call(this,"mime must be a string",k);if(typeof k!="function")return i.throwError.call(this,"cb must be a function",k);if(E=E.toLowerCase(),this._rgba&&this.constructor.hasAlpha[E]?this.bitmap.data=b.from(this.bitmap.data):this.bitmap.data=w(this.constructor,this).data,this.constructor.encoders[E]){var O=this.constructor.encoders[E](this);k.call(this,null,O)}else k.call(this,"Unsupported MIME type: "+E);return this}function C(E){return(0,l.default)(S,this,E)}}).call(this,m("buffer").Buffer)},{"../constants":192,"./mime":197,"./promisify":198,"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/interopRequireWildcard":12,"@babel/runtime/helpers/slicedToArray":19,"@jimp/utils":235,buffer:48,"exif-parser":53,"file-type":62}],197:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.getExtension=g.getType=g.addType=void 0;var b={},f=function(i){return Object.entries(b).find(function(r){return r[1].includes(i)})||[]},n=function(i,r){b[i]=r};g.addType=n;var o=function(i){var r=i.split("/").slice(-1),e=r[r.length-1].split(".").pop(),l=f(e);return l[0]};g.getType=o;var a=function(i){return(b[i.toLowerCase()]||[])[0]};g.getExtension=a},{}],198:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=function(o,a){for(var t=arguments.length,i=new Array(t>2?t-2:0),r=2;r<t;r++)i[r-2]=arguments[r];return new Promise(function(e,l){i.push(function(s,c){s&&l(s),e(c)}),o.bind(a).apply(void 0,i)})},f=b;g.default=f,x.exports=g.default},{}],199:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireWildcard"),f=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=e;var n=f(m("@babel/runtime/helpers/toConsumableArray")),o=f(m("@babel/runtime/helpers/defineProperty")),a=f(m("@babel/runtime/helpers/slicedToArray")),t=b(m("@jimp/core"));function i(l,s){var c=Object.keys(l);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(l);s&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(l,h).enumerable})),c.push.apply(c,u)}return c}function r(l){for(var s=1;s<arguments.length;s++){var c=arguments[s]!=null?arguments[s]:{};s%2?i(c,!0).forEach(function(u){(0,o.default)(l,u,c[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(c)):i(c).forEach(function(u){Object.defineProperty(l,u,Object.getOwnPropertyDescriptor(c,u))})}return l}function e(l){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.default,c={hasAlpha:{},encoders:{},decoders:{},class:{},constants:{}};function u(_){Object.entries(_).forEach(function(w){var S=(0,a.default)(w,2),C=S[0],E=S[1];c[C]=r({},c[C],{},E)})}function h(_){var w=_();Array.isArray(w.mime)?t.addType.apply(void 0,(0,n.default)(w.mime)):Object.entries(w.mime).forEach(function(S){return t.addType.apply(void 0,(0,n.default)(S))}),delete w.mime,u(w)}function p(_){var w=_(t.jimpEvChange)||{};!w.class&&!w.constants?u({class:w}):u(w)}return l.types&&(l.types.forEach(h),s.decoders=r({},s.decoders,{},c.decoders),s.encoders=r({},s.encoders,{},c.encoders),s.hasAlpha=r({},s.hasAlpha,{},c.hasAlpha)),l.plugins&&l.plugins.forEach(p),(0,t.addJimpMethods)(c.class,s),(0,t.addConstants)(c.constants,s),t.default}x.exports=g.default},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/interopRequireWildcard":12,"@babel/runtime/helpers/slicedToArray":19,"@babel/runtime/helpers/toConsumableArray":20,"@jimp/core":193}],200:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=b(m("@jimp/custom")),n=b(m("@jimp/types")),o=b(m("@jimp/plugins")),a=(0,f.default)({types:[n.default],plugins:[o.default]});g.default=a,x.exports=g.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/custom":199,"@jimp/plugins":228,"@jimp/types":234}],201:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=b(m("@babel/runtime/helpers/typeof")),n=m("@jimp/utils"),o=function(){return{blit:function(i,r,e,l,s,c,u,h){if(!(i instanceof this.constructor))return n.throwError.call(this,"The source must be a Jimp image",h);if(typeof r!="number"||typeof e!="number")return n.throwError.call(this,"x and y must be numbers",h);if(typeof l=="function")h=l,l=0,s=0,c=i.bitmap.width,u=i.bitmap.height;else if((0,f.default)(l)===(0,f.default)(s)&&(0,f.default)(s)===(0,f.default)(c)&&(0,f.default)(c)===(0,f.default)(u))l=l||0,s=s||0,c=c||i.bitmap.width,u=u||i.bitmap.height;else return n.throwError.call(this,"srcx, srcy, srcw, srch must be numbers",h);r=Math.round(r),e=Math.round(e),l=Math.round(l),s=Math.round(s),c=Math.round(c),u=Math.round(u);var p=this.bitmap.width,_=this.bitmap.height,w=this;return i.scanQuiet(l,s,c,u,function(S,C,E){var k=r+S-l,O=e+C-s;if(k>=0&&O>=0&&p-k>0&&_-O>0){var U=w.getPixelIndex(k,O),F={r:this.bitmap.data[E],g:this.bitmap.data[E+1],b:this.bitmap.data[E+2],a:this.bitmap.data[E+3]},M={r:w.bitmap.data[U],g:w.bitmap.data[U+1],b:w.bitmap.data[U+2],a:w.bitmap.data[U+3]};w.bitmap.data[U]=(F.a*(F.r-M.r)-M.r+255>>8)+M.r,w.bitmap.data[U+1]=(F.a*(F.g-M.g)-M.g+255>>8)+M.g,w.bitmap.data[U+2]=(F.a*(F.b-M.b)-M.b+255>>8)+M.b,w.bitmap.data[U+3]=this.constructor.limit255(M.a+F.a)}}),(0,n.isNodePattern)(h)&&h.call(this,null,this),this}}};g.default=o,x.exports=g.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235}],202:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.shgTable=g.mulTable=void 0;var b=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1];g.mulTable=b;var f=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18];g.shgTable=f},{}],203:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=m("./blur-tables"),n=function(){return{blur:function(t,i){if(typeof t!="number")return b.throwError.call(this,"r must be a number",i);if(t<1)return b.throwError.call(this,"r must be greater than 0",i);for(var r,e,l,s,c,u,h,p,_,w,S,C,E,k,O=this.bitmap.width-1,U=this.bitmap.height-1,F=t+1,M=f.mulTable[t],j=f.shgTable[t],G=[],N=[],R=[],A=[],H=[],Z=[],K=2;K-- >0;){for(C=0,E=0,u=0;u<this.bitmap.height;u++){for(r=this.bitmap.data[E]*F,e=this.bitmap.data[E+1]*F,l=this.bitmap.data[E+2]*F,s=this.bitmap.data[E+3]*F,h=1;h<=t;h++)p=E+((h>O?O:h)<<2),r+=this.bitmap.data[p++],e+=this.bitmap.data[p++],l+=this.bitmap.data[p++],s+=this.bitmap.data[p];for(c=0;c<this.bitmap.width;c++)G[C]=r,N[C]=e,R[C]=l,A[C]=s,u===0&&(H[c]=((p=c+F)<O?p:O)<<2,Z[c]=(p=c-t)>0?p<<2:0),_=E+H[c],w=E+Z[c],r+=this.bitmap.data[_++]-this.bitmap.data[w++],e+=this.bitmap.data[_++]-this.bitmap.data[w++],l+=this.bitmap.data[_++]-this.bitmap.data[w++],s+=this.bitmap.data[_]-this.bitmap.data[w],C++;E+=this.bitmap.width<<2}for(c=0;c<this.bitmap.width;c++){for(S=c,r=G[S]*F,e=N[S]*F,l=R[S]*F,s=A[S]*F,h=1;h<=t;h++)S+=h>U?0:this.bitmap.width,r+=G[S],e+=N[S],l+=R[S],s+=A[S];for(C=c<<2,u=0;u<this.bitmap.height;u++)k=s*M>>>j,this.bitmap.data[C+3]=k,k>255&&(this.bitmap.data[C+3]=255),k>0?(k=255/k,this.bitmap.data[C]=(r*M>>>j)*k,this.bitmap.data[C+1]=(e*M>>>j)*k,this.bitmap.data[C+2]=(l*M>>>j)*k):(this.bitmap.data[C+2]=0,this.bitmap.data[C+1]=0,this.bitmap.data[C]=0),c===0&&(H[u]=((p=u+F)<U?p:U)*this.bitmap.width,Z[u]=(p=u-t)>0?p*this.bitmap.width:0),_=c+H[u],w=c+Z[u],r+=G[_]-G[w],e+=N[_]-N[w],l+=R[_]-R[w],s+=A[_]-A[w],C+=this.bitmap.width<<2}}return(0,b.isNodePattern)(i)&&i.call(this,null,this),this}}};g.default=n,x.exports=g.default},{"./blur-tables":202,"@jimp/utils":235}],204:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{circle:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;typeof a=="function"&&(t=a,a={});var i=a.radius||(this.bitmap.width>this.bitmap.height?this.bitmap.height:this.bitmap.width)/2,r={x:typeof a.x=="number"?a.x:this.bitmap.width/2,y:typeof a.y=="number"?a.y:this.bitmap.height/2};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(e,l,s){var c=Math.sqrt(Math.pow(e-r.x,2)+Math.pow(l-r.y,2));i-c<=0?this.bitmap.data[s+3]=0:i-c<1&&(this.bitmap.data[s+3]=255*(i-c))}),(0,b.isNodePattern)(t)&&t.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],205:[function(m,x,g){(function(b){var f=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var n=f(m("@babel/runtime/helpers/toConsumableArray")),o=f(m("tinycolor2")),a=m("@jimp/utils");function t(c,u,h,p){for(var _=[0,0,0],w=(u.length-1)/2,S=0;S<u.length;S+=1)for(var C=0;C<u[S].length;C+=1){var E=c.getPixelIndex(h+S-w,p+C-w);_[0]+=c.bitmap.data[E]*u[S][C],_[1]+=c.bitmap.data[E+1]*u[S][C],_[2]+=c.bitmap.data[E+2]*u[S][C]}return _}var i=function(u){return typeof u<"u"&&u!==null};function r(c){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(u,h,p){var _=parseInt(.2126*this.bitmap.data[p]+.7152*this.bitmap.data[p+1]+.0722*this.bitmap.data[p+2],10);this.bitmap.data[p]=_,this.bitmap.data[p+1]=_,this.bitmap.data[p+2]=_}),(0,a.isNodePattern)(c)&&c.call(this,null,this),this}function e(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:50;return{r:(u.r-c.r)*(h/100)+c.r,g:(u.g-c.g)*(h/100)+c.g,b:(u.b-c.b)*(h/100)+c.b}}function l(c,u){var h=this;return!c||!Array.isArray(c)?a.throwError.call(this,"actions must be an array",u):(c=c.map(function(p){return(p.apply==="xor"||p.apply==="mix")&&(p.params[0]=(0,o.default)(p.params[0]).toRgb()),p}),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(p,_,w){var S={r:h.bitmap.data[w],g:h.bitmap.data[w+1],b:h.bitmap.data[w+2]},C=function(k,O){return h.constructor.limit255(S[k]+O)};c.forEach(function(E){if(E.apply==="mix")S=e(S,E.params[0],E.params[1]);else if(E.apply==="tint")S=e(S,{r:255,g:255,b:255},E.params[0]);else if(E.apply==="shade")S=e(S,{r:0,g:0,b:0},E.params[0]);else if(E.apply==="xor")S={r:S.r^E.params[0].r,g:S.g^E.params[0].g,b:S.b^E.params[0].b};else if(E.apply==="red")S.r=C("r",E.params[0]);else if(E.apply==="green")S.g=C("g",E.params[0]);else if(E.apply==="blue")S.b=C("b",E.params[0]);else{var k;if(E.apply==="hue"&&(E.apply="spin"),S=(0,o.default)(S),!S[E.apply])return a.throwError.call(h,"action "+E.apply+" not supported",u);S=(k=S)[E.apply].apply(k,(0,n.default)(E.params)).toRgb()}}),h.bitmap.data[w]=S.r,h.bitmap.data[w+1]=S.g,h.bitmap.data[w+2]=S.b}),(0,a.isNodePattern)(u)&&u.call(this,null,this),this)}var s=function(){return{brightness:function(h,p){return typeof h!="number"?a.throwError.call(this,"val must be numbers",p):h<-1||h>1?a.throwError.call(this,"val must be a number between -1 and +1",p):(this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(_,w,S){h<0?(this.bitmap.data[S]=this.bitmap.data[S]*(1+h),this.bitmap.data[S+1]=this.bitmap.data[S+1]*(1+h),this.bitmap.data[S+2]=this.bitmap.data[S+2]*(1+h)):(this.bitmap.data[S]=this.bitmap.data[S]+(255-this.bitmap.data[S])*h,this.bitmap.data[S+1]=this.bitmap.data[S+1]+(255-this.bitmap.data[S+1])*h,this.bitmap.data[S+2]=this.bitmap.data[S+2]+(255-this.bitmap.data[S+2])*h)}),(0,a.isNodePattern)(p)&&p.call(this,null,this),this)},contrast:function(h,p){if(typeof h!="number")return a.throwError.call(this,"val must be numbers",p);if(h<-1||h>1)return a.throwError.call(this,"val must be a number between -1 and +1",p);var _=(h+1)/(1-h);function w(S){return S=Math.floor(_*(S-127)+127),S<0?0:S>255?255:S}return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(S,C,E){this.bitmap.data[E]=w(this.bitmap.data[E]),this.bitmap.data[E+1]=w(this.bitmap.data[E+1]),this.bitmap.data[E+2]=w(this.bitmap.data[E+2])}),(0,a.isNodePattern)(p)&&p.call(this,null,this),this},posterize:function(h,p){return typeof h!="number"?a.throwError.call(this,"n must be numbers",p):(h<2&&(h=2),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(_,w,S){this.bitmap.data[S]=Math.floor(this.bitmap.data[S]/255*(h-1))/(h-1)*255,this.bitmap.data[S+1]=Math.floor(this.bitmap.data[S+1]/255*(h-1))/(h-1)*255,this.bitmap.data[S+2]=Math.floor(this.bitmap.data[S+2]/255*(h-1))/(h-1)*255}),(0,a.isNodePattern)(p)&&p.call(this,null,this),this)},greyscale:r,grayscale:r,opacity:function(h,p){return typeof h!="number"?a.throwError.call(this,"f must be a number",p):h<0||h>1?a.throwError.call(this,"f must be a number from 0 to 1",p):(this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(_,w,S){var C=this.bitmap.data[S+3]*h;this.bitmap.data[S+3]=C}),(0,a.isNodePattern)(p)&&p.call(this,null,this),this)},sepia:function(h){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(p,_,w){var S=this.bitmap.data[w],C=this.bitmap.data[w+1],E=this.bitmap.data[w+2];S=S*.393+C*.769+E*.189,C=S*.349+C*.686+E*.168,E=S*.272+C*.534+E*.131,this.bitmap.data[w]=S<255?S:255,this.bitmap.data[w+1]=C<255?C:255,this.bitmap.data[w+2]=E<255?E:255}),(0,a.isNodePattern)(h)&&h.call(this,null,this),this},fade:function(h,p){return typeof h!="number"?a.throwError.call(this,"f must be a number",p):h<0||h>1?a.throwError.call(this,"f must be a number from 0 to 1",p):(this.opacity(1-h),(0,a.isNodePattern)(p)&&p.call(this,null,this),this)},convolution:function(h,p,_){typeof p=="function"&&typeof _>"u"&&(_=p,p=null),p||(p=this.constructor.EDGE_EXTEND);var w=b.from(this.bitmap.data),S=h.length,C=h[0].length,E=Math.floor(S/2),k=Math.floor(C/2),O=-E,U=-k,F,M,j,G,N,R,A,H,Z,K;return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(J,D,I){G=0,j=0,M=0;for(var W=O;W<=E;W++)for(var q=U;q<=k;q++)H=J+q,Z=D+W,F=h[W+E][q+k],K=this.getPixelIndex(H,Z,p),K===-1?(A=0,R=0,N=0):(N=this.bitmap.data[K+0],R=this.bitmap.data[K+1],A=this.bitmap.data[K+2]),M+=F*N,j+=F*R,G+=F*A;M<0&&(M=0),j<0&&(j=0),G<0&&(G=0),M>255&&(M=255),j>255&&(j=255),G>255&&(G=255),w[I+0]=M,w[I+1]=j,w[I+2]=G}),this.bitmap.data=w,(0,a.isNodePattern)(_)&&_.call(this,null,this),this},opaque:function(h){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(p,_,w){this.bitmap.data[w+3]=255}),(0,a.isNodePattern)(h)&&h.call(this,null,this),this},pixelate:function(h,p,_,w,S,C){if(typeof p=="function")C=p,S=null,w=null,_=null,p=null;else{if(typeof h!="number")return a.throwError.call(this,"size must be a number",C);if(i(p)&&typeof p!="number")return a.throwError.call(this,"x must be a number",C);if(i(_)&&typeof _!="number")return a.throwError.call(this,"y must be a number",C);if(i(w)&&typeof w!="number")return a.throwError.call(this,"w must be a number",C);if(i(S)&&typeof S!="number")return a.throwError.call(this,"h must be a number",C)}var E=[[1/16,2/16,1/16],[2/16,4/16,2/16],[1/16,2/16,1/16]];p=p||0,_=_||0,w=i(w)?w:this.bitmap.width-p,S=i(S)?S:this.bitmap.height-_;var k=this.cloneQuiet();return this.scanQuiet(p,_,w,S,function(O,U,F){O=h*Math.floor(O/h),U=h*Math.floor(U/h);var M=t(k,E,O,U);this.bitmap.data[F]=M[0],this.bitmap.data[F+1]=M[1],this.bitmap.data[F+2]=M[2]}),(0,a.isNodePattern)(C)&&C.call(this,null,this),this},convolute:function(h,p,_,w,S,C){if(!Array.isArray(h))return a.throwError.call(this,"the kernel must be an array",C);if(typeof p=="function")C=p,p=null,_=null,w=null,S=null;else{if(i(p)&&typeof p!="number")return a.throwError.call(this,"x must be a number",C);if(i(_)&&typeof _!="number")return a.throwError.call(this,"y must be a number",C);if(i(w)&&typeof w!="number")return a.throwError.call(this,"w must be a number",C);if(i(S)&&typeof S!="number")return a.throwError.call(this,"h must be a number",C)}var E=(h.length-1)/2;p=i(p)?p:E,_=i(_)?_:E,w=i(w)?w:this.bitmap.width-p,S=i(S)?S:this.bitmap.height-_;var k=this.cloneQuiet();return this.scanQuiet(p,_,w,S,function(O,U,F){var M=t(k,h,O,U);this.bitmap.data[F]=this.constructor.limit255(M[0]),this.bitmap.data[F+1]=this.constructor.limit255(M[1]),this.bitmap.data[F+2]=this.constructor.limit255(M[2])}),(0,a.isNodePattern)(C)&&C.call(this,null,this),this},color:l,colour:l}};g.default=s,x.exports=g.default}).call(this,m("buffer").Buffer)},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/toConsumableArray":20,"@jimp/utils":235,buffer:48,tinycolor2:178}],206:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{contain:function(a,t,i,r,e){if(typeof a!="number"||typeof t!="number")return b.throwError.call(this,"w and h must be numbers",e);typeof i=="string"&&(typeof r=="function"&&typeof e>"u"&&(e=r),r=i,i=null),typeof i=="function"&&(typeof e>"u"&&(e=i),r=null,i=null),typeof r=="function"&&typeof e>"u"&&(e=r,r=null),i=i||this.constructor.HORIZONTAL_ALIGN_CENTER|this.constructor.VERTICAL_ALIGN_MIDDLE;var l=i&8-1,s=i>>3;if(!(l!==0&&!(l&l-1)||s!==0&&!(s&s-1)))return b.throwError.call(this,"only use one flag per alignment direction",e);var c=l>>1,u=s>>1,h=a/t>this.bitmap.width/this.bitmap.height?t/this.bitmap.height:a/this.bitmap.width,p=this.cloneQuiet().scale(h,r);return this.resize(a,t,r),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(_,w,S){this.bitmap.data.writeUInt32BE(this._background,S)}),this.blit(p,(this.bitmap.width-p.bitmap.width)/2*c,(this.bitmap.height-p.bitmap.height)/2*u),(0,b.isNodePattern)(e)&&e.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],207:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{cover:function(a,t,i,r,e){if(typeof a!="number"||typeof t!="number")return b.throwError.call(this,"w and h must be numbers",e);i&&typeof i=="function"&&typeof e>"u"?(e=i,i=null,r=null):typeof r=="function"&&typeof e>"u"&&(e=r,r=null),i=i||this.constructor.HORIZONTAL_ALIGN_CENTER|this.constructor.VERTICAL_ALIGN_MIDDLE;var l=i&8-1,s=i>>3;if(!(l!==0&&!(l&l-1)||s!==0&&!(s&s-1)))return b.throwError.call(this,"only use one flag per alignment direction",e);var c=l>>1,u=s>>1,h=a/t>this.bitmap.width/this.bitmap.height?a/this.bitmap.width:t/this.bitmap.height;return this.scale(h,r),this.crop((this.bitmap.width-a)/2*c,(this.bitmap.height-t)/2*u,a,t),(0,b.isNodePattern)(e)&&e.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],208:[function(m,x,g){(function(b){var f=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=a;var n=f(m("@babel/runtime/helpers/typeof")),o=m("@jimp/utils");function a(t){return t("crop",function(i,r,e,l,s){if(typeof i!="number"||typeof r!="number")return o.throwError.call(this,"x and y must be numbers",s);if(typeof e!="number"||typeof l!="number")return o.throwError.call(this,"w and h must be numbers",s);if(i=Math.round(i),r=Math.round(r),e=Math.round(e),l=Math.round(l),i===0&&e===this.bitmap.width){var c=e*r+i<<2,u=c+l*e<<2;this.bitmap.data=this.bitmap.data.slice(c,u)}else{var h=b.allocUnsafe(e*l*4),p=0;this.scanQuiet(i,r,e,l,function(_,w,S){var C=this.bitmap.data.readUInt32BE(S,!0);h.writeUInt32BE(C,p,!0),p+=4}),this.bitmap.data=h}return this.bitmap.width=e,this.bitmap.height=l,(0,o.isNodePattern)(s)&&s.call(this,null,this),this}),{class:{autocrop:function(){for(var r=this.bitmap.width,e=this.bitmap.height,l=1,s,c=0,u=2e-4,h=!0,p=!1,_=arguments.length,w=new Array(_),S=0;S<_;S++)w[S]=arguments[S];for(var C=0,E=w.length;C<E;C++)if(typeof w[C]=="number"&&(u=w[C]),typeof w[C]=="boolean"&&(h=w[C]),typeof w[C]=="function"&&(s=w[C]),(0,n.default)(w[C])==="object"){var k=w[C];typeof k.tolerance<"u"&&(u=k.tolerance),typeof k.cropOnlyFrames<"u"&&(h=k.cropOnlyFrames),typeof k.cropSymmetric<"u"&&(p=k.cropSymmetric),typeof k.leaveBorder<"u"&&(c=k.leaveBorder)}var O=this.getPixelColor(0,0),U=this.constructor.intToRGBA(O),F=0,M=0,j=0,G=0;O=this.getPixelColor(0,0);e:for(var N=0;N<e-l;N++){for(var R=0;R<r;R++){var A=this.getPixelColor(R,N),H=this.constructor.intToRGBA(A);if(this.constructor.colorDiff(U,H)>u)break e}F++}O=this.getPixelColor(r,0);e:for(var Z=0;Z<r-l;Z++){for(var K=0+F;K<e;K++){var J=this.getPixelColor(Z,K),D=this.constructor.intToRGBA(J);if(this.constructor.colorDiff(U,D)>u)break e}M++}O=this.getPixelColor(0,e);e:for(var I=e-1;I>=F+l;I--){for(var W=r-M-1;W>=0;W--){var q=this.getPixelColor(W,I),ne=this.constructor.intToRGBA(q);if(this.constructor.colorDiff(U,ne)>u)break e}j++}O=this.getPixelColor(r,e);e:for(var le=r-1;le>=0+M+l;le--){for(var ce=e-1;ce>=0+F;ce--){var fe=this.getPixelColor(le,ce),he=this.constructor.intToRGBA(fe);if(this.constructor.colorDiff(U,he)>u)break e}G++}var se=!1;if(G-=c,M-=c,F-=c,j-=c,p){var ie=Math.min(M,G),Q=Math.min(F,j);G=ie,M=ie,F=Q,j=Q}G=G>=0?G:0,M=M>=0?M:0,F=F>=0?F:0,j=j>=0?j:0;var re=r-(G+M),te=e-(j+F);return h?se=M!==0&&F!==0&&G!==0&&j!==0:se=M!==0||F!==0||G!==0||j!==0,se&&this.crop(M,F,re,te),(0,o.isNodePattern)(s)&&s.call(this,null,this),this}}}}x.exports=g.default}).call(this,m("buffer").Buffer)},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235,buffer:48}],209:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=b(m("@babel/runtime/helpers/typeof")),n=m("@jimp/utils"),o=function(){return{displace:function(i,r,e){if((0,f.default)(i)!=="object"||i.constructor!==this.constructor)return n.throwError.call(this,"The source must be a Jimp image",e);if(typeof r!="number")return n.throwError.call(this,"factor must be a number",e);var l=this.cloneQuiet();return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(s,c,u){var h=i.bitmap.data[u]/256*r;h=Math.round(h);var p=this.getPixelIndex(s+h,c);this.bitmap.data[p]=l.bitmap.data[u],this.bitmap.data[p+1]=l.bitmap.data[u+1],this.bitmap.data[p+2]=l.bitmap.data[u+2]}),(0,n.isNodePattern)(e)&&e.call(this,null,this),this}}};g.default=o,x.exports=g.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235}],210:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils");function f(o){var a=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(t,i,r){var e=((i&3)<<2)+t%4,l=a[e];this.bitmap.data[r]=Math.min(this.bitmap.data[r]+l,255),this.bitmap.data[r+1]=Math.min(this.bitmap.data[r+1]+l,255),this.bitmap.data[r+2]=Math.min(this.bitmap.data[r+2]+l,255)}),(0,b.isNodePattern)(o)&&o.call(this,null,this),this}var n=function(){return{dither565:f,dither16:f}};g.default=n,x.exports=g.default},{"@jimp/utils":235}],211:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{fisheye:function(){var a=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{r:2.5},i=arguments.length>1?arguments[1]:void 0;typeof t=="function"&&(i=t,t={r:2.5});var r=this.cloneQuiet(),e=r.bitmap,l=e.width,s=e.height;return r.scanQuiet(0,0,l,s,function(c,u){var h=c/l,p=u/s,_=Math.sqrt(Math.pow(h-.5,2)+Math.pow(p-.5,2)),w=2*Math.pow(_,t.r),S=(h-.5)/_,C=(p-.5)/_,E=Math.round((w*S+.5)*l),k=Math.round((w*C+.5)*s),O=r.getPixelColor(E,k);a.setPixelColor(O,c,u)}),this.setPixelColor(r.getPixelColor(l/2,s/2),l/2,s/2),(0,b.isNodePattern)(i)&&i.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],212:[function(m,x,g){(function(b){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=m("@jimp/utils");function n(a,t,i){if(typeof a!="boolean"||typeof t!="boolean")return f.throwError.call(this,"horizontal and vertical must be Booleans",i);var r=b.alloc(this.bitmap.data.length);return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(e,l,s){var c=a?this.bitmap.width-1-e:e,u=t?this.bitmap.height-1-l:l,h=this.bitmap.width*u+c<<2,p=this.bitmap.data.readUInt32BE(s);r.writeUInt32BE(p,h)}),this.bitmap.data=b.from(r),(0,f.isNodePattern)(i)&&i.call(this,null,this),this}var o=function(){return{flip:n,mirror:n}};g.default=o,x.exports=g.default}).call(this,m("buffer").Buffer)},{"@jimp/utils":235,buffer:48}],213:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{gaussian:function(a,t){if(typeof a!="number")return b.throwError.call(this,"r must be a number",t);if(a<1)return b.throwError.call(this,"r must be greater than 0",t);for(var i=Math.ceil(a*2.57),r=i*2+1,e=a*a*2,l=e*Math.PI,s=[],c=0;c<r;c++){s[c]=[];for(var u=0;u<r;u++){var h=Math.pow(u-i,2)+Math.pow(c-i,2);s[c][u]=Math.exp(-h/e)/l}}for(var p=0;p<this.bitmap.height;p++)for(var _=0;_<this.bitmap.width;_++)for(var w=0,S=0,C=0,E=0,k=0,O=0;O<r;O++){for(var U=0;U<r;U++){var F=Math.min(this.bitmap.width-1,Math.max(0,U+_-i)),M=Math.min(this.bitmap.height-1,Math.max(0,O+p-i)),j=s[O][U],G=M*this.bitmap.width+F<<2;w+=this.bitmap.data[G]*j,S+=this.bitmap.data[G+1]*j,C+=this.bitmap.data[G+2]*j,E+=this.bitmap.data[G+3]*j,k+=j}var N=p*this.bitmap.width+_<<2;this.bitmap.data[N]=Math.round(w/k),this.bitmap.data[N+1]=Math.round(S/k),this.bitmap.data[N+2]=Math.round(C/k),this.bitmap.data[N+3]=Math.round(E/k)}return(0,b.isNodePattern)(t)&&t.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],214:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{invert:function(a){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(t,i,r){this.bitmap.data[r]=255-this.bitmap.data[r],this.bitmap.data[r+1]=255-this.bitmap.data[r+1],this.bitmap.data[r+2]=255-this.bitmap.data[r+2]}),(0,b.isNodePattern)(a)&&a.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],215:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{mask:function(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;if(!(a instanceof this.constructor))return b.throwError.call(this,"The source must be a Jimp image",r);if(typeof t!="number"||typeof i!="number")return b.throwError.call(this,"x and y must be numbers",r);t=Math.round(t),i=Math.round(i);var e=this.bitmap.width,l=this.bitmap.height,s=this;return a.scanQuiet(0,0,a.bitmap.width,a.bitmap.height,function(c,u,h){var p=t+c,_=i+u;if(p>=0&&_>=0&&p<e&&_<l){var w=s.getPixelIndex(p,_),S=this.bitmap.data,C=(S[h+0]+S[h+1]+S[h+2])/3;s.bitmap.data[w+3]*=C/255}}),(0,b.isNodePattern)(r)&&r.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],216:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils");function f(){var t={r:new Array(256).fill(0),g:new Array(256).fill(0),b:new Array(256).fill(0)};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(i,r,e){t.r[this.bitmap.data[e+0]]++,t.g[this.bitmap.data[e+1]]++,t.b[this.bitmap.data[e+2]]++}),t}var n=function(i,r,e){return(i-r)*255/(e-r)},o=function(i){return[i.findIndex(function(r){return r>0}),255-i.slice().reverse().findIndex(function(r){return r>0})]},a=function(){return{normalize:function(r){var e=f.call(this),l={r:o(e.r),g:o(e.g),b:o(e.b)};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(s,c,u){var h=this.bitmap.data[u+0],p=this.bitmap.data[u+1],_=this.bitmap.data[u+2];this.bitmap.data[u+0]=n(h,l.r[0],l.r[1]),this.bitmap.data[u+1]=n(p,l.g[0],l.g[1]),this.bitmap.data[u+2]=n(_,l.b[0],l.b[1])}),(0,b.isNodePattern)(r)&&r.call(this,null,this),this}}};g.default=a,x.exports=g.default},{"@jimp/utils":235}],217:[function(m,x,g){(function(b){var f=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var n=f(m("@babel/runtime/helpers/typeof")),o=f(m("@babel/runtime/helpers/toConsumableArray")),a=f(m("path")),t=f(m("load-bmfont")),i=m("@jimp/utils"),r=m("./measure-text");function e(_,w,S,C,E){return E===_.HORIZONTAL_ALIGN_LEFT?0:E===_.HORIZONTAL_ALIGN_CENTER?(C-(0,r.measureText)(w,S))/2:C-(0,r.measureText)(w,S)}function l(_,w,S,C,E){if(E.width>0&&E.height>0){var k=w.pages[E.page];_.blit(k,S+E.xoffset,C+E.yoffset,E.x,E.y,E.width,E.height)}return _}function s(_,w,S,C,E){for(var k=0;k<C.length;k++){var O=void 0;_.chars[C[k]]?O=C[k]:/\s/.test(C[k])?O="":O="?";var U=_.chars[O]||{},F=_.kernings[O];l(this,_,w,S,U||{});var M=F&&F[C[k+1]]?F[C[k+1]]:0;w+=M+(U.xadvance||E)}}function c(_,w,S){var C=w.split(" "),E=[],k=[],O=0;return C.forEach(function(U){var F=[].concat((0,o.default)(k),[U]).join(" "),M=(0,r.measureText)(_,F);M<=S?(M>O&&(O=M),k.push(U)):(E.push(k),k=[U])}),E.push(k),{lines:E,longestLine:O}}function u(_,w,S){var C=S.map(function(E){return _.read(w+"/"+E)});return Promise.all(C)}var h="browser/lib/",p=function(){return{constants:{measureText:r.measureText,measureTextHeight:r.measureTextHeight,FONT_SANS_8_BLACK:a.default.join(h,"fonts/open-sans/open-sans-8-black/open-sans-8-black.fnt"),FONT_SANS_10_BLACK:a.default.join(h,"fonts/open-sans/open-sans-10-black/open-sans-10-black.fnt"),FONT_SANS_12_BLACK:a.default.join(h,"fonts/open-sans/open-sans-12-black/open-sans-12-black.fnt"),FONT_SANS_14_BLACK:a.default.join(h,"fonts/open-sans/open-sans-14-black/open-sans-14-black.fnt"),FONT_SANS_16_BLACK:a.default.join(h,"fonts/open-sans/open-sans-16-black/open-sans-16-black.fnt"),FONT_SANS_32_BLACK:a.default.join(h,"fonts/open-sans/open-sans-32-black/open-sans-32-black.fnt"),FONT_SANS_64_BLACK:a.default.join(h,"fonts/open-sans/open-sans-64-black/open-sans-64-black.fnt"),FONT_SANS_128_BLACK:a.default.join(h,"fonts/open-sans/open-sans-128-black/open-sans-128-black.fnt"),FONT_SANS_8_WHITE:a.default.join(h,"fonts/open-sans/open-sans-8-white/open-sans-8-white.fnt"),FONT_SANS_16_WHITE:a.default.join(h,"fonts/open-sans/open-sans-16-white/open-sans-16-white.fnt"),FONT_SANS_32_WHITE:a.default.join(h,"fonts/open-sans/open-sans-32-white/open-sans-32-white.fnt"),FONT_SANS_64_WHITE:a.default.join(h,"fonts/open-sans/open-sans-64-white/open-sans-64-white.fnt"),FONT_SANS_128_WHITE:a.default.join(h,"fonts/open-sans/open-sans-128-white/open-sans-128-white.fnt"),loadFont:function(S,C){var E=this;return typeof S!="string"?i.throwError.call(this,"file must be a string",C):new Promise(function(k,O){C=C||function(U,F){U?O(U):k(F)},(0,t.default)(S,function(U,F){var M={},j={};if(U)return i.throwError.call(E,U,C);for(var G=0;G<F.chars.length;G++)M[String.fromCharCode(F.chars[G].id)]=F.chars[G];for(var N=0;N<F.kernings.length;N++){var R=String.fromCharCode(F.kernings[N].first);j[R]=j[R]||{},j[R][String.fromCharCode(F.kernings[N].second)]=F.kernings[N].amount}u(E,a.default.dirname(S),F.pages).then(function(A){C(null,{chars:M,kernings:j,pages:A,common:F.common,info:F.info})})})})}},class:{print:function(S,C,E,k,O,U,F){var M=this;if(typeof O=="function"&&typeof F>"u"&&(F=O,O=1/0),typeof O>"u"&&(O=1/0),typeof U=="function"&&typeof F>"u"&&(F=U,U=1/0),typeof U>"u"&&(U=1/0),(0,n.default)(S)!=="object")return i.throwError.call(this,"font must be a Jimp loadFont",F);if(typeof C!="number"||typeof E!="number"||typeof O!="number")return i.throwError.call(this,"x, y and maxWidth must be numbers",F);if(typeof O!="number")return i.throwError.call(this,"maxWidth must be a number",F);if(typeof U!="number")return i.throwError.call(this,"maxHeight must be a number",F);var j,G;if((0,n.default)(k)==="object"&&k.text!==null&&k.text!==void 0){j=k.alignmentX||this.constructor.HORIZONTAL_ALIGN_LEFT,G=k.alignmentY||this.constructor.VERTICAL_ALIGN_TOP;var N=k;k=N.text}else j=this.constructor.HORIZONTAL_ALIGN_LEFT,G=this.constructor.VERTICAL_ALIGN_TOP,k=k.toString();U!==1/0&&G===this.constructor.VERTICAL_ALIGN_BOTTOM?E+=U-(0,r.measureTextHeight)(S,k,O):U!==1/0&&G===this.constructor.VERTICAL_ALIGN_MIDDLE&&(E+=U/2-(0,r.measureTextHeight)(S,k,O)/2);var R=Object.entries(S.chars)[0][1].xadvance,A=c(S,k,O),H=A.lines,Z=A.longestLine;return H.forEach(function(K){var J=K.join(" "),D=e(M.constructor,S,J,O,j);s.call(M,S,C+D,E,J,R),E+=S.common.lineHeight}),(0,i.isNodePattern)(F)&&F.call(this,null,this,{x:C+Z,y:E}),this}}}};g.default=p,x.exports=g.default}).call(this,"/../../node_modules/@jimp/plugin-print/dist")},{"./measure-text":218,"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/toConsumableArray":20,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235,"load-bmfont":219,path:107}],218:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.measureText=b,g.measureTextHeight=f;function b(n,o){for(var a=0,t=0;t<o.length;t++)if(n.chars[o[t]]){var i=n.kernings[o[t]]&&n.kernings[o[t]][o[t+1]]?n.kernings[o[t]][o[t+1]]:0;a+=(n.chars[o[t]].xadvance||0)+i}return a}function f(n,o,a){for(var t=o.split(" "),i="",r=n.common.lineHeight,e=0;e<t.length;e++){var l=i+t[e]+" ",s=b(n,l);s>a&&e>0?(r+=n.common.lineHeight,i=t[e]+" "):i=l}return r}},{}],219:[function(m,x,g){(function(b){var f=m("xhr"),n=function(){},o=m("parse-bmfont-ascii"),a=m("parse-bmfont-xml"),t=m("parse-bmfont-binary"),i=m("./lib/is-binary"),r=m("xtend"),e=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();x.exports=function(c,u){u=typeof u=="function"?u:n,typeof c=="string"?c={uri:c}:c||(c={});var h=c.binary;h&&(c=s(c)),f(c,function(p,_,w){if(p)return u(p);if(!/^2/.test(_.statusCode))return u(new Error("http status code: "+_.statusCode));if(!w)return u(new Error("no body result"));var S=!1;if(l(w)){var C=new Uint8Array(w);w=new b(C,"binary")}i(w)&&(S=!0,typeof w=="string"&&(w=new b(w,"binary"))),S||(b.isBuffer(w)&&(w=w.toString(c.encoding)),w=w.trim());var E;try{var k=_.headers["content-type"];S?E=t(w):/json/.test(k)||w.charAt(0)==="{"?E=JSON.parse(w):/xml/.test(k)||w.charAt(0)==="<"?E=a(w):E=o(w)}catch(O){u(new Error("error parsing font "+O.message)),u=n}u(null,E)})};function l(c){var u=Object.prototype.toString;return u.call(c)==="[object ArrayBuffer]"}function s(c){if(e)return r(c,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var u=new self.XMLHttpRequest;return u.overrideMimeType("text/plain; charset=x-user-defined"),r({xhr:u},c)}}).call(this,m("buffer").Buffer)},{"./lib/is-binary":220,buffer:48,"parse-bmfont-ascii":102,"parse-bmfont-binary":103,"parse-bmfont-xml":104,xhr:187,xtend:189}],220:[function(m,x,g){(function(b){var f=m("buffer-equal"),n=new b([66,77,70,3]);x.exports=function(o){return typeof o=="string"?o.substring(0,3)==="BMF":o.length>4&&f(o.slice(0,4),n)}}).call(this,m("buffer").Buffer)},{buffer:48,"buffer-equal":49}],221:[function(m,x,g){(function(b){var f=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var n=m("@jimp/utils"),o=f(m("./modules/resize")),a=f(m("./modules/resize2")),t=function(){return{constants:{RESIZE_NEAREST_NEIGHBOR:"nearestNeighbor",RESIZE_BILINEAR:"bilinearInterpolation",RESIZE_BICUBIC:"bicubicInterpolation",RESIZE_HERMITE:"hermiteInterpolation",RESIZE_BEZIER:"bezierInterpolation"},class:{resize:function(e,l,s,c){if(typeof e!="number"||typeof l!="number")return n.throwError.call(this,"w and h must be numbers",c);if(typeof s=="function"&&typeof c>"u"&&(c=s,s=null),e===this.constructor.AUTO&&l===this.constructor.AUTO)return n.throwError.call(this,"w and h cannot both be set to auto",c);if(e===this.constructor.AUTO&&(e=this.bitmap.width*(l/this.bitmap.height)),l===this.constructor.AUTO&&(l=this.bitmap.height*(e/this.bitmap.width)),e<0||l<0)return n.throwError.call(this,"w and h must be positive numbers",c);if(e=Math.round(e),l=Math.round(l),typeof a.default[s]=="function"){var u={data:b.alloc(e*l*4),width:e,height:l};a.default[s](this.bitmap,u),this.bitmap=u}else{var h=this,p=new o.default(this.bitmap.width,this.bitmap.height,e,l,!0,!0,function(_){h.bitmap.data=b.from(_),h.bitmap.width=e,h.bitmap.height=l});p.resize(this.bitmap.data)}return(0,n.isNodePattern)(c)&&c.call(this,null,this),this}}}};g.default=t,x.exports=g.default}).call(this,m("buffer").Buffer)},{"./modules/resize":222,"./modules/resize2":223,"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/utils":235,buffer:48}],222:[function(m,x,g){function b(f,n,o,a,t,i,r){this.widthOriginal=Math.abs(Math.floor(f)||0),this.heightOriginal=Math.abs(Math.floor(n)||0),this.targetWidth=Math.abs(Math.floor(o)||0),this.targetHeight=Math.abs(Math.floor(a)||0),this.colorChannels=t?4:3,this.interpolationPass=!!i,this.resizeCallback=typeof r=="function"?r:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}b.prototype.initialize=function(){if(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0)this.configurePasses();else throw new Error("Invalid settings specified for the resizer.")},b.prototype.configurePasses=function(){this.widthOriginal===this.targetWidth?this.resizeWidth=this.bypassResizer:(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass?(this.initializeFirstPassBuffers(!0),this.resizeWidth=this.colorChannels===4?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB):(this.initializeFirstPassBuffers(!1),this.resizeWidth=this.colorChannels===4?this.resizeWidthRGBA:this.resizeWidthRGB)),this.heightOriginal===this.targetHeight?this.resizeHeight=this.bypassResizer:(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass?(this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated):(this.initializeSecondPassBuffers(!1),this.resizeHeight=this.colorChannels===4?this.resizeHeightRGBA:this.resizeHeightRGB))},b.prototype._resizeWidthInterpolatedRGBChannels=function(f,n){var o=n?4:3,a=this.ratioWeightWidthPass,t=this.widthBuffer,i=0,r=0,e=0,l=0,s=0,c;for(c=0;i<1/3;c+=o,i+=a)for(r=c,e=0;r<this.widthPassResultSize;e+=this.originalWidthMultipliedByChannels,r+=this.targetWidthMultipliedByChannels)t[r]=f[e],t[r+1]=f[e+1],t[r+2]=f[e+2],n&&(t[r+3]=f[e+3]);i-=1/3;var u;for(u=this.widthOriginal-1;i<u;c+=o,i+=a)for(s=i%1,l=1-s,r=c,e=Math.floor(i)*o;r<this.widthPassResultSize;e+=this.originalWidthMultipliedByChannels,r+=this.targetWidthMultipliedByChannels)t[r+0]=f[e+0]*l+f[e+o+0]*s,t[r+1]=f[e+1]*l+f[e+o+1]*s,t[r+2]=f[e+2]*l+f[e+o+2]*s,n&&(t[r+3]=f[e+3]*l+f[e+o+3]*s);for(u=this.originalWidthMultipliedByChannels-o;c<this.targetWidthMultipliedByChannels;c+=o)for(r=c,e=u;r<this.widthPassResultSize;e+=this.originalWidthMultipliedByChannels,r+=this.targetWidthMultipliedByChannels)t[r]=f[e],t[r+1]=f[e+1],t[r+2]=f[e+2],n&&(t[r+3]=f[e+3]);return t},b.prototype._resizeWidthRGBChannels=function(f,n){var o=n?4:3,a=this.ratioWeightWidthPass,t=1/a,i=this.originalWidthMultipliedByChannels-o+1,r=this.targetWidthMultipliedByChannels-o+1,e=this.outputWidthWorkBench,l=this.widthBuffer,s=this.outputWidthWorkBenchOpaquePixelsCount,c=0,u=0,h=0,p=0,_=0,w=0,S=0,C=1,E=0,k=0,O=0,U=0;do{for(_=0;_<this.originalHeightMultipliedByChannels;)e[_++]=0,e[_++]=0,e[_++]=0,n&&(e[_++]=0,s[_/o-1]=0);c=a;do{for(u=1+h-p,C=Math.min(c,u),_=0,w=h;_<this.originalHeightMultipliedByChannels;w+=i)E=f[w],k=f[++w],O=f[++w],U=n?f[++w]:255,e[_++]+=(U?E:0)*C,e[_++]+=(U?k:0)*C,e[_++]+=(U?O:0)*C,n&&(e[_++]+=U*C,s[_/o-1]+=U?C:0);if(c>=u)h+=o,p=h,c-=u;else{p+=c;break}}while(c>0&&h<this.originalWidthMultipliedByChannels);for(_=0,w=S;_<this.originalHeightMultipliedByChannels;w+=r)c=n?s[_/o]:1,C=n?c?1/c:0:t,l[w]=e[_++]*C,l[++w]=e[_++]*C,l[++w]=e[_++]*C,n&&(l[++w]=e[_++]*t);S+=o}while(S<this.targetWidthMultipliedByChannels);return l},b.prototype._resizeHeightRGBChannels=function(f,n){var o=this.ratioWeightHeightPass,a=1/o,t=this.outputHeightWorkBench,i=this.heightBuffer,r=this.outputHeightWorkBenchOpaquePixelsCount,e=0,l=0,s=0,c=0,u=0,h=0,p=0,_=1,w=0,S=0,C=0,E=0;do{for(u=0;u<this.targetWidthMultipliedByChannels;)t[u++]=0,t[u++]=0,t[u++]=0,n&&(t[u++]=0,r[u/4-1]=0);e=o;do{for(l=1+s-c,_=Math.min(e,l),p=s,u=0;u<this.targetWidthMultipliedByChannels;)w=f[p++],S=f[p++],C=f[p++],E=n?f[p++]:255,t[u++]+=(E?w:0)*_,t[u++]+=(E?S:0)*_,t[u++]+=(E?C:0)*_,n&&(t[u++]+=E*_,r[u/4-1]+=E?_:0);if(e>=l)s=p,c=s,e-=l;else{c+=e;break}}while(e>0&&s<this.widthPassResultSize);for(u=0;u<this.targetWidthMultipliedByChannels;)e=n?r[u/4]:1,_=n?e?1/e:0:a,i[h++]=Math.round(t[u++]*_),i[h++]=Math.round(t[u++]*_),i[h++]=Math.round(t[u++]*_),n&&(i[h++]=Math.round(t[u++]*a))}while(h<this.finalResultSize);return i},b.prototype.resizeWidthInterpolatedRGB=function(f){return this._resizeWidthInterpolatedRGBChannels(f,!1)},b.prototype.resizeWidthInterpolatedRGBA=function(f){return this._resizeWidthInterpolatedRGBChannels(f,!0)},b.prototype.resizeWidthRGB=function(f){return this._resizeWidthRGBChannels(f,!1)},b.prototype.resizeWidthRGBA=function(f){return this._resizeWidthRGBChannels(f,!0)},b.prototype.resizeHeightInterpolated=function(f){for(var n=this.ratioWeightHeightPass,o=this.heightBuffer,a=0,t=0,i=0,r=0,e=0,l=0,s=0,c;a<1/3;a+=n)for(i=0;i<this.targetWidthMultipliedByChannels;)o[t++]=Math.round(f[i++]);for(a-=1/3,c=this.heightOriginal-1;a<c;a+=n)for(s=a%1,l=1-s,r=Math.floor(a)*this.targetWidthMultipliedByChannels,e=r+this.targetWidthMultipliedByChannels,i=0;i<this.targetWidthMultipliedByChannels;++i)o[t++]=Math.round(f[r++]*l+f[e++]*s);for(;t<this.finalResultSize;)for(i=0,r=c*this.targetWidthMultipliedByChannels;i<this.targetWidthMultipliedByChannels;++i)o[t++]=Math.round(f[r++]);return o},b.prototype.resizeHeightRGB=function(f){return this._resizeHeightRGBChannels(f,!1)},b.prototype.resizeHeightRGBA=function(f){return this._resizeHeightRGBChannels(f,!0)},b.prototype.resize=function(f){this.resizeCallback(this.resizeHeight(this.resizeWidth(f)))},b.prototype.bypassResizer=function(f){return f},b.prototype.initializeFirstPassBuffers=function(f){this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),f||(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3&&(this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)))},b.prototype.initializeSecondPassBuffers=function(f){this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),f||(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3&&(this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)))},b.prototype.generateFloatBuffer=function(f){try{return new Float32Array(f)}catch(n){return[]}},b.prototype.generateFloat64Buffer=function(f){try{return new Float64Array(f)}catch(n){return[]}},b.prototype.generateUint8Buffer=function(f){try{return new Uint8Array(f)}catch(n){return[]}},x.exports=b},{}],223:[function(m,x,g){(function(b){x.exports={nearestNeighbor:function(n,o){for(var a=n.width,t=n.height,i=o.width,r=o.height,e=n.data,l=o.data,s=0;s<r;s++)for(var c=0;c<i;c++){var u=(s*i+c)*4,h=Math.floor(s*t/r),p=Math.floor(c*a/i),_=(h*a+p)*4;l[u++]=e[_++],l[u++]=e[_++],l[u++]=e[_++],l[u++]=e[_++]}},bilinearInterpolation:function(n,o){for(var a=n.width,t=n.height,i=o.width,r=o.height,e=n.data,l=o.data,s=function(U,F,M,j,G){return F===j?M:Math.round((U-F)*G+(j-U)*M)},c=function(U,F,M,j,G,N,R,A){var H=(R*a+j)*4+F,Z=(R*a+G)*4+F,K=s(M,j,e[H],G,e[Z]);if(A===R)l[U+F]=K;else{H=(A*a+j)*4+F,Z=(A*a+G)*4+F;var J=s(M,j,e[H],G,e[Z]);l[U+F]=s(N,R,K,A,J)}},u=0;u<r;u++)for(var h=0;h<i;h++){var p=(u*i+h)*4,_=h*a/i,w=Math.floor(_),S=Math.min(Math.ceil(_),a-1),C=u*t/r,E=Math.floor(C),k=Math.min(Math.ceil(C),t-1);c(p,0,_,w,S,C,E,k),c(p,1,_,w,S,C,E,k),c(p,2,_,w,S,C,E,k),c(p,3,_,w,S,C,E,k)}},_interpolate2D:function(n,o,a,t){for(var i=n.data,r=o.data,e=n.width,l=n.height,s=o.width,c=o.height,u=Math.max(1,Math.floor(e/s)),h=s*u,p=Math.max(1,Math.floor(l/c)),_=c*p,w=b.alloc(h*l*4),S=0;S<l;S++)for(var C=0;C<h;C++)for(var E=C*(e-1)/h,k=Math.floor(E),O=E-k,U=(S*e+k)*4,F=(S*h+C)*4,M=0;M<4;M++){var j=U+M,G=k>0?i[j-4]:2*i[j]-i[j+4],N=i[j],R=i[j+4],A=k<e-2?i[j+8]:2*i[j+4]-i[j];w[F+M]=t(G,N,R,A,O)}for(var H=b.alloc(h*_*4),Z=0;Z<_;Z++)for(var K=0;K<h;K++)for(var J=Z*(l-1)/_,D=Math.floor(J),I=J-D,W=(D*h+K)*4,q=(Z*h+K)*4,ne=0;ne<4;ne++){var le=W+ne,ce=D>0?w[le-h*4]:2*w[le]-w[le+h*4],fe=w[le],he=w[le+h*4],se=D<l-2?w[le+h*8]:2*w[le+h*4]-w[le];H[q+ne]=t(ce,fe,he,se,I)}var ie=u*p;if(ie>1)for(var Q=0;Q<c;Q++)for(var re=0;re<s;re++){for(var te=0,V=0,z=0,B=0,ee=0,Y=0;Y<p;Y++)for(var L=Q*p+Y,P=0;P<u;P++){var ae=re*u+P,ue=(L*h+ae)*4,ve=H[ue+3];ve&&(te+=H[ue],V+=H[ue+1],z+=H[ue+2],ee++),B+=ve}var _e=(Q*s+re)*4;r[_e]=ee?Math.round(te/ee):0,r[_e+1]=ee?Math.round(V/ee):0,r[_e+2]=ee?Math.round(z/ee):0,r[_e+3]=Math.round(B/ie)}else o.data=H},bicubicInterpolation:function(n,o,a){var t=function(r,e,l,s,c){var u=s-l-r+e,h=r-e-u,p=l-r,_=e;return Math.max(0,Math.min(255,u*(c*c*c)+h*(c*c)+p*c+_))};return this._interpolate2D(n,o,a,t)},hermiteInterpolation:function(n,o,a){var t=function(r,e,l,s,c){var u=e,h=.5*(l-r),p=r-2.5*e+2*l-.5*s,_=.5*(s-r)+1.5*(e-l);return Math.max(0,Math.min(255,Math.round(((_*c+p)*c+h)*c+u)))};return this._interpolate2D(n,o,a,t)},bezierInterpolation:function(n,o,a){var t=function(r,e,l,s,c){var u=e+(l-r)/4,h=l-(s-e)/4,p=1-c,_=e*p*p*p,w=3*u*p*p*c,S=3*h*p*c*c,C=l*c*c*c;return Math.max(0,Math.min(255,Math.round(_+w+S+C)))};return this._interpolate2D(n,o,a,t)}}}).call(this,m("buffer").Buffer)},{buffer:48}],224:[function(m,x,g){(function(b){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=m("@jimp/utils");function n(a,t){a%=360;var i=a*Math.PI/180,r=Math.cos(i),e=Math.sin(i),l=this.bitmap.width,s=this.bitmap.height;if(t===!0||typeof t=="string"){l=Math.ceil(Math.abs(this.bitmap.width*r)+Math.abs(this.bitmap.height*e))+1,s=Math.ceil(Math.abs(this.bitmap.width*e)+Math.abs(this.bitmap.height*r))+1,l%2!==0&&l++,s%2!==0&&s++;var c=this.cloneQuiet();this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(R,A,H){this.bitmap.data.writeUInt32BE(this._background,H)});var u=Math.max(l,s,this.bitmap.width,this.bitmap.height);this.resize(u,u,t),this.blit(c,this.bitmap.width/2-c.bitmap.width/2,this.bitmap.height/2-c.bitmap.height/2)}var h=this.bitmap.width,p=this.bitmap.height,_=b.alloc(this.bitmap.data.length);function w(R,A){return function(H,Z){return{x:H+R,y:Z+A}}}for(var S=w(-(h/2),-(p/2)),C=w(h/2+.5,p/2+.5),E=1;E<=p;E++)for(var k=1;k<=h;k++){var O=S(k,E),U=C(r*O.x-e*O.y,r*O.y+e*O.x),F=h*(E-1)+k-1<<2;if(U.x>=0&&U.x<h&&U.y>=0&&U.y<p){var M=(h*(U.y|0)+U.x|0)<<2,j=this.bitmap.data.readUInt32BE(M);_.writeUInt32BE(j,F)}else _.writeUInt32BE(this._background,F)}if(this.bitmap.data=_,t===!0||typeof t=="string"){var G=h/2-l/2,N=p/2-s/2;this.crop(G,N,l,s)}}var o=function(){return{rotate:function(i,r,e){return(typeof r>"u"||r===null)&&(r=!0),typeof r=="function"&&typeof e>"u"&&(e=r,r=!0),typeof i!="number"?f.throwError.call(this,"deg must be a number",e):typeof r!="boolean"&&typeof r!="string"?f.throwError.call(this,"mode must be a boolean or a string",e):(n.call(this,i,r,e),(0,f.isNodePattern)(e)&&e.call(this,null,this),this)}}};g.default=o,x.exports=g.default}).call(this,m("buffer").Buffer)},{"@jimp/utils":235,buffer:48}],225:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{scale:function(a,t,i){if(typeof a!="number")return b.throwError.call(this,"f must be a number",i);if(a<0)return b.throwError.call(this,"f must be a positive number",i);typeof t=="function"&&typeof i>"u"&&(i=t,t=null);var r=this.bitmap.width*a,e=this.bitmap.height*a;return this.resize(r,e,t),(0,b.isNodePattern)(i)&&i.call(this,null,this),this},scaleToFit:function(a,t,i,r){if(typeof a!="number"||typeof t!="number")return b.throwError.call(this,"w and h must be numbers",r);typeof i=="function"&&typeof r>"u"&&(r=i,i=null);var e=a/t>this.bitmap.width/this.bitmap.height?t/this.bitmap.height:a/this.bitmap.width;return this.scale(e,i),(0,b.isNodePattern)(r)&&r.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],226:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{shadow:function(){var a=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;typeof t=="function"&&(i=t,t={});var r=t,e=r.opacity,l=e===void 0?.7:e,s=r.size,c=s===void 0?1.1:s,u=r.x,h=u===void 0?-25:u,p=r.y,_=p===void 0?25:p,w=r.blur,S=w===void 0?5:w,C=this.clone(),E=this.clone();return E.scan(0,0,E.bitmap.width,E.bitmap.height,function(k,O,U){E.bitmap.data[U]=0,E.bitmap.data[U+1]=0,E.bitmap.data[U+2]=0,E.bitmap.data[U+3]=E.constructor.limit255(E.bitmap.data[U+3]*l),a.bitmap.data[U]=0,a.bitmap.data[U+1]=0,a.bitmap.data[U+2]=0,a.bitmap.data[U+3]=0}),E.resize(E.bitmap.width*c,E.bitmap.height*c).blur(S),this.composite(E,h,_),this.composite(C,0,0),(0,b.isNodePattern)(i)&&i.call(this,null,this),this}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],227:[function(m,x,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=m("@jimp/utils"),f=function(){return{threshold:function(a,t){var i=this,r=a.max,e=a.replace,l=e===void 0?255:e,s=a.autoGreyscale,c=s===void 0?!0:s;return typeof r!="number"?b.throwError.call(this,"max must be a number",t):typeof l!="number"?b.throwError.call(this,"replace must be a number",t):typeof c!="boolean"?b.throwError.call(this,"autoGreyscale must be a boolean",t):(r=this.constructor.limit255(r),l=this.constructor.limit255(l),c&&this.greyscale(),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,function(u,h,p){var _=i.bitmap.data[p]<r?i.bitmap.data[p]:l;i.bitmap.data[p]=_,i.bitmap.data[p+1]=_,i.bitmap.data[p+2]=_}),(0,b.isNodePattern)(t)&&t.call(this,null,this),this)}}};g.default=f,x.exports=g.default},{"@jimp/utils":235}],228:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=b(m("@babel/runtime/helpers/toConsumableArray")),n=m("timm"),o=b(m("@jimp/plugin-blit")),a=b(m("@jimp/plugin-blur")),t=b(m("@jimp/plugin-circle")),i=b(m("@jimp/plugin-color")),r=b(m("@jimp/plugin-contain")),e=b(m("@jimp/plugin-cover")),l=b(m("@jimp/plugin-crop")),s=b(m("@jimp/plugin-displace")),c=b(m("@jimp/plugin-dither")),u=b(m("@jimp/plugin-fisheye")),h=b(m("@jimp/plugin-flip")),p=b(m("@jimp/plugin-gaussian")),_=b(m("@jimp/plugin-invert")),w=b(m("@jimp/plugin-mask")),S=b(m("@jimp/plugin-normalize")),C=b(m("@jimp/plugin-print")),E=b(m("@jimp/plugin-resize")),k=b(m("@jimp/plugin-rotate")),O=b(m("@jimp/plugin-scale")),U=b(m("@jimp/plugin-shadow")),F=b(m("@jimp/plugin-threshold")),M=[o.default,a.default,t.default,i.default,r.default,e.default,l.default,s.default,c.default,u.default,h.default,p.default,_.default,w.default,S.default,C.default,E.default,k.default,O.default,U.default,F.default],j=function(N){var R=M.map(function(A){var H=A(N)||{};return!H.class&&!H.constants&&(H={class:H}),H});return n.mergeDeep.apply(void 0,(0,f.default)(R))};g.default=j,x.exports=g.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/toConsumableArray":20,"@jimp/plugin-blit":201,"@jimp/plugin-blur":203,"@jimp/plugin-circle":204,"@jimp/plugin-color":205,"@jimp/plugin-contain":206,"@jimp/plugin-cover":207,"@jimp/plugin-crop":208,"@jimp/plugin-displace":209,"@jimp/plugin-dither":210,"@jimp/plugin-fisheye":211,"@jimp/plugin-flip":212,"@jimp/plugin-gaussian":213,"@jimp/plugin-invert":214,"@jimp/plugin-mask":215,"@jimp/plugin-normalize":216,"@jimp/plugin-print":217,"@jimp/plugin-resize":221,"@jimp/plugin-rotate":224,"@jimp/plugin-scale":225,"@jimp/plugin-shadow":226,"@jimp/plugin-threshold":227,timm:177}],229:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=b(m("@babel/runtime/helpers/defineProperty")),n=b(m("bmp-js")),o=m("@jimp/utils"),a="image/bmp",t="image/x-ms-bmp";function i(c){return(0,o.scan)(c,0,0,c.bitmap.width,c.bitmap.height,function(u,h,p){var _=this.bitmap.data[p+0],w=this.bitmap.data[p+1],S=this.bitmap.data[p+2],C=this.bitmap.data[p+3];this.bitmap.data[p+0]=C,this.bitmap.data[p+1]=S,this.bitmap.data[p+2]=w,this.bitmap.data[p+3]=_}).bitmap}function r(c){return(0,o.scan)({bitmap:c},0,0,c.width,c.height,function(u,h,p){var _=this.bitmap.data[p+0],w=this.bitmap.data[p+1],S=this.bitmap.data[p+2],C=this.bitmap.data[p+3];this.bitmap.data[p+0]=C,this.bitmap.data[p+1]=S,this.bitmap.data[p+2]=w,this.bitmap.data[p+3]=c.is_with_alpha?_:255}).bitmap}var e=function(u){return r(n.default.decode(u))},l=function(u){return n.default.encode(i(u)).data},s=function(){var u,h;return{mime:(0,f.default)({},a,["bmp"]),constants:{MIME_BMP:a,MIME_X_MS_BMP:t},decoders:(u={},(0,f.default)(u,a,e),(0,f.default)(u,t,e),u),encoders:(h={},(0,f.default)(h,a,l),(0,f.default)(h,t,l),h)}};g.default=s,x.exports=g.default},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/utils":235,"bmp-js":30}],230:[function(m,x,g){(function(b){var f=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var n=f(m("@babel/runtime/helpers/defineProperty")),o=f(m("omggif")),a=m("gifwrap"),t="image/gif",i=function(){return{mime:(0,n.default)({},t,["gif"]),constants:{MIME_GIF:t},decoders:(0,n.default)({},t,function(e){var l=new o.default.GifReader(e),s=b.alloc(l.width*l.height*4);return l.decodeAndBlitFrameRGBA(0,s),{data:s,width:l.width,height:l.height}}),encoders:(0,n.default)({},t,function(e){var l=new a.BitmapImage(e.bitmap);a.GifUtil.quantizeDekker(l,256);var s=new a.GifFrame(l),c=new a.GifCodec;return c.encodeGif([s],{}).then(function(u){return u.buffer})})}};g.default=i,x.exports=g.default}).call(this,m("buffer").Buffer)},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,buffer:48,gifwrap:70,omggif:85}],231:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=b(m("@babel/runtime/helpers/defineProperty")),n=b(m("jpeg-js")),o=m("@jimp/utils"),a="image/jpeg",t=function(){return{mime:(0,f.default)({},a,["jpeg","jpg","jpe"]),constants:{MIME_JPEG:a},decoders:(0,f.default)({},a,n.default.decode),encoders:(0,f.default)({},a,function(r){return n.default.encode(r.bitmap,r._quality).data}),class:{_quality:100,quality:function(e,l){return typeof e!="number"?o.throwError.call(this,"n must be a number",l):e<0||e>100?o.throwError.call(this,"n must be a number 0 - 100",l):(this._quality=Math.round(e),(0,o.isNodePattern)(l)&&l.call(this,null,this),this)}}}};g.default=t,x.exports=g.default},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/utils":235,"jpeg-js":80}],232:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=b(m("@babel/runtime/helpers/defineProperty")),n=m("pngjs"),o=m("@jimp/utils"),a="image/png",t=-1,i=0,r=1,e=2,l=3,s=4,c=function(){return{mime:(0,f.default)({},a,["png"]),constants:{MIME_PNG:a,PNG_FILTER_AUTO:t,PNG_FILTER_NONE:i,PNG_FILTER_SUB:r,PNG_FILTER_UP:e,PNG_FILTER_AVERAGE:l,PNG_FILTER_PATH:s},hasAlpha:(0,f.default)({},a,!0),decoders:(0,f.default)({},a,n.PNG.sync.read),encoders:(0,f.default)({},a,function(h){var p=new n.PNG({width:h.bitmap.width,height:h.bitmap.height});return p.data=h.bitmap.data,n.PNG.sync.write(p,{width:h.bitmap.width,height:h.bitmap.height,deflateLevel:h._deflateLevel,deflateStrategy:h._deflateStrategy,filterType:h._filterType,colorType:typeof h._colorType=="number"?h._colorType:h._rgba?6:2,inputHasAlpha:h._rgba})}),class:{_deflateLevel:9,_deflateStrategy:3,_filterType:t,_colorType:null,deflateLevel:function(p,_){return typeof p!="number"?o.throwError.call(this,"l must be a number",_):p<0||p>9?o.throwError.call(this,"l must be a number 0 - 9",_):(this._deflateLevel=Math.round(p),(0,o.isNodePattern)(_)&&_.call(this,null,this),this)},deflateStrategy:function(p,_){return typeof p!="number"?o.throwError.call(this,"s must be a number",_):p<0||p>3?o.throwError.call(this,"s must be a number 0 - 3",_):(this._deflateStrategy=Math.round(p),(0,o.isNodePattern)(_)&&_.call(this,null,this),this)},filterType:function(p,_){return typeof p!="number"?o.throwError.call(this,"n must be a number",_):p<-1||p>4?o.throwError.call(this,"n must be -1 (auto) or a number 0 - 4",_):(this._filterType=Math.round(p),(0,o.isNodePattern)(_)&&_.call(this,null,this),this)},colorType:function(p,_){return typeof p!="number"?o.throwError.call(this,"s must be a number",_):p!==0&&p!==2&&p!==4&&p!==6?o.throwError.call(this,"s must be a number 0, 2, 4, 6.",_):(this._colorType=Math.round(p),(0,o.isNodePattern)(_)&&_.call(this,null,this),this)}}}};g.default=c,x.exports=g.default},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/utils":235,pngjs:129}],233:[function(m,x,g){(function(b){var f=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var n=f(m("@babel/runtime/helpers/defineProperty")),o=f(m("utif")),a="image/tiff",t=function(){return{mime:(0,n.default)({},a,["tiff","tif"]),constants:{MIME_TIFF:a},decoders:(0,n.default)({},a,function(r){var e=o.default.decode(r),l=e[0];o.default.decodeImages(r,e);var s=o.default.toRGBA8(l);return{data:b.from(s),width:l.t256[0],height:l.t257[0]}}),encoders:(0,n.default)({},a,function(r){var e=o.default.encodeImage(r.bitmap.data,r.bitmap.width,r.bitmap.height);return b.from(e)})}};g.default=t,x.exports=g.default}).call(this,m("buffer").Buffer)},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,buffer:48,utif:182}],234:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var f=m("timm"),n=b(m("@jimp/jpeg")),o=b(m("@jimp/png")),a=b(m("@jimp/bmp")),t=b(m("@jimp/tiff")),i=b(m("@jimp/gif")),r=function(){return(0,f.mergeDeep)((0,n.default)(),(0,o.default)(),(0,a.default)(),(0,t.default)(),(0,i.default)())};g.default=r,x.exports=g.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/bmp":229,"@jimp/gif":230,"@jimp/jpeg":231,"@jimp/png":232,"@jimp/tiff":233,timm:177}],235:[function(m,x,g){var b=m("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(g,"__esModule",{value:!0}),g.isNodePattern=o,g.throwError=a,g.scan=t,g.scanIterator=i;var f=b(m("@babel/runtime/regenerator")),n=f.default.mark(i);function o(r){if(typeof r>"u")return!1;if(typeof r!="function")throw new TypeError("Callback must be a function");return!0}function a(r,e){if(typeof r=="string"&&(r=new Error(r)),typeof e=="function")return e.call(this,r);throw r}function t(r,e,l,s,c,u){e=Math.round(e),l=Math.round(l),s=Math.round(s),c=Math.round(c);for(var h=l;h<l+c;h++)for(var p=e;p<e+s;p++){var _=r.bitmap.width*h+p<<2;u.call(r,p,h,_)}return r}function i(r,e,l,s,c){var u,h,p;return f.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:e=Math.round(e),l=Math.round(l),s=Math.round(s),c=Math.round(c),u=l;case 5:if(!(u<l+c)){w.next=17;break}h=e;case 7:if(!(h<e+s)){w.next=14;break}return p=r.bitmap.width*u+h<<2,w.next=11,{x:h,y:u,idx:p,image:r};case 11:h++,w.next=7;break;case 14:u++,w.next=5;break;case 17:case"end":return w.stop()}},n)}},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/regenerator":22}]},{},[200])(200)})})(el);var tl=el.exports;function aa(v,d){this.x=v||0,this.y=d||0}aa.prototype={copy:function(){return new aa(this.x,this.y)}};var Mi=aa,Ba=Mi,ai={};function T1(v){return ai[v]||(ai[v]=new RegExp(" "+v+'="((?:\\\\(?=")"|[^"])+)"',"i")),ai[v]}function U1(v,d,y){var m=" "+d+'="'+y+'"';return v.indexOf(" "+d+'="')===-1?v=v.replace(/<[a-z]+/i,function(x){return x+m}):v=v.replace(T1(d),m),v}function Lt(v){return v.toFixed(3).replace(".000","")}function A1(v,d){return v>=d?v%d:v>=0?v:d-1-(-1-v)%d}function O1(v,d){return v.x*d.y-v.y*d.x}function M1(v,d,y){return v<=y?v<=d&&d<y:v<=d||d<y}function na(v){return v>0?1:v<0?-1:0}function P1(v,d){var y=new Array(3),m,x,g;for(y[0]=d.x,y[1]=d.y,y[2]=1,g=0,m=0;m<3;m++)for(x=0;x<3;x++)g+=y[m]*v.at(m,x)*y[x];return g}function R1(v,d,y){var m=new Ba;return m.x=d.x+v*(y.x-d.x),m.y=d.y+v*(y.y-d.y),m}function rl(v,d){var y=new Ba;return y.y=na(d.x-v.x),y.x=-na(d.y-v.y),y}function D1(v,d){var y=rl(v,d);return y.y*(d.x-v.x)-y.x*(d.y-v.y)}function L1(v,d,y){var m,x,g,b;return m=d.x-v.x,x=d.y-v.y,g=y.x-v.x,b=y.y-v.y,m*b-g*x}function ni(v,d,y,m){var x,g,b,f;return x=d.x-v.x,g=d.y-v.y,b=m.x-y.x,f=m.y-y.y,x*f-b*g}function I1(v,d,y){var m,x,g,b;return m=d.x-v.x,x=d.y-v.y,g=y.x-v.x,b=y.y-v.y,m*g+x*b}function F1(v,d,y,m){var x,g,b,f;return x=d.x-v.x,g=d.y-v.y,b=m.x-y.x,f=m.y-y.y,x*b+g*f}function B1(v,d){return Math.sqrt((v.x-d.x)*(v.x-d.x)+(v.y-d.y)*(v.y-d.y))}var Pi={luminance:function(v,d,y){return Math.round(.2126*v+.7153*d+.0721*y)},between:function(v,d,y){return v>=d&&v<=y},clamp:function(v,d,y){return Math.min(y,Math.max(d,v))},isNumber:function(v){return typeof v=="number"},setHtmlAttr:U1,renderCurve:function(v,d){d=d||{x:1,y:1};var y=v.c[(v.n-1)*3+2],m=["M "+Lt(y.x*d.x)+" "+Lt(y.y*d.y)];return v.tag.forEach(function(x,g){var b=g*3,f=v.c[b],n=v.c[b+1],o=v.c[b+2];x==="CURVE"?m.push("C "+Lt(f.x*d.x)+" "+Lt(f.y*d.y)+", "+Lt(n.x*d.x)+" "+Lt(n.y*d.y)+", "+Lt(o.x*d.x)+" "+Lt(o.y*d.y)):x==="CORNER"&&m.push("L "+Lt(n.x*d.x)+" "+Lt(n.y*d.y)+" "+Lt(o.x*d.x)+" "+Lt(o.y*d.y))}),m.join(" ")},bezier:function(d,y,m,x,g){var b=1-d,f=new Ba;return f.x=b*b*b*y.x+3*(b*b*d)*m.x+3*(d*d*b)*x.x+d*d*d*g.x,f.y=b*b*b*y.y+3*(b*b*d)*m.y+3*(d*d*b)*x.y+d*d*d*g.y,f},tangent:function(d,y,m,x,g,b){var f,n,o,a,t,i,r,e,l,s;return f=ni(d,y,g,b),n=ni(y,m,g,b),o=ni(m,x,g,b),a=f-2*n+o,t=-2*f+2*n,i=f,r=t*t-4*a*i,a===0||r<0?-1:(e=Math.sqrt(r),l=(-t+e)/(2*a),s=(-t-e)/(2*a),l>=0&&l<=1?l:s>=0&&s<=1?s:-1)},mod:A1,xprod:O1,cyclic:M1,sign:na,quadform:P1,interval:R1,dorth_infty:rl,ddenom:D1,dpara:L1,cprod:ni,iprod:I1,iprod1:F1,ddist:B1},Ni,Ln;function In(){if(Ln)return Ni;Ln=1;var v=Pi,d=null;try{d=tl}catch(n){}var y=il(),m=256,x=m-1;function g(n,o){return m*n+o}function b(n,o){if(n=typeof n=="number"?v.clamp(Math.round(n),0,x):0,o=typeof o=="number"?v.clamp(Math.round(o),0,x):x,n>o)throw new Error('Invalid range "'+n+"..."+o+'"');return[n,o]}function f(n,o){if(this.data=null,this.pixels=0,this._sortedIndexes=null,this._cachedStats={},this._lookupTableH=null,typeof n=="number")this._createArray(n);else if(n instanceof y)this._collectValuesBitmap(n);else if(d&&n instanceof d)this._collectValuesJimp(n,o);else throw new Error("Unsupported image source")}return f.MODE_LUMINANCE="luminance",f.MODE_R="r",f.MODE_G="g",f.MODE_B="b",f.prototype={_createArray:function(n){var o=n<=Math.pow(2,8)?Uint8Array:n<=Math.pow(2,16)?Uint16Array:Uint32Array;return this.pixels=n,this.data=new o(m)},_collectValuesJimp:function(n,o){var a=n.bitmap.data,t=this._createArray(n.bitmap.width*n.bitmap.height);n.scan(0,0,n.bitmap.width,n.bitmap.height,function(i,r,e){var l=o===f.MODE_R?a[e]:o===f.MODE_G?a[e+1]:o===f.MODE_B?a[e+2]:v.luminance(a[e],a[e+1],a[e+2]);t[l]++})},_collectValuesBitmap:function(n){for(var o=this._createArray(n.size),a=n.data.length,t,i=0;i<a;i++)t=n.data[i],o[t]++},_getSortedIndexes:function(n){if(!n&&this._sortedIndexes)return this._sortedIndexes;var o=this.data,a=new Array(m),t=0;for(t;t<m;t++)a[t]=t;return a.sort(function(i,r){return o[i]>o[r]?1:o[i]<o[r]?-1:0}),this._sortedIndexes=a,a},_thresholdingBuildLookupTable:function(){var n=new Float64Array(m*m),o=new Float64Array(m*m),a=new Float64Array(m*m),t=this.pixels,i,r,e,l;for(i=1;i<m;++i)e=g(i,i),l=this.data[i]/t,n[e]=l,o[e]=i*l;for(i=1;i<m-1;++i)l=this.data[i+1]/t,e=g(1,i),n[e+1]=n[e]+l,o[e+1]=o[e]+(i+1)*l;for(i=2;i<m;i++)for(r=i+1;r<m;r++)n[g(i,r)]=n[g(1,r)]-n[g(1,i-1)],o[g(i,r)]=o[g(1,r)]-o[g(1,i-1)];for(i=1;i<m;++i)for(r=i+1;r<m;r++)e=g(i,r),a[e]=n[e]!==0?o[e]*o[e]/n[e]:0;return this._lookupTableH=a},multilevelThresholding:function(n,o,a){if(o=b(o,a),a=o[1],o=o[0],n=Math.min(a-o-2,~~n),n<1)return[];this._lookupTableH||this._thresholdingBuildLookupTable();var t=this._lookupTableH,i=null,r=0;n>4&&console.log("[Warning]: Threshold computation for more than 5 levels may take a long time");function e(l,s,c,u){l=(l||0)+1,s=s||0,c=c||new Array(n),u=u||0;for(var h=u+1,p,_=l;_<a-n+u;_++)p=s+t[g(l,_)],c[h-1]=_,h+1<n+1?e(_,p,c,h):(p+=t[g(_+1,a)],r<p&&(r=p,i=c.slice()))}return e(o||0),i||[]},autoThreshold:function(n,o){var a=this.multilevelThresholding(1,n,o);return a.length?a[0]:null},getDominantColor:function(n,o,a){n=b(n,o),o=n[1],n=n[0],a=a||1;var t=this.data,i=-1,r=-1,e,l,s;if(n===o)return t[n]?n:-1;for(e=n;e<=o;e++){for(s=0,l=~~(a/-2);l<a;l++)s+=v.between(e+l,0,x)?t[e+l]:0;var c=s>r,u=r===s&&(i<0||t[e]>t[i]);(c||u)&&(i=e,r=s)}return r<=0?-1:i},getStats:function(n,o,a){if(n=b(n,o),o=n[1],n=n[0],!a&&this._cachedStats[n+"-"+o])return this._cachedStats[n+"-"+o];var t=this.data,i=this._getSortedIndexes(),r=0,e=null,l,s,c,u,h=0,p=0,_=0,w,S,C,E=0,k=0;for(w=n;w<=o;w++)r+=t[w],_+=t[w]*w,E+=t[w]===0?0:1,k<t[w]&&(k=t[w]);for(l=_/r,c=r/(o-n),u=r/E,s=Math.floor(r/2),w=0;w<m;w++)C=i[w],S=t[C],!(C<n||C>o)&&(p+=S,h+=Math.pow(C-l,2)*S,e===null&&p>=s&&(e=C));return this._cachedStats[n+"-"+o]={levels:{mean:l,median:e,stdDev:Math.sqrt(h/r),unique:E},pixelsPerLevel:{mean:c,median:u,peak:k},pixels:r}}},Ni=f,Ni}var zi,Fn;function il(){if(Fn)return zi;Fn=1;var v=Mi,d=Pi;function y(m,x){this._histogram=null,this.width=m,this.height=x,this.size=m*x,this.arrayBuffer=new ArrayBuffer(this.size),this.data=new Uint8Array(this.arrayBuffer)}return zi=y,In(),y.prototype={getValueAt:function(m,x){var g=typeof m=="number"&&typeof x!="number"?m:this.pointToIndex(m,x);return this.data[g]},indexToPoint:function(m){var x=new v;return d.between(m,0,this.size)?(x.y=Math.floor(m/this.width),x.x=m-x.y*this.width):(x.x=-1,x.y=-1),x},pointToIndex:function(m,x){var g=m,b=x;return m instanceof v&&(g=m.x,b=m.y),!d.between(g,0,this.width)||!d.between(b,0,this.height)?-1:this.width*b+g},copy:function(m){var x=new y(this.width,this.height),g=typeof m=="function",b;for(b=0;b<this.size;b++)x.data[b]=g?m(this.data[b],b):this.data[b];return x},histogram:function(){var m=In();return this._histogram?this._histogram:(this._histogram=new m(this),this._histogram)}},zi}function N1(v){this.n=v,this.tag=new Array(v),this.c=new Array(v*3),this.alphaCurve=0,this.vertex=new Array(v),this.alpha=new Array(v),this.alpha0=new Array(v),this.beta=new Array(v)}var z1=N1;function j1(){this.area=0,this.len=0,this.curve={},this.pt=[],this.minX=1e5,this.minY=1e5,this.maxX=-1,this.maxY=-1}var H1=j1;function al(){this.data=[0,0,0,0,0,0,0,0,0]}al.prototype.at=function(v,d){return this.data[v*3+d]};var G1=al;function W1(v,d,y,m,x){this.x=v,this.y=d,this.xy=y,this.x2=m,this.y2=x}var Y1=W1,Bn=Mi;function X1(){this.pen=0,this.c=[new Bn,new Bn],this.t=0,this.s=0,this.alpha=0}var $1=X1,Nn=tl,V1=il(),zn=z1,Mt=Mi,Z1=H1,jn=G1,Hn=Y1,Gn=$1,Be=Pi;function st(v){this._luminanceData=null,this._pathlist=[],this._imageLoadingIdentifier=null,this._imageLoaded=!1,this._processed=!1,this._params={turnPolicy:st.TURNPOLICY_MINORITY,turdSize:2,alphaMax:1,optCurve:!0,optTolerance:.2,threshold:st.THRESHOLD_AUTO,blackOnWhite:!0,color:st.COLOR_AUTO,background:st.COLOR_TRANSPARENT,width:null,height:null},v&&this.setParameters(v)}st.COLOR_AUTO="auto";st.COLOR_TRANSPARENT="transparent";st.THRESHOLD_AUTO=-1;st.TURNPOLICY_BLACK="black";st.TURNPOLICY_WHITE="white";st.TURNPOLICY_LEFT="left";st.TURNPOLICY_RIGHT="right";st.TURNPOLICY_MINORITY="minority";st.TURNPOLICY_MAJORITY="majority";var Wn=[st.TURNPOLICY_BLACK,st.TURNPOLICY_WHITE,st.TURNPOLICY_LEFT,st.TURNPOLICY_RIGHT,st.TURNPOLICY_MINORITY,st.TURNPOLICY_MAJORITY];st.prototype={_bmToPathlist:function(){var v=this,d=this._params.threshold,y=this._params.blackOnWhite,m,x=new Mt(0,0),g;d===st.THRESHOLD_AUTO&&(d=this._luminanceData.histogram().autoThreshold()||128),m=this._luminanceData.copy(function(a){var t=y?a>d:a<d;return t?0:1});function b(a){for(var t=m.pointToIndex(a);t<m.size&&m.data[t]!==1;)t++;return t<m.size&&m.indexToPoint(t)}function f(a,t){var i,r,e;for(i=2;i<5;i++){for(e=0,r=-i+1;r<=i-1;r++)e+=m.getValueAt(a+r,t+i-1)?1:-1,e+=m.getValueAt(a+i-1,t+r-1)?1:-1,e+=m.getValueAt(a+r-1,t-i)?1:-1,e+=m.getValueAt(a-i,t+r)?1:-1;if(e>0)return 1;if(e<0)return 0}return 0}function n(a){var t=new Z1,i=a.x,r=a.y,e=0,l=1,s;for(t.sign=m.getValueAt(a.x,a.y)?"+":"-";t.pt.push(new Mt(i,r)),i>t.maxX&&(t.maxX=i),i<t.minX&&(t.minX=i),r>t.maxY&&(t.maxY=r),r<t.minY&&(t.minY=r),t.len++,i+=e,r+=l,t.area-=i*l,!(i===a.x&&r===a.y);){var c=m.getValueAt(i+(e+l-1)/2,r+(l-e-1)/2),u=m.getValueAt(i+(e-l-1)/2,r+(l+e-1)/2);u&&!c?v._params.turnPolicy==="right"||v._params.turnPolicy==="black"&&t.sign==="+"||v._params.turnPolicy==="white"&&t.sign==="-"||v._params.turnPolicy==="majority"&&f(i,r)||v._params.turnPolicy==="minority"&&!f(i,r)?(s=e,e=-l,l=s):(s=e,e=l,l=-s):u?(s=e,e=-l,l=s):c||(s=e,e=l,l=-s)}return t}function o(a){var t=a.pt[0].y,i=a.len,r,e,l,s,c,u,h;for(c=1;c<i;c++)if(r=a.pt[c].x,e=a.pt[c].y,e!==t){for(s=t<e?t:e,l=a.maxX,u=r;u<l;u++)h=m.pointToIndex(u,s),m.data[h]=m.data[h]?0:1;t=e}}for(this._pathlist=[];x=b(x);)g=n(x),o(g),g.area>v._params.turdSize&&this._pathlist.push(g)},_processPath:function(){var v=this;function d(a){var t,i,r;a.x0=a.pt[0].x,a.y0=a.pt[0].y,a.sums=[];var e=a.sums;for(e.push(new Hn(0,0,0,0,0)),t=0;t<a.len;t++)i=a.pt[t].x-a.x0,r=a.pt[t].y-a.y0,e.push(new Hn(e[t].x+i,e[t].y+r,e[t].xy+i*r,e[t].x2+i*i,e[t].y2+r*r))}function y(a){var t=a.len,i=a.pt,r,e=new Array(t),l=new Array(t),s=new Array(4);a.lon=new Array(t);var c=[new Mt,new Mt],u=new Mt,h=new Mt,p=new Mt,_,w,S,C,E,k,O,U,F=0;for(w=t-1;w>=0;w--)i[w].x!=i[F].x&&i[w].y!=i[F].y&&(F=w+1),l[w]=F;for(w=t-1;w>=0;w--){for(s[0]=s[1]=s[2]=s[3]=0,r=(3+3*(i[Be.mod(w+1,t)].x-i[w].x)+(i[Be.mod(w+1,t)].y-i[w].y))/2,s[r]++,c[0].x=0,c[0].y=0,c[1].x=0,c[1].y=0,F=l[w],C=w;;){if(_=0,r=(3+3*Be.sign(i[F].x-i[C].x)+Be.sign(i[F].y-i[C].y))/2,s[r]++,s[0]&&s[1]&&s[2]&&s[3]){e[w]=C,_=1;break}if(u.x=i[F].x-i[w].x,u.y=i[F].y-i[w].y,Be.xprod(c[0],u)<0||Be.xprod(c[1],u)>0||(Math.abs(u.x)<=1&&Math.abs(u.y)<=1||(h.x=u.x+(u.y>=0&&(u.y>0||u.x<0)?1:-1),h.y=u.y+(u.x<=0&&(u.x<0||u.y<0)?1:-1),Be.xprod(c[0],h)>=0&&(c[0].x=h.x,c[0].y=h.y),h.x=u.x+(u.y<=0&&(u.y<0||u.x<0)?1:-1),h.y=u.y+(u.x>=0&&(u.x>0||u.y<0)?1:-1),Be.xprod(c[1],h)<=0&&(c[1].x=h.x,c[1].y=h.y)),C=F,F=l[C],!Be.cyclic(F,w,C)))break}_===0&&(p.x=Be.sign(i[F].x-i[C].x),p.y=Be.sign(i[F].y-i[C].y),u.x=i[C].x-i[w].x,u.y=i[C].y-i[w].y,E=Be.xprod(c[0],u),k=Be.xprod(c[0],p),O=Be.xprod(c[1],u),U=Be.xprod(c[1],p),S=1e7,k<0&&(S=Math.floor(E/-k)),U>0&&(S=Math.min(S,Math.floor(-O/U))),e[w]=Be.mod(C+S,t))}for(S=e[t-1],a.lon[t-1]=S,w=t-2;w>=0;w--)Be.cyclic(w+1,e[w],S)&&(S=e[w]),a.lon[w]=S;for(w=t-1;Be.cyclic(Be.mod(w+1,t),S,a.lon[w]);w--)a.lon[w]=S}function m(a){function t(k,O,U){var F=k.len,M=k.pt,j=k.sums,G,N,R,A,H,Z,K,J,D,I,W,q,ne,le,ce=0;return U>=F&&(U-=F,ce=1),ce===0?(G=j[U+1].x-j[O].x,N=j[U+1].y-j[O].y,A=j[U+1].x2-j[O].x2,R=j[U+1].xy-j[O].xy,H=j[U+1].y2-j[O].y2,Z=U+1-O):(G=j[U+1].x-j[O].x+j[F].x,N=j[U+1].y-j[O].y+j[F].y,A=j[U+1].x2-j[O].x2+j[F].x2,R=j[U+1].xy-j[O].xy+j[F].xy,H=j[U+1].y2-j[O].y2+j[F].y2,Z=U+1-O+F),W=(M[O].x+M[U].x)/2-M[0].x,q=(M[O].y+M[U].y)/2-M[0].y,le=M[U].x-M[O].x,ne=-(M[U].y-M[O].y),K=(A-2*G*W)/Z+W*W,J=(R-G*q-N*W)/Z+W*q,D=(H-2*N*q)/Z+q*q,I=ne*ne*K+2*ne*le*J+le*le*D,Math.sqrt(I)}var i,r,e,l,s=a.len,c=new Array(s+1),u=new Array(s+1),h=new Array(s),p=new Array(s+1),_=new Array(s+1),w=new Array(s+1),S,C,E;for(i=0;i<s;i++)E=Be.mod(a.lon[Be.mod(i-1,s)]-1,s),E==i&&(E=Be.mod(i+1,s)),E<i?h[i]=s:h[i]=E;for(r=1,i=0;i<s;i++)for(;r<=h[i];)p[r]=i,r++;for(i=0,r=0;i<s;r++)_[r]=i,i=h[i];for(_[r]=s,e=r,i=s,r=e;r>0;r--)w[r]=i,i=p[i];for(w[0]=0,c[0]=0,r=1;r<=e;r++)for(i=w[r];i<=_[r];i++){for(C=-1,l=_[r-1];l>=p[i];l--)S=t(a,l,i)+c[l],(C<0||S<C)&&(u[i]=l,C=S);c[i]=C}for(a.m=e,a.po=new Array(e),i=s,r=e-1;i>0;r--)i=u[i],a.po[r]=i}function x(a){function t(K,J,D,I,W){for(var q=K.len,ne=K.sums,le,ce,fe,he,se,ie,Q,re,te,V,z,B=0;D>=q;)D-=q,B+=1;for(;J>=q;)J-=q,B-=1;for(;D<0;)D+=q,B-=1;for(;J<0;)J+=q,B+=1;le=ne[D+1].x-ne[J].x+B*ne[q].x,ce=ne[D+1].y-ne[J].y+B*ne[q].y,fe=ne[D+1].x2-ne[J].x2+B*ne[q].x2,he=ne[D+1].xy-ne[J].xy+B*ne[q].xy,se=ne[D+1].y2-ne[J].y2+B*ne[q].y2,ie=D+1-J+B*q,I.x=le/ie,I.y=ce/ie,Q=(fe-le*le/ie)/ie,re=(he-le*ce/ie)/ie,te=(se-ce*ce/ie)/ie,V=(Q+te+Math.sqrt((Q-te)*(Q-te)+4*re*re))/2,Q-=V,te-=V,Math.abs(Q)>=Math.abs(te)?(z=Math.sqrt(Q*Q+re*re),z!==0&&(W.x=-re/z,W.y=Q/z)):(z=Math.sqrt(te*te+re*re),z!==0&&(W.x=-te/z,W.y=re/z)),z===0&&(W.x=W.y=0)}var i=a.m,r=a.po,e=a.len,l=a.pt,s=a.x0,c=a.y0,u=new Array(i),h=new Array(i),p=new Array(i),_=new Array(3),w,S,C,E,k,O=new Mt;for(a.curve=new zn(i),S=0;S<i;S++)C=r[Be.mod(S+1,i)],C=Be.mod(C-r[S],e)+r[S],u[S]=new Mt,h[S]=new Mt,t(a,r[S],C,u[S],h[S]);for(S=0;S<i;S++)if(p[S]=new jn,w=h[S].x*h[S].x+h[S].y*h[S].y,w===0)for(C=0;C<3;C++)for(E=0;E<3;E++)p[S].data[C*3+E]=0;else for(_[0]=h[S].y,_[1]=-h[S].x,_[2]=-_[1]*u[S].y-_[0]*u[S].x,k=0;k<3;k++)for(E=0;E<3;E++)p[S].data[k*3+E]=_[k]*_[E]/w;var U,F,M,j,G,N,R,A,H,Z;for(S=0;S<i;S++){for(U=new jn,F=new Mt,O.x=l[r[S]].x-s,O.y=l[r[S]].y-c,C=Be.mod(S-1,i),k=0;k<3;k++)for(E=0;E<3;E++)U.data[k*3+E]=p[C].at(k,E)+p[S].at(k,E);for(;;){if(G=U.at(0,0)*U.at(1,1)-U.at(0,1)*U.at(1,0),G!==0){F.x=(-U.at(0,2)*U.at(1,1)+U.at(1,2)*U.at(0,1))/G,F.y=(U.at(0,2)*U.at(1,0)-U.at(1,2)*U.at(0,0))/G;break}for(U.at(0,0)>U.at(1,1)?(_[0]=-U.at(0,1),_[1]=U.at(0,0)):U.at(1,1)?(_[0]=-U.at(1,1),_[1]=U.at(1,0)):(_[0]=1,_[1]=0),w=_[0]*_[0]+_[1]*_[1],_[2]=-_[1]*O.y-_[0]*O.x,k=0;k<3;k++)for(E=0;E<3;E++)U.data[k*3+E]+=_[k]*_[E]/w}if(M=Math.abs(F.x-O.x),j=Math.abs(F.y-O.y),M<=.5&&j<=.5){a.curve.vertex[S]=new Mt(F.x+s,F.y+c);continue}if(N=Be.quadform(U,O),A=O.x,H=O.y,U.at(0,0)!==0)for(Z=0;Z<2;Z++)F.y=O.y-.5+Z,F.x=-(U.at(0,1)*F.y+U.at(0,2))/U.at(0,0),M=Math.abs(F.x-O.x),R=Be.quadform(U,F),M<=.5&&R<N&&(N=R,A=F.x,H=F.y);if(U.at(1,1)!==0)for(Z=0;Z<2;Z++)F.x=O.x-.5+Z,F.y=-(U.at(1,0)*F.x+U.at(1,2))/U.at(1,1),j=Math.abs(F.y-O.y),R=Be.quadform(U,F),j<=.5&&R<N&&(N=R,A=F.x,H=F.y);for(k=0;k<2;k++)for(E=0;E<2;E++)F.x=O.x-.5+k,F.y=O.y-.5+E,R=Be.quadform(U,F),R<N&&(N=R,A=F.x,H=F.y);a.curve.vertex[S]=new Mt(A+s,H+c)}}function g(a){var t=a.curve,i=t.n,r=t.vertex,e,l,s;for(e=0,l=i-1;e<l;e++,l--)s=r[e],r[e]=r[l],r[l]=s}function b(a){var t=a.curve.n,i=a.curve,r,e,l,s,c,u,h,p,_;for(r=0;r<t;r++)e=Be.mod(r+1,t),l=Be.mod(r+2,t),_=Be.interval(1/2,i.vertex[l],i.vertex[e]),c=Be.ddenom(i.vertex[r],i.vertex[l]),c!==0?(s=Be.dpara(i.vertex[r],i.vertex[e],i.vertex[l])/c,s=Math.abs(s),u=s>1?1-1/s:0,u=u/.75):u=4/3,i.alpha0[e]=u,u>=v._params.alphaMax?(i.tag[e]="CORNER",i.c[3*e+1]=i.vertex[e],i.c[3*e+2]=_):(u<.55?u=.55:u>1&&(u=1),h=Be.interval(.5+.5*u,i.vertex[r],i.vertex[e]),p=Be.interval(.5+.5*u,i.vertex[l],i.vertex[e]),i.tag[e]="CURVE",i.c[3*e+0]=h,i.c[3*e+1]=p,i.c[3*e+2]=_),i.alpha[e]=u,i.beta[e]=.5;i.alphaCurve=1}function f(a){function t(N,R,A,H,Z,K,J){var D=N.curve.n,I=N.curve,W=I.vertex,q,ne,le,ce,fe,he,se,ie,Q,re,te,V,z,B,ee,Y,L,P,ae,ue,ve,_e,Te;if(R==A||(q=R,fe=Be.mod(R+1,D),ne=Be.mod(q+1,D),ce=K[ne],ce===0))return 1;for(ie=Be.ddist(W[R],W[fe]),q=ne;q!=A;q=ne)if(ne=Be.mod(q+1,D),le=Be.mod(q+2,D),K[ne]!=ce||Be.sign(Be.cprod(W[R],W[fe],W[ne],W[le]))!=ce||Be.iprod1(W[R],W[fe],W[ne],W[le])<ie*Be.ddist(W[ne],W[le])*-.999847695156)return 1;if(te=I.c[Be.mod(R,D)*3+2].copy(),V=W[Be.mod(R+1,D)].copy(),z=W[Be.mod(A,D)].copy(),B=I.c[Be.mod(A,D)*3+2].copy(),he=J[A]-J[R],he-=Be.dpara(W[0],I.c[R*3+2],I.c[A*3+2])/2,R>=A&&(he+=J[D]),P=Be.dpara(te,V,z),ae=Be.dpara(te,V,B),ue=Be.dpara(te,z,B),ve=P+ue-ae,ae==P||(Te=ue/(ue-ve),_e=ae/(ae-P),Y=ae*Te/2,Y===0))return 1;for(L=he/Y,se=2-Math.sqrt(4-L/.3),H.c[0]=Be.interval(Te*se,te,V),H.c[1]=Be.interval(_e*se,B,z),H.alpha=se,H.t=Te,H.s=_e,V=H.c[0].copy(),z=H.c[1].copy(),H.pen=0,q=Be.mod(R+1,D);q!=A;q=ne){if(ne=Be.mod(q+1,D),Te=Be.tangent(te,V,z,B,W[q],W[ne]),Te<-.5||(ee=Be.bezier(Te,te,V,z,B),ie=Be.ddist(W[q],W[ne]),ie===0)||(Q=Be.dpara(W[q],W[ne],ee)/ie,Math.abs(Q)>Z)||Be.iprod(W[q],W[ne],ee)<0||Be.iprod(W[ne],W[q],ee)<0)return 1;H.pen+=Q*Q}for(q=R;q!=A;q=ne){if(ne=Be.mod(q+1,D),Te=Be.tangent(te,V,z,B,I.c[q*3+2],I.c[ne*3+2]),Te<-.5||(ee=Be.bezier(Te,te,V,z,B),ie=Be.ddist(I.c[q*3+2],I.c[ne*3+2]),ie===0)||(Q=Be.dpara(I.c[q*3+2],I.c[ne*3+2],ee)/ie,re=Be.dpara(I.c[q*3+2],I.c[ne*3+2],W[ne])/ie,re*=.75*I.alpha[ne],re<0&&(Q=-Q,re=-re),Q<re-Z))return 1;Q<re&&(H.pen+=(Q-re)*(Q-re))}return 0}var i=a.curve,r=i.n,e=i.vertex,l=new Array(r+1),s=new Array(r+1),c=new Array(r+1),u=new Array(r+1),h,p,_,w,S=new Gn,C,E,k,O,U,F,M,j=new Array(r),G=new Array(r+1);for(p=0;p<r;p++)i.tag[p]=="CURVE"?j[p]=Be.sign(Be.dpara(e[Be.mod(p-1,r)],e[p],e[Be.mod(p+1,r)])):j[p]=0;for(k=0,G[0]=0,C=i.vertex[0],p=0;p<r;p++)E=Be.mod(p+1,r),i.tag[E]=="CURVE"&&(O=i.alpha[E],k+=.3*O*(4-O)*Be.dpara(i.c[p*3+2],e[E],i.c[E*3+2])/2,k+=Be.dpara(C,i.c[p*3+2],i.c[E*3+2])/2),G[p+1]=k;for(l[0]=-1,s[0]=0,c[0]=0,_=1;_<=r;_++)for(l[_]=_-1,s[_]=s[_-1],c[_]=c[_-1]+1,p=_-2;p>=0&&(w=t(a,p,Be.mod(_,r),S,v._params.optTolerance,j,G),!w);p--)(c[_]>c[p]+1||c[_]==c[p]+1&&s[_]>s[p]+S.pen)&&(l[_]=p,s[_]=s[p]+S.pen,c[_]=c[p]+1,u[_]=S,S=new Gn);for(h=c[r],U=new zn(h),F=new Array(h),M=new Array(h),_=r,p=h-1;p>=0;p--)l[_]==_-1?(U.tag[p]=i.tag[Be.mod(_,r)],U.c[p*3+0]=i.c[Be.mod(_,r)*3+0],U.c[p*3+1]=i.c[Be.mod(_,r)*3+1],U.c[p*3+2]=i.c[Be.mod(_,r)*3+2],U.vertex[p]=i.vertex[Be.mod(_,r)],U.alpha[p]=i.alpha[Be.mod(_,r)],U.alpha0[p]=i.alpha0[Be.mod(_,r)],U.beta[p]=i.beta[Be.mod(_,r)],F[p]=M[p]=1):(U.tag[p]="CURVE",U.c[p*3+0]=u[_].c[0],U.c[p*3+1]=u[_].c[1],U.c[p*3+2]=i.c[Be.mod(_,r)*3+2],U.vertex[p]=Be.interval(u[_].s,i.c[Be.mod(_,r)*3+2],e[Be.mod(_,r)]),U.alpha[p]=u[_].alpha,U.alpha0[p]=u[_].alpha,F[p]=u[_].s,M[p]=u[_].t),_=l[_];for(p=0;p<h;p++)E=Be.mod(p+1,h),U.beta[p]=F[p]/(F[p]+M[E]);U.alphaCurve=1,a.curve=U}for(var n=0;n<this._pathlist.length;n++){var o=this._pathlist[n];d(o),y(o),m(o),x(o),o.sign==="-"&&g(o),b(o),v._params.optCurve&&f(o)}},_validateParameters:function(v){if(v&&v.turnPolicy&&Wn.indexOf(v.turnPolicy)===-1){var d="'"+Wn.join("', '")+"'";throw new Error("Bad turnPolicy value. Allowed values are: "+d)}if(v&&v.threshold!=null&&v.threshold!==st.THRESHOLD_AUTO&&(typeof v.threshold!="number"||!Be.between(v.threshold,0,255)))throw new Error("Bad threshold value. Expected to be an integer in range 0..255");if(v&&v.optCurve!=null&&typeof v.optCurve!="boolean")throw new Error("'optCurve' must be Boolean")},_processLoadedImage:function(v){var d=new V1(v.bitmap.width,v.bitmap.height),y=v.bitmap.data;v.scan(0,0,v.bitmap.width,v.bitmap.height,function(m,x,g){var b=y[g+3]/255,f=255+(y[g+0]-255)*b,n=255+(y[g+1]-255)*b,o=255+(y[g+2]-255)*b;d.data[g/4]=Be.luminance(f,n,o)}),this._luminanceData=d,this._imageLoaded=!0},loadImage:function(v,d){var y=this,m={};this._imageLoadingIdentifier=m,this._imageLoaded=!1,v instanceof Nn?(this._imageLoadingIdentifier=null,this._imageLoaded=!0,y._processLoadedImage(v),d.call(y,null)):Nn.read(v,function(x,g){var b=y._imageLoadingIdentifier!==m;if(b){var f=x||new Error("Another image was loaded instead");return d.call(y,f)}y._imageLoadingIdentifier=null,y._processLoadedImage(g),d.call(y,null)})},setParameters:function(v){var d,y;this._validateParameters(v);for(d in this._params)this._params.hasOwnProperty(d)&&v.hasOwnProperty(d)&&(y=this._params[d],this._params[d]=v[d],y!==this._params[d]&&["color","background"].indexOf(d)===-1&&(this._processed=!1))},getPathTag:function(v,d){if(v=arguments.length===0?this._params.color:v,v===st.COLOR_AUTO&&(v=this._params.blackOnWhite?"black":"white"),!this._imageLoaded)throw new Error("Image should be loaded first");this._processed||(this._bmToPathlist(),this._processPath(),this._processed=!0);var y='<path d="';return y+=this._pathlist.map(function(m){return Be.renderCurve(m.curve,d)}).join(" "),y+='" stroke="none" fill="'+v+'" fill-rule="evenodd"/>',y},getSymbol:function(v){return'<symbol viewBox="0 0 '+this._luminanceData.width+" "+this._luminanceData.height+'" id="'+v+'">'+this.getPathTag("")+"</symbol>"},getSVG:function(){var v=this._params.width||this._luminanceData.width,d=this._params.height||this._luminanceData.height,y={x:this._params.width?this._params.width/this._luminanceData.width:1,y:this._params.height?this._params.height/this._luminanceData.height:1};return'<svg xmlns="http://www.w3.org/2000/svg" width="'+v+'" height="'+d+'" viewBox="0 0 '+v+" "+d+'" version="1.1">\n'+(this._params.background!==st.COLOR_TRANSPARENT?'	<rect x="0" y="0" width="100%" height="100%" fill="'+this._params.background+'" />\n':"")+"	"+this.getPathTag(this._params.color,y)+"\n</svg>"}};var nl=st,Ht=nl,qt=Pi;function pt(v){this._potrace=new Ht,this._calculatedThreshold=null,this._params={threshold:Ht.THRESHOLD_AUTO,blackOnWhite:!0,steps:pt.STEPS_AUTO,background:Ht.COLOR_TRANSPARENT,fillStrategy:pt.FILL_DOMINANT,rangeDistribution:pt.RANGES_AUTO},v&&this.setParameters(v)}for(var Ir in Ht)Object.prototype.hasOwnProperty.call(Ht,Ir)&&Ir===Ir.toUpperCase()&&(pt[Ir]=Ht[Ir]);pt.STEPS_AUTO=-1;pt.FILL_SPREAD="spread";pt.FILL_DOMINANT="dominant";pt.FILL_MEDIAN="median";pt.FILL_MEAN="mean";pt.RANGES_AUTO="auto";pt.RANGES_EQUAL="equal";pt.prototype={_addExtraColorStop:function(v){var d=this._params.blackOnWhite,y=v[v.length-1],m=d?0:y.value,x=d?y.value:255;if(x-m>25&&y.colorIntensity!==1){var g=this._getImageHistogram(),b=g.getStats(m,x).levels,f=b.mean+b.stdDev<=25?b.mean+b.stdDev:b.mean-b.stdDev<=25?b.mean-b.stdDev:25,n=d?g.getStats(0,f):g.getStats(f,255),o=n.levels.mean;v.push({value:Math.abs((d?0:255)-f),colorIntensity:isNaN(o)?0:(d?255-o:o)/255})}return v},_calcColorIntensity:function(v){var d=this._params.blackOnWhite,y=this._params.fillStrategy,m=y!==pt.FILL_SPREAD?this._getImageHistogram():null,x=Math.abs(this._paramThreshold()-(d?0:255));return v.map(function(g,b){var f=b+1===v.length?d?-1:256:v[b+1],n=Math.round(d?f+1:g),o=Math.round(d?g:f-1),a=b/(v.length-1),t=o-n,i=m.getStats(n,o),r=-1;if(i.pixels===0)return{value:g,colorIntensity:0};switch(y){case pt.FILL_SPREAD:r=(d?n:o)+(d?1:-1)*t*Math.max(.5,x/255)*a;break;case pt.FILL_DOMINANT:r=m.getDominantColor(n,o,qt.clamp(t,1,5));break;case pt.FILL_MEAN:r=i.levels.mean;break;case pt.FILL_MEDIAN:r=i.levels.median;break}return b!==0&&(r=d?qt.clamp(r,n,o-Math.round(t*.1)):qt.clamp(r,n+Math.round(t*.1),o)),{value:g,colorIntensity:r===-1?0:(d?255-r:r)/255}})},_getImageHistogram:function(){return this._potrace._luminanceData.histogram()},_getRanges:function(){var v=this._paramSteps();if(!Array.isArray(v))return this._params.rangeDistribution===pt.RANGES_AUTO?this._getRangesAuto():this._getRangesEquallyDistributed();var d=[],y=this._paramThreshold(),m=this._params.blackOnWhite;return v.forEach(function(x){d.indexOf(x)===-1&&qt.between(x,0,255)&&d.push(x)}),d.length||d.push(y),d=d.sort(function(x,g){return x<g===m?1:-1}),m&&d[0]<y?d.unshift(y):!m&&d[d.length-1]<y&&d.push(y),this._calcColorIntensity(d)},_getRangesAuto:function(){var v=this._getImageHistogram(),d=this._paramSteps(!0),y;if(this._params.threshold===Ht.THRESHOLD_AUTO)y=v.multilevelThresholding(d);else{var m=this._paramThreshold();y=this._params.blackOnWhite?v.multilevelThresholding(d-1,0,m):v.multilevelThresholding(d-1,m,255),this._params.blackOnWhite?y.push(m):y.unshift(m)}return this._params.blackOnWhite&&(y=y.reverse()),this._calcColorIntensity(y)},_getRangesEquallyDistributed:function(){for(var v=this._params.blackOnWhite,d=v?this._paramThreshold():255-this._paramThreshold(),y=this._paramSteps(),m=d/y,x=[],g=y-1,b;g>=0;)b=Math.min(d,(g+1)*m),b=v?b:255-b,g--,x.push(b);return this._calcColorIntensity(x)},_paramSteps:function(v){var d=this._params.steps;if(Array.isArray(d))return v?d.length:d;if(d===pt.STEPS_AUTO&&this._params.threshold===Ht.THRESHOLD_AUTO)return 4;var y=this._params.blackOnWhite,m=y?this._paramThreshold():255-this._paramThreshold();return d===pt.STEPS_AUTO?m>200?4:3:Math.min(m,Math.max(2,d))},_paramThreshold:function(){if(this._calculatedThreshold!==null)return this._calculatedThreshold;if(this._params.threshold!==Ht.THRESHOLD_AUTO)return this._calculatedThreshold=this._params.threshold,this._calculatedThreshold;var v=this._getImageHistogram().multilevelThresholding(2);return this._calculatedThreshold=this._params.blackOnWhite?v[1]:v[0],this._calculatedThreshold=this._calculatedThreshold||128,this._calculatedThreshold},_pathTags:function(v){var d=this._getRanges(),y=this._potrace,m=this._params.blackOnWhite;d.length>=10&&(d=this._addExtraColorStop(d)),y.setParameters({blackOnWhite:m});var x=0;return d.map(function(g){var b=g.colorIntensity;if(b===0)return"";var f=!x||b===1?b:(x-b)/(x-1);f=qt.clamp(parseFloat(f.toFixed(3)),0,1),x=x+(1-x)*f,y.setParameters({threshold:g.value});var n=v?y.getPathTag(""):y.getPathTag();n=qt.setHtmlAttr(n,"fill-opacity",f.toFixed(3));var o=f===0||n.indexOf(' d=""')!==-1;return o?"":n})},loadImage:function(v,d){var y=this;this._potrace.loadImage(v,function(m){y._calculatedThreshold=null,d.call(y,m)})},setParameters:function(v){if(v){if(this._potrace.setParameters(v),v.steps&&!Array.isArray(v.steps)&&(!qt.isNumber(v.steps)||!qt.between(v.steps,1,255)))throw new Error("Bad 'steps' value");for(var d in this._params)this._params.hasOwnProperty(d)&&v.hasOwnProperty(d)&&(this._params[d]=v[d]);this._calculatedThreshold=null}},getSymbol:function(v){var d=this._potrace._luminanceData.width,y=this._potrace._luminanceData.height,m=this._pathTags(!0);return'<symbol viewBox="0 0 '+d+" "+y+'" id="'+v+'">'+m.join("")+"</symbol>"},getSVG:function(){var v=this._potrace._luminanceData.width,d=this._potrace._luminanceData.height,y=this._pathTags(!1),m='<svg xmlns="http://www.w3.org/2000/svg" width="'+v+'" height="'+d+'" viewBox="0 0 '+v+" "+d+'" version="1.1">\n	'+(this._params.background!==Ht.COLOR_TRANSPARENT?'<rect x="0" y="0" width="100%" height="100%" fill="'+this._params.background+'" />\n	':"")+y.join("\n	")+"\n</svg>";return m.replace(/\n(?:\t*\n)+(\t*)/g,"\n$1")}};var q1=pt,sl=nl,ol=q1;function K1(v,d,y){arguments.length===2&&(y=d,d={});var m=new sl(d);m.loadImage(v,function(x){if(x)return y(x);y(null,m.getSVG(),m)})}function Q1(v,d,y){arguments.length===2&&(y=d,d={});var m=new ol(d);m.loadImage(v,function(x){if(x)return y(x);y(null,m.getSVG(),m)})}var J1={trace:K1,posterize:Q1,Potrace:sl,Posterizer:ol};const e_=fs(J1);var fi={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},t_=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function r_(v){return v===10||v===13||v===8232||v===8233||v===32||v===9||v===11||v===12||v===160||v>=5760&&t_.indexOf(v)>=0}function i_(v){switch(v|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}function a_(v){return(v|32)===97}function pr(v){return v>=48&&v<=57}function n_(v){return v>=48&&v<=57||v===43||v===45||v===46}function s_(v){this.index=0,this.path=v,this.max=v.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function ui(v){for(;v.index<v.max&&r_(v.path.charCodeAt(v.index));)v.index++}function o_(v){var d=v.path.charCodeAt(v.index);if(d===48){v.param=0,v.index++;return}if(d===49){v.param=1,v.index++;return}v.err="SvgPath: arc flag can be 0 or 1 only (at pos "+v.index+")"}function l_(v){var d=v.index,y=d,m=v.max,x=!1,g=!1,b=!1,f=!1,n;if(y>=m){v.err="SvgPath: missed param (at pos "+y+")";return}if(n=v.path.charCodeAt(y),(n===43||n===45)&&(y++,n=y<m?v.path.charCodeAt(y):0),!pr(n)&&n!==46){v.err="SvgPath: param should start with 0..9 or `.` (at pos "+y+")";return}if(n!==46){if(x=n===48,y++,n=y<m?v.path.charCodeAt(y):0,x&&y<m&&n&&pr(n)){v.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+d+")";return}for(;y<m&&pr(v.path.charCodeAt(y));)y++,g=!0;n=y<m?v.path.charCodeAt(y):0}if(n===46){for(f=!0,y++;pr(v.path.charCodeAt(y));)y++,b=!0;n=y<m?v.path.charCodeAt(y):0}if(n===101||n===69){if(f&&!g&&!b){v.err="SvgPath: invalid float exponent (at pos "+y+")";return}if(y++,n=y<m?v.path.charCodeAt(y):0,(n===43||n===45)&&y++,y<m&&pr(v.path.charCodeAt(y)))for(;y<m&&pr(v.path.charCodeAt(y));)y++;else{v.err="SvgPath: invalid float exponent (at pos "+y+")";return}}v.index=y,v.param=parseFloat(v.path.slice(d,y))+0}function ji(v){var d,y;d=v.path[v.segmentStart],y=d.toLowerCase();var m=v.data;if(y==="m"&&m.length>2&&(v.result.push([d,m[0],m[1]]),m=m.slice(2),y="l",d=d==="m"?"l":"L"),y==="r")v.result.push([d].concat(m));else for(;m.length>=fi[y]&&(v.result.push([d].concat(m.splice(0,fi[y]))),!!fi[y]););}function c_(v){var d=v.max,y,m,x,g,b;if(v.segmentStart=v.index,y=v.path.charCodeAt(v.index),m=a_(y),!i_(y)){v.err="SvgPath: bad command "+v.path[v.index]+" (at pos "+v.index+")";return}if(g=fi[v.path[v.index].toLowerCase()],v.index++,ui(v),v.data=[],!g){ji(v);return}for(x=!1;;){for(b=g;b>0;b--){if(m&&(b===3||b===4)?o_(v):l_(v),v.err.length){ji(v);return}v.data.push(v.param),ui(v),x=!1,v.index<d&&v.path.charCodeAt(v.index)===44&&(v.index++,ui(v),x=!0)}if(!x&&(v.index>=v.max||!n_(v.path.charCodeAt(v.index))))break}ji(v)}var f_=function(d){var y=new s_(d),m=y.max;for(ui(y);y.index<m&&!y.err.length;)c_(y);return y.result.length&&("mM".indexOf(y.result[0][0])<0?(y.err="SvgPath: string should start with `M` or `m`",y.result=[]):y.result[0][0]="M"),{err:y.err,segments:y.result}};function u_(v,d){return[v[0]*d[0]+v[2]*d[1],v[1]*d[0]+v[3]*d[1],v[0]*d[2]+v[2]*d[3],v[1]*d[2]+v[3]*d[3],v[0]*d[4]+v[2]*d[5]+v[4],v[1]*d[4]+v[3]*d[5]+v[5]]}function zt(){if(!(this instanceof zt))return new zt;this.queue=[],this.cache=null}zt.prototype.matrix=function(v){return v[0]===1&&v[1]===0&&v[2]===0&&v[3]===1&&v[4]===0&&v[5]===0?this:(this.cache=null,this.queue.push(v),this)};zt.prototype.translate=function(v,d){return(v!==0||d!==0)&&(this.cache=null,this.queue.push([1,0,0,1,v,d])),this};zt.prototype.scale=function(v,d){return(v!==1||d!==1)&&(this.cache=null,this.queue.push([v,0,0,d,0,0])),this};zt.prototype.rotate=function(v,d,y){var m,x,g;return v!==0&&(this.translate(d,y),m=v*Math.PI/180,x=Math.cos(m),g=Math.sin(m),this.queue.push([x,g,-g,x,0,0]),this.cache=null,this.translate(-d,-y)),this};zt.prototype.skewX=function(v){return v!==0&&(this.cache=null,this.queue.push([1,0,Math.tan(v*Math.PI/180),1,0,0])),this};zt.prototype.skewY=function(v){return v!==0&&(this.cache=null,this.queue.push([1,Math.tan(v*Math.PI/180),0,1,0,0])),this};zt.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],this.queue.length===1)return this.cache;for(var v=1;v<this.queue.length;v++)this.cache=u_(this.cache,this.queue[v]);return this.cache};zt.prototype.calc=function(v,d,y){var m;return this.queue.length?(this.cache||(this.cache=this.toArray()),m=this.cache,[v*m[0]+d*m[2]+(y?0:m[4]),v*m[1]+d*m[3]+(y?0:m[5])]):[v,d]};var ll=zt,h_=ll,d_={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},m_=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,p_=/[\s,]+/,v_=function(d){var y=new h_,m,x;return d.split(m_).forEach(function(g){if(g.length){if(typeof d_[g]<"u"){m=g;return}switch(x=g.split(p_).map(function(b){return+b||0}),m){case"matrix":x.length===6&&y.matrix(x);return;case"scale":x.length===1?y.scale(x[0],x[0]):x.length===2&&y.scale(x[0],x[1]);return;case"rotate":x.length===1?y.rotate(x[0],0,0):x.length===3&&y.rotate(x[0],x[1],x[2]);return;case"translate":x.length===1?y.translate(x[0],0):x.length===2&&y.translate(x[0],x[1]);return;case"skewX":x.length===1&&y.skewX(x[0]);return;case"skewY":x.length===1&&y.skewY(x[0]);return}}}),y},Nr=Math.PI*2;function Yn(v,d,y,m){var x=v*m-d*y<0?-1:1,g=v*y+d*m;return g>1&&(g=1),g<-1&&(g=-1),x*Math.acos(g)}function b_(v,d,y,m,x,g,b,f,n,o){var a=o*(v-y)/2+n*(d-m)/2,t=-n*(v-y)/2+o*(d-m)/2,i=b*b,r=f*f,e=a*a,l=t*t,s=i*r-i*l-r*e;s<0&&(s=0),s/=i*l+r*e,s=Math.sqrt(s)*(x===g?-1:1);var c=s*b/f*t,u=s*-f/b*a,h=o*c-n*u+(v+y)/2,p=n*c+o*u+(d+m)/2,_=(a-c)/b,w=(t-u)/f,S=(-a-c)/b,C=(-t-u)/f,E=Yn(1,0,_,w),k=Yn(_,w,S,C);return g===0&&k>0&&(k-=Nr),g===1&&k<0&&(k+=Nr),[h,p,E,k]}function g_(v,d){var y=1.3333333333333333*Math.tan(d/4),m=Math.cos(v),x=Math.sin(v),g=Math.cos(v+d),b=Math.sin(v+d);return[m,x,m-x*y,x+m*y,g+b*y,b-g*y,g,b]}var __=function(d,y,m,x,g,b,f,n,o){var a=Math.sin(o*Nr/360),t=Math.cos(o*Nr/360),i=t*(d-m)/2+a*(y-x)/2,r=-a*(d-m)/2+t*(y-x)/2;if(i===0&&r===0)return[];if(f===0||n===0)return[];f=Math.abs(f),n=Math.abs(n);var e=i*i/(f*f)+r*r/(n*n);e>1&&(f*=Math.sqrt(e),n*=Math.sqrt(e));var l=b_(d,y,m,x,g,b,f,n,a,t),s=[],c=l[2],u=l[3],h=Math.max(Math.ceil(Math.abs(u)/(Nr/4)),1);u/=h;for(var p=0;p<h;p++)s.push(g_(c,u)),c+=u;return s.map(function(_){for(var w=0;w<_.length;w+=2){var S=_[w+0],C=_[w+1];S*=f,C*=n;var E=t*S-a*C,k=a*S+t*C;_[w+0]=E+l[0],_[w+1]=k+l[1]}return _})},zr=1e-10,Xn=Math.PI/180;function jr(v,d,y){if(!(this instanceof jr))return new jr(v,d,y);this.rx=v,this.ry=d,this.ax=y}jr.prototype.transform=function(v){var d=Math.cos(this.ax*Xn),y=Math.sin(this.ax*Xn),m=[this.rx*(v[0]*d+v[2]*y),this.rx*(v[1]*d+v[3]*y),this.ry*(-v[0]*y+v[2]*d),this.ry*(-v[1]*y+v[3]*d)],x=m[0]*m[0]+m[2]*m[2],g=m[1]*m[1]+m[3]*m[3],b=((m[0]-m[3])*(m[0]-m[3])+(m[2]+m[1])*(m[2]+m[1]))*((m[0]+m[3])*(m[0]+m[3])+(m[2]-m[1])*(m[2]-m[1])),f=(x+g)/2;if(b<zr*f)return this.rx=this.ry=Math.sqrt(f),this.ax=0,this;var n=m[0]*m[1]+m[2]*m[3];b=Math.sqrt(b);var o=f+b/2,a=f-b/2;return this.ax=Math.abs(n)<zr&&Math.abs(o-g)<zr?90:Math.atan(Math.abs(n)>Math.abs(o-g)?(o-x)/n:n/(o-g))*180/Math.PI,this.ax>=0?(this.rx=Math.sqrt(o),this.ry=Math.sqrt(a)):(this.ax+=90,this.rx=Math.sqrt(a),this.ry=Math.sqrt(o)),this};jr.prototype.isDegenerate=function(){return this.rx<zr*this.ry||this.ry<zr*this.rx};var y_=jr,w_=f_,x_=v_,rr=ll,S_=__,C_=y_;function lt(v){if(!(this instanceof lt))return new lt(v);var d=w_(v);this.segments=d.segments,this.err=d.err,this.__stack=[]}lt.from=function(v){if(typeof v=="string")return new lt(v);if(v instanceof lt){var d=new lt("");return d.err=v.err,d.segments=v.segments.map(function(y){return y.slice()}),d.__stack=v.__stack.map(function(y){return rr().matrix(y.toArray())}),d}throw new Error("SvgPath.from: invalid param type "+v)};lt.prototype.__matrix=function(v){var d=this,y;v.queue.length&&this.iterate(function(m,x,g,b){var f,n,o,a;switch(m[0]){case"v":f=v.calc(0,m[1],!0),n=f[0]===0?["v",f[1]]:["l",f[0],f[1]];break;case"V":f=v.calc(g,m[1],!1),n=f[0]===v.calc(g,b,!1)[0]?["V",f[1]]:["L",f[0],f[1]];break;case"h":f=v.calc(m[1],0,!0),n=f[1]===0?["h",f[0]]:["l",f[0],f[1]];break;case"H":f=v.calc(m[1],b,!1),n=f[1]===v.calc(g,b,!1)[1]?["H",f[0]]:["L",f[0],f[1]];break;case"a":case"A":var t=v.toArray(),i=C_(m[1],m[2],m[3]).transform(t);if(t[0]*t[3]-t[1]*t[2]<0&&(m[5]=m[5]?"0":"1"),f=v.calc(m[6],m[7],m[0]==="a"),m[0]==="A"&&m[6]===g&&m[7]===b||m[0]==="a"&&m[6]===0&&m[7]===0){n=[m[0]==="a"?"l":"L",f[0],f[1]];break}i.isDegenerate()?n=[m[0]==="a"?"l":"L",f[0],f[1]]:n=[m[0],i.rx,i.ry,i.ax,m[4],m[5],f[0],f[1]];break;case"m":a=x>0,f=v.calc(m[1],m[2],a),n=["m",f[0],f[1]];break;default:for(o=m[0],n=[o],a=o.toLowerCase()===o,y=1;y<m.length;y+=2)f=v.calc(m[y],m[y+1],a),n.push(f[0],f[1])}d.segments[x]=n},!0)};lt.prototype.__evaluateStack=function(){var v,d;if(this.__stack.length){if(this.__stack.length===1){this.__matrix(this.__stack[0]),this.__stack=[];return}for(v=rr(),d=this.__stack.length;--d>=0;)v.matrix(this.__stack[d].toArray());this.__matrix(v),this.__stack=[]}};lt.prototype.toString=function(){var v="",d="",y=!1;this.__evaluateStack();for(var m=0,x=this.segments.length;m<x;m++){var g=this.segments[m],b=g[0];b!==d||b==="m"||b==="M"?(b==="m"&&d==="z"&&(v+=" "),v+=b,y=!1):y=!0;for(var f=1;f<g.length;f++){var n=g[f];f===1?y&&n>=0&&(v+=" "):n>=0&&(v+=" "),v+=n}d=b}return v};lt.prototype.translate=function(v,d){return this.__stack.push(rr().translate(v,d||0)),this};lt.prototype.scale=function(v,d){return this.__stack.push(rr().scale(v,!d&&d!==0?v:d)),this};lt.prototype.rotate=function(v,d,y){return this.__stack.push(rr().rotate(v,d||0,y||0)),this};lt.prototype.skewX=function(v){return this.__stack.push(rr().skewX(v)),this};lt.prototype.skewY=function(v){return this.__stack.push(rr().skewY(v)),this};lt.prototype.matrix=function(v){return this.__stack.push(rr().matrix(v)),this};lt.prototype.transform=function(v){return v.trim()?(this.__stack.push(x_(v)),this):this};lt.prototype.round=function(v){var d=0,y=0,m=0,x=0,g;return v=v||0,this.__evaluateStack(),this.segments.forEach(function(b){var f=b[0].toLowerCase()===b[0];switch(b[0]){case"H":case"h":f&&(b[1]+=m),m=b[1]-b[1].toFixed(v),b[1]=+b[1].toFixed(v);return;case"V":case"v":f&&(b[1]+=x),x=b[1]-b[1].toFixed(v),b[1]=+b[1].toFixed(v);return;case"Z":case"z":m=d,x=y;return;case"M":case"m":f&&(b[1]+=m,b[2]+=x),m=b[1]-b[1].toFixed(v),x=b[2]-b[2].toFixed(v),d=m,y=x,b[1]=+b[1].toFixed(v),b[2]=+b[2].toFixed(v);return;case"A":case"a":f&&(b[6]+=m,b[7]+=x),m=b[6]-b[6].toFixed(v),x=b[7]-b[7].toFixed(v),b[1]=+b[1].toFixed(v),b[2]=+b[2].toFixed(v),b[3]=+b[3].toFixed(v+2),b[6]=+b[6].toFixed(v),b[7]=+b[7].toFixed(v);return;default:g=b.length,f&&(b[g-2]+=m,b[g-1]+=x),m=b[g-2]-b[g-2].toFixed(v),x=b[g-1]-b[g-1].toFixed(v),b.forEach(function(n,o){o&&(b[o]=+b[o].toFixed(v))});return}}),this};lt.prototype.iterate=function(v,d){var y=this.segments,m={},x=!1,g=0,b=0,f=0,n=0,o,a,t;if(d||this.__evaluateStack(),y.forEach(function(i,r){var e=v(i,r,g,b);Array.isArray(e)&&(m[r]=e,x=!0);var l=i[0]===i[0].toLowerCase();switch(i[0]){case"m":case"M":g=i[1]+(l?g:0),b=i[2]+(l?b:0),f=g,n=b;return;case"h":case"H":g=i[1]+(l?g:0);return;case"v":case"V":b=i[1]+(l?b:0);return;case"z":case"Z":g=f,b=n;return;default:g=i[i.length-2]+(l?g:0),b=i[i.length-1]+(l?b:0)}}),!x)return this;for(t=[],o=0;o<y.length;o++)if(typeof m[o]<"u")for(a=0;a<m[o].length;a++)t.push(m[o][a]);else t.push(y[o]);return this.segments=t,this};lt.prototype.abs=function(){return this.iterate(function(v,d,y,m){var x=v[0],g=x.toUpperCase(),b;if(x!==g)switch(v[0]=g,x){case"v":v[1]+=m;return;case"a":v[6]+=y,v[7]+=m;return;default:for(b=1;b<v.length;b++)v[b]+=b%2?y:m}},!0),this};lt.prototype.rel=function(){return this.iterate(function(v,d,y,m){var x=v[0],g=x.toLowerCase(),b;if(x!==g&&!(d===0&&x==="M"))switch(v[0]=g,x){case"V":v[1]-=m;return;case"A":v[6]-=y,v[7]-=m;return;default:for(b=1;b<v.length;b++)v[b]-=b%2?y:m}},!0),this};lt.prototype.unarc=function(){return this.iterate(function(v,d,y,m){var x,g,b,f=[],n=v[0];return n!=="A"&&n!=="a"?null:(n==="a"?(g=y+v[6],b=m+v[7]):(g=v[6],b=v[7]),x=S_(y,m,g,b,v[4],v[5],v[1],v[2],v[3]),x.length===0?[[v[0]==="a"?"l":"L",v[6],v[7]]]:(x.forEach(function(o){f.push(["C",o[2],o[3],o[4],o[5],o[6],o[7]])}),f))}),this};lt.prototype.unshort=function(){var v=this.segments,d,y,m,x,g;return this.iterate(function(b,f,n,o){var a=b[0],t=a.toUpperCase(),i;f&&(t==="T"?(i=a==="t",m=v[f-1],m[0]==="Q"?(d=m[1]-n,y=m[2]-o):m[0]==="q"?(d=m[1]-m[3],y=m[2]-m[4]):(d=0,y=0),x=-d,g=-y,i||(x+=n,g+=o),v[f]=[i?"q":"Q",x,g,b[1],b[2]]):t==="S"&&(i=a==="s",m=v[f-1],m[0]==="C"?(d=m[3]-n,y=m[4]-o):m[0]==="c"?(d=m[3]-m[5],y=m[4]-m[6]):(d=0,y=0),x=-d,g=-y,i||(x+=n,g+=o),v[f]=[i?"c":"C",x,g,b[1],b[2],b[3],b[4]]))}),this};var E_=lt,k_=E_;const T_=fs(k_);function cl(v,d=1,y=0,m=0){return new Promise((x,g)=>{e_.trace(v,function(b,f){var t;b&&g(b);const n=/<path d=\"(.+?)\"/,o=(t=n.exec(f))==null?void 0:t[1],a=T_(o).scale(1/d).translate(Number(y),Number(m)).round(1).toString();f=f.replace(n,'<path d="'.concat(a,'"')),x(f)})})}async function Hi(v){return new Promise(d=>{const{fill:y}=v;v.clone(async m=>{m.path&&(m.path.visible=!1),m.set("fill","black");const x=v.toObject();y?x.src=U_(m):x.svg=await A_(m),d(x)})})}function U_(v){return v.toDataURL({format:"jpeg",multiplier:10,enableRetinaScaling:!0})}function A_(v){return new Promise((d,y)=>{const m=400/v.fontSize/v.scaleX,x=v.toDataURL({multiplier:m}),{left:g,top:b}=v.getBoundingRect(!0);cl(x,m,g,b).then(f=>{d(f)}).catch(f=>{y(f)})})}const $n={"i-text":Hi,text:Hi,MText:Hi};class Vn{static async toObject(d){const{type:y="",fill:m}=d,x=y==="image";let g;const b=d.getBoundingRect(!0);if(typeof $n[y]=="function")g=await $n[y](d);else if(x)g=d.toObject(),await new Promise(f=>{d.clone(n=>{n.set({scaleX:1,scaleY:1}),n.setCoords(),g.src=n.toDataURL({format:"jpeg"}),f()})});else if(m){g=d.toObject();const n=(await new Promise(o=>{d.clone(a=>{a.set({fill:"black",strokeWidth:.1}),o(a)})})).toDataURL({format:"jpeg",multiplier:10,enableRetinaScaling:!0});g.src=n}else{g=d.toObject();const f=await new Promise(n=>{d.clone(o=>{o.set({strokeWidth:1}),n(o)})});g.svg=f.toSVG(n=>{const o=f.ownMatrixCache.value,a=/transform="(.*?)\)"/;return n.replace(a,'transform="matrix('.concat(o[0]," ").concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5],' )"'))})}return g.width=b.width,g.height=b.height,g.left=b.left,g.top=b.top,g}}const O_=Me.fabric.Object.prototype.toObject;Me.fabric.Object.prototype.toObject=function(v){const d=O_.call(this,v);return d.id=this.id,d.name=this.name,this.hasBezierControl&&(d.hasBezierControl=[...this.hasBezierControl]),d.hasControls=this.hasControls,d.width=this.width,d.height=this.height,d.scaleX=this.scaleX,d.scaleY=this.scaleY,d.isLock=this.isLock,d.isVariableThickness=this.isVariableThickness,d};const M_=Me.fabric.Text.prototype._measureLine;Me.fabric.IText.prototype._fontSizeFraction=0;Me.fabric.IText.prototype.measureLine=function(v){const d=this._measureLine(v);return this.charSpacing!==0&&(d.width-=this._getWidthOfCharSpacing()),d.width-=d.fitWidth,d.width<0&&(d.width=0),d},Me.fabric.IText.prototype._measureLine=function(v){const d=M_.call(this,v),y=this._textLines[v],m=this.getCompleteStyleDeclaration(0,0),x=m.fontSize/this.CACHE_FONT_SIZE,g=this.getMeasuringContext();g.save(),this._setTextStyles(g,m,!0);const b=g.measureText(y.join(""));g.restore();const f=b.actualBoundingBoxRight+b.actualBoundingBoxLeft;return{...d,fitWidth:(b.width-f)*x}};Me.fabric.IText.prototype.getHeightOfCharActual=function(v,d){let y,m;d===-1?(y=this._textLines[v].join(""),m=this.getCompleteStyleDeclaration(v,0)):(y=this._textLines[v][d],m=this.getCompleteStyleDeclaration(v,d));const x=m.fontSize/this.CACHE_FONT_SIZE,g=this.getMeasuringContext();g.save(),this._setTextStyles(g,m,!0);const b=g.measureText(y);return g.restore(),{charHeight:(b.actualBoundingBoxAscent+b.actualBoundingBoxDescent)*x,above:b.actualBoundingBoxAscent*x,below:b.actualBoundingBoxDescent*x}};Me.fabric.IText.prototype.getHeightOfLine=function(v){if(this.__lineHeights[v])return this.__lineHeights[v];const d=this._textLines[v],{above:y,below:m}=this.getHeightOfCharActual(v,0);let x=y,g=m;for(let f=1,n=d.length;f<n;f++){const{above:o,below:a}=this.getHeightOfCharActual(v,f);x=Math.max(o,x),g=Math.max(a,g)}const b=x+g;return this.maxAbove=x,this.maxBelow=g,this.__lineHeights[v]=b*Number(this.lineHeight)};Me.fabric.IText.prototype._renderChars=function(v,d,y,m,x,g){let b,f,n="",o,a=0,t;const i=this.path,r=this.direction==="ltr",e=this.direction==="ltr"?1:-1;let l;const s=d.canvas.getAttribute("dir");d.save(),s!==this.direction&&(d.canvas.setAttribute("dir",r?"ltr":"rtl"),d.direction=r?"ltr":"rtl",d.textAlign=r?"left":"right"),x-=this.maxBelow;for(let c=0,u=y.length-1;c<=u;c++)t=!0,n+=y[c],o=this.__charBounds[g][c],a===0?(m+=e*(o.kernedWidth-o.width),a+=o.width):a+=o.kernedWidth,t||(b=b||this.getCompleteStyleDeclaration(g,c),f=this.getCompleteStyleDeclaration(g,c+1),t=Me.fabric.util.hasStyleChanged(b,f,!1)),t&&(i?(d.save(),d.translate(o.renderLeft,o.renderTop),d.rotate(o.angle),this._renderChar(v,d,g,c,n,-a/2,0),d.restore()):(l=m,this._renderChar(v,d,g,c,n,l,x,y[0])),n="",b=f,m+=e*a,a=0);d.restore()};Me.fabric.IText.prototype._renderChar=function(v,d,y,m,x,g,b,f){const n=this._getStyleDeclaration(y,m),o=this.getCompleteStyleDeclaration(y,m),a=v==="fillText"&&o.fill,t=v==="strokeText"&&o.stroke&&o.strokeWidth;let i,r;if(!t&&!a)return;d.save(),a&&(i=this._setFillStyles(d,o)),t&&(r=this._setStrokeStyles(d,o)),d.font=this._getFontDeclaration(o),n&&n.textBackgroundColor&&this._removeShadow(d),f||(f=x);const l=d.measureText(f).actualBoundingBoxLeft;a&&d.fillText(x,g-i.offsetX+l,b-i.offsetY),t&&d.strokeText(x,g-r.offsetX+l,b-r.offsetY),d.restore()};Me.fabric.IText.prototype.renderCursor=function(v,d){var a;const y=this.get2DCursorLocation(),m=y.lineIndex,x=y.charIndex>0?y.charIndex-1:0,g=this.getHeightOfLine(m)/Number(this.lineHeight),b=Number(this.scaleX)*(((a=this.canvas)==null?void 0:a.getZoom())||1),f=Number(this.cursorWidth)/b,n=v.topOffset,o=this.getValueOfPropertyAt(m,x,"deltaY");this.inCompositionMode&&this.renderSelection(v,d),d.fillStyle=this.cursorColor||this.getValueOfPropertyAt(m,x,"fill"),d.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,d.fillRect(v.left+v.leftOffset-f/2,n+v.top+o,f,g)};Me.fabric.Text.prototype.initDimensions=function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){let v=0,d=0;const y=this._textLines[0];for(let x=0;x<y.length;x++){const g=this.getCompleteStyleDeclaration(0,x);v=Math.max(v,this._measureChar(y[x],g).width),d=Math.max(d,this.getHeightOfChar(0,x))}const m=Math.max(v,d);this.width=this.path.width+m*2,this.height=this.path.height+m*2}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}};const P_=Me.fabric.Text.prototype.toObject;Me.fabric.Text.prototype.toObject=function(v){const d=P_.call(this,v);return d.path&&(d.path=new Me.fabric.Path(this.path.path,this.path)),d};class R_{constructor(d){Fe(this,"options");Fe(this,"gridBackground");Fe(this,"grids");this.options=d,this.initGridBackground(d)}initGridBackground(d){var c;const y=d.stageWidth,m=d.stageHeight,x=d.zoomRate;if(!y||!m)return console.error("请提供舞台尺寸大小！");const g=d.interval||10,b=d.defaultColor||"#EAEBEA",f=d.blodColor||"#D1D2D4",n=Math.ceil(m/10)-1,o=Math.ceil(y/10)-1;let a=1,t=!1,i="",r="";for(let u=0;u<n+o;u++){const h=u<n?"M 0 ".concat(a*g," L ").concat(y," ").concat(a*g):"M ".concat(a*g," 0 L ").concat(a*g," ").concat(m);a%g===0?r+=h:i+=h,a===n&&!t?(a=1,t=!0):++a}const e=new Me.fabric.Path(i);e.set({originX:"left",originY:"top",top:0,left:-(1/x/2),fill:void 0,stroke:b,strokeWidth:1/x,opacity:1,selectable:!1,evented:!1,strokeUniform:!0,hoverCursor:"default"});const l=new Me.fabric.Path(r);l.set({originX:"left",originY:"top",top:0,left:-(1/x/2),fill:void 0,stroke:f,strokeWidth:1/x,opacity:1,selectable:!1,evented:!1,strokeUniform:!0,hoverCursor:"default",width:y,height:m});const s=new Me.fabric.Path("\n      M 0 0 L ".concat(y," 0\n      M 0 ").concat(m," L ").concat(y," ").concat(m,"\n      M 0 0 L 0 ").concat(m,"\n      M ").concat(y," 0 L ").concat(y," ").concat(m,"\n    "),{name:"pathBorder",top:-(1/x/2),left:-(1/x/2),originX:"left",originY:"top",stroke:this.options.stageBorCor||"#43C9B0",strokeWidth:1/x,strokeLineCap:"square",selectable:!1,evented:!1,strokeUniform:!0,hoverCursor:"default"});((c=this.grids)==null?void 0:c.length)>0?(this.grids[0].set(e),this.grids[1].set(l),this.grids[2].set(s)):(this.grids=[e,l,s],this.grids.forEach(u=>{d.addElement(u)}))}resize(d,y,m){this.initGridBackground({...this.options,stageWidth:d,stageHeight:y}),this.resetGridBackground(m)}resetGridBackground(d){this.grids.forEach(y=>{const m={left:-(1/d/2),strokeWidth:1/d};y.name&&(m.top=-(1/d/2)),y.set(m)})}onZoom({zoomRate:d}){this.resetGridBackground(d)}onCanvasResize({zoomRate:d}){this.resetGridBackground(d)}}let si;const D_=new Uint8Array(16);function L_(){if(!si&&(si=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!si))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return si(D_)}const xt=[];for(let v=0;v<256;++v)xt.push((v+256).toString(16).slice(1));function I_(v,d=0){return(xt[v[d+0]]+xt[v[d+1]]+xt[v[d+2]]+xt[v[d+3]]+"-"+xt[v[d+4]]+xt[v[d+5]]+"-"+xt[v[d+6]]+xt[v[d+7]]+"-"+xt[v[d+8]]+xt[v[d+9]]+"-"+xt[v[d+10]]+xt[v[d+11]]+xt[v[d+12]]+xt[v[d+13]]+xt[v[d+14]]+xt[v[d+15]]).toLowerCase()}const F_=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Zn={randomUUID:F_};function fl(v,d,y){if(Zn.randomUUID&&!d&&!v)return Zn.randomUUID();v=v||{};const m=v.random||(v.rng||L_)();if(m[6]=m[6]&15|64,m[8]=m[8]&63|128,d){y=y||0;for(let x=0;x<16;++x)d[y+x]=m[x];return d}return I_(m)}class Pt extends Array{constructor(d=1,y=0){super(),this.x=d,this.y=y}set x(d){this[0]=d}set y(d){this[1]=d}get x(){return this[0]}get y(){return this[1]}get length(){return Math.hypot(this.x,this.y)}get dir(){return Math.atan2(this.y,this.x)}copy(){return new Pt(this.x,this.y)}add(d){return this.x+=d.x,this.y+=d.y,this}sub(d){return this.x-=d.x,this.y-=d.y,this}scale(d){return this.x*=d,this.y*=d,this}rotate(d){const y=Math.cos(d),m=Math.sin(d),[x,g]=this;return this.x=x*y+g*-m,this.y=x*m+g*y,this}cross(d){return this.x*d.y-d.x*this.y}dot(d){return this.x*d.x+d.y*this.y}normalize(){return this.scale(1/this.length)}}function oi(v,d){return new Pt(v.x+d.x,v.y+d.y)}function Kt(v,d){return new Pt(v.x-d.x,v.y-d.y)}const B_={createSmoothLineControlPoint(v,d,y,m=.3){const x=Kt(v,d),g=Kt(v,d),b=x.length,f=g.length,n=b/f;let o;n>1?o=Kt(v,oi(d,Kt(y,d).scale(1/n))):o=Kt(oi(d,Kt(v,d).scale(n)),y),o=o.scale(m);const a={x:oi(d,o).x,y:oi(d,o).y},t={x:Kt(d,o).x,y:Kt(d,o).y};return{control1:a,control2:t}},createSmoothLine(v,d=.3){const y=v.length;let m=[];const x=[];if(!(y<3)){for(let g=0;g<y-2;g++){const b=new Pt(v[g].x,v[g].y),f=new Pt(v[g+1].x,v[g+1].y),n=new Pt(v[g+2].x,v[g+2].y);console.log(b,f,n);const{control1:o,control2:a}=this.createSmoothLineControlPoint(new Pt(v[g].x,v[g].y),new Pt(v[g+1].x,v[g+1].y),new Pt(v[g+2].x,v[g+2].y),d);console.log(o,a,"control1, control2"),x.push(o),x.push(a);let t,i=[];g===0?t=this.create2PBezier(v[g],o,v[g+1],50):t=this.create3PBezier(v[g],x[2*g-1],o,v[g+1],50),g+2===y-1&&(i=this.create2PBezier(v[g+1],a,v[g+2],50)),g+2===y-1?m=[...m,...t,...i]:m=[...m,...t]}return m}},create2PBezier(v,d,y,m=100,x=1){const g=x/(m-1),b=[];for(let f=0;f<m;f++){const n=this.getBezierNowPoint2P(v,d,y,f,g);b.push({x:n.x,y:n.y})}return b},getBezierNowPoint2P(v,d,y,m,x){return{x:this.bezier2P(v.x,d.x,y.x,m*x),y:this.bezier2P(v.y,d.y,y.y,m*x)}},bezier2P(v,d,y,m){const x=v*Math.pow(1-m,2),g=d*2*m*(1-m),b=y*m*m;return x+g+b},bezier3P(v,d,y,m,x){const g=v*Math.pow(1-x,3),b=3*d*x*Math.pow(1-x,2),f=3*y*Math.pow(x,2)*(1-x),n=m*Math.pow(x,3);return g+b+f+n},getBezierNowPoint3P(v,d,y,m,x,g){return{x:this.bezier3P(v.x,d.x,y.x,m.x,x*g),y:this.bezier3P(v.y,d.y,y.y,m.y,x*g)}},create3PBezier(v,d,y,m,x=100,g=1){const b=x,n=g/(b-1),o=[];for(let a=0;a<b;a++){const t=this.getBezierNowPoint3P(v,d,y,m,a,n);o.push({x:t.x,y:t.y})}return o}};class N_{constructor(d){Fe(this,"name","pen");Fe(this,"options");Fe(this,"radius",2);Fe(this,"lineCache");Fe(this,"shape");Fe(this,"startPoint");Fe(this,"firstPen",[]);Fe(this,"penGroup",[[],[]]);Fe(this,"isDrawing",!1);Fe(this,"isEditing",!1);Fe(this,"BezierControl");Fe(this,"strokeWidth",1);this.strokeWidth=1/d.getZoom(),this.options=d}createPenPath(d){const y=new Me.fabric.Path(d,{...mt()});return y.set("hasBezierControl",[]),y}makePenPath(d,y,m,x,g){var t;this.options.client!=="PC"&&((t=this.lineCache)==null||t.set({x2:d.x,y2:d.y}));let b=new Me.fabric.Line([d.x,d.y,d.x,d.y],{...Gi(),evented:!1,selectable:!1,strokeWidth:this.strokeWidth});this.lineCache=b;const f=this.radius,n=this.options.client!=="PC"?3:0,o=this.makePenCircle(d,f);let a=0;if(m){for(let i=0;i<2;i++){const r=y[i],e=m[i];Math.abs(r-e)<f+n&&a++}if(a===2){x==null||x.set({x2:y[0],y2:y[1]}),b=null;const i=this.clearAssistObject(!0),r=this.createPenPath(i);this.options.addElement(r),this.options.recordOperate(r),this.options.setSelection(r)}}return b&&(g[0].push(b),g[1].push(o),this.options.addElement(b),this.options.addElement(o)),this.options.renderCanvas(),b}makePenCircle(d,y=2,m={}){return new Me.fabric.Circle({...Gi(),left:d.x,top:d.y,strokeWidth:this.strokeWidth,fill:"white",radius:y,originX:"center",originY:"center",evented:!1,strokeUniform:!0,selectable:!1,hasBorders:!1,hasControls:!1,hoverCursor:"default",...m})}createBezierPoint(d,y,m,x,g,b,f=!0,n,o,a){const t=g.get(x),i=t.cricle.getCenterPoint();let r,e;if(n)r=d,e=y;else{const{control1:p,control2:_}=B_.createSmoothLineControlPoint(new Pt(d.x,d.y),new Pt(i.x,i.y),new Pt(y.x,y.y),.3);r=p,e=_}const l=this.makePenCircle(r,2,{evented:!0,selectable:!0,visible:f}),s=this.makePenCircle(e,2,{evented:!0,selectable:!0,visible:f}),c=new Me.fabric.Line([r.x,r.y,e.x,e.y],{...Gi(),evented:!1,selectable:!1,visible:f,strokeWidth:this.strokeWidth});t.line=c,t.cricle1=l,t.cricle2=s;const u=()=>{const p=m.path,_=p[x];let w,S;x+1===p.length?(S=1,b||(S=0),w=p[S]):(S=x+1,w=p[S]);const C=[..._];_[0]==="Q"&&(C[1]=t.cricle1.left,C[2]=t.cricle1.top),_[0]==="C"&&(C[3]=t.cricle1.left,C[4]=t.cricle1.top);const E=[...w];E[0]!=="M"&&(E[1]=t.cricle2.left,E[2]=t.cricle2.top),p[x]=C,p[S]=E,this.updatePenPath(m,p),l.setCoords(),s.setCoords()};l.on("mousemove",()=>{this.calcDiagonal(l,s,1,t.cricle,c),u()}),s.on("mousemove",()=>{this.calcDiagonal(l,s,2,t.cricle,c),u()}),o&&this.calcDiagonal(l,s,2,t.cricle,c),a&&this.calcDiagonal(l,s,1,t.cricle,c);const h=this.options.getObjects().indexOf(t.cricle);return this.options.addElement(c),this.options.addElement(l),this.options.addElement(s),l.moveTo(h),s.moveTo(h),c.moveTo(h),{control1:r,control2:e}}calcDiagonal(d,y,m,x,g){const b=x.getCenterPoint(),f={x:0,y:0};m===1?(f.y=b.y-d.top,f.x=b.x-d.left,y.set({top:b.y+f.y,left:b.x+f.x})):(f.y=b.y-y.top,f.x=b.x-y.left,d.set({top:b.y+f.y,left:b.x+f.x})),g.set({x1:d.left,y1:d.top,x2:y.left,y2:y.top})}updatePenPath(d,y,m={}){d.path=y;const x=d._calcDimensions(),g=d.strokeWidth/2;d.set({width:x.width,height:x.height,left:x.left,top:x.top,pathOffset:{x:x.width/2+x.left+g,y:x.height/2+x.top+g},dirty:!0,...m}),d.setCoords(),this.options.renderCanvas()}onMouseDblClick(d){var n,o;if(!d.target||!(Object.hasOwn(d.target,"hasBezierControl")&&((n=d.target)==null?void 0:n.type)==="path")||this.isEditing)return;this.exitEdit();const m=d.target,x=new Map;this.BezierControl=x,this.isEditing=!0,this.options.setSelectable(!1),this.shape=m,this.options.setSelection(),(o=this.shape)==null||o.set({lockMovementX:!0,lockMovementY:!0});const g=[],b=Me.fabric.util.transformPath(m.path,m.calcOwnMatrix(),m.pathOffset);this.updatePenPath(m,b,{scaleX:1,scaleY:1,angle:0,skewX:0,skewY:0});const f=m.path;f.forEach((a,t)=>{let i=!0;const r=f[f.length-1];if((f[0][1]!==r[r.length-2]||f[0][2]!==r[r.length-1])&&(i=!1),t===0&&i)return;const e={};x.set(t,e);const l=this.makePenCircle({x:b[t][b[t].length-2],y:b[t][b[t].length-1]},this.radius,{evented:!0,selectable:!0});let s;if(e.cricle=l,g.push(l),m.hasBezierControl[t]){let u=!1,h=!1;const p={x:0,y:0},_={x:0,y:0},w=f[t];if(w[0]==="M"){const E=f[t+1];_.x=E[1],_.y=E[2],u=!0}w[0]==="Q"&&(p.x=w[1],p.y=w[2]),w[0]==="C"&&(p.x=w[3],p.y=w[4]);let S,C;t+1===f.length?(C=1,i||(C=0),S=f[C]):(C=t+1,S=f[C]),S[0]==="M"?h=!0:(_.x=S[1],_.y=S[2]),this.createBezierPoint(p,_,m,t,x,i,!1,!0,u,h)}let c=!1;l.on("mousedblclick",()=>{if(m.hasBezierControl[t])return;m.hasBezierControl[t]=!0;const u=f[t];let h,p;i?t===1?(p=f.length-1,h=f[p]):(p=t-1,h=f[p]):t===0?(p=f.length-1,h=f[p]):(p=t-1,h=f[p]);const _={x:h[h.length-2],y:h[h.length-1]},w={x:0,y:0};let S,C;t+1===f.length?(C=1,i||(C=0),S=f[C]):(C=t+1,S=f[C]),w.x=S[S.length-2],w.y=S[S.length-1],u[0]==="Q"&&(_.x=u[1],_.y=u[2]),S[0]==="Q"&&(w.x=S[1],w.y=S[2]);const{control1:E,control2:k}=this.createBezierPoint(_,w,m,t,x,i),O=[...u];u[0]==="Q"?(O[0]="C",O.splice(3,0,E.x,E.y)):u[0]==="L"&&(O[0]="Q",O.splice(1,0,E.x,E.y));const U=[...S];S[0]==="L"?(U[0]="Q",U.splice(1,0,k.x,k.y)):S[0]==="Q"&&(U[0]="C",U.splice(1,0,k.x,k.y)),f[t]=O,f[C]=U,this.updatePenPath(m,f)}),l.on("mousemove",()=>{if(!c)return;const u=l.getCenterPoint(),h=f[t];let p,_;t+1===f.length?(_=1,i||(_=0),p=f[_]):(_=t+1,p=f[_]);const w=x.get(t);if(w!=null&&w.cricle2){const E=s.x-u.x,k=s.y-u.y;w.cricle2.set({top:w.c2DownPoint.top-k,left:w.c2DownPoint.left-E}),w.cricle1.set({top:w.c1DownPoint.top-k,left:w.c1DownPoint.left-E}),w.line.set({x1:w.lineDownPoint.x1-E,y1:w.lineDownPoint.y1-k,x2:w.lineDownPoint.x2-E,y2:w.lineDownPoint.y2-k}),w.cricle1.setCoords(),w.cricle2.setCoords()}i&&t===f.length-1&&(f[0][1]=u.x,f[0][2]=u.y);const S=[...h];h[0]==="M"&&(S[1]=u.x,S[2]=u.y),h[0]==="L"&&(S[1]=u.x,S[2]=u.y),h[0]==="Q"&&(m.hasBezierControl[t]&&(S[1]=w.cricle1.left,S[2]=w.cricle1.top),S[3]=u.x,S[4]=u.y),h[0]==="C"&&(S[3]=w.cricle1.left,S[4]=w.cricle1.top,S[5]=u.x,S[6]=u.y);const C=[...p];C[0]==="Q"&&m.hasBezierControl[t]&&(C[1]=w.cricle2.left,C[2]=w.cricle2.top),C[0]==="C"&&(C[1]=w.cricle2.left,C[2]=w.cricle2.top),f[t]=S,f[_]=C,this.updatePenPath(m,f)}),l.on("mousedown",u=>{c=!0,s=l.getCenterPoint();const h=x.get(t);h.cricle1&&(h.c1DownPoint={top:h.cricle1.top,left:h.cricle1.left},h.c2DownPoint={top:h.cricle2.top,left:h.cricle2.left},h.lineDownPoint={x1:h.line.x1,y1:h.line.y1,x2:h.line.x2,y2:h.line.y2}),g.forEach((p,_)=>{var C,E,k,O,U,F;let w=_+1;i||(w=_);const S=x.get(w);p.id!==l.id?((C=S==null?void 0:S.line)==null||C.set({visible:!1}),(E=S==null?void 0:S.cricle1)==null||E.set({visible:!1}),(k=S==null?void 0:S.cricle2)==null||k.set({visible:!1}),p.set({fill:"white"})):((O=S==null?void 0:S.line)==null||O.set({visible:!0}),(U=S==null?void 0:S.cricle1)==null||U.set({visible:!0}),(F=S==null?void 0:S.cricle2)==null||F.set({visible:!0}),p.set({fill:Dt.stroke}))}),Ss("cricleEvent",()=>{u.isFire||(l.fire("mousedblclick"),l.fire("mousedown",{isFire:!0}))})}),l.on("mouseup",()=>{c=!1}),this.options.addElement(l)})}startDrawPen(){this.isDrawing=!0}clearAssistObject(d){this.lineCache=void 0;let y="M ".concat(this.firstPen[0]," ").concat(this.firstPen[1]);return this.penGroup[0].forEach((m,x)=>{if(this.options.removeElement(m),this.options.removeElement(this.penGroup[1][x]),!d&&x===this.penGroup[1].length-1){const g=this.createPenPath(y);g.set("hasBezierControl",[]),this.options.addElement(g),this.options.recordOperate(g),this.options.setSelection(g);return}y+=" L ".concat(m.x2," ").concat(m.y2)}),this.penGroup[0]=[],this.penGroup[1]=[],y}onExitDrawMode(){this.exitPen()}exitPen(){var y;const d=localStorage.getItem("setOption")?JSON.parse(localStorage.getItem("setOption")):{openAdsorb:!1,perPixelTargetFind:!1};this.options.setOpenAdsorb(d.openAdsorb),(y=this.shape)==null||y.set({lockMovementX:!1,lockMovementY:!1}),this.options.setDefaultCursor(),this.isEditing&&this.exitEdit(),this.isDrawing&&(this.clearAssistObject(),this.isDrawing=!1,this.options.setSelectable(!0),this.shape=null,this.firstPen=[],this.options.reCalcStrokeWidth())}exitEdit(){this.shape&&(this.isEditing=!1,this.BezierControl.forEach(d=>{for(const y in d){const m=d[y];m instanceof Me.fabric.Object&&(m.off(),this.options.removeElement(m))}}),this.options.setSelectable(!0),this.options.recordOperate(this.shape),this.shape&&this.options.setSelection(this.shape),this.shape=null)}destroyed(){}onZoom({zoomRate:d}){this.strokeWidth=1/d}onMouseDown(d){if(!this.isDrawing){this.options.client==="Mobile"&&this.isEditing&&!d.target&&this.options.exitDrawMode();return}this.options.setSelectable(!1);const y=this.startPoint=this.options.getPointer(d),m=[y.x,y.y,y.x,y.y];let x=this.firstPen,g=m;x!=null&&x.length||(this.firstPen=m,g=null),this.shape=this.makePenPath(y,x,g,this.shape,this.penGroup),this.shape||(this.exitPen(),x=[])}onMouseMove(d){if(this.options.client==="PC"&&this.isDrawing&&this.shape){const y=this.options.getPointer(d)||{x:0,y:0};this.shape.set({x1:this.startPoint.x,y1:this.startPoint.y,x2:y.x,y2:y.y}),this.options.renderCanvas()}}}function Gi(){return{id:"el-"+fl(),name:Dt.name,strokeWidth:Dt.strokeWidth,stroke:Dt.stroke,fill:Dt.fill}}function gr(v="el"){return"".concat(v,"-").concat(fl())}function qn(v,d,y){const m=d.x,x=d.y,g=v.x,b=v.y,f=m+(g-m)*Math.cos(y*Math.PI/180)-(b-x)*Math.sin(y*Math.PI/180),n=x+(g-m)*Math.sin(y*Math.PI/180)+(b-x)*Math.cos(y*Math.PI/180);return{x:Number(f.toFixed(1)),y:Number(n.toFixed(1)),angle:y}}function sa(v,d){return d!==_i.MM?"".concat((v/25.4).toFixed(3)):"".concat(v==null?void 0:v.toFixed(1))}function Kn(v){return v*25.4}class z_{constructor(d){Fe(this,"rulerX");Fe(this,"rulerY");Fe(this,"unit",_i.MM);Fe(this,"preParams");this.rulerX=d.rulerX,this.rulerY=d.rulerY,this.unit=d.unit,this.preParams={stageX:d.stageX,stageY:d.stageY,canvasWidth:d.canvasWidth,canvasHeight:d.canvasHeight,zoomRate:d.zoomRate},this.drawAll(d.stageX,d.stageY,d.canvasWidth,d.canvasHeight,d.zoomRate)}getGridSize(d){let y,m=100;return this.unit===_i.INCH?(y=Kn(1),m=Kn(10)):d<=.1?(y=400,m=200):d<=.75?y=200:d<=1.25?y=50:d<2.5?y=10:(y=5,m=50),{gridSize:y,fullUnit:m}}drawX(d,y,m){this.rulerX&&(this.rulerX.width=m,this.draw(this.rulerX,!1,d,y,m))}drawY(d,y,m){this.rulerY&&(this.rulerY.height=m,this.draw(this.rulerY,!0,d,y,m))}draw(d,y,m,x,g,b=20){const f=d.getContext("2d");if(f){f.clearRect(0,0,d.width,d.height),f.save();const n=m;let o=0,a=0,t=0;y?(f.translate(b,0),f.rotate(90*Math.PI/180),o=b,a=10,t=0):(o=0,a=b-10,t=b);const{gridSize:i,fullUnit:r}=this.getGridSize(m);let e=-x,l=0;e<0?(l-=e%i*n,e=e-e%i):(l+=(i-e%i)*n,e=e+i-e%i);const s=i*n;for(f.beginPath(),f.strokeStyle="rgb(210, 210, 210)";e<=g/m-x;)f.moveTo(l,t),Number(e.toFixed(2))%r===0?(f.lineTo(l,o),f.fillText(parseInt(sa(e,this.unit)).toString(),l+2,a)):f.lineTo(l,a),l+=s,e+=i;f.stroke(),f.closePath(),f.restore()}}drawAll(d,y,m,x,g){this.preParams={stageX:d,stageY:y,canvasWidth:m,canvasHeight:x,zoomRate:g},this.drawX(g,d,m),this.drawY(g,y,x)}onCanvasDraging({stageX:d,stageY:y,canvasWidth:m,canvasHeight:x,zoomRate:g}){this.drawAll(d,y,m,x,g)}onCanvasResize({stageX:d,stageY:y,canvasWidth:m,canvasHeight:x,zoomRate:g}){this.drawAll(d,y,m,x,g)}onZoom({stageX:d,stageY:y,canvasWidth:m,canvasHeight:x,zoomRate:g}){this.drawAll(d,y,m,x,g)}onUnitChange(d){console.log("ruler unit type",d),this.unit=d;const{stageX:y,stageY:m,canvasWidth:x,canvasHeight:g,zoomRate:b}=this.preParams;this.drawAll(y,m,x,g,b)}}const Qn={ruler:z_,gridBackground:R_,pen:N_},Jn=["onMouseDown","onMouseMove","onMouseUp","onSelected","onCanvasDraging","onCanvasResize","onZoom","onExitDrawMode","onMouseDblClick","onUnitChange"];class j_{constructor(){Fe(this,"_plugins");this._plugins=[]}parse(d,y){d.forEach(m=>{const{name:x="",options:g}=m;if(Qn[x]){const b=new Qn[x]({...g,...y}),f={name:x,_plugin:b};Jn.forEach(n=>{f[n]=b[n]}),this.addPlugin(f,b)}else this.addPlugin(m)})}getPlugin(d){return this._plugins.find(m=>m.name===d)||null}addPlugin(d,y){this.includePlugin(d)||(this._plugins.push(d),this.bindFunc(d,y||d))}removePlugin(d){const y=this._plugins.findIndex(m=>d.name===m.name);y>=0&&this._plugins.splice(y,1)}includePlugin(d){for(let y=0;y<this._plugins.length;y++)if(this._plugins[y].name===d.name)return this._plugins[y];return!1}bindFunc(d,y){Jn.forEach(m=>{$e(d[m])&&(d[m]=d[m].bind(y))})}onMouseDown(d){this._plugins.forEach(y=>{$e(y.onMouseDown)&&y.onMouseDown(d)})}onMouseMove(d){this._plugins.forEach(y=>{$e(y.onMouseMove)&&y.onMouseMove(d)})}onMouseUp(d){this._plugins.forEach(y=>{$e(y.onMouseUp)&&y.onMouseUp(d)})}onMouseDblClick(d){this._plugins.forEach(y=>{$e(y.onMouseDblClick)&&y.onMouseDblClick(d)})}onSelected(d){this._plugins.forEach(y=>{$e(y.onSelected)&&y.onSelected(d)})}onCanvasDraging(d){this._plugins.forEach(y=>{$e(y.onCanvasDraging)&&y.onCanvasDraging(d)})}onCanvasResize(d){this._plugins.forEach(y=>{$e(y.onCanvasResize)&&y.onCanvasResize(d)})}onZoom(d){this._plugins.forEach(y=>{$e(y.onZoom)&&y.onZoom(d)})}onUnitChange(d){this._plugins.forEach(y=>{$e(y.onUnitChange)&&y.onUnitChange(d)})}setOpenAdsorb(d){this._plugins.forEach(y=>{$e(y.setOpenAdsorb)&&y.setOpenAdsorb(d)})}adsorbCalcXY(d){this._plugins.forEach(y=>{$e(y.calcXY)&&y.calcXY(d.target,d.e)})}adsorbSetGaps(){this._plugins.forEach(d=>{$e(d.setGaps)&&d.setGaps()})}onSelectionUpdated(d){this._plugins.forEach(y=>{$e(y.onSelectionUpdated)&&y.onSelectionUpdated(d)})}onSelectionCreated(d){this._plugins.forEach(y=>{$e(y.onSelectionCreated)&&y.onSelectionCreated(d)})}onExitDrawMode(d){this._plugins.forEach(y=>{$e(y.onExitDrawMode)&&y.onExitDrawMode(d)})}destroy(){this._plugins=[]}}class H_{constructor(){Fe(this,"Mesh");const d=Me.fabric.util.createClass(Me.fabric.Image.filters.BaseFilter,{type:"Mesh",initialize(y){this.setOptions({type:"Mesh",webgl:!1,...y})},applyTo2d:function(y){const m=y.sourceWidth,x=y.sourceHeight,g=6,b=Math.ceil(x/g)-0,f=Math.ceil(m/g)-0,n=document.createElement("canvas");n.width=m,n.height=x;const o=n.getContext("2d");o.putImageData(y.imageData,0,0),o.save();const a=255,t=255,i=255,r=255*.1,e="rgba(".concat(a,", ").concat(t,", ").concat(i,", ").concat(r/255,")"),l=1;for(let u=0;u<f;u++)o.beginPath(),o.strokeStyle=e,o.lineWidth=l,o.moveTo(u*g,0),o.lineTo(u*g,x),o.stroke();for(let u=0;u<b;u++)o.beginPath(),o.strokeStyle=e,o.lineWidth=l,o.moveTo(0,u*g),o.lineTo(m,u*g),o.stroke();o.restore();const s=o.getImageData(0,0,m,x),c=y.imageData.data;for(let u=0;u<c.length;u+=4)c[u+3]===0&&(s.data[u]=0,s.data[u+1]=0,s.data[u+2]=0,s.data[u+3]=0);y.imageData=s}});this.Mesh=d,Me.fabric.Image.filters.Mesh=d,Me.fabric.Image.filters.Mesh.fromObject=Me.fabric.Image.filters.BaseFilter.fromObject}}class G_{constructor(){Fe(this,"Sketch");Fe(this,"radius",1);Fe(this,"sigma",.7);const d=Me.fabric.util.createClass(Me.fabric.Image.filters.BaseFilter,{type:"Sketch",initialize(y){this.setOptions({type:"Sketch",webgl:!1,...y})},applyTo2d:y=>{const m=y.sourceWidth,x=y.sourceHeight,g=document.createElement("canvas");g.width=m,g.height=x;let b=y.originalImageData.data;const f=[];for(let n=0;n<b.length;n+=4){const o=b[n],a=b[n+1],t=b[n+2],i=.3*o+.59*a+.11*t;f.push(i),f.push(i),f.push(i),f.push(b[n+3]);const r=255-i;b[n]=r,b[n+1]=r,b[n+2]=r}y.originalImageData=this.gaussBlur(y.originalImageData,this.radius,this.sigma),b=y.originalImageData.data;for(let n=0;n<b.length;n+=4){const o=Math.min(f[n]+f[n]*b[n]/(255-b[n]),255);b[n]=o,b[n+1]=o,b[n+2]=o}y.imageData=y.originalImageData}});this.Sketch=d,Me.fabric.Image.filters.Sketch=d,Me.fabric.Image.filters.Sketch.fromObject=Me.fabric.Image.filters.BaseFilter.fromObject}gaussBlur(d,y,m){const x=d.data,g=d.width,b=d.height;y=y||5,m=m||y/3;const f=y*2+1,n=[];let o=0;const a=1/(2*m*m*Math.PI),t=-a*Math.PI;for(let r=-y;r<=y;r++)for(let e=-y;e<=y;e++){const l=a*Math.exp((r*r+e*e)*t);n.push(l),o+=l}const i=(y+1)*(y+1);for(let r=0;r<i;r++)n[r]=n[r]/o;for(let r=0;r<g;r++)for(let e=0;e<b;e++){let l=0,s=0,c=0;for(let h=-y;h<=y;h++){const p=this.handleEdge(h,r,g);for(let _=-y;_<=y;_++){const S=(this.handleEdge(_,e,b)*g+p)*4,C=_+y,E=h+y;l+=x[S]*n[C*f+E],s+=x[S+1]*n[C*f+E],c+=x[S+2]*n[C*f+E]}}const u=(e*g+r)*4;x[u]=~~l,x[u+1]=~~s,x[u+2]=~~c}return d}handleEdge(d,y,m){let x=y+d;return x<0?x=-x:x>=m&&(x=m+d-y),x}}class W_{constructor(){Fe(this,"Comic");const d=Me.fabric.util.createClass(Me.fabric.Image.filters.BaseFilter,{type:"Comic",initialize(y){this.setOptions({type:"Comic",webgl:!1,...y})},applyTo2d:y=>{const m=y.sourceWidth,x=y.sourceHeight,g=document.createElement("canvas");g.width=m,g.height=x;const b=g.getContext("2d"),f=y.originalImageData.data;for(let n=0;n<f.length;n+=4){const o=f[n+0],a=f[n+1],t=f[n+2],i=(o+a+t)/3;f[n+0]=f[n+1]=f[n+2]=i>=128?255:0}b.putImageData(y.originalImageData,0,0),y.imageData=y.originalImageData}});this.Comic=d,Me.fabric.Image.filters.Comic=d,Me.fabric.Image.filters.Comic.fromObject=Me.fabric.Image.filters.BaseFilter.fromObject}}class Y_{constructor(){Fe(this,"ColorScale");const d=Me.fabric.util.createClass(Me.fabric.Image.filters.BaseFilter,{type:"ColorScale",input_shadows:0,input_highlights:255,initialize(y){this.setOptions({type:"ColorScale",webgl:!1,...y})},applyTo2d:function(y){const m=this.input_shadows,x=this.input_highlights,g=255,b=0,f=y.imageData.data;for(let n=0;n<f.length;n+=4){const o=f[n+0],a=f[n+1],t=f[n+2];f[n+0]=(o-m)/(x-m)*(g-b)+b,f[n+1]=(a-m)/(x-m)*(g-b)+b,f[n+2]=(t-m)/(x-m)*(g-b)+b,f[n+0]=Math.min(255,Math.max(0,f[n+0])),f[n+1]=Math.min(255,Math.max(0,f[n+1])),f[n+2]=Math.min(255,Math.max(0,f[n+2]))}}});this.ColorScale=d,Me.fabric.Image.filters.ColorScale=d,Me.fabric.Image.filters.ColorScale.fromObject=Me.fabric.Image.filters.BaseFilter.fromObject}}class X_{constructor(){Fe(this,"Mesh",new H_);Fe(this,"Sketch",new G_);Fe(this,"Comic",new W_);Fe(this,"ColorScale",new Y_)}}let Ot=1,Wi=1;const vr=["top","centerY","bottom"],br=["left","centerX","right"];class $_{constructor(d){Fe(this,"switch",!0);Fe(this,"unit");Fe(this,"el");Fe(this,"name","referLine");Fe(this,"options");Fe(this,"selectArray",[]);Fe(this,"coordsArray",[]);Fe(this,"cacheTop");Fe(this,"cacheLeft");Fe(this,"gaps",{top:0,bottom:0,centerY:0,left:0,right:0,centerX:0});Fe(this,"threshold",3);Fe(this,"startPoint",{});Fe(this,"mousePoint",{});Fe(this,"adsorbOffset",{x:0,y:0});Fe(this,"XreferLineArray",[[],[],[]]);Fe(this,"YreferLineArray",[[],[],[]]);this.unit=d.unit,this.options=d}setOpenAdsorb(d){this.switch=d}getAllIndex(d,y){const m=[];return y.forEach((x,g)=>{x===d&&m.push(g)}),m}getObjectRect(d){const y=d.getBoundingRect(!0);return{el:d,top:Number(y.top),bottom:Number(y.top+y.height),centerY:Number(y.top+y.height/2),left:Number(y.left),right:Number(y.left+y.width),centerX:Number(y.left+y.width/2),width:y.width,height:y.height}}calcXY(d,y){if(!this.switch||!this.coordsArray.length)return;!this.startPoint.x&&y&&(this.startPoint=this.options.getPointer(y)),this.cacheLeft=void 0,this.cacheTop=void 0,Wi=this.options.getZoom(),Ot=1/Wi,this.clearReferLine();const m=this.getObjectRect(d);let x,g,b=[],f=[];this.coordsArray.forEach(n=>{const o=[];vr.forEach(r=>{const e=[Math.abs(m.top-n[r]),Math.abs(m.bottom-n[r]),Math.abs(m.centerY-n[r])],l=Math.min(...e);o.push(Number(l.toFixed(1)))});const a=Math.min(...o);if(a<this.threshold&&(g||(g=a),a<g&&(b=[],g=a),a<=g)){const r=this.getAllIndex(a,o),e=[];r.forEach(l=>{b.length||e.push(vr[l]),b.length&&b[0].val[vr[l]]===n[vr[l]]&&e.push(vr[l])}),e.length&&b.push({keys:e,val:n})}const t=[];br.forEach(r=>{const e=[Math.abs(m.left-n[r]),Math.abs(m.right-n[r]),Math.abs(m.centerX-n[r])],l=Math.min(...e);t.push(Number(l.toFixed(1)))});const i=Math.min(...t);if(i<this.threshold&&(x||(x=i),i<x&&(f=[],x=i),i<=x)){const r=this.getAllIndex(i,t),e=[];r.forEach(l=>{f.length||e.push(br[l]),f.length&&f[0].val[br[l]]===n[br[l]]&&e.push(br[l])}),e.length&&f.push({keys:e,val:n})}}),(b.length||f.length)&&(f.length&&(this.cacheLeft=f,this.createXLine(f,m)),b.length&&(this.cacheTop=b,this.createYLine(b,m)),y&&this.mouseAdsorb(m))}createXLine(d,y){const m=[],x=[],g=new Array(3),b=new Array(3),f=new Array(3);d.forEach(n=>{const o=Math.min(n.val.top,y.top),a=Math.max(n.val.bottom,y.bottom);let t=!1;n.val.el.intersectsWithObject(y.el)||!(n.val.top<=y.top&&n.val.bottom>=y.top)&&!(n.val.bottom>=y.bottom&&n.val.top<=y.bottom)&&(t=!0),n.keys.forEach(i=>{let r=Number(n.val[i]);i==="centerX"&&(r-=Ot/2),i==="right"&&(r-=Ot);let e;if(t){let l=function(c){n.val.bottom>y.bottom?(!wr(b[c])||b[c]>n.val.top)&&(b[c]=n.val.top):(!wr(g[c])||g[c]<n.val.bottom)&&(g[c]=n.val.bottom)},s=n.val[n.keys[0]];switch(n.keys[0]==="centerX"&&(s-=Ot/2),n.keys[0]==="right"&&(s-=Ot),n.keys[0]){case"left":f[0]=s,l(0);break;case"centerX":f[1]=s,l(1);break;case"right":f[2]=s,l(2);break}e=new Me.fabric.Line([r,o,r,a],{...Yt()})}else e=new Me.fabric.Line([r,o,r,a],{...Yt()});m.push(e)})}),this.XreferLineArray[0].push(...m),this.options.addElement(...m);for(let n=0;n<f.length;n++){const o=f[n];g[n]&&x.push(new Me.fabric.Line([o,g[n],o,y.top],{...Yt(),stroke:"red"})),b[n]&&x.push(new Me.fabric.Line([o,y.bottom,o,b[n]],{...Yt(),stroke:"red"}))}x.length&&(this.createGap(x,!1),this.XreferLineArray[1].push(...x),this.options.addElement(...x))}createYLine(d,y){const m=[],x=[],g=new Array(3),b=new Array(3),f=new Array(3);d.forEach(n=>{const o=Math.min(n.val.left,y.left),a=Math.max(n.val.right,y.right);let t=!1;n.val.el.intersectsWithObject(y.el)||!(n.val.left<=y.left&&n.val.right>=y.left)&&!(n.val.right>=y.right&&n.val.left<=y.right)&&(t=!0),n.keys.forEach(i=>{let r=Number(n.val[i]);i==="centerY"&&(r-=Ot/2),i==="bottom"&&(r-=Ot);let e;if(t){let l=function(c){n.val.left>y.left?(!wr(b[c])||b[c]>n.val.left)&&(b[c]=n.val.left):(!wr(g[c])||g[c]<n.val.right)&&(g[c]=n.val.right)},s=n.val[n.keys[0]];switch(n.keys[0]==="centerY"&&(s-=Ot/2),n.keys[0]==="bottom"&&(s-=Ot),n.keys[0]){case"top":f[0]=s,l(0);break;case"centerY":f[1]=s,l(1);break;case"bottom":f[2]=s,l(2);break}e=new Me.fabric.Line([o,r,a,r],{...Yt()})}else e=new Me.fabric.Line([o,r,a,r],{...Yt()});m.push(e)})}),this.YreferLineArray[0].push(...m),this.options.addElement(...m);for(let n=0;n<f.length;n++){const o=f[n];g[n]&&x.push(new Me.fabric.Line([g[n],o,y.left,o],{...Yt(),stroke:"red"})),b[n]&&x.push(new Me.fabric.Line([y.right,o,b[n],o],{...Yt(),stroke:"red"}))}x.length&&(this.createGap(x,!0),this.YreferLineArray[1].push(...x),this.options.addElement(...x))}createGap(d,y){const m=[];for(let x=0;x<d.length;x++){const g=d[x],b=g.getPointByOrigin("center","center"),f=new Me.fabric.Text("".concat(y?sa(g.width,this.unit):sa(g.height,this.unit)).concat(this.unit),{...Yt(),fill:"red",stroke:void 0,fontSize:16/Wi});y?(f.setPositionByOrigin(b,"center","bottom"),this.YreferLineArray[2].push(f)):(f.setPositionByOrigin(b,"right","center"),this.XreferLineArray[2].push(f)),m.push(f)}this.options.addElement(...m)}mouseAdsorb(d){var m,x;if(this.XreferLineArray[0].length){let g=this.XreferLineArray[0][0].x1;const b=Math.min(Math.abs(d.left-g),Math.abs(d.centerX-g),Math.abs(d.right-g));br.forEach(n=>{const o=d[n];Math.abs(o-g)===b&&(n==="left"&&(g=g+this.gaps.left),n==="centerX"&&(g=g-d.width/2+this.gaps.left),n==="right"&&(g=g-d.width+Ot+this.gaps.left))}),Math.abs(g-d.el.left)>this.threshold+Ot&&(g=d.el.left,this.cacheLeft=void 0,delete this.mousePoint.x),(m=d.el)==null||m.set({left:g})}if(this.YreferLineArray[0].length){let g=this.YreferLineArray[0][0].y1;const b=Math.min(Math.abs(d.top-g),Math.abs(d.centerY-g),Math.abs(d.bottom-g));vr.forEach(n=>{const o=d[n];Math.abs(o-g)===b&&(n==="top"&&(g+=this.gaps.top),n==="centerY"&&(g=g-d.height/2+this.gaps.top),n==="bottom"&&(g=g-d.height+Ot+this.gaps.top))}),Math.abs(g-d.el.top)>this.threshold+Ot&&(g=d.el.top,this.cacheTop=void 0),(x=d.el)==null||x.set({top:g})}this.options.renderAll();const y=this.getObjectRect(d.el);this.clearReferLine(),this.cacheLeft&&this.createXLine(this.cacheLeft,y),this.cacheTop&&this.createYLine(this.cacheTop,y)}setGaps(){const d=this.options.getActiveObject(),y=this.getObjectRect(d);this.gaps.top=Math.abs(Number((Number(d.top)-y.top).toFixed(1))),this.gaps.centerY=Math.abs(Number((Number(d.top)-y.centerY).toFixed(1))),this.gaps.bottom=Math.abs(Number((Number(d.top)-y.bottom).toFixed(1))),this.gaps.left=Math.abs(Number((Number(d.left)-y.left).toFixed(1))),this.gaps.centerX=Math.abs(Number((Number(d.left)-y.centerX).toFixed(1))),this.gaps.right=Math.abs(Number((Number(d.left)-y.right).toFixed(1)))}onSelectionUpdated(d){this.onMouseDown(d)}onSelectionCreated(d){this.onMouseDown(d)}onMouseDown(d){if(this.el=d,!(d!=null&&d.selected))return;this.setGaps();const y=d.selected;this.clearObjects(),y.forEach(m=>{const x=m.getBoundingRect(!0),g={id:m.id,name:m.name,top:x.top,bottom:x.top+x.height,centerY:x.top+x.height/2,left:x.left,right:x.left+x.width,centerX:x.left+x.width/2,width:x.width,height:x.height};this.selectArray.push(g)}),this.coordsArray.length||this.options.getAllValidObjects().forEach(x=>{if(x.id&&x.name){for(let f=0;f<this.selectArray.length;f++)if(this.selectArray[f].id===x.id)return;const g=x.getBoundingRect(!0),b={el:x,id:x.id,name:x.name,top:g.top,bottom:g.top+g.height,centerY:g.top+g.height/2,left:g.left,right:g.left+g.width,centerX:g.left+g.width/2,width:g.width,height:g.height};this.coordsArray.push(b)}return x.id&&x.name})}onMouseUp(){this.startPoint={},this.mousePoint={},this.cacheLeft=void 0,this.cacheTop=void 0,this.adsorbOffset={x:0,y:0},this.clearReferLine()}clearObjects(){this.selectArray=[],this.coordsArray=[]}clearReferLine(){this.XreferLineArray.forEach(d=>{d.forEach(y=>{this.options.removeElement(y)})}),this.YreferLineArray.forEach(d=>{d.forEach(y=>{this.options.removeElement(y)})}),this.XreferLineArray=[[],[],[]],this.YreferLineArray=[[],[],[]]}onUnitChange(d){this.unit=d}}function Yt(){return{strokeWidth:Ot,stroke:Dt.stroke,evented:!1,selectable:!1}}class es{constructor(){Fe(this,"_stack");this._stack=[]}push(d){this._stack.push(d)}pop(){return this._stack.pop()}top(){return this._stack[this._stack.length-1]}isEmpty(){return this._stack.length===0}getStack(){return this._stack}clear(){this._stack=[]}}class V_{constructor(d){Fe(this,"operateStack");Fe(this,"redoStack");Fe(this,"maxLimit",50);Fe(this,"options");this.options=d,this.operateStack=new es,this.redoStack=new es,this.maxLimit=d.operateMaxLimit||this.maxLimit}pushCommand(d,y){const m={};d.forEach(x=>{m[x.id]=x}),this.operateStack.push({allIds:y,objJsons:m}),this.redoStack.clear()}undo(){if(this.operateStack.isEmpty())return;const d=this.operateStack.pop();if(!d)console.log("清除舞台");else{this.redoStack.push(d);const y=this.operateStack.top();this.update(d,y)}}redo(){if(this.redoStack.isEmpty())return;const d=this.redoStack.pop();if(!d)console.log("无操作");else{const y=this.operateStack.top();this.update(y,d),this.operateStack.push(d)}}update(d,y){const m=new Set(y==null?void 0:y.allIds),x=new Set(d==null?void 0:d.allIds),g=[],b=[],f=[];m.forEach(n=>{const o=this.findObjAttribute(n,y);o&&(x.has(n)?((d.objJsons[n]||y.objJsons[n])&&f.push(o),x.delete(n)):b.push(o))}),x.forEach(n=>{g.push(n)}),g.length>0&&(console.log("delete>>>"),this.options.removeElement(...g)),b.length>0&&(console.log("add>>>"),this.options.addElement(...b)),f.length>0&&(console.log("update>>>"),this.options.updateElement(...f))}findObjAttribute(d,y){if(y.objJsons[d])return{...y.objJsons[d]};const m=this.operateStack.getStack();for(let x=m.length-1;x>=0;x--)if(m[x].objJsons[d])return{...m[x].objJsons[d]};return null}getOperateStack(){return this.operateStack}getRedoStack(){return this.redoStack}destroy(){this.operateStack.clear(),this.redoStack.clear()}}var hi=(v=>(v.LEFT="left",v.RIGHT="right",v))(hi||{}),di=(v=>(v.PLANE="plane",v.CYLINDER="cylinder",v))(di||{});const vt=class vt extends x1.EventEmitter{constructor(y){super();Fe(this,"canvas");Fe(this,"isDrawing");Fe(this,"isDragMode");Fe(this,"drawType");Fe(this,"whiteScreen");Fe(this,"filters",new X_);Fe(this,"drawMinSize",.5);Fe(this,"backgroundImg");Fe(this,"canvasOptions");Fe(this,"pluginManager");Fe(this,"operateManager");Fe(this,"referLine");Fe(this,"id");Fe(this,"screenChangeRatio",1);Fe(this,"preSelection");Fe(this,"viewportRatio",.9);Fe(this,"svgPath","");Fe(this,"svgSize",100);Fe(this,"isImageExtrac",!1);Fe(this,"pathText","");Fe(this,"batchPreview",[]);Fe(this,"unit");Fe(this,"workMode");Fe(this,"originStageWidth");Fe(this,"originStageHeight");this.unit=y.unit,Me.fabric.enableGLFiltering=!1,this.canvasOptions={minZoom:.6,maxZoom:5,...y},this.originStageWidth=this.canvasOptions.stageWidth,this.originStageHeight=this.canvasOptions.stageHeight,this.workMode=di.PLANE,this.canvas=new Me.fabric.Canvas(y.container,{backgroundColor:"rgb(230,230,230)",imageSmoothingEnabled:!1,selection:!y.noSelection}),y.viewportRatio&&(this.viewportRatio=y.viewportRatio),Me.fabric.Object.prototype.objectCaching=!1,y.isOpenControlIcon&&new Dn(Me.fabric,this),this.canvas.setWidth(y.width),this.canvas.setHeight(y.height),this.isDrawing=!1,this.isDragMode=!1,this.drawType=ut.NONE,this.pluginManager=new j_,this.operateManager=new V_({operateMaxLimit:this.canvasOptions.operateMaxLimit||50,addElement:this.addElementFromJson.bind(this),removeElement:this.removeElementFromJson.bind(this),updateElement:this.updateElementFromJson.bind(this)}),this.initBackdrop(y),this.addIntelligentAdsorptionPlugin(),this.initEventListener(),this.initDragMode(),this.initDrawTools(),this.initPluginManagre({stageBorCor:y.stageBorCor||""}),this.throttleRender=sc(this.throttleRender,20),this.centerStage=$i(this.centerStage,100),this.id=y.id||gr("canvas"),console.log("Running at fabric.js ".concat(Me.fabric.version," timeStamp: ").concat(new Date)),this.setPreciseSelection(y.perPixelTargetFind),this.setOpenAdsorb(y.openAdsorb),this.canvas.preserveObjectStacking=!0,this.bindListener()}toggleControlsCanvas(y){this.canvas=y,new Dn(Me.fabric,this)}initBackdrop(y){this.whiteScreen=new Me.fabric.Rect({left:0,top:0,width:y.stageWidth||400,height:y.stageHeight||300,fill:"white",strokeWidth:0,strokeUniform:!0,selectable:!1,evented:!1}),this.canvas.add(this.whiteScreen);const m=new Me.fabric.Point((this.canvas.getWidth()-(this.whiteScreen.width||0))/2,(this.canvas.getHeight()-(this.whiteScreen.height||0))/2);this.canvas.relativePan(m),this.centerStage()}addIntelligentAdsorptionPlugin(){const y=new $_({addElement:this.canvas.add.bind(this.canvas),removeElement:this.canvas.remove.bind(this.canvas),getObjects:this.canvas.getObjects.bind(this.canvas),whiteScreenData:this.whiteScreenData,getAllValidObjects:this.getAllValidObjects.bind(this),getZoom:this.getZoom.bind(this),getPointer:this.canvas.getPointer.bind(this.canvas),renderAll:this.canvas.renderAll.bind(this.canvas),getActiveObject:this.canvas.getActiveObject.bind(this.canvas),unit:this.unit});this.addPlugin(y)}initPluginManagre(y){if(this.canvasOptions.plugins){const m=this.getCanvasDetail();this.pluginManager.parse(this.canvasOptions.plugins,{stageWidth:this.canvasOptions.stageWidth,stageHeight:this.canvasOptions.stageHeight,...m,...y,unit:this.unit,addElement:x=>{this.canvas.add(x)},removeElement:x=>{this.canvas.remove(x)},renderCanvas:()=>{this.canvas.requestRenderAll()},setSelectable:this.setSelectable.bind(this),getPointer:x=>this.canvas.getPointer(x.e),getObjects:()=>this.canvas.getObjects(),setSelection:x=>{x?this.canvas.setActiveObject(x):this.canvas.discardActiveObject()},reCalcStrokeWidth:(...x)=>{this.reCalcStrokeWidth(...x)},getZoom:()=>this.getZoom(),exitDrawMode:()=>this.exitDrawMode(),setDefaultCursor:()=>{this.setCursor(Tt.default)},setOpenAdsorb:x=>{this.setOpenAdsorb(x)},recordOperate:this.recordOperate.bind(this),client:this.canvasOptions.client||"PC"})}}bindListener(){this.onDrawPathTextMouseUp=this.onDrawPathTextMouseUp.bind(this),this.onEndDraw=this.onEndDraw.bind(this)}throttleRender(){this.canvas.requestRenderAll()}resize(y,m){wr(y)&&(this.canvas.setWidth(y),this.canvasOptions.width=y),wr(m)&&(this.canvasOptions.height=m,this.canvas.setHeight(m)),this.centerStage()}setCursor(y){this.canvas.defaultCursor=y,this.canvas.setCursor(y)}setBorderHover(y,m){(y==null?void 0:y.type)!=="image"&&(m?y==null||y.set({stroke:Mn.hoverBorderColor}):y==null||y.set({stroke:y.originStroke?y.originStroke:Mn.borderColor}),this.canvas.requestRenderAll())}initEventListener(){this.canvas.on("mouse:down",b=>{$e(this.pluginManager.onMouseDown)&&this.pluginManager.onMouseDown(b),this.setBorderHover(b.target,!1),this.emit(Ve.MOUSE_DOWN,b),this.canvasOptions.client==="Mobile"&&b.target&&Ss("canvasMouseDown",()=>{this.canvas.fire("mouse:dblclick",b)})}),this.canvas.on("mouse:move",b=>{$e(this.pluginManager.onMouseMove)&&this.pluginManager.onMouseMove(b),this.emit(Ve.MOUSE_MOVE,b)}),this.canvas.on("mouse:up",b=>{$e(this.pluginManager.onMouseUp)&&this.pluginManager.onMouseUp(b),this.emit(Ve.MOUSE_UP,b)}),this.canvas.on("mouse:over",b=>{this.setBorderHover(b.target,!0)}),this.canvas.on("mouse:out",b=>{var f;((f=b.target)==null?void 0:f.type)===Bt?b.target.getObjects().forEach(o=>{this.setBorderHover(o,!1)}):this.setBorderHover(b.target,!1)}),this.canvas.on("mouse:dblclick",b=>{this.isDragMode||($e(this.pluginManager.onMouseDblClick)&&this.pluginManager.onMouseDblClick(b),b.target&&Object.hasOwn(b.target,"hasBezierControl")&&b.target.hasBezierControl&&this.setOpenAdsorb(!1))});let y=!1;const m=$i(async()=>{const b=this.selection;if(b){const f=this.calcObjProperty(b);this.emit(Ve.ELEMENT_MODIFY,f)}},100),x=()=>{this.canvas.selection&&(y=!0,m(),$e(this.pluginManager.adsorbSetGaps)&&this.pluginManager.adsorbSetGaps())},g=()=>{const b=this.selection;window.selected=b;let f;b&&(f=this.calcObjProperty(b),this.emit(Ve.SELECTION_CHANGE,f,b))};this.canvas.on("selection:updated",b=>{$e(this.pluginManager.onSelectionUpdated)&&this.pluginManager.onSelectionUpdated(b),g()}).on("selection:created",b=>{$e(this.pluginManager.onSelectionCreated)&&this.pluginManager.onSelectionCreated(b),g()}).on("object:added",b=>{var f;(f=b.target)!=null&&f.id&&this.emit(Ve.ADDED,b)}).on("object:removed",b=>{var f;(f=b.target)!=null&&f.id&&this.emit(Ve.REMOVED,b)}).on("selection:cleared",()=>{this.emit(Ve.SELECTION_CLEAR),window.selected=null}).on("text:changed",x).on("object:moving",b=>{b.target&&this.canvas.selection&&$e(this.pluginManager.adsorbCalcXY)&&this.pluginManager.adsorbCalcXY(b),x()}).on("object:scaling",()=>{this.selection&&this.reCalcStrokeWidth(this.selection),x()}).on("object:rotating",x).on("object:skewing",x).on("mouse:up",async b=>{if(y){y=!1;const f=this.selection;if(f){if($e(this.pluginManager.onMouseUp)&&this.pluginManager.onMouseUp(b),f.type!==Bt&&f.name!==Dt.name)return;if(f.type===Bt){const n=await this.transformGroup(f);this.recordOperate(...n)}else this.recordOperate(f);this.computedElementZindex()}}})}_toFixed(y,m=1){return Number(y.toFixed(m))}toJSON(y){const{left:m=0,top:x=0,width:g=0,height:b=0,angle:f=0,scaleX:n=0,scaleY:o=0,isLock:a=!0,type:t,hasBezierControl:i,isVariableThickness:r,hasControls:e,originStroke:l}=y,c={id:y.id,type:t,left:m,top:x,width:g*n,height:b*o,angle:this._toFixed(f),isLock:a,hasBezierControl:i,isVariableThickness:r,hasControls:e,originStroke:l};if(y.type===Ke.IText&&(c.hasPath=!!y.path),t===Bt){const h=y.getObjects().map(p=>this.toJSON(p));c.children=h}return c}async getCanvasData(){this.canvas.discardActiveObject(),this.canvas.requestRenderAll();const y=this.getAllValidObjects(),m=[];for(let x=0;x<y.length;x++)if(y[x].type===Ke.group){const g=await this.transformGroup(y[x]);for(let b=0;b<g.length;b++){const f=await Vn.toObject(g[b]);m.push(f)}}else{const g=await Vn.toObject(y[x]);m.push(g)}return m}addPlugin(y){this.pluginManager.addPlugin(y)}removePlugin(y){this.pluginManager.removePlugin(y)}drawShape(y,m={x:60,y:60}){let x=null;const g=(this.originStageWidth-m.x)/2,b=(this.originStageHeight-m.y)/2;switch(y){case ut.TRIANGLE:x=new Me.fabric.Triangle({...mt(),left:g,top:b,width:m.x,height:m.y});break;case ut.CIRCLE:x=new Me.fabric.Ellipse({...mt(),left:g,top:b,rx:m.x/2,ry:m.y/2});break;case ut.RECT:x=new Me.fabric.Rect({...mt(),left:g,top:b,width:m.x,height:m.y});break}x&&(this.reCalcStrokeWidth(x),this.canvas.add(x),this.setObjectControlsToUnlock(),this.canvas.setActiveObject(x).requestRenderAll())}initDrawTools(){let y,m;const x={name:"drawTool",onMouseDown:g=>{if(!g.target&&this.isDrawing&&!y){switch(this.canvas.selection=!1,m=this.canvas.getPointer(g.e),this.drawType){case ut.RECT:y=new Me.fabric.Rect({...mt(),left:m.x,top:m.y,width:0,height:0});break;case ut.CIRCLE:y=new Me.fabric.Ellipse({...mt(),left:m.x,top:m.y,rx:0,ry:0});break;case ut.LINE:y=new Me.fabric.Line([m.x,m.y,m.x,m.y],mt());break;case ut.TEXT:y=new Me.fabric.IText("Hello",{...mt(),left:m.x,top:m.y,fontFamily:"Times New Roman"});break;case ut.TRIANGLE:y=new Me.fabric.Triangle({...mt(),left:m.x,top:m.y,width:0,height:0});break;case ut.SVG:this.handleSvgImage(m.x,m.y);break}y&&(this.reCalcStrokeWidth(y),y.originStroke=Nt.engrave,this.canvas.add(y)),this.setObjectControlsToUnlock()}},onMouseMove:g=>{if(this.isDrawing&&y){const b=this.canvas.getPointer(g.e)||{x:0,y:0},f=Math.min(b.x,m.x),n=Math.min(b.y,m.y);let o=Math.abs(b.x-m.x),a=Math.abs(b.y-m.y);const t=g.e.shiftKey,i=g.e.altKey;switch(t&&(o=a=Math.max(o,a)),i?(y.set({originX:"center",originY:"center"}),o*=2,a*=2):y.set({originX:"left",originY:"top"}),this.drawType){case ut.RECT:y.set({left:f,top:n,width:o,height:a});break;case ut.CIRCLE:y.set({left:f,top:n,rx:o/2,ry:a/2});break;case ut.LINE:let r=m.x,e=m.y,l=b.x,s=b.y;if(t){const c=Math.abs(r-l),u=Math.abs(e-s);c>u?s=e:l=r}if(i){const c=l-r,u=s-e;r-=c,e-=u}y.set({x1:r,y1:e,x2:l,y2:s});break;case ut.TRIANGLE:y.set({left:f,top:n,width:o,height:a});break}this.canvas.requestRenderAll()}},onMouseUp:g=>{if(this.isDrawing){if(this.isDrawing=!1,this.canvas.selection=!0,this.setCursor(Tt.default),y){if(this.drawType!==ut.TEXT&&Number(y.width)<this.drawMinSize&&Number(y.height)<this.drawMinSize){this.canvas.remove(y),y.off(),y=null;return}if(g.e.altKey){const{x:f,y:n}=y.getPointByOrigin("left","top");y.set({left:f,top:n,originX:"left",originY:"top"})}y.setCoords(),this.computedElementZindex(),this.recordOperate(y),this.canvas.setActiveObject(y).requestRenderAll()}y=null}}};this.addPlugin(x)}get selection(){return this.canvas.getActiveObject()}get selections(){return this.canvas.getActiveObjects()}get whiteScreenData(){return this.whiteScreen.toObject()}initDragMode(){let y=!1;const m={name:"dragStage",onMouseDown:()=>{this.isDragMode&&(this.canvas.selection=!1,y=!0)},onMouseMove:({e:x})=>{if(this.isDragMode&&(this.setCursor(Tt.grab),y)){const g=new Me.fabric.Point(x.movementX,x.movementY);if(this.canvas.relativePan(g),$e(this.pluginManager.onCanvasDraging)){const b=this.getCanvasDetail();this.pluginManager.onCanvasDraging(b)}}},onMouseUp:()=>{y=!1,this.isDragMode&&(this.canvas.selection=!0,this.isDragMode&&this.setCursor(Tt.grab))}};this.addPlugin(m)}startImageExtract(){this.isImageExtrac=!0,this.resize(this.canvasOptions.width,this.canvasOptions.height),this.setSelectable(!1),this.canvas.discardActiveObject(),this.backgroundImg.moveTo(this.canvas.getObjects().length)}stopImageExtract(){this.isImageExtrac=!1,this.setSelectable(!0),this.backgroundImg.moveTo(1)}startDrawRect(){this.drawType=ut.RECT,this.isDrawing=!0,this.setCursor(Tt.crosshair)}startDrawCircle(){this.drawType=ut.CIRCLE,this.isDrawing=!0,this.setCursor(Tt.crosshair)}startDrawLine(){this.drawType=ut.LINE,this.isDrawing=!0,this.setCursor(Tt.crosshair)}startDrawText(){this.drawType=ut.TEXT,this.isDrawing=!0,this.setCursor(Tt.text)}reverseTextPathSide(){const y=this.selection;y&&y.type===Ke.IText&&y.path&&(y.pathSide===hi.LEFT?y.pathSide=hi.RIGHT:y.pathSide=hi.LEFT,this.recordOperate(y))}convertPathToText(y){const m=this.selection,x=this.createTextFromPath(y,m);x&&(this.canvas.remove(m),this.recordOperate(x,m))}async convertElementToText(y){const m=this.selection;m&&(m.type===Ke.path?this.convertPathToText(y):m.clone(async x=>{x.set("fill","black");const g=5,b=x.toDataURL({multiplier:g}),{left:f,top:n}=x.getBoundingRect(!0),o=await cl(b,g,f,n),i=new DOMParser().parseFromString(o,"image/svg+xml").getElementsByTagName("path")[0].getAttribute("d");if(i){const r=new Me.fabric.Path(i);r.set({fill:"",stroke:"orange"}),this.reCalcStrokeWidth(r);const e=this.createTextFromPath(y,r);e&&(this.canvas.remove(m),this.recordOperate(e,m))}}))}createTextFromPath(y,m){if(Number(m.width)<.1||Number(m.height)<.1){this.canvas.isDrawingMode=!1;return}const x=Me.fabric.util.transformPath(m.path,m.calcTransformMatrix(),m.pathOffset);m=new Me.fabric.Path(x,m);const g=Me.fabric.util.getPathSegmentsInfo(x),b=new Me.fabric.IText(y,{fontFamily:"Times New Roman",path:m,top:m.top,left:m.left,...mt()}),{width:f}=b.measureLine(0),n=f/y.length,a=g[g.length-1].length/y.length;if(n>a){const e=a/n*40;b.set({fontSize:e>>0})}let t=(a-n)*1e3/40;t<0&&(t=0),b.set({charSpacing:t>>0}),this.reCalcStrokeWidth(b);const i=Number(b.width)-b.path.width,r=Number(b.height)-b.path.height;return b.set({left:Number(b.left)-i/2,top:Number(b.top)-r/2}),this.canvas.add(b),this.canvas.setActiveObject(b),b}onDrawPathTextMouseUp(y){const m=y.path,x=this.createTextFromPath(this.pathText,m);x&&this.recordOperate(x),this.canvas.isDrawingMode=!1,this.canvas.off("before:path:created",this.onDrawPathTextMouseUp)}onEndDraw(y){this.canvas.remove(y.path),this.canvas.off("path:created",this.onEndDraw)}startDrawPathText(y){this.canvas.isDrawingMode=!0,this.pathText=y,this.canvas.off("before:path:created",this.onDrawPathTextMouseUp),this.canvas.off("path:created",this.onEndDraw),this.canvas.on("before:path:created",this.onDrawPathTextMouseUp),this.canvas.on("path:created",this.onEndDraw)}startDrawPen(){this.setSelectable(!1);const y=this.pluginManager.getPlugin("pen");y&&(this.setOpenAdsorb(!1),this.setCursor(Tt.crosshair),y._plugin.startDrawPen())}startDrawTriangle(){this.drawType=ut.TRIANGLE,this.isDrawing=!0,this.setCursor(Tt.crosshair)}startDrawSvg(y){this.svgPath=y,this.drawType=ut.SVG,this.isDrawing=!0,this.setCursor(Tt.crosshair)}handleSvgImage(y=0,m=0){const x=document.createElement("img");x.src=this.svgPath;const g=Math.min(this.svgSize/x.width,this.svgSize/x.width);this.loadResource(x,{scaleX:g,scaleY:g,top:m,left:y})}async moveElement(y,m){const x=this.selection;if(x){const{left:g=0,top:b=0}=x;if(x.set({left:g+y,top:b+m}),x.setCoords(),this.throttleRender(),this.canvas.fire("object:moving"),x)if(x.type===Bt){const f=await this.transformGroup(x);this.recordOperate(...f)}else this.recordOperate(x)}}endDraw(){const y=this.pluginManager.getPlugin("drawTool");y!=null&&y.onMouseUp&&(y==null||y.onMouseUp({e:new MouseEvent("mouseup")}))}exitDrawMode(){this.endDraw(),this.isDrawing=!1,this.canvas.isDrawingMode=!1,this.canvas.selection=!0,this.setCursor(Tt.default),this.canvas.discardActiveObject();const y=localStorage.getItem("setOption")?JSON.parse(localStorage.getItem("setOption")):{openAdsorb:!1,perPixelTargetFind:!1};if(this.setOpenAdsorb(y.openAdsorb),$e(this.pluginManager.onExitDrawMode)){const m=this.getCanvasDetail();this.pluginManager.onExitDrawMode(m)}this.throttleRender()}removeSelection(){if(!this.canvas.selection)return;const y=this.canvas.getActiveObjects();this.canvas.discardActiveObject(),this.canvas.remove(...y),this.recordOperate(...y)}startDragStage(){!this.isDragMode&&!this.isImageExtrac&&(this.isDragMode=!0,this.preSelection=this.canvas.getActiveObjects(),this.canvas.discardActiveObject(),this.setSelectableAll(!1),this.setCursor(Tt.grab))}stopDragStage(){this.isDragMode&&!this.isImageExtrac&&(this.isDragMode=!1,this.setSelectableAll(!0),this.preSelection&&this.preSelection.length>0&&(this.preSelection.length===1?this.canvas.setActiveObject(this.preSelection[0]).requestRenderAll():this.selectAt(this.preSelection)),this.setCursor(Tt.default))}setSelectableAll(y){const m=this.getAllValidObjects();m==null||m.forEach(x=>{x.selectable=y})}selectAll(){const y=this.getAllValidObjects();if(y.length===0)return;this.canvas.discardActiveObject();const m=new Me.fabric.ActiveSelection(y,{canvas:this.canvas});this.canvas.setActiveObject(m),this.canvas.requestRenderAll()}selectAt(y,m={}){this.canvas.discardActiveObject();const x=new Me.fabric.ActiveSelection(y,{canvas:this.canvas,...m});return this.canvas.setActiveObject(x),this.canvas.requestRenderAll(),x}selectAtObj(y){this.canvas.discardActiveObject(),this.canvas.setActiveObject(y)}undo(){console.log("undo"),this.operateManager.undo(),this.emit(Ve.OPERATE)}redo(){console.log("redo"),this.operateManager.redo(),this.emit(Ve.OPERATE)}reCalcStrokeWidth(...y){const m=[];y.length===0&&(y=this.getAllValidObjects()),y.forEach(g=>{g.type===Bt||g.type===Ke.group?m.push(...g.getObjects()):m.push(g)});const x=this.canvas.getZoom();m.forEach(g=>{if(!g.strokeWidth||g.strokeWidth===0)return;const b=Math.max(g.scaleX||1,g.scaleY||1),f=g.group?Math.max(Number(g.group.scaleX),Number(g.group.scaleY)):1,n=x*(g.type==="i-text"?b*f:1);g.set("strokeWidth",Dt.strokeWidth/n)})}centerStage(){const y=this.canvas.getWidth(),m=this.canvas.getHeight(),x=(this.whiteScreen.width||0)/(this.whiteScreen.height||0),g=y*this.viewportRatio,b=m*this.viewportRatio,f=g/(this.whiteScreen.width||1),n=b/(this.whiteScreen.height||1);let o;if(f<n?(o=new Me.fabric.Point(-(y-g)/2,-(m-g/x)/2),this.screenChangeRatio=f):(o=new Me.fabric.Point(-(y-b*x)/2,-(m-b)/2),this.screenChangeRatio=n),this.canvas.setZoom(this.screenChangeRatio),this.canvas.absolutePan(o),this.reCalcStrokeWidth(),this.emit(Ve.ZOOM_IN,this.screenChangeRatio),$e(this.pluginManager.onCanvasResize)){const a=this.getCanvasDetail();this.pluginManager.onCanvasResize(a)}}zoomIn(y,m=1.2){const x=this.canvas.getPointer(y,!0);let b=this.canvas.getZoom()*m;const f=this.canvasOptions.maxZoom||1;if(b>f&&(b=f),this.canvas.zoomToPoint(x,b),this.reCalcStrokeWidth(),$e(this.pluginManager.onZoom)){const n=this.getCanvasDetail();this.pluginManager.onZoom(n)}this.throttleRender(),this.screenChangeRatio=b,this.emit(Ve.ZOOM_IN,b)}updateZoom(){this.reCalcStrokeWidth();const y=this.getCanvasDetail();this.pluginManager.onZoom(y)}zoomOut(y,m=1.2){const x=this.canvas.getPointer(y,!0);let b=this.canvas.getZoom()/m;const f=this.canvasOptions.minZoom||1;if(b<f&&(b=f),this.canvas.zoomToPoint(x,b),this.reCalcStrokeWidth(),$e(this.pluginManager.onZoom)){const n=this.getCanvasDetail();this.pluginManager.onZoom(n)}this.throttleRender(),this.emit(Ve.ZOOM_OUT,b)}zoomFinger(y,m){if(this.canvas.zoomToPoint(y,m),$e(this.pluginManager.onZoom)){const x=this.getCanvasDetail();this.pluginManager.onZoom(x)}this.screenChangeRatio=m,this.emit(Ve.ZOOM_OUT,m)}loadSVGFromString(y,m){return new Promise(x=>{Me.fabric.loadSVGFromString(y,async g=>{g.forEach(n=>{const o=n.stroke?n.stroke:n.fill;this._strokeColorToProcessMode(o)&&n.set({originStroke:o}),n.set(mt())}),this.canvas.add(...g);const b=this.selectAt(g);m&&m(b),this.reCalcStrokeWidth(...g),this.computedElementZindex();const f=await this.transformGroup(b);this.recordOperate(...f),this.setObjectControlsToLock(),this.throttleRender(),this.selectAt(g),x()})})}imagefromURL(y,m){return new Promise(x=>{Me.fabric.Image.fromURL(y,g=>{g.set({id:gr(),name:Fr}),this.canvas.add(g),this.computedElementZindex(),this.recordOperate(g),this.canvas.setActiveObject(g),this.setObjectControlsToLock(),x()},m)})}setBackground(y,m){const x=(m==null?void 0:m.width)||this.originStageWidth||y.width,g=(m==null?void 0:m.height)||this.originStageHeight||y.height,b=x/y.width,f=g/y.height;this.backgroundImg?this.backgroundImg.setElement(y):(this.backgroundImg=new Me.fabric.Image(y),this.canvas.insertAt(this.backgroundImg,1,!1),this.workMode===di.PLANE?this.backgroundImg.set({angle:0,left:0}):this.backgroundImg.set({angle:90,left:this.originStageHeight})),this.backgroundImg.set({scaleX:b,scaleY:f}),this.backgroundImg.set({selectable:!1,evented:!1}),this.throttleRender()}imageExtract(y){var c;const m=this.canvas.getZoom(),x=this.canvasOptions.container.getBoundingClientRect(),g=this.canvas.viewportTransform[4],b=this.canvas.viewportTransform[5],f=x.left+g,n=x.top+b;let o=!1,a,t,i,r;if(y.left>f?a=(y.left-f)/m:y.left<f&&(a=0),y.top>n?t=(y.top-n)/m:y.top<n&&(t=0),y.width+y.left>f&&(i=(y.width+y.left-f)/m),i>this.canvasOptions.stageWidth&&(i=this.canvasOptions.stageWidth),y.width+y.left<f&&(console.error("w error"),o=!0),y.height+y.top>n&&(r=(y.height+y.top-n)/m),r>this.canvasOptions.stageHeight&&(r=this.canvasOptions.stageHeight),y.height+y.top<n&&(console.error("h error"),o=!0),(a>this.canvasOptions.stageWidth||t>this.canvasOptions.stageHeight)&&(console.error("x || y error"),o=!0),o)return o;if(!this.backgroundImg)return;const e=this.backgroundImg.scaleY,l=this.backgroundImg.scaleY;t=t/l,r=r/l,a=a/e,i=i/e;const s=(c=this.backgroundImg)==null?void 0:c.toDataURL({top:t,left:a,width:i-a,height:r-t,quality:1,withoutTransform:!0});Me.fabric.Image.fromURL(s,u=>{u.set({id:gr(),name:Fr,top:t*l,left:a*e,scaleX:e,scaleY:l}),this.canvas.add(u),this.canvas.setActiveObject(u),this.recordOperate(u)})}clearBackground(){var y;(y=this.backgroundImg)!=null&&y.canvas&&this.canvas.remove(this.backgroundImg),this.canvas.add(this.whiteScreen)}updateProperty(y,m){const x=this.selections,g=this.selection;if(y in g&&x.length>0){if(y==="fill")x.forEach(b=>{if(b.type!=="image")switch(m){case Xt.engrave:b.set({fill:"",stroke:Nt.engrave,originStroke:Nt.engrave,strokeWidth:Dt.strokeWidth}),this.reCalcStrokeWidth(b);break;case Xt.fillEngrave:b.set({fill:Nt.fillEngrave,stroke:Nt.fillEngrave,originStroke:Nt.fillEngrave});break;case Xt.cut:b.set({fill:"",stroke:Nt.cut,originStroke:Nt.cut,strokeWidth:Dt.strokeWidth}),this.reCalcStrokeWidth(b);break}});else if(y==="height"){const b=m/g.height;g.isLock?(g.set("scaleY",b),g.set("scaleX",b),this.emit(Ve.UPDATE_ELEMENT_PROPERTY,{type:"width",value:Number((g.width*b).toFixed(1))})):g.set("scaleY",b),this.reCalcStrokeWidth(g),this.computedElementZindex()}else if(y==="width"){const b=m/g.width;g.isLock?(g.set("scaleY",b),g.set("scaleX",b),this.emit(Ve.UPDATE_ELEMENT_PROPERTY,{type:"height",value:Number((g.height*b).toFixed(1))})):g.set("scaleX",b),this.reCalcStrokeWidth(g),this.computedElementZindex()}else y==="angle"?g.rotate(m):g.set(y,m);x.length>=2?this.transformGroup(g).then(b=>{this.recordOperate(...b)}):this.recordOperate(g),this.throttleRender()}}async flipElement(y){const m=this.canvas.getActiveObject();if(m){m.rotate(-(m.angle||0)),y==="x"?m.toggle("flipX"):m.toggle("flipY"),m.setCoords(),this.canvas.requestRenderAll();const x=this.toJSON(m);if(m.type===Bt||m.type==="group"){const g=await this.transformGroup(m);this.recordOperate(...g)}else this.recordOperate(m);this.emit(Ve.ELEMENT_MODIFY,x)}}async rotate(y){const m=this.selection;if(!m)return;m.rotate((m.angle||0)+y),m.setCoords(),this.canvas.requestRenderAll();const x=this.toJSON(m);if(m.type===Bt||m.type==="group"){const g=await this.transformGroup(m);this.recordOperate(...g)}else this.recordOperate(m);this.emit(Ve.ELEMENT_MODIFY,x)}getZoom(){return this.canvas.getZoom()}setZoomToCenterPoint(y){const m=this.canvas.getCenterPoint();return this.canvas.zoomToPoint(m,y)}getStageOffset(){const y=this.whiteScreen.getBoundingRect(),m=this.getZoom();return y.left/=m,y.top/=m,{offsetX:y.left,offsetY:y.top}}getCanvasSize(){return{width:this.canvas.getWidth(),height:this.canvas.getHeight()}}getCanvasDetail(){const{offsetX:y,offsetY:m}=this.getStageOffset(),x=this.canvas.getZoom(),{width:g,height:b}=this.getCanvasSize();return{stageX:y,stageY:m,canvasWidth:g,canvasHeight:b,zoomRate:x}}async setAlignProcess(y){var b,f,n,o,a,t;const m=this.selections;switch(this.selectAt(m),y){case $t.LEFT:{const i=(b=this.selection)==null?void 0:b.width;m.forEach(r=>{const e=-i/2+r.getBoundingRect(!0,!0).width/2,l=r.getPointByOrigin("center","center").y,s=new Me.fabric.Point(e,l);r.setPositionByOrigin(s,"center","center")})}break;case $t.RIGHT:{const i=(f=this.selection)==null?void 0:f.width;m.forEach(r=>{const e=i/2-r.getBoundingRect(!0,!0).width/2,l=r.getPointByOrigin("center","center").y,s=new Me.fabric.Point(e,l);r.setPositionByOrigin(s,"center","center")})}break;case $t.UP:{const i=(n=this.selection)==null?void 0:n.height;m.forEach(r=>{const e=-i/2+r.getBoundingRect(!0,!0).height/2,l=r.getPointByOrigin("center","center").x,s=new Me.fabric.Point(l,e);r.setPositionByOrigin(s,"center","center")})}break;case $t.DOWN:{const i=(o=this.selection)==null?void 0:o.height;m.forEach(r=>{const e=i/2-r.getBoundingRect(!0,!0).height/2,l=r.getPointByOrigin("center","center").x,s=new Me.fabric.Point(l,e);r.setPositionByOrigin(s,"center","center")})}break;case $t.XCENTER:m.forEach(i=>{const r=i.getPointByOrigin("center","center").x,e=new Me.fabric.Point(r,0);i.setPositionByOrigin(e,"center","center")});break;case $t.YCENTER:m.forEach(i=>{const r=i.getPointByOrigin("center","center").y,e=new Me.fabric.Point(0,r);i.setPositionByOrigin(e,"center","center")});break;case $t.HCENTER:{const i=(a=this.selection)==null?void 0:a.width,r=m.map(c=>c.getBoundingRect().width).reduce((c,u)=>c+u,0),e=(i-r)/(m.length-1);let l=-i/2;[...m].sort((c,u)=>c.left-u.left).forEach(c=>{const u=c.getPointByOrigin("center","center").y,h=l+c.getBoundingRect().width/2;l+=c.getBoundingRect().width+e;const p=new Me.fabric.Point(h,u);c.setPositionByOrigin(p,"center","center")})}break;case $t.VCENTER:{const i=(t=this.selection)==null?void 0:t.height,r=m.map(c=>c.getBoundingRect().height).reduce((c,u)=>c+u,0),e=(i-r)/(m.length-1);let l=-i/2;[...m].sort((c,u)=>c.left-u.left).forEach(c=>{const u=c.getPointByOrigin("center","center").x,h=l+c.getBoundingRect().height/2;l+=c.getBoundingRect().height+e;const p=new Me.fabric.Point(u,h);c.setPositionByOrigin(p,"center","center")})}break}const x=this.selectAt(m),g=await this.transformGroup(x);this.recordOperate(...g)}destroy(){this.pluginManager.destroy(),this.canvas.dispose(),this.operateManager.destroy()}addElementFromJson(...y){this.canvas.discardActiveObject(),this.createElementInstance(y,m=>{m&&(this.reCalcStrokeWidth(m),this.canvas.add(m),this.computedElementZindex())})}removeElementFromJson(...y){this.canvas.discardActiveObject();const m=this.getAllValidObjects();y.forEach(x=>{const g=m.find(b=>b.id===x);g&&this.canvas.remove(g)})}updateElementFromJson(...y){this.canvas.discardActiveObject();const m=this.getAllValidObjects();y.forEach(x=>{const g=m.find(b=>b.id===x.id);if(g){g.type===Ke.line&&(delete x.x1,delete x.x2,delete x.y1,delete x.y2),g.set(x),this.reCalcStrokeWidth(g),g.type==="image"&&g.setSrc(x.src,()=>{this.canvas.requestRenderAll()}),g.setCoords();const b=this.calcObjProperty(g);this.emit(Ve.LOCK,b)}}),this.canvas.requestRenderAll()}recordOperate(...y){const m=y.map(b=>this.getObjectOperateAttribute(b)),x=this.getAllValidObjects().map(b=>b.id),g=new Set(x);this.operateManager.pushCommand(m,g)}_calcArea(y){const{width:m=0,height:x=0,scaleX:g=0,scaleY:b=0}=y,f=y.group&&y.group.scaleX||1,n=y.group&&y.group.scaleY||1;return m*g*x*b*f*n}computedElementZindex(){const y=this.getAllValidObjects();y.sort((m,x)=>{const g=this._calcArea(m);return this._calcArea(x)-g}),y.forEach((m,x)=>{m.zIndex!==10+x&&(m.moveTo(10+x),m.set({zIndex:10+x}))})}getObjectOperateAttribute(y){const m={},x=p1.slice();switch(y.type){case Ke.circle:x.push("radius");break;case Ke.polygon:x.push("points");break;case Ke.rect:x.push("rx","ry");break;case Ke.ellipse:x.push("rx","ry");break;case Ke.line:x.push("x1","y1","x2","y2");break;case Ke.IText:case Ke.Text:x.push("text","path","fontFamily","fontSize","charSpacing","pathSide");break;case Ke.path:x.push("path","pathOffset");break;case Ke.image:x.push("src");break;case Ke.group:const f=y.getObjects().map(n=>this.getObjectOperateAttribute(n));m.objects=f}const g=y.toObject();return x.forEach(b=>{m[b]=g[b]||y.get(b)}),m.scaleX=y.get("scaleX"),m.scaleY=y.get("scaleY"),m}getAllValidObjects(){return this.canvas.getObjects().filter(m=>m.name===Fr)}copy(){if(!this.selection)return;const y=this.selection;vt.Clipboard=[];const m=y.top,x=y.left;vt.Clipboard._postion={top:m,left:x},y.type===Bt?vt.Clipboard.push(...y._objects):vt.Clipboard.push(y)}async paste(){if(vt.Clipboard.length===0)return;const y={},m=[];if(vt.Clipboard.length>1){for(let b=0;b<vt.Clipboard.length;b++){const f=vt.Clipboard[b],n=await this._deepClone(f);this.setObjectIdAndParams(n,{originStroke:f.originStroke}),this.canvas.add(n),m.push(n),y[f.id]=n.id}const x=this.selectAt(m);x.set({left:vt.Clipboard._postion.left+10,top:vt.Clipboard._postion.top+10}),x.setCoords();const g=await this.transformGroup(x);this.recordOperate(...g),vt.Clipboard=g,vt.Clipboard._postion={left:x.left,top:x.top}}else{const x=vt.Clipboard[0];this.setBorderHover(x,!1),this.canvas.discardActiveObject();const g=await this._deepClone(x);this.setObjectIdAndParams(g,{left:vt.Clipboard._postion.left+10,top:vt.Clipboard._postion.top+10,originStroke:x.originStroke}),this.canvas.add(g),y[x.id]=g.id,g.setCoords(),this.canvas.setActiveObject(g),this.recordOperate(g),vt.Clipboard[0]=g,vt.Clipboard._postion={left:g.left,top:g.top},g.isLock?this.setObjectControlsToLock():this.setObjectControlsToUnlock()}return this.computedElementZindex(),y}_deepClone(y){return new Promise(m=>{y.clone(x=>{m(x)})})}transformGroup(y){return new Promise(m=>{y==null||y.clone(x=>{x.ungroupOnCanvas();const g=x.getObjects().map((b,f)=>{const n=y.getObjects()[f];return b.set({id:n.id,name:n.name,scaleX:n.scaleX*y.scaleX,scaleY:n.scaleY*y.scaleY,originStroke:n.originStroke}),b});m(g)})})}setObjectIdAndParams(y,m={},x=Fr){y.set({id:gr(),name:x,...m})}calcObjProperty(y){return this.toJSON(y)}getActiveJSON(){const y=this.canvas.getActiveObject();if(y)return this.calcObjProperty(y)}getSaveCanvasObjects(){const y=this.selections;this.canvas.discardActiveObject();let m=this.getAllValidObjects();if(m=m.map(x=>{for(const g in x)Object.prototype.hasOwnProperty.call(x,g)&&x[g]===void 0&&(x[g]="");return{...x.toObject(),originStroke:x.originStroke}}),y){const x=new Me.fabric.ActiveSelection(y,{canvas:this.canvas});this.canvas.setActiveObject(x)}return m}importProject(y){return new Promise(m=>{let x=0;const g=[];if(y.length===0){m();return}this.createElementInstance(y,b=>{x++,b&&(g.push(b),this.canvas.add(b)),x>=y.length&&(this.recordOperate(...g),this.computedElementZindex(),m())})})}loadResource(y,m){return y instanceof Image?this.imagefromURL(y.src,m):this.loadSVGFromString(y)}async createElementInstance(y,m){let x;y.forEach(g=>{switch(g.fill||(g.fill=""),g.type){case Ke.rect:x=new Me.fabric.Rect(g);break;case Ke.polygon:x=new Me.fabric.Polygon(g.points,g);break;case Ke.circle:x=new Me.fabric.Circle(g);break;case Ke.ellipse:x=new Me.fabric.Ellipse(g);break;case Ke.line:x=new Me.fabric.Line([g.x1,g.y1,g.x2,g.y2],g);break;case Ke.IText:case Ke.Text:x=new Me.fabric.IText(g.text,g),g.path&&x.set("path",new Me.fabric.Path(g.path.path,g.path));break;case Ke.image:const{src:b}=g;Me.fabric.Image.fromURL(b,o=>{m&&m(o)},g);break;case Ke.path:const{path:f}=g;x=new Me.fabric.Path(f,g);break;case Ke.group:const{objects:n}=g;if(n.length>0){const o=[];this.createElementInstance(n,a=>{if(o.push(a),o.length===n.length){delete g.objects;const t=new Me.fabric.Group(o,g);m==null||m(t)}})}return}Ke.image!==g.type&&m&&m(x)})}updateSelectedStatus(){this.selections.length>0&&(this.selections[0].isLock?this.setObjectControlsToLock():this.setObjectControlsToUnlock(),this.throttleRender())}setObjectControlsToLock(y=!0){this.canvas.uniformScaling=!0,y&&this.selections.forEach(m=>{m.isLock=!0}),this.selection&&(this.selection.isLock=!0),this.setMiddleControlsVisible(!1)}setObjectControlsToUnlock(y=!0){this.canvas.uniformScaling=!1,y&&this.selections.forEach(m=>{m.isLock=!1}),this.selection&&(this.selection.isLock=!1),this.setMiddleControlsVisible(!0)}setMiddleControlsVisible(y){Me.fabric.Object.prototype.controls.ml.visible=y,Me.fabric.Object.prototype.controls.mr.visible=y,Me.fabric.Object.prototype.controls.mb.visible=y,Me.fabric.Object.prototype.controls.mt.visible=y}getCanvasDataURL(){return this.canvas.toDataURL({multiplier:.2,quality:.2})}setSelectable(y){this.setSelectableAll(y),this.canvas.selection=y,y||this.canvas.discardActiveObject()}canvasDragMove(y,m){const x=new Me.fabric.Point(y,m);this.canvas.relativePan(x)}setImageSrc(y){const m=this.canvas.getActiveObject(),x=m.width/2,g=m.height/2,b=y.width/2+y.left,f=y.height/2+y.top,n=m.getPointByOrigin("center","center"),o=(b-x)*m.scaleX,a=(f-g)*m.scaleY,t=qn({x:n.x+o,y:n.y+a},n,m.angle||0);m.setSrc(y.base64,i=>{i.setPositionByOrigin(t,"center","center"),this.canvas.discardActiveObject(),this.canvas.setActiveObject(i),this.canvas.requestRenderAll(),this.recordOperate(i)},{width:y.width,height:y.height})}setPreciseSelection(y=!1){this.canvas.perPixelTargetFind=y,this.canvas.targetFindTolerance=4}setOpenAdsorb(y=!1){$e(this.pluginManager.setOpenAdsorb)&&this.pluginManager.setOpenAdsorb(y),y?(Me.fabric.Object.prototype.snapAngle=90,Me.fabric.Object.prototype.snapThreshold=5):(Me.fabric.Object.prototype.snapAngle=0,Me.fabric.Object.prototype.snapThreshold=null)}_strokeColorToProcessMode(y){let m="";switch(y){case"#000000":m=Xt.engrave;break;case"#E61F19":case"#00FF00":m=Xt.cut;break;case"#17489C":m=Xt.fillEngrave;break}return m}getPointer(y){return this.canvas.getPointer(y)}async arrayCreation(y,m){this.clearBatchPreview();const x=this.selection,g=x.getBoundingRect(!0),b=[];if((x==null?void 0:x.type)===Bt){const n=await this.transformGroup(x);b.push(...n)}else b.push(x);const f=[];for(let n=0;n<y.columns;n++)for(let o=0;o<y.rows;o++)if(!(n===0&&o===0))for(let a=0;a<b.length;a++){const t=b[a],i=t.getPointByOrigin("right","top"),r=g.width-x.scaleX*x.strokeWidth,e=g.height-x.scaleY*x.strokeWidth,l=await this._deepClone(t);this.setObjectIdAndParams(l);const s=i.x+(r+y.columnSpacing)*n,c=i.y+(e+y.rowSpacing)*o;l.setPositionByOrigin({x:s,y:c},"right","top"),f.push(l),this.canvas.add(l)}this.batchPreview=f,m&&(this.batchPreview=[],this.recordOperate(...f))}async centricCreation(y,m){this.clearBatchPreview();const x=this.selection,g=[];if((x==null?void 0:x.type)===Bt){const f=await this.transformGroup(x);g.push(...f)}else g.push(x);const b=[];for(let f=0;f<y.copyCount;f++)for(let n=0;n<g.length;n++){const o=g[n],a=o.getPointByOrigin("center","center"),t={x:a.x,y:a.y},i=y.gapAngle*(f+1),r=qn(t,{x:y.x,y:y.y},i),e=await this._deepClone(o);this.setObjectIdAndParams(e),e.setPositionByOrigin({x:r.x,y:r.y},"center","center"),e.rotate(y.autorotation?(e.angle||0)+r.angle:e.angle||0),b.push(e),this.canvas.add(e)}this.batchPreview=b,m&&(this.batchPreview=[],this.recordOperate(...b))}async materialCreation(y,m){this.clearBatchPreview();const x=this.selection,g=x.getBoundingRect(!0),b=[],f=x.getPointByOrigin("left","top"),n=x.getPointByOrigin("left","center"),o=x.getPointByOrigin("center","bottom");let a=f.x,t,i=f.y,r;const e=2,l="Speed(mm/s)",s="Power(%)",c="3mm椴木板",u=(y.speedMax-y.speedMin)/(y.speedRow-1),h=(y.powerMax-y.powerMin)/(y.powerColumn-1);for(let U=0;U<y.powerColumn;U++)for(let F=0;F<y.speedRow;F++){const M="".concat((y.speedMax-u*F).toFixed()),j="".concat((y.powerMin+h*U).toFixed());if(U===0){const N=new Me.fabric.IText(M,{...mt(),fontSize:8,textAlign:"right",fontFamily:"Times New Roman"});N.setPositionByOrigin({x:n.x-e,y:n.y+(g.height+y.speedRowSpacing)*F},"right","center"),b.push(N),N.left<a&&(a=N.left)}if(F===0){const N=new Me.fabric.IText(j,{...mt(),fontSize:8,textAlign:"center",fontFamily:"Times New Roman"});N.setPositionByOrigin({x:o.x+(g.width+y.powerColumnSpacing)*U,y:o.y+(g.height+y.speedRowSpacing)*(y.speedRow-1)+3},"center","top"),b.push(N),r=N.getPointByOrigin("left","bottom").y}let G=x;if(U!==0||F!==0){const N=x.getPointByOrigin("right","top"),R=g.width-x.scaleX*x.strokeWidth,A=g.height-x.scaleY*x.strokeWidth;G=await this._deepClone(x),this.setObjectIdAndParams(G);const H=N.x+(R+y.powerColumnSpacing)*U,Z=N.y+(A+y.speedRowSpacing)*F;G.setPositionByOrigin({x:H,y:Z},"right","top"),t=H,b.push(G)}if(m){G.set({fill:Nt.fillEngrave,stroke:"",strokeWidth:0});let N=this.calcObjProperty(G);N={...N,fillEngrave:{power:Number(j),speed:Number(M),repeat:1},processMode:Xt.fillEngrave},this.emit(Ve.PROPERTYMANAGER,N),this.emit(Ve.SELECTION_CHANGE,N,G)}}const p=new Me.fabric.IText(s,{...mt(),fontSize:12,textAlign:"center",fontFamily:"Times New Roman"});p.setPositionByOrigin({x:a+(t+g.width-a)/2,y:r+e},"center","top"),b.push(p);const _=new Me.fabric.IText(l,{...mt(),fontSize:12,angle:-90,textAlign:"center",fontFamily:"Times New Roman"});_.setPositionByOrigin({x:a-e,y:i+(r-i)/2},"center","bottom"),b.push(_);const w=new Me.fabric.IText(c,{...mt(),fontSize:12,textAlign:"center",fontFamily:"Times New Roman"});w.setPositionByOrigin({x:a+(t-a)/2,y:i-e-2},"center","bottom"),b.push(w),a=f.x-30,i=f.y-20,r=f.y+(g.height+y.speedRowSpacing)*y.speedRow+23;const S=20,C=new Me.fabric.Path("\n      M ".concat(a," ").concat(i," L ").concat(a+S," ").concat(i,"\n      M ").concat(a," ").concat(i," L ").concat(a," ").concat(i+S,"\n    "),{...mt()});b.push(C),t-=2;const E=new Me.fabric.Path("\n      M ".concat(t+S," ").concat(i," L ").concat(t," ").concat(i,"\n      M ").concat(t+S," ").concat(i," L ").concat(t+S," ").concat(i+S,"\n    "),{...mt()});b.push(E);const k=new Me.fabric.Path("\n      M ".concat(t+S," ").concat(r," L ").concat(t+S," ").concat(r-S,"\n      M ").concat(t+S," ").concat(r," L ").concat(t," ").concat(r,"\n    "),{...mt()});b.push(k);const O=new Me.fabric.Path("\n      M ".concat(a," ").concat(r," L ").concat(a+S," ").concat(r,"\n      M ").concat(a," ").concat(r," L ").concat(a," ").concat(r-S,"\n    "),{...mt()});if(b.push(O),this.canvas.add(...b),this.reCalcStrokeWidth(...b),this.batchPreview=b,m){b.push(x),this.canvas.discardActiveObject();const F=this.selectAt(b,mt()).toGroup();F.set({fill:"",strokeWidth:0}),this.recordOperate(F),this.canvas.requestRenderAll(),this.batchPreview=[],b.forEach(j=>{if(j.type===Ke.IText||j.type==="path"){let G=this.calcObjProperty(j);G={...G,engrave:{power:50,speed:60,repeat:1},processMode:Xt.engrave},this.emit(Ve.SELECTION_CHANGE,G,j)}});const M=this.calcObjProperty(F);this.emit(Ve.SELECTION_CHANGE,M,F)}}clearBatchPreview(){this.canvas.remove(...this.batchPreview),this.batchPreview=[]}async setActiveObjectToGroup(){const y=[],m=this.canvas.getActiveObjects();this.canvas.discardActiveObject();for(let f=0;f<m.length;f++){const n=m[f];if(n.type==="group"){const o=n.toActiveSelection();y.push(...o._objects)}else y.push(n)}const g=this.selectAt(y).toGroup();g.set({id:gr(),name:Dt.name}),this.emit(Ve.ADDED,{target:g}),this.recordOperate(g);const b=this.calcObjProperty(g);this.emit(Ve.SELECTION_CHANGE,b,g)}async ungroupToActiveObject(){const m=this.selection.toActiveSelection(),x=await this.transformGroup(m);this.recordOperate(...x);const g=this.calcObjProperty(m);this.emit(Ve.SELECTION_CHANGE,g,m)}setLayerActiveObject(y){const m=this.canvas.getObjects(),x=[];y.forEach(g=>{const b=m.find(f=>f.id===g);b&&x.push(b)}),x.length===1?this.canvas.setActiveObject(x[0]):x.length>1&&this.selectAt(x,{originX:"left",originY:"top"}),this.canvas.requestRenderAll()}removeCanvasObjects(y){if(!y.length)return;const m=[...y],x=this.selection,g=[];x.id&&x.type!=="activeSelection"?y.includes(x.id)||g.push(x):x._objects.forEach(f=>{y.includes(f.id)||g.push(f)}),this.canvas.discardActiveObject();const b=this.canvas.getObjects();m.forEach(f=>{const n=b.find(o=>o.id===f);n&&this.canvas.remove(n)}),this.canvas.requestRenderAll(),g.length&&this.selectAt(g)}setUnitType(y){$e(this.pluginManager.onUnitChange)&&this.pluginManager.onUnitChange(y)}async cloneAddCanvas(y,m={},x){const g=await this._deepClone(y);this.setObjectIdAndParams(g),g.set(m),x&&x(g),this.canvas.add(g),this.recordOperate(g)}getClosestCanvasElementCentrePoint(){const y=this.selections;this.canvas.discardActiveObject();const m=this.getAllValidObjects().map(x=>x.getCenterPoint());if(m.sort((x,g)=>x.y-g.y),m.length===0)return null;if(m.length>0)return y.length>1?this.selectAt(y):y.length===1&&this.canvas.setActiveObject(y[0]),m}switchCanvasMode(y){var f,n;let m,x;this.workMode=y,y===di.PLANE?(m=this.originStageWidth,x=this.originStageHeight,(f=this.backgroundImg)==null||f.set({angle:0,left:0})):(m=this.originStageHeight,x=this.originStageWidth,(n=this.backgroundImg)==null||n.set({angle:90,left:m})),this.canvasOptions.stageWidth=m,this.canvasOptions.stageHeight=x,this.whiteScreen.set({width:m,height:x});const g=this.canvas.getZoom(),b=this.pluginManager.getPlugin("gridBackground");b&&(b._plugin.resize(m,x,g),this.backgroundImg&&b._plugin.grids.forEach(o=>{o.name!=="pathBorder"&&o.set("opacity",.2)})),this.throttleRender()}};Fe(vt,"Clipboard",[]);let oa=vt;function mt(){return{...Dt,id:gr()}}function Z_(v,d){const y=Gr(),m=ps(),x=Ze(!1),g=Ze(),b=Ze([]),f=Ze(!1),n=Cr({x:0,y:0}),o=Ze(),a=Ze(),t=Cr({w:0,h:0}),i=Ze(),r=w=>{const S=document.getElementById("canvas-container-box"),C=document.createElement("canvas");S.appendChild(C);const E=new oa({container:C,width:t.w,height:t.h,stageWidth:v.gridBackgroundSize.w,stageHeight:v.gridBackgroundSize.h,strokeWidth:0,stageBorCor:"#E0E0E6",minZoom:.6,maxZoom:20,operateMaxLimit:50,isInitGridBackground:!0,isOpenControlIcon:!0,viewportRatio:1,id:w,backdropStroke:"#E0E0E6",unit:m.setOption.unit,plugins:[{name:"gridBackground",options:{width:v.gridBackgroundSize.w,height:v.gridBackgroundSize.h}},{name:"ruler",options:{rulerX:o.value,rulerY:a.value}}]}),k=E.id;return y.addCanvas({id:k,canvas:E}),b.value=[...b.value,k],y.loadMaterialInitLayers(k),g.value=E==null?void 0:E.whiteScreenData,window.addEventListener("resize",h),E==null||E.on(Ve.SELECTION_CHANGE,O=>{p(O)}).on(Ve.SELECTION_CLEAR,()=>{y.chanePropertyMode(hr.STAGE)}).on(Ve.ELEMENT_MODIFY,O=>{p(O)}).on(Ve.MOUSE_DOWN,O=>{var F,M;const U=O.e;u(O.changedTouches),n.x=(F=U.changedTouches)==null?void 0:F[0].clientX,n.y=(M=U.changedTouches)==null?void 0:M[0].clientY}).on(Ve.UPDATE_ELEMENT_PROPERTY,({type:O,value:U})=>{y.updateElementProperty({type:O,value:U})}).on(Ve.MOUSE_MOVE,O=>{var F,M,j,G,N,R;const U=O.e;if(d.value){const A=((F=y.canvas())==null?void 0:F.canvas.getZoom())||1,H=((M=U.changedTouches)==null?void 0:M[0].clientX)-n.x,Z=((j=U.changedTouches)==null?void 0:j[0].clientY)-n.y;(G=y.canvas())==null||G.canvasDragMove(H,Z),n.y=(N=U.changedTouches)==null?void 0:N[0].clientY,n.x=(R=U.changedTouches)==null?void 0:R[0].clientX,U.changedTouches&&U.changedTouches.length===1&&(v.zoomPoint={x:0,y:0}),e(A)}}),window.canvas=y.canvas(),v.zoomPoint={x:t.w/2,y:t.h/2},e(t.h/v.gridBackgroundSize.h-.1),E.id},e=w=>{var S;(S=y.canvas())==null||S.zoomFinger(v.zoomPoint||{x:0,y:0},w),window.canvas=y.canvas()},l=w=>{c(!1);const S=r(w);return s(S),S},s=w=>{var k,O,U,F,M,j,G;if(!Xi.instance.has(w))return;y.getCanvasSnapShoot(((k=y.canvas())==null?void 0:k.id)||""),c(!1),Xi.instance.setID(w),(U=y.canvas())==null||U.toggleControlsCanvas((O=y.canvas())==null?void 0:O.canvas),y.currCanvasId=w,window.canvas=y.canvas(),(F=y.canvas())==null||F.updateSelectedStatus(),c(!0);const S=(M=y.canvas())==null?void 0:M.getActiveJSON();S?(y.chanePropertyMode(hr.ELEMENT),y.setElementProperty(S)):y.chanePropertyMode(hr.STAGE);const C=(j=y.canvas())==null?void 0:j.getCanvasDetail();((C==null?void 0:C.canvasWidth)!==t.w||(C==null?void 0:C.canvasHeight)!==t.h)&&((G=y.canvas())==null||G.resize(t.w,t.h)),v.zoomPoint={x:(t.w||0)/2,y:(t.h||0)/2};const E=(t.h||295)/295-.2;return e(E),y.canvas()},c=w=>{var C;if(!y.canvas())return;const S=((C=y.canvas())==null?void 0:C.canvas).wrapperEl;S&&(w?S.style.setProperty("display","block"):S.style.setProperty("display","none"))},u=w=>{if(w&&w.length>1){const S=(w[0].clientX+w[1].clientX)/2,C=(w[0].clientY+w[1].clientY)/2;v.zoomPoint.x=S,v.zoomPoint.y=C}},h=()=>{var w;_(),(w=y.canvas())==null||w.resize(t.w,t.h)},p=w=>{if(w.type!=="activeSelection")y.chanePropertyMode(hr.ELEMENT),y.setElementProperty(w);else{const S="image",C=w.children.every(k=>k.type!==S),E=w.children.every(k=>k.type===S);!C&&!E?y.chanePropertyMode(hr.DIIFGROP):y.chanePropertyMode(hr.ELEMENT),w.children.forEach(k=>{y.setElementProperty(k)}),y.setElementProperty(w)}},_=()=>{const w=Jr(document.body).height,S=Jr(document.querySelector(".bottom-button")).height+Jr(document.querySelector(".top-nav-bar")).height+Jr(document.querySelector(".edit-page-bar")).height+26,C=i.value;t.w=C.clientWidth-v.ruler.size-1,t.h=w-S,v.isShowProcessPop||(v.previewGcodeSize=fa(t))};return{isShowChooseBtn:x,whiteScreen:g,rulerX:o,rulerY:a,canvasSize:t,canvasBox:i,canvasIds:b,isRanging:f,onResize:h,handleInitCanvas:r,refreshCanvasWH:_,addMultCanvas:l,toggleMultCanvas:s,setZoom:e}}function q_(v,d){const y=Cr({scale:1,originScale:1,pageX:0,pageY:0,pageX2:0,pageY2:0,moveable:!1}),m=Gr(),x=.7;let g=null;const b=i=>{yr(()=>{g=document.querySelector(".".concat(i)),g==null||g.addEventListener("touchstart",f,{passive:!1}),g==null||g.addEventListener("touchmove",n,{passive:!1})})},f=i=>{var s;if(i.preventDefault(),!d.value)return;const r=i.touches,e=r[0],l=r[1];a(r),y.pageX=e.pageX,y.pageY=e.pageY,y.moveable=!0,l&&(y.pageX2=l.pageX,y.pageY2=l.pageY),y.originScale=((s=m.canvas())==null?void 0:s.canvas.getZoom())||0},n=i=>{if(i.preventDefault(),!y.moveable)return;const r=i.touches,e=r[0],l=r[1];if(a(r),l&&d.value){y.pageX2||(y.pageX2=l.pageX),y.pageY2||(y.pageY2=l.pageY);let s=t({x:e.pageX,y:e.pageY},{x:l.pageX,y:l.pageY})/t({x:y.pageX,y:y.pageY},{x:y.pageX2,y:y.pageY2});s=Number(s.toFixed(3));let c=y.originScale*s;c<x&&(c=x),o(c)}},o=i=>{var r;(r=m.canvas())==null||r.zoomFinger(v.zoomPoint,i),window.canvas=m.canvas()},a=i=>{if(i&&i.length>1){const r=(i[0].clientX+i[1].clientX)/2,e=(i[0].clientY+i[1].clientY)/2;v.zoomPoint.x=r,v.zoomPoint.y=e}},t=(i,r)=>Math.hypot(r.x-i.x,r.y-i.y);return la(()=>{g==null||g.removeEventListener("touchstart",f),g==null||g.removeEventListener("touchmove",n)}),{dragFun:b}}const K_=(v,{wait:d=200,prevent:y=!1,stop:m=!1})=>{let x=!0;if(!$e(v))throw new Error("useThrottle hook 第一个参数需要传入函数");return g=>{x&&(v(),setTimeout(()=>{x=!0},d)),x=!1,y&&(g==null||g.preventDefault()),m&&(g==null||g.stopPropagation())}};class Q_{constructor(d){Fe(this,"offset",{x:0,y:0});Fe(this,"curOffset",{x:0,y:0});Fe(this,"mousePosition",{x:0,y:0});Fe(this,"maxScale",8);Fe(this,"minScale",.4);Fe(this,"scaleStep",.2);Fe(this,"scale",1);Fe(this,"preScale",1);Fe(this,"width");Fe(this,"height");Fe(this,"x",0);Fe(this,"y",0);Fe(this,"canvas");Fe(this,"displacement",{scale:1,originScale:1,pageX:0,pageY:0,pageX2:0,pageY2:0,moveable:!1});var y;this.canvas=d,this.width=d.options.width,this.height=d.options.height,this.scale=((y=d.options)==null?void 0:y.scale)||1,this.touchstart=this.touchstart.bind(this),this.touchmove=this.touchmove.bind(this),this.touchend=this.touchend.bind(this),this.onMousewheel=this.onMousewheel.bind(this),this.initEventListener(),this.paint=K_(this.paint.bind(this),{wait:15}),this.initZoom()}initEventListener(){this.canvas.target.addEventListener("wheel",this.onMousewheel,{passive:!1})}onMousewheel(d){if(d.preventDefault(),this.mousePosition.x=d.offsetX,this.mousePosition.y=d.offsetY,d.wheelDelta>0){if(this.scale=parseFloat((this.scaleStep+this.scale).toFixed(2)),this.scale>this.maxScale){this.scale=this.maxScale;return}}else if(this.scale=parseFloat((this.scale-this.scaleStep).toFixed(2)),this.scale<this.minScale){this.scale=this.minScale;return}this.zoom()}zoom(){this.offset.x=this.mousePosition.x-(this.mousePosition.x-this.offset.x)*this.scale/this.preScale,this.offset.y=this.mousePosition.y-(this.mousePosition.y-this.offset.y)*this.scale/this.preScale,this.paint(),this.preScale=this.scale,this.curOffset.x=this.offset.x,this.curOffset.y=this.offset.y}touchstart(d){d.preventDefault();const y=d.touches[0],m=d.touches[1];if(this.displacement.pageX=y.pageX,this.displacement.pageY=y.pageY,m&&(this.displacement.pageX2=m.pageX,this.displacement.pageY2=m.pageY),this.displacement.originScale=this.scale||1,m){const x=this.getPosition(d);this.x=x.x,this.y=x.y}else this.x=y.pageX,this.y=y.pageY;this.canvas.target.addEventListener("touchmove",this.touchmove,{passive:!1}),this.canvas.target.addEventListener("touchend",this.touchend,{passive:!1})}getPosition(d){const y=d.touches,m=y[0],x=y[1];return{x:(m.pageX+x.pageX)/2,y:(m.pageY+x.pageY)/2}}touchmove(d){d.preventDefault();const y=d.touches,m=y[0],x=y[1];if(x){this.displacement.pageX2||(this.displacement.pageX2=x.pageX),this.displacement.pageY2||(this.displacement.pageY2=x.pageY);let g=this.getDistance({x:m.pageX,y:m.pageY},{x:x.pageX,y:x.pageY})/this.getDistance({x:this.displacement.pageX,y:this.displacement.pageY},{x:this.displacement.pageX2,y:this.displacement.pageY2});g=Number(g.toFixed(5));const b=this.displacement.originScale*g;this.scale=b,this.mousePosition.x=this.width/2,this.mousePosition.y=this.height/2,this.zoom()}else this.offset.x=this.curOffset.x+(m.pageX-this.x),this.offset.y=this.curOffset.y+(m.pageY-this.y),this.paint()}getDistance(d,y){return Math.hypot(y.x-d.x,y.y-d.y)}touchend(){this.curOffset.x=this.offset.x,this.curOffset.y=this.offset.y,this.canvas.target.removeEventListener("touchmove",this.touchmove),this.canvas.target.removeEventListener("touchend",this.touchend)}initZoom(){this.mousePosition.x=this.width/2,this.mousePosition.y=this.height/2,this.zoom()}reset(){}draw(){this.canvas.options.useCache||this.canvas.options.useOffscreen?this.canvas.endPainting():this.canvas.executeOperateHistory()}paint(){var d;this.clear(),this.canvas.ctx.translate(this.offset.x,this.offset.y),(d=this.canvas.ctx)==null||d.scale(this.scale,this.scale),this.canvas.initStageBackground(this.canvas.options),this.draw()}clear(){this.canvas.target.width=this.canvas.options.width,this.canvas.initCanvasBackground(this.canvas.options)}destroy(){var d,y;(d=this.canvas.target)==null||d.removeEventListener("wheel",this.onMousewheel),(y=this.canvas.target)==null||y.removeEventListener("touchstart",this.touchstart)}}class J_{constructor(d){Fe(this,"_left");Fe(this,"_top");Fe(this,"target");Fe(this,"ctx");Fe(this,"offscreen",{});Fe(this,"options");Fe(this,"events");Fe(this,"operateHistory",[]);Fe(this,"canvasCache",{});this.options=d,this.target=d.target,this.ctx=d.target.getContext("2d"),this.initCache(d),this.initCanvasBackground(d),this.initStageBackground(d),d.isMoveCanvas&&(this.target.style.cursor="move",this.events=new Q_(this))}initOffscreen(d){this.options.useOffscreen&&(this.offscreen.useOffscreen=this.options.useOffscreen,this.offscreen.imageBitmap=d,this.endPainting())}initCache(d){d.useCache&&(this.canvasCache.useCache=d.useCache,this.canvasCache.cacheCanvas=document.createElement("canvas"),this.canvasCache.cacheCanvas.width=d.width||400,this.canvasCache.cacheCanvas.height=d.height||300,this.canvasCache.cacheCtx=this.canvasCache.cacheCanvas.getContext("2d"))}initCanvasBackground(d){const y=d.width,m=d.height;this.target.width=y||400,this.target.height=m||300;const x=this.ctx;x.beginPath(),x.clearRect(0,0,y,m),x.fillStyle=d.canvasBackgroundColor,x.fillRect(0,0,y,m),x.closePath()}initStageBackground(d){if(!d.isInitStage)return;const y=d.stageWidth,m=d.stageHeight,x=(this._left=(d.width-y)/2)+.5,g=(this._top=(d.height-m)/2)+.5,b=this.ctx;b.beginPath(),b.fillStyle=d.stageBackgroundColor,b.fillRect(x,g,y,d.stageHeight),b.lineWidth=d.stageBorderWidth,b.strokeStyle=d.stageBorderColor,b.strokeRect(x,g,y,d.stageHeight),b.closePath()}drawLine(d,y){var g;const m=(g=this.options.machineOptions)==null?void 0:g.S;let x;this.options.useCache?x=this.canvasCache.cacheCtx:x=this.ctx,this.ctx.save(),x.lineWidth=this.options.strokeWidth||1,d.forEach((b,f)=>{var n;if(f!==0){x.beginPath();let o=(n=this.options.strokeStyle)==null?void 0:n.split(",");o&&o.length>1&&(o[o.length-1]=b.s/m+")",o=o.join(",")),x.strokeStyle=o,x.moveTo(d[f-1].x+this._left,d[f-1].y+this._top),x.lineTo(b.x+this._left,b.y+this._top),x.stroke()}}),this.ctx.restore(),!(y!=null&&y.isHistory)&&this.addOperateHistory(this.drawLine,d,y),this.options.useCache&&this.endPainting()}endPainting(d=0,y=0){let m=null;this.options.useOffscreen?m=this.offscreen.imageBitmap:this.options.useCache&&(m=this.canvasCache.cacheCanvas),this.ctx.drawImage(m,d,y)}addOperateHistory(d,y,m){this.operateHistory.push({fn:d.bind(this),arg:y,options:m})}executeOperateHistory(){this.operateHistory.forEach(d=>{d.fn(d.arg,{...d.options,isHistory:!0})})}clearRect(){this.ctx.clearRect(0,0,this.options.width,this.options.height),this.operateHistory=[]}destroy(){this.events.destroy(),this.clearRect(),this.ctx=null,this.target=null}}function ey(){return new Worker(""+new URL("OffscreenCanvasWorker-d4a672d7.js",import.meta.url).href)}function ty({state:v,canvasIds:d,canvasSize:y,handleSwitchModel:m,toggleMultCanvas:x,addMultCanvas:g,onResize:b,setZoom:f}){const n=ua(),o=ss(),a=Gr(),t=us(),{t:i}=ca(),r=os(),e=ps(),l=375,s=Ze(),c=Ze(!1);let u;const h=Ze(!1),p=Ze(""),_=Ze(10),w=Ze(1),S=Ze(i("editor.casswoodBoard3mm")),C=Ze(1),E=Ze(!1),k=Ze(""),O=Ze("beforeSend"),U=Ze(n.isConnectedDevice),F=Ze(!1),M=Ze(!1),j=Ze(!1),G=Ze([{label:i("editor.lineEngrave"),key:_t.engrave},{label:i("editor.fillEngrave"),key:_t.fillEngrave},{label:i("editor.lineCut"),key:_t.cut}]),N=Ze([{label:i("editor.engrave"),key:_t.fillEngrave}]),R=rt(()=>fa(a.currProperty)),A=rt(()=>d.value.map((Se,Ee)=>({name:i("editor.currentPage",{page:Ee+1}),id:Se,index:Ee+1}))),H=Ze(!1),Z=Cr({text:U.value?i("editor.startPro"):i("editor.connectDev"),isConnected:U.value}),K=rt(()=>F.value||M.value),J=()=>{G.value=[{label:i("editor.lineEngrave"),key:_t.engrave},{label:i("editor.fillEngrave"),key:_t.fillEngrave},{label:i("editor.lineCut"),key:_t.cut}],N.value=[{label:i("editor.engrave"),key:_t.fillEngrave}]};function D(Se,Ee){var Ie;const Ce=(Ie=a.canvas())==null?void 0:Ie.whiteScreenData;return{width:Ce.width/2-Se/2,height:Ce.height/2-Ee/2}}const I=async()=>{var Ee;const{projectID:Se}=r.params;if(a.localProjectId&&Se.includes("project")){const Ie=a.localProjectList.find(Ae=>Ae.projectId===Se);Ie?W(Ie):g()}else if(Se==="material"){const Ce=t.materialSource.svgList;if(!Ce)g();else{for(const Ie of Ce)Ie&&(g(),await((Ee=a.canvas())==null?void 0:Ee.loadSVGFromString(Ie,Ae=>{const $=Ae.getObjects(),be=Va(Ae.width)/Ae.width,ge=Va(Ae.height)/Ae.height;Ae==null||Ae.set({scaleX:be,scaleY:ge,left:D(Ae.width*be,Ae.height*ge).width,top:D(Ae.width*be,Ae.height*ge).height}),$==null||$.forEach(ke=>{ne(ke)}),q($)})));x(d.value[0])}}else g();yr(()=>{const Ce=Xi.instance.getList();for(const[,Ie]of Ce)Ie==null||Ie.setUnitType(e.setOption.unit)})},W=async Se=>{var Ie;a.remark=Se.remark;const Ee=Se.canvasList,Ce=Se.processList;for(let Ae=0;Ae<Ee.length;Ae++){const $=Ee[Ae];g(),await((Ie=a.canvas())==null?void 0:Ie.importProject($.objects)),$.objects.forEach(be=>{a.setElementProperty({id:be.id,...Ce[be.id]})})}x(Se.currentCanvasId),a.localProjectId=Se.projectId,a.setProjectDirty(!1)},q=Se=>{const Ee=[];Se.forEach(Ce=>{const Ie=Ce.fill||Ce.stroke,Ae=Ee.findIndex($=>$===Ie);if(Ae!==-1)a.currentCanvasLayer.layer[Ae].ids.push(Ce.id);else{if(!Ee.length)a.currentCanvasLayer.layer[0].ids.push(Ce.id);else{const $=a.currentCanvasLayer.layer[0].index+1;a.currentCanvasLayer.layer.unshift({name:"图层 "+$,index:$,ids:[Ce.id],isEdit:!1,selected:!1})}Ee.unshift(Ie)}})};function ne(Se){const Ce=a.canvas().toJSON(Se),Ie=Se.originStroke,Ae=$(Ie);if(Ae)switch(Ae){case _t.engrave:Se.set({fill:"",stroke:dr.engrave,originStroke:dr.engrave}),Ce.processMode=_t.engrave,a.setElementProperty(Ce);break;case _t.fillEngrave:Se.set({fill:dr.fillEngrave,stroke:dr.fillEngrave,originStroke:dr.fillEngrave}),Ce.processMode=_t.fillEngrave,a.setElementProperty(Ce);break;case _t.cut:Se.set({fill:"",stroke:Se.originStroke,originStroke:Se.originStroke,isVariableThickness:Se.originStroke===dr.variableThickness}),Ce.processMode=_t.cut,a.setElementProperty(Ce);break}function $(be){let ge="";switch(be){case"#000000":ge="engrave";break;case"#E61F19":case"#00FF00":ge="cut";break;case"#17489C":ge="fillEngrave";break}return ge}}const le=Se=>{C.value=Se.index,c.value=!1,x(Se.id)},ce=()=>{if(C.value>1){const Se=C.value-1,Ee=A.value.find(Ce=>Ce.index===Se);Ee&&le(Ee)}},fe=()=>{if(C.value<A.value.length){const Se=C.value+1,Ee=A.value.find(Ce=>Ce.index===Se);Ee&&le(Ee)}},he=Se=>{se("processMode",Se)},se=(Se,Ee)=>{a.setCanvasElementProperty({type:Se,value:Ee})},ie=(Se,Ee)=>{Se?(H.value=!0,v.title=i("editor.machiningParameterSetting"),v.leftText=i("editor.backEdit")):(H.value=!1,v.title=i("editor.processingMaterial"),v.leftText=i("common.back")),yr(()=>{b(),Ee&&$e(Ee)&&Ee()})},Q=()=>{if(!(K.value&&U.value)){if(H.value){ee();return}if(U.value){if(!Te()){Qt(i("editor.stageEmpty"));return}ie(!0,()=>{setTimeout(()=>{v.zoomPoint={x:v.gridBackgroundSize.w/2,y:v.gridBackgroundSize.h/2-25};const Ee=Math.min(y.w/v.gridBackgroundSize.w,y.h/v.gridBackgroundSize.h);f(Ee-.1)},100)}),m(!1)}else o.push("/connectConfig")}},re=()=>{H.value?ie(!1,()=>{v.zoomPoint={x:y.w/2,y:y.h/2},f(y.h/v.gridBackgroundSize.h-.1)}):o.back()},te=Se=>window.screen.width/l*Se,V=!1;function z(){var Ae;const Se=(Ae=a.canvas())==null?void 0:Ae.whiteScreenData,Ee=te(v.gcodeCanvasSize.h),Ce=Ee/Se.height-.1,Ie=document.querySelector(".gcodeViewBox");u=new J_({target:Ie,width:v.gcodeCanvasSize.w,height:Ee,canvasBackgroundColor:"#E6E6E6",stageWidth:Se.width,stageHeight:Se.height,stageBackgroundColor:Se.fill,stageBorderColor:Se.stroke||"#43c9b0",stageBorderWidth:1,strokeStyle:"rgba(0,0,0,1)",strokeWidth:Dt.strokeWidth,isInitStage:!0,useCache:!1,scale:Ce,isMoveCanvas:!0,useOffscreen:V,machineOptions:{S:1e3}})}const B=Ze(!1);function ee(){B.value=!0,a.calculateGcode().then(Se=>{const{gcode:Ee,isOutWorkArea:Ce}=Se||{};if(!Ee){Qt(i("editor.no_active_element")),B.value=!1;return}const Ie=()=>{if(p.value=Ee,El(p.value)>50){Qt(i("editor.machining.gcode_size_tip")),B.value=!1,p.value="";return}ae(Ee)};return Ce?ms({title:i("common.tip"),message:i("editor.out_canvas_tip"),confirmButtonText:i("common.confirm"),cancelButtonText:i("common.cancel")}).then(()=>{Ie()}).catch(()=>{B.value=!1,p.value=""}):Ie(),!0})}const Y=Se=>{if(Se>60*60)return(Se/3600).toFixed(1)+i("editor.hours");if(Se<60)return Se.toFixed(1)+i("editor.seconds");if(Se<60*60)return(Se/60).toFixed(1)+i("editor.minits")};let L,P=[];function ae(Se){L=new ey,L.onmessage=Ee=>{Ee.data?(Ee.data.showModal&&(h.value=!0,_.value=Ee.data.duration,k.value="".concat(i("editor.preProsessTime"),": ").concat(Y(_.value)),yr(()=>{z();const Ce=JSON.parse(JSON.stringify(u.options));u.options.useOffscreen?L.postMessage({options:Ce,offscreenCanvas:!0}):(P=Ee.data.pictures,yr(()=>{ue()}))})),Ee.data.drawOK&&(u.initOffscreen(Ee.data.imageBitmap),B.value=!1)):B.value=!1},L.postMessage({gcode:Se,useOffscreen:V})}function ue(){P.forEach(Se=>{u.drawLine(Se)}),B.value=!1}const ve=()=>{const Se=new Cl;Se.appendAsciiStr(p.value);const Ee=Se.end();E.value=!0,n.uploadGcode(p.value,Ee).then(Ce=>{Ce.status===200&&(O.value="standby")}).catch(()=>{E.value=!1})},_e=()=>{h.value=!1,u==null||u.destroy(),k.value="",O.value="beforeSend",_.value=0,ie(!1)},Te=()=>{var Ae;const Se=(Ae=a.canvas())==null?void 0:Ae.canvas.getObjects(),Ee=Se==null?void 0:Se.filter($=>{const be=$.left+$.width,ge=$.top+$.height;return $.name==="element"&&$.left>=0&&$.top>=0&&be<=v.gridBackgroundSize.w&&ge<=v.gridBackgroundSize.h});let Ce=null;return Ee==null||Ee.forEach($=>{Ce?$.top<Ce.top&&(Ce=$):Ce=$}),Ce?{x:(Ce.left+Ce.left+Ce.width)/2,y:(Ce.top+Ce.top+Ce.height)/2}:{x:0,y:0}},Re=()=>{var Ee;if(F.value)return;F.value=!0;const Se=(Ee=a.canvas())==null?void 0:Ee.getClosestCanvasElementCentrePoint();if(Se){let Ce=!1;for(let Ie=0;Ie<Se.length;Ie++){const Ae=Se[Ie];if(Ae.x>=0&&Ae.x<=420&&Ae.y>=0&&Ae.y<=290){n.measureDistance({x:Number(Ae.x.toFixed(2)),y:Number(Ae.y.toFixed(2))}).then($=>{F.value=!1;const{data:be}=$;a.setThickness(be["height-z"]||0),a.setCalibrationsHeight(be.distance),j.value=!0,setTimeout(()=>{Le()},1e3)}).catch(()=>{F.value=!1,j.value=!1,Qt(i("editor.autoFocusFailed"))}).finally(()=>{F.value=!1}),Ce=!1;break}else Ce=!0}Ce&&Qt(i("editor.stageEmpty"))}else Qt(i("editor.stageEmpty"))},Le=()=>{M.value=!0,n.takePhoto().then(()=>{var Ee;M.value=!1;const Se=(Ee=a.canvas())==null?void 0:Ee.pluginManager.getPlugin("gridBackground");Se&&Se._plugin.grids.forEach(Ce=>{Ce.name!=="pathBorder"&&Ce.set("opacity",.2)})}).catch(()=>{M.value=!1,Qt(i("editor.refreshBgFailed"))}).finally(()=>{M.value=!1})};return ls(()=>{U.value=n.isConnectedDevice,Z.text=U.value?i("editor.startPro"):i("editor.connectDev")}),{gcodeFinish:s,connectStatusState:Z,isShowPagePick:c,isShowProcessPop:H,processMode:G,imageProcessMode:N,processAttr:R,times:w,plate:S,currentPage:C,showModal:h,canvasList:A,duration:_,tip:k,processStatus:O,isConnectedDevice:U,isRanging:F,isTakingPhoto:M,isAutoFocused:j,disabledStart:K,startWork:ee,onSelectPage:le,prePage:ce,nextPage:fe,onFormChange:se,onClickTab:he,hanldeMakeIt:Q,onClickLeft:re,handleSend:ve,initMaterial:I,closeProcessPop:_e,handleFocus:Re,handleTakePhoto:Le,switchOperateLan:J,getCenterPointer:Te}}const ry=v=>(as("data-v-ed89a200"),v=v(),ns(),v),iy={class:"mobile-edit-page"},ay=ry(()=>He("div",{class:"canvas-box"},[He("div",{id:"canvas-container-box"})],-1)),ny=Ft({__name:"index",setup(v){const d=ss(),y=Gr(),m=os(),x=ua(),g=cs(),{t:b,locale:f}=ca(),n=us(),o=Cr({zoomPoint:{x:0,y:0},title:b("editor.processingMaterial"),leftText:b("common.back"),rightText:b("editor.startPro"),previewGcodeSize:{w:0,h:0},route:m,deviceStore:x,gridBackgroundSize:{w:420,h:295},ruler:{size:20},gcodeCanvasSize:{w:342,h:245}}),a=()=>{W.value="finished"},{buttons:t,isShowShapePop:i,isCanvasMoved:r,switchBtnsLan:e,handleToolClick:l,handleImage:s,handleSwitchModel:c}=m1(),{rulerX:u,rulerY:h,canvasSize:p,canvasBox:_,canvasIds:w,whiteScreen:S,onResize:C,refreshCanvasWH:E,toggleMultCanvas:k,addMultCanvas:O,setZoom:U}=Z_(o,r),{connectStatusState:F,isShowPagePick:M,isShowProcessPop:j,processMode:G,imageProcessMode:N,processAttr:R,times:A,plate:H,currentPage:Z,showModal:K,canvasList:J,duration:D,tip:I,processStatus:W,isRanging:q,isTakingPhoto:ne,isAutoFocused:le,disabledStart:ce,onSelectPage:fe,prePage:he,nextPage:se,onFormChange:ie,onClickTab:Q,hanldeMakeIt:re,onClickLeft:te,handleSend:V,initMaterial:z,closeProcessPop:B,handleFocus:ee,handleTakePhoto:Y,switchOperateLan:L}=ty({state:o,canvasIds:w,canvasSize:p,handleSwitchModel:c,toggleMultCanvas:k,addMultCanvas:O,onResize:C,setZoom:U});o.isShowProcessPop=j;const{dragFun:P}=q_(o,r);rs(()=>g.socketData.control.action,ve=>{ve===sr.FINISH?(console.info(b("editor.finished")),W.value="finished"):ve===sr.START?(console.info(b("editor.start")),W.value="working"):ve===sr.STOP&&(console.info(b("editor.suspend")),W.value="suspend")});const ae=()=>{const ve=(navigator.language||navigator.browserLanguage).toLowerCase()==="zh-cn"?"zh_CN":"en_US";f.value=localStorage.getItem("language")||ve,o.title=b("editor.processingMaterial"),o.leftText=b("common.back"),o.rightText=b("editor.startPro"),e(),L()},ue=async()=>{w.value=[],Z.value=1,le.value=!1,r.value=!1,_.value=void 0,y.editorDestroy();const ve=document.getElementById("canvas-container-box");ve.innerHTML="",ve.innerText="",S.value=""};return ls(async()=>{const{forward:ve,back:_e}=d.options.history.state;ae(),(_e==="/"||_e==="/mine"||_e==="/search")&&!ve&&(await ue(),z(),setTimeout(()=>{Y()},1e3))}),is(async()=>{E(),window==null||window.addEventListener("resize",C),ae(),P("canvas-box"),Li("openAlbum"),Li("albumCallback",s),Li("androidPhysicalBackButtonClicked",()=>{K.value?K.value=!1:te()})}),la(()=>{window.removeEventListener("resize",C),y.editorDestroy(),n.$patch({materialSource:{}})}),(ve,_e)=>{const Te=It("topBar");return ht(),St("div",iy,[Xe(Te,{title:o.title,"left-text":o.leftText,"auto-back":!1,"bg-color":"var(--backgroundColorMain)",color:"white",onOnClickLeft:De(te),onOnClickRight:De(re)},{right:Rt(()=>[He("span",{class:Jt(["bar-right-icon",{disabled:De(ce)}])},et(De(j)?o.rightText:De(F).text),3)]),_:1},8,["title","left-text","onOnClickLeft","onOnClickRight"]),Xe(Vc,{"is-show-page-pick":De(M),"current-page":De(Z),"canvas-list":De(J),onPrePage:De(he),onNextPage:De(se),onShowPagePop:_e[0]||(_e[0]=Re=>M.value=!0),onClosePagePop:_e[1]||(_e[1]=Re=>M.value=!1),onOnSelectPage:De(fe)},null,8,["is-show-page-pick","current-page","canvas-list","onPrePage","onNextPage","onOnSelectPage"]),Xe(Wc,{processAttr:De(R),"onUpdate:processAttr":_e[2]||(_e[2]=Re=>Vt(R)?R.value=Re:null),plate:De(H),"onUpdate:plate":_e[3]||(_e[3]=Re=>Vt(H)?H.value=Re:null),times:De(A),"onUpdate:times":_e[4]||(_e[4]=Re=>Vt(A)?A.value=Re:null),"is-show-process-pop":De(j),"is-canvas-moved":De(r),"current-page":De(Z),buttons:De(t),"process-mode":De(G),"image-process-mode":De(N),isRanging:De(q),isTakingPhoto:De(ne),onHandleToolClick:De(l),onHandleSwitchModel:De(c),onOnClickTab:De(Q),onOnFormChange:De(ie),onHandleFocus:De(ee),onHandleTakePhoto:De(Y)},null,8,["processAttr","plate","times","is-show-process-pop","is-canvas-moved","current-page","buttons","process-mode","image-process-mode","isRanging","isTakingPhoto","onHandleToolClick","onHandleSwitchModel","onOnClickTab","onOnFormChange","onHandleFocus","onHandleTakePhoto"]),Xe(Au,{isShowShapePop:De(i),"onUpdate:isShowShapePop":_e[5]||(_e[5]=Re=>Vt(i)?i.value=Re:null),onHandleToolClick:De(l)},null,8,["isShowShapePop","onHandleToolClick"]),He("div",{id:"canvas-box",ref_key:"canvasBox",ref:_},[He("canvas",$a({id:"rulerX",ref_key:"rulerX",ref:u},{width:De(p).w,height:o.ruler.size}),null,16),He("canvas",$a({id:"rulerY",ref_key:"rulerY",ref:h},{width:o.ruler.size,height:De(p).h}),null,16),ay],512),Xe(yu,{showModal:De(K),"onUpdate:showModal":_e[6]||(_e[6]=Re=>Vt(K)?K.value=Re:null),duration:De(D),"process-status":De(W),tip:De(I),onFinish:a,onHandleSend:De(V),onClose:De(B)},null,8,["showModal","duration","process-status","tip","onHandleSend","onClose"])])}}});const wy=Hr(ny,[["__scopeId","data-v-ed89a200"]]);export{wy as default};
