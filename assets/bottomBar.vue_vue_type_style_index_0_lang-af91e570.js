import{L as $,r as b,i as P,Q as H,O as N,M as T,N as I,d as M,h as U,a as V,o as v,e as y,w as O,j as l,t as h,u as a,c as B,f as R,F as Y,v as A,S as E,_ as G,m as F,g as J,n as D,b as L}from"./index-e43f4e63.js";import{u as j}from"./device-1f3f345b.js";import{g as z}from"./index-affcdb37.js";import{s as Q}from"./opencv-49a7e8f2.js";import"./index-410ce858.js";const q=()=>{const u=j(),{t:m}=$(),t=b(!1),o=b({version:"",url:"",changes:[],force:!1}),r=b(!1),c=async()=>{const e=T?"android":I?"ios":"";return e?await z(e):void 0},_=async()=>{o.value=await c(),N("deviceInfo",{},e=>{if(!e)return;const n=JSON.parse(e);p(n),d(n)})},p=e=>{u.setPackageInfos(e)};function f(e,n){const s=e.split("."),i=n.split(".");for(let w=0;w<Math.max(s.length,i.length);w++){const x=parseInt(s[w]||"0"),S=parseInt(i[w]||"0");if(x<S)return-1;if(x>S)return 1}return 0}const d=e=>{if(e.appVersion&&o.value.version){if(e.appVersion===o.value.version){r.value=!1;return}if(f(e.appVersion,o.value.version)===-1)if(r.value=!0,o.value.force)t.value=!0;else{const s=C(),i=localStorage.getItem("closeTime");!i||i!==s?t.value=!0:t.value=!1}}else t.value=!1},k=()=>{N("openUrl",{url:T?"https://play.google.com/store/apps/details?id=com.wecreat.create":I?"https://apps.apple.com/us/app/wecreat/id6449988667":""},n=>{if(n){const s=JSON.parse(n);s&&s.code==="0"&&Q(m("home.fail_retry"))}})},g=()=>{const e=C();localStorage.setItem("closeTime",e)},C=()=>{const e=new Date,n=e.getFullYear();let s=e.getMonth()+1,i=e.getDate();return s=s>9?s:"0"+s,i=i>9?i:"0"+i,n+s+i};return P(()=>{H("openUrl")}),{show:t,isFindNewVersion:r,verParams:o,handleGetNewetVersion:c,handleShowPop:_,handleConfirm:k,handleCancel:g}},K={class:"content"},W={class:"version-content"},X={style:{color:"#666"}},Z={class:"content-title"},ee=M({__name:"index",props:{isHome:{type:Boolean,default:!1}},setup(u,{expose:m}){const{t}=$(),o=async()=>{c.value=await p(),r.value=!0},{show:r,verParams:c,handleShowPop:_,handleGetNewetVersion:p,handleConfirm:f,handleCancel:d}=q();return U(()=>{_()}),P(()=>{H("openUrl")}),m({handleShow:o}),(k,g)=>{const C=V("van-dialog");return v(),y(C,{show:a(r),"onUpdate:show":g[0]||(g[0]=e=>A(r)?r.value=e:null),title:a(t)("mine.foundNewVersion"),"show-cancel-button":!a(c).force&&u.isHome||!u.isHome,confirmButtonText:a(t)("mine.updateNow"),cancelButtonText:a(t)("common.close"),confirmButtonColor:a(E).backgroundColorMain,cancelButtonColor:"#ccc",onConfirm:a(f),onCancel:a(d)},{default:O(()=>[l("div",K,[l("div",W,[l("span",null,h(a(t)("mine.lastestVersion"))+":",1),l("span",X," v"+h(a(c).version),1)]),l("span",Z,h(a(t)("mine.updateContent"))+":",1),(v(!0),B(Y,null,R(a(c).changes,(e,n)=>(v(),B("div",{key:n,class:"items"},[l("span",null,h("".concat(n+1,". ")),1),l("div",null," "+h("".concat(e.type,": ").concat(e.description)),1)]))),128))])]),_:1},8,["show","title","show-cancel-button","confirmButtonText","cancelButtonText","confirmButtonColor","onConfirm","onCancel"])}}});const ie=G(ee,[["__scopeId","data-v-60058bd7"]]);function oe(){const u=F(),m=window.innerHeight,t=J(()=>u.currentRoute.value.fullPath),o=()=>{u.back()},r=c=>{u.push(c)};return{routerPath:a(t),height:m,routerBack:o,routerPush:r}}const te={class:"bottom-bar"},le=M({__name:"bottomBar",setup(u){const m=F(),{routerPath:t}=oe(),o=b(!0),r=p=>{m.push({path:"/editor/".concat(p)})},c=()=>{m.push("/mine")},_=()=>{m.push("/")};return P(()=>{o.value=t==="/"}),(p,f)=>{const d=V("vk-icon"),k=V("van-button");return v(),B("div",te,[l("div",{class:D(["bottom-item home",{active:o.value}]),onClick:_},[o.value?(v(),y(d,{key:0,icon:"",class:"bottom-icon"})):(v(),y(d,{key:1,icon:"",class:"bottom-icon"})),l("span",null,h(p.$t("common.homePage")),1)],2),L(k,{icon:"plus",class:"add-icon",onClick:f[0]||(f[0]=g=>r(1))}),l("div",{class:D(["bottom-item mine",{active:!o.value}]),onClick:c},[o.value?(v(),y(d,{key:0,icon:"",class:"bottom-icon"})):(v(),y(d,{key:1,icon:"",class:"bottom-icon"})),l("span",null,h(p.$t("common.mine")),1)],2)])}}});export{ie as V,le as _,q as u};
