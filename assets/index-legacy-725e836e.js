!function(){function e(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=x(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function r(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?t(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function n(e){var t=c();return function(){var r,i=u(e);if(t){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}(this,r)}}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return o(e,arguments,u(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l(i,e)},s(e)}function o(e,t,r){return o=c()?Reflect.construct.bind():function(e,t,r){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return r&&l(n,r.prototype),n},o.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function h(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,y(i.key),i)}}function p(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */m=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(O){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var a=t&&t.prototype instanceof f?t:f,s=Object.create(a.prototype),o=new E(n||[]);return i(s,"_invoke",{value:k(e,r,o)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(O){return{type:"throw",arg:O}}}e.wrap=l;var h={};function f(){}function d(){}function p(){}var b={};c(b,a,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(T([])));g&&g!==t&&r.call(g,a)&&(b=g);var y=p.prototype=f.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(i,a,s,o){var c=u(e[i],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==_(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,o)}),(function(e){n("throw",e,s,o)})):t.resolve(h).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,o)}))}o(c.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function k(e,t,r){var i="suspendedStart";return function(n,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw a;return M()}for(r.method=n,r.arg=a;;){var s=r.delegate;if(s){var o=S(s,r);if(o){if(o===h)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=u(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}function S(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var n=u(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function U(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function T(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:M}}function M(){return{value:void 0,done:!0}}return d.prototype=p,i(y,"constructor",{value:p,configurable:!0}),i(p,"constructor",{value:d,configurable:!0}),d.displayName=c(p,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},w(x.prototype),c(x.prototype,s,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,i,n,a){void 0===a&&(a=Promise);var s=new x(l(t,r,i,n),a);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(y),c(y,o,"Generator"),c(y,a,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=T,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(U),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var o=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(o&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),U(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;U(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}function b(e,t,r,i,n,a,s){try{var o=e[a](s),c=o.value}catch(l){return void r(l)}o.done?t(c):Promise.resolve(c).then(i,n)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var a=e.apply(t,r);function s(e){b(a,i,n,s,o,"next",e)}function o(e){b(a,i,n,s,o,"throw",e)}s(void 0)}))}}function g(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==_(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===_(t)?t:String(t)}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a,s,o=[],c=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(i=a.call(r)).done)&&(o.push(i.value),o.length!==t);c=!0);}catch(u){l=!0,n=u}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw n}}return o}}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}System.register(["./index-legacy-b852f6e0.js","./device-legacy-43b2d1d1.js","./_commonjs-dynamic-modules-legacy-4418504b.js","./index-legacy-877f79de.js","./equ-img-legacy-ae2f2487.js","./bottomPopSheet.vue_vue_type_style_index_0_lang-legacy-b5539fc8.js","./opencv-legacy-1bc95a87.js","./isObject-legacy-41afd752.js","./function-call-legacy-3d849cf8.js","./user-legacy-140cff6d.js","./getElementPX-legacy-dd553387.js"],(function(t,o){"use strict";var c,l,u,d,b,y,x,k,S,C,U,E,T,M,O,P,A,I,L,j,R,D,B,F,N,z,H,G,W,Y,X,V,q,Z,K,J,Q,$,ee,te,re,ie,ne,ae,se,oe,ce,le,ue,he,fe,de,pe,me,be,ve,ge,ye,_e,we,xe,ke,Se,Ce,Ue,Ee,Te,Me,Oe,Pe,Ae,Ie,Le,je,Re,De,Be,Fe;return{setters:[function(e){c=e.d,l=e.g,u=e.s,d=e.c,b=e.u,y=e.F,x=e.f,k=e.b,S=e.w,C=e.j,U=e.t,E=e.v,T=e.n,M=e.k,O=e.a,P=e.o,A=e.e,I=e.x,L=e._,j=e.y,R=e.z,D=e.A,B=e.r,F=e.B,N=e.C,z=e.D,H=e.E,G=e.i,W=e.G,Y=e.H,X=e.I,V=e.J,q=e.p,Z=e.q,K=e.K,J=e.L,Q=e.M,$=e.N,ee=e.O,te=e.m,re=e.P,ie=e.h,ne=e.Q,ae=e.R},function(e){se=e.t,oe=e.c,ce=e.m,le=e.a,ue=e.u,he=e.M,fe=e.b,de=e.i,pe=e.P,me=e.C},function(e){be=e.d,ve=e.c,ge=e.b,ye=e.e,_e=e.f,we=e.u},function(e){xe=e.i,ke=e.P,Se=e.C,Ce=e.O,Ue=e.s,Ee=e.c,Te=e.E,Me=e.M,Oe=e.a},function(e){Pe=e._},function(e){Ae=e._},function(e){Ie=e.s},function(e){Le=e.i,je=e.b,Re=e.a},function(e){De=e.s},function(e){Be=e.u},function(e){Fe=e.g}],execute:function(){var Ne,ze=document.createElement("style");function He(e,t,r){var i=e.length;return r=void 0===r?i:r,!t&&r>=i?e:function(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),(r=r>n?n:r)<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(n);++i<n;)a[i]=e[i+t];return a}(e,t,r)}ze.textContent='.bottom-button[data-v-ccf00891]{position:fixed;bottom:0;left:.56rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;overflow-x:auto;background:white;padding:10px 0;width:calc(100% - .56rem)}.bottom-button .btns[data-v-ccf00891]{margin-right:3px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:1.12rem}.bottom-button.process[data-v-ccf00891]{width:100%;padding-right:1.06667rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:50%;overflow:auto;z-index:9}.bottom-button.process .flex-center[data-v-ccf00891]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.bottom-button.process .process-slider-row[data-v-ccf00891]{padding:.37333rem 0;border-bottom:1px solid #efeff5}.bottom-button.process .process-slider-row .prosess-title[data-v-ccf00891]{font-size:.37333rem;color:#333;display:inline-block;width:2.18667rem;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.bottom-button.process .process-slider-row .paddLeft15[data-v-ccf00891]{padding-left:.4rem}.bottom-button.process .process-slider-row .prosess-btn[data-v-ccf00891]{display:inline-block;width:3.46667rem;border:1px solid #ccc;border-radius:4px;padding:8px 0;text-align:center}.bottom-button.process .meterial[data-v-ccf00891]{padding:.32rem 0}.edit-setting-config .bottom-button .default-icon{font-size:.64rem}.edit-setting-config .bottom-button .btns{border:none}.edit-setting-config .process-slider-row .van-slider{height:8px;background:#f3f3f5}.edit-setting-config .process-slider-row .van-slider .van-slider__bar{background:var(--borderColorMain)}.edit-setting-config .process-slider-row .auto-focus-btn{font-size:.42667rem;width:45%}.edit-setting-config .process-slider-row .auto-focus-btn .van-button__text{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.edit-setting-config .process-slider-row .auto-focus-btn .focus-icon{font-size:.48rem}.edit-setting-config .process-slider-row .border-cell{border:1px solid #eee;margin-left:10px;width:2.13333rem;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;padding:5px .4rem;border-radius:4px}.edit-setting-config .process-slider-row .no-border{width:3.73333rem;padding:3px 0}.edit-setting-config .process-slider-row .no-border .van-field__control{text-align:right}.edit-setting-config .process-slider-row .times{padding:5px 3px}.edit-setting-config .process-slider-row .times .van-field__control{text-align:center}.edit-setting-config .process-slider-row .times .van-icon:before{font-size:.34667rem;color:#333}.edit-setting-config .process-slider-row .times.leftDisabled .van-icon-minus:before{color:#ccc}.edit-setting-config .process-slider-row .times.rightDisabled .van-icon-plus:before{color:#ccc}.edit-setting-config .tabs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:8.93333rem}.edit-setting-config .tabs .tabs-item{width:33.33%;text-align:center;padding:10px 0;border:1px solid #e0e0e6}.edit-setting-config .tabs .tabs-item:first-child{border-radius:3px 0 0 3px;border-right:none}.edit-setting-config .tabs .tabs-item:last-child{border-radius:0 3px 3px 0;border-left:none}.edit-setting-config .tabs .active{color:#fff;background:var(--borderColorMain)}.edit-setting-config .tabs .full-item{width:100%;border:1px solid #e0e0e6}.edit-page-bar[data-v-dde2a7d5]{height:1.33333rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:0 .56rem;border-bottom:1px solid #eee;z-index:100}.edit-page-bar .change-page-btn[data-v-dde2a7d5]{display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;padding:0 5px;height:.74667rem;line-height:.74667rem;text-align:center;font-size:.37333rem;font-weight:400;color:#333639;border-radius:3px;border:1px solid #e0e0e6}.edit-page-bar .change-page-btn.disabled[data-v-dde2a7d5]{background:#fafafc;border:1px solid #e0e0e6;color:#c2c2c2}.edit-page-bar .show-pages-btn[data-v-dde2a7d5]{width:3.2rem;padding:0 10px;text-align:center}.edit-page-bar .van-icon-arrow:before{content:"";-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.process-box .n-progress-graph-line-fill,.process-box .n-progress-graph-line-fill .n-progress-graph-line-indicator{background:var(--backgroundColorMain)!important}.process-box[data-v-86a943ce]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:.53333rem 0 0;width:100%}.process-box .btn[data-v-86a943ce]{width:100%;height:1.33333rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;padding:10px .53333rem}.process-box .btn button[data-v-86a943ce]{margin:0 10px}.start-process-pop{padding:1.33333rem 10px 10px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;height:100%}.start-process-pop .page-title{position:absolute;top:.4rem;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translate(-50%);font-size:.42667rem;font-weight:400;color:#000}.start-process-pop .van-button{margin-bottom:10px}.start-process-pop .van-button .icon{margin-right:5px}.start-process-pop .van-button .icon .iconfont{font-size:.64rem!important}.start-process-pop .van-button .van-button__text{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.start-process-pop .bottom-infos{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;padding:.93333rem 0;position:relative}.start-process-pop .bottom-infos .times{font-size:.50667rem;font-weight:400;color:#000;line-height:.69333rem}.start-process-pop .bottom-infos .send-btn{padding:0 1.6rem;margin-top:1.06667rem}.start-process-pop .bottom-infos .complate-btn{padding:0 1.6rem}.start-process-pop .bottom-infos .finished-box{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;font-size:.50667rem;font-weight:400;color:#000}.start-process-pop .bottom-infos .finished-box .finished-image{width:4.05333rem;height:3.2rem;margin-bottom:.32rem}.start-process-pop .bottom-infos .standby-status-content{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.start-process-pop .bottom-infos .standby-status-content .equ-img{width:9.12rem;height:6.77333rem;-webkit-transform:translateY(-.93333rem);-ms-transform:translateY(-.93333rem);transform:translateY(-.93333rem)}.start-process-pop .bottom-infos .standby-status-content .words{font-size:.50667rem;font-weight:400;color:#000;margin-top:1.06667rem}.start-process-pop .bottom-infos .working-status{width:80%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.start-process-pop .bottom-remarks{background:#fef7ed;border-radius:3px;font-size:.37333rem;font-weight:400;color:#000;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;padding:11px 8px 9px;margin-top:1.33333rem;border:1px solid #fae0b5;position:fixed;bottom:.8rem;left:0}.start-process-pop .bottom-remarks .title{font-size:.37333rem;font-weight:700;color:#000}.start-process-pop .gcodeViewContainer{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;overflow:hidden;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.shape-pop-content[data-v-50a2862e]{width:100%;padding:0 .42667rem .42667rem}.shape-pop-content .shape-box[data-v-50a2862e]{width:2.74667rem;height:2.74667rem;background:#ffffff;border:1px solid #e0e0e6;margin-top:.42667rem;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:4px}.shape-pop-content .shape-box .triangle[data-v-50a2862e]{width:0;height:0;border-right:.82667rem solid transparent;border-left:.82667rem solid transparent;border-bottom:1.65333rem solid #7a7a7a}.shape-pop-content .shape-box .round[data-v-50a2862e]{width:1.65333rem;height:1.65333rem;border-radius:1.65333rem;background-color:#7a7a7a}.shape-pop-content .shape-box .square[data-v-50a2862e]{width:1.54667rem;height:1.54667rem;background:#7a7a7a;border-radius:2px}.shape-pop-content .shape-box .pentagram[data-v-50a2862e]{width:2.08rem;height:2.08rem;border-radius:4px;background:url('+new URL("pentagram-4942ff41.png",o.meta.url).href+");background-size:100% 100%}.mobile-edit-page[data-v-ed89a200]{font-size:.42667rem;color:#333639}.mobile-edit-page .bar-right-icon[data-v-ed89a200]{background:white;color:var(--backgroundColorMain);border-radius:.48rem;padding:6px .42667rem}.mobile-edit-page .bar-right-icon.disabled[data-v-ed89a200]{opacity:.5}.mobile-edit-page #rulerX[data-v-ed89a200]{position:absolute;left:.53333rem;top:2.56rem;border-left:1px solid #e0e0e6;border-bottom:1px solid #e0e0e6}.mobile-edit-page #rulerY[data-v-ed89a200]{position:absolute;left:0;top:3.09333rem;border-top:1px solid #e0e0e6;border-right:1px solid #e0e0e6}.mobile-edit-page .canvas-box[data-v-ed89a200]{padding:.66667rem 0 0 .56rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}\n",document.head.appendChild(ze);var Ge=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function We(e){return Ge.test(e)}var Ye="\\ud800-\\udfff",Xe="["+Ye+"]",Ve="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",qe="\\ud83c[\\udffb-\\udfff]",Ze="[^"+Ye+"]",Ke="(?:\\ud83c[\\udde6-\\uddff]){2}",Je="[\\ud800-\\udbff][\\udc00-\\udfff]",Qe="(?:"+Ve+"|"+qe+")"+"?",$e="[\\ufe0e\\ufe0f]?",et=$e+Qe+("(?:\\u200d(?:"+[Ze,Ke,Je].join("|")+")"+$e+Qe+")*"),tt="(?:"+[Ze+Ve+"?",Ve,Ke,Je,Xe].join("|")+")",rt=RegExp(qe+"(?="+qe+")|"+tt+et,"g");function it(e){return We(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.split("")}(e)}var nt,at=(nt="toUpperCase",function(e){var t=We(e=se(e))?it(e):void 0,r=t?t[0]:e.charAt(0),i=t?He(t,1).join(""):e.slice(1);return r[nt]()+i}),st="[object String]";function ot(e){return"string"==typeof e||!xe(e)&&Le(e)&&je(e)==st}function ct(e){return"number"==typeof e||Le(e)&&"[object Number]"==je(e)}var lt={};function ut(e,t){var r=lt[e]||0,i=(new Date).getTime();i-r<=300&&t&&t(),lt[e]=i}var ht={class:"edit-setting-config"},ft={key:0,class:"bottom-button"},dt={class:"icon operate-icons"},pt={class:"icon operate-icons"},mt={key:1,class:"bottom-button process"},bt={class:"process-slider-row flex-center meterial"},vt={class:"process-slider-row flex-center"},gt={class:"tabs"},yt=["title","name","onClick"],_t={key:0},wt={class:"process-slider-row"},xt={class:"prosess-title"},kt={class:"flex flex-center paddLeft15"},St={class:"process-slider-row"},Ct={class:"prosess-title"},Ut={class:"flex flex-center paddLeft15"},Et={class:"process-slider-row flex-center"},Tt={class:"prosess-title"},Mt={key:1},Ot={class:"process-slider-row"},Pt={class:"prosess-title"},At={class:"flex flex-center paddLeft15"},It={class:"process-slider-row"},Lt={class:"prosess-title"},jt={class:"flex flex-center paddLeft15"},Rt={class:"process-slider-row flex-center"},Dt={class:"prosess-title"},Bt={key:2},Ft={class:"process-slider-row"},Nt={class:"prosess-title"},zt={class:"flex flex-center paddLeft15"},Ht={class:"process-slider-row"},Gt={class:"prosess-title"},Wt={class:"flex flex-center paddLeft15"},Yt={class:"process-slider-row flex-center"},Xt={class:"prosess-title"},Vt=c({__name:"EditBottomBar",props:{isShowProcessPop:{type:Boolean},isCanvasMoved:{type:Boolean},currentPage:null,buttons:null,processAttr:null,processMode:null,imageProcessMode:null,plate:null,times:null,isRanging:{type:Boolean},isTakingPhoto:{type:Boolean}},emits:["handleToolClick","handleSwitchModel","onClickTab","onFormChange","handleFocus","handleTakePhoto","update:processAttr","update:plate","update:times"],setup:function(e,t){var r=t.emit,i=e,n=l((function(){return i.isShowProcessPop})),a=l((function(){return i.isCanvasMoved})),s=l((function(){return oe(i.processAttr)})),o=u({"engrave.power":!1,"fillEngrave.power":!1,"cut.power":!1,"engrave.speed":!1,"fillEngrave.speed":!1,"cut.speed":!1}),c=600,h=250,f=l((function(){return v.value||i.processAttr.processMode===ke.fillEngrave})),p=l((function(){return f.value?c:h})),m=l({get:function(){return i.plate},set:function(e){r("update:plate",e)}}),v=l((function(){return"image"===s.value.type})),g=function(){r("handleSwitchModel")},_=function(e,t,r){if(!(e.indexOf("power")>-1||e.indexOf("speed")>-1)||o[e]){var i=t?parseInt(t):null;i&&i>r?(s.value[e]=r,L(e,r)):L(e,i)}else o[e]=!0},w=function(e,t){return""===e||"0"===e?e:(e?parseInt(e):0)>t?""+t:e},L=function(e,t){r("onFormChange",e,t)},j=function(){r("handleTakePhoto")},R=function(){r("handleFocus")},D=function(e,t,r){var i=t;if("minus"===r){if(!t||i<=1)return;i=Number(i)-1}else"plus"===r&&(i=Number(i)+1);L(e,i)};return function(t,i){var c=O("vk-icon"),l=O("van-button"),u=O("van-field"),h=O("van-loading"),f=O("van-slider");return P(),d("div",ht,[b(n)?(P(),d("div",mt,[C("div",null,[C("div",bt,[C("span",null,U(t.$t("editor.material"))+":",1),k(u,{modelValue:b(m),"onUpdate:modelValue":i[0]||(i[0]=function(e){return E(m)?m.value=e:null}),class:"no-border","is-link":"",readonly:"",name:"picker"},null,8,["modelValue"])]),C("div",vt,[k(l,{class:"auto-focus-btn",onClick:j},{default:S((function(){return[e.isTakingPhoto?(P(),A(h,{key:0,color:"#333",type:"spinner",size:"16px"})):M("",!0),I("  "+U(t.$t("editor.refreshBg"))+"  ",1)]})),_:1}),k(l,{class:"auto-focus-btn",onClick:R},{default:S((function(){return[e.isRanging?(P(),A(h,{key:0,color:"#333",type:"spinner",size:"16px"})):M("",!0),I("  "+U(t.$t("editor.autoFocus"))+"  ",1),k(c,{icon:"",class:"focus-icon"})]})),_:1})]),C("div",gt,[(P(!0),d(y,null,x(b(v)?e.imageProcessMode:e.processMode,(function(e,t){return P(),d("div",{key:t,class:T(["tabs-item",{active:b(s).processMode===e.key,"full-item":b(v)}]),title:e.label,name:e.key,onClick:function(t){return function(e){"fillEngrave"===e?(o["fillEngrave.power"]=!1,o["fillEngrave.speed"]=!1):"engrave"===e?(o["engrave.power"]=!1,o["engrave.speed"]=!1):"cut"===e&&(o["cut.power"]=!1,o["cut.speed"]=!1),r("onClickTab",e)}(e.key)}},[C("span",null,U(e.label),1)],10,yt)})),128))]),b(s).processMode===b(ke).engrave?(P(),d("div",_t,[C("div",wt,[C("span",xt,U(t.$t("editor.power"))+" (%):",1),C("div",kt,[k(f,{modelValue:b(s).engrave.power,"onUpdate:modelValue":i[1]||(i[1]=function(e){return b(s).engrave.power=e}),max:100,onChange:i[2]||(i[2]=function(e){return L("engrave.power",e)})},null,8,["modelValue"]),k(u,{modelValue:b(s).engrave.power,"onUpdate:modelValue":[i[3]||(i[3]=function(e){return b(s).engrave.power=e}),i[4]||(i[4]=function(e){return _("engrave.power",e,100)})],class:T(["border-cell",{line:b(s).engrave.power>100}]),type:"number",max:100,formatter:function(e){return w(e,100)}},null,8,["modelValue","class","formatter"])])]),C("div",St,[C("span",Ct,U(t.$t("editor.speed"))+" (mm/s):",1),C("div",Ut,[k(f,{modelValue:b(s).engrave.speed,"onUpdate:modelValue":i[5]||(i[5]=function(e){return b(s).engrave.speed=e}),max:b(p),onChange:i[6]||(i[6]=function(e){return L("engrave.speed",e)})},null,8,["modelValue","max"]),k(u,{modelValue:b(s).engrave.speed,"onUpdate:modelValue":[i[7]||(i[7]=function(e){return b(s).engrave.speed=e}),i[8]||(i[8]=function(e){return _("engrave.speed",e,b(p))})],class:"border-cell",type:"number",formatter:function(e){return w(e,b(p))}},null,8,["modelValue","formatter"])])]),C("div",Et,[C("span",Tt,U(t.$t("editor.proTimes"))+":",1),k(u,{modelValue:b(s).engrave.repeat,"onUpdate:modelValue":i[9]||(i[9]=function(e){return b(s).engrave.repeat=e}),class:T(["times border-cell",{leftDisabled:b(s).engrave.repeat<=1,rightDisabled:b(s).engrave.repeat>=999}]),type:"number","left-icon":"minus","right-icon":"plus",onClickLeftIcon:i[10]||(i[10]=function(){return D("engrave.repeat",b(s).engrave.repeat,"minus")}),onClickRightIcon:i[11]||(i[11]=function(){return D("engrave.repeat",b(s).engrave.repeat,"plus")}),onChange:i[12]||(i[12]=function(e){D("engrave.repeat",e)})},null,8,["modelValue","class"])])])):M("",!0),b(s).processMode===b(ke).fillEngrave?(P(),d("div",Mt,[C("div",Ot,[C("span",Pt,U(t.$t("editor.power"))+" (%):",1),C("div",At,[k(f,{modelValue:b(s).fillEngrave.power,"onUpdate:modelValue":i[13]||(i[13]=function(e){return b(s).fillEngrave.power=e}),max:100,onChange:i[14]||(i[14]=function(e){return L("fillEngrave.power",e)})},null,8,["modelValue"]),k(u,{modelValue:b(s).fillEngrave.power,"onUpdate:modelValue":[i[15]||(i[15]=function(e){return b(s).fillEngrave.power=e}),i[16]||(i[16]=function(e){return _("fillEngrave.power",e,100)})],class:"border-cell",type:"number",maxlength:"100",formatter:function(e){return w(e,100)}},null,8,["modelValue","formatter"])])]),C("div",It,[C("span",Lt,U(t.$t("editor.speed"))+" (mm/s):",1),C("div",jt,[k(f,{modelValue:b(s).fillEngrave.speed,"onUpdate:modelValue":i[17]||(i[17]=function(e){return b(s).fillEngrave.speed=e}),max:b(p),onChange:i[18]||(i[18]=function(e){return L("fillEngrave.speed",e)})},null,8,["modelValue","max"]),k(u,{modelValue:b(s).fillEngrave.speed,"onUpdate:modelValue":[i[19]||(i[19]=function(e){return b(s).fillEngrave.speed=e}),i[20]||(i[20]=function(e){return _("fillEngrave.speed",e,b(p))})],class:"border-cell",type:"number",formatter:function(e){return w(e,b(p))}},null,8,["modelValue","formatter"])])]),C("div",Rt,[C("span",Dt,U(t.$t("editor.proTimes"))+":",1),k(u,{modelValue:b(s).fillEngrave.repeat,"onUpdate:modelValue":i[21]||(i[21]=function(e){return b(s).fillEngrave.repeat=e}),class:T(["times border-cell",{leftDisabled:b(s).fillEngrave.repeat<=1,rightDisabled:b(s).fillEngrave.repeat>=999}]),type:"number","left-icon":"minus","right-icon":"plus",onClickLeftIcon:i[22]||(i[22]=function(){return D("fillEngrave.repeat",b(s).fillEngrave.repeat,"minus")}),onClickRightIcon:i[23]||(i[23]=function(){return D("fillEngrave.repeat",b(s).fillEngrave.repeat,"plus")}),onChange:i[24]||(i[24]=function(e){D("fillEngrave.repeat",e)})},null,8,["modelValue","class"])])])):M("",!0),b(s).processMode===b(ke).cut?(P(),d("div",Bt,[C("div",Ft,[C("span",Nt,U(t.$t("editor.power"))+" (%):",1),C("div",zt,[k(f,{modelValue:b(s).cut.power,"onUpdate:modelValue":i[25]||(i[25]=function(e){return b(s).cut.power=e}),max:100,onChange:i[26]||(i[26]=function(e){return L("cut.power",e)})},null,8,["modelValue"]),k(u,{modelValue:b(s).cut.power,"onUpdate:modelValue":[i[27]||(i[27]=function(e){return b(s).cut.power=e}),i[28]||(i[28]=function(e){return _("cut.power",e,100)})],class:"border-cell",type:"number",formatter:function(e){return w(e,100)}},null,8,["modelValue","formatter"])])]),C("div",Ht,[C("span",Gt,U(t.$t("editor.speed"))+" (mm/s):",1),C("div",Wt,[k(f,{modelValue:b(s).cut.speed,"onUpdate:modelValue":i[29]||(i[29]=function(e){return b(s).cut.speed=e}),max:b(p),onChange:i[30]||(i[30]=function(e){return L("cut.speed",e)})},null,8,["modelValue","max"]),k(u,{modelValue:b(s).cut.speed,"onUpdate:modelValue":[i[31]||(i[31]=function(e){return b(s).cut.speed=e}),i[32]||(i[32]=function(e){return _("cut.speed",e,b(p))})],class:"border-cell",type:"number",formatter:function(e){return w(e,b(p))}},null,8,["modelValue","formatter"])])]),C("div",Yt,[C("span",Xt,U(t.$t("editor.proTimes"))+":",1),k(u,{modelValue:b(s).cut.repeat,"onUpdate:modelValue":i[33]||(i[33]=function(e){return b(s).cut.repeat=e}),class:T(["times border-cell",{leftDisabled:b(s).cut.repeat<=1,rightDisabled:b(s).cut.repeat>=999}]),type:"number","left-icon":"minus","right-icon":"plus",onClickLeftIcon:i[34]||(i[34]=function(){return D("cut.repeat",b(s).cut.repeat,"minus")}),onClickRightIcon:i[35]||(i[35]=function(){return D("cut.repeat",b(s).cut.repeat,"plus")}),onChange:i[36]||(i[36]=function(e){D("cut.repeat",e)})},null,8,["modelValue","class"])])])):M("",!0)])])):(P(),d("div",ft,[(P(!0),d(y,null,x(e.buttons,(function(e,t){return P(),A(l,{key:t,class:"btns",size:"small",onClick:function(t){return function(e){r("handleToolClick",e)}(e.key)}},{default:S((function(){return[C("div",dt,[k(c,{icon:e.icon},null,8,["icon"])]),I(" "+U(e.label),1)]})),_:2},1032,["onClick"])})),128)),k(l,{class:"btns",size:"small",onClick:g},{default:S((function(){return[C("div",pt,[b(a)?(P(),A(c,{key:0,icon:"",class:"bottom-icon"})):(P(),A(c,{key:1,icon:"",class:"bottom-icon"}))]),I(" "+U(b(a)?t.$t("editor.edit"):t.$t("editor.move")),1)]})),_:1})]))])}}}),qt=L(Vt,[["__scopeId","data-v-ccf00891"]]),Zt={class:"edit-page-bar"},Kt=["onClick"],Jt=c({__name:"PageBar",props:{isShowPagePick:{type:Boolean},currentPage:null,canvasList:null},emits:["prePage","nextPage","showPagePop","closePagePop","onSelectPage"],setup:function(e,t){var r=t.emit,i=e,n=l((function(){return i.isShowPagePick})),a=function(){r("prePage")},s=function(){r("nextPage")},o=function(){r("showPagePop")},c=function(){r("closePagePop")},u=function(e){r("onSelectPage",e)};return function(t,r){var i=O("van-cell"),l=O("van-action-sheet");return P(),d(y,null,[C("div",Zt,[C("span",{class:T(["change-page-btn",{disabled:1===e.currentPage}]),onClick:a},U(t.$t("editor.lastPage")),3),k(i,{class:"show-pages-btn","is-link":"",title:"".concat(e.currentPage," / ").concat(e.canvasList.length||0),onClick:j(o,["stop"])},null,8,["title","onClick"]),C("span",{class:T(["change-page-btn",{disabled:e.currentPage===e.canvasList.length}]),onClick:j(s,["stop"])},U(t.$t("editor.nextPage")),11,Kt)]),k(l,{show:b(n),"onUpdate:show":r[0]||(r[0]=function(e){return E(n)?n.value=e:null}),actions:e.canvasList,"cancel-text":t.$t("common.close"),title:t.$t("editor.pageTitle"),"close-on-click-action":"",style:{"max-height":"50%"},onCancel:c,onSelect:u},null,8,["show","actions","cancel-text","title"])],64)}}}),Qt=L(Jt,[["__scopeId","data-v-dde2a7d5"]]),$t=""+new URL("finished-image-62ab7aa0.png",o.meta.url).href,er={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"},tr="^\\s*",rr="\\s*$",ir="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",nr="([0-9A-Fa-f])",ar="([0-9A-Fa-f]{2})",sr=new RegExp("".concat(tr,"rgb\\s*\\(").concat(ir,",").concat(ir,",").concat(ir,"\\)").concat(rr)),or=new RegExp("".concat(tr,"rgba\\s*\\(").concat(ir,",").concat(ir,",").concat(ir,",").concat(ir,"\\)").concat(rr)),cr=new RegExp("".concat(tr,"#").concat(nr).concat(nr).concat(nr).concat(rr)),lr=new RegExp("".concat(tr,"#").concat(ar).concat(ar).concat(ar).concat(rr)),ur=new RegExp("".concat(tr,"#").concat(nr).concat(nr).concat(nr).concat(nr).concat(rr)),hr=new RegExp("".concat(tr,"#").concat(ar).concat(ar).concat(ar).concat(ar).concat(rr));function fr(e){return parseInt(e,16)}function dr(e){try{var t;if(t=lr.exec(e))return[fr(t[1]),fr(t[2]),fr(t[3]),1];if(t=sr.exec(e))return[gr(t[1]),gr(t[5]),gr(t[9]),1];if(t=or.exec(e))return[gr(t[1]),gr(t[5]),gr(t[9]),vr(t[13])];if(t=cr.exec(e))return[fr(t[1]+t[1]),fr(t[2]+t[2]),fr(t[3]+t[3]),1];if(t=hr.exec(e))return[fr(t[1]),fr(t[2]),fr(t[3]),vr(fr(t[4])/255)];if(t=ur.exec(e))return[fr(t[1]+t[1]),fr(t[2]+t[2]),fr(t[3]+t[3]),vr(fr(t[4]+t[4])/255)];if(e in er)return dr(er[e]);throw new Error("[seemly/rgba]: Invalid color value ".concat(e,"."))}catch(r){throw r}}function pr(e,t,r,i,n){return gr((e*t*(1-i)+r*i)/n)}function mr(e,t){Array.isArray(e)||(e=dr(e)),Array.isArray(t)||(t=dr(t));var r,i,n,a,s,o=e[3],c=t[3],l=vr(o+c-o*c);return r=pr(e[0],o,t[0],c,l),i=pr(e[1],o,t[1],c,l),n=pr(e[2],o,t[2],c,l),a=l,"rgba(".concat(gr(r),", ").concat(gr(i),", ").concat(gr(n),", ").concat((s=a)>1?1:s<0?0:s,")")}function br(e,t){var r=w(Array.isArray(e)?e:dr(e),4),i=r[0],n=r[1],a=r[2],s=r[3],o=void 0===s?1:s,c=t.lightness,l=void 0===c?1:c,u=t.alpha;return function(e){var t=w(e,3),r=t[0],i=t[1],n=t[2];if(3 in e)return"rgba(".concat(gr(r),", ").concat(gr(i),", ").concat(gr(n),", ").concat(vr(e[3]),")");return"rgba(".concat(gr(r),", ").concat(gr(i),", ").concat(gr(n),", 1)")}([i*l,n*l,a*l,o*(void 0===u?1:u)])}function vr(e){var t=Math.round(100*Number(e))/100;return t>1?1:t<0?0:t}function gr(e){var t=Math.round(Number(e));return t>255?255:t<0?0:t}var yr=/^(\d|\.)+$/,_r=/(\d|\.)+/;function wr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.c,i=void 0===r?1:r,n=t.offset,a=void 0===n?0:n,s=t.attachPx,o=void 0===s||s;if("number"==typeof e){var c=(e+a)*i;return 0===c?"0":"".concat(c,"px")}if("string"==typeof e){if(yr.test(e)){var l=(Number(e)+a)*i;return o?0===l?"0":"".concat(l,"px"):"".concat(l)}var u=_r.exec(e);return u?e.replace(_r,String((Number(u[0])+a)*i)):e}return e}var xr=/\s*,(?![^(]*\))\s*/g,kr=/\s+/g;function Sr(e){var t=[""];return e.forEach((function(e){(e=e&&e.trim())&&(t=e.includes("&")?function(e,t){var r=[];return t.split(xr).forEach((function(t){var i=function(e){for(var t=0,r=0;r<e.length;++r)"&"===e[r]&&++t;return t}(t);if(i)if(1!==i){for(var n=[t],a=function(){var t=[];n.forEach((function(r){e.forEach((function(e){t.push(r.replace("&",e))}))})),n=t};i--;)a();n.forEach((function(e){return r.push(e)}))}else e.forEach((function(e){r.push(t.replace("&",e))}));else e.forEach((function(e){r.push((e&&e+" ")+t)}))})),r}(t,e):function(e,t){var r=[];return t.split(xr).forEach((function(t){e.forEach((function(e){r.push((e&&e+" ")+t)}))})),r}(t,e))})),t.join(", ").replace(kr," ")}function Cr(e){if(e){var t=e.parentElement;t&&t.removeChild(e)}}function Ur(e){return document.querySelector('style[cssr-id="'.concat(e,'"]'))}function Er(e){return!!e&&/^\s*@(s|m)/.test(e)}var Tr=/[A-Z]/g;function Mr(e){return e.replace(Tr,(function(e){return"-"+e.toLowerCase()}))}function Or(e,t,r,i){if(!t)return"";var n=function(e,t,r){return"function"==typeof e?e({context:t.context,props:r}):e}(t,r,i);if(!n)return"";if("string"==typeof n)return"".concat(e," {\n").concat(n,"\n}");var a=Object.keys(n);if(0===a.length)return r.config.keepEmptyBlock?e+" {\n}":"";var s=e?[e+" {"]:[];return a.forEach((function(e){var t=n[e];"raw"!==e?(e=Mr(e),null!=t&&s.push("  ".concat(e).concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"  ";return"object"===_(e)&&null!==e?" {\n"+Object.entries(e).map((function(e){return t+"  ".concat(Mr(e[0]),": ").concat(e[1],";")})).join("\n")+"\n"+t+"}":": ".concat(e,";")}(t)))):s.push("\n"+t+"\n")})),e&&s.push("}"),s.join("\n")}function Pr(e,t,r){e&&e.forEach((function(e){if(Array.isArray(e))Pr(e,t,r);else if("function"==typeof e){var i=e(t);Array.isArray(i)?Pr(i,t,r):i&&r(i)}else e&&r(e)}))}function Ar(e,t,r,i,n,a){var s=e.$,o="";if(s&&"string"!=typeof s)if("function"==typeof s){var c=s({context:i.context,props:n});Er(c)?o=c:t.push(c)}else if(s.before&&s.before(i.context),s.$&&"string"!=typeof s.$){if(s.$){var l=s.$({context:i.context,props:n});Er(l)?o=l:t.push(l)}}else Er(s.$)?o=s.$:t.push(s.$);else Er(s)?o=s:t.push(s);var u=Sr(t),h=Or(u,e.props,i,n);o?(r.push("".concat(o," {")),a&&h&&a.insertRule("".concat(o," {\n").concat(h,"\n}\n"))):(a&&h&&a.insertRule(h),!a&&h.length&&r.push(h)),e.children&&Pr(e.children,{context:i.context,props:n},(function(e){if("string"==typeof e){var s=Or(u,{raw:e},i,n);a?a.insertRule(s):r.push(s)}else Ar(e,t,r,i,n,a)})),t.pop(),o&&r.push("}"),s&&s.after&&s.after(i.context)}function Ir(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=[];return Ar(e,[],n,t,r,i?e.instance.__styleSheet:void 0),i?"":n.join("\n\n")}function Lr(e){for(var t,r=0,i=0,n=e.length;n>=4;++i,n-=4)t=1540483477*(65535&(t=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(n){case 3:r^=(255&e.charCodeAt(i+2))<<16;case 2:r^=(255&e.charCodeAt(i+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(i)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}function jr(e,t){e.push(t)}function Rr(e,t,r,i,n,a,s,o,c){if(!a||c){var l;if(void 0===r&&(r=Lr(l=t.render(i))),!c){var u=Ur(r);if(null!==u&&!s)return u;var h=null!=u?u:function(e){var t=document.createElement("style");return t.setAttribute("cssr-id",e),t}(r);if(void 0===l&&(l=t.render(i)),h.textContent=l,null!==u)return u;if(o){var f=document.head.querySelector('meta[name="'.concat(o,'"]'));if(f)return document.head.insertBefore(h,f),jr(t.els,h),h}return n?document.head.insertBefore(h,document.head.querySelector("style, link")):document.head.appendChild(h),jr(t.els,h),h}c.adapter(r,null!=l?l:t.render(i))}else{if(void 0===r)return void console.error("[css-render/mount]: `id` is required in `silent` mode.");var d=window.__cssrContext;d[r]||(d[r]=!0,Ir(t,e,i,a))}}function Dr(e){return Ir(this,this.instance,e)}function Br(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.ssr,i=e.props,n=e.head,a=void 0!==n&&n,s=e.silent,o=void 0!==s&&s,c=e.force,l=void 0!==c&&c,u=e.anchorMetaName;return Rr(this.instance,this,t,i,a,o,l,u,r)}function Fr(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;!function(e,t,r){var i=t.els;if(void 0===r)i.forEach(Cr),t.els=[];else{var n=Ur(r);n&&i.includes(n)&&(Cr(n),t.els=i.filter((function(e){return e!==n})))}}(this.instance,this,e)}"undefined"!=typeof window&&(window.__cssrContext={});var Nr=function(e,t,r,i){return{instance:e,$:t,props:r,children:i,els:[],render:Dr,mount:Br,unmount:Fr}},zr=function(e,t,r,i){return Array.isArray(t)?Nr(e,{$:null},null,t):Array.isArray(r)?Nr(e,t,null,r):Array.isArray(i)?Nr(e,t,r,i):Nr(e,t,r,null)};function Hr(e,t){return e+("default"===t?"":t.replace(/^[a-z]/,(function(e){return e.toUpperCase()})))}Hr("abc","def");var Gr=".".concat("n","-"),Wr=function(){var e=null,t={c:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return zr.apply(void 0,[t].concat(r))},use:function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];return e.install.apply(e,[t].concat(i))},find:Ur,context:{},config:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},get __styleSheet(){if(!e){var t=document.createElement("style");return document.head.appendChild(t),e=document.styleSheets[document.styleSheets.length-1]}return e}};return t}(),Yr=function(e){var t,r=".",i="__",n="--";if(e){var a=e.blockPrefix;a&&(r=a),(a=e.elementPrefix)&&(i=a),(a=e.modifierPrefix)&&(n=a)}var s={install:function(e){t=e.c;var r=e.context;r.bem={},r.bem.b=null,r.bem.els=null}};return Object.assign(s,{cB:function(){return t((e=arguments.length<=0?void 0:arguments[0],{before:function(e){i=e.bem.b,n=e.bem.els,e.bem.els=null},after:function(e){e.bem.b=i,e.bem.els=n},$:function(t){var i=t.context,n=t.props;return e="string"==typeof e?e:e({context:i,props:n}),i.bem.b=e,"".concat((null==n?void 0:n.bPrefix)||r).concat(i.bem.b)}}),arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);var e,i,n},cE:function(){return t((e=arguments.length<=0?void 0:arguments[0],{before:function(e){n=e.bem.els},after:function(e){e.bem.els=n},$:function(t){var n=t.context,a=t.props;return e="string"==typeof e?e:e({context:n,props:a}),n.bem.els=e.split(",").map((function(e){return e.trim()})),n.bem.els.map((function(e){return"".concat((null==a?void 0:a.bPrefix)||r).concat(n.bem.b).concat(i).concat(e)})).join(", ")}}),arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);var e,n},cM:function(){return t((e=arguments.length<=0?void 0:arguments[0],{$:function(t){var a=t.context,s=t.props,o=(e="string"==typeof e?e:e({context:a,props:s})).split(",").map((function(e){return e.trim()}));function c(e){return o.map((function(t){return"&".concat((null==s?void 0:s.bPrefix)||r).concat(a.bem.b).concat(void 0!==e?"".concat(i).concat(e):"").concat(n).concat(t)})).join(", ")}var l=a.bem.els;return null!==l?c(l[0]):c()}}),arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);var e},cNotM:function(){return t((e=arguments.length<=0?void 0:arguments[0],{$:function(t){var a=t.context,s=t.props;e="string"==typeof e?e:e({context:a,props:s});var o=a.bem.els;return"&:not(".concat((null==s?void 0:s.bPrefix)||r).concat(a.bem.b).concat(null!==o&&o.length>0?"".concat(i).concat(o[0]):"").concat(n).concat(e,")")}}),arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);var e}}),s}({blockPrefix:Gr,elementPrefix:"__",modifierPrefix:"--"});Wr.use(Yr);var Xr=Wr.c,Vr=(Wr.find,Yr.cB),qr=(Yr.cE,Yr.cM),Zr=(Yr.cNotM,Symbol("@css-render/vue3-ssr"));function Kr(e,t){var r=R(Zr,null);if(null!==r){var i=r.styles,n=r.ids;n.has(e)||null!==i&&(n.add(e),i.push(function(e,t){return'<style cssr-id="'.concat(e,'">\n').concat(t,"\n</style>")}(e,t)))}else console.error("[css-render/vue3-ssr]: no ssr context found.")}var Jr="undefined"!=typeof document;function Qr(){if(!Jr){var e=R(Zr,null);if(null!==e)return{adapter:Kr,context:e}}}var $r={fontFamily:'v-sans, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontFamilyMono:"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace",fontWeight:"400",fontWeightStrong:"500",cubicBezierEaseInOut:"cubic-bezier(.4, 0, .2, 1)",cubicBezierEaseOut:"cubic-bezier(0, 0, .2, 1)",cubicBezierEaseIn:"cubic-bezier(.4, 0, 1, 1)",borderRadius:"3px",borderRadiusSmall:"2px",fontSize:"14px",fontSizeMini:"12px",fontSizeTiny:"12px",fontSizeSmall:"14px",fontSizeMedium:"14px",fontSizeLarge:"15px",fontSizeHuge:"16px",lineHeight:"1.6",heightMini:"16px",heightTiny:"22px",heightSmall:"28px",heightMedium:"34px",heightLarge:"40px",heightHuge:"46px"},ei=$r.fontFamily,ti=$r.lineHeight,ri=Xr("body","\n margin: 0;\n font-size: ".concat($r.fontSize,";\n font-family: ").concat(ei,";\n line-height: ").concat(ti,";\n -webkit-text-size-adjust: 100%;\n -webkit-tap-highlight-color: transparent;\n"),[Xr("input","\n font-family: inherit;\n font-size: inherit;\n ")]),ii="n-config-provider",ni="naive-ui-style";function ai(e,t,r,i,n,a){var s=Qr(),o=R(ii,null);if(r){var c=function(){var e=null==a?void 0:a.value;r.mount({id:void 0===e?t:e+t,head:!0,props:{bPrefix:e?".".concat(e,"-"):void 0},anchorMetaName:ni,ssr:s}),(null==o?void 0:o.preflightStyleDisabled)||ri.mount({id:"n-global",head:!0,anchorMetaName:ni,ssr:s})};s?c():D(c)}return l((function(){var t,r=n.theme,a=void 0===r?{}:r,s=a.common,c=a.self,l=a.peers,u=void 0===l?{}:l,h=n.themeOverrides,f=void 0===h?{}:h,d=n.builtinThemeOverrides,p=void 0===d?{}:d,m=f.common,b=f.peers,v=(null==o?void 0:o.mergedThemeRef.value)||{},g=v.common,y=void 0===g?void 0:g,_=v[e],w=void 0===_?{}:_,x=w.common,k=void 0===x?void 0:x,S=w.self,C=void 0===S?void 0:S,U=w.peers,E=void 0===U?{}:U,T=(null==o?void 0:o.mergedThemeOverridesRef.value)||{},M=T.common,O=void 0===M?void 0:M,P=T[e],A=void 0===P?{}:P,I=A.common,L=A.peers,j=void 0===L?{}:L,R=ce({},s||k||y||i.common,O,I,m);return{common:R,self:ce(null===(t=c||C||i.self)||void 0===t?void 0:t(R),p,A,f),peers:ce({},i.peers,E,u),peerOverrides:ce({},p.peers,j,b)}}))}ai.props={theme:Object,themeOverrides:Object,builtinThemeOverrides:Object};function si(e,t,r,i){var n;r||function(e,t){throw new Error("[naive/".concat(e,"]: ").concat(t))}("useThemeClass","cssVarsRef is not passed");var a,s=null===(n=R(ii,null))||void 0===n?void 0:n.mergedThemeHashRef,o=B(""),c=Qr(),l="__".concat(e);return F((function(){!function(){var e=l,n=t?t.value:void 0,u=null==s?void 0:s.value;u&&(e+="-"+u),n&&(e+="-"+n);var h=i.themeOverrides,f=i.builtinThemeOverrides;h&&(e+="-"+Lr(JSON.stringify(h))),f&&(e+="-"+Lr(JSON.stringify(f))),o.value=e,a=function(){var t=r.value,i="";for(var n in t)i+="".concat(n,": ").concat(t[n],";");Xr(".".concat(e),i).mount({id:e,ssr:c}),a=void 0}}()})),{themeClass:o,onRender:function(){null==a||a()}}}function oi(e,t){return c({name:at(e),setup:function(){var r,i=null===(r=R(ii,null))||void 0===r?void 0:r.mergedIconsRef;return function(){var r,n=null===(r=null==i?void 0:i.value)||void 0===r?void 0:r[e];return n?n():t}}})}var ci=oi("error",N("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},N("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},N("g",{"fill-rule":"nonzero"},N("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),li=oi("info",N("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},N("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},N("g",{"fill-rule":"nonzero"},N("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),ui=oi("success",N("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},N("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},N("g",{"fill-rule":"nonzero"},N("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),hi=oi("warning",N("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},N("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},N("g",{"fill-rule":"nonzero"},N("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),fi=Vr("base-icon","\n height: 1em;\n width: 1em;\n line-height: 1em;\n text-align: center;\n display: inline-block;\n position: relative;\n fill: currentColor;\n transform: translateZ(0);\n",[Xr("svg","\n height: 1em;\n width: 1em;\n ")]),di=c({name:"BaseIcon",props:{role:String,ariaLabel:String,ariaDisabled:{type:Boolean,default:void 0},ariaHidden:{type:Boolean,default:void 0},clsPrefix:{type:String,required:!0},onClick:Function,onMousedown:Function,onMouseup:Function},setup:function(e){!function(e,t,r){if(t){var i=Qr(),n=R(ii,null),a=function(){var a=null==r?void 0:r.value;t.mount({id:void 0===a?e:a+e,head:!0,anchorMetaName:ni,props:{bPrefix:a?".".concat(a,"-"):void 0},ssr:i}),(null==n?void 0:n.preflightStyleDisabled)||ri.mount({id:"n-global",head:!0,anchorMetaName:ni,ssr:i})};i?a():D(a)}}("-base-icon",fi,z(e,"clsPrefix"))},render:function(){return N("i",{class:"".concat(this.clsPrefix,"-base-icon"),onClick:this.onClick,onMousedown:this.onMousedown,onMouseup:this.onMouseup,role:this.role,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,"aria-disabled":this.ariaDisabled},this.$slots)}}),pi="#FFF",mi="#000",bi="#000",vi="#fff",gi="#fff",yi="#fff",_i="#fff",wi="0.82",xi="0.72",ki="0.38",Si="0.24",Ci="0.18",Ui="0.6",Ei="0.5",Ti="0.2",Mi=".08",Oi="0",Pi="0.25",Ai="0.4",Ii="#36ad6a",Li="#18a058",ji="#0c7a43",Ri="#36ad6a",Di="#4098fc",Bi="#2080f0",Fi="#1060c9",Ni="#4098fc",zi="#de576d",Hi="#d03050",Gi="#ab1f3f",Wi="#de576d",Yi="#fcb040",Xi="#f0a020",Vi="#c97c10",qi="#fcb040",Zi="#36ad6a",Ki="#18a058",Ji="#0c7a43",Qi="#36ad6a",$i=dr(pi),en=dr(mi),tn="rgba("+en.slice(0,3).join(", ")+", ";function rn(e){return tn+String(e)+")"}function nn(e){var t=Array.from(en);return t[3]=Number(e),mr($i,t)}var an={name:"Progress",common:Object.assign(Object.assign({name:"common"},$r),{baseColor:pi,primaryColor:Li,primaryColorHover:Ii,primaryColorPressed:ji,primaryColorSuppl:Ri,infoColor:Bi,infoColorHover:Di,infoColorPressed:Fi,infoColorSuppl:Ni,successColor:Ki,successColorHover:Zi,successColorPressed:Ji,successColorSuppl:Qi,warningColor:Xi,warningColorHover:Yi,warningColorPressed:Vi,warningColorSuppl:qi,errorColor:Hi,errorColorHover:zi,errorColorPressed:Gi,errorColorSuppl:Wi,textColorBase:bi,textColor1:"rgb(31, 34, 37)",textColor2:"rgb(51, 54, 57)",textColor3:"rgb(118, 124, 130)",textColorDisabled:nn(Si),placeholderColor:nn(Si),placeholderColorDisabled:nn(Ci),iconColor:nn(Si),iconColorHover:br(nn(Si),{lightness:.75}),iconColorPressed:br(nn(Si),{lightness:.9}),iconColorDisabled:nn(Ci),opacity1:wi,opacity2:xi,opacity3:ki,opacity4:Si,opacity5:Ci,dividerColor:"rgb(239, 239, 245)",borderColor:"rgb(224, 224, 230)",closeIconColor:nn(Number(Ui)),closeIconColorHover:nn(Number(Ui)),closeIconColorPressed:nn(Number(Ui)),closeColorHover:"rgba(0, 0, 0, .09)",closeColorPressed:"rgba(0, 0, 0, .13)",clearColor:nn(Si),clearColorHover:br(nn(Si),{lightness:.75}),clearColorPressed:br(nn(Si),{lightness:.9}),scrollbarColor:rn(Pi),scrollbarColorHover:rn(Ai),scrollbarWidth:"5px",scrollbarHeight:"5px",scrollbarBorderRadius:"5px",progressRailColor:nn(Mi),railColor:"rgb(219, 219, 223)",popoverColor:vi,tableColor:gi,cardColor:gi,modalColor:yi,bodyColor:_i,tagColor:"#eee",avatarColor:nn(Ti),invertedColor:"rgb(0, 20, 40)",inputColor:nn(Oi),codeColor:"rgb(244, 244, 248)",tabColor:"rgb(247, 247, 250)",actionColor:"rgb(250, 250, 252)",tableHeaderColor:"rgb(250, 250, 252)",hoverColor:"rgb(243, 243, 245)",tableColorHover:"rgba(0, 0, 100, 0.03)",tableColorStriped:"rgba(0, 0, 100, 0.02)",pressedColor:"rgb(237, 237, 239)",opacityDisabled:Ei,inputColorDisabled:"rgb(250, 250, 252)",buttonColor2:"rgba(46, 51, 56, .05)",buttonColor2Hover:"rgba(46, 51, 56, .09)",buttonColor2Pressed:"rgba(46, 51, 56, .13)",boxShadow1:"0 1px 2px -2px rgba(0, 0, 0, .08), 0 3px 6px 0 rgba(0, 0, 0, .06), 0 5px 12px 4px rgba(0, 0, 0, .04)",boxShadow2:"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05)",boxShadow3:"0 6px 16px -9px rgba(0, 0, 0, .08), 0 9px 28px 0 rgba(0, 0, 0, .05), 0 12px 48px 16px rgba(0, 0, 0, .03)"}),self:function(e){var t=e.infoColor,r=e.successColor,i=e.warningColor,n=e.errorColor,a=e.textColor2,s=e.progressRailColor;return{fontSize:e.fontSize,fontSizeCircle:"28px",fontWeightCircle:e.fontWeight,railColor:s,railHeight:"8px",iconSizeCircle:"36px",iconSizeLine:"18px",iconColor:t,iconColorInfo:t,iconColorSuccess:r,iconColorWarning:i,iconColorError:n,textColorCircle:a,textColorLineInner:"rgb(255, 255, 255)",textColorLineOuter:a,fillColor:t,fillColorInfo:t,fillColorSuccess:r,fillColorWarning:i,fillColorError:n,lineBgProcessing:"linear-gradient(90deg, rgba(255, 255, 255, .3) 0%, rgba(255, 255, 255, .5) 100%)"}}},sn=Xr([Vr("progress",{display:"inline-block"},[Vr("progress-icon","\n color: var(--n-icon-color);\n transition: color .3s var(--n-bezier);\n "),qr("line","\n width: 100%;\n display: block;\n ",[Vr("progress-content","\n display: flex;\n align-items: center;\n ",[Vr("progress-graph",{flex:1})]),Vr("progress-custom-content",{marginLeft:"14px"}),Vr("progress-icon","\n width: 30px;\n padding-left: 14px;\n height: var(--n-icon-size-line);\n line-height: var(--n-icon-size-line);\n font-size: var(--n-icon-size-line);\n ",[qr("as-text","\n color: var(--n-text-color-line-outer);\n text-align: center;\n width: 40px;\n font-size: var(--n-font-size);\n padding-left: 4px;\n transition: color .3s var(--n-bezier);\n ")])]),qr("circle, dashboard",{width:"120px"},[Vr("progress-custom-content","\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translateX(-50%) translateY(-50%);\n display: flex;\n align-items: center;\n justify-content: center;\n "),Vr("progress-text","\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translateX(-50%) translateY(-50%);\n display: flex;\n align-items: center;\n color: inherit;\n font-size: var(--n-font-size-circle);\n color: var(--n-text-color-circle);\n font-weight: var(--n-font-weight-circle);\n transition: color .3s var(--n-bezier);\n white-space: nowrap;\n "),Vr("progress-icon","\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translateX(-50%) translateY(-50%);\n display: flex;\n align-items: center;\n color: var(--n-icon-color);\n font-size: var(--n-icon-size-circle);\n ")]),qr("multiple-circle","\n width: 200px;\n color: inherit;\n ",[Vr("progress-text","\n font-weight: var(--n-font-weight-circle);\n color: var(--n-text-color-circle);\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translateX(-50%) translateY(-50%);\n display: flex;\n align-items: center;\n justify-content: center;\n transition: color .3s var(--n-bezier);\n ")]),Vr("progress-content",{position:"relative"}),Vr("progress-graph",{position:"relative"},[Vr("progress-graph-circle",[Xr("svg",{verticalAlign:"bottom"}),Vr("progress-graph-circle-fill","\n stroke: var(--n-fill-color);\n transition:\n opacity .3s var(--n-bezier),\n stroke .3s var(--n-bezier),\n stroke-dasharray .3s var(--n-bezier);\n ",[qr("empty",{opacity:0})]),Vr("progress-graph-circle-rail","\n transition: stroke .3s var(--n-bezier);\n overflow: hidden;\n stroke: var(--n-rail-color);\n ")]),Vr("progress-graph-line",[qr("indicator-inside",[Vr("progress-graph-line-rail","\n height: 16px;\n line-height: 16px;\n border-radius: 10px;\n ",[Vr("progress-graph-line-fill","\n height: inherit;\n border-radius: 10px;\n "),Vr("progress-graph-line-indicator","\n background: #0000;\n white-space: nowrap;\n text-align: right;\n margin-left: 14px;\n margin-right: 14px;\n height: inherit;\n font-size: 12px;\n color: var(--n-text-color-line-inner);\n transition: color .3s var(--n-bezier);\n ")])]),qr("indicator-inside-label","\n height: 16px;\n display: flex;\n align-items: center;\n ",[Vr("progress-graph-line-rail","\n flex: 1;\n transition: background-color .3s var(--n-bezier);\n "),Vr("progress-graph-line-indicator","\n background: var(--n-fill-color);\n font-size: 12px;\n transform: translateZ(0);\n display: flex;\n vertical-align: middle;\n height: 16px;\n line-height: 16px;\n padding: 0 10px;\n border-radius: 10px;\n position: absolute;\n white-space: nowrap;\n color: var(--n-text-color-line-inner);\n transition:\n right .2s var(--n-bezier),\n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n ")]),Vr("progress-graph-line-rail","\n position: relative;\n overflow: hidden;\n height: var(--n-rail-height);\n border-radius: 5px;\n background-color: var(--n-rail-color);\n transition: background-color .3s var(--n-bezier);\n ",[Vr("progress-graph-line-fill","\n background: var(--n-fill-color);\n position: relative;\n border-radius: 5px;\n height: inherit;\n width: 100%;\n max-width: 0%;\n transition:\n background-color .3s var(--n-bezier),\n max-width .2s var(--n-bezier);\n ",[qr("processing",[Xr("&::after",'\n content: "";\n background-image: var(--n-line-bg-processing);\n animation: progress-processing-animation 2s var(--n-bezier) infinite;\n ')])])])])])]),Xr("@keyframes progress-processing-animation","\n 0% {\n position: absolute;\n left: 0;\n top: 0;\n bottom: 0;\n right: 100%;\n opacity: 1;\n }\n 66% {\n position: absolute;\n left: 0;\n top: 0;\n bottom: 0;\n right: 0;\n opacity: 0;\n }\n 100% {\n position: absolute;\n left: 0;\n top: 0;\n bottom: 0;\n right: 0;\n opacity: 0;\n }\n ")]),on={success:N(ui,null),error:N(ci,null),warning:N(hi,null),info:N(li,null)},cn=c({name:"ProgressLine",props:{clsPrefix:{type:String,required:!0},percentage:{type:Number,default:0},railColor:String,railStyle:[String,Object],fillColor:String,status:{type:String,required:!0},indicatorPlacement:{type:String,required:!0},indicatorTextColor:String,unit:{type:String,default:"%"},processing:{type:Boolean,required:!0},showIndicator:{type:Boolean,required:!0},height:[String,Number],railBorderRadius:[String,Number],fillBorderRadius:[String,Number]},setup:function(e,t){var r=t.slots,i=l((function(){return wr(e.height)})),n=l((function(){return void 0!==e.railBorderRadius?wr(e.railBorderRadius):void 0!==e.height?wr(e.height,{c:.5}):""})),a=l((function(){return void 0!==e.fillBorderRadius?wr(e.fillBorderRadius):void 0!==e.railBorderRadius?wr(e.railBorderRadius):void 0!==e.height?wr(e.height,{c:.5}):""}));return function(){var t=e.indicatorPlacement,s=e.railColor,o=e.railStyle,c=e.percentage,l=e.unit,u=e.indicatorTextColor,h=e.status,f=e.showIndicator,d=e.fillColor,p=e.processing,m=e.clsPrefix;return N("div",{class:"".concat(m,"-progress-content"),role:"none"},N("div",{class:"".concat(m,"-progress-graph"),"aria-hidden":!0},N("div",{class:["".concat(m,"-progress-graph-line"),g({},"".concat(m,"-progress-graph-line--indicator-").concat(t),!0)]},N("div",{class:"".concat(m,"-progress-graph-line-rail"),style:[{backgroundColor:s,height:i.value,borderRadius:n.value},o]},N("div",{class:["".concat(m,"-progress-graph-line-fill"),p&&"".concat(m,"-progress-graph-line-fill--processing")],style:{maxWidth:"".concat(e.percentage,"%"),backgroundColor:d,height:i.value,lineHeight:i.value,borderRadius:a.value}},"inside"===t?N("div",{class:"".concat(m,"-progress-graph-line-indicator"),style:{color:u}},c,l):null)))),f&&"outside"===t?N("div",null,r.default?N("div",{class:"".concat(m,"-progress-custom-content"),style:{color:u},role:"none"},r.default()):"default"===h?N("div",{role:"none",class:"".concat(m,"-progress-icon ").concat(m,"-progress-icon--as-text"),style:{color:u}},c,l):N("div",{class:"".concat(m,"-progress-icon"),"aria-hidden":!0},N(di,{clsPrefix:m},{default:function(){return on[h]}}))):null)}}}),ln={success:N(ui,null),error:N(ci,null),warning:N(hi,null),info:N(li,null)},un=c({name:"ProgressCircle",props:{clsPrefix:{type:String,required:!0},status:{type:String,required:!0},strokeWidth:{type:Number,required:!0},fillColor:String,railColor:String,railStyle:[String,Object],percentage:{type:Number,default:0},offsetDegree:{type:Number,default:0},showIndicator:{type:Boolean,required:!0},indicatorTextColor:String,unit:String,viewBoxWidth:{type:Number,required:!0},gapDegree:{type:Number,required:!0},gapOffsetDegree:{type:Number,default:0}},setup:function(e,t){var r=t.slots;function i(t,r,i){var n=e.gapDegree,a=e.viewBoxWidth,s=50,o=50+e.strokeWidth/2,c="M ".concat(o,",").concat(o," m ").concat(0,",").concat(50,"\n      a ").concat(s,",").concat(s," 0 1 1 ").concat(0,",").concat(-100,"\n      a ").concat(s,",").concat(s," 0 1 1 ").concat(-0,",").concat(100),l=2*Math.PI*s;return{pathString:c,pathStyle:{stroke:i,strokeDasharray:"".concat(t/100*(l-n),"px ").concat(8*a,"px"),strokeDashoffset:"-".concat(n/2,"px"),transformOrigin:r?"center":void 0,transform:r?"rotate(".concat(r,"deg)"):void 0}}}return function(){var t=e.fillColor,n=e.railColor,a=e.strokeWidth,s=e.offsetDegree,o=e.status,c=e.percentage,l=e.showIndicator,u=e.indicatorTextColor,h=e.unit,f=e.gapOffsetDegree,d=e.clsPrefix,p=i(100,0,n),m=p.pathString,b=p.pathStyle,v=i(c,s,t),g=v.pathString,y=v.pathStyle,_=100+a;return N("div",{class:"".concat(d,"-progress-content"),role:"none"},N("div",{class:"".concat(d,"-progress-graph"),"aria-hidden":!0},N("div",{class:"".concat(d,"-progress-graph-circle"),style:{transform:f?"rotate(".concat(f,"deg)"):void 0}},N("svg",{viewBox:"0 0 ".concat(_," ").concat(_)},N("g",null,N("path",{class:"".concat(d,"-progress-graph-circle-rail"),d:m,"stroke-width":a,"stroke-linecap":"round",fill:"none",style:b})),N("g",null,N("path",{class:["".concat(d,"-progress-graph-circle-fill"),0===c&&"".concat(d,"-progress-graph-circle-fill--empty")],d:g,"stroke-width":a,"stroke-linecap":"round",fill:"none",style:y}))))),l?N("div",null,r.default?N("div",{class:"".concat(d,"-progress-custom-content"),role:"none"},r.default()):"default"!==o?N("div",{class:"".concat(d,"-progress-icon"),"aria-hidden":!0},N(di,{clsPrefix:d},{default:function(){return ln[o]}})):N("div",{class:"".concat(d,"-progress-text"),style:{color:u},role:"none"},N("span",{class:"".concat(d,"-progress-text__percentage")},c),N("span",{class:"".concat(d,"-progress-text__unit")},h))):null)}}});function hn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return"m ".concat(r/2," ").concat(r/2-e," a ").concat(e," ").concat(e," 0 1 1 0 ").concat(2*e," a ").concat(e," ").concat(e," 0 1 1 0 -").concat(2*e)}var fn=c({name:"ProgressMultipleCircle",props:{clsPrefix:{type:String,required:!0},viewBoxWidth:{type:Number,required:!0},percentage:{type:Array,default:[0]},strokeWidth:{type:Number,required:!0},circleGap:{type:Number,required:!0},showIndicator:{type:Boolean,required:!0},fillColor:{type:Array,default:function(){return[]}},railColor:{type:Array,default:function(){return[]}},railStyle:{type:Array,default:function(){return[]}}},setup:function(e,t){var r=t.slots,i=l((function(){var t=e.percentage.map((function(t,r){return"".concat(Math.PI*t/100*(e.viewBoxWidth/2-e.strokeWidth/2*(1+2*r)-e.circleGap*r)*2,", ").concat(8*e.viewBoxWidth)}));return t}));return function(){var t=e.viewBoxWidth,n=e.strokeWidth,a=e.circleGap,s=e.showIndicator,o=e.fillColor,c=e.railColor,l=e.railStyle,u=e.percentage,h=e.clsPrefix;return N("div",{class:"".concat(h,"-progress-content"),role:"none"},N("div",{class:"".concat(h,"-progress-graph"),"aria-hidden":!0},N("div",{class:"".concat(h,"-progress-graph-circle")},N("svg",{viewBox:"0 0 ".concat(t," ").concat(t)},u.map((function(e,r){return N("g",{key:r},N("path",{class:"".concat(h,"-progress-graph-circle-rail"),d:hn(t/2-n/2*(1+2*r)-a*r,n,t),"stroke-width":n,"stroke-linecap":"round",fill:"none",style:[{strokeDashoffset:0,stroke:c[r]},l[r]]}),N("path",{class:["".concat(h,"-progress-graph-circle-fill"),0===e&&"".concat(h,"-progress-graph-circle-fill--empty")],d:hn(t/2-n/2*(1+2*r)-a*r,n,t),"stroke-width":n,"stroke-linecap":"round",fill:"none",style:{strokeDasharray:i.value[r],strokeDashoffset:0,stroke:o[r]}}))}))))),s&&r.default?N("div",null,N("div",{class:"".concat(h,"-progress-text")},r.default())):null)}}}),dn=Object.assign(Object.assign({},ai.props),{processing:Boolean,type:{type:String,default:"line"},gapDegree:Number,gapOffsetDegree:Number,status:{type:String,default:"default"},railColor:[String,Array],railStyle:[String,Array],color:[String,Array],viewBoxWidth:{type:Number,default:100},strokeWidth:{type:Number,default:7},percentage:[Number,Array],unit:{type:String,default:"%"},showIndicator:{type:Boolean,default:!0},indicatorPosition:{type:String,default:"outside"},indicatorPlacement:{type:String,default:"outside"},indicatorTextColor:String,circleGap:{type:Number,default:1},height:Number,borderRadius:[String,Number],fillBorderRadius:[String,Number],offsetDegree:Number}),pn=c({name:"Progress",props:dn,setup:function(e){var t=l((function(){return e.indicatorPlacement||e.indicatorPosition})),r=l((function(){return e.gapDegree||0===e.gapDegree?e.gapDegree:"dashboard"===e.type?75:void 0})),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{defaultBordered:!0},r=R(ii,null);return{inlineThemeDisabled:null==r?void 0:r.inlineThemeDisabled,mergedRtlRef:null==r?void 0:r.mergedRtlRef,mergedComponentPropsRef:null==r?void 0:r.mergedComponentPropsRef,mergedBreakpointsRef:null==r?void 0:r.mergedBreakpointsRef,mergedBorderedRef:l((function(){var i,n,a=e.bordered;return void 0!==a?a:null===(n=null!==(i=null==r?void 0:r.mergedBorderedRef.value)&&void 0!==i?i:t.defaultBordered)||void 0===n||n})),mergedClsPrefixRef:l((function(){return(null==r?void 0:r.mergedClsPrefixRef.value)||"n"})),namespaceRef:l((function(){return null==r?void 0:r.mergedNamespaceRef.value}))}}(e),n=i.mergedClsPrefixRef,a=i.inlineThemeDisabled,s=ai("Progress","-progress",sn,an,e,n),o=l((function(){var t=e.status,r=s.value,i=r.common.cubicBezierEaseInOut,n=r.self,a=n.fontSize,o=n.fontSizeCircle,c=n.railColor,l=n.railHeight,u=n.iconSizeCircle,h=n.iconSizeLine,f=n.textColorCircle,d=n.textColorLineInner,p=n.textColorLineOuter,m=n.lineBgProcessing,b=n.fontWeightCircle,v=n[Hr("iconColor",t)];return{"--n-bezier":i,"--n-fill-color":n[Hr("fillColor",t)],"--n-font-size":a,"--n-font-size-circle":o,"--n-font-weight-circle":b,"--n-icon-color":v,"--n-icon-size-circle":u,"--n-icon-size-line":h,"--n-line-bg-processing":m,"--n-rail-color":c,"--n-rail-height":l,"--n-text-color-circle":f,"--n-text-color-line-inner":d,"--n-text-color-line-outer":p}})),c=a?si("progress",l((function(){return e.status[0]})),o,e):void 0;return{mergedClsPrefix:n,mergedIndicatorPlacement:t,gapDeg:r,cssVars:a?void 0:o,themeClass:null==c?void 0:c.themeClass,onRender:null==c?void 0:c.onRender}},render:function(){var e=this.type,t=this.cssVars,r=this.indicatorTextColor,i=this.showIndicator,n=this.status,a=this.railColor,s=this.railStyle,o=this.color,c=this.percentage,l=this.viewBoxWidth,u=this.strokeWidth,h=this.mergedIndicatorPlacement,f=this.unit,d=this.borderRadius,p=this.fillBorderRadius,m=this.height,b=this.processing,v=this.circleGap,g=this.mergedClsPrefix,y=this.gapDeg,_=this.gapOffsetDegree,w=this.themeClass,x=this.$slots,k=this.onRender;return null==k||k(),N("div",{class:[w,"".concat(g,"-progress"),"".concat(g,"-progress--").concat(e),"".concat(g,"-progress--").concat(n)],style:t,"aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":c,role:"circle"===e||"line"===e||"dashboard"===e?"progressbar":"none"},"circle"===e||"dashboard"===e?N(un,{clsPrefix:g,status:n,showIndicator:i,indicatorTextColor:r,railColor:a,fillColor:o,railStyle:s,offsetDegree:this.offsetDegree,percentage:c,viewBoxWidth:l,strokeWidth:u,gapDegree:void 0===y?"dashboard"===e?75:0:y,gapOffsetDegree:_,unit:f},x):"line"===e?N(cn,{clsPrefix:g,status:n,showIndicator:i,indicatorTextColor:r,railColor:a,fillColor:o,railStyle:s,percentage:c,processing:b,indicatorPlacement:h,unit:f,fillBorderRadius:p,railBorderRadius:d,height:m},x):"multiple-circle"===e?N(fn,{clsPrefix:g,strokeWidth:u,railColor:a,fillColor:o,railStyle:s,viewBoxWidth:l,percentage:c,showIndicator:i,circleGap:v},x):null)}}),mn={class:"process-box"},bn=c({__name:"ProcessProgress",props:{duration:null},setup:function(e,t){var r=t.expose,i=e,n=le(),a=ue(),s=B(0),o=null,c=l((function(){return 100/i.duration})),u=function(){o=setInterval((function(){s.value=parseFloat((s.value+c.value).toFixed(2)),o&&s.value>=99&&(s.value=99,o&&clearInterval(o))}),1e3)},h=function(){var e=v(m().mark((function e(t){var r;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.device.controlProcess(t);case 2:if(200!==(r=e.sent).status){e.next=10;break}if(0!==r.data.code){e.next=9;break}return e.abrupt("return",Promise.resolve(r.data));case 9:return e.abrupt("return",Promise.reject());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return H((function(){return n.socketData.control.action}),(function(e){e===Se.FINISH?s.value=100:e===Se.START?u():e===Se.STOP&&o&&clearInterval(o)})),r({go:function(e,t){h(e).then((function(){u(),t&&t()}))},pause:function(e,t){h(e).then((function(){o&&clearInterval(o),t&&t()}))}}),G((function(){n.socketData.control.action===Se.FINISH&&(s.value=100)})),W((function(){o&&clearInterval(o)})),u(),function(e,t){return P(),d("div",mn,[k(b(pn),{type:"line",percentage:s.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])])}}}),vn=L(bn,[["__scopeId","data-v-86a943ce"]]),gn={class:"page-title"},yn={ref:"gcodeViewContainer",class:"gcodeViewContainer"},_n={id:"gcodeView",ref:"gcodeViewBox",class:"gcodeViewBox"},wn={class:"bottom-infos"},xn={key:0,style:{"text-align":"center"}},kn={class:"times"},Sn={key:1,class:"standby-status-content"},Cn=C("img",{src:Pe,class:"equ-img",alt:"",draggable:"false"},null,-1),Un={class:"words"},En={class:"working-status",style:{width:"80%"}},Tn={class:"working-status"},Mn={key:2,class:"finished-box"},On=C("img",{src:$t,alt:"",class:"finished-image",draggable:"false"},null,-1),Pn={class:"bottom-remarks"},An={class:"title"},In={class:"content"},Ln=c({__name:"ProcessPop",props:{duration:null,showModal:{type:Boolean},processStatus:null,tip:null},emits:["finish","handleSend","close","update:showModal"],setup:function(e,t){var r=t.emit,i=e,n=l({get:function(){return i.showModal},set:function(e){r("update:showModal",e)}}),a=function(){r("finish")},s=function(){r("handleSend")},o=function(){n.value=!1,Y((function(){r("close")}))};return function(t,r){var i=O("van-button"),c=O("van-popup");return P(),d("div",null,[k(c,{show:b(n),"onUpdate:show":r[0]||(r[0]=function(e){return E(n)?n.value=e:null}),position:"top",class:"start-process-pop",closeable:"",onClose:o},{default:S((function(){return[C("span",gn,U(t.$t("editor.preparePro")),1),X(C("div",yn,[C("canvas",_n,null,512)],512),[[V,"standby"!==e.processStatus]]),C("div",wn,["beforeSend"===e.processStatus?(P(),d("div",xn,[C("div",kn,[C("span",null,U(e.tip),1)]),k(i,{color:"var(--backgroundColorMain)",round:"",class:"send-btn",onClick:s},{default:S((function(){return[I(U(t.$t("editor.send")),1)]})),_:1})])):M("",!0),"standby"===e.processStatus?(P(),d("div",Sn,[Cn,C("span",Un,U(t.$t("editor.pressStart")),1)])):M("",!0),X(C("div",En,[C("span",null,U(t.$t("editor.processAccuracy")),1),k(vn,{ref:"progress",duration:e.duration,onFinish:a},null,8,["duration"])],512),[[V,"working"===e.processStatus]]),X(C("div",Tn,[C("span",null,U(t.$t("editor.suspend")),1),k(vn,{ref:"progress",duration:e.duration},null,8,["duration"])],512),[[V,"suspend"===e.processStatus]]),"finished"===e.processStatus?(P(),d("div",Mn,[On,k(i,{color:"var(--backgroundColorMain)",round:"",class:"complate-btn",onClick:o},{default:S((function(){return[I(U(t.$t("editor.proFinished")),1)]})),_:1})])):M("",!0),C("div",Pn,[C("span",An,U(t.$t("editor.remark")),1),C("span",In,U(t.$t("editor.remarkContent")),1)])])]})),_:1},8,["show"])])}}}),jn=function(e){return q("data-v-50a2862e"),e=e(),Z(),e},Rn={class:"shape-pop-content"},Dn=[jn((function(){return C("div",{class:"triangle"},null,-1)}))],Bn=[jn((function(){return C("div",{class:"round"},null,-1)}))],Fn=[jn((function(){return C("div",{class:"square"},null,-1)}))],Nn=c({__name:"ShapeChoosePop",props:{isShowShapePop:{type:Boolean}},emits:["handleToolClick","update:isShowShapePop"],setup:function(e,t){var r=t.emit,i=e,n=l({get:function(){return i.isShowShapePop},set:function(e){r("update:isShowShapePop",e)}}),a=function(e){r("handleToolClick",e)};return function(e,t){var r=O("van-col"),i=O("van-row");return P(),d("div",null,[k(Ae,{show:b(n),"onUpdate:show":t[3]||(t[3]=function(e){return E(n)?n.value=e:null}),title:e.$t("editor.shape")},{default:S((function(){return[C("div",Rn,[k(i,{gutter:12},{default:S((function(){return[k(r,{span:8},{default:S((function(){return[C("div",{class:"shape-box",onClick:t[0]||(t[0]=function(e){return a(b(Ce).TRIANGLE)})},Dn)]})),_:1}),k(r,{span:8},{default:S((function(){return[C("div",{class:"shape-box",onClick:t[1]||(t[1]=function(e){return a(b(Ce).CIRCLE)})},Bn)]})),_:1}),k(r,{span:8},{default:S((function(){return[C("div",{class:"shape-box",onClick:t[2]||(t[2]=function(e){return a(b(Ce).RECT)})},Fn)]})),_:1})]})),_:1})])]})),_:1},8,["show","title"])])}}}),zn=L(Nn,[["__scopeId","data-v-50a2862e"]]),Hn={},Gn={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={verbose:!1}}(Gn);var Wn={},Yn={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e){var t,r={};return e.forEach((function(e){var i=e[0],n=e[1];switch(n){case"$MEASUREMENT":t="measurement";break;case"$INSUNITS":t="insUnits";break;case"$EXTMIN":r.extMin={},t="extMin";break;case"$EXTMAX":r.extMax={},t="extMax";break;case"$DIMASZ":r.dimArrowSize={},t="dimArrowSize";break;default:switch(t){case"extMin":case"extMax":switch(i){case 10:r[t].x=n;break;case 20:r[t].y=n;break;case 30:r[t].z=n,t=void 0}break;case"measurement":case"insUnits":if(70===i)r[t]=n,t=void 0;break;case"dimArrowSize":if(40===i)r[t]=n,t=void 0}}})),r}}(Yn);var Xn={},Vn={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=Gn)&&t.__esModule?t:{default:t};var i={info:function(){r.default.verbose&&console.info.apply(void 0,arguments)},warn:function(){r.default.verbose&&console.warn.apply(void 0,arguments)},error:function(){console.error.apply(void 0,arguments)}};e.default=i}(Vn),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=Vn)&&t.__esModule?t:{default:t};var i=function(e){var t=null,r=null;return e.reduce((function(e,i){var n=i[0],a=i[1];switch(n){case 2:e.name=a;break;case 3:e.description=a;break;case 70:e.flag=a;break;case 72:e.alignment=a;break;case 73:e.elementCount=parseInt(a);break;case 40:e.patternLength=a;break;case 49:(t=Object.create({scales:[],offset:[]})).length=a,e.pattern.push(t);break;case 74:t.shape=a;break;case 75:t.shapeNumber=a;break;case 340:t.styleHandle=a;break;case 46:t.scales.push(a);break;case 50:t.rotation=a;break;case 44:r=Object.create({x:a,y:0}),t.offset.push(r);break;case 45:r.y=a;break;case 9:t.text=a}return e}),{type:"LTYPE",pattern:[]})},n=function(e){return e.reduce((function(e,t){var r=t[0],i=t[1];switch(r){case 2:e.name=i;break;case 6:e.lineTypeName=i;break;case 62:e.colorNumber=i;break;case 70:e.flags=i;break;case 290:e.plot=0!==parseInt(i);break;case 370:e.lineWeightEnum=i}return e}),{type:"LAYER"})},a=function(e){return e.reduce((function(e,t){var r=t[0],i=t[1];switch(r){case 2:e.name=i;break;case 6:e.lineTypeName=i;break;case 40:e.fixedTextHeight=i;break;case 41:e.widthFactor=i;break;case 50:e.obliqueAngle=i;break;case 71:e.flags=i;break;case 42:e.lastHeightUsed=i;break;case 3:e.primaryFontFileName=i;break;case 4:e.bigFontFileName=i}return e}),{type:"STYLE"})},s=function(e){return e.reduce((function(e,t){var r=t[0],i=t[1];switch(r){case 2:e.name=i;break;case 5:e.handle=i;break;case 70:e.flags=i;break;case 10:e.lowerLeft.x=parseFloat(i);break;case 20:e.lowerLeft.y=parseFloat(i);break;case 11:e.upperRight.x=parseFloat(i);break;case 21:e.upperRight.y=parseFloat(i);break;case 12:e.center.x=parseFloat(i);break;case 22:e.center.y=parseFloat(i);break;case 14:e.snapSpacing.x=parseFloat(i);break;case 24:e.snapSpacing.y=parseFloat(i);break;case 15:e.gridSpacing.x=parseFloat(i);break;case 25:e.gridSpacing.y=parseFloat(i);break;case 16:e.direction.x=parseFloat(i);break;case 26:e.direction.y=parseFloat(i);break;case 36:e.direction.z=parseFloat(i);break;case 17:e.target.x=parseFloat(i);break;case 27:e.target.y=parseFloat(i);break;case 37:e.target.z=parseFloat(i);break;case 45:e.height=parseFloat(i);break;case 50:e.snapAngle=parseFloat(i);break;case 51:e.angle=parseFloat(i);break;case 110:e.x=parseFloat(i);break;case 120:e.y=parseFloat(i);break;case 130:e.z=parseFloat(i);break;case 111:case 112:e.xAxisX=parseFloat(i);break;case 121:case 122:e.xAxisY=parseFloat(i);break;case 131:case 132:e.xAxisZ=parseFloat(i);break;case 146:e.elevation=parseFloat(i)}return e}),{type:"VPORT",center:{},lowerLeft:{},upperRight:{},snap:{},snapSpacing:{},gridSpacing:{},direction:{},target:{}})},o=function(e,t,i){var n,a=[];return e.forEach((function(e){var r=e[0],i=e[1];0!==r&&2!==r||i!==t?n.push(e):(n=[],a.push(n))})),a.reduce((function(e,t){var n=i(t);return n.name?e[n.name]=n:r.default.warn("table row without name:",n),e}),{})};e.default=function(e){var t,r=[];e.forEach((function(e){var i=e[1];"TABLE"===i?(t=[],r.push(t)):"ENDTAB"===i?r.push(t):t.push(e)}));var c=[],l=[],u=[],h=[];return r.forEach((function(e){"STYLE"===e[0][1]?c=e:"LTYPE"===e[0][1]?h=e:"LAYER"===e[0][1]?l=e:"VPORT"===e[0][1]&&(u=e)})),{layers:o(l,"LAYER",n),styles:o(c,"STYLE",a),vports:o(u,"VPORT",s),ltypes:o(h,"LTYPE",i)}}}(Xn);var qn={},Zn={},Kn={},Jn={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e,t){switch(e){case 5:return{handle:t};case 6:return{lineTypeName:t};case 8:return{layer:t};case 48:return{lineTypeScale:t};case 60:return{visible:0===t};case 62:return{colorNumber:t};case 67:return 0===t?{}:{paperSpace:t};case 68:return{viewportOn:t};case 69:return{viewport:t};case 210:return{extrusionX:t};case 220:return{extrusionY:t};case 230:return{extrusionZ:t};case 410:return{layout:t};default:return{}}}}(Jn),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="POINT";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 39:e.thickness=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i})};e.process=n;var a={TYPE:i,process:n};e.default=a}(Kn);var Qn={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="LINE";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 10:e.start.x=n;break;case 20:e.start.y=n;break;case 30:e.start.z=n;break;case 39:e.thickness=n;break;case 11:e.end.x=n;break;case 21:e.end.y=n;break;case 31:e.end.z=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i,start:{},end:{}})};e.process=n;var a={TYPE:i,process:n};e.default=a}(Qn);var $n={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="LWPOLYLINE";e.TYPE=i;var n=function(e){var t;return e.reduce((function(e,i){var n=i[0],a=i[1];switch(n){case 70:e.closed=1==(1&a);break;case 10:t={x:a,y:0},e.vertices.push(t);break;case 20:t.y=a;break;case 39:e.thickness=a;break;case 42:t.bulge=a;break;default:Object.assign(e,(0,r.default)(n,a))}return e}),{type:i,vertices:[]})};e.process=n;var a={TYPE:i,process:n};e.default=a}($n);var ea={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="POLYLINE";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 70:e.closed=1==(1&n),e.polygonMesh=16==(16&n),e.polyfaceMesh=64==(64&n);break;case 39:e.thickness=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i,vertices:[]})};e.process=n;var a={TYPE:i,process:n};e.default=a}(ea);var ta={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t="VERTEX";e.TYPE=t;var r=function(e){return e.reduce((function(e,t){var r=t[0],i=t[1];switch(r){case 10:e.x=i;break;case 20:e.y=i;break;case 30:e.z=i;break;case 42:e.bulge=i}return e}),{})};e.process=r;var i={TYPE:t,process:r};e.default=i}(ta);var ra={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="CIRCLE";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 40:e.r=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i})};e.process=n;var a={TYPE:i,process:n};e.default=a}(ra);var ia={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="ARC";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 39:e.thickness=n;break;case 40:e.r=n;break;case 50:e.startAngle=n/180*Math.PI;break;case 51:e.endAngle=n/180*Math.PI;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i})};e.process=n;var a={TYPE:i,process:n};e.default=a}(ia);var na={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="ELLIPSE";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 10:e.x=n;break;case 11:e.majorX=n;break;case 20:e.y=n;break;case 21:e.majorY=n;break;case 30:e.z=n;break;case 31:e.majorZ=n;break;case 40:e.axisRatio=n;break;case 41:e.startAngle=n;break;case 42:e.endAngle=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i})};e.process=n;var a={TYPE:i,process:n};e.default=a}(na);var aa={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="SPLINE";e.TYPE=i;var n=function(e){var t;return e.reduce((function(e,i){var n=i[0],a=i[1];switch(n){case 10:t={x:a,y:0},e.controlPoints.push(t);break;case 20:t.y=a;break;case 30:t.z=a;break;case 40:e.knots.push(a);break;case 41:e.weights||(e.weights=[]),e.weights.push(a);break;case 42:e.knotTolerance=a;break;case 43:e.controlPointTolerance=a;break;case 44:e.fitTolerance=a;break;case 70:e.flag=a,e.closed=1==(1&a);break;case 71:e.degree=a;break;case 72:e.numberOfKnots=a;break;case 73:e.numberOfControlPoints=a;break;case 74:e.numberOfFitPoints=a;break;default:Object.assign(e,(0,r.default)(n,a))}return e}),{type:i,controlPoints:[],knots:[]})};e.process=n;var a={TYPE:i,process:n};e.default=a}(aa);var sa={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="SOLID";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 10:e.corners[0].x=n;break;case 20:e.corners[0].y=n;break;case 30:e.corners[0].z=n;break;case 11:e.corners[1].x=n;break;case 21:e.corners[1].y=n;break;case 31:e.corners[1].z=n;break;case 12:e.corners[2].x=n;break;case 22:e.corners[2].y=n;break;case 32:e.corners[2].z=n;break;case 13:e.corners[3].x=n;break;case 23:e.corners[3].y=n;break;case 33:e.corners[3].z=n;break;case 39:e.thickness=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i,corners:[{},{},{},{}]})};e.process=n;var a={TYPE:i,process:n};e.default=a}(sa);var oa={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="HATCH";e.TYPE=i;var n="IDLE",a={},s=0,o=!1,c=null,l={references:[],entities:[]},u=null,h=function(e){return e.reduce((function(e,t){var i=t[0],h=t[1];switch(i){case 100:n="IDLE";break;case 2:e.patternName=h;break;case 10:"IDLE"===n?e.elevation.x=parseFloat(h):"POLYLINE"===n?(u=Object.create({x:parseFloat(h),y:0,bulge:0}),l.entities[0].points.push(u)):"SEED"===n?(c||(c={x:0,y:0},e.seeds.seeds.push(c)),c.x=parseFloat(h)):d(i,s,parseFloat(h));break;case 20:"IDLE"===n?e.elevation.y=parseFloat(h):"POLYLINE"===n?u.y=parseFloat(h):"SEED"===n?(c.y=parseFloat(h),c=null):d(i,s,parseFloat(h));break;case 30:e.elevation.z=parseFloat(h);break;case 63:e.fillColor=h;break;case 70:e.fillType=1===parseFloat(h)?"SOLID":"PATTERN";break;case 210:e.extrusionDir.x=parseFloat(h);break;case 220:e.extrusionDir.y=parseFloat(h);break;case 230:e.extrusionDir.z=parseFloat(h);break;case 91:e.boundary.count=parseFloat(h);break;case 92:if(l={references:[],entities:[]},e.boundary.loops.push(l),l.type=parseFloat(h),o=2==(2&l.type)){l.entities.push({type:"POLYLINE",points:[]}),n="POLYLINE"}break;case 93:"IDLE"===n&&(n="ENT"),l.count=parseFloat(h);break;case 11:case 21:case 40:case 50:case 51:case 74:case 94:case 95:case 96:d(i,s,parseFloat(h));break;case 42:o?u.bulge=parseFloat(h):d(i,s,parseFloat(h));break;case 72:s=parseFloat(h),l[o?"hasBulge":"edgeType"]=s,o||(a=function(e){if(o)return{};switch(e){case 1:return{type:"LINE",start:{x:0,y:0},end:{x:0,y:0}};case 2:return{type:"ARC",center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,counterClockWise:!1};case 3:return{type:"ELLIPSE",center:{x:0,y:0},startAngle:0,endAngle:0,counterClockWise:!1,major:{x:0,y:0},minor:0};case 4:return{type:"SPLINE",degree:0,rational:0,periodic:0,knots:{count:0,knots:[]},controlPoints:{count:0,point:{x:0,y:0}},weights:1}}return{}}(s),l.entities.push(a));break;case 73:"IDLE"===n||o?l.entities[0].closed=h:d(i,s,parseFloat(h));break;case 75:n="IDLE",e.style=parseFloat(h);break;case 76:e.hatchType=parseFloat(h);break;case 97:n="IDLE",o=!1,l.sourceObjects=parseFloat(h);break;case 98:n="SEED",e.seeds.count=parseFloat(h);break;case 52:e.shadowPatternAngle=parseFloat(h);break;case 41:e.spacing=parseFloat(h);break;case 77:e.double=1===parseFloat(h);break;case 78:e.pattern.lineCount=parseFloat(h);break;case 53:e.pattern.angle=parseFloat(h);break;case 43:e.pattern.x=parseFloat(h);break;case 44:e.pattern.y=parseFloat(h);break;case 45:e.pattern.offsetX=parseFloat(h);break;case 46:e.pattern.offsetY=parseFloat(h);break;case 79:e.pattern.dashCount=parseFloat(h);break;case 49:e.pattern.length.push(h);break;case 330:l.references.push(h);break;case 450:e.solidOrGradient=0===parseFloat(h)?"SOLID":"GRADIENT";break;case 453:e.color.count=parseFloat(h);break;case 460:e.color.rotation=h;break;case 461:e.color.gradient=h;break;case 462:e.color.tint=h;break;default:Object.assign(e,(0,r.default)(i,h))}return e}),{type:i,elevation:{},extrusionDir:{x:0,y:0,z:1},pattern:{length:[]},boundary:{loops:[]},seeds:{count:0,seeds:[]},color:{}})};e.process=h;var f={TYPE:i,process:h};function d(e,t,r){switch(e){case 10:switch(t){case 1:a.start.x=r;break;case 2:case 3:a.center.x=r;break;case 4:a.controlPoints.point.x=r}break;case 20:switch(t){case 1:a.start.y=r;break;case 2:case 3:a.center.y=r;break;case 4:a.controlPoints.point.y=r}break;case 11:switch(t){case 1:a.end.x=r;break;case 3:a.major.x=r}break;case 21:switch(t){case 1:a.end.y=r;break;case 3:a.major.y=r}break;case 40:switch(t){case 2:a.radius=r;break;case 3:a.minor=r;break;case 4:a.knots.knots.push(r)}break;case 42:if(4===t)a.weights=r;break;case 50:switch(t){case 2:case 3:a.startAngle=r}break;case 51:switch(t){case 2:case 3:a.endAngle=r}break;case 73:switch(t){case 2:case 3:a.counterClockWise=1===parseFloat(r);break;case 4:a.rational=r}break;case 74:if(4===t)a.periodic=r;break;case 94:if(4===t)a.degree=r;break;case 95:if(4===t)a.knots.count=r;break;case 96:if(4===t)a.controlPoints.count=r}}e.default=f}(oa);var ca={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.assign=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="MTEXT";e.TYPE=i;var n={10:"x",20:"y",30:"z",40:"nominalTextHeight",41:"refRectangleWidth",71:"attachmentPoint",72:"drawingDirection",7:"styleName",11:"xAxisX",21:"xAxisY",31:"xAxisZ",42:"horizontalWidth",43:"verticalHeight",73:"lineSpacingStyle",44:"lineSpacingFactor",90:"backgroundFill",420:"bgColorRGB0",421:"bgColorRGB1",422:"bgColorRGB2",423:"bgColorRGB3",424:"bgColorRGB4",425:"bgColorRGB5",426:"bgColorRGB6",427:"bgColorRGB7",428:"bgColorRGB8",429:"bgColorRGB9",430:"bgColorName0",431:"bgColorName1",432:"bgColorName2",433:"bgColorName3",434:"bgColorName4",435:"bgColorName5",436:"bgColorName6",437:"bgColorName7",438:"bgColorName8",439:"bgColorName9",45:"fillBoxStyle",63:"bgFillColor",441:"bgFillTransparency",75:"columnType",76:"columnCount",78:"columnFlowReversed",79:"columnAutoheight",48:"columnWidth",49:"columnGutter",50:"columnHeights"},a=function(e){return e.reduce((function(e,t){var r=t[0],i=t[1];return s(e,r,i),e}),{type:i,string:""})};e.process=a;var s=function(e,t,i){return void 0!==n[t]?e[n[t]]=i:1===t||3===t?e.string+=i:50===t?(e.xAxisX=Math.cos(i),e.xAxisY=Math.sin(i)):Object.assign(e,(0,r.default)(t,i)),e};e.assign=s;var o={TYPE:i,process:a,assign:s};e.default=o}(ca);var la={},ua={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.assign=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="TEXT";e.TYPE=i;var n={1:"string",10:"x",20:"y",30:"z",11:"x2",21:"y2",31:"z2",39:"thickness",40:"textHeight",41:"relScaleX",50:"rotation",51:"obliqueAngle",7:"styleName",71:"mirror",72:"hAlign",73:"vAlign"},a=function(e){return e.reduce((function(e,t){var r=t[0],i=t[1];return s(e,r,i),e}),{type:i,string:""})};e.process=a;var s=function(e,t,i){void 0!==n[t]?e[n[t]]=i:Object.assign(e,(0,r.default)(t,i))};e.assign=s;var o={TYPE:i,process:a,assign:s};e.default=o}(ua),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.assign=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t},i=ca,n=ua;var a="ATTDEF";e.TYPE=a;var s=function(e){return e.reduce((function(e,t){var r=t[0],i=t[1];return o(e,r,i),e}),{type:a,subclassMarker:"AcDbText",thickness:0,scaleX:1,mtext:{},text:{}})};e.process=s;var o=function(e,t,a){switch(t){case 100:e.subclassMarker=a;break;case 1:switch(e.subclassMarker){case"AcDbText":(0,n.assign)(e.text,t,a);break;case"AcDbMText":(0,i.assign)(e.mtext,t,a)}break;case 2:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":e.tag=a;break;case"AcDbXrecord":e.attdefFlag=a}break;case 3:switch(e.subclassMarker){case"AcDbAttributeDefinition":e.prompt=a;break;case"AcDbMText":(0,i.assign)(e.mtext,t,a)}break;case 7:case 41:case 50:case 71:case 72:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,n.assign)(e.text,t,a);break;case"AcDbMText":(0,i.assign)(e.mtext,t,a)}break;case 10:switch(e.subclassMarker){case"AcDbText":(0,n.assign)(e.text,t,a);break;case"AcDbMText":(0,i.assign)(e.mtext,t,a);break;case"AcDbXrecord":e.x=a}break;case 20:switch(e.subclassMarker){case"AcDbText":(0,n.assign)(e.text,t,a);break;case"AcDbMText":(0,i.assign)(e.mtext,t,a);break;case"AcDbXrecord":e.y=a}break;case 30:switch(e.subclassMarker){case"AcDbText":(0,n.assign)(e.text,t,a);break;case"AcDbMText":(0,i.assign)(e.mtext,t,a);break;case"AcDbXrecord":e.z=a}break;case 11:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":e.x2=a;break;case"AcDbMText":(0,i.assign)(e.mtext,t,a)}break;case 21:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":e.y2=a;break;case"AcDbMText":(0,i.assign)(e.mtext,t,a)}break;case 31:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":e.z2=a;break;case"AcDbMText":(0,i.assign)(e.mtext,t,a)}break;case 39:case 51:(0,n.assign)(e.text,t,a);break;case 40:switch(e.subclassMarker){case"AcDbText":(0,n.assign)(e.text,t,a);break;case"AcDbMText":(0,i.assign)(e.mtext,t,a);break;case"AcDbXrecord":e.annotationScale=a}break;case 42:case 43:case 44:case 45:case 48:case 49:case 63:case 75:case 76:case 78:case 79:case 90:case 420:case 421:case 422:case 423:case 424:case 425:case 426:case 427:case 428:case 429:case 430:case 431:case 432:case 433:case 434:case 435:case 436:case 437:case 438:case 439:case 441:(0,i.assign)(e.mtext,t,a);break;case 46:e.mtext.annotationHeight=a;break;case 70:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":e.attributeFlags=a;break;case"AcDbXrecord":void 0===e.mTextFlag?e.mTextFlag=a:void 0===e.isReallyLocked?e.isReallyLocked=a:e.secondaryAttdefCount=a}break;case 73:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":e.fieldLength=a;break;case"AcDbMText":(0,i.assign)(e.mtext,t,a)}break;case 74:(0,n.assign)(e.text,73,a);break;case 210:case 220:case 230:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,n.assign)(e.mtext,t,a);break;case"AcDbMText":(0,i.assign)(e.mtext,t,a)}break;case 280:switch(e.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":e.lock=a;break;case"AcDbXrecord":e.clone=!0}break;case 340:e.attdefHandle=a;break;default:Object.assign(e,(0,r.default)(t,a))}};e.assign=o;var c={TYPE:a,process:s,assign:o};e.default=c}(la);var ha={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t=la,r="ATTRIB";e.TYPE=r;var i=function(e){return e.reduce((function(e,r){var i=r[0],n=r[1];return(0,t.assign)(e,i,n),e}),{type:r,subclassMarker:"AcDbText",thickness:0,scaleX:1,mtext:{},text:{}})};e.process=i;var n={TYPE:r,process:i};e.default=n}(ha);var fa={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="INSERT";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 2:e.block=n;break;case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 41:e.scaleX=n;break;case 42:e.scaleY=n;break;case 43:e.scaleZ=n;break;case 44:e.columnSpacing=n;break;case 45:e.rowSpacing=n;break;case 50:e.rotation=n;break;case 70:e.columnCount=n;break;case 71:e.rowCount=n;break;case 210:e.extrusionX=n;break;case 220:e.extrusionY=n;break;case 230:e.extrusionZ=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i})};e.process=n;var a={TYPE:i,process:n};e.default=a}(fa);var da={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="3DFACE";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 10:e.vertices[0].x=n;break;case 20:e.vertices[0].y=n;break;case 30:e.vertices[0].z=n;break;case 11:e.vertices[1].x=n;break;case 21:e.vertices[1].y=n;break;case 31:e.vertices[1].z=n;break;case 12:e.vertices[2].x=n;break;case 22:e.vertices[2].y=n;break;case 32:e.vertices[2].z=n;break;case 13:e.vertices[3].x=n;break;case 23:e.vertices[3].y=n;break;case 33:e.vertices[3].z=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i,vertices:[{},{},{},{}]})};e.process=n;var a={TYPE:i,process:n};e.default=a}(da);var pa={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="DIMENSION";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 2:e.block=n;break;case 10:e.start.x=n;break;case 20:e.start.y=n;break;case 30:e.start.z=n;break;case 11:e.textMidpoint.x=n;break;case 21:e.textMidpoint.y=n;break;case 31:e.textMidpoint.z=n;break;case 13:e.measureStart.x=n;break;case 23:e.measureStart.y=n;break;case 33:e.measureStart.z=n;break;case 14:e.measureEnd.x=n;break;case 24:e.measureEnd.y=n;break;case 34:e.measureEnd.z=n;break;case 50:e.rotation=n;break;case 51:e.horizonRotation=n;break;case 52:e.extensionRotation=n;break;case 53:e.textRotation=n;break;case 70:var a=function(e){var t=!1,r=!1,i=!1;if(e>6){var n=e-32,a=e-64,s=e-32-64,o=e-32-128,c=e-32-64-128;n>=0&&n<=6?(t=!0,e=n):a>=0&&a<=6?(r=!0,e=a):s>=0&&s<=6?(t=!0,r=!0,e=s):o>=0&&o<=6?(t=!0,i=!0,e=o):c>=0&&c<=6&&(t=!0,r=!0,i=!0,e=c)}return{dimensionType:e,uniqueBlockReference:t,ordinateType:r,userDefinedLocation:i}}(n);a.ordinateType&&(e.ordinateType=!0),a.uniqueBlockReference&&(e.uniqueBlockReference=!0),a.userDefinedLocation&&(e.userDefinedLocation=!0),e.dimensionType=a.dimensionType;break;case 71:e.attachementPoint=n;break;case 210:e.extrudeDirection=e.extrudeDirection||{},e.extrudeDirection.x=n;break;case 220:e.extrudeDirection=e.extrudeDirection||{},e.extrudeDirection.y=n;break;case 230:e.extrudeDirection=e.extrudeDirection||{},e.extrudeDirection.z=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i,start:{x:0,y:0,z:0},measureStart:{x:0,y:0,z:0},measureEnd:{x:0,y:0,z:0},textMidpoint:{x:0,y:0,z:0},attachementPoint:1,dimensionType:0})};e.process=n;var a={TYPE:i,process:n};e.default=a}(pa);var ma={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.process=e.default=e.TYPE=void 0;var t,r=(t=Jn)&&t.__esModule?t:{default:t};var i="VIEWPORT";e.TYPE=i;var n=function(e){return e.reduce((function(e,t){var i=t[0],n=t[1];switch(i){case 1:e.layout=parseFloat(n);break;case 10:e.center.x=parseFloat(n);break;case 20:e.center.y=parseFloat(n);break;case 30:e.center.z=parseFloat(n);break;case 12:e.centerDCS.x=parseFloat(n);break;case 22:e.centerDCS.y=parseFloat(n);break;case 13:e.snap.x=parseFloat(n);break;case 23:e.snap.y=parseFloat(n);break;case 14:e.snapSpacing.x=parseFloat(n);break;case 24:e.snapSpacing.y=parseFloat(n);break;case 15:e.gridSpacing.x=parseFloat(n);break;case 25:e.gridSpacing.y=parseFloat(n);break;case 16:e.direction.x=parseFloat(n);break;case 26:e.direction.y=parseFloat(n);break;case 36:e.direction.z=parseFloat(n);break;case 17:e.target.x=parseFloat(n);break;case 27:e.target.y=parseFloat(n);break;case 37:e.target.z=parseFloat(n);break;case 40:e.width=parseFloat(n);break;case 41:e.height=parseFloat(n);break;case 50:e.snapAngle=parseFloat(n);break;case 51:e.angle=parseFloat(n);break;case 68:e.status=n;break;case 69:e.id=n;break;case 90:e.flags=n;break;case 110:e.x=parseFloat(n);break;case 120:e.y=parseFloat(n);break;case 130:e.z=parseFloat(n);break;case 111:case 112:e.xAxisX=parseFloat(n);break;case 121:case 122:e.xAxisY=parseFloat(n);break;case 131:case 132:e.xAxisZ=parseFloat(n);break;case 146:e.elevation=parseFloat(n);break;case 281:e.render=n;break;default:Object.assign(e,(0,r.default)(i,n))}return e}),{type:i,center:{},centerDCS:{},snap:{},snapSpacing:{},gridSpacing:{},direction:{},target:{}})};e.process=n;var a={TYPE:i,process:n};e.default=a}(ma),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=w(Vn),r=w(Kn),i=w(Qn),n=w($n),a=w(ea),s=w(ta),o=w(ra),c=w(ia),l=w(na),u=w(aa),h=w(sa),f=w(oa),d=w(ca),p=w(la),m=w(ha),b=w(fa),v=w(da),g=w(pa),y=w(ua),_=w(ma);function w(e){return e&&e.__esModule?e:{default:e}}var x=[r.default,i.default,n.default,a.default,s.default,o.default,c.default,l.default,u.default,h.default,f.default,d.default,p.default,m.default,y.default,b.default,g.default,v.default,_.default].reduce((function(e,t){return e[t.TYPE]=t,e}),{});e.default=function(e){var r,i,n=[],a=[];return e.forEach((function(e){0===e[0]&&(r=[],a.push(r)),r.push(e)})),a.forEach((function(e){var r=e[0][1],a=e.slice(1);if(void 0!==x[r]){var s=x[r].process(a);"POLYLINE"===r?(i=s,n.push(s)):"VERTEX"===r?i?i.vertices.push(s):t.default.error("ignoring invalid VERTEX entity"):"SEQEND"===r?i=void 0:n.push(s)}else t.default.warn("unsupported type in ENTITIES section:",r)})),n}}(Zn),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=Zn)&&t.__esModule?t:{default:t};e.default=function(e){var t,i,n=[],a=[];return e.forEach((function(e){var s=e[0],o=e[1];if("BLOCK"===o)t="block",i={},a=[],n.push(i);else if("ENDBLK"===o)i.entities="entities"===t?(0,r.default)(a):[],a=void 0,t=void 0;else if("block"===t&&0!==s)switch(s){case 1:i.xref=o;break;case 2:i.name=o;break;case 10:i.x=o;break;case 20:i.y=o;break;case 30:i.z=o;break;case 67:0!==o&&(i.paperSpace=o);break;case 410:i.layout=o}else"block"===t&&0===s?(t="entities",a.push(e)):"entities"===t&&a.push(e)})),n}}(qn);var ba={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e){var t,r={layouts:[]},i={};return e.forEach((function(e,n){var a=e[0],s=e[1];if(0===a&&(t="IDLE"),"LAYOUT"===s&&(t="layout",i={},r.layouts.push(i)),"layout"===t&&0!==a&&100===a)"AcDbLayout"===s&&(t="AcDbLayout");if("AcDbLayout"===t&&0!==a)switch(a){case 1:i.name=s;break;case 5:i.handle=s;break;case 10:i.minLimitX=parseFloat(s);break;case 20:i.minLimitY=parseFloat(s);break;case 11:i.maxLimitX=parseFloat(s);break;case 21:i.maxLimitY=parseFloat(s);break;case 12:i.x=parseFloat(s);break;case 22:i.y=parseFloat(s);break;case 32:i.z=parseFloat(s);break;case 14:i.minX=parseFloat(s);break;case 24:i.minY=parseFloat(s);break;case 34:i.minZ=parseFloat(s);break;case 15:i.maxX=parseFloat(s);break;case 25:i.maxY=parseFloat(s);break;case 35:i.maxZ=parseFloat(s);break;case 70:i.flag=1===s?"PSLTSCALE":"LIMCHECK";break;case 71:i.tabOrder=s;break;case 146:i.elevation=parseFloat(s);break;case 13:i.ucsX=parseFloat(s);break;case 23:i.ucsY=parseFloat(s);break;case 33:i.ucsZ=parseFloat(s);break;case 16:i.ucsXaxisX=parseFloat(s);break;case 26:i.ucsXaxisY=parseFloat(s);break;case 36:i.ucsXaxisZ=parseFloat(s);break;case 17:i.ucsYaxisX=parseFloat(s);break;case 27:i.ucsYaxisY=parseFloat(s);break;case 37:i.ucsYaxisZ=parseFloat(s);break;case 76:switch(s){case 0:i.ucsType="NOT ORTHOGRAPHIC";break;case 1:i.ucsType="TOP";break;case 2:i.ucsType="BOTTOM";break;case 3:i.ucsType="FRONT";break;case 4:i.ucsType="BACK";break;case 5:i.ucsType="LEFT";break;case 6:i.ucsType="RIGHT"}break;case 330:i.tableRecord=s;break;case 331:i.lastActiveViewport=s;break;case 333:i.shadePlot=s}})),r}}(ba),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=o(Yn),r=o(Xn),i=o(qn),n=o(Zn),a=o(ba),s=o(Vn);function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var u=function(e,t){return e>=10&&e<60||e>=210&&e<240?parseFloat(t,10):e>=60&&e<100?parseInt(t,10):t},h=function(e,o){var c=o[0][1],l=o.slice(1);switch(c){case"HEADER":e.header=(0,t.default)(l);break;case"TABLES":e.tables=(0,r.default)(l);break;case"BLOCKS":e.blocks=(0,i.default)(l);break;case"ENTITIES":e.entities=(0,n.default)(l);break;case"OBJECTS":e.objects=(0,a.default)(l);break;default:s.default.warn("Unsupported section: ".concat(c))}return e};e.default=function(e){var t=function(e){var t,r,i="type",n=[],a=c(e);try{for(a.s();!(r=a.n()).done;){var s=r.value;"type"===i?(t=parseInt(s,10),i="value"):(n.push([t,u(t,s)]),i="type")}}catch(o){a.e(o)}finally{a.f()}return n}(e.split(/\r\n|\r|\n/g)),r=function(e){var t;return e.reduce((function(e,r){return 0===r[0]&&"SECTION"===r[1]?t=[]:0===r[0]&&"ENDSEC"===r[1]?(e.push(t),t=void 0):void 0!==t&&t.push(r),e}),[])}(t);return r.reduce(h,{header:{},blocks:[],entities:[],objects:{layouts:[]},tables:{layers:{},styles:{},ltypes:{}}})}}(Wn);var va={};var ga=function(){this.__data__=[],this.size=0};var ya=function(e,t){return e===t||e!=e&&t!=t},_a=ya;var wa=function(e,t){for(var r=e.length;r--;)if(_a(e[r][0],t))return r;return-1},xa=wa,ka=Array.prototype.splice;var Sa=function(e){var t=this.__data__,r=xa(t,e);return!(r<0)&&(r==t.length-1?t.pop():ka.call(t,r,1),--this.size,!0)},Ca=wa;var Ua=function(e){var t=this.__data__,r=Ca(t,e);return r<0?void 0:t[r][1]},Ea=wa;var Ta=function(e){return Ea(this.__data__,e)>-1},Ma=wa;var Oa=function(e,t){var r=this.__data__,i=Ma(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},Pa=ga,Aa=Sa,Ia=Ua,La=Ta,ja=Oa;function Ra(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Ra.prototype.clear=Pa,Ra.prototype.delete=Aa,Ra.prototype.get=Ia,Ra.prototype.has=La,Ra.prototype.set=ja;var Da=Ra,Ba=Da;var Fa=function(){this.__data__=new Ba,this.size=0};var Na=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var za=function(e){return this.__data__.get(e)};var Ha=function(e){return this.__data__.has(e)},Ga="object"==_(ve)&&ve&&ve.Object===Object&&ve,Wa=Ga,Ya="object"==("undefined"==typeof self?"undefined":_(self))&&self&&self.Object===Object&&self,Xa=Wa||Ya||Function("return this")(),Va=Xa.Symbol,qa=Va,Za=Object.prototype,Ka=Za.hasOwnProperty,Ja=Za.toString,Qa=qa?qa.toStringTag:void 0;var $a=function(e){var t=Ka.call(e,Qa),r=e[Qa];try{e[Qa]=void 0;var i=!0}catch(a){}var n=Ja.call(e);return i&&(t?e[Qa]=r:delete e[Qa]),n},es=Object.prototype.toString;var ts=$a,rs=function(e){return es.call(e)},is=Va?Va.toStringTag:void 0;var ns=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":is&&is in Object(e)?ts(e):rs(e)};var as=function(e){var t=_(e);return null!=e&&("object"==t||"function"==t)},ss=ns,os=as;var cs,ls=function(e){if(!os(e))return!1;var t=ss(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},us=Xa["__core-js_shared__"],hs=(cs=/[^.]+$/.exec(us&&us.keys&&us.keys.IE_PROTO||""))?"Symbol(src)_1."+cs:"";var fs=function(e){return!!hs&&hs in e},ds=Function.prototype.toString;var ps=function(e){if(null!=e){try{return ds.call(e)}catch(t){}try{return e+""}catch(t){}}return""},ms=ls,bs=fs,vs=as,gs=ps,ys=/^\[object .+?Constructor\]$/,_s=Function.prototype,ws=Object.prototype,xs=_s.toString,ks=ws.hasOwnProperty,Ss=RegExp("^"+xs.call(ks).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Cs=function(e,t){return null==e?void 0:e[t]},Us=function(e){return!(!vs(e)||bs(e))&&(ms(e)?Ss:ys).test(gs(e))},Es=Cs;var Ts=function(e,t){var r=Es(e,t);return Us(r)?r:void 0},Ms=Ts(Xa,"Map"),Os=Ts(Object,"create"),Ps=Os;var As=function(){this.__data__=Ps?Ps(null):{},this.size=0};var Is=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ls=Os,js=Object.prototype.hasOwnProperty;var Rs=function(e){var t=this.__data__;if(Ls){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return js.call(t,e)?t[e]:void 0},Ds=Os,Bs=Object.prototype.hasOwnProperty;var Fs=function(e){var t=this.__data__;return Ds?void 0!==t[e]:Bs.call(t,e)},Ns=Os;var zs=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ns&&void 0===t?"__lodash_hash_undefined__":t,this},Hs=As,Gs=Is,Ws=Rs,Ys=Fs,Xs=zs;function Vs(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Vs.prototype.clear=Hs,Vs.prototype.delete=Gs,Vs.prototype.get=Ws,Vs.prototype.has=Ys,Vs.prototype.set=Xs;var qs=Vs,Zs=Da,Ks=Ms;var Js=function(e){var t=_(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Qs=function(e,t){var r=e.__data__;return Js(t)?r["string"==typeof t?"string":"hash"]:r.map},$s=Qs;var eo=function(e){var t=$s(this,e).delete(e);return this.size-=t?1:0,t},to=Qs;var ro=function(e){return to(this,e).get(e)},io=Qs;var no=function(e){return io(this,e).has(e)},ao=Qs;var so=function(e,t){var r=ao(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},oo=function(){this.size=0,this.__data__={hash:new qs,map:new(Ks||Zs),string:new qs}},co=eo,lo=ro,uo=no,ho=so;function fo(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}fo.prototype.clear=oo,fo.prototype.delete=co,fo.prototype.get=lo,fo.prototype.has=uo,fo.prototype.set=ho;var po=Da,mo=Ms,bo=fo;var vo=function(e,t){var r=this.__data__;if(r instanceof po){var i=r.__data__;if(!mo||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new bo(i)}return r.set(e,t),this.size=r.size,this},go=Da,yo=Fa,_o=Na,wo=za,xo=Ha,ko=vo;function So(e){var t=this.__data__=new go(e);this.size=t.size}So.prototype.clear=yo,So.prototype.delete=_o,So.prototype.get=wo,So.prototype.has=xo,So.prototype.set=ko;var Co=So;var Uo=function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i&&!1!==t(e[r],r,e););return e},Eo=Ts,To=function(){try{var e=Eo(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();var Mo=function(e,t,r){"__proto__"==t&&To?To(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Oo=Mo,Po=ya,Ao=Object.prototype.hasOwnProperty;var Io=function(e,t,r){var i=e[t];Ao.call(e,t)&&Po(i,r)&&(void 0!==r||t in e)||Oo(e,t,r)},Lo=Io,jo=Mo;var Ro=function(e,t,r,i){var n=!r;r||(r={});for(var a=-1,s=t.length;++a<s;){var o=t[a],c=i?i(r[o],e[o],o,r,e):void 0;void 0===c&&(c=e[o]),n?jo(r,o,c):Lo(r,o,c)}return r};var Do=function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i};var Bo=function(e){return null!=e&&"object"==_(e)},Fo=ns,No=Bo;var zo=function(e){return No(e)&&"[object Arguments]"==Fo(e)},Ho=Bo,Go=Object.prototype,Wo=Go.hasOwnProperty,Yo=Go.propertyIsEnumerable,Xo=zo(function(){return arguments}())?zo:function(e){return Ho(e)&&Wo.call(e,"callee")&&!Yo.call(e,"callee")},Vo=Xo,qo=Array.isArray,Zo={exports:{}};var Ko=function(){return!1};!function(e,t){var r=Xa,i=Ko,n=t&&!t.nodeType&&t,a=n&&e&&!e.nodeType&&e,s=a&&a.exports===n?r.Buffer:void 0,o=(s?s.isBuffer:void 0)||i;e.exports=o}(Zo,Zo.exports);var Jo=Zo.exports,Qo=/^(?:0|[1-9]\d*)$/;var $o=function(e,t){var r=_(e);return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Qo.test(e))&&e>-1&&e%1==0&&e<t};var ec=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},tc=ns,rc=ec,ic=Bo,nc={};nc["[object Float32Array]"]=nc["[object Float64Array]"]=nc["[object Int8Array]"]=nc["[object Int16Array]"]=nc["[object Int32Array]"]=nc["[object Uint8Array]"]=nc["[object Uint8ClampedArray]"]=nc["[object Uint16Array]"]=nc["[object Uint32Array]"]=!0,nc["[object Arguments]"]=nc["[object Array]"]=nc["[object ArrayBuffer]"]=nc["[object Boolean]"]=nc["[object DataView]"]=nc["[object Date]"]=nc["[object Error]"]=nc["[object Function]"]=nc["[object Map]"]=nc["[object Number]"]=nc["[object Object]"]=nc["[object RegExp]"]=nc["[object Set]"]=nc["[object String]"]=nc["[object WeakMap]"]=!1;var ac=function(e){return ic(e)&&rc(e.length)&&!!nc[tc(e)]};var sc=function(e){return function(t){return e(t)}},oc={exports:{}};!function(e,t){var r=Ga,i=t&&!t.nodeType&&t,n=i&&e&&!e.nodeType&&e,a=n&&n.exports===i&&r.process,s=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=s}(oc,oc.exports);var cc=oc.exports,lc=ac,uc=sc,hc=cc&&cc.isTypedArray,fc=hc?uc(hc):lc,dc=Do,pc=Vo,mc=qo,bc=Jo,vc=$o,gc=fc,yc=Object.prototype.hasOwnProperty;var _c=function(e,t){var r=mc(e),i=!r&&pc(e),n=!r&&!i&&bc(e),a=!r&&!i&&!n&&gc(e),s=r||i||n||a,o=s?dc(e.length,String):[],c=o.length;for(var l in e)!t&&!yc.call(e,l)||s&&("length"==l||n&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||vc(l,c))||o.push(l);return o},wc=Object.prototype;var xc=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||wc)};var kc=function(e,t){return function(r){return e(t(r))}},Sc=kc(Object.keys,Object),Cc=xc,Uc=Sc,Ec=Object.prototype.hasOwnProperty;var Tc=function(e){if(!Cc(e))return Uc(e);var t=[];for(var r in Object(e))Ec.call(e,r)&&"constructor"!=r&&t.push(r);return t},Mc=ls,Oc=ec;var Pc=function(e){return null!=e&&Oc(e.length)&&!Mc(e)},Ac=_c,Ic=Tc,Lc=Pc;var jc=function(e){return Lc(e)?Ac(e):Ic(e)},Rc=Ro,Dc=jc;var Bc=function(e,t){return e&&Rc(t,Dc(t),e)};var Fc=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},Nc=as,zc=xc,Hc=Fc,Gc=Object.prototype.hasOwnProperty;var Wc=function(e){if(!Nc(e))return Hc(e);var t=zc(e),r=[];for(var i in e)("constructor"!=i||!t&&Gc.call(e,i))&&r.push(i);return r},Yc=_c,Xc=Wc,Vc=Pc;var qc=function(e){return Vc(e)?Yc(e,!0):Xc(e)},Zc=Ro,Kc=qc;var Jc=function(e,t){return e&&Zc(t,Kc(t),e)},Qc={exports:{}};!function(e,t){var r=Xa,i=t&&!t.nodeType&&t,n=i&&e&&!e.nodeType&&e,a=n&&n.exports===i?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,i=s?s(r):new e.constructor(r);return e.copy(i),i}}(Qc,Qc.exports);var $c=Qc.exports;var el=function(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t};var tl=function(e,t){for(var r=-1,i=null==e?0:e.length,n=0,a=[];++r<i;){var s=e[r];t(s,r,e)&&(a[n++]=s)}return a};var rl=function(){return[]},il=tl,nl=rl,al=Object.prototype.propertyIsEnumerable,sl=Object.getOwnPropertySymbols,ol=sl?function(e){return null==e?[]:(e=Object(e),il(sl(e),(function(t){return al.call(e,t)})))}:nl,cl=Ro,ll=ol;var ul=function(e,t){return cl(e,ll(e),t)};var hl=function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e},fl=kc(Object.getPrototypeOf,Object),dl=hl,pl=fl,ml=ol,bl=rl,vl=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)dl(t,ml(e)),e=pl(e);return t}:bl,gl=Ro,yl=vl;var _l=function(e,t){return gl(e,yl(e),t)},wl=hl,xl=qo;var kl=function(e,t,r){var i=t(e);return xl(e)?i:wl(i,r(e))},Sl=kl,Cl=ol,Ul=jc;var El=function(e){return Sl(e,Ul,Cl)},Tl=kl,Ml=vl,Ol=qc;var Pl=function(e){return Tl(e,Ol,Ml)},Al=Ts(Xa,"DataView"),Il=Ms,Ll=Ts(Xa,"Promise"),jl=Ts(Xa,"Set"),Rl=Ts(Xa,"WeakMap"),Dl=ns,Bl=ps,Fl="[object Map]",Nl="[object Promise]",zl="[object Set]",Hl="[object WeakMap]",Gl="[object DataView]",Wl=Bl(Al),Yl=Bl(Il),Xl=Bl(Ll),Vl=Bl(jl),ql=Bl(Rl),Zl=Dl;(Al&&Zl(new Al(new ArrayBuffer(1)))!=Gl||Il&&Zl(new Il)!=Fl||Ll&&Zl(Ll.resolve())!=Nl||jl&&Zl(new jl)!=zl||Rl&&Zl(new Rl)!=Hl)&&(Zl=function(e){var t=Dl(e),r="[object Object]"==t?e.constructor:void 0,i=r?Bl(r):"";if(i)switch(i){case Wl:return Gl;case Yl:return Fl;case Xl:return Nl;case Vl:return zl;case ql:return Hl}return t});var Kl=Zl,Jl=Object.prototype.hasOwnProperty;var Ql=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Jl.call(e,"index")&&(r.index=e.index,r.input=e.input),r},$l=Xa.Uint8Array;var eu=function(e){var t=new e.constructor(e.byteLength);return new $l(t).set(new $l(e)),t},tu=eu;var ru=function(e,t){var r=t?tu(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},iu=/\w*$/;var nu=function(e){var t=new e.constructor(e.source,iu.exec(e));return t.lastIndex=e.lastIndex,t},au=Va?Va.prototype:void 0,su=au?au.valueOf:void 0;var ou=eu;var cu=eu,lu=ru,uu=nu,hu=function(e){return su?Object(su.call(e)):{}},fu=function(e,t){var r=t?ou(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var du=function(e,t,r){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return cu(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return lu(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return fu(e,r);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return uu(e);case"[object Symbol]":return hu(e)}},pu=as,mu=Object.create,bu=function(){function e(){}return function(t){if(!pu(t))return{};if(mu)return mu(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),vu=fl,gu=xc;var yu=function(e){return"function"!=typeof e.constructor||gu(e)?{}:bu(vu(e))},_u=Kl,wu=Bo;var xu=function(e){return wu(e)&&"[object Map]"==_u(e)},ku=sc,Su=cc&&cc.isMap,Cu=Su?ku(Su):xu,Uu=Kl,Eu=Bo;var Tu=function(e){return Eu(e)&&"[object Set]"==Uu(e)},Mu=sc,Ou=cc&&cc.isSet,Pu=Ou?Mu(Ou):Tu,Au=Co,Iu=Uo,Lu=Io,ju=Bc,Ru=Jc,Du=$c,Bu=el,Fu=ul,Nu=_l,zu=El,Hu=Pl,Gu=Kl,Wu=Ql,Yu=du,Xu=yu,Vu=qo,qu=Jo,Zu=Cu,Ku=as,Ju=Pu,Qu=jc,$u=qc,eh="[object Arguments]",th="[object Function]",rh="[object Object]",ih={};ih[eh]=ih["[object Array]"]=ih["[object ArrayBuffer]"]=ih["[object DataView]"]=ih["[object Boolean]"]=ih["[object Date]"]=ih["[object Float32Array]"]=ih["[object Float64Array]"]=ih["[object Int8Array]"]=ih["[object Int16Array]"]=ih["[object Int32Array]"]=ih["[object Map]"]=ih["[object Number]"]=ih[rh]=ih["[object RegExp]"]=ih["[object Set]"]=ih["[object String]"]=ih["[object Symbol]"]=ih["[object Uint8Array]"]=ih["[object Uint8ClampedArray]"]=ih["[object Uint16Array]"]=ih["[object Uint32Array]"]=!0,ih["[object Error]"]=ih[th]=ih["[object WeakMap]"]=!1;var nh=function e(t,r,i,n,a,s){var o,c=1&r,l=2&r,u=4&r;if(i&&(o=a?i(t,n,a,s):i(t)),void 0!==o)return o;if(!Ku(t))return t;var h=Vu(t);if(h){if(o=Wu(t),!c)return Bu(t,o)}else{var f=Gu(t),d=f==th||"[object GeneratorFunction]"==f;if(qu(t))return Du(t,c);if(f==rh||f==eh||d&&!a){if(o=l||d?{}:Xu(t),!c)return l?Nu(t,Ru(o,t)):Fu(t,ju(o,t))}else{if(!ih[f])return a?t:{};o=Yu(t,f,c)}}s||(s=new Au);var p=s.get(t);if(p)return p;s.set(t,o),Ju(t)?t.forEach((function(n){o.add(e(n,r,i,n,t,s))})):Zu(t)&&t.forEach((function(n,a){o.set(a,e(n,r,i,a,t,s))}));var m=h?void 0:(u?l?Hu:zu:l?$u:Qu)(t);return Iu(m||t,(function(n,a){m&&(n=t[a=n]),Lu(o,a,e(n,r,i,a,t,s))})),o},ah=nh;var sh=function(e){return ah(e,5)};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=i(sh),r=i(Vn);function i(e){return e&&e.__esModule?e:{default:e}}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}e.default=function(e){var i=e.blocks.reduce((function(e,t){return e[t.name]=t,e}),{});return function e(a,s){var o=[];return a.forEach((function(a){if("INSERT"===a.type){var c=function(){var n,c,l,u,h,f=a,d=i[f.block];if(!d)return r.default.error("no block found for insert. block:",f.block),{v:void 0};var p,m,b=null!==(n=f.rowCount)&&void 0!==n?n:1,v=null!==(c=f.columnCount)&&void 0!==c?c:1,g=null!==(l=f.rowSpacing)&&void 0!==l?l:0,y=null!==(u=f.columnSpacing)&&void 0!==u?u:0,_=null!==(h=f.rotation)&&void 0!==h?h:0;if(b>1||v>1){var w=Math.cos(_*Math.PI/180),x=Math.sin(_*Math.PI/180);p={x:-x*g,y:w*g},m={x:w*y,y:x*y}}else p={x:0,y:0},m={x:0,y:0};for(var k=0;k<b;k++)for(var S=0;S<v;S++){var C={x:f.x+p.x*k+m.x*S,y:f.y+p.y*k+m.y*S,scaleX:f.scaleX,scaleY:f.scaleY,scaleZ:f.scaleZ,extrusionX:f.extrusionX,extrusionY:f.extrusionY,extrusionZ:f.extrusionZ,rotation:f.rotation},U=s.slice(0);U.push(C);var E=d.entities.map((function(e){var r=(0,t.default)(e);switch(r.layer=f.layer,r.type){case"LINE":r.start.x-=d.x,r.start.y-=d.y,r.end.x-=d.x,r.end.y-=d.y;break;case"LWPOLYLINE":case"POLYLINE":r.vertices.forEach((function(e){e.x-=d.x,e.y-=d.y}));break;case"CIRCLE":case"ELLIPSE":case"ARC":r.x-=d.x,r.y-=d.y;break;case"SPLINE":r.controlPoints.forEach((function(e){e.x-=d.x,e.y-=d.y}))}return r}));o=o.concat(e(E,U))}}();if("object"===n(c))return c.v}else{var l=(0,t.default)(a);l.transforms=s.slice().reverse(),o.push(l)}})),o}(e.entities,[])}}(va);var oh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e){return e.reduce((function(e,t){var r=t.layer;return e[r]||(e[r]=[]),e[r].push(t),e}),{})}}(oh);var ch={},lh={},uh={};!function(e){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function e(r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"===t(r)?(this.x=r.x,this.y=r.y):(this.x=r,this.y=i)}var i,n,a;return i=e,(n=[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function(){return new e(-this.x,-this.y)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"sub",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"multiply",value:function(t){return new e(this.x*t,this.y*t)}},{key:"norm",value:function(){return this.multiply(1/this.length())}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}}])&&r(i.prototype,n),a&&r(i,a),e}();e.default=i}(uh);var hh={};!function(e){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function e(r,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"===t(r)?(this.x=r.x,this.y=r.y,this.z=r.z):void 0===r?(this.x=0,this.y=0,this.z=0):(this.x=r,this.y=i,this.z=n)}var i,n,a;return i=e,(n=[{key:"equals",value:function(e,t){return void 0===t&&(t=0),Math.abs(this.x-e.x)<=t&&Math.abs(this.y-e.y)<=t&&Math.abs(this.z-e.z)<=t}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function(){return new e(-this.x,-this.y,-this.z)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z)}},{key:"sub",value:function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z)}},{key:"multiply",value:function(t){return new e(this.x*t,this.y*t,this.z*t)}},{key:"norm",value:function(){return this.multiply(1/this.length())}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"cross",value:function(t){return new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}}])&&r(i.prototype,n),a&&r(i,a),e}();e.default=i}(hh);var fh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=uh)&&t.__esModule?t:{default:t};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"===i(t)&&"object"===i(n)&&void 0!==t.x&&void 0!==t.y&&void 0!==n.x&&void 0!==n.y)this.min=new r.default(t),this.max=new r.default(n),this.valid=!0;else{if(void 0!==t||void 0!==n)throw Error("Illegal construction - must use { x, y } objects");this.min=new r.default(1/0,1/0),this.max=new r.default(-1/0,-1/0),this.valid=!1}}var t,a,s;return t=e,a=[{key:"equals",value:function(e){if(!this.valid)throw Error("Box2 is invalid");return this.min.equals(e.min)&&this.max.equals(e.max)}},{key:"expandByPoint",value:function(e){return this.min=new r.default(Math.min(this.min.x,e.x),Math.min(this.min.y,e.y)),this.max=new r.default(Math.max(this.max.x,e.x),Math.max(this.max.y,e.y)),this.valid=!0,this}},{key:"expandByPoints",value:function(e){var t=this;return e.forEach((function(e){t.expandByPoint(e)}),this),this}},{key:"isPointInside",value:function(e){return e.x>=this.min.x&&e.y>=this.min.y&&e.x<=this.max.x&&e.y<=this.max.y}},{key:"width",get:function(){if(!this.valid)throw Error("Box2 is invalid");return this.max.x-this.min.x}},{key:"height",get:function(){if(!this.valid)throw Error("Box2 is invalid");return this.max.y-this.min.y}}],a&&n(t.prototype,a),s&&n(t,s),e}();a.fromPoints=function(e){return(new a).expandByPoints(e)};var s=a;e.default=s}(fh);var dh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=hh)&&t.__esModule?t:{default:t};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"===i(t)&&"object"===i(n)&&void 0!==t.x&&void 0!==t.y&&void 0!==t.z&&void 0!==n.x&&void 0!==n.y&&void 0!==n.z)this.min=new r.default(t),this.max=new r.default(n),this.valid=!0;else{if(void 0!==t||void 0!==n)throw Error("Illegal construction - must use { x, y, z } objects");this.min=new r.default(1/0,1/0,1/0),this.max=new r.default(-1/0,-1/0,-1/0),this.valid=!1}}var t,a,s;return t=e,a=[{key:"equals",value:function(e){if(!this.valid)throw Error("Box3 is invalid");return this.min.equals(e.min)&&this.max.equals(e.max)}},{key:"expandByPoint",value:function(e){return this.min=new r.default(Math.min(this.min.x,e.x),Math.min(this.min.y,e.y),Math.min(this.min.z,e.z)),this.max=new r.default(Math.max(this.max.x,e.x),Math.max(this.max.y,e.y),Math.max(this.max.z,e.z)),this.valid=!0,this}},{key:"expandByPoints",value:function(e){var t=this;return e.forEach((function(e){t.expandByPoint(e)}),this),this}},{key:"isPointInside",value:function(e){return e.x>=this.min.x&&e.y>=this.min.y&&e.z>=this.min.z&&e.x<=this.max.x&&e.y<=this.max.y&&e.z<=this.max.z}},{key:"width",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.x-this.min.x}},{key:"depth",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.y-this.min.y}},{key:"height",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.z-this.min.z}}],a&&n(t.prototype,a),s&&n(t,s),e}();a.fromPoints=function(e){return(new a).expandByPoints(e)};var s=a;e.default=s}(dh);var ph={};!function(e){function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(){function e(t,r,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.a=t,this.b=r,this.c=i,this.d=n}var r,i,n;return r=e,(i=[{key:"distanceToPoint",value:function(e){return(this.a*e.x+this.b*e.y+this.c*e.z+this.d)/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c)}},{key:"equals",value:function(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d}},{key:"coPlanar",value:function(e){var t=this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d,r=this.a===-e.a&&this.b===-e.b&&this.c===-e.c&&this.d===-e.d;return t||r}}])&&t(r.prototype,i),n&&t(r,n),e}();r.fromPointAndNormal=function(e,t){var i=t.x,n=t.y,a=t.z,s=-(e.x*i+e.y*n+e.z*a);return new r(t.x,t.y,t.z,s)},r.fromPoints=function(e){for(var t,i=0,n=e.length;i<n;++i){var a=e[(i+1)%n].sub(e[i]),s=e[(i+2)%n].sub(e[(i+1)%n]),o=a.cross(s);if(!isNaN(o.length())&&0!==o.length())if(t){var c=o.norm().equals(t,1e-6),l=o.neg().norm().equals(t,1e-6);if(!c&&!l)throw Error("points not on a plane")}else t=o.norm()}if(!t)throw Error("points not on a plane");return r.fromPointAndNormal(e[0],t.norm())};var i=r;e.default=i}(ph);var mh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=hh)&&t.__esModule?t:{default:t};function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=function(){function e(t,r,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=r,this.z=i,this.w=n}var t,n,a;return t=e,(n=[{key:"applyToVec3",value:function(e){var t=e.x,i=e.y,n=e.z,a=this.x,s=this.y,o=this.z,c=this.w,l=c*t+s*n-o*i,u=c*i+o*t-a*n,h=c*n+a*i-s*t,f=-a*t-s*i-o*n;return new r.default(l*c+f*-a+u*-o-h*-s,u*c+f*-s+h*-a-l*-o,h*c+f*-o+l*-s-u*-a)}}])&&i(t.prototype,n),a&&i(t,a),e}();n.fromAxisAngle=function(e,t){var r=e.norm(),i=t/2,a=Math.sin(i);return new n(r.x*a,r.y*a,r.z*a,Math.cos(i))};var a=n;e.default=a}(mh);var bh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=uh)&&t.__esModule?t:{default:t};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(e,t,r){var i=e.x,n=e.y,a=t.x,s=t.y,o=r.x,c=(r.y-n)*(a-i),l=(s-n)*(o-i);return c>l+Number.EPSILON?1:c+Number.EPSILON<l?-1:0},s=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},o=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"!==i(t)||void 0===t.x||void 0===t.y)throw Error("expected first argument to have x and y properties");if("object"!==i(n)||void 0===n.x||void 0===n.y)throw Error("expected second argument to have x and y properties");this.a=new r.default(t),this.b=new r.default(n)}var t,o,c;return t=e,o=[{key:"length",value:function(){return this.a.sub(this.b).length()}},{key:"intersects",value:function(t){if(!(t instanceof e))throw new Error("expected argument to be an instance of vecks.Line2");return i=t,n=(r=this).a,s=r.b,o=i.a,c=i.b,a(n,o,c)!==a(s,o,c)&&a(n,s,o)!==a(n,s,c);var r,i,n,s,o,c}},{key:"getIntersection",value:function(e){return this.intersects(e)?function(e,t){var i=e.a.x,n=e.b.x,a=e.a.y,s=e.b.y,o=t.a.x,c=t.b.x,l=t.a.y,u=t.b.y,h=i-n,f=o-c,d=a-s,p=l-u,m=h*p-d*f,b=((i*s-a*n)*f-h*(o*u-l*c))/m,v=((i*s-a*n)*p-d*(o*u-l*c))/m;return isNaN(b)||isNaN(v)?null:new r.default(b,v)}(this,e):null}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-12;return Math.abs(s(this.a,this.b)-s(e,this.a)-s(e,this.b))<t}}],o&&n(t.prototype,o),c&&n(t,c),e}(),c=o;e.default=c}(bh);var vh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=hh)&&t.__esModule?t:{default:t};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)+Math.pow(e.z-t.z,2))},s=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"!==i(t)||void 0===t.x||void 0===t.y||void 0===t.z)throw Error("expected first argument to have x, y and z properties");if("object"!==i(n)||void 0===n.x||void 0===n.y||void 0===n.y)throw Error("expected second argument to have x, y and z properties");this.a=new r.default(t),this.b=new r.default(n)}var t,s,o;return t=e,s=[{key:"length",value:function(){return this.a.sub(this.b).length()}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-12;return Math.abs(a(this.a,this.b)-a(e,this.a)-a(e,this.b))<t}}],s&&n(t.prototype,s),o&&n(t,o),e}(),o=s;e.default=o}(vh),function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"V2",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"V3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"Box2",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"Box3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"Plane3",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"Quaternion",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"Line2",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"Line3",{enumerable:!0,get:function(){return c.default}});var t=l(uh),r=l(hh),i=l(fh),n=l(dh),a=l(ph),s=l(mh),o=l(bh),c=l(vh);function l(e){return e&&e.__esModule?e:{default:e}}}(lh);var gh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=[[0,0,0],[255,0,0],[255,255,0],[0,255,0],[0,255,255],[0,0,255],[255,0,255],[255,255,255],[65,65,65],[128,128,128],[255,0,0],[255,170,170],[189,0,0],[189,126,126],[129,0,0],[129,86,86],[104,0,0],[104,69,69],[79,0,0],[79,53,53],[255,63,0],[255,191,170],[189,46,0],[189,141,126],[129,31,0],[129,96,86],[104,25,0],[104,78,69],[79,19,0],[79,59,53],[255,127,0],[255,212,170],[189,94,0],[189,157,126],[129,64,0],[129,107,86],[104,52,0],[104,86,69],[79,39,0],[79,66,53],[255,191,0],[255,234,170],[189,141,0],[189,173,126],[129,96,0],[129,118,86],[104,78,0],[104,95,69],[79,59,0],[79,73,53],[255,255,0],[255,255,170],[189,189,0],[189,189,126],[129,129,0],[129,129,86],[104,104,0],[104,104,69],[79,79,0],[79,79,53],[191,255,0],[234,255,170],[141,189,0],[173,189,126],[96,129,0],[118,129,86],[78,104,0],[95,104,69],[59,79,0],[73,79,53],[127,255,0],[212,255,170],[94,189,0],[157,189,126],[64,129,0],[107,129,86],[52,104,0],[86,104,69],[39,79,0],[66,79,53],[63,255,0],[191,255,170],[46,189,0],[141,189,126],[31,129,0],[96,129,86],[25,104,0],[78,104,69],[19,79,0],[59,79,53],[0,255,0],[170,255,170],[0,189,0],[126,189,126],[0,129,0],[86,129,86],[0,104,0],[69,104,69],[0,79,0],[53,79,53],[0,255,63],[170,255,191],[0,189,46],[126,189,141],[0,129,31],[86,129,96],[0,104,25],[69,104,78],[0,79,19],[53,79,59],[0,255,127],[170,255,212],[0,189,94],[126,189,157],[0,129,64],[86,129,107],[0,104,52],[69,104,86],[0,79,39],[53,79,66],[0,255,191],[170,255,234],[0,189,141],[126,189,173],[0,129,96],[86,129,118],[0,104,78],[69,104,95],[0,79,59],[53,79,73],[0,255,255],[170,255,255],[0,189,189],[126,189,189],[0,129,129],[86,129,129],[0,104,104],[69,104,104],[0,79,79],[53,79,79],[0,191,255],[170,234,255],[0,141,189],[126,173,189],[0,96,129],[86,118,129],[0,78,104],[69,95,104],[0,59,79],[53,73,79],[0,127,255],[170,212,255],[0,94,189],[126,157,189],[0,64,129],[86,107,129],[0,52,104],[69,86,104],[0,39,79],[53,66,79],[0,63,255],[170,191,255],[0,46,189],[126,141,189],[0,31,129],[86,96,129],[0,25,104],[69,78,104],[0,19,79],[53,59,79],[0,0,255],[170,170,255],[0,0,189],[126,126,189],[0,0,129],[86,86,129],[0,0,104],[69,69,104],[0,0,79],[53,53,79],[63,0,255],[191,170,255],[46,0,189],[141,126,189],[31,0,129],[96,86,129],[25,0,104],[78,69,104],[19,0,79],[59,53,79],[127,0,255],[212,170,255],[94,0,189],[157,126,189],[64,0,129],[107,86,129],[52,0,104],[86,69,104],[39,0,79],[66,53,79],[191,0,255],[234,170,255],[141,0,189],[173,126,189],[96,0,129],[118,86,129],[78,0,104],[95,69,104],[59,0,79],[73,53,79],[255,0,255],[255,170,255],[189,0,189],[189,126,189],[129,0,129],[129,86,129],[104,0,104],[104,69,104],[79,0,79],[79,53,79],[255,0,191],[255,170,234],[189,0,141],[189,126,173],[129,0,96],[129,86,118],[104,0,78],[104,69,95],[79,0,59],[79,53,73],[255,0,127],[255,170,212],[189,0,94],[189,126,157],[129,0,64],[129,86,107],[104,0,52],[104,69,86],[79,0,39],[79,53,66],[255,0,63],[255,170,191],[189,0,46],[189,126,141],[129,0,31],[129,86,96],[104,0,25],[104,69,78],[79,0,19],[79,53,59],[51,51,51],[80,80,80],[105,105,105],[130,130,130],[190,190,190],[255,255,255]]}(gh);var yh={},_h={},wh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e,t){return void 0===t||0==+t?Math.round(e):(e=+e,t=+t,isNaN(e)||"number"!=typeof t||t%1!=0?NaN:(e=e.toString().split("e"),+((e=(e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]+t:t))))}}(wh),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=wh)&&t.__esModule?t:{default:t};e.default=function(e,t,i,n,a){var s=i.length,o=i[0].length;if(e<0||e>1)throw new Error("t out of bounds [0,1]: "+e);if(t<1)throw new Error("degree must be at least 1 (linear)");if(t>s-1)throw new Error("degree must be less than or equal to point count - 1");if(!a){a=[];for(var c=0;c<s;c++)a[c]=1}if(n){if(n.length!==s+t+1)throw new Error("bad knot vector length")}else{n=[];for(var l=0;l<s+t+1;l++)n[l]=l}var u,h=[t,n.length-1-t],f=n[h[0]],d=n[h[1]];for(e=e*(d-f)+f,e=Math.max(e,f),e=Math.min(e,d),u=h[0];u<h[1]&&!(e>=n[u]&&e<=n[u+1]);u++);for(var p,m=[],b=0;b<s;b++){m[b]=[];for(var v=0;v<o;v++)m[b][v]=i[b][v]*a[b];m[b][o]=a[b]}for(var g=1;g<=t+1;g++)for(var y=u;y>u-t-1+g;y--){p=(e-n[y])/(n[y+t+1-g]-n[y]);for(var _=0;_<o+1;_++)m[y][_]=(1-p)*m[y-1][_]+p*m[y][_]}for(var w=[],x=0;x<o;x++)w[x]=(0,r.default)(m[u][x]/m[u][o],-9);return w}}(_h);var xh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=lh;e.default=function(e,r,i,n){var a,s,o;n||(n=5),i<0?(a=4*Math.atan(-i),s=new t.V2(e[0],e[1]),o=new t.V2(r[0],r[1])):(a=4*Math.atan(i),s=new t.V2(r[0],r[1]),o=new t.V2(e[0],e[1]));var c,l=o.sub(s),u=l.length(),h=s.add(l.multiply(.5)),f=Math.abs(u/2/Math.tan(a/2)),d=l.norm();if(a<Math.PI){var p=new t.V2(d.x*Math.cos(Math.PI/2)-d.y*Math.sin(Math.PI/2),d.y*Math.cos(Math.PI/2)+d.x*Math.sin(Math.PI/2));c=h.add(p.multiply(-f))}else{var m=new t.V2(d.x*Math.cos(Math.PI/2)-d.y*Math.sin(Math.PI/2),d.y*Math.cos(Math.PI/2)+d.x*Math.sin(Math.PI/2));c=h.add(m.multiply(f))}var b=Math.atan2(o.y-c.y,o.x-c.x)/Math.PI*180,v=Math.atan2(s.y-c.y,s.x-c.x)/Math.PI*180;v<b&&(v+=360);for(var g=o.sub(c).length(),y=Math.floor(b/n)*n+n,_=Math.ceil(v/n)*n-n,w=[],x=y;x<=_;x+=n)w.push(c.add(new t.V2(Math.cos(x/180*Math.PI)*g,Math.sin(x/180*Math.PI)*g)));return i<0&&w.reverse(),w.map((function(e){return[e.x,e.y]}))}}(xh),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.interpolateBSpline=e.default=void 0;var t=n(_h),r=n(Vn),i=n(xh);function n(e){return e&&e.__esModule?e:{default:e}}var a=function(e,t,r,i,n,a,s){a<n&&(a+=2*Math.PI);for(var o=[],c=2*Math.PI/72,l=n;l<a-1e-6;l+=c)o.push([Math.cos(l)*r,Math.sin(l)*i]);return o.push([Math.cos(a)*r,Math.sin(a)*i]),s&&(o=function(e,t){return e.map((function(e){return[e[0]*Math.cos(t)-e[1]*Math.sin(t),e[1]*Math.cos(t)+e[0]*Math.sin(t)]}))}(o,s)),o=o.map((function(r){return[e+r[0],t+r[1]]}))},s=function(e,r,i,n,a){for(var s=[],o=e.map((function(e){return[e.x,e.y]})),c=[i[r]],l=[i[r],i[i.length-1-r]],u=r+1;u<i.length-r;++u)c[c.length-1]!==i[u]&&c.push(i[u]);n=n||25;for(var h=1;h<c.length;++h)for(var f=c[h-1],d=c[h],p=0;p<=n;++p){var m=(p/n*(d-f)+f-l[0])/(l[1]-l[0]);m=Math.max(m,0),m=Math.min(m,1);var b=(0,t.default)(m,r,o,i,a);s.push(b)}return s};e.interpolateBSpline=s;e.default=function(e,t){var n;if(t=t||{},"LINE"===e.type&&(n=[[e.start.x,e.start.y],[e.end.x,e.end.y]]),"LWPOLYLINE"===e.type||"POLYLINE"===e.type)if(n=[],e.polygonMesh||e.polyfaceMesh);else if(e.vertices.length){e.closed&&(e.vertices=e.vertices.concat(e.vertices[0]));for(var o=0,c=e.vertices.length;o<c-1;++o){var l=[e.vertices[o].x,e.vertices[o].y],u=[e.vertices[o+1].x,e.vertices[o+1].y];n.push(l),e.vertices[o].bulge&&(n=n.concat((0,i.default)(l,u,e.vertices[o].bulge))),o===c-2&&n.push(u)}}else r.default.warn("Polyline entity with no vertices");if("CIRCLE"===e.type&&(n=a(e.x,e.y,e.r,e.r,0,2*Math.PI),-1===e.extrusionZ&&(n=n.map((function(e){return[-e[0],e[1]]})))),"ELLIPSE"===e.type){var h=Math.sqrt(e.majorX*e.majorX+e.majorY*e.majorY),f=e.axisRatio*h,d=-Math.atan2(-e.majorY,e.majorX);n=a(e.x,e.y,h,f,e.startAngle,e.endAngle,d),-1===e.extrusionZ&&(n=n.map((function(e){return[-e[0],e[1]]})))}return"ARC"===e.type&&(n=a(e.x,e.y,e.r,e.r,e.startAngle,e.endAngle,void 0),-1===e.extrusionZ&&(n=n.map((function(e){return[-e[0],e[1]]})))),"SPLINE"===e.type&&(n=s(e.controlPoints,e.degree,e.knots,t.interpolationsPerSplineSegment,e.weights)),n||(r.default.warn("unsupported entity for converting to polyline:",e.type),[])}}(yh);var kh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e,t){return t.forEach((function(t){e=e.map((function(e){var r=[e[0],e[1]];if(t.scaleX&&(r[0]=r[0]*t.scaleX),t.scaleY&&(r[1]=r[1]*t.scaleY),t.rotation){var i=t.rotation/180*Math.PI;r=[r[0]*Math.cos(i)-r[1]*Math.sin(i),r[1]*Math.cos(i)+r[0]*Math.sin(i)]}return t.x&&(r[0]=r[0]+t.x),t.y&&(r[1]=r[1]+t.y),-1===t.extrusionZ&&(r[0]=-r[0]),r}))})),e}}(kh),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=lh,r=o(gh),i=o(va),n=o(yh),a=o(kh),s=o(Vn);function o(e){return e&&e.__esModule?e:{default:e}}e.default=function(e){var o=(0,i.default)(e).map((function(t){var i,o=e.tables.layers[t.layer];if(o){var c="colorNumber"in t?t.colorNumber:o.colorNumber;void 0===(i=r.default[c])&&(s.default.warn("Color index",c,"invalid, defaulting to black"),i=[0,0,0])}else s.default.warn("no layer table for layer:"+t.layer),i=[0,0,0];return{rgb:i,vertices:(0,a.default)((0,n.default)(t),t.transforms)}})),c=new t.Box2;return o.forEach((function(e){e.vertices.forEach((function(e){c.expandByPoint({x:e[0],y:e[1]})}))})),{bbox:c,polylines:o}}}(ch);var Sh={},Ch={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=i(gh),r=i(Vn);function i(e){return e&&e.__esModule?e:{default:e}}e.default=function(e,i){var n=e[i.layer];if(n){var a="colorNumber"in i&&256!==i.colorNumber?i.colorNumber:n.colorNumber,s=t.default[a];return s||(r.default.warn("Color index",a,"invalid, defaulting to black"),[0,0,0])}return r.default.warn("no layer table for layer:"+i.layer),[0,0,0]}}(Ch);var Uh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e,t){return{x:e.x*Math.cos(t)-e.y*Math.sin(t),y:e.y*Math.cos(t)+e.x*Math.sin(t)}}}(Uh);var Eh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e){return 255===e[0]&&255===e[1]&&255===e[2]?"rgb(0, 0, 0)":"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")")}}(Eh);var Th={},Mh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e,t,r,i){for(var n=r,a=t,s=t.length,o=0,c=!1,l=0;l<s+e;l++)if(i>n[l]&&i<=n[l+1]){o=l,c=!0;break}if(!c)throw new Error("invalid new knot");for(var u,h=[],f=0;f<s+e+1;f++)h[f]=f<=o?n[f]:f===o+1?i:n[f-1];for(var d=[],p=0;p<s+1;p++)u=p<=o-e+1?1:o-e+2<=p&&p<=o?n[p+e-1]-n[p]==0?0:(i-n[p])/(n[p+e-1]-n[p]):0,d[p]=0===u?a[p-1]:1===u?a[p]:{x:(1-u)*a[p-1].x+u*a[p].x,y:(1-u)*a[p-1].y+u*a[p].y};return{controlPoints:d,knots:h}}}(Mh),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.multiplicity=e.default=e.computeInsertions=e.checkPinned=void 0;var t,r=(t=Mh)&&t.__esModule?t:{default:t};var i=function(e,t){for(var r=1;r<e;++r)if(t[r]!==t[0])throw Error("not pinned. order: ".concat(e," knots: ").concat(t));for(var i=t.length-2;i>t.length-e-1;--i)if(t[i]!==t[t.length-1])throw Error("not pinned. order: ".concat(e," knots: ").concat(t))};e.checkPinned=i;var n=function(e,t){for(var r=1,i=t+1;i<e.length&&e[i]===e[t];++i)++r;return r};e.multiplicity=n;var a=function(e,t){for(var r=[],i=e;i<t.length-e;){for(var a=t[i],s=n(t,i),o=0;o<e-s-1;++o)r.push(a);i+=s}return r};e.computeInsertions=a;e.default=function(e,t,n){return i(e,n),a(e,n).reduce((function(t,i){return(0,r.default)(e,t.controlPoints,t.knots,i)}),{controlPoints:t,knots:n})}}(Th);var Oh={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=lh;function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a,s,o=[],c=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(i=a.call(r)).done)&&(o.push(i.value),o.length!==t);c=!0);}catch(u){l=!0,n=u}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}e.default=function(e,i,n){var a="",s=n.map((function(e){var t,r,i,n,a,s,o=e.x||0,c=e.y||0,l=e.scaleX||1,u=e.scaleY||1,h=(e.rotation||0)/180*Math.PI,f=Math.cos,d=Math.sin;return-1===e.extrusionZ?(t=-l*f(h),r=l*d(h),i=u*d(h),n=u*f(h),a=-o,s=c):(t=l*f(h),r=l*d(h),i=-u*d(h),n=u*f(h),a=o,s=c),[t,r,i,n,a,s]})),o=new t.Box2;if(e.valid){var c=[{x:e.min.x,y:e.min.y},{x:e.max.x,y:e.min.y},{x:e.max.x,y:e.max.y},{x:e.min.x,y:e.max.y}];s.forEach((function(e){var t=r(e,6),i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5];c=c.map((function(e){return{x:e.x*i+e.y*a+o,y:e.x*n+e.y*s+l}}))})),o=c.reduce((function(e,t){return e.expandByPoint(t)}),new t.Box2)}return s.reverse(),s.forEach((function(e){var t=r(e,6),i=t[0],n=t[1],s=t[2],o=t[3],c=t[4],l=t[5];a+='<g transform="matrix('.concat(i," ").concat(n," ").concat(s," ").concat(o," ").concat(c," ").concat(l,')">')})),a+=i,s.forEach((function(e){a+="</g>"})),{bbox:o,element:a}}}(Oh),function(e){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.piecewiseToPaths=e.default=void 0;var r=lh,i=f(yh),n=f(va),a=f(Ch),s=f(Vn),o=f(Uh),c=f(Eh),l=function(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!==t(e)&&"function"!=typeof e)return{default:e};var i=h(r);if(i&&i.has(e))return i.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=a?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}n.default=e,i&&i.set(e,n);return n}(Th),u=f(Oh);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(h=function(e){return e?r:t})(e)}function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a,s,o=[],c=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(i=a.call(r)).done)&&(o.push(i.value),o.length!==t);c=!0);}catch(u){l=!0,n=u}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var m=function(e,t){var i=t.bbox,n=t.element;return-1===e.extrusionZ?{bbox:(new r.Box2).expandByPoint({x:-i.min.x,y:i.min.y}).expandByPoint({x:-i.max.x,y:i.max.y}),element:'<g transform="matrix(-1 0 0 1 0 0)">\n        '.concat(n,"\n      </g>")}:{bbox:i,element:n}},b=function(e){var t=(0,i.default)(e),n=t.reduce((function(e,t){var r=d(t,2),i=r[0],n=r[1];return e.expandByPoint({x:i,y:n})}),new r.Box2),a=t.reduce((function(e,t,r){return e+=0===r?"M":"L",e+=t[0]+","+t[1]}),"");return(0,u.default)(n,'<path d="'.concat(a,'" />'),e.transforms)},v=function(e,t,r,i,n,a,s,c){var l=Math.sqrt(r*r+i*i),u=n*l,h=-Math.atan2(-i,r),f=g(e,t,r,i,n,a,s);if(Math.abs(a-s)<1e-9||Math.abs(a-s+2*Math.PI)<1e-9)return{bbox:f,element:'<g transform="rotate('.concat(h/Math.PI*180," ").concat(e,", ").concat(t,')">\n      <ellipse cx="').concat(e,'" cy="').concat(t,'" rx="').concat(l,'" ry="').concat(u,'" />\n    </g>')};var d=(0,o.default)({x:Math.cos(a)*l,y:Math.sin(a)*u},h),p={x:e+d.x,y:t+d.y},m=(0,o.default)({x:Math.cos(s)*l,y:Math.sin(s)*u},h),b={x:e+m.x,y:t+m.y},v=(s<a?s+2*Math.PI:s)-a<Math.PI?0:1,y="M ".concat(p.x," ").concat(p.y," A ").concat(l," ").concat(u," ").concat(h/Math.PI*180," ").concat(v," 1 ").concat(b.x," ").concat(b.y);return{bbox:f,element:'<path d="'.concat(y,'" />')}},g=function(e,t,i,n,a,s,o,c){for(;s<0;)s+=2*Math.PI;for(;o<=s;)o+=2*Math.PI;var l=[];if(Math.abs(i)<1e-12||Math.abs(n)<1e-12)for(var u=0;u<4;u++)l.push(u/2*Math.PI);else l[0]=Math.atan(-n*a/i)-Math.PI,l[1]=Math.atan(i*a/n)-Math.PI,l[2]=l[0]-Math.PI,l[3]=l[1]-Math.PI;for(var h=4;h>=0;h--){for(;l[h]<s;)l[h]+=2*Math.PI;l[h]>o&&l.splice(h,1)}l.push(s),l.push(o);var f=l.map((function(e){return{x:Math.cos(e),y:Math.sin(e)}})),d=[[i,-n*a],[n,i*a]];return f.map((function(r){return{x:r.x*d[0][0]+r.y*d[0][1]+e,y:r.x*d[1][0]+r.y*d[1][1]+t}})).reduce((function(e,t){return e.expandByPoint(t),e}),new r.Box2)},y=function(e,t,r){for(var i=[],n=0,a=e;a<t.length-e+1;){var s=(0,l.multiplicity)(t,a),o=r.slice(n,n+e);4===e?i.push('<path d="M '.concat(o[0].x," ").concat(o[0].y," C ").concat(o[1].x," ").concat(o[1].y," ").concat(o[2].x," ").concat(o[2].y," ").concat(o[3].x," ").concat(o[3].y,'" />')):3===e&&i.push('<path d="M '.concat(o[0].x," ").concat(o[0].y," Q ").concat(o[1].x," ").concat(o[1].y," ").concat(o[2].x," ").concat(o[2].y,'" />')),n+=s,a+=s}return i};e.piecewiseToPaths=y;var _=function(e){switch(e.type){case"CIRCLE":return function(e){var t=(new r.Box2).expandByPoint({x:e.x+e.r,y:e.y+e.r}).expandByPoint({x:e.x-e.r,y:e.y-e.r}),i='<circle cx="'.concat(e.x,'" cy="').concat(e.y,'" r="').concat(e.r,'" />'),n=m(e,{bbox:t,element:i}),a=n.bbox,s=n.element;return(0,u.default)(a,s,e.transforms)}(e);case"ELLIPSE":return function(e){var t=v(e.x,e.y,e.majorX,e.majorY,e.axisRatio,e.startAngle,e.endAngle),r=t.bbox,i=t.element,n=m(e,{bbox:r,element:i}),a=n.bbox,s=n.element;return(0,u.default)(a,s,e.transforms)}(e);case"ARC":return function(e){var t=v(e.x,e.y,e.r,0,1,e.startAngle,e.endAngle,e.extrusionZ),r=t.bbox,i=t.element,n=m(e,{bbox:r,element:i}),a=n.bbox,s=n.element;return(0,u.default)(a,s,e.transforms)}(e);case"SPLINE":var t=e.weights&&e.weights.some((function(e){return 1!==e}));if(2!==e.degree&&3!==e.degree||t)return b(e);try{return function(e){var t=new r.Box2;e.controlPoints.forEach((function(e){t=t.expandByPoint(e)}));var i=e.degree+1,n=(0,l.default)(i,e.controlPoints,e.knots),a=y(i,n.knots,n.controlPoints),s="<g>".concat(a.join(""),"</g>");return(0,u.default)(t,s,e.transforms)}(e)}catch(i){return b(e)}case"LINE":case"LWPOLYLINE":case"POLYLINE":return b(e);default:return s.default.warn("entity type not supported in SVG rendering:",e.type),null}};e.default=function(e){var t=(0,n.default)(e).reduce((function(t,r,i){var n=(0,a.default)(e.tables.layers,r),s=_(r);if(s){var o=s.bbox,l=s.element;o.valid&&(t.bbox.expandByPoint(o.min),t.bbox.expandByPoint(o.max)),t.elements.push('<g stroke="'.concat((0,c.default)(n),'">').concat(l,"</g>"))}return t}),{bbox:new r.Box2,elements:[]}),i=t.bbox,s=t.elements,o=i.valid?{x:i.min.x,y:-i.max.y,width:i.max.x-i.min.x,height:i.max.y-i.min.y}:{x:0,y:0,width:0,height:0};return'<?xml version="1.0"?>\n<svg\n  xmlns="http://www.w3.org/2000/svg"\n  xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\n  preserveAspectRatio="xMinYMin meet"\n  viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'"\n  width="100%" height="100%"\n>\n  <g stroke="#000000" stroke-width="0.1%" fill="none" transform="matrix(1,0,0,-1,0,0)">\n    ').concat(s.join("\n"),"\n  </g>\n</svg>")}}(Sh);var Ph={};function Ah(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function Ih(e,t){for(var r,i="",n=0,a=-1,s=0,o=0;o<=e.length;++o){if(o<e.length)r=e.charCodeAt(o);else{if(47===r)break;r=47}if(47===r){if(a===o-1||1===s);else if(a!==o-1&&2===s){if(i.length<2||2!==n||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var c=i.lastIndexOf("/");if(c!==i.length-1){-1===c?(i="",n=0):n=(i=i.slice(0,c)).length-1-i.lastIndexOf("/"),a=o,s=0;continue}}else if(2===i.length||1===i.length){i="",n=0,a=o,s=0;continue}t&&(i.length>0?i+="/..":i="..",n=2)}else i.length>0?i+="/"+e.slice(a+1,o):i=e.slice(a+1,o),n=o-a-1;a=o,s=0}else 46===r&&-1!==s?++s:s=-1}return i}!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=o(Vn),r=o(Wn),i=o(va),n=o(Sh),a=o(ch),s=o(oh);function o(e){return e&&e.__esModule?e:{default:e}}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,u(i.key),i)}}function u(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==c(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}var h=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"!=typeof t)throw Error("Helper constructor expects a DXF string");this._contents=t,this._parsed=null,this._denormalised=null}var o,c,u;return o=e,(c=[{key:"parse",value:function(){return this._parsed=(0,r.default)(this._contents),t.default.info("parsed:",this.parsed),this._parsed}},{key:"parsed",get:function(){return null===this._parsed&&this.parse(),this._parsed}},{key:"denormalise",value:function(){return this._denormalised=(0,i.default)(this.parsed),t.default.info("denormalised:",this._denormalised),this._denormalised}},{key:"denormalised",get:function(){return this._denormalised||this.denormalise(),this._denormalised}},{key:"group",value:function(){this._groups=(0,s.default)(this.denormalised)}},{key:"groups",get:function(){return this._groups||this.group(),this._groups}},{key:"toSVG",value:function(){return(0,n.default)(this.parsed)}},{key:"toPolylines",value:function(){return(0,a.default)(this.parsed)}}])&&l(o.prototype,c),u&&l(o,u),Object.defineProperty(o,"prototype",{writable:!1}),e}();e.default=h}(Ph),function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Helper",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"colors",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"config",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"denormalise",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"groupEntitiesByLayer",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"parseString",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"toPolylines",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"toSVG",{enumerable:!0,get:function(){return s.default}});var t=l(Gn),r=l(Wn),i=l(va),n=l(oh),a=l(ch),s=l(Sh),o=l(gh),c=l(Ph);function l(e){return e&&e.__esModule?e:{default:e}}}(Hn);var Lh={resolve:function(){for(var e,t="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var n;i>=0?n=arguments[i]:(void 0===e&&(e=process.cwd()),n=e),Ah(n),0!==n.length&&(t=n+"/"+t,r=47===n.charCodeAt(0))}return t=Ih(t,!r),r?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(Ah(e),0===e.length)return".";var t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0!==(e=Ih(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Ah(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];Ah(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":Lh.normalize(e)},relative:function(e,t){if(Ah(e),Ah(t),e===t)return"";if((e=Lh.resolve(e))===(t=Lh.resolve(t)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var i=e.length,n=i-r,a=1;a<t.length&&47===t.charCodeAt(a);++a);for(var s=t.length-a,o=n<s?n:s,c=-1,l=0;l<=o;++l){if(l===o){if(s>o){if(47===t.charCodeAt(a+l))return t.slice(a+l+1);if(0===l)return t.slice(a+l)}else n>o&&(47===e.charCodeAt(r+l)?c=l:0===l&&(c=0));break}var u=e.charCodeAt(r+l);if(u!==t.charCodeAt(a+l))break;47===u&&(c=l)}var h="";for(l=r+c+1;l<=i;++l)l!==i&&47!==e.charCodeAt(l)||(0===h.length?h+="..":h+="/..");return h.length>0?h+t.slice(a+c):(a+=c,47===t.charCodeAt(a)&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(Ah(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,i=-1,n=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!n){i=a;break}}else n=!1;return-1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');Ah(e);var r,i=0,n=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,o=-1;for(r=e.length-1;r>=0;--r){var c=e.charCodeAt(r);if(47===c){if(!a){i=r+1;break}}else-1===o&&(a=!1,o=r+1),s>=0&&(c===t.charCodeAt(s)?-1==--s&&(n=r):(s=-1,n=o))}return i===n?n=o:-1===n&&(n=e.length),e.slice(i,n)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){i=r+1;break}}else-1===n&&(a=!1,n=r+1);return-1===n?"":e.slice(i,n)},extname:function(e){Ah(e);for(var t=-1,r=0,i=-1,n=!0,a=0,s=e.length-1;s>=0;--s){var o=e.charCodeAt(s);if(47!==o)-1===i&&(n=!1,i=s+1),46===o?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1);else if(!n){r=s+1;break}}return-1===t||-1===i||0===a||1===a&&t===i-1&&t===r+1?"":e.slice(t,i)},format:function(e){if(null===e||"object"!==_(e))throw new TypeError('The "pathObject" argument must be of type Object. Received type '+_(e));return function(e,t){var r=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+i:r+e+i:i}("/",e)},parse:function(e){Ah(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r,i=e.charCodeAt(0),n=47===i;n?(t.root="/",r=1):r=0;for(var a=-1,s=0,o=-1,c=!0,l=e.length-1,u=0;l>=r;--l)if(47!==(i=e.charCodeAt(l)))-1===o&&(c=!1,o=l+1),46===i?-1===a?a=l:1!==u&&(u=1):-1!==a&&(u=-1);else if(!c){s=l+1;break}return-1===a||-1===o||0===u||1===u&&a===o-1&&a===s+1?-1!==o&&(t.base=t.name=0===s&&n?e.slice(1,o):e.slice(s,o)):(0===s&&n?(t.name=e.slice(1,a),t.base=e.slice(1,o)):(t.name=e.slice(s,a),t.base=e.slice(s,o)),t.ext=e.slice(a,o)),s>0?t.dir=e.slice(0,s-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Lh.posix=Lh;var jh=Lh,Rh=["jpg","jpeg","gif","png","bmp","svg","dxf","webp"],Dh=function(){var e=arguments;return v(m().mark((function t(){var r,i,n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.length>0&&void 0!==e[0]?e[0]:Rh,null===(r=window.electron)||void 0===r||!r.openFileDialog){t.next=5;break}return t.abrupt("return",null===(n=window.electron)||void 0===n?void 0:n.openFileDialog({filters:[{name:"file",extensions:i}]}));case 5:return t.abrupt("return",Ue(i));case 6:case"end":return t.stop()}}),t)})))()},Bh=function(e){return v(m().mark((function t(){var r,i,n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=ot(e)?e:e.name,i=jh.extname(r).replace(".","").toLocaleLowerCase(),t.t0=i,t.next="png"===t.t0||"jpg"===t.t0||"jpeg"===t.t0||"bmp"===t.t0||"gif"===t.t0?5:"svg"===t.t0?9:"dxf"===t.t0?13:17;break;case 5:return t.next=7,zh(e);case 7:return n=t.sent,t.abrupt("break",20);case 9:return t.next=11,Gh(e);case 11:return n=t.sent,t.abrupt("break",20);case 13:return t.next=15,Wh(e);case 15:return n=t.sent,t.abrupt("break",20);case 17:return t.next=19,Gh(e);case 19:n=t.sent;case 20:return t.abrupt("return",n);case 21:case"end":return t.stop()}}),t)})))()},Fh=function(e,t){return v(m().mark((function r(){var i;return m().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,null===(i=window.electron)||void 0===i?void 0:i.FileHelper.write(e,t);case 2:case"end":return r.stop()}}),r)})))()},Nh=function(){var e=arguments;return v(m().mark((function t(){var r,i,n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.length>0&&void 0!==e[0]?e[0]:{},t.next=3,null===(r=window.electron)||void 0===r?void 0:r.showSaveDialog(i);case 3:return n=t.sent,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))()},zh=function(e){return new Promise(function(){var t=v(m().mark((function t(r,i){var n,a;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ot(e)){t.next=5;break}return t.next=3,Hh(e);case 3:n=t.sent,e=new Blob([n]);case 5:(a=new FileReader).onload=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result,a=new Image;a.src=n,a.onload=function(){URL.revokeObjectURL(a.src),r(a)},a.onerror=i},a.readAsDataURL(e);case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())},Hh=function(){var e=v(m().mark((function e(t){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gh(t,"arraybuffer"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Gh=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(ot(e)){var r,i=null===(r=window.electron)||void 0===r?void 0:r.FileHelper;return i?"text"===t?i.read2Str(e):i.read2Buffer(e):Promise.reject("read file error. path: ".concat(e))}return new Promise((function(r){var i=new FileReader;i.onload=function(){r(i.result)},"text"===t?i.readAsText(e):i.readAsArrayBuffer(e)}))},Wh=function(){var e=v(m().mark((function e(t){var r,i,n,a;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gh(t);case 2:return r=e.sent,i=new Hn.Helper(r),n=i.toSVG(),e.next=7,he.send({method:"preProcessPath",data:{svgStr:n}});case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Yh=K("files",{actions:{uploadFile:function(e){var t=this;return v(m().mark((function r(){var i,n;return m().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.openFileDialog(e);case 2:if(i=r.sent){r.next=5;break}return r.abrupt("return",{});case 5:return r.next=7,t.readFile(i);case 7:return n=r.sent,r.abrupt("return",{fileData:n,file:i});case 9:case"end":return r.stop()}}),r)})))()},openFileDialog:function(e){return Dh(e)},readFile:function(e){return Bh(e)},writeFile:function(e,t){return Fh(e,t)},showSaveDialog:function(){return Nh(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}}});var Xh,Vh=function(e){return e.RECT="RECT",e.CIRCLE="CIRCLE",e.LINE="LINE",e.TEXT="TEXT",e.NONE="NONE",e.PEN="PEN",e.TRIANGLE="TRIANGLE",e.SVG="SVG",e}(Vh||{}),qh=function(e){return e.MM="mm",e.INCH="in",e}(qh||{}),Zh=function(e){return e.auto="auto",e.default="default",e.none="none",e.initial="initial",e.inherit="inherit",e.contextMenu="context-menu",e.help="help",e.pointer="pointer",e.progress="progress",e.wait="wait",e.cell="cell",e.crosshair="crosshair",e.text="text",e.verticalText="vertical-text",e.alias="alias",e.copy="copy",e.move="move",e.noDrop="no-drop",e.notAllowed="not-allowed",e.allScroll="all-scroll",e.colResize="col-resize",e.rowResize="row-resize",e.nResize="n-resize",e.eResize="e-resize",e.sResize="s-resize",e.wResize="w-resize",e.neResize="ne-resize",e.nwResize="nw-resize",e.seResize="se-resize",e.swResize="sw-resize",e.ewResize="ew-resize",e.nsResize="ns-resize",e.neswResize="nesw-resize",e.nwseResize="nwse-resize",e.zoomIn="zoom-in",e.zoomOut="zoom-out",e.grab="grab",e.grabbing="grabbing",e}(Zh||{}),Kh=function(e){return e.engrave="engrave",e.fillEngrave="fillEngrave",e.cut="cut",e}(Kh||{}),Jh=(g(Ne={},"engrave","orange"),g(Ne,"fillEngrave","#17489C"),g(Ne,"cut","#E61F19"),g(Ne,"variableThickness","#00FF00"),Ne),Qh="element",$h={name:Qh,strokeWidth:1,stroke:Jh.engrave,fill:void 0,strokeUniform:!0,isLock:!1},ef=function(e){return e.SELECTION_CHANGE="SELECTION_CHANGE",e.ELEMENT_MODIFY="ELEMENT_MODIFY",e.SELECTION_CLEAR="SELECTION_CLEAR",e.STAGE_MOVE="CANVAS_MOVE",e.ZOOM="ZOOM",e.RESIZE="RESIZE",e.OPERATE="OPERATE",e.MOUSE_DOWN="MOUSE_DOWN",e.MOUSE_MOVE="MOUSE_MOVE",e.ZOOM_IN="ZOOM_IN",e.ZOOM_OUT="ZOOM_OUT",e.MOUSE_UP="MOUSE_UP",e.LOCK="LOCK",e.UPDATE_ELEMENT_PROPERTY="UPDATE_ELEMENT_PROPERTY",e.ADDED="ADDED",e.REMOVED="REMOVED",e.PROPERTYMANAGER="PROPERTYMANAGER",e}(ef||{}),tf=function(e){return e.LEFT="LEFT",e.RIGHT="RIGHT",e.UP="UP",e.DOWN="DOWN",e.XCENTER="XCENTER",e.YCENTER="YCENTER",e.HCENTER="HCENTER",e.VCENTER="VCENTER",e}(tf||{}),rf=function(e){return e.rect="rect",e.line="line",e.circle="circle",e.ellipse="ellipse",e.IText="i-text",e.Text="text",e.path="path",e.polygon="polygon",e.image="image",e.group="group",e}(rf||{}),nf=["id","left","top","width","height","angle","fill","flipX","flipY","scaleX","scaleY","skewX","skewY","stroke","strokeWidth","type","name","strokeUniform","isLock","originStroke","hasBezierControl","isVariableThickness"],af={hoverBorderColor:"#1dd2ca",borderColor:Jh.engrave},sf="activeSelection",of={exports:{}},cf="object"===("undefined"==typeof Reflect?"undefined":_(Reflect))?Reflect:null,lf=cf&&"function"==typeof cf.apply?cf.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};Xh=cf&&"function"==typeof cf.ownKeys?cf.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var uf=Number.isNaN||function(e){return e!=e};function hf(){hf.init.call(this)}of.exports=hf,of.exports.once=function(e,t){return new Promise((function(r,i){function n(r){e.removeListener(t,a),i(r)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}wf(e,t,a,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&wf(e,"error",t,r)}(e,n,{once:!0})}))},hf.EventEmitter=hf,hf.prototype._events=void 0,hf.prototype._eventsCount=0,hf.prototype._maxListeners=void 0;var ff=10;function df(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+_(e))}function pf(e){return void 0===e._maxListeners?hf.defaultMaxListeners:e._maxListeners}function mf(e,t,r,i){var n,a,s,o;if(df(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]),void 0===s)s=a[t]=r,++e._eventsCount;else if("function"==typeof s?s=a[t]=i?[r,s]:[s,r]:i?s.unshift(r):s.push(r),(n=pf(e))>0&&s.length>n&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,o=c,console&&console.warn&&console.warn(o)}return e}function bf(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function vf(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=bf.bind(i);return n.listener=r,i.wrapFn=n,n}function gf(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):_f(n,n.length)}function yf(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function _f(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}function wf(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+_(e));e.addEventListener(t,(function n(a){i.once&&e.removeEventListener(t,n),r(a)}))}}Object.defineProperty(hf,"defaultMaxListeners",{enumerable:!0,get:function(){return ff},set:function(e){if("number"!=typeof e||e<0||uf(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ff=e}}),hf.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},hf.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||uf(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},hf.prototype.getMaxListeners=function(){return pf(this)},hf.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,n=this._events;if(void 0!==n)i=i&&void 0===n.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var o=n[e];if(void 0===o)return!1;if("function"==typeof o)lf(o,this,t);else{var c=o.length,l=_f(o,c);for(r=0;r<c;++r)lf(l[r],this,t)}return!0},hf.prototype.addListener=function(e,t){return mf(this,e,t,!1)},hf.prototype.on=hf.prototype.addListener,hf.prototype.prependListener=function(e,t){return mf(this,e,t,!0)},hf.prototype.once=function(e,t){return df(t),this.on(e,vf(this,e,t)),this},hf.prototype.prependOnceListener=function(e,t){return df(t),this.prependListener(e,vf(this,e,t)),this},hf.prototype.removeListener=function(e,t){var r,i,n,a,s;if(df(t),void 0===(i=this._events))return this;if(void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,n=a;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},hf.prototype.off=hf.prototype.removeListener,hf.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,a=Object.keys(r);for(i=0;i<a.length;++i)"removeListener"!==(n=a[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},hf.prototype.listeners=function(e){return gf(this,e,!0)},hf.prototype.rawListeners=function(e){return gf(this,e,!1)},hf.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):yf.call(e,t)},hf.prototype.listenerCount=yf,hf.prototype.eventNames=function(){return this._eventsCount>0?Xh(this._events):[]};var xf=of.exports,kf={},Sf=Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})),Cf=ge(Sf);!function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t,r,i,n,a,s,o,c,l,u,h,f,d,p,m,b,v,g,y,w,x,k=k||{version:"5.3.0"};if(e.fabric=k,"undefined"!=typeof document&&"undefined"!=typeof window)document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?k.document=document:k.document=document.implementation.createHTMLDocument(""),k.window=window;else{var S=new Cf.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;k.document=S.document,k.jsdomImplForWrapper=Cf.implForWrapper,k.nodeCanvas=Cf.Canvas,k.window=S,DOMParser=k.window.DOMParser}function C(e,t){var r=e.canvas,i=t.targetCanvas,n=i.getContext("2d");n.translate(0,i.height),n.scale(1,-1);var a=r.height-i.height;n.drawImage(r,0,a,i.width,i.height,0,0,i.width,i.height)}function U(e,t){var r=t.targetCanvas.getContext("2d"),i=t.destinationWidth,n=t.destinationHeight,a=i*n*4,s=new Uint8Array(this.imageBuffer,0,a),o=new Uint8ClampedArray(this.imageBuffer,0,a);e.readPixels(0,0,i,n,e.RGBA,e.UNSIGNED_BYTE,s);var c=new ImageData(o,i,n);r.putImageData(c,0,0)}k.isTouchSupported="ontouchstart"in k.window||"ontouchstart"in k.document||k.window&&k.window.navigator&&k.window.navigator.maxTouchPoints>0,k.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,k.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],k.DPI=96,k.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",k.commaWsp="(?:\\s+,?\\s*|,\\s*)",k.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,k.reNonWord=/[ \n\.,;!\?\-]/,k.fontPaths={},k.iMatrix=[1,0,0,1,0,0],k.svgNS="http://www.w3.org/2000/svg",k.perfLimitSizeTotal=2097152,k.maxCacheSideLimit=4096,k.minCacheSideLimit=256,k.charWidthsCache={},k.textureSize=2048,k.disableStyleCopyPaste=!1,k.enableGLFiltering=!0,k.devicePixelRatio=k.window.devicePixelRatio||k.window.webkitDevicePixelRatio||k.window.mozDevicePixelRatio||1,k.browserShadowBlurConstant=1,k.arcToSegmentsCache={},k.boundsOfCurveCache={},k.cachesBoundsOfCurve=!0,k.forceGLPutImageData=!1,k.initFilterBackend=function(){return k.enableGLFiltering&&k.isWebglSupported&&k.isWebglSupported(k.textureSize)?(console.log("max texture size: "+k.maxTextureSize),new k.WebglFilterBackend({tileSize:k.textureSize})):k.Canvas2dFilterBackend?new k.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=k),function(){function e(e,t){if(this.__eventListeners[e]){var r=this.__eventListeners[e];t?r[r.indexOf(t)]=!1:k.util.array.fill(r,!1)}}function t(e,t){var r=function(){t.apply(this,arguments),this.off(e,r)}.bind(this);this.on(e,r)}k.Observable={fire:function(e,t){if(!this.__eventListeners)return this;var r=this.__eventListeners[e];if(!r)return this;for(var i=0,n=r.length;i<n;i++)r[i]&&r[i].call(this,t||{});return this.__eventListeners[e]=r.filter((function(e){return!1!==e})),this},on:function(e,t){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var r in e)this.on(r,e[r]);else this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(t);return this},once:function(e,r){if(1===arguments.length)for(var i in e)t.call(this,i,e[i]);else t.call(this,e,r);return this},off:function(t,r){if(!this.__eventListeners)return this;if(0===arguments.length)for(t in this.__eventListeners)e.call(this,t);else if(1===arguments.length&&"object"===_(arguments[0]))for(var i in t)e.call(this,i,t[i]);else e.call(this,t,r);return this}}}(),k.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var e=0,t=arguments.length;e<t;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(e,t,r){var i=this._objects;return r?i[t]=e:i.splice(t,0,e),this._onObjectAdded&&this._onObjectAdded(e),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var e,t=this._objects,r=!1,i=0,n=arguments.length;i<n;i++)-1!==(e=t.indexOf(arguments[i]))&&(r=!0,t.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&r&&this.requestRenderAll(),this},forEachObject:function(e,t){for(var r=this.getObjects(),i=0,n=r.length;i<n;i++)e.call(t,r[i],i,r);return this},getObjects:function(e){return void 0===e?this._objects.concat():this._objects.filter((function(t){return t.type===e}))},item:function(e){return this._objects[e]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(e,t){return this._objects.indexOf(e)>-1||!!t&&this._objects.some((function(t){return"function"==typeof t.contains&&t.contains(e,!0)}))},complexity:function(){return this._objects.reduce((function(e,t){return e+=t.complexity?t.complexity():0}),0)}},k.CommonMethods={_setOptions:function(e){for(var t in e)this.set(t,e[t])},_initGradient:function(e,t){!e||!e.colorStops||e instanceof k.Gradient||this.set(t,new k.Gradient(e))},_initPattern:function(e,t,r){!e||!e.source||e instanceof k.Pattern?r&&r():this.set(t,new k.Pattern(e,r))},_setObject:function(e){for(var t in e)this._set(t,e[t])},set:function(e,t){return"object"===_(e)?this._setObject(e):this._set(e,t),this},_set:function(e,t){this[e]=t},toggle:function(e){var t=this.get(e);return"boolean"==typeof t&&this.set(e,!t),this},get:function(e){return this[e]}},t=e,r=Math.sqrt,i=Math.atan2,n=Math.pow,a=Math.PI/180,s=Math.PI/2,k.util={cos:function(e){if(0===e)return 1;switch(e<0&&(e=-e),e/s){case 1:case 3:return 0;case 2:return-1}return Math.cos(e)},sin:function(e){if(0===e)return 0;var t=1;switch(e<0&&(t=-1),e/s){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(e)},removeFromArray:function(e,t){var r=e.indexOf(t);return-1!==r&&e.splice(r,1),e},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},degreesToRadians:function(e){return e*a},radiansToDegrees:function(e){return e/a},rotatePoint:function(e,t,r){var i=new k.Point(e.x-t.x,e.y-t.y),n=k.util.rotateVector(i,r);return new k.Point(n.x,n.y).addEquals(t)},rotateVector:function(e,t){var r=k.util.sin(t),i=k.util.cos(t);return{x:e.x*i-e.y*r,y:e.x*r+e.y*i}},createVector:function(e,t){return new k.Point(t.x-e.x,t.y-e.y)},calcAngleBetweenVectors:function(e,t){return Math.acos((e.x*t.x+e.y*t.y)/(Math.hypot(e.x,e.y)*Math.hypot(t.x,t.y)))},getHatVector:function(e){return new k.Point(e.x,e.y).multiply(1/Math.hypot(e.x,e.y))},getBisector:function(e,t,r){var i=k.util.createVector(e,t),n=k.util.createVector(e,r),a=k.util.calcAngleBetweenVectors(i,n),s=a*(0===k.util.calcAngleBetweenVectors(k.util.rotateVector(i,a),n)?1:-1)/2;return{vector:k.util.getHatVector(k.util.rotateVector(i,s)),angle:a}},projectStrokeOnPoints:function(e,t,r){var i=[],n=t.strokeWidth/2,a=t.strokeUniform?new k.Point(1/t.scaleX,1/t.scaleY):new k.Point(1,1),s=function(e){var t=n/Math.hypot(e.x,e.y);return new k.Point(e.x*t*a.x,e.y*t*a.y)};return e.length<=1||e.forEach((function(o,c){var l,u,h=new k.Point(o.x,o.y);0===c?(u=e[c+1],l=r?s(k.util.createVector(u,h)).addEquals(h):e[e.length-1]):c===e.length-1?(l=e[c-1],u=r?s(k.util.createVector(l,h)).addEquals(h):e[0]):(l=e[c-1],u=e[c+1]);var f,d,p=k.util.getBisector(h,l,u),m=p.vector,b=p.angle;if("miter"===t.strokeLineJoin&&(f=-n/Math.sin(b/2),d=new k.Point(m.x*f*a.x,m.y*f*a.y),Math.hypot(d.x,d.y)/n<=t.strokeMiterLimit))return i.push(h.add(d)),void i.push(h.subtract(d));f=-n*Math.SQRT2,d=new k.Point(m.x*f*a.x,m.y*f*a.y),i.push(h.add(d)),i.push(h.subtract(d))})),i},transformPoint:function(e,t,r){return r?new k.Point(t[0]*e.x+t[2]*e.y,t[1]*e.x+t[3]*e.y):new k.Point(t[0]*e.x+t[2]*e.y+t[4],t[1]*e.x+t[3]*e.y+t[5])},makeBoundingBoxFromPoints:function(e,t){if(t)for(var r=0;r<e.length;r++)e[r]=k.util.transformPoint(e[r],t);var i=[e[0].x,e[1].x,e[2].x,e[3].x],n=k.util.array.min(i),a=k.util.array.max(i)-n,s=[e[0].y,e[1].y,e[2].y,e[3].y],o=k.util.array.min(s);return{left:n,top:o,width:a,height:k.util.array.max(s)-o}},invertTransform:function(e){var t=1/(e[0]*e[3]-e[1]*e[2]),r=[t*e[3],-t*e[1],-t*e[2],t*e[0]],i=k.util.transformPoint({x:e[4],y:e[5]},r,!0);return r[4]=-i.x,r[5]=-i.y,r},toFixed:function(e,t){return parseFloat(Number(e).toFixed(t))},parseUnit:function(e,t){var r=/\D{0,2}$/.exec(e),i=parseFloat(e);switch(t||(t=k.Text.DEFAULT_SVG_FONT_SIZE),r[0]){case"mm":return i*k.DPI/25.4;case"cm":return i*k.DPI/2.54;case"in":return i*k.DPI;case"pt":return i*k.DPI/72;case"pc":return i*k.DPI/72*12;case"em":return i*t;default:return i}},falseFunction:function(){return!1},getKlass:function(e,t){return e=k.util.string.camelize(e.charAt(0).toUpperCase()+e.slice(1)),k.util.resolveNamespace(t)[e]},getSvgAttributes:function(e){var t=["instantiated_by_use","style","id","class"];switch(e){case"linearGradient":t=t.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":t=t.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":t=t.concat(["offset","stop-color","stop-opacity"])}return t},resolveNamespace:function(e){if(!e)return k;var r,i=e.split("."),n=i.length,a=t||k.window;for(r=0;r<n;++r)a=a[i[r]];return a},loadImage:function(e,t,r,i){if(e){var n=k.util.createImage(),a=function(){t&&t.call(r,n,!1),n=n.onload=n.onerror=null};n.onload=a,n.onerror=function(){k.log("Error loading "+n.src),t&&t.call(r,null,!0),n=n.onload=n.onerror=null},0!==e.indexOf("data")&&null!=i&&(n.crossOrigin=i),"data:image/svg"===e.substring(0,14)&&(n.onload=null,k.util.loadImageInDom(n,a)),n.src=e}else t&&t.call(r,e)},loadImageInDom:function(e,t){var r=k.document.createElement("div");r.style.width=r.style.height="1px",r.style.left=r.style.top="-100%",r.style.position="absolute",r.appendChild(e),k.document.querySelector("body").appendChild(r),e.onload=function(){t(),r.parentNode.removeChild(r),r=null}},enlivenObjects:function(e,t,r,i){var n=[],a=0,s=(e=e||[]).length;function o(){++a===s&&t&&t(n.filter((function(e){return e})))}s?e.forEach((function(e,t){e&&e.type?k.util.getKlass(e.type,r).fromObject(e,(function(r,a){a||(n[t]=r),i&&i(e,r,a),o()})):o()})):t&&t(n)},enlivenObjectEnlivables:function(e,t,r){var i=k.Object.ENLIVEN_PROPS.filter((function(t){return!!e[t]}));k.util.enlivenObjects(i.map((function(t){return e[t]})),(function(e){var n={};i.forEach((function(r,i){n[r]=e[i],t&&(t[r]=e[i])})),r&&r(n)}))},enlivenPatterns:function(e,t){function r(){++n===a&&t&&t(i)}var i=[],n=0,a=(e=e||[]).length;a?e.forEach((function(e,t){e&&e.source?new k.Pattern(e,(function(e){i[t]=e,r()})):(i[t]=e,r())})):t&&t(i)},groupSVGElements:function(e,t,r){var i;return e&&1===e.length?(void 0!==r&&(e[0].sourcePath=r),e[0]):(t&&(t.width&&t.height?t.centerPoint={x:t.width/2,y:t.height/2}:(delete t.width,delete t.height)),i=new k.Group(e,t),void 0!==r&&(i.sourcePath=r),i)},populateWithProperties:function(e,t,r){if(r&&Array.isArray(r))for(var i=0,n=r.length;i<n;i++)r[i]in e&&(t[r[i]]=e[r[i]])},createCanvasElement:function(){return k.document.createElement("canvas")},copyCanvasElement:function(e){var t=k.util.createCanvasElement();return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t},toDataURL:function(e,t,r){return e.toDataURL("image/"+t,r)},createImage:function(){return k.document.createElement("img")},multiplyTransformMatrices:function(e,t,r){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],r?0:e[0]*t[4]+e[2]*t[5]+e[4],r?0:e[1]*t[4]+e[3]*t[5]+e[5]]},qrDecompose:function(e){var t=i(e[1],e[0]),s=n(e[0],2)+n(e[1],2),o=r(s),c=(e[0]*e[3]-e[2]*e[1])/o,l=i(e[0]*e[2]+e[1]*e[3],s);return{angle:t/a,scaleX:o,scaleY:c,skewX:l/a,skewY:0,translateX:e[4],translateY:e[5]}},calcRotateMatrix:function(e){if(!e.angle)return k.iMatrix.concat();var t=k.util.degreesToRadians(e.angle),r=k.util.cos(t),i=k.util.sin(t);return[r,i,-i,r,0,0]},calcDimensionsMatrix:function(e){var t=void 0===e.scaleX?1:e.scaleX,r=void 0===e.scaleY?1:e.scaleY,i=[e.flipX?-t:t,0,0,e.flipY?-r:r,0,0],n=k.util.multiplyTransformMatrices,a=k.util.degreesToRadians;return e.skewX&&(i=n(i,[1,0,Math.tan(a(e.skewX)),1],!0)),e.skewY&&(i=n(i,[1,Math.tan(a(e.skewY)),0,1],!0)),i},composeMatrix:function(e){var t=[1,0,0,1,e.translateX||0,e.translateY||0],r=k.util.multiplyTransformMatrices;return e.angle&&(t=r(t,k.util.calcRotateMatrix(e))),(1!==e.scaleX||1!==e.scaleY||e.skewX||e.skewY||e.flipX||e.flipY)&&(t=r(t,k.util.calcDimensionsMatrix(e))),t},resetObjectTransform:function(e){e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)},saveObjectTransform:function(e){return{scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,angle:e.angle,left:e.left,flipX:e.flipX,flipY:e.flipY,top:e.top}},isTransparent:function(e,t,r,i){i>0&&(t>i?t-=i:t=0,r>i?r-=i:r=0);var n,a=!0,s=e.getImageData(t,r,2*i||1,2*i||1),o=s.data.length;for(n=3;n<o&&!1!=(a=s.data[n]<=0);n+=4);return s=null,a},parsePreserveAspectRatioAttribute:function(e){var t,r="meet",i=e.split(" ");return i&&i.length&&("meet"!==(r=i.pop())&&"slice"!==r?(t=r,r="meet"):i.length&&(t=i.pop())),{meetOrSlice:r,alignX:"none"!==t?t.slice(1,4):"none",alignY:"none"!==t?t.slice(5,8):"none"}},clearFabricFontCache:function(e){(e=(e||"").toLowerCase())?k.charWidthsCache[e]&&delete k.charWidthsCache[e]:k.charWidthsCache={}},limitDimsByArea:function(e,t){var r=Math.sqrt(t*e),i=Math.floor(t/r);return{x:Math.floor(r),y:i}},capValue:function(e,t,r){return Math.max(e,Math.min(t,r))},findScaleToFit:function(e,t){return Math.min(t.width/e.width,t.height/e.height)},findScaleToCover:function(e,t){return Math.max(t.width/e.width,t.height/e.height)},matrixToSVG:function(e){return"matrix("+e.map((function(e){return k.util.toFixed(e,k.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"},removeTransformFromObject:function(e,t){var r=k.util.invertTransform(t),i=k.util.multiplyTransformMatrices(r,e.calcOwnMatrix());k.util.applyTransformToObject(e,i)},addTransformToObject:function(e,t){k.util.applyTransformToObject(e,k.util.multiplyTransformMatrices(t,e.calcOwnMatrix()))},applyTransformToObject:function(e,t){var r=k.util.qrDecompose(t),i=new k.Point(r.translateX,r.translateY);e.flipX=!1,e.flipY=!1,e.set("scaleX",r.scaleX),e.set("scaleY",r.scaleY),e.skewX=r.skewX,e.skewY=r.skewY,e.angle=r.angle,e.setPositionByOrigin(i,"center","center")},sizeAfterTransform:function(e,t,r){var i=e/2,n=t/2,a=[{x:-i,y:-n},{x:i,y:-n},{x:-i,y:n},{x:i,y:n}],s=k.util.calcDimensionsMatrix(r),o=k.util.makeBoundingBoxFromPoints(a,s);return{x:o.width,y:o.height}},mergeClipPaths:function(e,t){var r=e,i=t;r.inverted&&!i.inverted&&(r=t,i=e),k.util.applyTransformToObject(i,k.util.multiplyTransformMatrices(k.util.invertTransform(r.calcTransformMatrix()),i.calcTransformMatrix()));var n=r.inverted&&i.inverted;return n&&(r.inverted=i.inverted=!1),new k.Group([r],{clipPath:i,inverted:n})},hasStyleChanged:function(e,t,r){return r=r||!1,e.fill!==t.fill||e.stroke!==t.stroke||e.strokeWidth!==t.strokeWidth||e.fontSize!==t.fontSize||e.fontFamily!==t.fontFamily||e.fontWeight!==t.fontWeight||e.fontStyle!==t.fontStyle||e.textBackgroundColor!==t.textBackgroundColor||e.deltaY!==t.deltaY||r&&(e.overline!==t.overline||e.underline!==t.underline||e.linethrough!==t.linethrough)},stylesToArray:function(e,t){e=k.util.object.clone(e,!0);for(var r=t.split("\n"),i=-1,n={},a=[],s=0;s<r.length;s++)if(e[s])for(var o=0;o<r[s].length;o++){i++;var c=e[s][o];c&&Object.keys(c).length>0&&(k.util.hasStyleChanged(n,c,!0)?a.push({start:i,end:i+1,style:c}):a[a.length-1].end++),n=c||{}}else i+=r[s].length;return a},stylesFromArray:function(e,t){if(!Array.isArray(e))return e;for(var r=t.split("\n"),i=-1,n=0,a={},s=0;s<r.length;s++)for(var o=0;o<r[s].length;o++)i++,e[n]&&e[n].start<=i&&i<e[n].end&&(a[s]=a[s]||{},a[s][o]=Object.assign({},e[n].style),i===e[n].end-1&&n++);return a}},function(){var e=Array.prototype.join,t={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},r={m:"l",M:"L"};function i(e,t,r,i,n,a,s,o,c,l,u){var h=k.util.cos(e),f=k.util.sin(e),d=k.util.cos(t),p=k.util.sin(t),m=r*n*d-i*a*p+s,b=i*n*d+r*a*p+o;return["C",l+c*(-r*n*f-i*a*h),u+c*(-i*n*f+r*a*h),m+c*(r*n*p+i*a*d),b+c*(i*n*p-r*a*d),m,b]}function n(e,t,r,i){var n=Math.atan2(t,e),a=Math.atan2(i,r);return a>=n?a-n:2*Math.PI-(n-a)}function a(e,t,r){for(var a=r[1],s=r[2],o=r[3],c=r[4],l=r[5],u=function(e,t,r,a,s,o,c){var l=Math.PI,u=c*l/180,h=k.util.sin(u),f=k.util.cos(u),d=0,p=0,m=-f*e*.5-h*t*.5,b=-f*t*.5+h*e*.5,v=(r=Math.abs(r))*r,g=(a=Math.abs(a))*a,y=b*b,_=m*m,w=v*g-v*y-g*_,x=0;if(w<0){var S=Math.sqrt(1-w/(v*g));r*=S,a*=S}else x=(s===o?-1:1)*Math.sqrt(w/(v*y+g*_));var C=x*r*b/a,U=-x*a*m/r,E=f*C-h*U+.5*e,T=h*C+f*U+.5*t,M=n(1,0,(m-C)/r,(b-U)/a),O=n((m-C)/r,(b-U)/a,(-m-C)/r,(-b-U)/a);0===o&&O>0?O-=2*l:1===o&&O<0&&(O+=2*l);for(var P=Math.ceil(Math.abs(O/l*2)),A=[],I=O/P,L=8/3*Math.sin(I/4)*Math.sin(I/4)/Math.sin(I/2),j=M+I,R=0;R<P;R++)A[R]=i(M,j,f,h,r,a,E,T,L,d,p),d=A[R][5],p=A[R][6],M=j,j+=I;return A}(r[6]-e,r[7]-t,a,s,c,l,o),h=0,f=u.length;h<f;h++)u[h][1]+=e,u[h][2]+=t,u[h][3]+=e,u[h][4]+=t,u[h][5]+=e,u[h][6]+=t;return u}function s(e,t,r,i){return Math.sqrt((r-e)*(r-e)+(i-t)*(i-t))}function o(e,t,r,i,n,a,s,o){return function(c){var l,u=(l=c)*l*l,h=function(e){return 3*e*e*(1-e)}(c),f=function(e){return 3*e*(1-e)*(1-e)}(c),d=function(e){return(1-e)*(1-e)*(1-e)}(c);return{x:s*u+n*h+r*f+e*d,y:o*u+a*h+i*f+t*d}}}function c(e,t,r,i,n,a,s,o){return function(c){var l=1-c,u=3*l*l*(r-e)+6*l*c*(n-r)+3*c*c*(s-n),h=3*l*l*(i-t)+6*l*c*(a-i)+3*c*c*(o-a);return Math.atan2(h,u)}}function l(e,t,r,i,n,a){return function(s){var o,c=(o=s)*o,l=function(e){return 2*e*(1-e)}(s),u=function(e){return(1-e)*(1-e)}(s);return{x:n*c+r*l+e*u,y:a*c+i*l+t*u}}}function u(e,t,r,i,n,a){return function(s){var o=1-s,c=2*o*(r-e)+2*s*(n-r),l=2*o*(i-t)+2*s*(a-i);return Math.atan2(l,c)}}function h(e,t,r){var i,n,a={x:t,y:r},o=0;for(n=1;n<=100;n+=1)i=e(n/100),o+=s(a.x,a.y,i.x,i.y),a=i;return o}function f(e,t){for(var r,i,n,a=0,o=0,c=e.iterator,l={x:e.x,y:e.y},u=.01,h=e.angleFinder;o<t&&u>1e-4;)r=c(a),n=a,(i=s(l.x,l.y,r.x,r.y))+o>t?(a-=u,u/=2):(l=r,a+=u,o+=i);return r.angle=h(n),r}function d(e){for(var t,r,i,n,a=0,f=e.length,d=0,p=0,m=0,b=0,v=[],g=0;g<f;g++){switch(i={x:d,y:p,command:(t=e[g])[0]},t[0]){case"M":i.length=0,m=d=t[1],b=p=t[2];break;case"L":i.length=s(d,p,t[1],t[2]),d=t[1],p=t[2];break;case"C":r=o(d,p,t[1],t[2],t[3],t[4],t[5],t[6]),n=c(d,p,t[1],t[2],t[3],t[4],t[5],t[6]),i.iterator=r,i.angleFinder=n,i.length=h(r,d,p),d=t[5],p=t[6];break;case"Q":r=l(d,p,t[1],t[2],t[3],t[4]),n=u(d,p,t[1],t[2],t[3],t[4]),i.iterator=r,i.angleFinder=n,i.length=h(r,d,p),d=t[3],p=t[4];break;case"Z":case"z":i.destX=m,i.destY=b,i.length=s(d,p,m,b),d=m,p=b}a+=i.length,v.push(i)}return v.push({length:a,x:d,y:p}),v}k.util.joinPath=function(e){return e.map((function(e){return e.join(" ")})).join(" ")},k.util.parsePath=function(e){var i,n,a,s,o,c=[],l=[],u=k.rePathCommand,h="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",f="("+h+")"+k.commaWsp,d="([01])"+k.commaWsp+"?",p=new RegExp(f+"?"+f+"?"+f+d+d+f+"?("+h+")","g");if(!e||!e.match)return c;for(var m,b=0,v=(o=e.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;b<v;b++){s=(i=o[b]).slice(1).trim(),l.length=0;var g=i.charAt(0);if(m=[g],"a"===g.toLowerCase())for(var y;y=p.exec(s);)for(var _=1;_<y.length;_++)l.push(y[_]);else for(;a=u.exec(s);)l.push(a[0]);_=0;for(var w=l.length;_<w;_++)n=parseFloat(l[_]),isNaN(n)||m.push(n);var x=t[g.toLowerCase()],S=r[g]||g;if(m.length-1>x)for(var C=1,U=m.length;C<U;C+=x)c.push([g].concat(m.slice(C,C+x))),g=S;else c.push(m)}return c},k.util.makePathSimpler=function(e){var t,r,i,n,s,o,c=0,l=0,u=e.length,h=0,f=0,d=[];for(r=0;r<u;++r){switch(i=!1,(t=e[r].slice(0))[0]){case"l":t[0]="L",t[1]+=c,t[2]+=l;case"L":c=t[1],l=t[2];break;case"h":t[1]+=c;case"H":t[0]="L",t[2]=l,c=t[1];break;case"v":t[1]+=l;case"V":t[0]="L",l=t[1],t[1]=c,t[2]=l;break;case"m":t[0]="M",t[1]+=c,t[2]+=l;case"M":c=t[1],l=t[2],h=t[1],f=t[2];break;case"c":t[0]="C",t[1]+=c,t[2]+=l,t[3]+=c,t[4]+=l,t[5]+=c,t[6]+=l;case"C":s=t[3],o=t[4],c=t[5],l=t[6];break;case"s":t[0]="S",t[1]+=c,t[2]+=l,t[3]+=c,t[4]+=l;case"S":"C"===n?(s=2*c-s,o=2*l-o):(s=c,o=l),c=t[3],l=t[4],t[0]="C",t[5]=t[3],t[6]=t[4],t[3]=t[1],t[4]=t[2],t[1]=s,t[2]=o,s=t[3],o=t[4];break;case"q":t[0]="Q",t[1]+=c,t[2]+=l,t[3]+=c,t[4]+=l;case"Q":s=t[1],o=t[2],c=t[3],l=t[4];break;case"t":t[0]="T",t[1]+=c,t[2]+=l;case"T":"Q"===n?(s=2*c-s,o=2*l-o):(s=c,o=l),t[0]="Q",c=t[1],l=t[2],t[1]=s,t[2]=o,t[3]=c,t[4]=l;break;case"a":t[0]="A",t[6]+=c,t[7]+=l;case"A":i=!0,d=d.concat(a(c,l,t)),c=t[6],l=t[7];break;case"z":case"Z":c=h,l=f}i||d.push(t),n=t[0]}return d},k.util.getSmoothPathFromPoints=function(e,t){var r,i=[],n=new k.Point(e[0].x,e[0].y),a=new k.Point(e[1].x,e[1].y),s=e.length,o=1,c=0,l=s>2;for(t=t||0,l&&(o=e[2].x<a.x?-1:e[2].x===a.x?0:1,c=e[2].y<a.y?-1:e[2].y===a.y?0:1),i.push(["M",n.x-o*t,n.y-c*t]),r=1;r<s;r++){if(!n.eq(a)){var u=n.midPointFrom(a);i.push(["Q",n.x,n.y,u.x,u.y])}n=e[r],r+1<e.length&&(a=e[r+1])}return l&&(o=n.x>e[r-2].x?1:n.x===e[r-2].x?0:-1,c=n.y>e[r-2].y?1:n.y===e[r-2].y?0:-1),i.push(["L",n.x+o*t,n.y+c*t]),i},k.util.getPathSegmentsInfo=d,k.util.getBoundsOfCurve=function(t,r,i,n,a,s,o,c){var l;if(k.cachesBoundsOfCurve&&(l=e.call(arguments),k.boundsOfCurveCache[l]))return k.boundsOfCurveCache[l];var u,h,f,d,p,m,b,v,g=Math.sqrt,y=Math.min,_=Math.max,w=Math.abs,x=[],S=[[],[]];h=6*t-12*i+6*a,u=-3*t+9*i-9*a+3*o,f=3*i-3*t;for(var C=0;C<2;++C)if(C>0&&(h=6*r-12*n+6*s,u=-3*r+9*n-9*s+3*c,f=3*n-3*r),w(u)<1e-12){if(w(h)<1e-12)continue;0<(d=-f/h)&&d<1&&x.push(d)}else(b=h*h-4*f*u)<0||(0<(p=(-h+(v=g(b)))/(2*u))&&p<1&&x.push(p),0<(m=(-h-v)/(2*u))&&m<1&&x.push(m));for(var U,E,T,M=x.length,O=M;M--;)U=(T=1-(d=x[M]))*T*T*t+3*T*T*d*i+3*T*d*d*a+d*d*d*o,S[0][M]=U,E=T*T*T*r+3*T*T*d*n+3*T*d*d*s+d*d*d*c,S[1][M]=E;S[0][O]=t,S[1][O]=r,S[0][O+1]=o,S[1][O+1]=c;var P=[{x:y.apply(null,S[0]),y:y.apply(null,S[1])},{x:_.apply(null,S[0]),y:_.apply(null,S[1])}];return k.cachesBoundsOfCurve&&(k.boundsOfCurveCache[l]=P),P},k.util.getPointOnPath=function(e,t,r){r||(r=d(e));for(var i=0;t-r[i].length>0&&i<r.length-2;)t-=r[i].length,i++;var n,a=r[i],s=t/a.length,o=a.command,c=e[i];switch(o){case"M":return{x:a.x,y:a.y,angle:0};case"Z":case"z":return(n=new k.Point(a.x,a.y).lerp(new k.Point(a.destX,a.destY),s)).angle=Math.atan2(a.destY-a.y,a.destX-a.x),n;case"L":return(n=new k.Point(a.x,a.y).lerp(new k.Point(c[1],c[2]),s)).angle=Math.atan2(c[2]-a.y,c[1]-a.x),n;case"C":case"Q":return f(a,t)}},k.util.transformPath=function(e,t,r){return r&&(t=k.util.multiplyTransformMatrices(t,[1,0,0,1,-r.x,-r.y])),e.map((function(e){for(var r=e.slice(0),i={},n=1;n<e.length-1;n+=2)i.x=e[n],i.y=e[n+1],i=k.util.transformPoint(i,t),r[n]=i.x,r[n+1]=i.y;return r}))}}(),function(){var e=Array.prototype.slice;function t(e,t,r){if(e&&0!==e.length){var i=e.length-1,n=t?e[i][t]:e[i];if(t)for(;i--;)r(e[i][t],n)&&(n=e[i][t]);else for(;i--;)r(e[i],n)&&(n=e[i]);return n}}k.util.array={fill:function(e,t){for(var r=e.length;r--;)e[r]=t;return e},invoke:function(t,r){for(var i=e.call(arguments,2),n=[],a=0,s=t.length;a<s;a++)n[a]=i.length?t[a][r].apply(t[a],i):t[a][r].call(t[a]);return n},min:function(e,r){return t(e,r,(function(e,t){return e<t}))},max:function(e,r){return t(e,r,(function(e,t){return e>=t}))}}}(),function(){function e(t,r,i){if(i)if(!k.isLikelyNode&&r instanceof Element)t=r;else if(r instanceof Array){t=[];for(var n=0,a=r.length;n<a;n++)t[n]=e({},r[n],i)}else if(r&&"object"===_(r))for(var s in r)"canvas"===s||"group"===s?t[s]=null:r.hasOwnProperty(s)&&(t[s]=e({},r[s],i));else t=r;else for(var s in r)t[s]=r[s];return t}k.util.object={extend:e,clone:function(t,r){return e({},t,r)}},k.util.object.extend(k.util,k.Observable)}(),function(){function e(e,t){var r=e.charCodeAt(t);if(isNaN(r))return"";if(r<55296||r>57343)return e.charAt(t);if(55296<=r&&r<=56319){if(e.length<=t+1)throw"High surrogate without following low surrogate";var i=e.charCodeAt(t+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return e.charAt(t)+e.charAt(t+1)}if(0===t)throw"Low surrogate without preceding high surrogate";var n=e.charCodeAt(t-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1}k.util.string={camelize:function(e){return e.replace(/-+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))},capitalize:function(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())},escapeXml:function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(t){var r,i=0,n=[];for(i=0;i<t.length;i++)!1!==(r=e(t,i))&&n.push(r);return n}}}(),function(){var e=Array.prototype.slice,t=function(){},r=function(){for(var e in{toString:1})if("toString"===e)return!1;return!0}(),i=function(e,t,i){for(var n in t)n in e.prototype&&"function"==typeof e.prototype[n]&&(t[n]+"").indexOf("callSuper")>-1?e.prototype[n]=function(e){return function(){var r=this.constructor.superclass;this.constructor.superclass=i;var n=t[e].apply(this,arguments);if(this.constructor.superclass=r,"initialize"!==e)return n}}(n):e.prototype[n]=t[n],r&&(t.toString!==Object.prototype.toString&&(e.prototype.toString=t.toString),t.valueOf!==Object.prototype.valueOf&&(e.prototype.valueOf=t.valueOf))};function n(){}function a(t){for(var r=null,i=this;i.constructor.superclass;){var n=i.constructor.superclass.prototype[t];if(i[t]!==n){r=n;break}i=i.constructor.superclass.prototype}return r?arguments.length>1?r.apply(this,e.call(arguments,1)):r.call(this):console.log("tried to callSuper "+t+", method not found in prototype chain",this)}k.util.createClass=function(){var r=null,s=e.call(arguments,0);function o(){this.initialize.apply(this,arguments)}"function"==typeof s[0]&&(r=s.shift()),o.superclass=r,o.subclasses=[],r&&(n.prototype=r.prototype,o.prototype=new n,r.subclasses.push(o));for(var c=0,l=s.length;c<l;c++)i(o,s[c],r);return o.prototype.initialize||(o.prototype.initialize=t),o.prototype.constructor=o,o.prototype.callSuper=a,o}}(),o=!!k.document.createElement("div").attachEvent,c=["touchstart","touchmove","touchend"],k.util.addListener=function(e,t,r,i){e&&e.addEventListener(t,r,!o&&i)},k.util.removeListener=function(e,t,r,i){e&&e.removeEventListener(t,r,!o&&i)},k.util.getPointer=function(e){var t=e.target,r=k.util.getScrollLeftTop(t),i=function(e){var t=e.changedTouches;return t&&t[0]?t[0]:e}(e);return{x:i.clientX+r.left,y:i.clientY+r.top}},k.util.isTouchEvent=function(e){return c.indexOf(e.type)>-1||"touch"===e.pointerType},l=k.document.createElement("div"),u="string"==typeof l.style.opacity,h="string"==typeof l.style.filter,f=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,d=function(e){return e},u?d=function(e,t){return e.style.opacity=t,e}:h&&(d=function(e,t){var r=e.style;return e.currentStyle&&!e.currentStyle.hasLayout&&(r.zoom=1),f.test(r.filter)?(t=t>=.9999?"":"alpha(opacity="+100*t+")",r.filter=r.filter.replace(f,t)):r.filter+=" alpha(opacity="+100*t+")",e}),k.util.setStyle=function(e,t){var r=e.style;if(!r)return e;if("string"==typeof t)return e.style.cssText+=";"+t,t.indexOf("opacity")>-1?d(e,t.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var i in t)if("opacity"===i)d(e,t[i]);else{var n="float"===i||"cssFloat"===i?void 0===r.styleFloat?"cssFloat":"styleFloat":i;r.setProperty(n,t[i])}return e},function(){var e=Array.prototype.slice;var t,r,i=function(t){return e.call(t,0)};try{t=i(k.document.childNodes)instanceof Array}catch(s){}function n(e,t){var r=k.document.createElement(e);for(var i in t)"class"===i?r.className=t[i]:"for"===i?r.htmlFor=t[i]:r.setAttribute(i,t[i]);return r}function a(e){for(var t=0,r=0,i=k.document.documentElement,n=k.document.body||{scrollLeft:0,scrollTop:0};e&&(e.parentNode||e.host)&&((e=e.parentNode||e.host)===k.document?(t=n.scrollLeft||i.scrollLeft||0,r=n.scrollTop||i.scrollTop||0):(t+=e.scrollLeft||0,r+=e.scrollTop||0),1!==e.nodeType||"fixed"!==e.style.position););return{left:t,top:r}}t||(i=function(e){for(var t=new Array(e.length),r=e.length;r--;)t[r]=e[r];return t}),r=k.document.defaultView&&k.document.defaultView.getComputedStyle?function(e,t){var r=k.document.defaultView.getComputedStyle(e,null);return r?r[t]:void 0}:function(e,t){var r=e.style[t];return!r&&e.currentStyle&&(r=e.currentStyle[t]),r},function(){var e=k.document.documentElement.style,t="userSelect"in e?"userSelect":"MozUserSelect"in e?"MozUserSelect":"WebkitUserSelect"in e?"WebkitUserSelect":"KhtmlUserSelect"in e?"KhtmlUserSelect":"";k.util.makeElementUnselectable=function(e){return void 0!==e.onselectstart&&(e.onselectstart=k.util.falseFunction),t?e.style[t]="none":"string"==typeof e.unselectable&&(e.unselectable="on"),e},k.util.makeElementSelectable=function(e){return void 0!==e.onselectstart&&(e.onselectstart=null),t?e.style[t]="":"string"==typeof e.unselectable&&(e.unselectable=""),e}}(),k.util.setImageSmoothing=function(e,t){e.imageSmoothingEnabled=e.imageSmoothingEnabled||e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled||e.oImageSmoothingEnabled,e.imageSmoothingEnabled=t},k.util.getById=function(e){return"string"==typeof e?k.document.getElementById(e):e},k.util.toArray=i,k.util.addClass=function(e,t){e&&-1===(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className+=(e.className?" ":"")+t)},k.util.makeElement=n,k.util.wrapElement=function(e,t,r){return"string"==typeof t&&(t=n(t,r)),e.parentNode&&e.parentNode.replaceChild(t,e),t.appendChild(e),t},k.util.getScrollLeftTop=a,k.util.getElementOffset=function(e){var t,i,n=e&&e.ownerDocument,s={left:0,top:0},o={left:0,top:0},c={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!n)return o;for(var l in c)o[c[l]]+=parseInt(r(e,l),10)||0;return t=n.documentElement,void 0!==e.getBoundingClientRect&&(s=e.getBoundingClientRect()),i=a(e),{left:s.left+i.left-(t.clientLeft||0)+o.left,top:s.top+i.top-(t.clientTop||0)+o.top}},k.util.getNodeCanvas=function(e){var t=k.jsdomImplForWrapper(e);return t._canvas||t._image},k.util.cleanUpJsdomNode=function(e){if(k.isLikelyNode){var t=k.jsdomImplForWrapper(e);t&&(t._image=null,t._canvas=null,t._currentSrc=null,t._attributes=null,t._classList=null)}}}(),function(){function e(){}k.util.request=function(t,r){r||(r={});var i=r.method?r.method.toUpperCase():"GET",n=r.onComplete||function(){},a=new k.window.XMLHttpRequest,s=r.body||r.parameters;return a.onreadystatechange=function(){4===a.readyState&&(n(a),a.onreadystatechange=e)},"GET"===i&&(s=null,"string"==typeof r.parameters&&(t=function(e,t){return e+(/\?/.test(e)?"&":"?")+t}(t,r.parameters))),a.open(i,t,!0),"POST"!==i&&"PUT"!==i||a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(s),a}}(),k.log=console.log,k.warn=console.warn,function(){var e=k.util.object.extend,t=k.util.object.clone,r=[];function i(){return!1}function n(e,t,r,i){return-r*Math.cos(e/i*(Math.PI/2))+r+t}k.util.object.extend(r,{cancelAll:function(){var e=this.splice(0);return e.forEach((function(e){e.cancel()})),e},cancelByCanvas:function(e){if(!e)return[];var t=this.filter((function(t){return"object"===_(t.target)&&t.target.canvas===e}));return t.forEach((function(e){e.cancel()})),t},cancelByTarget:function(e){var t=this.findAnimationsByTarget(e);return t.forEach((function(e){e.cancel()})),t},findAnimationIndex:function(e){return this.indexOf(this.findAnimation(e))},findAnimation:function(e){return this.find((function(t){return t.cancel===e}))},findAnimationsByTarget:function(e){return e?this.filter((function(t){return t.target===e})):[]}});var a=k.window.requestAnimationFrame||k.window.webkitRequestAnimationFrame||k.window.mozRequestAnimationFrame||k.window.oRequestAnimationFrame||k.window.msRequestAnimationFrame||function(e){return k.window.setTimeout(e,1e3/60)},s=k.window.cancelAnimationFrame||k.window.clearTimeout;function o(){return a.apply(k.window,arguments)}k.util.animate=function(r){r||(r={});var a,s=!1,c=function(){var e=k.runningAnimations.indexOf(a);return e>-1&&k.runningAnimations.splice(e,1)[0]};return a=e(t(r),{cancel:function(){return s=!0,c()},currentValue:"startValue"in r?r.startValue:0,completionRate:0,durationRate:0}),k.runningAnimations.push(a),o((function(e){var t,l=e||+new Date,u=r.duration||500,h=l+u,f=r.onChange||i,d=r.abort||i,p=r.onComplete||i,m=r.easing||n,b="startValue"in r&&r.startValue.length>0,v="startValue"in r?r.startValue:0,g="endValue"in r?r.endValue:100,y=r.byValue||(b?v.map((function(e,t){return g[t]-v[t]})):g-v);r.onStart&&r.onStart(),function e(r){var i=(t=r||+new Date)>h?u:t-l,n=i/u,_=b?v.map((function(e,t){return m(i,v[t],y[t],u)})):m(i,v,y,u),w=b?Math.abs((_[0]-v[0])/y[0]):Math.abs((_-v)/y);if(a.currentValue=b?_.slice():_,a.completionRate=w,a.durationRate=n,!s){if(!d(_,w,n))return t>h?(a.currentValue=b?g.slice():g,a.completionRate=1,a.durationRate=1,f(b?g.slice():g,1,1),p(g,1,1),void c()):(f(_,w,n),void o(e));c()}}(l)})),a.cancel},k.util.requestAnimFrame=o,k.util.cancelAnimFrame=function(){return s.apply(k.window,arguments)},k.runningAnimations=r}(),function(){function e(e,t,r){var i="rgba("+parseInt(e[0]+r*(t[0]-e[0]),10)+","+parseInt(e[1]+r*(t[1]-e[1]),10)+","+parseInt(e[2]+r*(t[2]-e[2]),10);return i+=","+(e&&t?parseFloat(e[3]+r*(t[3]-e[3])):1),i+=")"}k.util.animateColor=function(t,r,i,n){var a=new k.Color(t).getSource(),s=new k.Color(r).getSource(),o=n.onComplete,c=n.onChange;return n=n||{},k.util.animate(k.util.object.extend(n,{duration:i||500,startValue:a,endValue:s,byValue:s,easing:function(t,r,i,a){return e(r,i,n.colorEasing?n.colorEasing(t,a):1-Math.cos(t/a*(Math.PI/2)))},onComplete:function(t,r,i){if(o)return o(e(s,s,0),r,i)},onChange:function(t,r,i){if(c){if(Array.isArray(t))return c(e(t,t,0),r,i);c(t,r,i)}}}))}}(),function(){function e(e,t,r,i){return e<Math.abs(t)?(e=t,i=r/4):i=0===t&&0===e?r/(2*Math.PI)*Math.asin(1):r/(2*Math.PI)*Math.asin(t/e),{a:e,c:t,p:r,s:i}}function t(e,t,r){return e.a*Math.pow(2,10*(t-=1))*Math.sin((t*r-e.s)*(2*Math.PI)/e.p)}function r(e,t,r,n){return r-i(n-e,0,r,n)+t}function i(e,t,r,i){return(e/=i)<1/2.75?r*(7.5625*e*e)+t:e<2/2.75?r*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?r*(7.5625*(e-=2.25/2.75)*e+.9375)+t:r*(7.5625*(e-=2.625/2.75)*e+.984375)+t}k.util.ease={easeInQuad:function(e,t,r,i){return r*(e/=i)*e+t},easeOutQuad:function(e,t,r,i){return-r*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,r,i){return(e/=i/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,r,i){return r*(e/=i)*e*e+t},easeOutCubic:function(e,t,r,i){return r*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,r,i){return(e/=i/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,r,i){return r*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,r,i){return-r*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,r,i){return(e/=i/2)<1?r/2*e*e*e*e+t:-r/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,r,i){return r*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,r,i){return r*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,r,i){return(e/=i/2)<1?r/2*e*e*e*e*e+t:r/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,r,i){return-r*Math.cos(e/i*(Math.PI/2))+r+t},easeOutSine:function(e,t,r,i){return r*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,r,i){return-r/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,r,i){return 0===e?t:r*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,r,i){return e===i?t+r:r*(1-Math.pow(2,-10*e/i))+t},easeInOutExpo:function(e,t,r,i){return 0===e?t:e===i?t+r:(e/=i/2)<1?r/2*Math.pow(2,10*(e-1))+t:r/2*(2-Math.pow(2,-10*--e))+t},easeInCirc:function(e,t,r,i){return-r*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,r,i){return r*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,r,i){return(e/=i/2)<1?-r/2*(Math.sqrt(1-e*e)-1)+t:r/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(r,i,n,a){var s=0;return 0===r?i:1===(r/=a)?i+n:(s||(s=.3*a),-t(e(n,n,s,1.70158),r,a)+i)},easeOutElastic:function(t,r,i,n){var a=0;if(0===t)return r;if(1===(t/=n))return r+i;a||(a=.3*n);var s=e(i,i,a,1.70158);return s.a*Math.pow(2,-10*t)*Math.sin((t*n-s.s)*(2*Math.PI)/s.p)+s.c+r},easeInOutElastic:function(r,i,n,a){var s=0;if(0===r)return i;if(2===(r/=a/2))return i+n;s||(s=a*(.3*1.5));var o=e(n,n,s,1.70158);return r<1?-.5*t(o,r,a)+i:o.a*Math.pow(2,-10*(r-=1))*Math.sin((r*a-o.s)*(2*Math.PI)/o.p)*.5+o.c+i},easeInBack:function(e,t,r,i,n){return void 0===n&&(n=1.70158),r*(e/=i)*e*((n+1)*e-n)+t},easeOutBack:function(e,t,r,i,n){return void 0===n&&(n=1.70158),r*((e=e/i-1)*e*((n+1)*e+n)+1)+t},easeInOutBack:function(e,t,r,i,n){return void 0===n&&(n=1.70158),(e/=i/2)<1?r/2*(e*e*((1+(n*=1.525))*e-n))+t:r/2*((e-=2)*e*((1+(n*=1.525))*e+n)+2)+t},easeInBounce:r,easeOutBounce:i,easeInOutBounce:function(e,t,n,a){return e<a/2?.5*r(2*e,0,n,a)+t:.5*i(2*e-a,0,n,a)+.5*n+t}}}(),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.extend,i=t.util.object.clone,n=t.util.toFixed,a=t.util.parseUnit,s=t.util.multiplyTransformMatrices,o={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},c={stroke:"strokeOpacity",fill:"fillOpacity"},l="font-size",u="clip-path";function h(e){return e in o?o[e]:e}function f(e,r,i,n){var o,c=Array.isArray(r);if("fill"!==e&&"stroke"!==e||"none"!==r){if("strokeUniform"===e)return"non-scaling-stroke"===r;if("strokeDashArray"===e)r="none"===r?null:r.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===e)r=i&&i.transformMatrix?s(i.transformMatrix,t.parseTransformAttribute(r)):t.parseTransformAttribute(r);else if("visible"===e)r="none"!==r&&"hidden"!==r,i&&!1===i.visible&&(r=!1);else if("opacity"===e)r=parseFloat(r),i&&void 0!==i.opacity&&(r*=i.opacity);else if("textAnchor"===e)r="start"===r?"left":"end"===r?"right":"center";else if("charSpacing"===e)o=a(r,n)/n*1e3;else if("paintFirst"===e){var l=r.indexOf("fill"),u=r.indexOf("stroke");r="fill";(l>-1&&u>-1&&u<l||-1===l&&u>-1)&&(r="stroke")}else{if("href"===e||"xlink:href"===e||"font"===e)return r;if("imageSmoothing"===e)return"optimizeQuality"===r;o=c?r.map(a):a(r,n)}}else r="";return!c&&isNaN(o)?r:o}function d(e){return new RegExp("^("+e.join("|")+")\\b","i")}function p(e,t){var r,i,n,a,s=[];for(n=0,a=t.length;n<a;n++)r=t[n],i=e.getElementsByTagName(r),s=s.concat(Array.prototype.slice.call(i));return s}function m(e,t){var r,i=!0;return(r=b(e,t.pop()))&&t.length&&(i=function(e,t){var r,i=!0;for(;e.parentNode&&1===e.parentNode.nodeType&&t.length;)i&&(r=t.pop()),i=b(e=e.parentNode,r);return 0===t.length}(e,t)),r&&i&&0===t.length}function b(e,t){var r,i,n=e.nodeName,a=e.getAttribute("class"),s=e.getAttribute("id");if(r=new RegExp("^"+n,"i"),t=t.replace(r,""),s&&t.length&&(r=new RegExp("#"+s+"(?![a-zA-Z\\-]+)","i"),t=t.replace(r,"")),a&&t.length)for(i=(a=a.split(" ")).length;i--;)r=new RegExp("\\."+a[i]+"(?![a-zA-Z\\-]+)","i"),t=t.replace(r,"");return 0===t.length}function v(e,t){var r;if(e.getElementById&&(r=e.getElementById(t)),r)return r;var i,n,a,s=e.getElementsByTagName("*");for(n=0,a=s.length;n<a;n++)if(t===(i=s[n]).getAttribute("id"))return i}t.svgValidTagNamesRegEx=d(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),t.svgViewBoxElementsRegEx=d(["symbol","image","marker","pattern","view","svg"]),t.svgInvalidAncestorsRegEx=d(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),t.svgValidParentsRegEx=d(["symbol","g","a","svg","clipPath","defs"]),t.cssRules={},t.gradientDefs={},t.clipPaths={},t.parseTransformAttribute=function(){function e(e,r,i){e[i]=Math.tan(t.util.degreesToRadians(r[0]))}var r=t.iMatrix,i=t.reNum,n=t.commaWsp,a="(?:"+("(?:(matrix)\\s*\\(\\s*("+i+")"+n+"("+i+")"+n+"("+i+")"+n+"("+i+")"+n+"("+i+")"+n+"("+i+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+i+")(?:"+n+"("+i+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+i+")(?:"+n+"("+i+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+i+")(?:"+n+"("+i+")"+n+"("+i+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+i+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+i+")\\s*\\))")+")",s=new RegExp("^\\s*(?:"+("(?:"+a+"(?:"+n+"*"+a+")*)")+"?)\\s*$"),o=new RegExp(a,"g");return function(i){var n=r.concat(),c=[];if(!i||i&&!s.test(i))return n;i.replace(o,(function(i){var s=new RegExp(a).exec(i).filter((function(e){return!!e})),o=s[1],l=s.slice(2).map(parseFloat);switch(o){case"translate":!function(e,t){e[4]=t[0],2===t.length&&(e[5]=t[1])}(n,l);break;case"rotate":l[0]=t.util.degreesToRadians(l[0]),function(e,r){var i=t.util.cos(r[0]),n=t.util.sin(r[0]),a=0,s=0;3===r.length&&(a=r[1],s=r[2]),e[0]=i,e[1]=n,e[2]=-n,e[3]=i,e[4]=a-(i*a-n*s),e[5]=s-(n*a+i*s)}(n,l);break;case"scale":!function(e,t){var r=t[0],i=2===t.length?t[1]:t[0];e[0]=r,e[3]=i}(n,l);break;case"skewX":e(n,l,2);break;case"skewY":e(n,l,1);break;case"matrix":n=l}c.push(n.concat()),n=r.concat()}));for(var l=c[0];c.length>1;)c.shift(),l=t.util.multiplyTransformMatrices(l,c[0]);return l}}();var g=new RegExp("^\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*$");function y(e){if(!t.svgViewBoxElementsRegEx.test(e.nodeName))return{};var r,i,n,s,o,c,l=e.getAttribute("viewBox"),u=1,h=1,f=e.getAttribute("width"),d=e.getAttribute("height"),p=e.getAttribute("x")||0,m=e.getAttribute("y")||0,b=e.getAttribute("preserveAspectRatio")||"",v=!l||!(l=l.match(g)),y=!f||!d||"100%"===f||"100%"===d,_=v&&y,w={},x="",k=0,S=0;if(w.width=0,w.height=0,w.toBeParsed=_,v&&(p||m)&&e.parentNode&&"#document"!==e.parentNode.nodeName&&(x=" translate("+a(p)+" "+a(m)+") ",o=(e.getAttribute("transform")||"")+x,e.setAttribute("transform",o),e.removeAttribute("x"),e.removeAttribute("y")),_)return w;if(v)return w.width=a(f),w.height=a(d),w;if(r=-parseFloat(l[1]),i=-parseFloat(l[2]),n=parseFloat(l[3]),s=parseFloat(l[4]),w.minX=r,w.minY=i,w.viewBoxWidth=n,w.viewBoxHeight=s,y?(w.width=n,w.height=s):(w.width=a(f),w.height=a(d),u=w.width/n,h=w.height/s),"none"!==(b=t.util.parsePreserveAspectRatioAttribute(b)).alignX&&("meet"===b.meetOrSlice&&(h=u=u>h?h:u),"slice"===b.meetOrSlice&&(h=u=u>h?u:h),k=w.width-n*u,S=w.height-s*u,"Mid"===b.alignX&&(k/=2),"Mid"===b.alignY&&(S/=2),"Min"===b.alignX&&(k=0),"Min"===b.alignY&&(S=0)),1===u&&1===h&&0===r&&0===i&&0===p&&0===m)return w;if((p||m)&&"#document"!==e.parentNode.nodeName&&(x=" translate("+a(p)+" "+a(m)+") "),o=x+" matrix("+u+" 0 0 "+h+" "+(r*u+k)+" "+(i*h+S)+") ","svg"===e.nodeName){for(c=e.ownerDocument.createElementNS(t.svgNS,"g");e.firstChild;)c.appendChild(e.firstChild);e.appendChild(c)}else(c=e).removeAttribute("x"),c.removeAttribute("y"),o=c.getAttribute("transform")+o;return c.setAttribute("transform",o),w}function _(e,t){var r="xlink:href",i=v(e,t.getAttribute(r).slice(1));if(i&&i.getAttribute(r)&&_(e,i),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach((function(e){i&&!t.hasAttribute(e)&&i.hasAttribute(e)&&t.setAttribute(e,i.getAttribute(e))})),!t.children.length)for(var n=i.cloneNode(!0);n.firstChild;)t.appendChild(n.firstChild);t.removeAttribute(r)}t.parseSVGDocument=function(e,r,n,a){if(e){!function(e){for(var r=p(e,["use","svg:use"]),i=0;r.length&&i<r.length;){var n=r[i],a=n.getAttribute("xlink:href")||n.getAttribute("href");if(null===a)return;var s,o,c,l,u=a.slice(1),h=n.getAttribute("x")||0,f=n.getAttribute("y")||0,d=v(e,u).cloneNode(!0),m=(d.getAttribute("transform")||"")+" translate("+h+", "+f+")",b=r.length,g=t.svgNS;if(y(d),/^svg$/i.test(d.nodeName)){var _=d.ownerDocument.createElementNS(g,"g");for(o=0,l=(c=d.attributes).length;o<l;o++)s=c.item(o),_.setAttributeNS(g,s.nodeName,s.nodeValue);for(;d.firstChild;)_.appendChild(d.firstChild);d=_}for(o=0,l=(c=n.attributes).length;o<l;o++)"x"!==(s=c.item(o)).nodeName&&"y"!==s.nodeName&&"xlink:href"!==s.nodeName&&"href"!==s.nodeName&&("transform"===s.nodeName?m=s.nodeValue+" "+m:d.setAttribute(s.nodeName,s.nodeValue));d.setAttribute("transform",m),d.setAttribute("instantiated_by_use","1"),d.removeAttribute("id"),n.parentNode.replaceChild(d,n),r.length===b&&i++}}(e);var s,o,c=t.Object.__uid++,l=y(e),u=t.util.toArray(e.getElementsByTagName("*"));if(l.crossOrigin=a&&a.crossOrigin,l.svgUid=c,0===u.length&&t.isLikelyNode){var h=[];for(s=0,o=(u=e.selectNodes('//*[name(.)!="svg"]')).length;s<o;s++)h[s]=u[s];u=h}var f=u.filter((function(e){return y(e),t.svgValidTagNamesRegEx.test(e.nodeName.replace("svg:",""))&&!function(e,t){for(;e&&(e=e.parentNode);)if(e.nodeName&&t.test(e.nodeName.replace("svg:",""))&&!e.getAttribute("instantiated_by_use"))return!0;return!1}(e,t.svgInvalidAncestorsRegEx)}));if(!f||f&&!f.length)r&&r([],{});else{var d={};u.filter((function(e){return"clipPath"===e.nodeName.replace("svg:","")})).forEach((function(e){var r=e.getAttribute("id");d[r]=t.util.toArray(e.getElementsByTagName("*")).filter((function(e){return t.svgValidTagNamesRegEx.test(e.nodeName.replace("svg:",""))}))})),t.gradientDefs[c]=t.getGradientDefs(e),t.cssRules[c]=t.getCSSRules(e),t.clipPaths[c]=d,t.parseElements(f,(function(e,i){r&&(r(e,l,i,u),delete t.gradientDefs[c],delete t.cssRules[c],delete t.clipPaths[c])}),i(l),n,a)}}};var w=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)");r(t,{parseFontDeclaration:function(e,t){var r=e.match(w);if(r){var i=r[1],n=r[3],s=r[4],o=r[5],c=r[6];i&&(t.fontStyle=i),n&&(t.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),s&&(t.fontSize=a(s)),c&&(t.fontFamily=c),o&&(t.lineHeight="normal"===o?1:o)}},getGradientDefs:function(e){var t,r=p(e,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),i=0,n={};for(i=r.length;i--;)(t=r[i]).getAttribute("xlink:href")&&_(e,t),n[t.getAttribute("id")]=t;return n},parseAttributes:function(e,i,s){if(e){var o,d,p,b={};void 0===s&&(s=e.getAttribute("svgUid")),e.parentNode&&t.svgValidParentsRegEx.test(e.parentNode.nodeName)&&(b=t.parseAttributes(e.parentNode,i,s));var v=i.reduce((function(t,r){return(o=e.getAttribute(r))&&(t[r]=o),t}),{}),g=r(function(e,r){var i={};for(var n in t.cssRules[r])if(m(e,n.split(" ")))for(var a in t.cssRules[r][n])i[a]=t.cssRules[r][n][a];return i}(e,s),t.parseStyleAttribute(e));v=r(v,g),g[u]&&e.setAttribute(u,g[u]),d=p=b.fontSize||t.Text.DEFAULT_SVG_FONT_SIZE,v[l]&&(v[l]=d=a(v[l],p));var y,_,w={};for(var x in v)_=f(y=h(x),v[x],b,d),w[y]=_;w&&w.font&&t.parseFontDeclaration(w.font,w);var k=r(b,w);return t.svgValidParentsRegEx.test(e.nodeName)?k:function(e){for(var r in c)if(void 0!==e[c[r]]&&""!==e[r]){if(void 0===e[r]){if(!t.Object.prototype[r])continue;e[r]=t.Object.prototype[r]}if(0!==e[r].indexOf("url(")){var i=new t.Color(e[r]);e[r]=i.setAlpha(n(i.getAlpha()*e[c[r]],2)).toRgba()}}return e}(k)}},parseElements:function(e,r,i,n,a){new t.ElementsParser(e,r,i,n,a).parse()},parseStyleAttribute:function(e){var t={},r=e.getAttribute("style");return r?("string"==typeof r?function(e,t){var r,i;e.replace(/;\s*$/,"").split(";").forEach((function(e){var n=e.split(":");r=n[0].trim().toLowerCase(),i=n[1].trim(),t[r]=i}))}(r,t):function(e,t){var r,i;for(var n in e)void 0!==e[n]&&(r=n.toLowerCase(),i=e[n],t[r]=i)}(r,t),t):t},parsePointsAttribute:function(e){if(!e)return null;var t,r,i=[];for(t=0,r=(e=(e=e.replace(/,/g," ").trim()).split(/\s+/)).length;t<r;t+=2)i.push({x:parseFloat(e[t]),y:parseFloat(e[t+1])});return i},getCSSRules:function(e){var r,i,n=e.getElementsByTagName("style"),a={};for(r=0,i=n.length;r<i;r++){var s=n[r].textContent;""!==(s=s.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&s.split("}").filter((function(e){return e.trim()})).forEach((function(e){var n=e.split("{"),s={},o=n[1].trim().split(";").filter((function(e){return e.trim()}));for(r=0,i=o.length;r<i;r++){var c=o[r].split(":"),l=c[0].trim(),u=c[1].trim();s[l]=u}(e=n[0].trim()).split(",").forEach((function(e){""!==(e=e.replace(/^svg/i,"").trim())&&(a[e]?t.util.object.extend(a[e],s):a[e]=t.util.object.clone(s))}))}))}return a},loadSVGFromURL:function(e,r,i,n){e=e.replace(/^\n\s*/,"").trim(),new t.util.request(e,{method:"get",onComplete:function(e){var a=e.responseXML;if(!a||!a.documentElement)return r&&r(null),!1;t.parseSVGDocument(a.documentElement,(function(e,t,i,n){r&&r(e,t,i,n)}),i,n)}})},loadSVGFromString:function(e,r,i,n){var a=(new t.window.DOMParser).parseFromString(e.trim(),"text/xml");t.parseSVGDocument(a.documentElement,(function(e,t,i,n){r(e,t,i,n)}),i,n)}})}(e),k.ElementsParser=function(e,t,r,i,n,a){this.elements=e,this.callback=t,this.options=r,this.reviver=i,this.svgUid=r&&r.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=a},(p=k.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},p.createObjects=function(){var e=this;this.elements.forEach((function(t,r){t.setAttribute("svgUid",e.svgUid),e.createObject(t,r)}))},p.findTag=function(e){return k[k.util.string.capitalize(e.tagName.replace("svg:",""))]},p.createObject=function(e,t){var r=this.findTag(e);if(r&&r.fromElement)try{r.fromElement(e,this.createCallback(t,e),this.options)}catch(i){k.log(i)}else this.checkIfDone()},p.createCallback=function(e,t){var r=this;return function(i){var n;r.resolveGradient(i,t,"fill"),r.resolveGradient(i,t,"stroke"),i instanceof k.Image&&i._originalElement&&(n=i.parsePreserveAspectRatioAttribute(t)),i._removeTransformMatrix(n),r.resolveClipPath(i,t),r.reviver&&r.reviver(t,i),r.instances[e]=i,r.checkIfDone()}},p.extractPropertyDefinition=function(e,t,r){var i=e[t],n=this.regexUrl;if(n.test(i)){n.lastIndex=0;var a=n.exec(i)[1];return n.lastIndex=0,k[r][this.svgUid][a]}},p.resolveGradient=function(e,t,r){var i=this.extractPropertyDefinition(e,r,"gradientDefs");if(i){var n=t.getAttribute(r+"-opacity"),a=k.Gradient.fromElement(i,e,n,this.options);e.set(r,a)}},p.createClipPathCallback=function(e,t){return function(e){e._removeTransformMatrix(),e.fillRule=e.clipRule,t.push(e)}},p.resolveClipPath=function(e,t){var r,i,n,a,s=this.extractPropertyDefinition(e,"clipPath","clipPaths");if(s){n=[],i=k.util.invertTransform(e.calcTransformMatrix());for(var o=s[0].parentNode,c=t;c.parentNode&&c.getAttribute("clip-path")!==e.clipPath;)c=c.parentNode;c.parentNode.appendChild(o);for(var l=0;l<s.length;l++)r=s[l],this.findTag(r).fromElement(r,this.createClipPathCallback(e,n),this.options);s=1===n.length?n[0]:new k.Group(n),a=k.util.multiplyTransformMatrices(i,s.calcTransformMatrix()),s.clipPath&&this.resolveClipPath(s,c);var u=k.util.qrDecompose(a);s.flipX=!1,s.flipY=!1,s.set("scaleX",u.scaleX),s.set("scaleY",u.scaleY),s.angle=u.angle,s.skewX=u.skewX,s.skewY=0,s.setPositionByOrigin({x:u.translateX,y:u.translateY},"center","center"),e.clipPath=s}else delete e.clipPath},p.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter((function(e){return null!=e})),this.callback(this.instances,this.elements))},function(e){var t=e.fabric||(e.fabric={});function r(e,t){this.x=e,this.y=t}t.Point?t.warn("fabric.Point is already defined"):(t.Point=r,r.prototype={type:"point",constructor:r,add:function(e){return new r(this.x+e.x,this.y+e.y)},addEquals:function(e){return this.x+=e.x,this.y+=e.y,this},scalarAdd:function(e){return new r(this.x+e,this.y+e)},scalarAddEquals:function(e){return this.x+=e,this.y+=e,this},subtract:function(e){return new r(this.x-e.x,this.y-e.y)},subtractEquals:function(e){return this.x-=e.x,this.y-=e.y,this},scalarSubtract:function(e){return new r(this.x-e,this.y-e)},scalarSubtractEquals:function(e){return this.x-=e,this.y-=e,this},multiply:function(e){return new r(this.x*e,this.y*e)},multiplyEquals:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return new r(this.x/e,this.y/e)},divideEquals:function(e){return this.x/=e,this.y/=e,this},eq:function(e){return this.x===e.x&&this.y===e.y},lt:function(e){return this.x<e.x&&this.y<e.y},lte:function(e){return this.x<=e.x&&this.y<=e.y},gt:function(e){return this.x>e.x&&this.y>e.y},gte:function(e){return this.x>=e.x&&this.y>=e.y},lerp:function(e,t){return void 0===t&&(t=.5),t=Math.max(Math.min(1,t),0),new r(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)},distanceFrom:function(e){var t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)},midPointFrom:function(e){return this.lerp(e)},min:function(e){return new r(Math.min(this.x,e.x),Math.min(this.y,e.y))},max:function(e){return new r(Math.max(this.x,e.x),Math.max(this.y,e.y))},toString:function(){return this.x+","+this.y},setXY:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setFromPoint:function(e){return this.x=e.x,this.y=e.y,this},swap:function(e){var t=this.x,r=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=r},clone:function(){return new r(this.x,this.y)}})}(e),function(e){var t=e.fabric||(e.fabric={});function r(e){this.status=e,this.points=[]}t.Intersection?t.warn("fabric.Intersection is already defined"):(t.Intersection=r,t.Intersection.prototype={constructor:r,appendPoint:function(e){return this.points.push(e),this},appendPoints:function(e){return this.points=this.points.concat(e),this}},t.Intersection.intersectLineLine=function(e,i,n,a){var s,o=(a.x-n.x)*(e.y-n.y)-(a.y-n.y)*(e.x-n.x),c=(i.x-e.x)*(e.y-n.y)-(i.y-e.y)*(e.x-n.x),l=(a.y-n.y)*(i.x-e.x)-(a.x-n.x)*(i.y-e.y);if(0!==l){var u=o/l,h=c/l;0<=u&&u<=1&&0<=h&&h<=1?(s=new r("Intersection")).appendPoint(new t.Point(e.x+u*(i.x-e.x),e.y+u*(i.y-e.y))):s=new r}else s=new r(0===o||0===c?"Coincident":"Parallel");return s},t.Intersection.intersectLinePolygon=function(e,t,i){var n,a,s,o,c=new r,l=i.length;for(o=0;o<l;o++)n=i[o],a=i[(o+1)%l],s=r.intersectLineLine(e,t,n,a),c.appendPoints(s.points);return c.points.length>0&&(c.status="Intersection"),c},t.Intersection.intersectPolygonPolygon=function(e,t){var i,n=new r,a=e.length;for(i=0;i<a;i++){var s=e[i],o=e[(i+1)%a],c=r.intersectLinePolygon(s,o,t);n.appendPoints(c.points)}return n.points.length>0&&(n.status="Intersection"),n},t.Intersection.intersectPolygonRectangle=function(e,i,n){var a=i.min(n),s=i.max(n),o=new t.Point(s.x,a.y),c=new t.Point(a.x,s.y),l=r.intersectLinePolygon(a,o,e),u=r.intersectLinePolygon(o,s,e),h=r.intersectLinePolygon(s,c,e),f=r.intersectLinePolygon(c,a,e),d=new r;return d.appendPoints(l.points),d.appendPoints(u.points),d.appendPoints(h.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d})}(e),function(e){var t=e.fabric||(e.fabric={});function r(e){e?this._tryParsingColor(e):this.setSource([0,0,0,1])}function i(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}t.Color?t.warn("fabric.Color is already defined."):(t.Color=r,t.Color.prototype={_tryParsingColor:function(e){var t;e in r.colorNameMap&&(e=r.colorNameMap[e]),"transparent"===e&&(t=[255,255,255,0]),t||(t=r.sourceFromHex(e)),t||(t=r.sourceFromRgb(e)),t||(t=r.sourceFromHsl(e)),t||(t=[0,0,0,1]),t&&this.setSource(t)},_rgbToHsl:function(e,r,i){e/=255,r/=255,i/=255;var n,a,s,o=t.util.array.max([e,r,i]),c=t.util.array.min([e,r,i]);if(s=(o+c)/2,o===c)n=a=0;else{var l=o-c;switch(a=s>.5?l/(2-o-c):l/(o+c),o){case e:n=(r-i)/l+(r<i?6:0);break;case r:n=(i-e)/l+2;break;case i:n=(e-r)/l+4}n/=6}return[Math.round(360*n),Math.round(100*a),Math.round(100*s)]},getSource:function(){return this._source},setSource:function(e){this._source=e},toRgb:function(){var e=this.getSource();return"rgb("+e[0]+","+e[1]+","+e[2]+")"},toRgba:function(){var e=this.getSource();return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"},toHsl:function(){var e=this.getSource(),t=this._rgbToHsl(e[0],e[1],e[2]);return"hsl("+t[0]+","+t[1]+"%,"+t[2]+"%)"},toHsla:function(){var e=this.getSource(),t=this._rgbToHsl(e[0],e[1],e[2]);return"hsla("+t[0]+","+t[1]+"%,"+t[2]+"%,"+e[3]+")"},toHex:function(){var e,t,r,i=this.getSource();return e=1===(e=i[0].toString(16)).length?"0"+e:e,t=1===(t=i[1].toString(16)).length?"0"+t:t,r=1===(r=i[2].toString(16)).length?"0"+r:r,e.toUpperCase()+t.toUpperCase()+r.toUpperCase()},toHexa:function(){var e,t=this.getSource();return e=1===(e=(e=Math.round(255*t[3])).toString(16)).length?"0"+e:e,this.toHex()+e.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(e){var t=this.getSource();return t[3]=e,this.setSource(t),this},toGrayscale:function(){var e=this.getSource(),t=parseInt((.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),10),r=e[3];return this.setSource([t,t,t,r]),this},toBlackWhite:function(e){var t=this.getSource(),r=(.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),i=t[3];return e=e||127,r=Number(r)<Number(e)?0:255,this.setSource([r,r,r,i]),this},overlayWith:function(e){e instanceof r||(e=new r(e));var t,i=[],n=this.getAlpha(),a=this.getSource(),s=e.getSource();for(t=0;t<3;t++)i.push(Math.round(.5*a[t]+.5*s[t]));return i[3]=n,this.setSource(i),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,t.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},t.Color.fromRgb=function(e){return r.fromSource(r.sourceFromRgb(e))},t.Color.sourceFromRgb=function(e){var t=e.match(r.reRGBa);if(t){var i=parseInt(t[1],10)/(/%$/.test(t[1])?100:1)*(/%$/.test(t[1])?255:1),n=parseInt(t[2],10)/(/%$/.test(t[2])?100:1)*(/%$/.test(t[2])?255:1),a=parseInt(t[3],10)/(/%$/.test(t[3])?100:1)*(/%$/.test(t[3])?255:1);return[parseInt(i,10),parseInt(n,10),parseInt(a,10),t[4]?parseFloat(t[4]):1]}},t.Color.fromRgba=r.fromRgb,t.Color.fromHsl=function(e){return r.fromSource(r.sourceFromHsl(e))},t.Color.sourceFromHsl=function(e){var t=e.match(r.reHSLa);if(t){var n,a,s,o=(parseFloat(t[1])%360+360)%360/360,c=parseFloat(t[2])/(/%$/.test(t[2])?100:1),l=parseFloat(t[3])/(/%$/.test(t[3])?100:1);if(0===c)n=a=s=l;else{var u=l<=.5?l*(c+1):l+c-l*c,h=2*l-u;n=i(h,u,o+1/3),a=i(h,u,o),s=i(h,u,o-1/3)}return[Math.round(255*n),Math.round(255*a),Math.round(255*s),t[4]?parseFloat(t[4]):1]}},t.Color.fromHsla=r.fromHsl,t.Color.fromHex=function(e){return r.fromSource(r.sourceFromHex(e))},t.Color.sourceFromHex=function(e){if(e.match(r.reHex)){var t=e.slice(e.indexOf("#")+1),i=3===t.length||4===t.length,n=8===t.length||4===t.length,a=i?t.charAt(0)+t.charAt(0):t.substring(0,2),s=i?t.charAt(1)+t.charAt(1):t.substring(2,4),o=i?t.charAt(2)+t.charAt(2):t.substring(4,6),c=n?i?t.charAt(3)+t.charAt(3):t.substring(6,8):"FF";return[parseInt(a,16),parseInt(s,16),parseInt(o,16),parseFloat((parseInt(c,16)/255).toFixed(2))]}},t.Color.fromSource=function(e){var t=new r;return t.setSource(e),t})}(e),function(e){var t=e.fabric||(e.fabric={}),r=["e","se","s","sw","w","nw","n","ne","e"],i=["ns","nesw","ew","nwse"],n={},a="left",s="top",o="right",c="bottom",l="center",u={top:c,bottom:s,left:o,right:a,center:l},h=t.util.radiansToDegrees,f=Math.sign||function(e){return(e>0)-(e<0)||+e};function d(e,t){var r=e.angle+h(Math.atan2(t.y,t.x))+360;return Math.round(r%360/45)}function p(e,r){var i=r.transform.target,n=i.canvas,a=t.util.object.clone(r);a.target=i,n&&n.fire("object:"+e,a),i.fire(e,r)}function m(e,t){var r=t.canvas,i=e[r.uniScaleKey];return r.uniformScaling&&!i||!r.uniformScaling&&i}function b(e){return e.originX===l&&e.originY===l}function v(e,t,r){var i=e.lockScalingX,n=e.lockScalingY;return!(!i||!n)||(!(t||!i&&!n||!r)||(!(!i||"x"!==t)||!(!n||"y"!==t)))}function g(e,t,r,i){return{e:e,transform:t,pointer:{x:r,y:i}}}function y(e){return function(t,r,i,n){var a=r.target,s=a.getCenterPoint(),o=a.translateToOriginPoint(s,r.originX,r.originY),c=e(t,r,i,n);return a.setPositionByOrigin(o,r.originX,r.originY),c}}function _(e,t){return function(r,i,n,a){var s=t(r,i,n,a);return s&&p(e,g(r,i,n,a)),s}}function w(e,r,i,n,a){var s=e.target,o=s.controls[e.corner],c=s.canvas.getZoom(),l=s.padding/c,u=s.toLocalPoint(new t.Point(n,a),r,i);return u.x>=l&&(u.x-=l),u.x<=-l&&(u.x+=l),u.y>=l&&(u.y-=l),u.y<=l&&(u.y+=l),u.x-=o.offsetX,u.y-=o.offsetY,u}function x(e){return e.flipX!==e.flipY}function k(e,t,r,i,n){if(0!==e[t]){var a=n/e._getTransformedDimensions()[i]*e[r];e.set(r,a)}}function S(e,t,r,i){var n,l=t.target,u=l._getTransformedDimensions(0,l.skewY),f=w(t,t.originX,t.originY,r,i),d=Math.abs(2*f.x)-u.x,p=l.skewX;d<2?n=0:(n=h(Math.atan2(d/l.scaleX,u.y/l.scaleY)),t.originX===a&&t.originY===c&&(n=-n),t.originX===o&&t.originY===s&&(n=-n),x(l)&&(n=-n));var m=p!==n;if(m){var b=l._getTransformedDimensions().y;l.set("skewX",n),k(l,"skewY","scaleY","y",b)}return m}function C(e,t,r,i){var n,l=t.target,u=l._getTransformedDimensions(l.skewX,0),f=w(t,t.originX,t.originY,r,i),d=Math.abs(2*f.y)-u.y,p=l.skewY;d<2?n=0:(n=h(Math.atan2(d/l.scaleY,u.x/l.scaleX)),t.originX===a&&t.originY===c&&(n=-n),t.originX===o&&t.originY===s&&(n=-n),x(l)&&(n=-n));var m=p!==n;if(m){var b=l._getTransformedDimensions().x;l.set("skewY",n),k(l,"skewX","scaleX","x",b)}return m}function U(e,t,r,i,n){n=n||{};var a,s,o,c,l,h,d=t.target,p=d.lockScalingX,g=d.lockScalingY,y=n.by,_=m(e,d),x=v(d,y,_),k=t.gestureScale;if(x)return!1;if(k)s=t.scaleX*k,o=t.scaleY*k;else{if(a=w(t,t.originX,t.originY,r,i),l="y"!==y?f(a.x):1,h="x"!==y?f(a.y):1,t.signX||(t.signX=l),t.signY||(t.signY=h),d.lockScalingFlip&&(t.signX!==l||t.signY!==h))return!1;if(c=d._getTransformedDimensions(),_&&!y){var S=Math.abs(a.x)+Math.abs(a.y),C=t.original,U=S/(Math.abs(c.x*C.scaleX/d.scaleX)+Math.abs(c.y*C.scaleY/d.scaleY));s=C.scaleX*U,o=C.scaleY*U}else s=Math.abs(a.x*d.scaleX/c.x),o=Math.abs(a.y*d.scaleY/c.y);b(t)&&(s*=2,o*=2),t.signX!==l&&"y"!==y&&(t.originX=u[t.originX],s*=-1,t.signX=l),t.signY!==h&&"x"!==y&&(t.originY=u[t.originY],o*=-1,t.signY=h)}var E=d.scaleX,T=d.scaleY;return y?("x"===y&&d.set("scaleX",s),"y"===y&&d.set("scaleY",o)):(!p&&d.set("scaleX",s),!g&&d.set("scaleY",o)),E!==d.scaleX||T!==d.scaleY}n.scaleCursorStyleHandler=function(e,t,i){var n=m(e,i),a="";if(0!==t.x&&0===t.y?a="x":0===t.x&&0!==t.y&&(a="y"),v(i,a,n))return"not-allowed";var s=d(i,t);return r[s]+"-resize"},n.skewCursorStyleHandler=function(e,t,r){var n="not-allowed";if(0!==t.x&&r.lockSkewingY)return n;if(0!==t.y&&r.lockSkewingX)return n;var a=d(r,t)%4;return i[a]+"-resize"},n.scaleSkewCursorStyleHandler=function(e,t,r){return e[r.canvas.altActionKey]?n.skewCursorStyleHandler(e,t,r):n.scaleCursorStyleHandler(e,t,r)},n.rotationWithSnapping=_("rotating",y((function(e,t,r,i){var n=t,a=n.target,s=a.translateToOriginPoint(a.getCenterPoint(),n.originX,n.originY);if(a.lockRotation)return!1;var o,c=Math.atan2(n.ey-s.y,n.ex-s.x),l=Math.atan2(i-s.y,r-s.x),u=h(l-c+n.theta);if(a.snapAngle>0){var f=a.snapAngle,d=a.snapThreshold||f,p=Math.ceil(u/f)*f,m=Math.floor(u/f)*f;Math.abs(u-m)<d?u=m:Math.abs(u-p)<d&&(u=p)}return u<0&&(u=360+u),u%=360,o=a.angle!==u,a.angle=u,o}))),n.scalingEqually=_("scaling",y((function(e,t,r,i){return U(e,t,r,i)}))),n.scalingX=_("scaling",y((function(e,t,r,i){return U(e,t,r,i,{by:"x"})}))),n.scalingY=_("scaling",y((function(e,t,r,i){return U(e,t,r,i,{by:"y"})}))),n.scalingYOrSkewingX=function(e,t,r,i){return e[t.target.canvas.altActionKey]?n.skewHandlerX(e,t,r,i):n.scalingY(e,t,r,i)},n.scalingXOrSkewingY=function(e,t,r,i){return e[t.target.canvas.altActionKey]?n.skewHandlerY(e,t,r,i):n.scalingX(e,t,r,i)},n.changeWidth=_("resizing",y((function(e,t,r,i){var n=t.target,a=w(t,t.originX,t.originY,r,i),s=n.strokeWidth/(n.strokeUniform?n.scaleX:1),o=b(t)?2:1,c=n.width,l=Math.abs(a.x*o/n.scaleX)-s;return n.set("width",Math.max(l,0)),c!==l}))),n.skewHandlerX=function(e,t,r,i){var n,c=t.target,u=c.skewX,h=t.originY;return!c.lockSkewingX&&(0===u?n=w(t,l,l,r,i).x>0?a:o:(u>0&&(n=h===s?a:o),u<0&&(n=h===s?o:a),x(c)&&(n=n===a?o:a)),t.originX=n,_("skewing",y(S))(e,t,r,i))},n.skewHandlerY=function(e,t,r,i){var n,o=t.target,u=o.skewY,h=t.originX;return!o.lockSkewingY&&(0===u?n=w(t,l,l,r,i).y>0?s:c:(u>0&&(n=h===a?s:c),u<0&&(n=h===a?c:s),x(o)&&(n=n===s?c:s)),t.originY=n,_("skewing",y(C))(e,t,r,i))},n.dragHandler=function(e,t,r,i){var n=t.target,a=r-t.offsetX,s=i-t.offsetY,o=!n.get("lockMovementX")&&n.left!==a,c=!n.get("lockMovementY")&&n.top!==s;return o&&n.set("left",a),c&&n.set("top",s),(o||c)&&p("moving",g(e,t,r,i)),o||c},n.scaleOrSkewActionName=function(e,t,r){var i=e[r.canvas.altActionKey];return 0===t.x?i?"skewX":"scaleY":0===t.y?i?"skewY":"scaleX":void 0},n.rotationStyleHandler=function(e,t,r){return r.lockRotation?"not-allowed":t.cursorStyle},n.fireEvent=p,n.wrapWithFixedAnchor=y,n.wrapWithFireEvent=_,n.getLocalPoint=w,t.controlsUtils=n}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.degreesToRadians,i=t.controlsUtils;i.renderCircleControl=function(e,t,r,i,n){i=i||{};var a,s=this.sizeX||i.cornerSize||n.cornerSize,o=this.sizeY||i.cornerSize||n.cornerSize,c=void 0!==i.transparentCorners?i.transparentCorners:n.transparentCorners,l=c?"stroke":"fill",u=!c&&(i.cornerStrokeColor||n.cornerStrokeColor),h=t,f=r;e.save(),e.fillStyle=i.cornerColor||n.cornerColor,e.strokeStyle=i.cornerStrokeColor||n.cornerStrokeColor,s>o?(a=s,e.scale(1,o/s),f=r*s/o):o>s?(a=o,e.scale(s/o,1),h=t*o/s):a=s,e.lineWidth=1,e.beginPath(),e.arc(h,f,a/2,0,2*Math.PI,!1),e[l](),u&&e.stroke(),e.restore()},i.renderSquareControl=function(e,t,i,n,a){n=n||{};var s=this.sizeX||n.cornerSize||a.cornerSize,o=this.sizeY||n.cornerSize||a.cornerSize,c=void 0!==n.transparentCorners?n.transparentCorners:a.transparentCorners,l=c?"stroke":"fill",u=!c&&(n.cornerStrokeColor||a.cornerStrokeColor),h=s/2,f=o/2;e.save(),e.fillStyle=n.cornerColor||a.cornerColor,e.strokeStyle=n.cornerStrokeColor||a.cornerStrokeColor,e.lineWidth=1,e.translate(t,i),e.rotate(r(a.angle)),e[l+"Rect"](-h,-f,s,o),u&&e.strokeRect(-h,-f,s,o),e.restore()}}(e),function(e){var t=e.fabric||(e.fabric={});t.Control=function(e){for(var t in e)this[t]=e[t]},t.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(e,t){return t.cursorStyle},getActionName:function(e,t){return t.actionName},getVisibility:function(e,t){var r=e._controlsVisibility;return r&&void 0!==r[t]?r[t]:this.visible},setVisibility:function(e){this.visible=e},positionHandler:function(e,r){return t.util.transformPoint({x:this.x*e.x+this.offsetX,y:this.y*e.y+this.offsetY},r)},calcCornerCoords:function(e,r,i,n,a){var s,o,c,l,u=a?this.touchSizeX:this.sizeX,h=a?this.touchSizeY:this.sizeY;if(u&&h&&u!==h){var f=Math.atan2(h,u),d=Math.sqrt(u*u+h*h)/2,p=f-t.util.degreesToRadians(e),m=Math.PI/2-f-t.util.degreesToRadians(e);s=d*t.util.cos(p),o=d*t.util.sin(p),c=d*t.util.cos(m),l=d*t.util.sin(m)}else{d=.7071067812*(u&&h?u:r);p=t.util.degreesToRadians(45-e);s=c=d*t.util.cos(p),o=l=d*t.util.sin(p)}return{tl:{x:i-l,y:n-c},tr:{x:i+s,y:n-o},bl:{x:i-s,y:n+o},br:{x:i+l,y:n+c}}},render:function(e,r,i,n,a){if("circle"===((n=n||{}).cornerStyle||a.cornerStyle))t.controlsUtils.renderCircleControl.call(this,e,r,i,n,a);else t.controlsUtils.renderSquareControl.call(this,e,r,i,n,a)}}}(e),function(){function e(e,t){var r,i,n,a,s=e.getAttribute("style"),o=e.getAttribute("offset")||0;if(o=(o=parseFloat(o)/(/%$/.test(o)?100:1))<0?0:o>1?1:o,s){var c=s.split(/\s*;\s*/);for(""===c[c.length-1]&&c.pop(),a=c.length;a--;){var l=c[a].split(/\s*:\s*/),u=l[0].trim(),h=l[1].trim();"stop-color"===u?r=h:"stop-opacity"===u&&(n=h)}}return r||(r=e.getAttribute("stop-color")||"rgb(0,0,0)"),n||(n=e.getAttribute("stop-opacity")),i=(r=new k.Color(r)).getAlpha(),n=isNaN(parseFloat(n))?1:parseFloat(n),n*=i*t,{offset:o,color:r.toRgb(),opacity:n}}var t=k.util.object.clone;k.Gradient=k.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(e){e||(e={}),e.coords||(e.coords={});var t,r=this;Object.keys(e).forEach((function(t){r[t]=e[t]})),this.id?this.id+="_"+k.Object.__uid++:this.id=k.Object.__uid++,t={x1:e.coords.x1||0,y1:e.coords.y1||0,x2:e.coords.x2||0,y2:e.coords.y2||0},"radial"===this.type&&(t.r1=e.coords.r1||0,t.r2=e.coords.r2||0),this.coords=t,this.colorStops=e.colorStops.slice()},addColorStop:function(e){for(var t in e){var r=new k.Color(e[t]);this.colorStops.push({offset:parseFloat(t),color:r.toRgb(),opacity:r.getAlpha()})}return this},toObject:function(e){var t={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return k.util.populateWithProperties(this,t,e),t},toSVG:function(e,r){var i,n,a,s,o=t(this.coords,!0),c=(r=r||{},t(this.colorStops,!0)),l=o.r1>o.r2,u=this.gradientTransform?this.gradientTransform.concat():k.iMatrix.concat(),h=-this.offsetX,f=-this.offsetY,d=!!r.additionalTransform,p="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(c.sort((function(e,t){return e.offset-t.offset})),"objectBoundingBox"===p?(h/=e.width,f/=e.height):(h+=e.width/2,f+=e.height/2),"path"===e.type&&"percentage"!==this.gradientUnits&&(h-=e.pathOffset.x,f-=e.pathOffset.y),u[4]-=h,u[5]-=f,s='id="SVGID_'+this.id+'" gradientUnits="'+p+'"',s+=' gradientTransform="'+(d?r.additionalTransform+" ":"")+k.util.matrixToSVG(u)+'" ',"linear"===this.type?a=["<linearGradient ",s,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,'">\n']:"radial"===this.type&&(a=["<radialGradient ",s,' cx="',l?o.x1:o.x2,'" cy="',l?o.y1:o.y2,'" r="',l?o.r1:o.r2,'" fx="',l?o.x2:o.x1,'" fy="',l?o.y2:o.y1,'">\n']),"radial"===this.type){if(l)for((c=c.concat()).reverse(),i=0,n=c.length;i<n;i++)c[i].offset=1-c[i].offset;var m=Math.min(o.r1,o.r2);if(m>0){var b=m/Math.max(o.r1,o.r2);for(i=0,n=c.length;i<n;i++)c[i].offset+=b*(1-c[i].offset)}}for(i=0,n=c.length;i<n;i++){var v=c[i];a.push("<stop ",'offset="',100*v.offset+"%",'" style="stop-color:',v.color,void 0!==v.opacity?";stop-opacity: "+v.opacity:";",'"/>\n')}return a.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),a.join("")},toLive:function(e){var t,r,i,n=k.util.object.clone(this.coords);if(this.type){for("linear"===this.type?t=e.createLinearGradient(n.x1,n.y1,n.x2,n.y2):"radial"===this.type&&(t=e.createRadialGradient(n.x1,n.y1,n.r1,n.x2,n.y2,n.r2)),r=0,i=this.colorStops.length;r<i;r++){var a=this.colorStops[r].color,s=this.colorStops[r].opacity,o=this.colorStops[r].offset;void 0!==s&&(a=new k.Color(a).setAlpha(s).toRgba()),t.addColorStop(o,a)}return t}}}),k.util.object.extend(k.Gradient,{fromElement:function(t,r,i,n){var a=parseFloat(i)/(/%$/.test(i)?100:1);a=a<0?0:a>1?1:a,isNaN(a)&&(a=1);var s,o,c,l,u=t.getElementsByTagName("stop"),h="userSpaceOnUse"===t.getAttribute("gradientUnits")?"pixels":"percentage",f=t.getAttribute("gradientTransform")||"",d=[],p=0,m=0;for("linearGradient"===t.nodeName||"LINEARGRADIENT"===t.nodeName?(s="linear",o=function(e){return{x1:e.getAttribute("x1")||0,y1:e.getAttribute("y1")||0,x2:e.getAttribute("x2")||"100%",y2:e.getAttribute("y2")||0}}(t)):(s="radial",o=function(e){return{x1:e.getAttribute("fx")||e.getAttribute("cx")||"50%",y1:e.getAttribute("fy")||e.getAttribute("cy")||"50%",r1:0,x2:e.getAttribute("cx")||"50%",y2:e.getAttribute("cy")||"50%",r2:e.getAttribute("r")||"50%"}}(t)),c=u.length;c--;)d.push(e(u[c],a));return l=k.parseTransformAttribute(f),function(e,t,r,i){var n,a;Object.keys(t).forEach((function(e){"Infinity"===(n=t[e])?a=1:"-Infinity"===n?a=0:(a=parseFloat(t[e],10),"string"==typeof n&&/^(\d+\.\d+)%|(\d+)%$/.test(n)&&(a*=.01,"pixels"===i&&("x1"!==e&&"x2"!==e&&"r2"!==e||(a*=r.viewBoxWidth||r.width),"y1"!==e&&"y2"!==e||(a*=r.viewBoxHeight||r.height)))),t[e]=a}))}(0,o,n,h),"pixels"===h&&(p=-r.left,m=-r.top),new k.Gradient({id:t.getAttribute("id"),type:s,coords:o,colorStops:d,gradientUnits:h,gradientTransform:l,offsetX:p,offsetY:m})}})}(),m=k.util.toFixed,k.Pattern=k.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,t){if(e||(e={}),this.id=k.Object.__uid++,this.setOptions(e),!e.source||e.source&&"string"!=typeof e.source)t&&t(this);else{var r=this;this.source=k.util.createImage(),k.util.loadImage(e.source,(function(e,i){r.source=e,t&&t(r,i)}),null,this.crossOrigin)}},toObject:function(e){var t,r,i=k.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?t=this.source.src:"object"===_(this.source)&&this.source.toDataURL&&(t=this.source.toDataURL()),r={type:"pattern",source:t,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:m(this.offsetX,i),offsetY:m(this.offsetY,i),patternTransform:this.patternTransform?this.patternTransform.concat():null},k.util.populateWithProperties(this,r,e),r},toSVG:function(e){var t="function"==typeof this.source?this.source():this.source,r=t.width/e.width,i=t.height/e.height,n=this.offsetX/e.width,a=this.offsetY/e.height,s="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(i=1,a&&(i+=Math.abs(a))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(r=1,n&&(r+=Math.abs(n))),t.src?s=t.src:t.toDataURL&&(s=t.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+a+'" width="'+r+'" height="'+i+'">\n<image x="0" y="0" width="'+t.width+'" height="'+t.height+'" xlink:href="'+s+'"></image>\n</pattern>\n'},setOptions:function(e){for(var t in e)this[t]=e[t]},toLive:function(e){var t=this.source;if(!t)return"";if(void 0!==t.src){if(!t.complete)return"";if(0===t.naturalWidth||0===t.naturalHeight)return""}return e.createPattern(t,this.repeat)}}),function(e){var t=e.fabric||(e.fabric={}),r=t.util.toFixed;t.Shadow?t.warn("fabric.Shadow is already defined."):(t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(e){for(var r in"string"==typeof e&&(e=this._parseShadow(e)),e)this[r]=e[r];this.id=t.Object.__uid++},_parseShadow:function(e){var r=e.trim(),i=t.Shadow.reOffsetsAndBlur.exec(r)||[];return{color:(r.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(i[1],10)||0,offsetY:parseFloat(i[2],10)||0,blur:parseFloat(i[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(e){var i=40,n=40,a=t.Object.NUM_FRACTION_DIGITS,s=t.util.rotateVector({x:this.offsetX,y:this.offsetY},t.util.degreesToRadians(-e.angle)),o=new t.Color(this.color);return e.width&&e.height&&(i=100*r((Math.abs(s.x)+this.blur)/e.width,a)+20,n=100*r((Math.abs(s.y)+this.blur)/e.height,a)+20),e.flipX&&(s.x*=-1),e.flipY&&(s.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+n+'%" height="'+(100+2*n)+'%" x="-'+i+'%" width="'+(100+2*i)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+r(this.blur?this.blur/2:0,a)+'"></feGaussianBlur>\n\t<feOffset dx="'+r(s.x,a)+'" dy="'+r(s.y,a)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+o.toRgb()+'" flood-opacity="'+o.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var e={},r=t.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach((function(t){this[t]!==r[t]&&(e[t]=this[t])}),this),e}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){if(k.StaticCanvas)k.warn("fabric.StaticCanvas is already defined.");else{var e=k.util.object.extend,t=k.util.getElementOffset,r=k.util.removeFromArray,i=k.util.toFixed,n=k.util.transformPoint,a=k.util.invertTransform,s=k.util.getNodeCanvas,o=k.util.createCanvasElement,c=new Error("Could not initialize `canvas` element");k.StaticCanvas=k.util.createClass(k.CommonMethods,{initialize:function(e,t){t||(t={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(e,t)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:k.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(e,t){var r=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(e),this._initOptions(t),this.interactive||this._initRetinaScaling(),t.overlayImage&&this.setOverlayImage(t.overlayImage,r),t.backgroundImage&&this.setBackgroundImage(t.backgroundImage,r),t.backgroundColor&&this.setBackgroundColor(t.backgroundColor,r),t.overlayColor&&this.setOverlayColor(t.overlayColor,r),this.calcOffset()},_isRetinaScaling:function(){return k.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,k.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var e=k.devicePixelRatio;this.__initRetinaScaling(e,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(e,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(e,t,r){t.setAttribute("width",this.width*e),t.setAttribute("height",this.height*e),r.scale(e,e)},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(e,t,r){return this.__setBgOverlayImage("overlayImage",e,t,r)},setBackgroundImage:function(e,t,r){return this.__setBgOverlayImage("backgroundImage",e,t,r)},setOverlayColor:function(e,t){return this.__setBgOverlayColor("overlayColor",e,t)},setBackgroundColor:function(e,t){return this.__setBgOverlayColor("backgroundColor",e,t)},__setBgOverlayImage:function(e,t,r,i){return"string"==typeof t?k.util.loadImage(t,(function(t,n){if(t){var a=new k.Image(t,i);this[e]=a,a.canvas=this}r&&r(t,n)}),this,i&&i.crossOrigin):(i&&t.setOptions(i),this[e]=t,t&&(t.canvas=this),r&&r(t,!1)),this},__setBgOverlayColor:function(e,t,r){return this[e]=t,this._initGradient(t,e),this._initPattern(t,e,r),this},_createCanvasElement:function(){var e=o();if(!e)throw c;if(e.style||(e.style={}),void 0===e.getContext)throw c;return e},_initOptions:function(e){var t=this.lowerCanvasEl;this._setOptions(e),this.width=this.width||parseInt(t.width,10)||0,this.height=this.height||parseInt(t.height,10)||0,this.lowerCanvasEl.style&&(t.width=this.width,t.height=this.height,t.style.width=this.width+"px",t.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(e){e&&e.getContext?this.lowerCanvasEl=e:this.lowerCanvasEl=k.util.getById(e)||this._createCanvasElement(),k.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(e,t){return this.setDimensions({width:e},t)},setHeight:function(e,t){return this.setDimensions({height:e},t)},setDimensions:function(e,t){var r;for(var i in t=t||{},e)r=e[i],t.cssOnly||(this._setBackstoreDimension(i,e[i]),r+="px",this.hasLostContext=!0),t.backstoreOnly||this._setCssDimension(i,r);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),t.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(e,t){return this.lowerCanvasEl[e]=t,this.upperCanvasEl&&(this.upperCanvasEl[e]=t),this.cacheCanvasEl&&(this.cacheCanvasEl[e]=t),this[e]=t,this},_setCssDimension:function(e,t){return this.lowerCanvasEl.style[e]=t,this.upperCanvasEl&&(this.upperCanvasEl.style[e]=t),this.wrapperEl&&(this.wrapperEl.style[e]=t),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(e){var t,r,i,n=this._activeObject,a=this.backgroundImage,s=this.overlayImage;for(this.viewportTransform=e,r=0,i=this._objects.length;r<i;r++)(t=this._objects[r]).group||t.setCoords(!0);return n&&n.setCoords(),a&&a.setCoords(!0),s&&s.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(e,t){var r=e,i=this.viewportTransform.slice(0);e=n(e,a(this.viewportTransform)),i[0]=t,i[3]=t;var s=n(e,i);return i[4]+=r.x-s.x,i[5]+=r.y-s.y,this.setViewportTransform(i)},setZoom:function(e){return this.zoomToPoint(new k.Point(0,0),e),this},absolutePan:function(e){var t=this.viewportTransform.slice(0);return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)},relativePan:function(e){return this.absolutePan(new k.Point(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(e){this.stateful&&e.setupState(),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added")},_onObjectRemoved:function(e){this.fire("object:removed",{target:e}),e.fire("removed"),delete e.canvas},clearContext:function(e){return e.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var e=this.contextContainer;return this.renderCanvas(e,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=k.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var e={},t=this.width,r=this.height,i=a(this.viewportTransform);return e.tl=n({x:0,y:0},i),e.br=n({x:t,y:r},i),e.tr=new k.Point(e.br.x,e.tl.y),e.bl=new k.Point(e.tl.x,e.br.y),this.vptCoords=e,e},cancelRequestedRender:function(){this.isRendering&&(k.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(e,t){var r=this.viewportTransform,i=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(e),k.util.setImageSmoothing(e,this.imageSmoothingEnabled),this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(e,t),e.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),i&&(i.canvas=this,i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e)),this._renderOverlay(e),this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.fire("after:render",{ctx:e})},drawClipPathOnCanvas:function(e){var t=this.viewportTransform,r=this.clipPath;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5]),e.globalCompositeOperation="destination-in",r.transform(e),e.scale(1/r.zoomX,1/r.zoomY),e.drawImage(r._cacheCanvas,-r.cacheTranslationX,-r.cacheTranslationY),e.restore()},_renderObjects:function(e,t){var r,i;for(r=0,i=t.length;r<i;++r)t[r]&&t[r].render(e)},_renderBackgroundOrOverlay:function(e,t){var r=this[t+"Color"],i=this[t+"Image"],n=this.viewportTransform,a=this[t+"Vpt"];if(r||i){if(r){e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=r.toLive?r.toLive(e,this):r,a&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),e.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);var s=r.gradientTransform||r.patternTransform;s&&e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),e.fill(),e.restore()}i&&(e.save(),a&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),i.render(e),e.restore())}},_renderBackground:function(e){this._renderBackgroundOrOverlay(e,"background")},_renderOverlay:function(e){this._renderBackgroundOrOverlay(e,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new k.Point(this.width/2,this.height/2)},centerObjectH:function(e){return this._centerObject(e,new k.Point(this.getCenterPoint().x,e.getCenterPoint().y))},centerObjectV:function(e){return this._centerObject(e,new k.Point(e.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(e){var t=this.getCenterPoint();return this._centerObject(e,t)},viewportCenterObject:function(e){var t=this.getVpCenter();return this._centerObject(e,t)},viewportCenterObjectH:function(e){var t=this.getVpCenter();return this._centerObject(e,new k.Point(t.x,e.getCenterPoint().y)),this},viewportCenterObjectV:function(e){var t=this.getVpCenter();return this._centerObject(e,new k.Point(e.getCenterPoint().x,t.y))},getVpCenter:function(){var e=this.getCenterPoint(),t=a(this.viewportTransform);return n(e,t)},_centerObject:function(e,t){return e.setPositionByOrigin(t,"center","center"),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(e){return this.toDatalessObject(e)},toObject:function(e){return this._toObjectMethod("toObject",e)},toDatalessObject:function(e){return this._toObjectMethod("toDatalessObject",e)},_toObjectMethod:function(t,r){var i=this.clipPath,n={version:k.version,objects:this._toObjects(t,r)};return i&&!i.excludeFromExport&&(n.clipPath=this._toObject(this.clipPath,t,r)),e(n,this.__serializeBgOverlay(t,r)),k.util.populateWithProperties(this,n,r),n},_toObjects:function(e,t){return this._objects.filter((function(e){return!e.excludeFromExport})).map((function(r){return this._toObject(r,e,t)}),this)},_toObject:function(e,t,r){var i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);var n=e[t](r);return this.includeDefaultValues||(e.includeDefaultValues=i),n},__serializeBgOverlay:function(e,t){var r={},i=this.backgroundImage,n=this.overlayImage,a=this.backgroundColor,s=this.overlayColor;return a&&a.toObject?a.excludeFromExport||(r.background=a.toObject(t)):a&&(r.background=a),s&&s.toObject?s.excludeFromExport||(r.overlay=s.toObject(t)):s&&(r.overlay=s),i&&!i.excludeFromExport&&(r.backgroundImage=this._toObject(i,e,t)),n&&!n.excludeFromExport&&(r.overlayImage=this._toObject(n,e,t)),r},svgViewportTransformation:!0,toSVG:function(e,t){e||(e={}),e.reviver=t;var r=[];return this._setSVGPreamble(r,e),this._setSVGHeader(r,e),this.clipPath&&r.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",t),this._setSVGObjects(r,t),this.clipPath&&r.push("</g>\n"),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",t),r.push("</svg>"),r.join("")},_setSVGPreamble:function(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(e,t){var r,n=t.width||this.width,a=t.height||this.height,s='viewBox="0 0 '+this.width+" "+this.height+'" ',o=k.Object.NUM_FRACTION_DIGITS;t.viewBox?s='viewBox="'+t.viewBox.x+" "+t.viewBox.y+" "+t.viewBox.width+" "+t.viewBox.height+'" ':this.svgViewportTransformation&&(r=this.viewportTransform,s='viewBox="'+i(-r[4]/r[0],o)+" "+i(-r[5]/r[3],o)+" "+i(this.width/r[0],o)+" "+i(this.height/r[3],o)+'" '),e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',a,'" ',s,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",k.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),"</defs>\n")},createSVGClipPathMarkup:function(e){var t=this.clipPath;return t?(t.clipPathId="CLIPPATH_"+k.Object.__uid++,'<clipPath id="'+t.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(e.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var e=this;return["background","overlay"].map((function(t){var r=e[t+"Color"];if(r&&r.toLive){var i=e[t+"Vpt"],n=e.viewportTransform,a={width:e.width/(i?n[0]:1),height:e.height/(i?n[3]:1)};return r.toSVG(a,{additionalTransform:i?k.util.matrixToSVG(n):""})}})).join("")},createSVGFontFacesMarkup:function(){var e,t,r,i,n,a,s,o,c="",l={},u=k.fontPaths,h=[];for(this._objects.forEach((function e(t){h.push(t),t._objects&&t._objects.forEach(e)})),s=0,o=h.length;s<o;s++)if(t=(e=h[s]).fontFamily,-1!==e.type.indexOf("text")&&!l[t]&&u[t]&&(l[t]=!0,e.styles))for(n in r=e.styles)for(a in i=r[n])!l[t=i[a].fontFamily]&&u[t]&&(l[t]=!0);for(var f in l)c+=["\t\t@font-face {\n","\t\t\tfont-family: '",f,"';\n","\t\t\tsrc: url('",u[f],"');\n","\t\t}\n"].join("");return c&&(c=['\t<style type="text/css">',"<![CDATA[\n",c,"]]>","</style>\n"].join("")),c},_setSVGObjects:function(e,t){var r,i,n,a=this._objects;for(i=0,n=a.length;i<n;i++)(r=a[i]).excludeFromExport||this._setSVGObject(e,r,t)},_setSVGObject:function(e,t,r){e.push(t.toSVG(r))},_setSVGBgOverlayImage:function(e,t,r){this[t]&&!this[t].excludeFromExport&&this[t].toSVG&&e.push(this[t].toSVG(r))},_setSVGBgOverlayColor:function(e,t){var r=this[t+"Color"],i=this.viewportTransform,n=this.width,a=this.height;if(r)if(r.toLive){var s=r.repeat,o=k.util.invertTransform(i),c=this[t+"Vpt"]?k.util.matrixToSVG(o):"";e.push('<rect transform="'+c+" translate(",n/2,",",a/2,')"',' x="',r.offsetX-n/2,'" y="',r.offsetY-a/2,'" ','width="',"repeat-y"===s||"no-repeat"===s?r.source.width:n,'" height="',"repeat-x"===s||"no-repeat"===s?r.source.height:a,'" fill="url(#SVGID_'+r.id+')"',"></rect>\n")}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',"></rect>\n")},sendToBack:function(e){if(!e)return this;var t,i,n,a=this._activeObject;if(e===a&&"activeSelection"===e.type)for(t=(n=a._objects).length;t--;)i=n[t],r(this._objects,i),this._objects.unshift(i);else r(this._objects,e),this._objects.unshift(e);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(e){if(!e)return this;var t,i,n,a=this._activeObject;if(e===a&&"activeSelection"===e.type)for(n=a._objects,t=0;t<n.length;t++)i=n[t],r(this._objects,i),this._objects.push(i);else r(this._objects,e),this._objects.push(e);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(e,t){if(!e)return this;var i,n,a,s,o,c=this._activeObject,l=0;if(e===c&&"activeSelection"===e.type)for(o=c._objects,i=0;i<o.length;i++)n=o[i],(a=this._objects.indexOf(n))>0+l&&(s=a-1,r(this._objects,n),this._objects.splice(s,0,n)),l++;else 0!==(a=this._objects.indexOf(e))&&(s=this._findNewLowerIndex(e,a,t),r(this._objects,e),this._objects.splice(s,0,e));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(e,t,r){var i,n;if(r)for(i=t,n=t-1;n>=0;--n){if(e.intersectsWithObject(this._objects[n])||e.isContainedWithinObject(this._objects[n])||this._objects[n].isContainedWithinObject(e)){i=n;break}}else i=t-1;return i},bringForward:function(e,t){if(!e)return this;var i,n,a,s,o,c=this._activeObject,l=0;if(e===c&&"activeSelection"===e.type)for(i=(o=c._objects).length;i--;)n=o[i],(a=this._objects.indexOf(n))<this._objects.length-1-l&&(s=a+1,r(this._objects,n),this._objects.splice(s,0,n)),l++;else(a=this._objects.indexOf(e))!==this._objects.length-1&&(s=this._findNewUpperIndex(e,a,t),r(this._objects,e),this._objects.splice(s,0,e));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(e,t,r){var i,n,a;if(r)for(i=t,n=t+1,a=this._objects.length;n<a;++n){if(e.intersectsWithObject(this._objects[n])||e.isContainedWithinObject(this._objects[n])||this._objects[n].isContainedWithinObject(e)){i=n;break}}else i=t+1;return i},moveTo:function(e,t){return r(this._objects,e),this._objects.splice(t,0,e),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(k.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(e){e.dispose&&e.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),k.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),k.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),e(k.StaticCanvas.prototype,k.Observable),e(k.StaticCanvas.prototype,k.Collection),e(k.StaticCanvas.prototype,k.DataURLExporter),e(k.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(e){var t=o();if(!t||!t.getContext)return null;var r=t.getContext("2d");return r&&"setLineDash"===e?void 0!==r.setLineDash:null}}),k.StaticCanvas.prototype.toJSON=k.StaticCanvas.prototype.toObject,k.isLikelyNode&&(k.StaticCanvas.prototype.createPNGStream=function(){var e=s(this.lowerCanvasEl);return e&&e.createPNGStream()},k.StaticCanvas.prototype.createJPEGStream=function(e){var t=s(this.lowerCanvasEl);return t&&t.createJPEGStream(e)})}}(),k.BaseBrush=k.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(e){var t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])},_setShadow:function(){if(this.shadow){var e=this.canvas,t=this.shadow,r=e.contextTop,i=e.getZoom();e&&e._isRetinaScaling()&&(i*=k.devicePixelRatio),r.shadowColor=t.color,r.shadowBlur=t.blur*i,r.shadowOffsetX=t.offsetX*i,r.shadowOffsetY=t.offsetY*i}},needsFullRender:function(){return new k.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0},_isOutSideCanvas:function(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}}),k.PencilBrush=k.util.createClass(k.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(e){this.canvas=e,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(e,t,r){var i=t.midPointFrom(r);return e.quadraticCurveTo(t.x,t.y,i.x,i.y),i},onMouseDown:function(e,t){this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],this._prepareForDrawing(e),this._captureDrawingPath(e),this._render())},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],(!0!==this.limitedToCanvasSize||!this._isOutSideCanvas(e))&&this._captureDrawingPath(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var r=this._points,i=r.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,r[i-2],r[i-1],!0),n.stroke(),n.restore()}},onMouseUp:function(e){return!this.canvas._isMainEvent(e.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(e){var t=new k.Point(e.x,e.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(e){var t=new k.Point(e.x,e.y);return this._addPoint(t)},_render:function(e){var t,r,i=this._points[0],n=this._points[1];if(e=e||this.canvas.contextTop,this._saveAndTransform(e),e.beginPath(),2===this._points.length&&i.x===n.x&&i.y===n.y){var a=this.width/1e3;i=new k.Point(i.x,i.y),n=new k.Point(n.x,n.y),i.x-=a,n.x+=a}for(e.moveTo(i.x,i.y),t=1,r=this._points.length;t<r;t++)this._drawSegment(e,i,n),i=this._points[t],n=this._points[t+1];e.lineTo(i.x,i.y),e.stroke(),e.restore()},convertPointsToSVGPath:function(e){var t=this.width/1e3;return k.util.getSmoothPathFromPoints(e,t)},_isEmptySVGPath:function(e){return"M 0 0 Q 0 0 0 0 L 0 0"===k.util.joinPath(e)},createPath:function(e){var t=new k.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new k.Shadow(this.shadow)),t},decimatePoints:function(e,t){if(e.length<=2)return e;var r,i=this.canvas.getZoom(),n=Math.pow(t/i,2),a=e.length-1,s=e[0],o=[s];for(r=1;r<a-1;r++)Math.pow(s.x-e[r].x,2)+Math.pow(s.y-e[r].y,2)>=n&&(s=e[r],o.push(s));return o.push(e[a]),o},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e))this.canvas.requestRenderAll();else{var t=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.requestRenderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t})}}}),k.CircleBrush=k.util.createClass(k.BaseBrush,{width:10,initialize:function(e){this.canvas=e,this.points=[]},drawDot:function(e){var t=this.addPoint(e),r=this.canvas.contextTop;this._saveAndTransform(r),this.dot(r,t),r.restore()},dot:function(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!1),e.closePath(),e.fill()},onMouseDown:function(e){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)},_render:function(){var e,t,r=this.canvas.contextTop,i=this.points;for(this._saveAndTransform(r),e=0,t=i.length;e<t;e++)this.dot(r,i[e]);r.restore()},onMouseMove:function(e){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(e)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e))},onMouseUp:function(){var e,t,r=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var i=[];for(e=0,t=this.points.length;e<t;e++){var n=this.points[e],a=new k.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(a.shadow=new k.Shadow(this.shadow)),i.push(a)}var s=new k.Group(i);s.canvas=this.canvas,this.canvas.fire("before:path:created",{path:s}),this.canvas.add(s),this.canvas.fire("path:created",{path:s}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=r,this.canvas.requestRenderAll()},addPoint:function(e){var t=new k.Point(e.x,e.y),r=k.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,i=new k.Color(this.color).setAlpha(k.util.getRandomInt(0,100)/100).toRgba();return t.radius=r,t.fill=i,this.points.push(t),t}}),k.SprayBrush=k.util.createClass(k.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e,this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.render(this.sprayChunkPoints)},onMouseMove:function(e){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(e)||(this.addSprayChunk(e),this.render(this.sprayChunkPoints))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var t=[],r=0,i=this.sprayChunks.length;r<i;r++)for(var n=this.sprayChunks[r],a=0,s=n.length;a<s;a++){var o=new k.Rect({width:n[a].width,height:n[a].width,left:n[a].x+1,top:n[a].y+1,originX:"center",originY:"center",fill:this.color});t.push(o)}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var c=new k.Group(t);this.shadow&&c.set("shadow",new k.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},_getOptimizedRects:function(e){var t,r,i,n={};for(r=0,i=e.length;r<i;r++)n[t=e[r].left+""+e[r].top]||(n[t]=e[r]);var a=[];for(t in n)a.push(n[t]);return a},render:function(e){var t,r,i=this.canvas.contextTop;for(i.fillStyle=this.color,this._saveAndTransform(i),t=0,r=e.length;t<r;t++){var n=e[t];void 0!==n.opacity&&(i.globalAlpha=n.opacity),i.fillRect(n.x,n.y,n.width,n.width)}i.restore()},_render:function(){var e,t,r=this.canvas.contextTop;for(r.fillStyle=this.color,this._saveAndTransform(r),e=0,t=this.sprayChunks.length;e<t;e++)this.render(this.sprayChunks[e]);r.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];var t,r,i,n,a=this.width/2;for(n=0;n<this.density;n++){t=k.util.getRandomInt(e.x-a,e.x+a),r=k.util.getRandomInt(e.y-a,e.y+a),i=this.dotWidthVariance?k.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var s=new k.Point(t,r);s.width=i,this.randomOpacity&&(s.opacity=k.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(s)}this.sprayChunks.push(this.sprayChunkPoints)}}),k.PatternBrush=k.util.createClass(k.PencilBrush,{getPatternSrc:function(){var e=k.util.createCanvasElement(),t=e.getContext("2d");return e.width=e.height=25,t.fillStyle=this.color,t.beginPath(),t.arc(10,10,10,0,2*Math.PI,!1),t.closePath(),t.fill(),e},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(e){return e.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(e){this.callSuper("_setBrushStyles",e),e.strokeStyle=this.getPattern(e)},createPath:function(e){var t=this.callSuper("createPath",e),r=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new k.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-r.x,offsetY:-r.y}),t}}),function(){var e=k.util.getPointer,t=k.util.degreesToRadians,r=k.util.isTouchEvent;for(var i in k.Canvas=k.util.createClass(k.StaticCanvas,{initialize:function(e,t){t||(t={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(e,t),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=k.PencilBrush&&new k.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var e,t,r,i=this.getActiveObjects();if(i.length>0&&!this.preserveObjectStacking){t=[],r=[];for(var n=0,a=this._objects.length;n<a;n++)e=this._objects[n],-1===i.indexOf(e)?t.push(e):r.push(e);i.length>1&&(this._activeObject._objects=r),t.push.apply(t,r)}else t=this._objects;return t},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var e=this.contextContainer;return this.renderCanvas(e,this._chooseObjectsToRender()),this},renderTopLayer:function(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()},renderTop:function(){var e=this.contextTop;return this.clearContext(e),this.renderTopLayer(e),this.fire("after:render"),this},_normalizePointer:function(e,t){var r=e.calcTransformMatrix(),i=k.util.invertTransform(r),n=this.restorePointerVpt(t);return k.util.transformPoint(n,i)},isTargetTransparent:function(e,t,r){if(e.shouldCache()&&e._cacheCanvas&&e!==this._activeObject){var i=this._normalizePointer(e,{x:t,y:r}),n=Math.max(e.cacheTranslationX+i.x*e.zoomX,0),a=Math.max(e.cacheTranslationY+i.y*e.zoomY,0);return k.util.isTransparent(e._cacheContext,Math.round(n),Math.round(a),this.targetFindTolerance)}var s=this.contextCache,o=e.selectionBackgroundColor,c=this.viewportTransform;return e.selectionBackgroundColor="",this.clearContext(s),s.save(),s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),e.render(s),s.restore(),e.selectionBackgroundColor=o,k.util.isTransparent(s,t,r,this.targetFindTolerance)},_isSelectionKeyPressed:function(e){var t=!1;return t=Array.isArray(this.selectionKey)?!!this.selectionKey.find((function(t){return!0===e[t]})):e[this.selectionKey],t},_shouldClearSelection:function(e,t){var r=this.getActiveObjects(),i=this._activeObject;return!t||t&&i&&r.length>1&&-1===r.indexOf(t)&&i!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&i&&i!==t},_shouldCenterTransform:function(e,t,r){var i;if(e)return"scale"===t||"scaleX"===t||"scaleY"===t||"resizing"===t?i=this.centeredScaling||e.centeredScaling:"rotate"===t&&(i=this.centeredRotation||e.centeredRotation),i?!r:r},_getOriginFromCorner:function(e,t){var r={x:e.originX,y:e.originY};return"ml"===t||"tl"===t||"bl"===t?r.x="right":"mr"!==t&&"tr"!==t&&"br"!==t||(r.x="left"),"tl"===t||"mt"===t||"tr"===t?r.y="bottom":"bl"!==t&&"mb"!==t&&"br"!==t||(r.y="top"),r},_getActionFromCorner:function(e,t,r,i){if(!t||!e)return"drag";var n=i.controls[t];return n.getActionName(r,n,i)},_setupCurrentTransform:function(e,r,i){if(r){var n=this.getPointer(e),a=r.__corner,s=r.controls[a],o=i&&a?s.getActionHandler(e,r,s):k.controlsUtils.dragHandler,c=this._getActionFromCorner(i,a,e,r),l=this._getOriginFromCorner(r,a),u=e[this.centeredKey],h={target:r,action:c,actionHandler:o,corner:a,scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,offsetX:n.x-r.left,offsetY:n.y-r.top,originX:l.x,originY:l.y,ex:n.x,ey:n.y,lastX:n.x,lastY:n.y,theta:t(r.angle),width:r.width*r.scaleX,shiftKey:e.shiftKey,altKey:u,original:k.util.saveObjectTransform(r)};this._shouldCenterTransform(r,c,u)&&(h.originX="center",h.originY="center"),h.original.originX=l.x,h.original.originY=l.y,this._currentTransform=h,this._beforeTransform(e)}},setCursor:function(e){this.upperCanvasEl.style.cursor=e},_drawSelection:function(e){var t=this._groupSelector,r=new k.Point(t.ex,t.ey),i=k.util.transformPoint(r,this.viewportTransform),n=new k.Point(t.ex+t.left,t.ey+t.top),a=k.util.transformPoint(n,this.viewportTransform),s=Math.min(i.x,a.x),o=Math.min(i.y,a.y),c=Math.max(i.x,a.x),l=Math.max(i.y,a.y),u=this.selectionLineWidth/2;this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(s,o,c-s,l-o)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,s+=u,o+=u,c-=u,l-=u,k.Object.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(s,o,c-s,l-o))},findTarget:function(e,t){if(!this.skipTargetFind){var i,n,a=this.getPointer(e,!0),s=this._activeObject,o=this.getActiveObjects(),c=r(e),l=o.length>1&&!t||1===o.length;if(this.targets=[],l&&s._findTargetCorner(a,c))return s;if(o.length>1&&!t&&s===this._searchPossibleTargets([s],a))return s;if(1===o.length&&s===this._searchPossibleTargets([s],a)){if(!this.preserveObjectStacking)return s;i=s,n=this.targets,this.targets=[]}var u=this._searchPossibleTargets(this._objects,a);return e[this.altSelectionKey]&&u&&i&&u!==i&&(u=i,this.targets=n),u}},_checkTarget:function(e,t,r){if(t&&t.visible&&t.evented&&t.containsPoint(e)){if(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing)return!0;if(!this.isTargetTransparent(t,r.x,r.y))return!0}},_searchPossibleTargets:function(e,t){for(var r,i,n=e.length;n--;){var a=e[n],s=a.group?this._normalizePointer(a.group,t):t;if(this._checkTarget(s,a,t)){(r=e[n]).subTargetCheck&&r instanceof k.Group&&(i=this._searchPossibleTargets(r._objects,t))&&this.targets.push(i);break}}return r},restorePointerVpt:function(e){return k.util.transformPoint(e,k.util.invertTransform(this.viewportTransform))},getPointer:function(t,r){if(this._absolutePointer&&!r)return this._absolutePointer;if(this._pointer&&r)return this._pointer;var i,n=e(t),a=this.upperCanvasEl,s=a.getBoundingClientRect(),o=s.width||0,c=s.height||0;o&&c||("top"in s&&"bottom"in s&&(c=Math.abs(s.top-s.bottom)),"right"in s&&"left"in s&&(o=Math.abs(s.right-s.left))),this.calcOffset(),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,r||(n=this.restorePointerVpt(n));var l=this.getRetinaScaling();return 1!==l&&(n.x/=l,n.y/=l),i=0===o||0===c?{width:1,height:1}:{width:a.width/o,height:a.height/c},{x:n.x*i.width,y:n.y*i.height}},_createUpperCanvas:function(){var e=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),t=this.lowerCanvasEl,r=this.upperCanvasEl;r?r.className="":(r=this._createCanvasElement(),this.upperCanvasEl=r),k.util.addClass(r,"upper-canvas "+e),this.wrapperEl.appendChild(r),this._copyCanvasStyle(t,r),this._applyCanvasStyle(r),this.contextTop=r.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=k.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),k.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),k.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(e){var t=this.width||e.width,r=this.height||e.height;k.util.setStyle(e,{position:"absolute",width:t+"px",height:r+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),e.width=t,e.height=r,k.util.makeElementUnselectable(e)},_copyCanvasStyle:function(e,t){t.style.cssText=e.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var e=this._activeObject;return e?"activeSelection"===e.type&&e._objects?e._objects.slice(0):[e]:[]},_onObjectRemoved:function(e){e===this._activeObject&&(this.fire("before:selection:cleared",{target:e}),this._discardActiveObject(),this.fire("selection:cleared",{target:e}),e.fire("deselected")),e===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",e)},_fireSelectionEvents:function(e,t){var r=!1,i=this.getActiveObjects(),n=[],a=[];e.forEach((function(e){-1===i.indexOf(e)&&(r=!0,e.fire("deselected",{e:t,target:e}),a.push(e))})),i.forEach((function(i){-1===e.indexOf(i)&&(r=!0,i.fire("selected",{e:t,target:i}),n.push(i))})),e.length>0&&i.length>0?r&&this.fire("selection:updated",{e:t,selected:n,deselected:a}):i.length>0?this.fire("selection:created",{e:t,selected:n}):e.length>0&&this.fire("selection:cleared",{e:t,deselected:a})},setActiveObject:function(e,t){var r=this.getActiveObjects();return this._setActiveObject(e,t),this._fireSelectionEvents(r,t),this},_setActiveObject:function(e,t){return this._activeObject!==e&&(!!this._discardActiveObject(t,e)&&(!e.onSelect({e:t})&&(this._activeObject=e,!0)))},_discardActiveObject:function(e,t){var r=this._activeObject;if(r){if(r.onDeselect({e:e,object:t}))return!1;this._activeObject=null}return!0},discardActiveObject:function(e){var t=this.getActiveObjects(),r=this.getActiveObject();return t.length&&this.fire("before:selection:cleared",{target:r,e:e}),this._discardActiveObject(e),this._fireSelectionEvents(t,e),this},dispose:function(){var e=this.wrapperEl;return this.removeListeners(),e.removeChild(this.upperCanvasEl),e.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(e){k.util.cleanUpJsdomNode(this[e]),this[e]=void 0}.bind(this)),e.parentNode&&e.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,k.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(e){var t=this._activeObject;t&&t._renderControls(e)},_toObject:function(e,t,r){var i=this._realizeGroupTransformOnObject(e),n=this.callSuper("_toObject",e,t,r);return this._unwindGroupTransformOnObject(e,i),n},_realizeGroupTransformOnObject:function(e){if(e.group&&"activeSelection"===e.group.type&&this._activeObject===e.group){var t={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(r){t[r]=e[r]})),k.util.addTransformToObject(e,this._activeObject.calcOwnMatrix()),t}return null},_unwindGroupTransformOnObject:function(e,t){t&&e.set(t)},_setSVGObject:function(e,t,r){var i=this._realizeGroupTransformOnObject(t);this.callSuper("_setSVGObject",e,t,r),this._unwindGroupTransformOnObject(t,i)},setViewportTransform:function(e){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),k.StaticCanvas.prototype.setViewportTransform.call(this,e)}}),k.StaticCanvas)"prototype"!==i&&(k.Canvas[i]=k.StaticCanvas[i])}(),function(){var e=k.util.addListener,t=k.util.removeListener,r={passive:!1};function i(e,t){return e.button&&e.button===t-1}k.util.object.extend(k.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(e,t){var i=this.upperCanvasEl,n=this._getEventPrefix();e(k.window,"resize",this._onResize),e(i,n+"down",this._onMouseDown),e(i,n+"move",this._onMouseMove,r),e(i,n+"out",this._onMouseOut),e(i,n+"enter",this._onMouseEnter),e(i,"wheel",this._onMouseWheel),e(i,"contextmenu",this._onContextMenu),e(i,"dblclick",this._onDoubleClick),e(i,"dragover",this._onDragOver),e(i,"dragenter",this._onDragEnter),e(i,"dragleave",this._onDragLeave),e(i,"drop",this._onDrop),this.enablePointerEvents||e(i,"touchstart",this._onTouchStart,r),"undefined"!=typeof eventjs&&t in eventjs&&(eventjs[t](i,"gesture",this._onGesture),eventjs[t](i,"drag",this._onDrag),eventjs[t](i,"orientation",this._onOrientationChange),eventjs[t](i,"shake",this._onShake),eventjs[t](i,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(t,"remove");var e=this._getEventPrefix();t(k.document,e+"up",this._onMouseUp),t(k.document,"touchend",this._onTouchEnd,r),t(k.document,e+"move",this._onMouseMove,r),t(k.document,"touchmove",this._onMouseMove,r)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(e,t){this.__onTransformGesture&&this.__onTransformGesture(e,t)},_onDrag:function(e,t){this.__onDrag&&this.__onDrag(e,t)},_onMouseWheel:function(e){this.__onMouseWheel(e)},_onMouseOut:function(e){var t=this._hoveredTarget;this.fire("mouse:out",{target:t,e:e}),this._hoveredTarget=null,t&&t.fire("mouseout",{e:e});var r=this;this._hoveredTargets.forEach((function(i){r.fire("mouse:out",{target:t,e:e}),i&&t.fire("mouseout",{e:e})})),this._hoveredTargets=[]},_onMouseEnter:function(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",{target:null,e:e}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(e,t){this.__onOrientationChange&&this.__onOrientationChange(e,t)},_onShake:function(e,t){this.__onShake&&this.__onShake(e,t)},_onLongPress:function(e,t){this.__onLongPress&&this.__onLongPress(e,t)},_onDragOver:function(e){e.preventDefault();var t=this._simpleEventHandler("dragover",e);this._fireEnterLeaveEvents(t,e)},_onDrop:function(e){return this._simpleEventHandler("drop:before",e),this._simpleEventHandler("drop",e)},_onContextMenu:function(e){return this.stopContextMenu&&(e.stopPropagation(),e.preventDefault()),!1},_onDoubleClick:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData(e)},getPointerId:function(e){var t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1},_isMainEvent:function(e){return!0===e.isPrimary||!1!==e.isPrimary&&("touchend"===e.type&&0===e.touches.length||(!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId))},_onTouchStart:function(i){i.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(i)),this.__onMouseDown(i),this._resetTransformEventData();var n=this.upperCanvasEl,a=this._getEventPrefix();e(k.document,"touchend",this._onTouchEnd,r),e(k.document,"touchmove",this._onMouseMove,r),t(n,a+"down",this._onMouseDown)},_onMouseDown:function(i){this.__onMouseDown(i),this._resetTransformEventData();var n=this.upperCanvasEl,a=this._getEventPrefix();t(n,a+"move",this._onMouseMove,r),e(k.document,a+"up",this._onMouseUp),e(k.document,a+"move",this._onMouseMove,r)},_onTouchEnd:function(i){if(!(i.touches.length>0)){this.__onMouseUp(i),this._resetTransformEventData(),this.mainTouchId=null;var n=this._getEventPrefix();t(k.document,"touchend",this._onTouchEnd,r),t(k.document,"touchmove",this._onMouseMove,r);var a=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){e(a.upperCanvasEl,n+"down",a._onMouseDown),a._willAddMouseDown=0}),400)}},_onMouseUp:function(i){this.__onMouseUp(i),this._resetTransformEventData();var n=this.upperCanvasEl,a=this._getEventPrefix();this._isMainEvent(i)&&(t(k.document,a+"up",this._onMouseUp),t(k.document,a+"move",this._onMouseMove,r),e(n,a+"move",this._onMouseMove,r))},_onMouseMove:function(e){!this.allowTouchScrolling&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)},_onResize:function(){this.calcOffset()},_shouldRender:function(e){var t=this._activeObject;return!!(!!t!=!!e||t&&e&&t!==e)||(t&&t.isEditing,!1)},__onMouseUp:function(e){var t,r=this._currentTransform,n=this._groupSelector,a=!1,s=!n||0===n.left&&0===n.top;if(this._cacheTransformEventData(e),t=this._target,this._handleEvent(e,"up:before"),i(e,3))this.fireRightClick&&this._handleEvent(e,"up",3,s);else{if(i(e,2))return this.fireMiddleClick&&this._handleEvent(e,"up",2,s),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(e);else if(this._isMainEvent(e)){if(r&&(this._finalizeCurrentTransform(e),a=r.actionPerformed),!s){var o=t===this._activeObject;this._maybeGroupObjects(e),a||(a=this._shouldRender(t)||!o&&t===this._activeObject)}var c,l;if(t){if(c=t._findTargetCorner(this.getPointer(e,!0),k.util.isTouchEvent(e)),t.selectable&&t!==this._activeObject&&"up"===t.activeOn)this.setActiveObject(t,e),a=!0;else{var u=t.controls[c],h=u&&u.getMouseUpHandler(e,t,u);h&&h(e,r,(l=this.getPointer(e)).x,l.y)}t.isMoving=!1}if(r&&(r.target!==t||r.corner!==c)){var f=r.target&&r.target.controls[r.corner],d=f&&f.getMouseUpHandler(e,t,u);l=l||this.getPointer(e),d&&d(e,r,l.x,l.y)}this._setCursorFromEvent(e,t),this._handleEvent(e,"up",1,s),this._groupSelector=null,this._currentTransform=null,t&&(t.__corner=0),a?this.requestRenderAll():s||this.renderTop()}}},_simpleEventHandler:function(e,t){var r=this.findTarget(t),i=this.targets,n={e:t,target:r,subTargets:i};if(this.fire(e,n),r&&r.fire(e,n),!i)return r;for(var a=0;a<i.length;a++)i[a].fire(e,n);return r},_handleEvent:function(e,t,r,i){var n=this._target,a=this.targets||[],s={e:e,target:n,subTargets:a,button:r||1,isClick:i||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===t&&(s.currentTarget=this.findTarget(e),s.currentSubTargets=this.targets),this.fire("mouse:"+t,s),n&&n.fire("mouse"+t,s);for(var o=0;o<a.length;o++)a[o].fire("mouse"+t,s)},_finalizeCurrentTransform:function(e){var t=this._currentTransform,r=t.target,i={e:e,target:r,transform:t,action:t.action};r._scaling&&(r._scaling=!1),r.setCoords(),(t.actionPerformed||this.stateful&&r.hasStateChanged())&&this._fire("modified",i)},_onMouseDownInDrawingMode:function(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(e).requestRenderAll();var t=this.getPointer(e);this.freeDrawingBrush.onMouseDown(t,{e:e,pointer:t}),this._handleEvent(e,"down")},_onMouseMoveInDrawingMode:function(e){if(this._isCurrentlyDrawing){var t=this.getPointer(e);this.freeDrawingBrush.onMouseMove(t,{e:e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")},_onMouseUpInDrawingMode:function(e){var t=this.getPointer(e);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:e,pointer:t}),this._handleEvent(e,"up")},__onMouseDown:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"down:before");var t=this._target;if(i(e,3))this.fireRightClick&&this._handleEvent(e,"down",3);else if(i(e,2))this.fireMiddleClick&&this._handleEvent(e,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(e);else if(this._isMainEvent(e)&&!this._currentTransform){var r=this._pointer;this._previousPointer=r;var n=this._shouldRender(t),a=this._shouldGroup(e,t);if(this._shouldClearSelection(e,t)?this.discardActiveObject(e):a&&(this._handleGrouping(e,t),t=this._activeObject),!this.selection||t&&(t.selectable||t.isEditing||t===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),t){var s=t===this._activeObject;t.selectable&&"down"===t.activeOn&&this.setActiveObject(t,e);var o=t._findTargetCorner(this.getPointer(e,!0),k.util.isTouchEvent(e));if(t.__corner=o,t===this._activeObject&&(o||!a)){this._setupCurrentTransform(e,t,s);var c=t.controls[o],l=(r=this.getPointer(e),c&&c.getMouseDownHandler(e,t,c));l&&l(e,this._currentTransform,r.x,r.y)}}this._handleEvent(e,"down"),(n||a)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(e){this._resetTransformEventData(),this._pointer=this.getPointer(e,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)||null},_beforeTransform:function(e){var t=this._currentTransform;this.stateful&&t.target.saveState(),this.fire("before:transform",{e:e,transform:t})},__onMouseMove:function(e){var t,r;if(this._handleEvent(e,"move:before"),this._cacheTransformEventData(e),this.isDrawingMode)this._onMouseMoveInDrawingMode(e);else if(this._isMainEvent(e)){var i=this._groupSelector;i?(r=this._absolutePointer,i.left=r.x-i.ex,i.top=r.y-i.ey,this.renderTop()):this._currentTransform?this._transformObject(e):(t=this.findTarget(e)||null,this._setCursorFromEvent(e,t),this._fireOverOutEvents(t,e)),this._handleEvent(e,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(e,t){var r=this._hoveredTarget,i=this._hoveredTargets,n=this.targets,a=Math.max(i.length,n.length);this.fireSyntheticInOutEvents(e,t,{oldTarget:r,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var s=0;s<a;s++)this.fireSyntheticInOutEvents(n[s],t,{oldTarget:i[s],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(e,t){var r=this._draggedoverTarget,i=this._hoveredTargets,n=this.targets,a=Math.max(i.length,n.length);this.fireSyntheticInOutEvents(e,t,{oldTarget:r,evtOut:"dragleave",evtIn:"dragenter"});for(var s=0;s<a;s++)this.fireSyntheticInOutEvents(n[s],t,{oldTarget:i[s],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=e},fireSyntheticInOutEvents:function(e,t,r){var i,n,a,s=r.oldTarget,o=s!==e,c=r.canvasEvtIn,l=r.canvasEvtOut;o&&(i={e:t,target:e,previousTarget:s},n={e:t,target:s,nextTarget:e}),a=e&&o,s&&o&&(l&&this.fire(l,n),s.fire(r.evtOut,n)),a&&(c&&this.fire(c,i),e.fire(r.evtIn,i))},__onMouseWheel:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()},_transformObject:function(e){var t=this.getPointer(e),r=this._currentTransform;r.reset=!1,r.shiftKey=e.shiftKey,r.altKey=e[this.centeredKey],this._performTransformAction(e,r,t),r.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(e,t,r){var i=r.x,n=r.y,a=t.action,s=!1,o=t.actionHandler;o&&(s=o(e,t,i,n)),"drag"===a&&s&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||s},_fire:k.controlsUtils.fireEvent,_setCursorFromEvent:function(e,t){if(!t)return this.setCursor(this.defaultCursor),!1;var r=t.hoverCursor||this.hoverCursor,i=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,n=(!i||!i.contains(t))&&t._findTargetCorner(this.getPointer(e,!0));n?this.setCursor(this.getCornerCursor(n,t,e)):(t.subTargetCheck&&this.targets.concat().reverse().map((function(e){r=e.hoverCursor||r})),this.setCursor(r))},getCornerCursor:function(e,t,r){var i=t.controls[e];return i.cursorStyleHandler(r,i,t)}})}(),b=Math.min,v=Math.max,k.util.object.extend(k.Canvas.prototype,{_shouldGroup:function(e,t){var r=this._activeObject;return r&&this._isSelectionKeyPressed(e)&&t&&t.selectable&&this.selection&&(r!==t||"activeSelection"===r.type)&&!t.onSelect({e:e})},_handleGrouping:function(e,t){var r=this._activeObject;r.__corner||(t!==r||(t=this.findTarget(e,!0))&&t.selectable)&&(r&&"activeSelection"===r.type?this._updateActiveSelection(t,e):this._createActiveSelection(t,e))},_updateActiveSelection:function(e,t){var r=this._activeObject,i=r._objects.slice(0);r.contains(e)?(r.removeWithUpdate(e),this._hoveredTarget=e,this._hoveredTargets=this.targets.concat(),1===r.size()&&this._setActiveObject(r.item(0),t)):(r.addWithUpdate(e),this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(i,t)},_createActiveSelection:function(e,t){var r=this.getActiveObjects(),i=this._createGroup(e);this._hoveredTarget=i,this._setActiveObject(i,t),this._fireSelectionEvents(r,t)},_createGroup:function(e){var t=this._objects,r=t.indexOf(this._activeObject)<t.indexOf(e)?[this._activeObject,e]:[e,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new k.ActiveSelection(r,{canvas:this})},_groupSelectedObjects:function(e){var t,r=this._collectObjects(e);1===r.length?this.setActiveObject(r[0],e):r.length>1&&(t=new k.ActiveSelection(r.reverse(),{canvas:this}),this.setActiveObject(t,e))},_collectObjects:function(e){for(var t,r=[],i=this._groupSelector.ex,n=this._groupSelector.ey,a=i+this._groupSelector.left,s=n+this._groupSelector.top,o=new k.Point(b(i,a),b(n,s)),c=new k.Point(v(i,a),v(n,s)),l=!this.selectionFullyContained,u=i===a&&n===s,h=this._objects.length;h--&&!((t=this._objects[h])&&t.selectable&&t.visible&&(l&&t.intersectsWithRect(o,c,!0)||t.isContainedWithinRect(o,c,!0)||l&&t.containsPoint(o,null,!0)||l&&t.containsPoint(c,null,!0))&&(r.push(t),u)););return r.length>1&&(r=r.filter((function(t){return!t.onSelect({e:e})}))),r},_maybeGroupObjects:function(e){this.selection&&this._groupSelector&&this._groupSelectedObjects(e),this.setCursor(this.defaultCursor),this._groupSelector=null}}),k.util.object.extend(k.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var t=e.format||"png",r=e.quality||1,i=(e.multiplier||1)*(e.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(i,e);return k.util.toDataURL(n,t,r)},toCanvasElement:function(e,t){e=e||1;var r=((t=t||{}).width||this.width)*e,i=(t.height||this.height)*e,n=this.getZoom(),a=this.width,s=this.height,o=n*e,c=this.viewportTransform,l=(c[4]-(t.left||0))*e,u=(c[5]-(t.top||0))*e,h=this.interactive,f=[o,0,0,o,l,u],d=this.enableRetinaScaling,p=k.util.createCanvasElement(),m=this.contextTop;return p.width=r,p.height=i,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=f,this.width=r,this.height=i,this.calcViewportBoundaries(),this.renderCanvas(p.getContext("2d"),this._objects),this.viewportTransform=c,this.width=a,this.height=s,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=d,this.contextTop=m,p}}),k.util.object.extend(k.StaticCanvas.prototype,{loadFromJSON:function(e,t,r){if(e){var i="string"==typeof e?JSON.parse(e):k.util.object.clone(e),n=this,a=i.clipPath,s=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete i.clipPath,this._enlivenObjects(i.objects,(function(e){n.clear(),n._setBgOverlay(i,(function(){a?n._enlivenObjects([a],(function(r){n.clipPath=r[0],n.__setupCanvas.call(n,i,e,s,t)})):n.__setupCanvas.call(n,i,e,s,t)}))}),r),this}},__setupCanvas:function(e,t,r,i){var n=this;t.forEach((function(e,t){n.insertAt(e,t)})),this.renderOnAddRemove=r,delete e.objects,delete e.backgroundImage,delete e.overlayImage,delete e.background,delete e.overlay,this._setOptions(e),this.renderAll(),i&&i()},_setBgOverlay:function(e,t){var r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(e.backgroundImage||e.overlayImage||e.background||e.overlay){var i=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&t&&t()};this.__setBgOverlay("backgroundImage",e.backgroundImage,r,i),this.__setBgOverlay("overlayImage",e.overlayImage,r,i),this.__setBgOverlay("backgroundColor",e.background,r,i),this.__setBgOverlay("overlayColor",e.overlay,r,i)}else t&&t()},__setBgOverlay:function(e,t,r,i){var n=this;if(!t)return r[e]=!0,void(i&&i());"backgroundImage"===e||"overlayImage"===e?k.util.enlivenObjects([t],(function(t){n[e]=t[0],r[e]=!0,i&&i()})):this["set"+k.util.string.capitalize(e,!0)](t,(function(){r[e]=!0,i&&i()}))},_enlivenObjects:function(e,t,r){e&&0!==e.length?k.util.enlivenObjects(e,(function(e){t&&t(e)}),null,r):t&&t([])},_toDataURL:function(e,t){this.clone((function(r){t(r.toDataURL(e))}))},_toDataURLWithMultiplier:function(e,t,r){this.clone((function(i){r(i.toDataURLWithMultiplier(e,t))}))},clone:function(e,t){var r=JSON.stringify(this.toJSON(t));this.cloneWithoutData((function(t){t.loadFromJSON(r,(function(){e&&e(t)}))}))},cloneWithoutData:function(e){var t=k.util.createCanvasElement();t.width=this.width,t.height=this.height;var r=new k.Canvas(t);this.backgroundImage?(r.setBackgroundImage(this.backgroundImage.src,(function(){r.renderAll(),e&&e(r)})),r.backgroundImageOpacity=this.backgroundImageOpacity,r.backgroundImageStretch=this.backgroundImageStretch):e&&e(r)}}),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.extend,i=t.util.object.clone,n=t.util.toFixed,a=t.util.string.capitalize,s=t.util.degreesToRadians,o=!t.isLikelyNode;t.Object||(t.Object=t.util.createClass(t.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:o,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(e){e&&this.setOptions(e)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=t.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(e){var r=t.perfLimitSizeTotal,i=e.width,n=e.height,a=t.maxCacheSideLimit,s=t.minCacheSideLimit;if(i<=a&&n<=a&&i*n<=r)return i<s&&(e.width=s),n<s&&(e.height=s),e;var o=i/n,c=t.util.limitDimsByArea(o,r),l=t.util.capValue,u=l(s,c.x,a),h=l(s,c.y,a);return i>u&&(e.zoomX/=i/u,e.width=u,e.capped=!0),n>h&&(e.zoomY/=n/h,e.height=h,e.capped=!0),e},_getCacheCanvasDimensions:function(){var e=this.getTotalObjectScaling(),t=this._getTransformedDimensions(0,0),r=t.x*e.scaleX/this.scaleX,i=t.y*e.scaleY/this.scaleY;return{width:r+2,height:i+2,zoomX:e.scaleX,zoomY:e.scaleY,x:r,y:i}},_updateCacheCanvas:function(){var e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){var r=e._currentTransform.target,i=e._currentTransform.action;if(this===r&&i.slice&&"scale"===i.slice(0,5))return!1}var n,a,s=this._cacheCanvas,o=this._limitCacheSize(this._getCacheCanvasDimensions()),c=t.minCacheSideLimit,l=o.width,u=o.height,h=o.zoomX,f=o.zoomY,d=l!==this.cacheWidth||u!==this.cacheHeight,p=this.zoomX!==h||this.zoomY!==f,m=d||p,b=0,v=0,g=!1;if(d){var y=this._cacheCanvas.width,_=this._cacheCanvas.height,w=l>y||u>_;g=w||(l<.9*y||u<.9*_)&&y>c&&_>c,w&&!o.capped&&(l>c||u>c)&&(b=.1*l,v=.1*u)}return this instanceof t.Text&&this.path&&(m=!0,g=!0,b+=this.getHeightOfLine(0)*this.zoomX,v+=this.getHeightOfLine(0)*this.zoomY),!!m&&(g?(s.width=Math.ceil(l+b),s.height=Math.ceil(u+v)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,s.width,s.height)),n=o.x/2,a=o.y/2,this.cacheTranslationX=Math.round(s.width/2-n)+n,this.cacheTranslationY=Math.round(s.height/2-a)+a,this.cacheWidth=l,this.cacheHeight=u,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(h,f),this.zoomX=h,this.zoomY=f,!0)},setOptions:function(e){this._setOptions(e),this._initGradient(e.fill,"fill"),this._initGradient(e.stroke,"stroke"),this._initPattern(e.fill,"fill"),this._initPattern(e.stroke,"stroke")},transform:function(e){var t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,r=this.calcTransformMatrix(!t);e.transform(r[0],r[1],r[2],r[3],r[4],r[5])},toObject:function(e){var r=t.Object.NUM_FRACTION_DIGITS,i={type:this.type,version:t.version,originX:this.originX,originY:this.originY,left:n(this.left,r),top:n(this.top,r),width:n(this.width,r),height:n(this.height,r),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,r),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,r),scaleX:n(this.scaleX,r),scaleY:n(this.scaleY,r),angle:n(this.angle,r),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,r),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,r),skewY:n(this.skewY,r)};return this.clipPath&&!this.clipPath.excludeFromExport&&(i.clipPath=this.clipPath.toObject(e),i.clipPath.inverted=this.clipPath.inverted,i.clipPath.absolutePositioned=this.clipPath.absolutePositioned),t.util.populateWithProperties(this,i,e),this.includeDefaultValues||(i=this._removeDefaultValues(i)),i},toDatalessObject:function(e){return this.toObject(e)},_removeDefaultValues:function(e){var r=t.util.getKlass(e.type).prototype;return r.stateProperties.forEach((function(t){"left"!==t&&"top"!==t&&(e[t]===r[t]&&delete e[t],Array.isArray(e[t])&&Array.isArray(r[t])&&0===e[t].length&&0===r[t].length&&delete e[t])})),e},toString:function(){return"#<fabric."+a(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var e=t.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(e.scaleX),scaleY:Math.abs(e.scaleY)}},getTotalObjectScaling:function(){var e=this.getObjectScaling(),t=e.scaleX,r=e.scaleY;if(this.canvas){var i=this.canvas.getZoom(),n=this.canvas.getRetinaScaling();t*=i*n,r*=i*n}return{scaleX:t,scaleY:r}},getObjectOpacity:function(){var e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e},_set:function(e,r){var i="scaleX"===e||"scaleY"===e,n=this[e]!==r,a=!1;return i&&(r=this._constrainScale(r)),"scaleX"===e&&r<0?(this.flipX=!this.flipX,r*=-1):"scaleY"===e&&r<0?(this.flipY=!this.flipY,r*=-1):"shadow"!==e||!r||r instanceof t.Shadow?"dirty"===e&&this.group&&this.group.set("dirty",r):r=new t.Shadow(r),this[e]=r,n&&(a=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(e)>-1?(this.dirty=!0,a&&this.group.set("dirty",!0)):a&&this.stateProperties.indexOf(e)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:t.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(e),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),e.restore())},renderCache:function(e){e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,e.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!==_(this.shadow))||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(e,r){if(e.save(),r.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",r.absolutePositioned){var i=t.util.invertTransform(this.calcTransformMatrix());e.transform(i[0],i[1],i[2],i[3],i[4],i[5])}r.transform(e),e.scale(1/r.zoomX,1/r.zoomY),e.drawImage(r._cacheCanvas,-r.cacheTranslationX,-r.cacheTranslationY),e.restore()},drawObject:function(e,t){var r=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath),this.fill=r,this.stroke=i},_drawClipPath:function(e,t){t&&(t.canvas=this.canvas,t.shouldCache(),t._transformDone=!0,t.renderCache({forClipping:!0}),this.drawClipPathOnCache(e,t))},drawCacheOnCanvas:function(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(e){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!e&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!e){var t=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-t/2,-r/2,t,r)}return!0}return!1},_renderBackground:function(e){if(this.backgroundColor){var t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}},_setOpacity:function(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity},_setStrokeStyles:function(e,t){var r=t.stroke;r&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,r.toLive?"percentage"===r.gradientUnits||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(e,r):(e.strokeStyle=r.toLive(e,this),this._applyPatternGradientTransform(e,r)):e.strokeStyle=t.stroke)},_setFillStyles:function(e,t){var r=t.fill;r&&(r.toLive?(e.fillStyle=r.toLive(e,this),this._applyPatternGradientTransform(e,t.fill)):e.fillStyle=r)},_setClippingProperties:function(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"},_setLineDash:function(e,t){t&&0!==t.length&&(1&t.length&&t.push.apply(t,t),e.setLineDash(t))},_renderControls:function(e,r){var i,n,a,o=this.getViewportTransform(),c=this.calcTransformMatrix();n=void 0!==(r=r||{}).hasBorders?r.hasBorders:this.hasBorders,a=void 0!==r.hasControls?r.hasControls:this.hasControls,c=t.util.multiplyTransformMatrices(o,c),i=t.util.qrDecompose(c),e.save(),e.translate(i.translateX,i.translateY),e.lineWidth=1*this.borderScaleFactor,this.group||(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(i.angle-=180),e.rotate(s(this.group?i.angle:this.angle)),r.forActiveSelection||this.group?n&&this.drawBordersInGroup(e,i,r):n&&this.drawBorders(e,r),a&&this.drawControls(e,r),e.restore()},_setShadow:function(e){if(this.shadow){var r,i=this.shadow,n=this.canvas,a=n&&n.viewportTransform[0]||1,s=n&&n.viewportTransform[3]||1;r=i.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),n&&n._isRetinaScaling()&&(a*=t.devicePixelRatio,s*=t.devicePixelRatio),e.shadowColor=i.color,e.shadowBlur=i.blur*t.browserShadowBlurConstant*(a+s)*(r.scaleX+r.scaleY)/4,e.shadowOffsetX=i.offsetX*a*r.scaleX,e.shadowOffsetY=i.offsetY*s*r.scaleY}},_removeShadow:function(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)},_applyPatternGradientTransform:function(e,t){if(!t||!t.toLive)return{offsetX:0,offsetY:0};var r=t.gradientTransform||t.patternTransform,i=-this.width/2+t.offsetX||0,n=-this.height/2+t.offsetY||0;return"percentage"===t.gradientUnits?e.transform(this.width,0,0,this.height,i,n):e.transform(1,0,0,1,i,n),r&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:i,offsetY:n}},_renderPaintInOrder:function(e){"stroke"===this.paintFirst?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))},_render:function(){},_renderFill:function(e){this.fill&&(e.save(),this._setFillStyles(e,this),"evenodd"===this.fillRule?e.fill("evenodd"):e.fill(),e.restore())},_renderStroke:function(e){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform&&this.group){var t=this.getObjectScaling();e.scale(1/t.scaleX,1/t.scaleY)}else this.strokeUniform&&e.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}},_applyPatternForTransformedGradient:function(e,r){var i,n=this._limitCacheSize(this._getCacheCanvasDimensions()),a=t.util.createCanvasElement(),s=this.canvas.getRetinaScaling(),o=n.x/this.scaleX/s,c=n.y/this.scaleY/s;a.width=o,a.height=c,(i=a.getContext("2d")).beginPath(),i.moveTo(0,0),i.lineTo(o,0),i.lineTo(o,c),i.lineTo(0,c),i.closePath(),i.translate(o/2,c/2),i.scale(n.zoomX/this.scaleX/s,n.zoomY/this.scaleY/s),this._applyPatternGradientTransform(i,r),i.fillStyle=r.toLive(e),i.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/n.zoomX,s*this.scaleY/n.zoomY),e.strokeStyle=i.createPattern(a,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var e=t.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",e.scaleX),this.set("scaleY",e.scaleY),this.angle=e.angle,this.skewX=e.skewX,this.skewY=0}},_removeTransformMatrix:function(e){var r=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),r=t.util.transformPoint(r,this.transformMatrix)),this.transformMatrix=null,e&&(this.scaleX*=e.scaleX,this.scaleY*=e.scaleY,this.cropX=e.cropX,this.cropY=e.cropY,r.x+=e.offsetLeft,r.y+=e.offsetTop,this.width=e.width,this.height=e.height),this.setPositionByOrigin(r,"center","center")},clone:function(e,r){var i=this.toObject(r);this.constructor.fromObject?this.constructor.fromObject(i,e):t.Object._fromObject("Object",i,e)},cloneAsImage:function(e,r){var i=this.toCanvasElement(r);return e&&e(new t.Image(i)),this},toCanvasElement:function(e){e||(e={});var r=t.util,i=r.saveObjectTransform(this),n=this.group,a=this.shadow,s=Math.abs,o=(e.multiplier||1)*(e.enableRetinaScaling?t.devicePixelRatio:1);delete this.group,e.withoutTransform&&r.resetObjectTransform(this),e.withoutShadow&&(this.shadow=null);var c,l,u,h,f=t.util.createCanvasElement(),d=this.getBoundingRect(!0,!0),p=this.shadow,m={x:0,y:0};p&&(l=p.blur,c=p.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),m.x=2*Math.round(s(p.offsetX)+l)*s(c.scaleX),m.y=2*Math.round(s(p.offsetY)+l)*s(c.scaleY)),u=d.width+m.x,h=d.height+m.y,f.width=Math.ceil(u),f.height=Math.ceil(h);var b=new t.StaticCanvas(f,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===e.format&&(b.backgroundColor="#fff"),this.setPositionByOrigin(new t.Point(b.width/2,b.height/2),"center","center");var v=this.canvas;b.add(this);var g=b.toCanvasElement(o||1,e);return this.shadow=a,this.set("canvas",v),n&&(this.group=n),this.set(i).setCoords(),b._objects=[],b.dispose(),b=null,g},toDataURL:function(e){return e||(e={}),t.util.toDataURL(this.toCanvasElement(e),e.format||"png",e.quality||1)},isType:function(e){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===e},complexity:function(){return 1},toJSON:function(e){return this.toObject(e)},rotate:function(e){var t=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return t&&this._setOriginToCenter(),this.set("angle",e),t&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(e,r){r=r||this.canvas.getPointer(e);var i=new t.Point(r.x,r.y),n=this._getLeftTopCoords();return this.angle&&(i=t.util.rotatePoint(i,n,s(-this.angle))),{x:i.x-n.x,y:i.y-n.y}},_setupCompositeOperation:function(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){t.runningAnimations&&t.runningAnimations.cancelByTarget(this)}}),t.util.createAccessors&&t.util.createAccessors(t.Object),r(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object.ENLIVEN_PROPS=["clipPath"],t.Object._fromObject=function(e,r,n,a){var s=t[e];r=i(r,!0),t.util.enlivenPatterns([r.fill,r.stroke],(function(e){void 0!==e[0]&&(r.fill=e[0]),void 0!==e[1]&&(r.stroke=e[1]),t.util.enlivenObjectEnlivables(r,r,(function(){var e=a?new s(r[a],r):new s(r);n&&n(e)}))}))},t.Object.__uid=0)}(e),g=k.util.degreesToRadians,y={left:-.5,center:0,right:.5},w={top:-.5,center:0,bottom:.5},k.util.object.extend(k.Object.prototype,{translateToGivenOrigin:function(e,t,r,i,n){var a,s,o,c=e.x,l=e.y;return"string"==typeof t?t=y[t]:t-=.5,"string"==typeof i?i=y[i]:i-=.5,"string"==typeof r?r=w[r]:r-=.5,"string"==typeof n?n=w[n]:n-=.5,s=n-r,((a=i-t)||s)&&(o=this._getTransformedDimensions(),c=e.x+a*o.x,l=e.y+s*o.y),new k.Point(c,l)},translateToCenterPoint:function(e,t,r){var i=this.translateToGivenOrigin(e,t,r,"center","center");return this.angle?k.util.rotatePoint(i,e,g(this.angle)):i},translateToOriginPoint:function(e,t,r){var i=this.translateToGivenOrigin(e,"center","center",t,r);return this.angle?k.util.rotatePoint(i,e,g(this.angle)):i},getCenterPoint:function(){var e=new k.Point(this.left,this.top);return this.translateToCenterPoint(e,this.originX,this.originY)},getPointByOrigin:function(e,t){var r=this.getCenterPoint();return this.translateToOriginPoint(r,e,t)},toLocalPoint:function(e,t,r){var i,n,a=this.getCenterPoint();return i=void 0!==t&&void 0!==r?this.translateToGivenOrigin(a,"center","center",t,r):new k.Point(this.left,this.top),n=new k.Point(e.x,e.y),this.angle&&(n=k.util.rotatePoint(n,a,-g(this.angle))),n.subtractEquals(i)},setPositionByOrigin:function(e,t,r){var i=this.translateToCenterPoint(e,t,r),n=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",n.x),this.set("top",n.y)},adjustPosition:function(e){var t,r,i=g(this.angle),n=this.getScaledWidth(),a=k.util.cos(i)*n,s=k.util.sin(i)*n;t="string"==typeof this.originX?y[this.originX]:this.originX-.5,r="string"==typeof e?y[e]:e-.5,this.left+=a*(r-t),this.top+=s*(r-t),this.setCoords(),this.originX=e},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var e=this.getCenterPoint();this.originX="center",this.originY="center",this.left=e.x,this.top=e.y},_resetOrigin:function(){var e=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=e.x,this.top=e.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var e=k.util,t=e.degreesToRadians,r=e.multiplyTransformMatrices,i=e.transformPoint;e.object.extend(k.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(e,t){return t?e?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),e?this.aCoords:this.lineCoords)},getCoords:function(e,t){return r=this._getCoords(e,t),[new k.Point(r.tl.x,r.tl.y),new k.Point(r.tr.x,r.tr.y),new k.Point(r.br.x,r.br.y),new k.Point(r.bl.x,r.bl.y)];var r},intersectsWithRect:function(e,t,r,i){var n=this.getCoords(r,i);return"Intersection"===k.Intersection.intersectPolygonRectangle(n,e,t).status},intersectsWithObject:function(e,t,r){return"Intersection"===k.Intersection.intersectPolygonPolygon(this.getCoords(t,r),e.getCoords(t,r)).status||e.isContainedWithinObject(this,t,r)||this.isContainedWithinObject(e,t,r)},isContainedWithinObject:function(e,t,r){for(var i=this.getCoords(t,r),n=t?e.aCoords:e.lineCoords,a=0,s=e._getImageLines(n);a<4;a++)if(!e.containsPoint(i[a],s))return!1;return!0},isContainedWithinRect:function(e,t,r,i){var n=this.getBoundingRect(r,i);return n.left>=e.x&&n.left+n.width<=t.x&&n.top>=e.y&&n.top+n.height<=t.y},containsPoint:function(e,t,r,i){var n=this._getCoords(r,i),a=(t=t||this._getImageLines(n),this._findCrossPoints(e,t));return 0!==a&&a%2==1},isOnScreen:function(e){if(!this.canvas)return!1;var t=this.canvas.vptCoords.tl,r=this.canvas.vptCoords.br;return!!this.getCoords(!0,e).some((function(e){return e.x<=r.x&&e.x>=t.x&&e.y<=r.y&&e.y>=t.y}))||(!!this.intersectsWithRect(t,r,!0,e)||this._containsCenterOfCanvas(t,r,e))},_containsCenterOfCanvas:function(e,t,r){var i={x:(e.x+t.x)/2,y:(e.y+t.y)/2};return!!this.containsPoint(i,null,!0,r)},isPartiallyOnScreen:function(e){if(!this.canvas)return!1;var t=this.canvas.vptCoords.tl,r=this.canvas.vptCoords.br;if(this.intersectsWithRect(t,r,!0,e))return!0;var i=this.getCoords(!0,e).every((function(e){return(e.x>=r.x||e.x<=t.x)&&(e.y>=r.y||e.y<=t.y)}));return i&&this._containsCenterOfCanvas(t,r,e)},_getImageLines:function(e){return{topline:{o:e.tl,d:e.tr},rightline:{o:e.tr,d:e.br},bottomline:{o:e.br,d:e.bl},leftline:{o:e.bl,d:e.tl}}},_findCrossPoints:function(e,t){var r,i,n,a=0;for(var s in t)if(!((n=t[s]).o.y<e.y&&n.d.y<e.y||n.o.y>=e.y&&n.d.y>=e.y||(n.o.x===n.d.x&&n.o.x>=e.x?i=n.o.x:(0,r=(n.d.y-n.o.y)/(n.d.x-n.o.x),i=-(e.y-0*e.x-(n.o.y-r*n.o.x))/(0-r)),i>=e.x&&(a+=1),2!==a)))break;return a},getBoundingRect:function(t,r){var i=this.getCoords(t,r);return e.makeBoundingBoxFromPoints(i)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:0===e?1e-4:e},scale:function(e){return this._set("scaleX",e),this._set("scaleY",e),this.setCoords()},scaleToWidth:function(e,t){var r=this.getBoundingRect(t).width/this.getScaledWidth();return this.scale(e/this.width/r)},scaleToHeight:function(e,t){var r=this.getBoundingRect(t).height/this.getScaledHeight();return this.scale(e/this.height/r)},calcLineCoords:function(){var r=this.getViewportTransform(),n=this.padding,a=t(this.angle),s=e.cos(a)*n,o=e.sin(a)*n,c=s+o,l=s-o,u=this.calcACoords(),h={tl:i(u.tl,r),tr:i(u.tr,r),bl:i(u.bl,r),br:i(u.br,r)};return n&&(h.tl.x-=l,h.tl.y-=c,h.tr.x+=c,h.tr.y-=l,h.bl.x-=c,h.bl.y+=l,h.br.x+=l,h.br.y+=c),h},calcOCoords:function(){var e=this._calcRotateMatrix(),t=this._calcTranslateMatrix(),i=this.getViewportTransform(),n=r(i,t),a=r(n,e),s=(a=r(a,[1/i[0],0,0,1/i[3],0,0]),this._calculateCurrentDimensions()),o={};return this.forEachControl((function(e,t,r){o[t]=e.positionHandler(s,a,r)})),o},calcACoords:function(){var e=this._calcRotateMatrix(),t=this._calcTranslateMatrix(),n=r(t,e),a=this._getTransformedDimensions(),s=a.x/2,o=a.y/2;return{tl:i({x:-s,y:-o},n),tr:i({x:s,y:-o},n),bl:i({x:-s,y:o},n),br:i({x:s,y:o},n)}},setCoords:function(e){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),e||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var e=this.getCenterPoint();return[1,0,0,1,e.x,e.y]},transformMatrixKey:function(e){var t="_",r="";return!e&&this.group&&(r=this.group.transformMatrixKey(e)+t),r+this.top+t+this.left+t+this.scaleX+t+this.scaleY+t+this.skewX+t+this.skewY+t+this.angle+t+this.originX+t+this.originY+t+this.width+t+this.height+t+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(e){var t=this.calcOwnMatrix();if(e||!this.group)return t;var i=this.transformMatrixKey(e),n=this.matrixCache||(this.matrixCache={});return n.key===i?n.value:(this.group&&(t=r(this.group.calcTransformMatrix(!1),t)),n.key=i,n.value=t,t)},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),r=this.ownMatrixCache||(this.ownMatrixCache={});if(r.key===t)return r.value;var i=this._calcTranslateMatrix(),n={angle:this.angle,translateX:i[4],translateY:i[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return r.key=t,r.value=e.composeMatrix(n),r.value},_getNonTransformedDimensions:function(){var e=this.strokeWidth;return{x:this.width+e,y:this.height+e}},_getTransformedDimensions:function(t,r){void 0===t&&(t=this.skewX),void 0===r&&(r=this.skewY);var i,n,a,s=0===t&&0===r;if(this.strokeUniform?(n=this.width,a=this.height):(n=(i=this._getNonTransformedDimensions()).x,a=i.y),s)return this._finalizeDimensions(n*this.scaleX,a*this.scaleY);var o=e.sizeAfterTransform(n,a,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:t,skewY:r});return this._finalizeDimensions(o.x,o.y)},_finalizeDimensions:function(e,t){return this.strokeUniform?{x:e+this.strokeWidth,y:t+this.strokeWidth}:{x:e,y:t}},_calculateCurrentDimensions:function(){var e=this.getViewportTransform(),t=this._getTransformedDimensions();return i(t,e,!0).scalarAdd(2*this.padding)}})}(),k.util.object.extend(k.Object.prototype,{sendToBack:function(){return this.group?k.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?k.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(e){return this.group?k.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas&&this.canvas.sendBackwards(this,e),this},bringForward:function(e){return this.group?k.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas&&this.canvas.bringForward(this,e),this},moveTo:function(e){return this.group&&"activeSelection"!==this.group.type?k.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas&&this.canvas.moveTo(this,e),this}}),function(){function e(e,t){if(t){if(t.toLive)return e+": url(#SVGID_"+t.id+"); ";var r=new k.Color(t),i=e+": "+r.toRgb()+"; ",n=r.getAlpha();return 1!==n&&(i+=e+"-opacity: "+n.toString()+"; "),i}return e+": none; "}var t=k.util.toFixed;k.util.object.extend(k.Object.prototype,{getSvgStyles:function(t){var r=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",a=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",l=void 0!==this.opacity?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=t?"":this.getSvgFilter(),f=e("fill",this.fill);return[e("stroke",this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",c,"; ",f,"fill-rule: ",r,"; ","opacity: ",l,";",h,u].join("")},getSvgSpanStyles:function(t,r){var i="; ",n=t.fontFamily?"font-family: "+(-1===t.fontFamily.indexOf("'")&&-1===t.fontFamily.indexOf('"')?"'"+t.fontFamily+"'":t.fontFamily)+i:"",a=t.strokeWidth?"stroke-width: "+t.strokeWidth+i:"",s=(n=n,t.fontSize?"font-size: "+t.fontSize+"px"+i:""),o=t.fontStyle?"font-style: "+t.fontStyle+i:"",c=t.fontWeight?"font-weight: "+t.fontWeight+i:"",l=t.fill?e("fill",t.fill):"",u=t.stroke?e("stroke",t.stroke):"",h=this.getSvgTextDecoration(t);return h&&(h="text-decoration: "+h+i),[u,a,n,s,o,c,h,l,t.deltaY?"baseline-shift: "+-t.deltaY+"; ":"",r?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(e){return["overline","underline","line-through"].filter((function(t){return e[t.replace("-","")]})).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(e,t){var r=e?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+k.util.matrixToSVG(r)+(t||"")+'" '},_setSVGBg:function(e){if(this.backgroundColor){var r=k.Object.NUM_FRACTION_DIGITS;e.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',t(-this.width/2,r),'" y="',t(-this.height/2,r),'" width="',t(this.width,r),'" height="',t(this.height,r),'"></rect>\n')}},toSVG:function(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})},toClipPathSVG:function(e){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})},_createBaseClipPathSVGMarkup:function(e,t){var r=(t=t||{}).reviver,i=t.additionalTransform||"",n=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),a=e.indexOf("COMMON_PARTS");return e[a]=n,r?r(e.join("")):e.join("")},_createBaseSVGMarkup:function(e,t){var r,i,n=(t=t||{}).noStyle,a=t.reviver,s=n?"":'style="'+this.getSvgStyles()+'" ',o=t.withShadow?'style="'+this.getSvgFilter()+'" ':"",c=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,h=this.stroke,f=this.fill,d=this.shadow,p=[],m=e.indexOf("COMMON_PARTS"),b=t.additionalTransform;return c&&(c.clipPathId="CLIPPATH_"+k.Object.__uid++,i='<clipPath id="'+c.clipPathId+'" >\n'+c.toClipPathSVG(a)+"</clipPath>\n"),u&&p.push("<g ",o,this.getSvgCommons()," >\n"),p.push("<g ",this.getSvgTransform(!1),u?"":o+this.getSvgCommons()," >\n"),r=[s,l,n?"":this.addPaintOrder()," ",b?'transform="'+b+'" ':""].join(""),e[m]=r,f&&f.toLive&&p.push(f.toSVG(this)),h&&h.toLive&&p.push(h.toSVG(this)),d&&p.push(d.toSVG(this)),c&&p.push(i),p.push(e.join("")),p.push("</g>\n"),u&&p.push("</g>\n"),a?a(p.join("")):p.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var e=k.util.object.extend,t="stateProperties";function r(t,r,i){var n={};i.forEach((function(e){n[e]=t[e]})),e(t[r],n,!0)}function i(e,t,r){if(e===t)return!0;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(var n=0,a=e.length;n<a;n++)if(!i(e[n],t[n]))return!1;return!0}if(e&&"object"===_(e)){var s,o=Object.keys(e);if(!t||"object"!==_(t)||!r&&o.length!==Object.keys(t).length)return!1;for(n=0,a=o.length;n<a;n++)if("canvas"!==(s=o[n])&&"group"!==s&&!i(e[s],t[s]))return!1;return!0}}k.util.object.extend(k.Object.prototype,{hasStateChanged:function(e){var r="_"+(e=e||t);return Object.keys(this[r]).length<this[e].length||!i(this[r],this,!0)},saveState:function(e){var i=e&&e.propertySet||t,n="_"+i;return this[n]?(r(this,n,this[i]),e&&e.stateProperties&&r(this,n,e.stateProperties),this):this.setupState(e)},setupState:function(e){var r=(e=e||{}).propertySet||t;return e.propertySet=r,this["_"+r]={},this.saveState(e),this}})}(),function(){var e=k.util.degreesToRadians;k.util.object.extend(k.Object.prototype,{_findTargetCorner:function(e,t){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var r,i,n,a=e.x,s=e.y,o=Object.keys(this.oCoords),c=o.length-1;for(this.__corner=0;c>=0;c--)if(n=o[c],this.isControlVisible(n)&&(i=this._getImageLines(t?this.oCoords[n].touchCorner:this.oCoords[n].corner),0!==(r=this._findCrossPoints({x:a,y:s},i))&&r%2==1))return this.__corner=n,n;return!1},forEachControl:function(e){for(var t in this.controls)e(this.controls[t],t,this)},_setCornerCoords:function(){var e=this.oCoords;for(var t in e){var r=this.controls[t];e[t].corner=r.calcCornerCoords(this.angle,this.cornerSize,e[t].x,e[t].y,!1),e[t].touchCorner=r.calcCornerCoords(this.angle,this.touchCornerSize,e[t].x,e[t].y,!0)}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var r=this.getCenterPoint(),i=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return t.translate(r.x,r.y),t.scale(1/n[0],1/n[3]),t.rotate(e(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-i.x/2,-i.y/2,i.x,i.y),t.restore(),this},drawBorders:function(e,t){t=t||{};var r=this._calculateCurrentDimensions(),i=this.borderScaleFactor,n=r.x+i,a=r.y+i,s=void 0!==t.hasControls?t.hasControls:this.hasControls,o=!1;return e.save(),e.strokeStyle=t.borderColor||this.borderColor,this._setLineDash(e,t.borderDashArray||this.borderDashArray),e.strokeRect(-n/2,-a/2,n,a),s&&(e.beginPath(),this.forEachControl((function(t,r,i){t.withConnection&&t.getVisibility(i,r)&&(o=!0,e.moveTo(t.x*n,t.y*a),e.lineTo(t.x*n+t.offsetX,t.y*a+t.offsetY))})),o&&e.stroke()),e.restore(),this},drawBordersInGroup:function(e,t,r){r=r||{};var i=k.util.sizeAfterTransform(this.width,this.height,t),n=this.strokeWidth,a=this.strokeUniform,s=this.borderScaleFactor,o=i.x+n*(a?this.canvas.getZoom():t.scaleX)+s,c=i.y+n*(a?this.canvas.getZoom():t.scaleY)+s;return e.save(),this._setLineDash(e,r.borderDashArray||this.borderDashArray),e.strokeStyle=r.borderColor||this.borderColor,e.strokeRect(-o/2,-c/2,o,c),e.restore(),this},drawControls:function(e,t){t=t||{},e.save();var r,i,n=this.canvas.getRetinaScaling();return e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=t.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=t.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,t.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(r=this.group.calcTransformMatrix()),this.forEachControl((function(n,a,s){i=s.oCoords[a],n.getVisibility(s,a)&&(r&&(i=k.util.transformPoint(i,r)),n.render(e,i.x,i.y,t,s))})),e.restore(),this},isControlVisible:function(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)},setControlVisible:function(e,t){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t,this},setControlsVisibility:function(e){for(var t in e||(e={}),e)this.setControlVisible(t,e[t]);return this},onDeselect:function(){},onSelect:function(){}})}(),k.util.object.extend(k.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){var r=function(){},i=(t=t||{}).onComplete||r,n=t.onChange||r,a=this;return k.util.animate({target:this,startValue:e.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(t){e.set("left",t),a.requestRenderAll(),n()},onComplete:function(){e.setCoords(),i()}})},fxCenterObjectV:function(e,t){var r=function(){},i=(t=t||{}).onComplete||r,n=t.onChange||r,a=this;return k.util.animate({target:this,startValue:e.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(t){e.set("top",t),a.requestRenderAll(),n()},onComplete:function(){e.setCoords(),i()}})},fxRemove:function(e,t){var r=function(){},i=(t=t||{}).onComplete||r,n=t.onChange||r,a=this;return k.util.animate({target:this,startValue:e.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(t){e.set("opacity",t),a.requestRenderAll(),n()},onComplete:function(){a.remove(e),i()}})}}),k.util.object.extend(k.Object.prototype,{animate:function(){if(arguments[0]&&"object"===_(arguments[0])){var e,t,r=[],i=[];for(e in arguments[0])r.push(e);for(var n=0,a=r.length;n<a;n++)e=r[n],t=n!==a-1,i.push(this._animate(e,arguments[0][e],arguments[1],t));return i}return this._animate.apply(this,arguments)},_animate:function(e,t,r,i){var n,a=this;t=t.toString(),r=r?k.util.object.clone(r):{},~e.indexOf(".")&&(n=e.split("."));var s=a.colorProperties.indexOf(e)>-1||n&&a.colorProperties.indexOf(n[1])>-1,o=n?this.get(n[0])[n[1]]:this.get(e);"from"in r||(r.from=o),s||(t=~t.indexOf("=")?o+parseFloat(t.replace("=","")):parseFloat(t));var c={target:this,startValue:r.from,endValue:t,byValue:r.by,easing:r.easing,duration:r.duration,abort:r.abort&&function(e,t,i){return r.abort.call(a,e,t,i)},onChange:function(t,s,o){n?a[n[0]][n[1]]=t:a.set(e,t),i||r.onChange&&r.onChange(t,s,o)},onComplete:function(e,t,n){i||(a.setCoords(),r.onComplete&&r.onComplete(e,t,n))}};return s?k.util.animateColor(c.startValue,c.endValue,c.duration,c):k.util.animate(c)}}),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.extend,i=t.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};function a(e,t){var r=e.origin,i=e.axis1,n=e.axis2,a=e.dimension,s=t.nearest,o=t.center,c=t.farthest;return function(){switch(this.get(r)){case s:return Math.min(this.get(i),this.get(n));case o:return Math.min(this.get(i),this.get(n))+.5*this.get(a);case c:return Math.max(this.get(i),this.get(n))}}}t.Line?t.warn("fabric.Line is already defined"):(t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:t.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(e,t){e||(e=[0,0,0,0]),this.callSuper("initialize",t),this.set("x1",e[0]),this.set("y1",e[1]),this.set("x2",e[2]),this.set("y2",e[3]),this._setWidthHeight(t)},_setWidthHeight:function(e){e||(e={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in e?e.left:this._getLeftToOriginX(),this.top="top"in e?e.top:this._getTopToOriginY()},_set:function(e,t){return this.callSuper("_set",e,t),void 0!==n[e]&&this._setWidthHeight(),this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(e){e.beginPath();var t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;var r=e.strokeStyle;e.strokeStyle=this.stroke||e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=r},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(e){return r(this.callSuper("toObject",e),this.calcLinePoints())},_getNonTransformedDimensions:function(){var e=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(e.y-=this.strokeWidth),0===this.height&&(e.x-=this.strokeWidth)),e},calcLinePoints:function(){var e=this.x1<=this.x2?-1:1,t=this.y1<=this.y2?-1:1,r=e*this.width*.5,i=t*this.height*.5;return{x1:r,x2:e*this.width*-.5,y1:i,y2:t*this.height*-.5}},_toSVG:function(){var e=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',e.x1,'" y1="',e.y1,'" x2="',e.x2,'" y2="',e.y2,'" />\n']}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(e,i,n){n=n||{};var a=t.parseAttributes(e,t.Line.ATTRIBUTE_NAMES),s=[a.x1||0,a.y1||0,a.x2||0,a.y2||0];i(new t.Line(s,r(a,n)))},t.Line.fromObject=function(e,r){var n=i(e,!0);n.points=[e.x1,e.y1,e.x2,e.y2],t.Object._fromObject("Line",n,(function(e){delete e.points,r&&r(e)}),"points")})}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.degreesToRadians;t.Circle?t.warn("fabric.Circle is already defined."):(t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:t.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(e,t){return this.callSuper("_set",e,t),"radius"===e&&this.setRadius(t),this},toObject:function(e){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(e))},_toSVG:function(){var e,i=(this.endAngle-this.startAngle)%360;if(0===i)e=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var n=r(this.startAngle),a=r(this.endAngle),s=this.radius;e=['<path d="M '+t.util.cos(n)*s+" "+t.util.sin(n)*s," A "+s+" "+s," 0 ",+(i>180?"1":"0")+" 1"," "+t.util.cos(a)*s+" "+t.util.sin(a)*s,'" ',"COMMON_PARTS"," />\n"]}return e},_render:function(e){e.beginPath(),e.arc(0,0,this.radius,r(this.startAngle),r(this.endAngle),!1),this._renderPaintInOrder(e)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(e){return this.radius=e,this.set("width",2*e).set("height",2*e)}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(e,r){var i,n=t.parseAttributes(e,t.Circle.ATTRIBUTE_NAMES);if(!("radius"in(i=n)&&i.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");n.left=(n.left||0)-n.radius,n.top=(n.top||0)-n.radius,r(new t.Circle(n))},t.Circle.fromObject=function(e,r){t.Object._fromObject("Circle",e,r)})}(e),function(e){var t=e.fabric||(e.fabric={});t.Triangle?t.warn("fabric.Triangle is already defined"):(t.Triangle=t.util.createClass(t.Object,{type:"triangle",width:100,height:100,_render:function(e){var t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,r),e.lineTo(0,-r),e.lineTo(t,r),e.closePath(),this._renderPaintInOrder(e)},_toSVG:function(){var e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-e+" "+t,"0 "+-t,e+" "+t].join(","),'" />']}}),t.Triangle.fromObject=function(e,r){return t.Object._fromObject("Triangle",e,r)})}(e),function(e){var t=e.fabric||(e.fabric={}),r=2*Math.PI;t.Ellipse?t.warn("fabric.Ellipse is already defined."):(t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(e){this.callSuper("initialize",e),this.set("rx",e&&e.rx||0),this.set("ry",e&&e.ry||0)},_set:function(e,t){switch(this.callSuper("_set",e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(e){return this.callSuper("toObject",["rx","ry"].concat(e))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,r,!1),e.restore(),this._renderPaintInOrder(e)}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(e,r){var i=t.parseAttributes(e,t.Ellipse.ATTRIBUTE_NAMES);i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,r(new t.Ellipse(i))},t.Ellipse.fromObject=function(e,r){t.Object._fromObject("Ellipse",e,r)})}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.extend;t.Rect?t.warn("fabric.Rect is already defined"):(t.Rect=t.util.createClass(t.Object,{stateProperties:t.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(e){this.callSuper("initialize",e),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(e){var t=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,n=this.height,a=-this.width/2,s=-this.height/2,o=0!==t||0!==r,c=.4477152502;e.beginPath(),e.moveTo(a+t,s),e.lineTo(a+i-t,s),o&&e.bezierCurveTo(a+i-c*t,s,a+i,s+c*r,a+i,s+r),e.lineTo(a+i,s+n-r),o&&e.bezierCurveTo(a+i,s+n-c*r,a+i-c*t,s+n,a+i-t,s+n),e.lineTo(a+t,s+n),o&&e.bezierCurveTo(a+c*t,s+n,a,s+n-c*r,a,s+n-r),e.lineTo(a,s+r),o&&e.bezierCurveTo(a,s+c*r,a+c*t,s,a+t,s),e.closePath(),this._renderPaintInOrder(e)},toObject:function(e){return this.callSuper("toObject",["rx","ry"].concat(e))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(e,i,n){if(!e)return i(null);n=n||{};var a=t.parseAttributes(e,t.Rect.ATTRIBUTE_NAMES);a.left=a.left||0,a.top=a.top||0,a.height=a.height||0,a.width=a.width||0;var s=new t.Rect(r(n?t.util.object.clone(n):{},a));s.visible=s.visible&&s.width>0&&s.height>0,i(s)},t.Rect.fromObject=function(e,r){return t.Object._fromObject("Rect",e,r)})}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.extend,i=t.util.array.min,n=t.util.array.max,a=t.util.toFixed,s=t.util.projectStrokeOnPoints;t.Polyline?t.warn("fabric.Polyline is already defined"):(t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:t.Object.prototype.cacheProperties.concat("points"),initialize:function(e,t){t=t||{},this.points=e||[],this.callSuper("initialize",t),this._setPositionDimensions(t)},_projectStrokeOnPoints:function(){return s(this.points,this,!0)},_setPositionDimensions:function(e){var t,r=this._calcDimensions(e),i=this.exactBoundingBox?this.strokeWidth:0;this.width=r.width-i,this.height=r.height-i,e.fromSVG||(t=this.translateToGivenOrigin({x:r.left-this.strokeWidth/2+i/2,y:r.top-this.strokeWidth/2+i/2},"left","top",this.originX,this.originY)),void 0===e.left&&(this.left=e.fromSVG?r.left:t.x),void 0===e.top&&(this.top=e.fromSVG?r.top:t.y),this.pathOffset={x:r.left+this.width/2+i/2,y:r.top+this.height/2+i/2}},_calcDimensions:function(){var e=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,t=i(e,"x")||0,r=i(e,"y")||0;return{left:t,top:r,width:(n(e,"x")||0)-t,height:(n(e,"y")||0)-r}},toObject:function(e){return r(this.callSuper("toObject",e),{points:this.points.concat()})},_toSVG:function(){for(var e=[],r=this.pathOffset.x,i=this.pathOffset.y,n=t.Object.NUM_FRACTION_DIGITS,s=0,o=this.points.length;s<o;s++)e.push(a(this.points[s].x-r,n),",",a(this.points[s].y-i,n)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',e.join(""),'" />\n']},commonRender:function(e){var t,r=this.points.length,i=this.pathOffset.x,n=this.pathOffset.y;if(!r||isNaN(this.points[r-1].y))return!1;e.beginPath(),e.moveTo(this.points[0].x-i,this.points[0].y-n);for(var a=0;a<r;a++)t=this.points[a],e.lineTo(t.x-i,t.y-n);return!0},_render:function(e){this.commonRender(e)&&this._renderPaintInOrder(e)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElementGenerator=function(e){return function(i,n,a){if(!i)return n(null);a||(a={});var s=t.parsePointsAttribute(i.getAttribute("points")),o=t.parseAttributes(i,t[e].ATTRIBUTE_NAMES);o.fromSVG=!0,n(new t[e](s,r(o,a)))}},t.Polyline.fromElement=t.Polyline.fromElementGenerator("Polyline"),t.Polyline.fromObject=function(e,r){return t.Object._fromObject("Polyline",e,r,"points")})}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.projectStrokeOnPoints;t.Polygon?t.warn("fabric.Polygon is already defined"):(t.Polygon=t.util.createClass(t.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return r(this.points,this)},_render:function(e){this.commonRender(e)&&(e.closePath(),this._renderPaintInOrder(e))}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=t.Polyline.fromElementGenerator("Polygon"),t.Polygon.fromObject=function(e,r){t.Object._fromObject("Polygon",e,r,"points")})}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.array.min,i=t.util.array.max,n=t.util.object.extend,a=t.util.object.clone,s=t.util.toFixed;t.Path?t.warn("fabric.Path is already defined"):(t.Path=t.util.createClass(t.Object,{type:"path",path:null,cacheProperties:t.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:t.Object.prototype.stateProperties.concat("path"),initialize:function(e,t){delete(t=a(t||{})).path,this.callSuper("initialize",t),this._setPath(e||[],t)},_setPath:function(e,r){this.path=t.util.makePathSimpler(Array.isArray(e)?e:t.util.parsePath(e)),t.Polyline.prototype._setPositionDimensions.call(this,r||{})},_renderPathCommands:function(e){var t,r=0,i=0,n=0,a=0,s=0,o=0,c=-this.pathOffset.x,l=-this.pathOffset.y;e.beginPath();for(var u=0,h=this.path.length;u<h;++u)switch((t=this.path[u])[0]){case"L":n=t[1],a=t[2],e.lineTo(n+c,a+l);break;case"M":r=n=t[1],i=a=t[2],e.moveTo(n+c,a+l);break;case"C":n=t[5],a=t[6],s=t[3],o=t[4],e.bezierCurveTo(t[1]+c,t[2]+l,s+c,o+l,n+c,a+l);break;case"Q":e.quadraticCurveTo(t[1]+c,t[2]+l,t[3]+c,t[4]+l),n=t[3],a=t[4],s=t[1],o=t[2];break;case"z":case"Z":n=r,a=i,e.closePath()}},_render:function(e){this._renderPathCommands(e),this._renderPaintInOrder(e)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(e){return n(this.callSuper("toObject",e),{path:this.path.map((function(e){return e.slice()}))})},toDatalessObject:function(e){var t=this.toObject(["sourcePath"].concat(e));return t.sourcePath&&delete t.path,t},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',t.util.joinPath(this.path),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var e=t.Object.NUM_FRACTION_DIGITS;return" translate("+s(-this.pathOffset.x,e)+", "+s(-this.pathOffset.y,e)+")"},toClipPathSVG:function(e){var t=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})},toSVG:function(e){var t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var e,n,a=[],s=[],o=0,c=0,l=0,u=0,h=0,f=this.path.length;h<f;++h){switch((e=this.path[h])[0]){case"L":l=e[1],u=e[2],n=[];break;case"M":o=l=e[1],c=u=e[2],n=[];break;case"C":n=t.util.getBoundsOfCurve(l,u,e[1],e[2],e[3],e[4],e[5],e[6]),l=e[5],u=e[6];break;case"Q":n=t.util.getBoundsOfCurve(l,u,e[1],e[2],e[1],e[2],e[3],e[4]),l=e[3],u=e[4];break;case"z":case"Z":l=o,u=c}n.forEach((function(e){a.push(e.x),s.push(e.y)})),a.push(l),s.push(u)}var d=r(a)||0,p=r(s)||0;return{left:d,top:p,width:(i(a)||0)-d,height:(i(s)||0)-p}}}),t.Path.fromObject=function(e,r){if("string"==typeof e.sourcePath){var i=e.sourcePath;t.loadSVGFromURL(i,(function(i){var n=i[0];n.setOptions(e),e.clipPath?t.util.enlivenObjects([e.clipPath],(function(e){n.clipPath=e[0],r&&r(n)})):r&&r(n)}))}else t.Object._fromObject("Path",e,r,"path")},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(e,r,i){var a=t.parseAttributes(e,t.Path.ATTRIBUTE_NAMES);a.fromSVG=!0,r(new t.Path(a.d,n(a,i)))})}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.array.min,i=t.util.array.max;t.Group||(t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(e,t,r){t=t||{},this._objects=[],r&&this.callSuper("initialize",t),this._objects=e||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;if(r)this._updateObjectsACoords();else{var n=t&&t.centerPoint;void 0!==t.originX&&(this.originX=t.originX),void 0!==t.originY&&(this.originY=t.originY),n||this._calcBounds(),this._updateObjectsCoords(n),delete t.centerPoint,this.callSuper("initialize",t)}this.setCoords()},_updateObjectsACoords:function(){for(var e=this._objects.length;e--;)this._objects[e].setCoords(true)},_updateObjectsCoords:function(e){e=e||this.getCenterPoint();for(var t=this._objects.length;t--;)this._updateObjectCoords(this._objects[t],e)},_updateObjectCoords:function(e,t){var r=e.left,i=e.top;e.set({left:r-t.x,top:i-t.y}),e.group=this,e.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(e){var r=!!this.group;return this._restoreObjectsState(),t.util.resetObjectTransform(this),e&&(r&&t.util.removeTransformFromObject(e,this.group.calcTransformMatrix()),this._objects.push(e),e.group=this,e._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,r?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(e){return this._restoreObjectsState(),t.util.resetObjectTransform(this),this.remove(e),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(e){this.dirty=!0,e.group=this,e._set("canvas",this.canvas)},_onObjectRemoved:function(e){this.dirty=!0,delete e.group},_set:function(e,r){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(e,r);if("canvas"===e)for(;i--;)this._objects[i]._set(e,r);t.Object.prototype._set.call(this,e,r)},toObject:function(e){var r=this.includeDefaultValues,i=this._objects.filter((function(e){return!e.excludeFromExport})).map((function(t){var i=t.includeDefaultValues;t.includeDefaultValues=r;var n=t.toObject(e);return t.includeDefaultValues=i,n})),n=t.Object.prototype.toObject.call(this,e);return n.objects=i,n},toDatalessObject:function(e){var r,i=this.sourcePath;if(i)r=i;else{var n=this.includeDefaultValues;r=this._objects.map((function(t){var r=t.includeDefaultValues;t.includeDefaultValues=n;var i=t.toDatalessObject(e);return t.includeDefaultValues=r,i}))}var a=t.Object.prototype.toDatalessObject.call(this,e);return a.objects=r,a},render:function(e){this._transformDone=!0,this.callSuper("render",e),this._transformDone=!1},shouldCache:function(){var e=t.Object.prototype.shouldCache.call(this);if(e)for(var r=0,i=this._objects.length;r<i;r++)if(this._objects[r].willDrawShadow())return this.ownCaching=!1,!1;return e},willDrawShadow:function(){if(t.Object.prototype.willDrawShadow.call(this))return!0;for(var e=0,r=this._objects.length;e<r;e++)if(this._objects[e].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(e){for(var t=0,r=this._objects.length;t<r;t++)this._objects[t].render(e);this._drawClipPath(e,this.clipPath)},isCacheDirty:function(e){if(this.callSuper("isCacheDirty",e))return!0;if(!this.statefullCache)return!1;for(var t=0,r=this._objects.length;t<r;t++)if(this._objects[t].isCacheDirty(!0)){if(this._cacheCanvas){var i=this.cacheWidth/this.zoomX,n=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-i/2,-n/2,i,n)}return!0}return!1},_restoreObjectsState:function(){var e=this.calcOwnMatrix();return this._objects.forEach((function(r){t.util.addTransformToObject(r,e),delete r.group,r.setCoords()})),this},destroy:function(){return this._objects.forEach((function(e){e.set("dirty",!0)})),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject((function(e){e.dispose&&e.dispose()})),this._objects=[]},toActiveSelection:function(){if(this.canvas){var e=this._objects,r=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var n=new t.ActiveSelection([]);return n.set(i),n.type="activeSelection",r.remove(this),e.forEach((function(e){e.group=n,e.dirty=!0,r.add(e)})),n.canvas=r,n._objects=e,r._activeObject=n,n.setCoords(),n}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(e){e.setCoords(true)})),this},_calcBounds:function(e){for(var t,r,i,n,a=[],s=[],o=["tr","br","bl","tl"],c=0,l=this._objects.length,u=o.length;c<l;++c){for(i=(t=this._objects[c]).calcACoords(),n=0;n<u;n++)r=o[n],a.push(i[r].x),s.push(i[r].y);t.aCoords=i}this._getBounds(a,s,e)},_getBounds:function(e,n,a){var s=new t.Point(r(e),r(n)),o=new t.Point(i(e),i(n)),c=s.y||0,l=s.x||0,u=o.x-s.x||0,h=o.y-s.y||0;this.width=u,this.height=h,a||this.setPositionByOrigin({x:l,y:c},"left","top")},_toSVG:function(e){for(var t=["<g ","COMMON_PARTS"," >\n"],r=0,i=this._objects.length;r<i;r++)t.push("\t\t",this._objects[r].toSVG(e));return t.push("</g>\n"),t},getSvgStyles:function(){var e=void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")},toClipPathSVG:function(e){for(var t=[],r=0,i=this._objects.length;r<i;r++)t.push("\t",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}}),t.Group.fromObject=function(e,r){var i=e.objects,n=t.util.object.clone(e,!0);delete n.objects,"string"!=typeof i?t.util.enlivenObjects(i,(function(i){t.util.enlivenObjectEnlivables(e,n,(function(){r&&r(new t.Group(i,n,!0))}))})):t.loadSVGFromURL(i,(function(a){var s=t.util.groupSVGElements(a,e,i),o=n.clipPath;delete n.clipPath,s.set(n),o?t.util.enlivenObjects([o],(function(e){s.clipPath=e[0],r&&r(s)})):r&&r(s)}))})}(e),function(e){var t=e.fabric||(e.fabric={});t.ActiveSelection||(t.ActiveSelection=t.util.createClass(t.Group,{type:"activeSelection",initialize:function(e,r){r=r||{},this._objects=e||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;r.originX&&(this.originX=r.originX),r.originY&&(this.originY=r.originY),this._calcBounds(),this._updateObjectsCoords(),t.Object.prototype.initialize.call(this,r),this.setCoords()},toGroup:function(){var e=this._objects.concat();this._objects=[];var r=t.Object.prototype.toObject.call(this),i=new t.Group([]);if(delete r.type,i.set(r),e.forEach((function(e){e.canvas.remove(e),e.group=i})),i._objects=e,!this.canvas)return i;var n=this.canvas;return n.add(i),n._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(e,t,r){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",e,t),void 0===(r=r||{}).hasControls&&(r.hasControls=!1),r.forActiveSelection=!0;for(var i=0,n=this._objects.length;i<n;i++)this._objects[i]._renderControls(e,r);e.restore()}}),t.ActiveSelection.fromObject=function(e,r){t.util.enlivenObjects(e.objects,(function(i){delete e.objects,r&&r(new t.ActiveSelection(i,e,!0))}))})}(e),function(e){var t=k.util.object.extend;e.fabric||(e.fabric={}),e.fabric.Image?k.warn("fabric.Image is already defined."):(k.Image=k.util.createClass(k.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:k.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:k.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(e,t){t||(t={}),this.filters=[],this.cacheKey="texture"+k.Object.__uid++,this.callSuper("initialize",t),this._initElement(e,t)},getElement:function(){return this._element||{}},setElement:function(e,t){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=e,this._originalElement=e,this._initConfig(t),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(e){var t=k.filterBackend;t&&t.evictCachesForKey&&t.evictCachesForKey(e)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(e){k.util.cleanUpJsdomNode(this[e]),this[e]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var e=this.getElement();return{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}},_stroke:function(e){if(this.stroke&&0!==this.strokeWidth){var t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,-r),e.lineTo(t,-r),e.lineTo(t,r),e.lineTo(-t,r),e.lineTo(-t,-r),e.closePath()}},toObject:function(e){var r=[];this.filters.forEach((function(e){e&&r.push(e.toObject())}));var i=t(this.callSuper("toObject",["cropX","cropY"].concat(e)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:r});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var e,t=[],r=[],i=this._element,n=-this.width/2,a=-this.height/2,s="",o="";if(!i)return[];if(this.hasCrop()){var c=k.Object.__uid++;t.push('<clipPath id="imageCrop_'+c+'">\n','\t<rect x="'+n+'" y="'+a+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),s=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(o='" image-rendering="optimizeSpeed'),r.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',n-this.cropX,'" y="',a-this.cropY,'" width="',i.width||i.naturalWidth,'" height="',i.height||i.height,o,'"',s,"></image>\n"),this.stroke||this.strokeDashArray){var l=this.fill;this.fill=null,e=["\t<rect ",'x="',n,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=l}return t="fill"!==this.paintFirst?t.concat(e,r):t.concat(r,e)},getSrc:function(e){var t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src"):t.src:this.src||""},setSrc:function(e,t,r){return k.util.loadImage(e,(function(e,i){this.setElement(e,r),this._setWidthHeight(),t&&t(this,i)}),this,r&&r.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var e=this.resizeFilter,t=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),i=r.scaleX,n=r.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>t&&n>t)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=n);k.filterBackend||(k.filterBackend=k.initFilterBackend());var s=k.util.createCanvasElement(),o=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,c=a.width,l=a.height;s.width=c,s.height=l,this._element=s,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=n,k.filterBackend.applyFilters([e],a,c,l,this._element,o),this._filterScalingX=s.width/this._originalElement.width,this._filterScalingY=s.height/this._originalElement.height},applyFilters:function(e){if(e=(e=e||this.filters||[]).filter((function(e){return e&&!e.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===e.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var t=this._originalElement,r=t.naturalWidth||t.width,i=t.naturalHeight||t.height;if(this._element===this._originalElement){var n=k.util.createCanvasElement();n.width=r,n.height=i,this._element=n,this._filteredEl=n}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,i),this._lastScaleX=1,this._lastScaleY=1;return k.filterBackend||(k.filterBackend=k.initFilterBackend()),k.filterBackend.applyFilters(e,this._originalElement,r,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(e){k.util.setImageSmoothing(e,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)},drawCacheOnCanvas:function(e){k.util.setImageSmoothing(e,this.imageSmoothing),k.Object.prototype.drawCacheOnCanvas.call(this,e)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(e){var t=this._element;if(t){var r=this._filterScalingX,i=this._filterScalingY,n=this.width,a=this.height,s=Math.min,o=Math.max,c=o(this.cropX,0),l=o(this.cropY,0),u=t.naturalWidth||t.width,h=t.naturalHeight||t.height,f=c*r,d=l*i,p=s(n*r,u-f),m=s(a*i,h-d),b=-n/2,v=-a/2,g=s(n,u/r-c),y=s(a,h/i-l);t&&e.drawImage(t,f,d,p,m,b,v,g,y)}},_needsResize:function(){var e=this.getTotalObjectScaling();return e.scaleX!==this._lastScaleX||e.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(e,t){this.setElement(k.util.getById(e),t),k.util.addClass(this.getElement(),k.Image.CSS_CANVAS)},_initConfig:function(e){e||(e={}),this.setOptions(e),this._setWidthHeight(e)},_initFilters:function(e,t){e&&e.length?k.util.enlivenObjects(e,(function(e){t&&t(e)}),"fabric.Image.filters"):t&&t()},_setWidthHeight:function(e){e||(e={});var t=this.getElement();this.width=e.width||t.naturalWidth||t.width||0,this.height=e.height||t.naturalHeight||t.height||0},parsePreserveAspectRatioAttribute:function(){var e,t=k.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),r=this._element.width,i=this._element.height,n=1,a=1,s=0,o=0,c=0,l=0,u=this.width,h=this.height,f={width:u,height:h};return!t||"none"===t.alignX&&"none"===t.alignY?(n=u/r,a=h/i):("meet"===t.meetOrSlice&&(e=(u-r*(n=a=k.util.findScaleToFit(this._element,f)))/2,"Min"===t.alignX&&(s=-e),"Max"===t.alignX&&(s=e),e=(h-i*a)/2,"Min"===t.alignY&&(o=-e),"Max"===t.alignY&&(o=e)),"slice"===t.meetOrSlice&&(e=r-u/(n=a=k.util.findScaleToCover(this._element,f)),"Mid"===t.alignX&&(c=e/2),"Max"===t.alignX&&(c=e),e=i-h/a,"Mid"===t.alignY&&(l=e/2),"Max"===t.alignY&&(l=e),r=u/n,i=h/a)),{width:r,height:i,scaleX:n,scaleY:a,offsetLeft:s,offsetTop:o,cropX:c,cropY:l}}}),k.Image.CSS_CANVAS="canvas-img",k.Image.prototype.getSvgSrc=k.Image.prototype.getSrc,k.Image.fromObject=function(e,t){var r=k.util.object.clone(e);k.util.loadImage(r.src,(function(e,i){i?t&&t(null,!0):k.Image.prototype._initFilters.call(r,r.filters,(function(i){r.filters=i||[],k.Image.prototype._initFilters.call(r,[r.resizeFilter],(function(i){r.resizeFilter=i[0],k.util.enlivenObjectEnlivables(r,r,(function(){var i=new k.Image(e,r);t(i,!1)}))}))}))}),null,r.crossOrigin)},k.Image.fromURL=function(e,t,r){k.util.loadImage(e,(function(e,i){t&&t(new k.Image(e,r),i)}),null,r&&r.crossOrigin)},k.Image.ATTRIBUTE_NAMES=k.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),k.Image.fromElement=function(e,r,i){var n=k.parseAttributes(e,k.Image.ATTRIBUTE_NAMES);k.Image.fromURL(n["xlink:href"],r,t(i?k.util.object.clone(i):{},n))})}(e),k.util.object.extend(k.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.angle%360;return e>0?90*Math.round((e-1)/90):90*Math.round(e/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(e){var t=function(){},r=(e=e||{}).onComplete||t,i=e.onChange||t,n=this;return k.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(e){n.rotate(e),i()},onComplete:function(){n.setCoords(),r()}})}}),k.util.object.extend(k.StaticCanvas.prototype,{straightenObject:function(e){return e.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(e){return e.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function e(e,t){var r="precision "+t+" float;\nvoid main(){}",i=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(i,r),e.compileShader(i),!!e.getShaderParameter(i,e.COMPILE_STATUS)}function t(e){e&&e.tileSize&&(this.tileSize=e.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}k.isWebglSupported=function(t){if(k.isLikelyNode)return!1;t=t||k.WebglFilterBackend.prototype.tileSize;var r=document.createElement("canvas"),i=r.getContext("webgl")||r.getContext("experimental-webgl"),n=!1;if(i){k.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),n=k.maxTextureSize>=t;for(var a=["highp","mediump","lowp"],s=0;s<3;s++)if(e(i,a[s])){k.webGlPrecision=a[s];break}}return this.isSupported=n,n},k.WebglFilterBackend=t,t.prototype={tileSize:2048,resources:{},setupGLContext:function(e,t){this.dispose(),this.createWebGLCanvas(e,t),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(e,t)},chooseFastestCopyGLTo2DMethod:function(e,t){var r,i=void 0!==window.performance;try{new ImageData(1,1),r=!0}catch(h){r=!1}var n="undefined"!=typeof ArrayBuffer,a="undefined"!=typeof Uint8ClampedArray;if(i&&r&&n&&a){var s=k.util.createCanvasElement(),o=new ArrayBuffer(e*t*4);if(k.forceGLPutImageData)return this.imageBuffer=o,void(this.copyGLTo2D=U);var c,l,u={imageBuffer:o,destinationWidth:e,destinationHeight:t,targetCanvas:s};s.width=e,s.height=t,c=window.performance.now(),C.call(u,this.gl,u),l=window.performance.now()-c,c=window.performance.now(),U.call(u,this.gl,u),l>window.performance.now()-c?(this.imageBuffer=o,this.copyGLTo2D=U):this.copyGLTo2D=C}},createWebGLCanvas:function(e,t){var r=k.util.createCanvasElement();r.width=e,r.height=t;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},n=r.getContext("webgl",i);n||(n=r.getContext("experimental-webgl",i)),n&&(n.clearColor(0,0,0,0),this.canvas=r,this.gl=n)},applyFilters:function(e,t,r,i,n,a){var s,o=this.gl;a&&(s=this.getCachedTexture(a,t));var c={originalWidth:t.width||t.originalWidth,originalHeight:t.height||t.originalHeight,sourceWidth:r,sourceHeight:i,destinationWidth:r,destinationHeight:i,context:o,sourceTexture:this.createTexture(o,r,i,!s&&t),targetTexture:this.createTexture(o,r,i),originalTexture:s||this.createTexture(o,r,i,!s&&t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:n},l=o.createFramebuffer();return o.bindFramebuffer(o.FRAMEBUFFER,l),e.forEach((function(e){e&&e.applyTo(c)})),function(e){var t=e.targetCanvas,r=t.width,i=t.height,n=e.destinationWidth,a=e.destinationHeight;r===n&&i===a||(t.width=n,t.height=a)}(c),this.copyGLTo2D(o,c),o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(c.sourceTexture),o.deleteTexture(c.targetTexture),o.deleteFramebuffer(l),n.getContext("2d").setTransform(1,0,0,1,0,0),c},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(e,t,r,i,n){var a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n||e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n||e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,r,0,e.RGBA,e.UNSIGNED_BYTE,null),a},getCachedTexture:function(e,t){if(this.textureCache[e])return this.textureCache[e];var r=this.createTexture(this.gl,t.width,t.height,t);return this.textureCache[e]=r,r},evictCachesForKey:function(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])},copyGLTo2D:C,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var e=this.gl,t={renderer:"",vendor:""};if(!e)return t;var r=e.getExtension("WEBGL_debug_renderer_info");if(r){var i=e.getParameter(r.UNMASKED_RENDERER_WEBGL),n=e.getParameter(r.UNMASKED_VENDOR_WEBGL);i&&(t.renderer=i.toLowerCase()),n&&(t.vendor=n.toLowerCase())}return this.gpuInfo=t,t}}}(),function(){var e=function(){};function t(){}k.Canvas2dFilterBackend=t,t.prototype={evictCachesForKey:e,dispose:e,clearWebGLCaches:e,resources:{},applyFilters:function(e,t,r,i,n){var a=n.getContext("2d");a.drawImage(t,0,0,r,i);var s={sourceWidth:r,sourceHeight:i,imageData:a.getImageData(0,0,r,i),originalEl:t,originalImageData:a.getImageData(0,0,r,i),canvasEl:n,ctx:a,filterBackend:this};return e.forEach((function(e){e.applyTo(s)})),s.imageData.width===r&&s.imageData.height===i||(n.width=s.imageData.width,n.height=s.imageData.height),a.putImageData(s.imageData,0,0),s}}}(),k.Image=k.Image||{},k.Image.filters=k.Image.filters||{},k.Image.filters.BaseFilter=k.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},createProgram:function(e,t,r){t=t||this.fragmentSource,r=r||this.vertexSource,"highp"!==k.webGlPrecision&&(t=t.replace(/precision highp float/g,"precision "+k.webGlPrecision+" float"));var i=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(i,r),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+e.getShaderInfoLog(i));var n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+e.getShaderInfoLog(n));var a=e.createProgram();if(e.attachShader(a,i),e.attachShader(a,n),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+e.getProgramInfoLog(a));var s=this.getAttributeLocations(e,a),o=this.getUniformLocations(e,a)||{};return o.uStepW=e.getUniformLocation(a,"uStepW"),o.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:s,uniformLocations:o}},getAttributeLocations:function(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(e,t,r){var i=t.aPosition,n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)},_setupFrameBuffer:function(e){var t,r,i=e.context;e.passes>1?(t=e.destinationWidth,r=e.destinationHeight,e.sourceWidth===t&&e.sourceHeight===r||(i.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(i,t,r)),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e.targetTexture,0)):(i.bindFramebuffer(i.FRAMEBUFFER,null),i.finish())},_swapTextures:function(e){e.passes--,e.pass++;var t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t},isNeutralState:function(){var e=this.mainParameter,t=k.Image.filters[this.type].prototype;if(e){if(Array.isArray(t[e])){for(var r=t[e].length;r--;)if(this[e][r]!==t[e][r])return!1;return!0}return t[e]===this[e]}return!1},applyTo:function(e){e.webgl?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},retrieveShader:function(e){return e.programCache.hasOwnProperty(this.type)||(e.programCache[this.type]=this.createProgram(e.context)),e.programCache[this.type]},applyToWebGL:function(e){var t=e.context,r=this.retrieveShader(e);0===e.pass&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(r.program),this.sendAttributeData(t,r.attributeLocations,e.aPosition),t.uniform1f(r.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(r.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,r.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(e,t,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)},unbindAdditionalTexture:function(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(e){this[this.mainParameter]=e},sendUniformData:function(){},createHelpLayer:function(e){if(!e.helpLayer){var t=document.createElement("canvas");t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}},toObject:function(){var e={type:this.type},t=this.mainParameter;return t&&(e[t]=this[t]),e},toJSON:function(){return this.toObject()}}),k.Image.filters.BaseFilter.fromObject=function(e,t){var r=new k.Image.filters[e.type](e);return t&&t(r),r},function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.ColorMatrix=i(r.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(e){this.callSuper("initialize",e),this.matrix=this.matrix.slice(0)},applyTo2d:function(e){var t,r,i,n,a,s=e.imageData.data,o=s.length,c=this.matrix,l=this.colorsOnly;for(a=0;a<o;a+=4)t=s[a],r=s[a+1],i=s[a+2],l?(s[a]=t*c[0]+r*c[1]+i*c[2]+255*c[4],s[a+1]=t*c[5]+r*c[6]+i*c[7]+255*c[9],s[a+2]=t*c[10]+r*c[11]+i*c[12]+255*c[14]):(n=s[a+3],s[a]=t*c[0]+r*c[1]+i*c[2]+n*c[3]+255*c[4],s[a+1]=t*c[5]+r*c[6]+i*c[7]+n*c[8]+255*c[9],s[a+2]=t*c[10]+r*c[11]+i*c[12]+n*c[13]+255*c[14],s[a+3]=t*c[15]+r*c[16]+i*c[17]+n*c[18]+255*c[19])},getUniformLocations:function(e,t){return{uColorMatrix:e.getUniformLocation(t,"uColorMatrix"),uConstants:e.getUniformLocation(t,"uConstants")}},sendUniformData:function(e,t){var r=this.matrix,i=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],n=[r[4],r[9],r[14],r[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,i),e.uniform4fv(t.uConstants,n)}}),t.Image.filters.ColorMatrix.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Brightness=i(r.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(e){if(0!==this.brightness){var t,r=e.imageData.data,i=r.length,n=Math.round(255*this.brightness);for(t=0;t<i;t+=4)r[t]=r[t]+n,r[t+1]=r[t+1]+n,r[t+2]=r[t+2]+n}},getUniformLocations:function(e,t){return{uBrightness:e.getUniformLocation(t,"uBrightness")}},sendUniformData:function(e,t){e.uniform1f(t.uBrightness,this.brightness)}}),t.Image.filters.Brightness.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.extend,i=t.Image.filters,n=t.util.createClass;i.Convolute=n(i.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(e){var t=Math.sqrt(this.matrix.length),r=this.type+"_"+t+"_"+(this.opaque?1:0),i=this.fragmentSource[r];return e.programCache.hasOwnProperty(r)||(e.programCache[r]=this.createProgram(e.context,i)),e.programCache[r]},applyTo2d:function(e){var t,r,i,n,a,s,o,c,l,u,h,f,d,p=e.imageData,m=p.data,b=this.matrix,v=Math.round(Math.sqrt(b.length)),g=Math.floor(v/2),y=p.width,_=p.height,w=e.ctx.createImageData(y,_),x=w.data,k=this.opaque?1:0;for(h=0;h<_;h++)for(u=0;u<y;u++){for(a=4*(h*y+u),t=0,r=0,i=0,n=0,d=0;d<v;d++)for(f=0;f<v;f++)s=u+f-g,(o=h+d-g)<0||o>=_||s<0||s>=y||(c=4*(o*y+s),l=b[d*v+f],t+=m[c]*l,r+=m[c+1]*l,i+=m[c+2]*l,k||(n+=m[c+3]*l));x[a]=t,x[a+1]=r,x[a+2]=i,x[a+3]=k?m[a+3]:n}e.imageData=w},getUniformLocations:function(e,t){return{uMatrix:e.getUniformLocation(t,"uMatrix"),uOpaque:e.getUniformLocation(t,"uOpaque"),uHalfSize:e.getUniformLocation(t,"uHalfSize"),uSize:e.getUniformLocation(t,"uSize")}},sendUniformData:function(e,t){e.uniform1fv(t.uMatrix,this.matrix)},toObject:function(){return r(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Grayscale=i(r.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(e){var t,r,i=e.imageData.data,n=i.length,a=this.mode;for(t=0;t<n;t+=4)"average"===a?r=(i[t]+i[t+1]+i[t+2])/3:"lightness"===a?r=(Math.min(i[t],i[t+1],i[t+2])+Math.max(i[t],i[t+1],i[t+2]))/2:"luminosity"===a&&(r=.21*i[t]+.72*i[t+1]+.07*i[t+2]),i[t]=r,i[t+1]=r,i[t+2]=r},retrieveShader:function(e){var t=this.type+"_"+this.mode;if(!e.programCache.hasOwnProperty(t)){var r=this.fragmentSource[this.mode];e.programCache[t]=this.createProgram(e.context,r)}return e.programCache[t]},getUniformLocations:function(e,t){return{uMode:e.getUniformLocation(t,"uMode")}},sendUniformData:function(e,t){e.uniform1i(t.uMode,1)},isNeutralState:function(){return!1}}),t.Image.filters.Grayscale.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Invert=i(r.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(e){var t,r=e.imageData.data,i=r.length;for(t=0;t<i;t+=4)r[t]=255-r[t],r[t+1]=255-r[t+1],r[t+2]=255-r[t+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(e,t){return{uInvert:e.getUniformLocation(t,"uInvert")}},sendUniformData:function(e,t){e.uniform1i(t.uInvert,this.invert)}}),t.Image.filters.Invert.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.extend,i=t.Image.filters,n=t.util.createClass;i.Noise=n(i.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(e){if(0!==this.noise){var t,r,i=e.imageData.data,n=i.length,a=this.noise;for(t=0,n=i.length;t<n;t+=4)r=(.5-Math.random())*a,i[t]+=r,i[t+1]+=r,i[t+2]+=r}},getUniformLocations:function(e,t){return{uNoise:e.getUniformLocation(t,"uNoise"),uSeed:e.getUniformLocation(t,"uSeed")}},sendUniformData:function(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())},toObject:function(){return r(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Pixelate=i(r.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(e){var t,r,i,n,a,s,o,c,l,u,h,f=e.imageData,d=f.data,p=f.height,m=f.width;for(r=0;r<p;r+=this.blocksize)for(i=0;i<m;i+=this.blocksize)for(n=d[t=4*r*m+4*i],a=d[t+1],s=d[t+2],o=d[t+3],u=Math.min(r+this.blocksize,p),h=Math.min(i+this.blocksize,m),c=r;c<u;c++)for(l=i;l<h;l++)d[t=4*c*m+4*l]=n,d[t+1]=a,d[t+2]=s,d[t+3]=o},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(e,t){return{uBlocksize:e.getUniformLocation(t,"uBlocksize"),uStepW:e.getUniformLocation(t,"uStepW"),uStepH:e.getUniformLocation(t,"uStepH")}},sendUniformData:function(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}),t.Image.filters.Pixelate.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.extend,i=t.Image.filters,n=t.util.createClass;i.RemoveColor=n(i.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(e){var r,i,n,a,s=e.imageData.data,o=255*this.distance,c=new t.Color(this.color).getSource(),l=[c[0]-o,c[1]-o,c[2]-o],u=[c[0]+o,c[1]+o,c[2]+o];for(r=0;r<s.length;r+=4)i=s[r],n=s[r+1],a=s[r+2],i>l[0]&&n>l[1]&&a>l[2]&&i<u[0]&&n<u[1]&&a<u[2]&&(s[r+3]=0)},getUniformLocations:function(e,t){return{uLow:e.getUniformLocation(t,"uLow"),uHigh:e.getUniformLocation(t,"uHigh")}},sendUniformData:function(e,r){var i=new t.Color(this.color).getSource(),n=parseFloat(this.distance),a=[0+i[0]/255-n,0+i[1]/255-n,0+i[2]/255-n,1],s=[i[0]/255+n,i[1]/255+n,i[2]/255+n,1];e.uniform4fv(r.uLow,a),e.uniform4fv(r.uHigh,s)},toObject:function(){return r(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),t.Image.filters.RemoveColor.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var a in n)r[a]=i(r.ColorMatrix,{type:a,matrix:n[a],mainParameter:!1,colorsOnly:!0}),t.Image.filters[a].fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric,r=t.Image.filters,i=t.util.createClass;r.BlendColor=i(r.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(e){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[e]+"}\n}"},retrieveShader:function(e){var t,r=this.type+"_"+this.mode;return e.programCache.hasOwnProperty(r)||(t=this.buildSource(this.mode),e.programCache[r]=this.createProgram(e.context,t)),e.programCache[r]},applyTo2d:function(e){var r,i,n,a,s,o,c,l=e.imageData.data,u=l.length,h=1-this.alpha;r=(c=new t.Color(this.color).getSource())[0]*this.alpha,i=c[1]*this.alpha,n=c[2]*this.alpha;for(var f=0;f<u;f+=4)switch(a=l[f],s=l[f+1],o=l[f+2],this.mode){case"multiply":l[f]=a*r/255,l[f+1]=s*i/255,l[f+2]=o*n/255;break;case"screen":l[f]=255-(255-a)*(255-r)/255,l[f+1]=255-(255-s)*(255-i)/255,l[f+2]=255-(255-o)*(255-n)/255;break;case"add":l[f]=a+r,l[f+1]=s+i,l[f+2]=o+n;break;case"diff":case"difference":l[f]=Math.abs(a-r),l[f+1]=Math.abs(s-i),l[f+2]=Math.abs(o-n);break;case"subtract":l[f]=a-r,l[f+1]=s-i,l[f+2]=o-n;break;case"darken":l[f]=Math.min(a,r),l[f+1]=Math.min(s,i),l[f+2]=Math.min(o,n);break;case"lighten":l[f]=Math.max(a,r),l[f+1]=Math.max(s,i),l[f+2]=Math.max(o,n);break;case"overlay":l[f]=r<128?2*a*r/255:255-2*(255-a)*(255-r)/255,l[f+1]=i<128?2*s*i/255:255-2*(255-s)*(255-i)/255,l[f+2]=n<128?2*o*n/255:255-2*(255-o)*(255-n)/255;break;case"exclusion":l[f]=r+a-2*r*a/255,l[f+1]=i+s-2*i*s/255,l[f+2]=n+o-2*n*o/255;break;case"tint":l[f]=r+a*h,l[f+1]=i+s*h,l[f+2]=n+o*h}},getUniformLocations:function(e,t){return{uColor:e.getUniformLocation(t,"uColor")}},sendUniformData:function(e,r){var i=new t.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,e.uniform4fv(r.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendColor.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric,r=t.Image.filters,i=t.util.createClass;r.BlendImage=i(r.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(e){var t=this.type+"_"+this.mode,r=this.fragmentSource[this.mode];return e.programCache.hasOwnProperty(t)||(e.programCache[t]=this.createProgram(e.context,r)),e.programCache[t]},applyToWebGL:function(e){var t=e.context,r=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,r,t.TEXTURE1),this.callSuper("applyToWebGL",e),this.unbindAdditionalTexture(t,t.TEXTURE1)},createTexture:function(e,t){return e.getCachedTexture(t.cacheKey,t._element)},calculateMatrix:function(){var e=this.image,t=e._element.width,r=e._element.height;return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/r,1]},applyTo2d:function(e){var r,i,n,a,s,o,c,l,u,h,f,d=e.imageData,p=e.filterBackend.resources,m=d.data,b=m.length,v=d.width,g=d.height,y=this.image;p.blendImage||(p.blendImage=t.util.createCanvasElement()),h=(u=p.blendImage).getContext("2d"),u.width!==v||u.height!==g?(u.width=v,u.height=g):h.clearRect(0,0,v,g),h.setTransform(y.scaleX,0,0,y.scaleY,y.left,y.top),h.drawImage(y._element,0,0,v,g),f=h.getImageData(0,0,v,g).data;for(var _=0;_<b;_+=4)switch(s=m[_],o=m[_+1],c=m[_+2],l=m[_+3],r=f[_],i=f[_+1],n=f[_+2],a=f[_+3],this.mode){case"multiply":m[_]=s*r/255,m[_+1]=o*i/255,m[_+2]=c*n/255,m[_+3]=l*a/255;break;case"mask":m[_+3]=a}},getUniformLocations:function(e,t){return{uTransformMatrix:e.getUniformLocation(t,"uTransformMatrix"),uImage:e.getUniformLocation(t,"uImage")}},sendUniformData:function(e,t){var r=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,r)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendImage.fromObject=function(e,r){t.Image.fromObject(e.image,(function(i){var n=t.util.object.clone(e);n.image=i,r(new t.Image.filters.BlendImage(n))}))}}(e),function(e){var t=e.fabric||(e.fabric={}),r=Math.pow,i=Math.floor,n=Math.sqrt,a=Math.abs,s=Math.round,o=Math.sin,c=Math.ceil,l=t.Image.filters,u=t.util.createClass;l.Resize=u(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(e,t){return{uDelta:e.getUniformLocation(t,"uDelta"),uTaps:e.getUniformLocation(t,"uTaps")}},sendUniformData:function(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)},retrieveShader:function(e){var t=this.getFilterWindow(),r=this.type+"_"+t;if(!e.programCache.hasOwnProperty(r)){var i=this.generateShader(t);e.programCache[r]=this.createProgram(e.context,i)}return e.programCache[r]},getFilterWindow:function(){var e=this.tempScale;return Math.ceil(this.lanczosLobes/e)},getTaps:function(){for(var e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,r=this.getFilterWindow(),i=new Array(r),n=1;n<=r;n++)i[n-1]=e(n*t);return i},generateShader:function(e){for(var t=new Array(e),r=this.fragmentSourceTOP,i=1;i<=e;i++)t[i-1]=i+".0 * uDelta";return r+="uniform float uTaps["+e+"];\n",r+="void main() {\n",r+="  vec4 color = texture2D(uTexture, vTexCoord);\n",r+="  float sum = 1.0;\n",t.forEach((function(e,t){r+="  color += texture2D(uTexture, vTexCoord + "+e+") * uTaps["+t+"];\n",r+="  color += texture2D(uTexture, vTexCoord - "+e+") * uTaps["+t+"];\n",r+="  sum += 2.0 * uTaps["+t+"];\n"})),r+="  gl_FragColor = color / sum;\n",r+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(e){e.webgl?(e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e),e.sourceHeight=e.destinationHeight):this.applyTo2d(e)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(e){return function(t){if(t>=e||t<=-e)return 0;if(t<1.1920929e-7&&t>-1.1920929e-7)return 1;var r=(t*=Math.PI)/e;return o(t)/t*o(r)/r}},applyTo2d:function(e){var t=e.imageData,r=this.scaleX,i=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/i;var n,a=t.width,o=t.height,c=s(a*r),l=s(o*i);"sliceHack"===this.resizeType?n=this.sliceByTwo(e,a,o,c,l):"hermite"===this.resizeType?n=this.hermiteFastResize(e,a,o,c,l):"bilinear"===this.resizeType?n=this.bilinearFiltering(e,a,o,c,l):"lanczos"===this.resizeType&&(n=this.lanczosResize(e,a,o,c,l)),e.imageData=n},sliceByTwo:function(e,r,n,a,s){var o,c,l=e.imageData,u=.5,h=!1,f=!1,d=r*u,p=n*u,m=t.filterBackend.resources,b=0,v=0,g=r,y=0;for(m.sliceByTwo||(m.sliceByTwo=document.createElement("canvas")),((o=m.sliceByTwo).width<1.5*r||o.height<n)&&(o.width=1.5*r,o.height=n),(c=o.getContext("2d")).clearRect(0,0,1.5*r,n),c.putImageData(l,0,0),a=i(a),s=i(s);!h||!f;)r=d,n=p,a<i(d*u)?d=i(d*u):(d=a,h=!0),s<i(p*u)?p=i(p*u):(p=s,f=!0),c.drawImage(o,b,v,r,n,g,y,d,p),b=g,v=y,y+=p;return c.getImageData(b,v,a,s)},lanczosResize:function(e,t,s,o,l){var u=e.imageData.data,h=e.ctx.createImageData(o,l),f=h.data,d=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,m=this.rcpScaleY,b=2/this.rcpScaleX,v=2/this.rcpScaleY,g=c(p*this.lanczosLobes/2),y=c(m*this.lanczosLobes/2),_={},w={},x={};return function e(c){var k,S,C,U,E,T,M,O,P,A,I;for(w.x=(c+.5)*p,x.x=i(w.x),k=0;k<l;k++){for(w.y=(k+.5)*m,x.y=i(w.y),E=0,T=0,M=0,O=0,P=0,S=x.x-g;S<=x.x+g;S++)if(!(S<0||S>=t)){A=i(1e3*a(S-w.x)),_[A]||(_[A]={});for(var L=x.y-y;L<=x.y+y;L++)L<0||L>=s||(I=i(1e3*a(L-w.y)),_[A][I]||(_[A][I]=d(n(r(A*b,2)+r(I*v,2))/1e3)),(C=_[A][I])>0&&(E+=C,T+=C*u[U=4*(L*t+S)],M+=C*u[U+1],O+=C*u[U+2],P+=C*u[U+3]))}f[U=4*(k*o+c)]=T/E,f[U+1]=M/E,f[U+2]=O/E,f[U+3]=P/E}return++c<o?e(c):h}(0)},bilinearFiltering:function(e,t,r,n,a){var s,o,c,l,u,h,f,d,p,m=0,b=this.rcpScaleX,v=this.rcpScaleY,g=4*(t-1),y=e.imageData.data,_=e.ctx.createImageData(n,a),w=_.data;for(c=0;c<a;c++)for(l=0;l<n;l++)for(u=b*l-(s=i(b*l)),h=v*c-(o=i(v*c)),p=4*(o*t+s),f=0;f<4;f++)d=y[p+f]*(1-u)*(1-h)+y[p+4+f]*u*(1-h)+y[p+g+f]*h*(1-u)+y[p+g+4+f]*u*h,w[m++]=d;return _},hermiteFastResize:function(e,t,r,s,o){for(var l=this.rcpScaleX,u=this.rcpScaleY,h=c(l/2),f=c(u/2),d=e.imageData.data,p=e.ctx.createImageData(s,o),m=p.data,b=0;b<o;b++)for(var v=0;v<s;v++){for(var g=4*(v+b*s),y=0,_=0,w=0,x=0,k=0,S=0,C=0,U=(b+.5)*u,E=i(b*u);E<(b+1)*u;E++)for(var T=a(U-(E+.5))/f,M=(v+.5)*l,O=T*T,P=i(v*l);P<(v+1)*l;P++){var A=a(M-(P+.5))/h,I=n(O+A*A);I>1&&I<-1||(y=2*I*I*I-3*I*I+1)>0&&(C+=y*d[(A=4*(P+E*t))+3],w+=y,d[A+3]<255&&(y=y*d[A+3]/250),x+=y*d[A],k+=y*d[A+1],S+=y*d[A+2],_+=y)}m[g]=x/_,m[g+1]=k/_,m[g+2]=S/_,m[g+3]=C/w}return p},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),t.Image.filters.Resize.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Contrast=i(r.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(e){if(0!==this.contrast){var t,r=e.imageData.data,i=r.length,n=Math.floor(255*this.contrast),a=259*(n+255)/(255*(259-n));for(t=0;t<i;t+=4)r[t]=a*(r[t]-128)+128,r[t+1]=a*(r[t+1]-128)+128,r[t+2]=a*(r[t+2]-128)+128}},getUniformLocations:function(e,t){return{uContrast:e.getUniformLocation(t,"uContrast")}},sendUniformData:function(e,t){e.uniform1f(t.uContrast,this.contrast)}}),t.Image.filters.Contrast.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Saturation=i(r.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(e){if(0!==this.saturation){var t,r,i=e.imageData.data,n=i.length,a=-this.saturation;for(t=0;t<n;t+=4)r=Math.max(i[t],i[t+1],i[t+2]),i[t]+=r!==i[t]?(r-i[t])*a:0,i[t+1]+=r!==i[t+1]?(r-i[t+1])*a:0,i[t+2]+=r!==i[t+2]?(r-i[t+2])*a:0}},getUniformLocations:function(e,t){return{uSaturation:e.getUniformLocation(t,"uSaturation")}},sendUniformData:function(e,t){e.uniform1f(t.uSaturation,-this.saturation)}}),t.Image.filters.Saturation.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Vibrance=i(r.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(e){if(0!==this.vibrance){var t,r,i,n,a=e.imageData.data,s=a.length,o=-this.vibrance;for(t=0;t<s;t+=4)r=Math.max(a[t],a[t+1],a[t+2]),i=(a[t]+a[t+1]+a[t+2])/3,n=2*Math.abs(r-i)/255*o,a[t]+=r!==a[t]?(r-a[t])*n:0,a[t+1]+=r!==a[t+1]?(r-a[t+1])*n:0,a[t+2]+=r!==a[t+2]?(r-a[t+2])*n:0}},getUniformLocations:function(e,t){return{uVibrance:e.getUniformLocation(t,"uVibrance")}},sendUniformData:function(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}}),t.Image.filters.Vibrance.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Blur=i(r.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(e){e.webgl?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},applyTo2d:function(e){e.imageData=this.simpleBlur(e)},simpleBlur:function(e){var r,i,n=e.filterBackend.resources,a=e.imageData.width,s=e.imageData.height;n.blurLayer1||(n.blurLayer1=t.util.createCanvasElement(),n.blurLayer2=t.util.createCanvasElement()),r=n.blurLayer1,i=n.blurLayer2,r.width===a&&r.height===s||(i.width=r.width=a,i.height=r.height=s);var o,c,l,u,h=r.getContext("2d"),f=i.getContext("2d"),d=15,p=.06*this.blur*.5;for(h.putImageData(e.imageData,0,0),f.clearRect(0,0,a,s),u=-15;u<=d;u++)l=p*(c=u/d)*a+(o=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(c),f.drawImage(r,l,o),h.drawImage(i,0,0),f.globalAlpha=1,f.clearRect(0,0,i.width,i.height);for(u=-15;u<=d;u++)l=p*(c=u/d)*s+(o=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(c),f.drawImage(r,o,l),h.drawImage(i,0,0),f.globalAlpha=1,f.clearRect(0,0,i.width,i.height);e.ctx.drawImage(r,0,0);var m=e.ctx.getImageData(0,0,r.width,r.height);return h.globalAlpha=1,h.clearRect(0,0,r.width,r.height),m},getUniformLocations:function(e,t){return{delta:e.getUniformLocation(t,"uDelta")}},sendUniformData:function(e,t){var r=this.chooseRightDelta();e.uniform2fv(t.delta,r)},chooseRightDelta:function(){var e,t=1,r=[0,0];return this.horizontal?this.aspectRatio>1&&(t=1/this.aspectRatio):this.aspectRatio<1&&(t=this.aspectRatio),e=t*this.blur*.12,this.horizontal?r[0]=e:r[1]=e,r}}),r.Blur.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Gamma=i(r.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(e){this.gamma=[1,1,1],r.BaseFilter.prototype.initialize.call(this,e)},applyTo2d:function(e){var t,r=e.imageData.data,i=this.gamma,n=r.length,a=1/i[0],s=1/i[1],o=1/i[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),t=0,n=256;t<n;t++)this.rVals[t]=255*Math.pow(t/255,a),this.gVals[t]=255*Math.pow(t/255,s),this.bVals[t]=255*Math.pow(t/255,o);for(t=0,n=r.length;t<n;t+=4)r[t]=this.rVals[r[t]],r[t+1]=this.gVals[r[t+1]],r[t+2]=this.bVals[r[t+2]]},getUniformLocations:function(e,t){return{uGamma:e.getUniformLocation(t,"uGamma")}},sendUniformData:function(e,t){e.uniform3fv(t.uGamma,this.gamma)}}),t.Image.filters.Gamma.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.Composed=i(r.BaseFilter,{type:"Composed",subFilters:[],initialize:function(e){this.callSuper("initialize",e),this.subFilters=this.subFilters.slice(0)},applyTo:function(e){e.passes+=this.subFilters.length-1,this.subFilters.forEach((function(t){t.applyTo(e)}))},toObject:function(){return t.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(e){return e.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(e){return!e.isNeutralState()}))}}),t.Image.filters.Composed.fromObject=function(e,r){var i=(e.subFilters||[]).map((function(e){return new t.Image.filters[e.type](e)})),n=new t.Image.filters.Composed({subFilters:i});return r&&r(n),n}}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.Image.filters,i=t.util.createClass;r.HueRotation=i(r.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var e=this.rotation*Math.PI,r=t.util.cos(e),i=t.util.sin(e),n=1/3,a=Math.sqrt(n)*i,s=1-r;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=r+s/3,this.matrix[1]=n*s-a,this.matrix[2]=n*s+a,this.matrix[5]=n*s+a,this.matrix[6]=r+n*s,this.matrix[7]=n*s-a,this.matrix[10]=n*s-a,this.matrix[11]=n*s+a,this.matrix[12]=r+n*s},isNeutralState:function(e){return this.calculateMatrix(),r.BaseFilter.prototype.isNeutralState.call(this,e)},applyTo:function(e){this.calculateMatrix(),r.BaseFilter.prototype.applyTo.call(this,e)}}),t.Image.filters.HueRotation.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),r=t.util.object.clone;if(t.Text)t.warn("fabric.Text is already defined");else{var i="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:t.Object.prototype.stateProperties.concat(i),cacheProperties:t.Object.prototype.cacheProperties.concat(i),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(e,t){this.styles=t&&t.styles||{},this.text=e,this.__skipDimension=!0,this.callSuper("initialize",t),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var e=this.path;e&&(e.segmentsInfo=t.util.getPathSegmentsInfo(e.path))},getMeasuringContext:function(){return t._measuringContext||(t._measuringContext=this.canvas&&this.canvas.contextCache||t.util.createCanvasElement().getContext("2d")),t._measuringContext},_splitText:function(){var e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var e,t,r,i,n,a,s,o=0,c=this._textLines.length;o<c;o++)if(("justify"===this.textAlign||o!==c-1&&!this.isEndOfWrapping(o))&&(i=0,n=this._textLines[o],(t=this.getLineWidth(o))<this.width&&(s=this.textLines[o].match(this._reSpacesAndTabs)))){r=s.length,e=(this.width-t)/r;for(var l=0,u=n.length;l<=u;l++)a=this.__charBounds[o][l],this._reSpaceAndTab.test(n[l])?(a.width+=e,a.kernedWidth+=e,a.left+=i,i+=e):a.left+=i}},isEndOfWrapping:function(e){return e===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var e=this.callSuper("_getCacheCanvasDimensions"),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e},_render:function(e){var t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")},_renderText:function(e){"stroke"===this.paintFirst?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))},_setTextStyles:function(e,t,r){if(e.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":e.textBaseline="middle";break;case"ascender":e.textBaseline="top";break;case"descender":e.textBaseline="bottom"}e.font=this._getFontDeclaration(t,r)},calcTextWidth:function(){for(var e=this.getLineWidth(0),t=1,r=this._textLines.length;t<r;t++){var i=this.getLineWidth(t);i>e&&(e=i)}return e},_renderTextLine:function(e,t,r,i,n,a){this._renderChars(e,t,r,i,n,a)},_renderTextLinesBackground:function(e){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var t,r,i,n,a,s,o,c=e.fillStyle,l=this._getLeftOffset(),u=this._getTopOffset(),h=0,f=0,d=this.path,p=0,m=this._textLines.length;p<m;p++)if(t=this.getHeightOfLine(p),this.textBackgroundColor||this.styleHas("textBackgroundColor",p)){i=this._textLines[p],r=this._getLineLeftOffset(p),f=0,h=0,n=this.getValueOfPropertyAt(p,0,"textBackgroundColor");for(var b=0,v=i.length;b<v;b++)a=this.__charBounds[p][b],s=this.getValueOfPropertyAt(p,b,"textBackgroundColor"),d?(e.save(),e.translate(a.renderLeft,a.renderTop),e.rotate(a.angle),e.fillStyle=s,s&&e.fillRect(-a.width/2,-t/this.lineHeight*(1-this._fontSizeFraction),a.width,t/this.lineHeight),e.restore()):s!==n?(o=l+r+h,"rtl"===this.direction&&(o=this.width-o-f),e.fillStyle=n,n&&e.fillRect(o,u,f,t/this.lineHeight),h=a.left,f=a.width,n=s):f+=a.kernedWidth;s&&!d&&(o=l+r+h,"rtl"===this.direction&&(o=this.width-o-f),e.fillStyle=s,e.fillRect(o,u,f,t/this.lineHeight)),u+=t}else u+=t;e.fillStyle=c,this._removeShadow(e)}},getFontCache:function(e){var r=e.fontFamily.toLowerCase();t.charWidthsCache[r]||(t.charWidthsCache[r]={});var i=t.charWidthsCache[r],n=e.fontStyle.toLowerCase()+"_"+(e.fontWeight+"").toLowerCase();return i[n]||(i[n]={}),i[n]},_measureChar:function(e,t,r,i){var n,a,s,o,c=this.getFontCache(t),l=r+e,u=this._getFontDeclaration(t)===this._getFontDeclaration(i),h=t.fontSize/this.CACHE_FONT_SIZE;if(r&&void 0!==c[r]&&(s=c[r]),void 0!==c[e]&&(o=n=c[e]),u&&void 0!==c[l]&&(o=(a=c[l])-s),void 0===n||void 0===s||void 0===a){var f=this.getMeasuringContext();this._setTextStyles(f,t,!0)}return void 0===n&&(o=n=f.measureText(e).width,c[e]=n),void 0===s&&u&&r&&(s=f.measureText(r).width,c[r]=s),u&&void 0===a&&(a=f.measureText(l).width,c[l]=a,o=a-s),{width:n*h,kernedWidth:o*h}},getHeightOfChar:function(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")},measureLine:function(e){var t=this._measureLine(e);return 0!==this.charSpacing&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t},_measureLine:function(e){var r,i,n,a,s,o,c=0,l=this._textLines[e],u=new Array(l.length),h=0,f=this.path,d="right"===this.pathSide;for(this.__charBounds[e]=u,r=0;r<l.length;r++)i=l[r],a=this._getGraphemeBox(i,e,r,n),u[r]=a,c+=a.kernedWidth,n=i;if(u[r]={left:a?a.left+a.width:0,width:0,kernedWidth:0,height:this.fontSize},f){switch(o=f.segmentsInfo[f.segmentsInfo.length-1].length,(s=t.util.getPointOnPath(f.path,0,f.segmentsInfo)).x+=f.pathOffset.x,s.y+=f.pathOffset.y,this.textAlign){case"left":h=d?o-c:0;break;case"center":h=(o-c)/2;break;case"right":h=d?0:o-c}for(h+=this.pathStartOffset*(d?-1:1),r=d?l.length-1:0;d?r>=0:r<l.length;d?r--:r++)a=u[r],h>o?h%=o:h<0&&(h+=o),this._setGraphemeOnPath(h,a,s),h+=a.kernedWidth}return{width:c,numOfSpaces:0}},_setGraphemeOnPath:function(e,r,i){var n=e+r.kernedWidth/2,a=this.path,s=t.util.getPointOnPath(a.path,n,a.segmentsInfo);r.renderLeft=s.x-i.x,r.renderTop=s.y-i.y,r.angle=s.angle+("right"===this.pathSide?Math.PI:0)},_getGraphemeBox:function(e,t,r,i,n){var a,s=this.getCompleteStyleDeclaration(t,r),o=i?this.getCompleteStyleDeclaration(t,r-1):{},c=this._measureChar(e,s,i,o),l=c.kernedWidth,u=c.width;0!==this.charSpacing&&(u+=a=this._getWidthOfCharSpacing(),l+=a);var h={width:u,left:0,height:s.fontSize,kernedWidth:l,deltaY:s.deltaY};if(r>0&&!n){var f=this.__charBounds[t][r-1];h.left=f.left+f.width+c.kernedWidth-c.width}return h},getHeightOfLine:function(e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var t=this._textLines[e],r=this.getHeightOfChar(e,0),i=1,n=t.length;i<n;i++)r=Math.max(this.getHeightOfChar(e,i),r);return this.__lineHeights[e]=r*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var e,t=0,r=0,i=this._textLines.length;r<i;r++)e=this.getHeightOfLine(r),t+=r===i-1?e/this.lineHeight:e;return t},_getLeftOffset:function(){return"ltr"===this.direction?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(e,t){e.save();for(var r=0,i=this._getLeftOffset(),n=this._getTopOffset(),a=0,s=this._textLines.length;a<s;a++){var o=this.getHeightOfLine(a),c=o/this.lineHeight,l=this._getLineLeftOffset(a);this._renderTextLine(t,e,this._textLines[a],i+l,n+r+c,a),r+=o}e.restore()},_renderTextFill:function(e){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(e,"fillText")},_renderTextStroke:function(e){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())},_renderChars:function(e,r,i,n,a,s){var o,c,l,u,h,f=this.getHeightOfLine(s),d=-1!==this.textAlign.indexOf("justify"),p="",m=0,b=this.path,v=!d&&0===this.charSpacing&&this.isEmptyStyles(s)&&!b,g="ltr"===this.direction,y="ltr"===this.direction?1:-1,_=r.canvas.getAttribute("dir");if(r.save(),_!==this.direction&&(r.canvas.setAttribute("dir",g?"ltr":"rtl"),r.direction=g?"ltr":"rtl",r.textAlign=g?"left":"right"),a-=f*this._fontSizeFraction/this.lineHeight,v)return this._renderChar(e,r,s,0,i.join(""),n,a,f),void r.restore();for(var w=0,x=i.length-1;w<=x;w++)u=w===x||this.charSpacing||b,p+=i[w],l=this.__charBounds[s][w],0===m?(n+=y*(l.kernedWidth-l.width),m+=l.width):m+=l.kernedWidth,d&&!u&&this._reSpaceAndTab.test(i[w])&&(u=!0),u||(o=o||this.getCompleteStyleDeclaration(s,w),c=this.getCompleteStyleDeclaration(s,w+1),u=t.util.hasStyleChanged(o,c,!1)),u&&(b?(r.save(),r.translate(l.renderLeft,l.renderTop),r.rotate(l.angle),this._renderChar(e,r,s,w,p,-m/2,0,f),r.restore()):(h=n,this._renderChar(e,r,s,w,p,h,a,f)),p="",o=c,n+=y*m,m=0);r.restore()},_applyPatternGradientTransformText:function(e){var r,i=t.util.createCanvasElement(),n=this.width+this.strokeWidth,a=this.height+this.strokeWidth;return i.width=n,i.height=a,(r=i.getContext("2d")).beginPath(),r.moveTo(0,0),r.lineTo(n,0),r.lineTo(n,a),r.lineTo(0,a),r.closePath(),r.translate(n/2,a/2),r.fillStyle=e.toLive(r),this._applyPatternGradientTransform(r,e),r.fill(),r.createPattern(i,"no-repeat")},handleFiller:function(e,t,r){var i,n;return r.toLive?"percentage"===r.gradientUnits||r.gradientTransform||r.patternTransform?(i=-this.width/2,n=-this.height/2,e.translate(i,n),e[t]=this._applyPatternGradientTransformText(r),{offsetX:i,offsetY:n}):(e[t]=r.toLive(e,this),this._applyPatternGradientTransform(e,r)):(e[t]=r,{offsetX:0,offsetY:0})},_setStrokeStyles:function(e,t){return e.lineWidth=t.strokeWidth,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",t.stroke)},_setFillStyles:function(e,t){return this.handleFiller(e,"fillStyle",t.fill)},_renderChar:function(e,t,r,i,n,a,s){var o,c,l=this._getStyleDeclaration(r,i),u=this.getCompleteStyleDeclaration(r,i),h="fillText"===e&&u.fill,f="strokeText"===e&&u.stroke&&u.strokeWidth;(f||h)&&(t.save(),h&&(o=this._setFillStyles(t,u)),f&&(c=this._setStrokeStyles(t,u)),t.font=this._getFontDeclaration(u),l&&l.textBackgroundColor&&this._removeShadow(t),l&&l.deltaY&&(s+=l.deltaY),h&&t.fillText(n,a-o.offsetX,s-o.offsetY),f&&t.strokeText(n,a-c.offsetX,s-c.offsetY),t.restore())},setSuperscript:function(e,t){return this._setScript(e,t,this.superscript)},setSubscript:function(e,t){return this._setScript(e,t,this.subscript)},_setScript:function(e,t,r){var i=this.get2DCursorLocation(e,!0),n=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),a=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),s={fontSize:n*r.size,deltaY:a+n*r.baseline};return this.setSelectionStyles(s,e,t),this},_getLineLeftOffset:function(e){var t=this.getLineWidth(e),r=this.width-t,i=this.textAlign,n=this.direction,a=0,s=this.isEndOfWrapping(e);return"justify"===i||"justify-center"===i&&!s||"justify-right"===i&&!s||"justify-left"===i&&!s?0:("center"===i&&(a=r/2),"right"===i&&(a=r),"justify-center"===i&&(a=r/2),"justify-right"===i&&(a=r),"rtl"===n&&(a-=r),a)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var e=this._forceClearCache;return e||(e=this.hasStateChanged("_dimensionAffectingProps")),e&&(this.dirty=!0,this._forceClearCache=!1),e},getLineWidth:function(e){if(void 0!==this.__lineWidths[e])return this.__lineWidths[e];var t=this.measureLine(e).width;return this.__lineWidths[e]=t,t},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(e,t,r){var i=this._getStyleDeclaration(e,t);return i&&void 0!==i[r]?i[r]:this[r]},_renderTextDecoration:function(e,t){if(this[t]||this.styleHas(t)){for(var r,i,n,a,s,o,c,l,u,h,f,d,p,m,b,v,g=this._getLeftOffset(),y=this._getTopOffset(),_=this.path,w=this._getWidthOfCharSpacing(),x=this.offsets[t],k=0,S=this._textLines.length;k<S;k++)if(r=this.getHeightOfLine(k),this[t]||this.styleHas(t,k)){c=this._textLines[k],m=r/this.lineHeight,a=this._getLineLeftOffset(k),h=0,f=0,l=this.getValueOfPropertyAt(k,0,t),v=this.getValueOfPropertyAt(k,0,"fill"),u=y+m*(1-this._fontSizeFraction),i=this.getHeightOfChar(k,0),s=this.getValueOfPropertyAt(k,0,"deltaY");for(var C=0,U=c.length;C<U;C++)if(d=this.__charBounds[k][C],p=this.getValueOfPropertyAt(k,C,t),b=this.getValueOfPropertyAt(k,C,"fill"),n=this.getHeightOfChar(k,C),o=this.getValueOfPropertyAt(k,C,"deltaY"),_&&p&&b)e.save(),e.fillStyle=v,e.translate(d.renderLeft,d.renderTop),e.rotate(d.angle),e.fillRect(-d.kernedWidth/2,x*n+o,d.kernedWidth,this.fontSize/15),e.restore();else if((p!==l||b!==v||n!==i||o!==s)&&f>0){var E=g+a+h;"rtl"===this.direction&&(E=this.width-E-f),l&&v&&(e.fillStyle=v,e.fillRect(E,u+x*i+s,f,this.fontSize/15)),h=d.left,f=d.width,l=p,v=b,i=n,s=o}else f+=d.kernedWidth;E=g+a+h;"rtl"===this.direction&&(E=this.width-E-f),e.fillStyle=b,p&&b&&e.fillRect(E,u+x*i+s,f-w,this.fontSize/15),y+=r}else y+=r;this._removeShadow(e)}},_getFontDeclaration:function(e,r){var i=e||this,n=this.fontFamily,a=t.Text.genericFonts.indexOf(n.toLowerCase())>-1,s=void 0===n||n.indexOf("'")>-1||n.indexOf(",")>-1||n.indexOf('"')>-1||a?i.fontFamily:'"'+i.fontFamily+'"';return[t.isLikelyNode?i.fontWeight:i.fontStyle,t.isLikelyNode?i.fontStyle:i.fontWeight,r?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",s].join(" ")},render:function(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",e)))},_splitTextIntoLines:function(e){for(var r=e.split(this._reNewline),i=new Array(r.length),n=["\n"],a=[],s=0;s<r.length;s++)i[s]=t.util.string.graphemeSplit(r[s]),a=a.concat(i[s],n);return a.pop(),{_unwrappedLines:i,lines:r,graphemeText:a,graphemeLines:i}},toObject:function(e){var r=i.concat(e),n=this.callSuper("toObject",r);return n.styles=t.util.stylesToArray(this.styles,this.text),n.path&&(n.path=this.path.toObject()),n},set:function(e,t){this.callSuper("set",e,t);var r=!1,i=!1;if("object"===_(e))for(var n in e)"path"===n&&this.setPathInfo(),r=r||-1!==this._dimensionAffectingProps.indexOf(n),i=i||"path"===n;else r=-1!==this._dimensionAffectingProps.indexOf(e),i="path"===e;return i&&this.setPathInfo(),r&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(e,i,n){if(!e)return i(null);var a=t.parseAttributes(e,t.Text.ATTRIBUTE_NAMES),s=a.textAnchor||"left";if((n=t.util.object.extend(n?r(n):{},a)).top=n.top||0,n.left=n.left||0,a.textDecoration){var o=a.textDecoration;-1!==o.indexOf("underline")&&(n.underline=!0),-1!==o.indexOf("overline")&&(n.overline=!0),-1!==o.indexOf("line-through")&&(n.linethrough=!0),delete n.textDecoration}"dx"in a&&(n.left+=a.dx),"dy"in a&&(n.top+=a.dy),"fontSize"in n||(n.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in e?c=e.textContent:"firstChild"in e&&null!==e.firstChild&&"data"in e.firstChild&&null!==e.firstChild.data&&(c=e.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var l=n.strokeWidth;n.strokeWidth=0;var u=new t.Text(c,n),h=u.getScaledHeight()/u.height,f=((u.height+u.strokeWidth)*u.lineHeight-u.height)*h,d=u.getScaledHeight()+f,p=0;"center"===s&&(p=u.getScaledWidth()/2),"right"===s&&(p=u.getScaledWidth()),u.set({left:u.left-p,top:u.top-(d-u.fontSize*(.07+u._fontSizeFraction))/u.lineHeight,strokeWidth:void 0!==l?l:1}),i(u)},t.Text.fromObject=function(e,i){var n=r(e),a=e.path;return delete n.path,t.Object._fromObject("Text",n,(function(r){r.styles=t.util.stylesFromArray(e.styles,e.text),a?t.Object._fromObject("Path",a,(function(e){r.set("path",e),i(r)}),"path"):i(r)}),"text")},t.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],t.util.createAccessors&&t.util.createAccessors(t.Text)}}(e),k.util.object.extend(k.Text.prototype,{isEmptyStyles:function(e){if(!this.styles)return!0;if(void 0!==e&&!this.styles[e])return!0;var t=void 0===e?this.styles:{line:this.styles[e]};for(var r in t)for(var i in t[r])for(var n in t[r][i])return!1;return!0},styleHas:function(e,t){if(!this.styles||!e||""===e)return!1;if(void 0!==t&&!this.styles[t])return!1;var r=void 0===t?this.styles:{0:this.styles[t]};for(var i in r)for(var n in r[i])if(void 0!==r[i][n][e])return!0;return!1},cleanStyle:function(e){if(!this.styles||!e||""===e)return!1;var t,r,i=this.styles,n=0,a=!0,s=0;for(var o in i){for(var c in t=0,i[o]){var l;n++,(l=i[o][c]).hasOwnProperty(e)?(r?l[e]!==r&&(a=!1):r=l[e],l[e]===this[e]&&delete l[e]):a=!1,0!==Object.keys(l).length?t++:delete i[o][c]}0===t&&delete i[o]}for(var u=0;u<this._textLines.length;u++)s+=this._textLines[u].length;a&&n===s&&(this[e]=r,this.removeStyle(e))},removeStyle:function(e){if(this.styles&&e&&""!==e){var t,r,i,n=this.styles;for(r in n){for(i in t=n[r])delete t[i][e],0===Object.keys(t[i]).length&&delete t[i];0===Object.keys(t).length&&delete n[r]}}},_extendStyles:function(e,t){var r=this.get2DCursorLocation(e);this._getLineStyle(r.lineIndex)||this._setLineStyle(r.lineIndex),this._getStyleDeclaration(r.lineIndex,r.charIndex)||this._setStyleDeclaration(r.lineIndex,r.charIndex,{}),k.util.object.extend(this._getStyleDeclaration(r.lineIndex,r.charIndex),t)},get2DCursorLocation:function(e,t){void 0===e&&(e=this.selectionStart);for(var r=t?this._unwrappedTextLines:this._textLines,i=r.length,n=0;n<i;n++){if(e<=r[n].length)return{lineIndex:n,charIndex:e};e-=r[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:r[n-1].length<e?r[n-1].length:e}},getSelectionStyles:function(e,t,r){void 0===e&&(e=this.selectionStart||0),void 0===t&&(t=this.selectionEnd||e);for(var i=[],n=e;n<t;n++)i.push(this.getStyleAtPosition(n,r));return i},getStyleAtPosition:function(e,t){var r=this.get2DCursorLocation(e);return(t?this.getCompleteStyleDeclaration(r.lineIndex,r.charIndex):this._getStyleDeclaration(r.lineIndex,r.charIndex))||{}},setSelectionStyles:function(e,t,r){void 0===t&&(t=this.selectionStart||0),void 0===r&&(r=this.selectionEnd||t);for(var i=t;i<r;i++)this._extendStyles(i,e);return this._forceClearCache=!0,this},_getStyleDeclaration:function(e,t){var r=this.styles&&this.styles[e];return r?r[t]:null},getCompleteStyleDeclaration:function(e,t){for(var r,i=this._getStyleDeclaration(e,t)||{},n={},a=0;a<this._styleProperties.length;a++)n[r=this._styleProperties[a]]=void 0===i[r]?this[r]:i[r];return n},_setStyleDeclaration:function(e,t,r){this.styles[e][t]=r},_deleteStyleDeclaration:function(e,t){delete this.styles[e][t]},_getLineStyle:function(e){return!!this.styles[e]},_setLineStyle:function(e){this.styles[e]={}},_deleteLineStyle:function(e){delete this.styles[e]}}),function(){function e(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}k.IText=k.util.createClass(k.Text,k.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,t){this.callSuper("initialize",e,t),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this.canvas.contextTop,r=this.canvas.viewportTransform;t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(t),this._clearTextArea(t),e||t.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this._getCursorBoundaries(),t=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),t.restore()}},_clearTextArea:function(e){var t=this.width+4,r=this.height+4;e.clearRect(-t/2,-r/2,t,r)},_getCursorBoundaries:function(e){void 0===e&&(e=this.selectionStart);var t=this._getLeftOffset(),r=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e);return{left:t,top:r,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var t,r,i,n,a=0,s=0,o=this.get2DCursorLocation(e);i=o.charIndex,r=o.lineIndex;for(var c=0;c<r;c++)a+=this.getHeightOfLine(c);t=this._getLineLeftOffset(r);var l=this.__charBounds[r][i];return l&&(s=l.left),0!==this.charSpacing&&i===this._textLines[r].length&&(s-=this._getWidthOfCharSpacing()),n={top:a,left:t+(s>0?s:0)},"rtl"===this.direction&&(n.left*=-1),this.cursorOffsetCache=n,this.cursorOffsetCache},renderCursor:function(e,t){var r=this.get2DCursorLocation(),i=r.lineIndex,n=r.charIndex>0?r.charIndex-1:0,a=this.getValueOfPropertyAt(i,n,"fontSize"),s=this.scaleX*this.canvas.getZoom(),o=this.cursorWidth/s,c=e.topOffset,l=this.getValueOfPropertyAt(i,n,"deltaY");c+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-a*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,t),t.fillStyle=this.cursorColor||this.getValueOfPropertyAt(i,n,"fill"),t.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,t.fillRect(e.left+e.leftOffset-o/2,c+e.top+l,o,a)},renderSelection:function(e,t){for(var r=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,n=-1!==this.textAlign.indexOf("justify"),a=this.get2DCursorLocation(r),s=this.get2DCursorLocation(i),o=a.lineIndex,c=s.lineIndex,l=a.charIndex<0?0:a.charIndex,u=s.charIndex<0?0:s.charIndex,h=o;h<=c;h++){var f,d=this._getLineLeftOffset(h)||0,p=this.getHeightOfLine(h),m=0,b=0;if(h===o&&(m=this.__charBounds[o][l].left),h>=o&&h<c)b=n&&!this.isEndOfWrapping(h)?this.width:this.getLineWidth(h)||5;else if(h===c)if(0===u)b=this.__charBounds[c][u].left;else{var v=this._getWidthOfCharSpacing();b=this.__charBounds[c][u-1].left+this.__charBounds[c][u-1].width-v}f=p,(this.lineHeight<1||h===c&&this.lineHeight>1)&&(p/=this.lineHeight);var g=e.left+d+m,y=b-m,_=p,w=0;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",_=1,w=p):t.fillStyle=this.selectionColor,"rtl"===this.direction&&(g=this.width-g-y),t.fillRect(g,e.top+e.topOffset+w,y,_),e.topOffset+=f}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}}),k.IText.fromObject=function(t,r){var i=k.util.stylesFromArray(t.styles,t.text),n=Object.assign({},t,{styles:i});if(e(n),n.styles)for(var a in n.styles)for(var s in n.styles[a])e(n.styles[a][s]);k.Object._fromObject("IText",n,r,"text")}}(),x=k.util.object.clone,k.util.object.extend(k.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",(function(){var t=e.canvas;t&&(t._hasITextHandlers||(t._hasITextHandlers=!0,e._initCanvasHandlers(t)),t._iTextInstances=t._iTextInstances||[],t._iTextInstances.push(e))}))},initRemovedHandler:function(){var e=this;this.on("removed",(function(){var t=e.canvas;t&&(t._iTextInstances=t._iTextInstances||[],k.util.removeFromArray(t._iTextInstances,e),0===t._iTextInstances.length&&(t._hasITextHandlers=!1,e._removeCanvasHandlers(t)))}))},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach((function(e){e.__isMousedown=!1}))},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,t,r,i){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",t,{duration:r,onComplete:function(){n.isAborted||e[i]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(e){var t=this,r=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){t._tick()}),r)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,t=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&t&&t.clearContext(t.contextTop||t.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var t=0,r=e-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r--;for(;/\S/.test(this._text[r])&&r>-1;)t++,r--;return e-t},findWordBoundaryRight:function(e){var t=0,r=e;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t},findLineBoundaryLeft:function(e){for(var t=0,r=e-1;!/\n/.test(this._text[r])&&r>-1;)t++,r--;return e-t},findLineBoundaryRight:function(e){for(var t=0,r=e;!/\n/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t},searchWordBoundary:function(e,t){for(var r=this._text,i=this._reSpace.test(r[e])?e-1:e,n=r[i],a=k.reNonWord;!a.test(n)&&i>0&&i<r.length;)n=r[i+=t];return a.test(n)&&(i+=1===t?0:1),i},selectWord:function(e){e=e||this.selectionStart;var t=this.searchWordBoundary(e,-1),r=this.searchWordBoundary(e,1);this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var t=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach((function(e){e.selected=!1,e.isEditing&&e.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(this.__isMousedown&&this.isEditing){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var t=this.getSelectionStartFromPointer(e.e),r=this.selectionStart,i=this.selectionEnd;(t===this.__selectionStartOnMouseDown&&r!==i||r!==t&&i!==t)&&(t>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=t):(this.selectionStart=t,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===i||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,t,r){var i=r.slice(0,e),n=k.util.string.graphemeSplit(i).length;if(e===t)return{selectionStart:n,selectionEnd:n};var a=r.slice(e,t);return{selectionStart:n,selectionEnd:n+k.util.string.graphemeSplit(a).length}},fromGraphemeToStringSelection:function(e,t,r){var i=r.slice(0,e).join("").length;return e===t?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+r.slice(e,t).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),i=r.lineIndex,n=r.charIndex,a=this.getValueOfPropertyAt(i,n,"fontSize")*this.lineHeight,s=t.leftOffset,o=this.calcTransformMatrix(),c={x:t.left+s,y:t.top+t.topOffset+a},l=this.canvas.getRetinaScaling(),u=this.canvas.upperCanvasEl,h=u.width/l,f=u.height/l,d=h-a,p=f-a,m=u.clientWidth/h,b=u.clientHeight/f;return c=k.util.transformPoint(c,o),(c=k.util.transformPoint(c,this.canvas.viewportTransform)).x*=m,c.y*=b,c.x<0&&(c.x=0),c.x>d&&(c.x=d),c.y<0&&(c.y=0),c.y>p&&(c.y=p),c.x+=this.canvas._offset.left,c.y+=this.canvas._offset.top,{left:c.x+"px",top:c.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text,t=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,t){var r,i,n=this.get2DCursorLocation(e,!0),a=this.get2DCursorLocation(t,!0),s=n.lineIndex,o=n.charIndex,c=a.lineIndex,l=a.charIndex;if(s!==c){if(this.styles[s])for(r=o;r<this._unwrappedTextLines[s].length;r++)delete this.styles[s][r];if(this.styles[c])for(r=l;r<this._unwrappedTextLines[c].length;r++)(i=this.styles[c][r])&&(this.styles[s]||(this.styles[s]={}),this.styles[s][o+r-l]=i);for(r=s+1;r<=c;r++)delete this.styles[r];this.shiftLineStyles(c,s-c)}else if(this.styles[s]){i=this.styles[s];var u,h,f=l-o;for(r=o;r<l;r++)delete i[r];for(h in this.styles[s])(u=parseInt(h,10))>=l&&(i[u-f]=i[h],delete i[h])}},shiftLineStyles:function(e,t){var r=x(this.styles);for(var i in this.styles){var n=parseInt(i,10);n>e&&(this.styles[n+t]=r[n],r[n-t]||delete this.styles[n])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(e,t,r,i){var n,a={},s=!1,o=this._unwrappedTextLines[e].length===t;for(var c in r||(r=1),this.shiftLineStyles(e,r),this.styles[e]&&(n=this.styles[e][0===t?t:t-1]),this.styles[e]){var l=parseInt(c,10);l>=t&&(s=!0,a[l-t]=this.styles[e][c],o&&0===t||delete this.styles[e][c])}var u=!1;for(s&&!o&&(this.styles[e+r]=a,u=!0),u&&r--;r>0;)i&&i[r-1]?this.styles[e+r]={0:x(i[r-1])}:n?this.styles[e+r]={0:x(n)}:delete this.styles[e+r],r--;this._forceClearCache=!0},insertCharStyleObject:function(e,t,r,i){this.styles||(this.styles={});var n=this.styles[e],a=n?x(n):{};for(var s in r||(r=1),a){var o=parseInt(s,10);o>=t&&(n[o+r]=a[o],a[o-r]||delete n[o])}if(this._forceClearCache=!0,i)for(;r--;)Object.keys(i[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+r]=x(i[r]));else if(n)for(var c=n[t?t-1:1];c&&r--;)this.styles[e][t+r]=x(c)},insertNewStyleBlock:function(e,t,r){for(var i=this.get2DCursorLocation(t,!0),n=[0],a=0,s=0;s<e.length;s++)"\n"===e[s]?n[++a]=0:n[a]++;for(n[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,n[0],r),r=r&&r.slice(n[0]+1)),a&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+n[0],a),s=1;s<a;s++)n[s]>0?this.insertCharStyleObject(i.lineIndex+s,0,n[s],r):r&&this.styles[i.lineIndex+s]&&r[0]&&(this.styles[i.lineIndex+s][0]=r[0]),r=r&&r.slice(n[s]+1);n[s]>0&&this.insertCharStyleObject(i.lineIndex+s,0,n[s],r)},setSelectionStartEndWithShift:function(e,t,r){r<=e?(t===e?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=r):r>e&&r<t?"right"===this._selectionDirection?this.selectionEnd=r:this.selectionStart=r:(t===e?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=t),this.selectionEnd=r)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}}),k.util.object.extend(k.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(e){if(this.canvas){this.__newClickTime=+new Date;var t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),this._stopEvent(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))},tripleClickHandler:function(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(e){!this.canvas||!this.editable||e.e.button&&1!==e.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(e.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(e){!this.canvas||!this.editable||e.e.button&&1!==e.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(e){if(this.__isMousedown=!1,!(!this.editable||this.group||e.transform&&e.transform.actionPerformed||e.e.button&&1!==e.e.button)){if(this.canvas){var t=this.canvas._activeObject;if(t&&t!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(e.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(e){var t=this.getSelectionStartFromPointer(e),r=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(r,i,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(e){for(var t,r=this.getLocalPointer(e),i=0,n=0,a=0,s=0,o=0,c=0,l=this._textLines.length;c<l&&a<=r.y;c++)a+=this.getHeightOfLine(c)*this.scaleY,o=c,c>0&&(s+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));n=this._getLineLeftOffset(o)*this.scaleX,t=this._textLines[o],"rtl"===this.direction&&(r.x=this.width*this.scaleX-r.x+n);for(var u=0,h=t.length;u<h&&(i=n,(n+=this.__charBounds[o][u].kernedWidth*this.scaleX)<=r.x);u++)s++;return this._getNewSelectionStartFromOffset(r,i,n,s,h)},_getNewSelectionStartFromOffset:function(e,t,r,i,n){var a=e.x-t,s=r-e.x,o=i+(s>a||s<0?0:1);return this.flipX&&(o=n-o),o>this._text.length&&(o=this._text.length),o}}),k.util.object.extend(k.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=k.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var e=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+e.top+"; left: "+e.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+e.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):k.document.body.appendChild(this.hiddenTextarea),k.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),k.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),k.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),k.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),k.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),k.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),k.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),k.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),k.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(k.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing){var t="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(e){var t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),this.isEditing){var r,i,n,a,s,o=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,c=this._text.length,l=o.length,u=l-c,h=this.selectionStart,f=this.selectionEnd,d=h!==f;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var p=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),m=h>p.selectionStart;d?(r=this._text.slice(h,f),u+=f-h):l<c&&(r=m?this._text.slice(f+u,f):this._text.slice(h,h-u)),i=o.slice(p.selectionEnd-u,p.selectionEnd),r&&r.length&&(i.length&&(n=this.getSelectionStyles(h,h+1,!1),n=i.map((function(){return n[0]}))),d?(a=h,s=f):m?(a=f-r.length,s=f):(a=f,s=f+r.length),this.removeStyleFromTo(a,s)),i.length&&(t&&i.join("")===k.copiedText&&!k.disableStyleCopyPaste&&(n=k.copiedTextStyle),this.insertNewStyleBlock(i,h,n)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(e){this.compositionStart=e.target.selectionStart,this.compositionEnd=e.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(k.copiedText=this.getSelectedText(),k.disableStyleCopyPaste?k.copiedTextStyle=null:k.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(e){return e&&e.clipboardData||k.window.clipboardData},_getWidthBeforeCursor:function(e,t){var r,i=this._getLineLeftOffset(e);return t>0&&(i+=(r=this.__charBounds[e][t-1]).left+r.width),i},getDownCursorOffset:function(e,t){var r=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(r),n=i.lineIndex;if(n===this._textLines.length-1||e.metaKey||34===e.keyCode)return this._text.length-r;var a=i.charIndex,s=this._getWidthBeforeCursor(n,a),o=this._getIndexOnLine(n+1,s);return this._textLines[n].slice(a).length+o+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(e,t){var r=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(r),n=i.lineIndex;if(0===n||e.metaKey||33===e.keyCode)return-r;var a=i.charIndex,s=this._getWidthBeforeCursor(n,a),o=this._getIndexOnLine(n-1,s),c=this._textLines[n].slice(0,a),l=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+o-c.length+(1-l)},_getIndexOnLine:function(e,t){for(var r,i,n=this._textLines[e],a=this._getLineLeftOffset(e),s=0,o=0,c=n.length;o<c;o++)if((a+=r=this.__charBounds[e][o].width)>t){i=!0;var l=a-r,u=a,h=Math.abs(l-t);s=Math.abs(u-t)<h?o:o-1;break}return i||(s=n.length-1),s},moveCursorDown:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)},moveCursorUp:function(e){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",e)},_moveCursorUpOrDown:function(e,t){var r=this["get"+e+"CursorOffset"](t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),0!==r&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(e){var t="left"===this._selectionDirection?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),0!==e},moveCursorWithoutShift:function(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),0!==e},moveCursorLeft:function(e){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",e)},_move:function(e,t,r){var i;if(e.altKey)i=this["findWordBoundary"+r](this[t]);else{if(!e.metaKey&&35!==e.keyCode&&36!==e.keyCode)return this[t]+="Left"===r?-1:1,!0;i=this["findLineBoundary"+r](this[t])}if(void 0!==i&&this[t]!==i)return this[t]=i,!0},_moveLeft:function(e,t){return this._move(e,t,"Left")},_moveRight:function(e,t){return this._move(e,t,"Right")},moveCursorLeftWithoutShift:function(e){var t=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t},moveCursorLeftWithShift:function(e){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(e,"selectionStart")):void 0},moveCursorRight:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)},_moveCursorLeftOrRight:function(e,t){var r="moveCursor"+e+"With";this._currentCursorOpacity=1,t.shiftKey?r+="Shift":r+="outShift",this[r](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(e){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(e,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(e){var t=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t},removeChars:function(e,t){void 0===t&&(t=e+1),this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(e,t,r,i){void 0===i&&(i=r),i>r&&this.removeStyleFromTo(r,i);var n=k.util.string.graphemeSplit(e);this.insertNewStyleBlock(n,r,t),this._text=[].concat(this._text.slice(0,r),n,this._text.slice(i)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var e=k.util.toFixed,t=/  +/g;k.util.object.extend(k.Text.prototype,{_toSVG:function(){var e=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(e.textTop,e.textLeft);return this._wrapSVGTextAndBg(t)},toSVG:function(e){return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(e){var t=this.getSvgTextDecoration(this);return[e.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",t?'text-decoration="'+t+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(e,t){var r,i=[],n=[],a=e;this._setSVGBg(n);for(var s=0,o=this._textLines.length;s<o;s++)r=this._getLineLeftOffset(s),(this.textBackgroundColor||this.styleHas("textBackgroundColor",s))&&this._setSVGTextLineBg(n,s,t+r,a),this._setSVGTextLineText(i,s,t+r,a),a+=this.getHeightOfLine(s);return{textSpans:i,textBgRects:n}},_createTextCharSpan:function(r,i,n,a){var s=r!==r.trim()||r.match(t),o=this.getSvgSpanStyles(i,s),c=o?'style="'+o+'"':"",l=i.deltaY,u="",h=k.Object.NUM_FRACTION_DIGITS;return l&&(u=' dy="'+e(l,h)+'" '),['<tspan x="',e(n,h),'" y="',e(a,h),'" ',u,c,">",k.util.string.escapeXml(r),"</tspan>"].join("")},_setSVGTextLineText:function(e,t,r,i){var n,a,s,o,c,l=this.getHeightOfLine(t),u=-1!==this.textAlign.indexOf("justify"),h="",f=0,d=this._textLines[t];i+=l*(1-this._fontSizeFraction)/this.lineHeight;for(var p=0,m=d.length-1;p<=m;p++)c=p===m||this.charSpacing,h+=d[p],s=this.__charBounds[t][p],0===f?(r+=s.kernedWidth-s.width,f+=s.width):f+=s.kernedWidth,u&&!c&&this._reSpaceAndTab.test(d[p])&&(c=!0),c||(n=n||this.getCompleteStyleDeclaration(t,p),a=this.getCompleteStyleDeclaration(t,p+1),c=k.util.hasStyleChanged(n,a,!0)),c&&(o=this._getStyleDeclaration(t,p)||{},e.push(this._createTextCharSpan(h,o,r,i)),h="",n=a,r+=f,f=0)},_pushTextBgRect:function(t,r,i,n,a,s){var o=k.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(r),' x="',e(i,o),'" y="',e(n,o),'" width="',e(a,o),'" height="',e(s,o),'"></rect>\n')},_setSVGTextLineBg:function(e,t,r,i){for(var n,a,s=this._textLines[t],o=this.getHeightOfLine(t)/this.lineHeight,c=0,l=0,u=this.getValueOfPropertyAt(t,0,"textBackgroundColor"),h=0,f=s.length;h<f;h++)n=this.__charBounds[t][h],(a=this.getValueOfPropertyAt(t,h,"textBackgroundColor"))!==u?(u&&this._pushTextBgRect(e,u,r+l,i,c,o),l=n.left,c=n.width,u=a):c+=n.kernedWidth;a&&this._pushTextBgRect(e,a,r+l,i,c,o)},_getFillAttributes:function(e){var t=e&&"string"==typeof e?new k.Color(e):"";return t&&t.getSource()&&1!==t.getAlpha()?'opacity="'+t.getAlpha()+'" fill="'+t.setAlpha(1).toRgb()+'"':'fill="'+e+'"'},_getSVGLineTopOffset:function(e){for(var t,r=0,i=0;i<e;i++)r+=this.getHeightOfLine(i);return t=this.getHeightOfLine(i),{lineTop:r,offset:(this._fontSizeMult-this._fontSizeFraction)*t/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(e){return k.Object.prototype.getSvgStyles.call(this,e)+" white-space: pre;"}})}(),function(e){var t=e.fabric||(e.fabric={});t.Textbox=t.util.createClass(t.IText,t.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:t.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(e){for(var t=0,r=0,i=0,n={},a=0;a<e.graphemeLines.length;a++)"\n"===e.graphemeText[i]&&a>0?(r=0,i++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&a>0&&(r++,i++),n[a]={line:t,offset:r},i+=e.graphemeLines[a].length,r+=e.graphemeLines[a].length;return n},styleHas:function(e,r){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[r];i&&(r=i.line)}return t.Text.prototype.styleHas.call(this,e,r)},isEmptyStyles:function(e){if(!this.styles)return!0;var t,r,i=0,n=!1,a=this._styleMap[e],s=this._styleMap[e+1];for(var o in a&&(e=a.line,i=a.offset),s&&(n=s.line===e,t=s.offset),r=void 0===e?this.styles:{line:this.styles[e]})for(var c in r[o])if(c>=i&&(!n||c<t))for(var l in r[o][c])return!1;return!0},_getStyleDeclaration:function(e,t){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[e];if(!r)return null;e=r.line,t=r.offset+t}return this.callSuper("_getStyleDeclaration",e,t)},_setStyleDeclaration:function(e,t,r){var i=this._styleMap[e];e=i.line,t=i.offset+t,this.styles[e][t]=r},_deleteStyleDeclaration:function(e,t){var r=this._styleMap[e];e=r.line,t=r.offset+t,delete this.styles[e][t]},_getLineStyle:function(e){var t=this._styleMap[e];return!!this.styles[t.line]},_setLineStyle:function(e){var t=this._styleMap[e];this.styles[t.line]={}},_wrapText:function(e,t){var r,i=[];for(this.isWrapping=!0,r=0;r<e.length;r++)i=i.concat(this._wrapLine(e[r],r,t));return this.isWrapping=!1,i},_measureWord:function(e,t,r){var i,n=0;r=r||0;for(var a=0,s=e.length;a<s;a++){n+=this._getGraphemeBox(e[a],t,a+r,i,true).kernedWidth,i=e[a]}return n},_wrapLine:function(e,r,i,n){var a=0,s=this.splitByGrapheme,o=[],c=[],l=s?t.util.string.graphemeSplit(e):e.split(this._wordJoiners),u="",h=0,f=s?"":" ",d=0,p=0,m=0,b=!0,v=this._getWidthOfCharSpacing();n=n||0;0===l.length&&l.push([]),i-=n;for(var g=0;g<l.length;g++)u=s?l[g]:t.util.string.graphemeSplit(l[g]),d=this._measureWord(u,r,h),h+=u.length,(a+=p+d-v)>i&&!b?(o.push(c),c=[],a=d,b=!0):a+=v,b||s||c.push(f),c=c.concat(u),p=s?0:this._measureWord([f],r,h),h++,b=!1,d>m&&(m=d);return g&&o.push(c),m+n>this.dynamicMinWidth&&(this.dynamicMinWidth=m-v+n),o},isEndOfWrapping:function(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line},missingNewlineOffset:function(e){return this.splitByGrapheme?this.isEndOfWrapping(e)?1:0:1},_splitTextIntoLines:function(e){for(var r=t.Text.prototype._splitTextIntoLines.call(this,e),i=this._wrapText(r.lines,this.width),n=new Array(i.length),a=0;a<i.length;a++)n[a]=i[a].join("");return r.lines=n,r.graphemeLines=i,r},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var e={};for(var t in this._styleMap)this._textLines[t]&&(e[this._styleMap[t].line]=1);for(var t in this.styles)e[t]||delete this.styles[t]},toObject:function(e){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(e))}}),t.Textbox.fromObject=function(e,r){var i=t.util.stylesFromArray(e.styles,e.text),n=Object.assign({},e,{styles:i});return t.Object._fromObject("Textbox",n,r,"text")}}(e),function(){var e=k.controlsUtils,t=e.scaleSkewCursorStyleHandler,r=e.scaleCursorStyleHandler,i=e.scalingEqually,n=e.scalingYOrSkewingX,a=e.scalingXOrSkewingY,s=e.scaleOrSkewActionName,o=k.Object.prototype.controls;if(o.ml=new k.Control({x:-.5,y:0,cursorStyleHandler:t,actionHandler:a,getActionName:s}),o.mr=new k.Control({x:.5,y:0,cursorStyleHandler:t,actionHandler:a,getActionName:s}),o.mb=new k.Control({x:0,y:.5,cursorStyleHandler:t,actionHandler:n,getActionName:s}),o.mt=new k.Control({x:0,y:-.5,cursorStyleHandler:t,actionHandler:n,getActionName:s}),o.tl=new k.Control({x:-.5,y:-.5,cursorStyleHandler:r,actionHandler:i}),o.tr=new k.Control({x:.5,y:-.5,cursorStyleHandler:r,actionHandler:i}),o.bl=new k.Control({x:-.5,y:.5,cursorStyleHandler:r,actionHandler:i}),o.br=new k.Control({x:.5,y:.5,cursorStyleHandler:r,actionHandler:i}),o.mtr=new k.Control({x:0,y:-.5,actionHandler:e.rotationWithSnapping,cursorStyleHandler:e.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),k.Textbox){var c=k.Textbox.prototype.controls={};c.mtr=o.mtr,c.tr=o.tr,c.br=o.br,c.tl=o.tl,c.bl=o.bl,c.mt=o.mt,c.mb=o.mb,c.mr=new k.Control({x:.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"}),c.ml=new k.Control({x:-.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"})}}()}(kf);var Uf=function(){function e(t,r){f(this,e),g(this,"fabric",void 0),g(this,"that",void 0),this.fabric=t,this.that=r,this.init()}return p(e,[{key:"init",value:function(){var e=this,t=document.createElement("img");t.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E";var r=document.createElement("img");r.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='iso-8859-1'%3F%3E%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 55.699 55.699' width='100px' height='100px' xml:space='preserve'%3E%3Cpath style='fill:%23010002;' d='M51.51,18.001c-0.006-0.085-0.022-0.167-0.05-0.248c-0.012-0.034-0.02-0.067-0.035-0.1 c-0.049-0.106-0.109-0.206-0.194-0.291v-0.001l0,0c0,0-0.001-0.001-0.001-0.002L34.161,0.293c-0.086-0.087-0.188-0.148-0.295-0.197 c-0.027-0.013-0.057-0.02-0.086-0.03c-0.086-0.029-0.174-0.048-0.265-0.053C33.494,0.011,33.475,0,33.453,0H22.177 c-3.678,0-6.669,2.992-6.669,6.67v1.674h-4.663c-3.678,0-6.67,2.992-6.67,6.67V49.03c0,3.678,2.992,6.669,6.67,6.669h22.677 c3.677,0,6.669-2.991,6.669-6.669v-1.675h4.664c3.678,0,6.669-2.991,6.669-6.669V18.069C51.524,18.045,51.512,18.025,51.51,18.001z M34.454,3.414l13.655,13.655h-8.985c-2.575,0-4.67-2.095-4.67-4.67V3.414z M38.191,49.029c0,2.574-2.095,4.669-4.669,4.669H10.845 c-2.575,0-4.67-2.095-4.67-4.669V15.014c0-2.575,2.095-4.67,4.67-4.67h5.663h4.614v10.399c0,3.678,2.991,6.669,6.668,6.669h10.4 v18.942L38.191,49.029L38.191,49.029z M36.777,25.412h-8.986c-2.574,0-4.668-2.094-4.668-4.669v-8.985L36.777,25.412z M44.855,45.355h-4.664V26.412c0-0.023-0.012-0.044-0.014-0.067c-0.006-0.085-0.021-0.167-0.049-0.249 c-0.012-0.033-0.021-0.066-0.036-0.1c-0.048-0.105-0.109-0.205-0.194-0.29l0,0l0,0c0-0.001-0.001-0.002-0.001-0.002L22.829,8.637 c-0.087-0.086-0.188-0.147-0.295-0.196c-0.029-0.013-0.058-0.021-0.088-0.031c-0.086-0.03-0.172-0.048-0.263-0.053 c-0.021-0.002-0.04-0.013-0.062-0.013h-4.614V6.67c0-2.575,2.095-4.67,4.669-4.67h10.277v10.4c0,3.678,2.992,6.67,6.67,6.67h10.399 v21.616C49.524,43.26,47.429,45.355,44.855,45.355z'/%3E%3C/svg%3E%0A",this.fabric.Object.prototype.controls.deleteControl=new this.fabric.Control({x:.5,y:-.5,offsetY:-16,offsetX:16,cursorStyle:"pointer",mouseUpHandler:function(){return e.deleteObject(e.that)},render:this.renderIcon(t,24),sizeX:24,sizeY:24}),this.fabric.Object.prototype.controls.clone=new this.fabric.Control({x:-.5,y:-.5,offsetY:-16,offsetX:-16,cursorStyle:"pointer",mouseUpHandler:function(){return e.cloneObject(e.that)},render:this.renderIcon(r,24),sizeX:24,sizeY:24})}},{key:"deleteObject",value:function(e){var t,r=e.canvas.getActiveObjects();return e.canvas.discardActiveObject(),(t=e.canvas).remove.apply(t,h(r)),e.recordOperate.apply(e,h(r)),e.canvas.requestRenderAll(),!0}},{key:"cloneObject",value:function(e){return e.copy(),e.paste(),!0}},{key:"renderIcon",value:function(e,t){var r=this;return function(i,n,a,s,o){i.save(),i.translate(n,a),i.rotate(r.fabric.util.degreesToRadians(o.angle)),i.drawImage(e,-t/2,-t/2,t,t),i.restore()}}}]),e}(),Ef={exports:{}};!function(e,t){if((void 0===a||!a)&&"undefined"!=typeof self)var a=self;e.exports=function(){function e(t,r,i){function n(s,o){if(!r[s]){if(!t[s]){var c="function"==typeof ye&&ye;if(!o&&c)return c(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[s]={exports:{}};t[s][0].call(u.exports,(function(e){return n(t[s][1][e]||e)}),u,u.exports,e,t,r,i)}return r[s].exports}for(var a="function"==typeof ye&&ye,s=0;s<i.length;s++)n(i[s]);return n}return e}()({1:[function(e,t,r){function i(e){if(Array.isArray(e))return e}t.exports=i},{}],2:[function(e,t,r){function i(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}t.exports=i},{}],3:[function(e,t,r){function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}t.exports=i},{}],4:[function(e,t,r){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.exports=i},{}],5:[function(e,t,r){var i=e("./setPrototypeOf");function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function a(e,r,s){return n()?t.exports=a=Reflect.construct:t.exports=a=function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&i(a,r.prototype),a},a.apply(null,arguments)}t.exports=a},{"./setPrototypeOf":18}],6:[function(e,t,r){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}t.exports=n},{}],7:[function(e,t,r){function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.exports=i},{}],8:[function(e,t,r){function i(){return t.exports=i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},i.apply(this,arguments)}t.exports=i},{}],9:[function(e,t,r){function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}t.exports=i},{}],10:[function(e,t,r){var i=e("./setPrototypeOf");function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}t.exports=n},{"./setPrototypeOf":18}],11:[function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}t.exports=i},{}],12:[function(e,t,r){var i=e("../helpers/typeof");function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var o=a?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=e[s]}return r.default=e,t&&t.set(e,r),r}t.exports=a},{"../helpers/typeof":21}],13:[function(e,t,r){function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}t.exports=i},{}],14:[function(e,t,r){function i(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(c){n=!0,a=c}finally{try{i||null==o.return||o.return()}finally{if(n)throw a}}return r}}t.exports=i},{}],15:[function(e,t,r){function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}t.exports=i},{}],16:[function(e,t,r){function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}t.exports=i},{}],17:[function(e,t,r){var i=e("../helpers/typeof"),n=e("./assertThisInitialized");function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?n(e):t}t.exports=a},{"../helpers/typeof":21,"./assertThisInitialized":3}],18:[function(e,t,r){function i(e,r){return t.exports=i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,r)}t.exports=i},{}],19:[function(e,t,r){var i=e("./arrayWithHoles"),n=e("./iterableToArrayLimit"),a=e("./nonIterableRest");function s(e,t){return i(e)||n(e,t)||a()}t.exports=s},{"./arrayWithHoles":1,"./iterableToArrayLimit":14,"./nonIterableRest":15}],20:[function(e,t,r){var i=e("./arrayWithoutHoles"),n=e("./iterableToArray"),a=e("./nonIterableSpread");function s(e){return i(e)||n(e)||a()}t.exports=s},{"./arrayWithoutHoles":2,"./iterableToArray":13,"./nonIterableSpread":16}],21:[function(e,t,r){function i(e){return i="function"==typeof Symbol&&"symbol"===_(Symbol.iterator)?function(e){return _(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_(e)},i(e)}function n(e){return"function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?t.exports=n=function(e){return i(e)}:t.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)},n(e)}t.exports=n},{}],22:[function(e,t,r){t.exports=e("regenerator-runtime")},{"regenerator-runtime":153}],23:[function(e,t,r){var i=e("./src/converter");function n(e,t){var r=new i(e,t);return function(e){return r.convert(e)}}n.BIN="01",n.OCT="01234567",n.DEC="0123456789",n.HEX="0123456789abcdef",t.exports=n},{"./src/converter":24}],24:[function(e,t,r){function i(e,t){if(!(e&&t&&e.length&&t.length))throw new Error("Bad alphabet");this.srcAlphabet=e,this.dstAlphabet=t}i.prototype.convert=function(e){var t,r,i,n={},a=this.srcAlphabet.length,s=this.dstAlphabet.length,o=e.length,c="string"==typeof e?"":[];if(!this.isValid(e))throw new Error('Number "'+e+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return e;for(t=0;t<o;t++)n[t]=this.srcAlphabet.indexOf(e[t]);do{for(r=0,i=0,t=0;t<o;t++)(r=r*a+n[t])>=s?(n[i++]=parseInt(r/s,10),r%=s):i>0&&(n[i++]=0);o=i,c=this.dstAlphabet.slice(r,r+1).concat(c)}while(0!==i);return c},i.prototype.isValid=function(e){for(var t=0;t<e.length;++t)if(-1===this.srcAlphabet.indexOf(e[t]))return!1;return!0},t.exports=i},{}],25:[function(e,t,r){(function(r){var i=e("object-assign");
/*!
      	 * The buffer module from node.js, for the browser.
      	 *
      	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
      	 * @license  MIT
      	 */function n(e,t){if(e===t)return 0;for(var r=e.length,i=t.length,n=0,a=Math.min(r,i);n<a;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0}function a(e){return r.Buffer&&"function"==typeof r.Buffer.isBuffer?r.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var s=e("util/"),o=Object.prototype.hasOwnProperty,c=Array.prototype.slice,l="foo"===function(){}.name;function u(e){return Object.prototype.toString.call(e)}function h(e){return!a(e)&&"function"==typeof r.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}var f=t.exports=y,d=/\s*function\s+([^\(\s]*)\s*/;function p(e){if(s.isFunction(e)){if(l)return e.name;var t=e.toString().match(d);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function b(e){if(l||!s.isFunction(e))return s.inspect(e);var t=p(e);return"[Function"+(t?": "+t:"")+"]"}function v(e){return m(b(e.actual),128)+" "+e.operator+" "+m(b(e.expected),128)}function g(e,t,r,i,n){throw new f.AssertionError({message:r,actual:e,expected:t,operator:i,stackStartFunction:n})}function y(e,t){e||g(e,!0,t,"==",f.ok)}function w(e,t,r,i){if(e===t)return!0;if(a(e)&&a(t))return 0===n(e,t);if(s.isDate(e)&&s.isDate(t))return e.getTime()===t.getTime();if(s.isRegExp(e)&&s.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"===_(e)||null!==t&&"object"===_(t)){if(h(e)&&h(t)&&u(e)===u(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===n(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(a(e)!==a(t))return!1;var o=(i=i||{actual:[],expected:[]}).actual.indexOf(e);return-1!==o&&o===i.expected.indexOf(t)||(i.actual.push(e),i.expected.push(t),k(e,t,r,i))}return r?e===t:e==t}function x(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function k(e,t,r,i){if(null==e||null==t)return!1;if(s.isPrimitive(e)||s.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var n=x(e),a=x(t);if(n&&!a||!n&&a)return!1;if(n)return w(e=c.call(e),t=c.call(t),r);var o,l,u=M(e),h=M(t);if(u.length!==h.length)return!1;for(u.sort(),h.sort(),l=u.length-1;l>=0;l--)if(u[l]!==h[l])return!1;for(l=u.length-1;l>=0;l--)if(!w(e[o=u[l]],t[o],r,i))return!1;return!0}function S(e,t,r){w(e,t,!0)&&g(e,t,r,"notDeepStrictEqual",S)}function C(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(r){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function U(e){var t;try{e()}catch(r){t=r}return t}function E(e,t,r,i){var n;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(i=r,r=null),n=U(t),i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:"."),e&&!n&&g(n,r,"Missing expected exception"+i);var a="string"==typeof i,o=!e&&n&&!r;if((!e&&s.isError(n)&&a&&C(n,r)||o)&&g(n,r,"Got unwanted exception"+i),e&&n&&r&&!C(n,r)||!e&&n)throw n}function T(e,t){e||g(e,!0,t,"==",T)}f.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=v(this),this.generatedMessage=!0);var t=e.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var i=r.stack,n=p(t),a=i.indexOf("\n"+n);if(a>=0){var s=i.indexOf("\n",a+1);i=i.substring(s+1)}this.stack=i}}},s.inherits(f.AssertionError,Error),f.fail=g,f.ok=y,f.equal=function(e,t,r){e!=t&&g(e,t,r,"==",f.equal)},f.notEqual=function(e,t,r){e==t&&g(e,t,r,"!=",f.notEqual)},f.deepEqual=function(e,t,r){w(e,t,!1)||g(e,t,r,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(e,t,r){w(e,t,!0)||g(e,t,r,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(e,t,r){w(e,t,!1)&&g(e,t,r,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=S,f.strictEqual=function(e,t,r){e!==t&&g(e,t,r,"===",f.strictEqual)},f.notStrictEqual=function(e,t,r){e===t&&g(e,t,r,"!==",f.notStrictEqual)},f.throws=function(e,t,r){E(!0,e,t,r)},f.doesNotThrow=function(e,t,r){E(!1,e,t,r)},f.ifError=function(e){if(e)throw e},f.strict=i(T,f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var M=Object.keys||function(e){var t=[];for(var r in e)o.call(e,r)&&t.push(r);return t}}).call(this,void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{"object-assign":84,"util/":28}],26:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],27:[function(e,t,r){t.exports=function(e){return e&&"object"===_(e)&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],28:[function(e,t,r){(function(t,i){var n=/%[sdj%]/g;r.format=function(e){if(!k(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(o(arguments[r]));return t.join(" ")}r=1;for(var i=arguments,a=i.length,s=String(e).replace(n,(function(e){if("%%"===e)return"%";if(r>=a)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return e}})),c=i[r];r<a;c=i[++r])y(c)||!E(c)?s+=" "+c:s+=" "+o(c);return s},r.deprecate=function(e,n){if(C(i.process))return function(){return r.deprecate(e,n).apply(this,arguments)};if(!0===t.noDeprecation)return e;var a=!1;function s(){if(!a){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),a=!0}return e.apply(this,arguments)}return s};var a,s={};function o(e,t){var i={seen:[],stylize:l};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),g(t)?i.showHidden=t:t&&r._extend(i,t),C(i.showHidden)&&(i.showHidden=!1),C(i.depth)&&(i.depth=2),C(i.colors)&&(i.colors=!1),C(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=c),h(i,e,i.depth)}function c(e,t){var r=o.styles[t];return r?"["+o.colors[r][0]+"m"+e+"["+o.colors[r][1]+"m":e}function l(e,t){return e}function u(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}function h(e,t,i){if(e.customInspect&&t&&O(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(i,e);return k(n)||(n=h(e,n,i)),n}var a=f(e,t);if(a)return a;var s=Object.keys(t),o=u(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),M(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return d(t);if(0===s.length){if(O(t)){var c=t.name?": "+t.name:"";return e.stylize("[Function"+c+"]","special")}if(U(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(T(t))return e.stylize(Date.prototype.toString.call(t),"date");if(M(t))return d(t)}var l,g="",y=!1,_=["{","}"];return v(t)&&(y=!0,_=["[","]"]),O(t)&&(g=" [Function"+(t.name?": "+t.name:"")+"]"),U(t)&&(g=" "+RegExp.prototype.toString.call(t)),T(t)&&(g=" "+Date.prototype.toUTCString.call(t)),M(t)&&(g=" "+d(t)),0!==s.length||y&&0!=t.length?i<0?U(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),l=y?p(e,t,i,o,s):s.map((function(r){return m(e,t,i,o,r,y)})),e.seen.pop(),b(l,g,_)):_[0]+g+_[1]}function f(e,t){if(C(t))return e.stylize("undefined","undefined");if(k(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return x(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,i,n){for(var a=[],s=0,o=t.length;s<o;++s)R(t,String(s))?a.push(m(e,t,r,i,String(s),!0)):a.push("");return n.forEach((function(n){n.match(/^\d+$/)||a.push(m(e,t,r,i,n,!0))})),a}function m(e,t,r,i,n,a){var s,o,c;if((c=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]}).get?o=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(o=e.stylize("[Setter]","special")),R(i,n)||(s="["+n+"]"),o||(e.seen.indexOf(c.value)<0?(o=y(r)?h(e,c.value,null):h(e,c.value,r-1)).indexOf("\n")>-1&&(o=a?o.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+o.split("\n").map((function(e){return"   "+e})).join("\n")):o=e.stylize("[Circular]","special")),C(s)){if(a&&n.match(/^\d+$/))return o;(s=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+o}function b(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function v(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function y(e){return null===e}function w(e){return null==e}function x(e){return"number"==typeof e}function k(e){return"string"==typeof e}function S(e){return"symbol"===_(e)}function C(e){return void 0===e}function U(e){return E(e)&&"[object RegExp]"===A(e)}function E(e){return"object"===_(e)&&null!==e}function T(e){return E(e)&&"[object Date]"===A(e)}function M(e){return E(e)&&("[object Error]"===A(e)||e instanceof Error)}function O(e){return"function"==typeof e}function P(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===_(e)||void 0===e}function A(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}r.debuglog=function(e){if(C(a)&&(a={TERM_PROGRAM:"vscode",NODE:"/usr/local/bin/node",INIT_CWD:"/Users/mac/workplace/h5/laser-cut-new/packages/laser-mobile",TERM:"xterm-256color",SHELL:"/bin/zsh",npm_config_metrics_registry:"https://registry.npm.taobao.org/",TMPDIR:"/var/folders/8h/6kht9rs15kd0_jl_jwkk7kfr0000gn/T/",npm_config_global_prefix:"/usr/local",TERM_PROGRAM_VERSION:"1.81.1",ZDOTDIR:"/Users/mac",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_registry:"https://registry.npm.taobao.org/",npm_config_local_prefix:"/Users/mac/workplace/h5/laser-cut-new",FLUTTER_GIT_URL:"https://gitee.com/mirrors/Flutter.git",USER:"mac",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/usr/local/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.2h59lhNQEm/Listeners",PUB_HOSTED_URL:"https://pub.flutter-io.cn",__CF_USER_TEXT_ENCODING:"0x1F5:0x19:0x34",npm_execpath:"/usr/local/lib/node_modules/npm/bin/npm-cli.js",PATH:"/Users/mac/workplace/h5/laser-cut-new/packages/laser-mobile/node_modules/.bin:/Users/mac/workplace/h5/laser-cut-new/packages/node_modules/.bin:/Users/mac/workplace/h5/laser-cut-new/node_modules/.bin:/Users/mac/workplace/h5/node_modules/.bin:/Users/mac/workplace/node_modules/.bin:/Users/mac/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/usr/local/opt/ruby/bin:/usr/local/opt/ruby/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/Apple/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin:/Users/mac/fvm/default/bin:/Users/mac/fvm/default/bin/cache/dart-sdk/bin:/Users/mac/.pub-cache/bin",npm_package_json:"/Users/mac/workplace/h5/laser-cut-new/packages/laser-mobile/package.json",_:"/usr/local/bin/vite",LaunchInstanceID:"2322B6CC-2171-4687-873A-5D3DD10A757F",npm_config_userconfig:"/Users/mac/.npmrc",npm_config_init_module:"/Users/mac/.npm-init.js",USER_ZDOTDIR:"/Users/mac",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/mac/workplace/h5/laser-cut-new/packages/laser-mobile",FLUTTER_STORAGE_BASE_URL:"https://storage.flutter-io.cn",VSCODE_NONCE:"7f738938-e670-42d6-9894-a8cf9ca0ea8a",npm_lifecycle_event:"build",EDITOR:"vi",FVM_GIT_CACHE:"https://gitee.com/mirrors/Flutter.git",npm_package_name:"laser-mobile",LANG:"zh_CN.UTF-8",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",XPC_FLAGS:"0x0",npm_config_electron_mirror:"https://npm.taobao.org/mirrors/electron/",npm_config_node_gyp:"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.04",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",SHLVL:"2",HOME:"/Users/mac",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",npm_config_cache:"/Users/mac/.npm",LOGNAME:"mac",npm_lifecycle_script:"vite build --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/8h/6kht9rs15kd0_jl_jwkk7kfr0000gn/T/vscode-git-667ad5f9c2.sock",npm_config_user_agent:"npm/8.19.2 node/v16.18.1 darwin x64 workspaces/true",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/Frameworks/Code Helper (Plugin).app/Contents/MacOS/Code Helper (Plugin)",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",SECURITYSESSIONID:"186a3",npm_node_execpath:"/usr/local/bin/node",npm_config_prefix:"/usr/local",COLORTERM:"truecolor",NODE_ENV:"production"}.NODE_DEBUG||""),e=e.toUpperCase(),!s[e])if(new RegExp("\\b"+e+"\\b","i").test(a)){var i=t.pid;s[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,i,t)}}else s[e]=function(){};return s[e]},r.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=v,r.isBoolean=g,r.isNull=y,r.isNullOrUndefined=w,r.isNumber=x,r.isString=k,r.isSymbol=S,r.isUndefined=C,r.isRegExp=U,r.isObject=E,r.isDate=T,r.isError=M,r.isFunction=O,r.isPrimitive=P,r.isBuffer=e("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function j(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":");return[e.getDate(),L[e.getMonth()],t].join(" ")}function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.log=function(){console.log("%s - %s",j(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!E(t))return e;for(var r=Object.keys(t),i=r.length;i--;)e[r[i]]=t[r[i]];return e}}).call(this,e("_process"),void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{"./support/isBuffer":27,_process:133,inherits:26}],29:[function(e,t,r){r.byteLength=u,r.toByteArray=f,r.fromByteArray=m;for(var i=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,c=s.length;o<c;++o)i[o]=s[o],n[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e){var t=l(e),r=t[0],i=t[1];return 3*(r+i)/4-i}function h(e,t,r){return 3*(t+r)/4-r}function f(e){var t,r,i=l(e),s=i[0],o=i[1],c=new a(h(e,s,o)),u=0,f=o>0?s-4:s;for(r=0;r<f;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===o&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===o&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c}function d(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function p(e,t,r){for(var i,n=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),n.push(d(i));return n.join("")}function m(e){for(var t,r=e.length,n=r%3,a=[],s=16383,o=0,c=r-n;o<c;o+=s)a.push(p(e,o,o+s>c?c:o+s));return 1===n?(t=e[r-1],a.push(i[t>>2]+i[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],a.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},{}],30:[function(e,t,r){var i=e("./lib/encoder"),n=e("./lib/decoder");t.exports={encode:i,decode:n}},{"./lib/decoder":31,"./lib/encoder":32}],31:[function(e,t,r){(function(e){function r(e,t){if(this.pos=0,this.buffer=e,this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),"BM"!=this.flag)throw new Error("Invalid BMP File");this.parseHeader(),this.parseRGBA()}r.prototype.parseHeader=function(){if(this.fileSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.reserved=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.offset=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.headerSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.width=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.height=this.buffer.readInt32LE(this.pos),this.pos+=4,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compress=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.rawSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.hr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.vr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.colors=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.importantColors=this.buffer.readUInt32LE(this.pos),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),n=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++);this.palette[t]={red:n,green:i,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},r.prototype.parseRGBA=function(){var t="bit"+this.bitPP,r=this.width*this.height*4;this.data=new e(r),this[t]()},r.prototype.bit1=function(){var e=Math.ceil(this.width/8),t=e%4,r=this.height>=0?this.height-1:-this.height;for(r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,n=0;n<e;n++)for(var a=this.buffer.readUInt8(this.pos++),s=i*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var c=this.palette[a>>7-o&1];this.data[s+4*o]=0,this.data[s+4*o+1]=c.blue,this.data[s+4*o+2]=c.green,this.data[s+4*o+3]=c.red}0!=t&&(this.pos+=4-t)}},r.prototype.bit4=function(){if(2==this.compress){this.data.fill(255);for(var e=0,t=this.bottom_up?this.height-1:0,r=!1;e<this.data.length;){var i=this.buffer.readUInt8(this.pos++),n=this.buffer.readUInt8(this.pos++);if(0==i){if(0==n){this.bottom_up?t--:t++,e=t*this.width*4,r=!1;continue}if(1==n)break;if(2==n){var a=this.buffer.readUInt8(this.pos++),s=this.buffer.readUInt8(this.pos++);this.bottom_up?t-=s:t+=s,e+=s*this.width*4+4*a}else{for(var o=this.buffer.readUInt8(this.pos++),c=0;c<n;c++)r?m.call(this,15&o):m.call(this,(240&o)>>4),1&c&&c+1<n&&(o=this.buffer.readUInt8(this.pos++)),r=!r;1==(n+1>>1&1)&&this.pos++}}else for(c=0;c<i;c++)r?m.call(this,15&n):m.call(this,(240&n)>>4),r=!r}function m(t){var r=this.palette[t];this.data[e]=0,this.data[e+1]=r.blue,this.data[e+2]=r.green,this.data[e+3]=r.red,e+=4}}else{var l=Math.ceil(this.width/2),u=l%4;for(s=this.height-1;s>=0;s--){var h=this.bottom_up?s:this.height-1-s;for(a=0;a<l;a++){n=this.buffer.readUInt8(this.pos++),e=h*this.width*4+2*a*4;var f=n>>4,d=15&n,p=this.palette[f];if(this.data[e]=0,this.data[e+1]=p.blue,this.data[e+2]=p.green,this.data[e+3]=p.red,2*a+1>=this.width)break;p=this.palette[d],this.data[e+4]=0,this.data[e+4+1]=p.blue,this.data[e+4+2]=p.green,this.data[e+4+3]=p.red}0!=u&&(this.pos+=4-u)}}},r.prototype.bit8=function(){if(1==this.compress){this.data.fill(255);for(var e=0,t=this.bottom_up?this.height-1:0;e<this.data.length;){var r=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++);if(0==r){if(0==i){this.bottom_up?t--:t++,e=t*this.width*4;continue}if(1==i)break;if(2==i){var n=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++);this.bottom_up?t-=a:t+=a,e+=a*this.width*4+4*n}else{for(var s=0;s<i;s++){var o=this.buffer.readUInt8(this.pos++);h.call(this,o)}!0&i&&this.pos++}}else for(s=0;s<r;s++)h.call(this,i)}function h(t){var r=this.palette[t];this.data[e]=0,this.data[e+1]=r.blue,this.data[e+2]=r.green,this.data[e+3]=r.red,e+=4}}else{var c=this.width%4;for(a=this.height-1;a>=0;a--){var l=this.bottom_up?a:this.height-1-a;for(n=0;n<this.width;n++)if(i=this.buffer.readUInt8(this.pos++),e=l*this.width*4+4*n,i<this.palette.length){var u=this.palette[i];this.data[e]=0,this.data[e+1]=u.blue,this.data[e+2]=u.green,this.data[e+3]=u.red}else this.data[e]=0,this.data[e+1]=255,this.data[e+2]=255,this.data[e+3]=255;0!=c&&(this.pos+=4-c)}}},r.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var a=this.buffer.readUInt16LE(this.pos);this.pos+=2;var s=(a&t)/t*255|0,o=(a>>5&t)/t*255|0,c=(a>>10&t)/t*255|0,l=a>>15?255:0,u=i*this.width*4+4*n;this.data[u]=l,this.data[u+1]=s,this.data[u+2]=o,this.data[u+3]=c}this.pos+=e}},r.prototype.bit16=function(){var e=this.width%2*2;this.maskRed=31744,this.maskGreen=992,this.maskBlue=31,this.mask0=0,3==this.compress&&(this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4);for(var t=[0,0,0],r=0;r<16;r++)this.maskRed>>r&1&&t[0]++,this.maskGreen>>r&1&&t[1]++,this.maskBlue>>r&1&&t[2]++;t[1]+=t[0],t[2]+=t[1],t[0]=8-t[0],t[1]-=8,t[2]-=8;for(var i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,a=0;a<this.width;a++){var s=this.buffer.readUInt16LE(this.pos);this.pos+=2;var o=(s&this.maskBlue)<<t[0],c=(s&this.maskGreen)>>t[1],l=(s&this.maskRed)>>t[2],u=n*this.width*4+4*a;this.data[u]=0,this.data[u+1]=o,this.data[u+2]=c,this.data[u+3]=l}this.pos+=e}},r.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.buffer.readUInt8(this.pos++),n=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),s=t*this.width*4+4*r;this.data[s]=0,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=a}this.pos+=this.width%4}},r.prototype.bit32=function(){if(3==this.compress){this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4;for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.buffer.readUInt8(this.pos++),n=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),s=this.buffer.readUInt8(this.pos++),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=s}}else for(e=this.height-1;e>=0;e--)for(t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++)n=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),s=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),o=t*this.width*4+4*r,this.data[o]=i,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=s},r.prototype.getData=function(){return this.data},t.exports=function(e){return new r(e)}}).call(this,e("buffer").Buffer)},{buffer:48}],32:[function(e,t,r){(function(e){function r(e){this.buffer=e.data,this.width=e.width,this.height=e.height,this.extraBytes=this.width%4,this.rgbSize=this.height*(3*this.width+this.extraBytes),this.headerInfoSize=40,this.data=[],this.flag="BM",this.reserved=0,this.offset=54,this.fileSize=this.rgbSize+this.offset,this.planes=1,this.bitPP=24,this.compress=0,this.hr=0,this.vr=0,this.colors=0,this.importantColors=0}r.prototype.encode=function(){var t=new e(this.offset+this.rgbSize);this.pos=0,t.write(this.flag,this.pos,2),this.pos+=2,t.writeUInt32LE(this.fileSize,this.pos),this.pos+=4,t.writeUInt32LE(this.reserved,this.pos),this.pos+=4,t.writeUInt32LE(this.offset,this.pos),this.pos+=4,t.writeUInt32LE(this.headerInfoSize,this.pos),this.pos+=4,t.writeUInt32LE(this.width,this.pos),this.pos+=4,t.writeInt32LE(-this.height,this.pos),this.pos+=4,t.writeUInt16LE(this.planes,this.pos),this.pos+=2,t.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,t.writeUInt32LE(this.compress,this.pos),this.pos+=4,t.writeUInt32LE(this.rgbSize,this.pos),this.pos+=4,t.writeUInt32LE(this.hr,this.pos),this.pos+=4,t.writeUInt32LE(this.vr,this.pos),this.pos+=4,t.writeUInt32LE(this.colors,this.pos),this.pos+=4,t.writeUInt32LE(this.importantColors,this.pos),this.pos+=4;for(var r=0,i=3*this.width+this.extraBytes,n=0;n<this.height;n++){for(var a=0;a<this.width;a++){var s=this.pos+n*i+3*a;r++,t[s]=this.buffer[r++],t[s+1]=this.buffer[r++],t[s+2]=this.buffer[r++]}if(this.extraBytes>0){var o=this.pos+n*i+3*this.width;t.fill(0,o,o+this.extraBytes)}}return t},t.exports=function(e,t){return{data:new r(e).encode(),width:e.width,height:e.height}}}).call(this,e("buffer").Buffer)},{buffer:48}],33:[function(e,t,r){},{}],34:[function(e,t,r){(function(t,i){var n=e("assert"),a=e("pako/lib/zlib/zstream"),s=e("pako/lib/zlib/deflate.js"),o=e("pako/lib/zlib/inflate.js"),c=e("pako/lib/zlib/constants");for(var l in c)r[l]=c[l];r.NONE=0,r.DEFLATE=1,r.INFLATE=2,r.GZIP=3,r.GUNZIP=4,r.DEFLATERAW=5,r.INFLATERAW=6,r.UNZIP=7;var u=31,h=139;function f(e){if("number"!=typeof e||e<r.DEFLATE||e>r.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=e,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}f.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,n(this.init_done,"close before init"),n(this.mode<=r.UNZIP),this.mode===r.DEFLATE||this.mode===r.GZIP||this.mode===r.DEFLATERAW?s.deflateEnd(this.strm):this.mode!==r.INFLATE&&this.mode!==r.GUNZIP&&this.mode!==r.INFLATERAW&&this.mode!==r.UNZIP||o.inflateEnd(this.strm),this.mode=r.NONE,this.dictionary=null)},f.prototype.write=function(e,t,r,i,n,a,s){return this._write(!0,e,t,r,i,n,a,s)},f.prototype.writeSync=function(e,t,r,i,n,a,s){return this._write(!1,e,t,r,i,n,a,s)},f.prototype._write=function(e,a,s,o,c,l,u,h){if(n.equal(arguments.length,8),n(this.init_done,"write before init"),n(this.mode!==r.NONE,"already finalized"),n.equal(!1,this.write_in_progress,"write already in progress"),n.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,n.equal(!1,void 0===a,"must provide flush value"),this.write_in_progress=!0,a!==r.Z_NO_FLUSH&&a!==r.Z_PARTIAL_FLUSH&&a!==r.Z_SYNC_FLUSH&&a!==r.Z_FULL_FLUSH&&a!==r.Z_FINISH&&a!==r.Z_BLOCK)throw new Error("Invalid flush value");if(null==s&&(s=i.alloc(0),c=0,o=0),this.strm.avail_in=c,this.strm.input=s,this.strm.next_in=o,this.strm.avail_out=h,this.strm.output=l,this.strm.next_out=u,this.flush=a,!e)return this._process(),this._checkError()?this._afterSync():void 0;var f=this;return t.nextTick((function(){f._process(),f._after()})),this},f.prototype._afterSync=function(){var e=this.strm.avail_out,t=this.strm.avail_in;return this.write_in_progress=!1,[t,e]},f.prototype._process=function(){var e=null;switch(this.mode){case r.DEFLATE:case r.GZIP:case r.DEFLATERAW:this.err=s.deflate(this.strm,this.flush);break;case r.UNZIP:switch(this.strm.avail_in>0&&(e=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===e)break;if(this.strm.input[e]!==u){this.mode=r.INFLATE;break}if(this.gzip_id_bytes_read=1,e++,1===this.strm.avail_in)break;case 1:if(null===e)break;this.strm.input[e]===h?(this.gzip_id_bytes_read=2,this.mode=r.GUNZIP):this.mode=r.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case r.INFLATE:case r.GUNZIP:case r.INFLATERAW:for(this.err=o.inflate(this.strm,this.flush),this.err===r.Z_NEED_DICT&&this.dictionary&&(this.err=o.inflateSetDictionary(this.strm,this.dictionary),this.err===r.Z_OK?this.err=o.inflate(this.strm,this.flush):this.err===r.Z_DATA_ERROR&&(this.err=r.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===r.GUNZIP&&this.err===r.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=o.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},f.prototype._checkError=function(){switch(this.err){case r.Z_OK:case r.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===r.Z_FINISH)return this._error("unexpected end of file"),!1;break;case r.Z_STREAM_END:break;case r.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},f.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,t=this.strm.avail_in;this.write_in_progress=!1,this.callback(t,e),this.pending_close&&this.close()}},f.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},f.prototype.init=function(e,t,i,a,s){n(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),n(e>=8&&e<=15,"invalid windowBits"),n(t>=-1&&t<=9,"invalid compression level"),n(i>=1&&i<=9,"invalid memlevel"),n(a===r.Z_FILTERED||a===r.Z_HUFFMAN_ONLY||a===r.Z_RLE||a===r.Z_FIXED||a===r.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(t,e,i,a,s),this._setDictionary()},f.prototype.params=function(){throw new Error("deflateParams Not supported")},f.prototype.reset=function(){this._reset(),this._setDictionary()},f.prototype._init=function(e,t,i,n,c){switch(this.level=e,this.windowBits=t,this.memLevel=i,this.strategy=n,this.flush=r.Z_NO_FLUSH,this.err=r.Z_OK,this.mode!==r.GZIP&&this.mode!==r.GUNZIP||(this.windowBits+=16),this.mode===r.UNZIP&&(this.windowBits+=32),this.mode!==r.DEFLATERAW&&this.mode!==r.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new a,this.mode){case r.DEFLATE:case r.GZIP:case r.DEFLATERAW:this.err=s.deflateInit2(this.strm,this.level,r.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case r.INFLATE:case r.GUNZIP:case r.INFLATERAW:case r.UNZIP:this.err=o.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==r.Z_OK&&this._error("Init error"),this.dictionary=c,this.write_in_progress=!1,this.init_done=!0},f.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=r.Z_OK,this.mode){case r.DEFLATE:case r.DEFLATERAW:this.err=s.deflateSetDictionary(this.strm,this.dictionary)}this.err!==r.Z_OK&&this._error("Failed to set dictionary")}},f.prototype._reset=function(){switch(this.err=r.Z_OK,this.mode){case r.DEFLATE:case r.DEFLATERAW:case r.GZIP:this.err=s.deflateReset(this.strm);break;case r.INFLATE:case r.INFLATERAW:case r.GUNZIP:this.err=o.inflateReset(this.strm)}this.err!==r.Z_OK&&this._error("Failed to reset stream")},r.Zlib=f}).call(this,e("_process"),e("buffer").Buffer)},{_process:133,assert:25,buffer:48,"pako/lib/zlib/constants":38,"pako/lib/zlib/deflate.js":40,"pako/lib/zlib/inflate.js":42,"pako/lib/zlib/zstream":46}],35:[function(e,t,r){(function(t){var i=e("buffer").Buffer,n=e("stream").Transform,a=e("./binding"),s=e("util"),o=e("assert").ok,c=e("buffer").kMaxLength,l="Cannot create final Buffer. It would be larger than 0x"+c.toString(16)+" bytes";a.Z_MIN_WINDOWBITS=8,a.Z_MAX_WINDOWBITS=15,a.Z_DEFAULT_WINDOWBITS=15,a.Z_MIN_CHUNK=64,a.Z_MAX_CHUNK=1/0,a.Z_DEFAULT_CHUNK=16384,a.Z_MIN_MEMLEVEL=1,a.Z_MAX_MEMLEVEL=9,a.Z_DEFAULT_MEMLEVEL=8,a.Z_MIN_LEVEL=-1,a.Z_MAX_LEVEL=9,a.Z_DEFAULT_LEVEL=a.Z_DEFAULT_COMPRESSION;for(var u=Object.keys(a),h=0;h<u.length;h++){var f=u[h];f.match(/^Z/)&&Object.defineProperty(r,f,{enumerable:!0,value:a[f],writable:!1})}for(var d={Z_OK:a.Z_OK,Z_STREAM_END:a.Z_STREAM_END,Z_NEED_DICT:a.Z_NEED_DICT,Z_ERRNO:a.Z_ERRNO,Z_STREAM_ERROR:a.Z_STREAM_ERROR,Z_DATA_ERROR:a.Z_DATA_ERROR,Z_MEM_ERROR:a.Z_MEM_ERROR,Z_BUF_ERROR:a.Z_BUF_ERROR,Z_VERSION_ERROR:a.Z_VERSION_ERROR},p=Object.keys(d),m=0;m<p.length;m++){var b=p[m];d[d[b]]=b}function v(e,t,r){var n=[],a=0;function s(){for(var t;null!==(t=e.read());)n.push(t),a+=t.length;e.once("readable",s)}function o(t){e.removeListener("end",u),e.removeListener("readable",s),r(t)}function u(){var t,s=null;a>=c?s=new RangeError(l):t=i.concat(n,a),n=[],e.close(),r(s,t)}e.on("error",o),e.on("end",u),e.end(t),s()}function g(e,t){if("string"==typeof t&&(t=i.from(t)),!i.isBuffer(t))throw new TypeError("Not a string or buffer");var r=e._finishFlushFlag;return e._processChunk(t,r)}function y(e){if(!(this instanceof y))return new y(e);E.call(this,e,a.DEFLATE)}function _(e){if(!(this instanceof _))return new _(e);E.call(this,e,a.INFLATE)}function w(e){if(!(this instanceof w))return new w(e);E.call(this,e,a.GZIP)}function x(e){if(!(this instanceof x))return new x(e);E.call(this,e,a.GUNZIP)}function k(e){if(!(this instanceof k))return new k(e);E.call(this,e,a.DEFLATERAW)}function S(e){if(!(this instanceof S))return new S(e);E.call(this,e,a.INFLATERAW)}function C(e){if(!(this instanceof C))return new C(e);E.call(this,e,a.UNZIP)}function U(e){return e===a.Z_NO_FLUSH||e===a.Z_PARTIAL_FLUSH||e===a.Z_SYNC_FLUSH||e===a.Z_FULL_FLUSH||e===a.Z_FINISH||e===a.Z_BLOCK}function E(e,t){var s=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||r.Z_DEFAULT_CHUNK,n.call(this,e),e.flush&&!U(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!U(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||a.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:a.Z_FINISH,e.chunkSize&&(e.chunkSize<r.Z_MIN_CHUNK||e.chunkSize>r.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<r.Z_MIN_WINDOWBITS||e.windowBits>r.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<r.Z_MIN_LEVEL||e.level>r.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<r.Z_MIN_MEMLEVEL||e.memLevel>r.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=r.Z_FILTERED&&e.strategy!=r.Z_HUFFMAN_ONLY&&e.strategy!=r.Z_RLE&&e.strategy!=r.Z_FIXED&&e.strategy!=r.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!i.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new a.Zlib(t);var o=this;this._hadError=!1,this._handle.onerror=function(e,t){T(o),o._hadError=!0;var i=new Error(e);i.errno=t,i.code=r.codes[t],o.emit("error",i)};var c=r.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(c=e.level);var l=r.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(l=e.strategy),this._handle.init(e.windowBits||r.Z_DEFAULT_WINDOWBITS,c,e.memLevel||r.Z_DEFAULT_MEMLEVEL,l,e.dictionary),this._buffer=i.allocUnsafe(this._chunkSize),this._offset=0,this._level=c,this._strategy=l,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!s._handle},configurable:!0,enumerable:!0})}function T(e,r){r&&t.nextTick(r),e._handle&&(e._handle.close(),e._handle=null)}function M(e){e.emit("close")}Object.defineProperty(r,"codes",{enumerable:!0,value:Object.freeze(d),writable:!1}),r.Deflate=y,r.Inflate=_,r.Gzip=w,r.Gunzip=x,r.DeflateRaw=k,r.InflateRaw=S,r.Unzip=C,r.createDeflate=function(e){return new y(e)},r.createInflate=function(e){return new _(e)},r.createDeflateRaw=function(e){return new k(e)},r.createInflateRaw=function(e){return new S(e)},r.createGzip=function(e){return new w(e)},r.createGunzip=function(e){return new x(e)},r.createUnzip=function(e){return new C(e)},r.deflate=function(e,t,r){return"function"==typeof t&&(r=t,t={}),v(new y(t),e,r)},r.deflateSync=function(e,t){return g(new y(t),e)},r.gzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),v(new w(t),e,r)},r.gzipSync=function(e,t){return g(new w(t),e)},r.deflateRaw=function(e,t,r){return"function"==typeof t&&(r=t,t={}),v(new k(t),e,r)},r.deflateRawSync=function(e,t){return g(new k(t),e)},r.unzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),v(new C(t),e,r)},r.unzipSync=function(e,t){return g(new C(t),e)},r.inflate=function(e,t,r){return"function"==typeof t&&(r=t,t={}),v(new _(t),e,r)},r.inflateSync=function(e,t){return g(new _(t),e)},r.gunzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),v(new x(t),e,r)},r.gunzipSync=function(e,t){return g(new x(t),e)},r.inflateRaw=function(e,t,r){return"function"==typeof t&&(r=t,t={}),v(new S(t),e,r)},r.inflateRawSync=function(e,t){return g(new S(t),e)},s.inherits(E,n),E.prototype.params=function(e,i,n){if(e<r.Z_MIN_LEVEL||e>r.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(i!=r.Z_FILTERED&&i!=r.Z_HUFFMAN_ONLY&&i!=r.Z_RLE&&i!=r.Z_FIXED&&i!=r.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+i);if(this._level!==e||this._strategy!==i){var s=this;this.flush(a.Z_SYNC_FLUSH,(function(){o(s._handle,"zlib binding closed"),s._handle.params(e,i),s._hadError||(s._level=e,s._strategy=i,n&&n())}))}else t.nextTick(n)},E.prototype.reset=function(){return o(this._handle,"zlib binding closed"),this._handle.reset()},E.prototype._flush=function(e){this._transform(i.alloc(0),"",e)},E.prototype.flush=function(e,r){var n=this,s=this._writableState;("function"==typeof e||void 0===e&&!r)&&(r=e,e=a.Z_FULL_FLUSH),s.ended?r&&t.nextTick(r):s.ending?r&&this.once("end",r):s.needDrain?r&&this.once("drain",(function(){return n.flush(e,r)})):(this._flushFlag=e,this.write(i.alloc(0),"",r))},E.prototype.close=function(e){T(this,e),t.nextTick(M,this)},E.prototype._transform=function(e,t,r){var n,s=this._writableState,o=(s.ending||s.ended)&&(!e||s.length===e.length);return null===e||i.isBuffer(e)?this._handle?(o?n=this._finishFlushFlag:(n=this._flushFlag,e.length>=s.length&&(this._flushFlag=this._opts.flush||a.Z_NO_FLUSH)),void this._processChunk(e,n,r)):r(new Error("zlib binding closed")):r(new Error("invalid input"))},E.prototype._processChunk=function(e,t,r){var n=e&&e.length,a=this._chunkSize-this._offset,s=0,u=this,h="function"==typeof r;if(!h){var f,d=[],p=0;this.on("error",(function(e){f=e})),o(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(t,e,s,n,this._buffer,this._offset,a)}while(!this._hadError&&g(m[0],m[1]));if(this._hadError)throw f;if(p>=c)throw T(this),new RangeError(l);var b=i.concat(d,p);return T(this),b}o(this._handle,"zlib binding closed");var v=this._handle.write(t,e,s,n,this._buffer,this._offset,a);function g(c,l){if(this&&(this.buffer=null,this.callback=null),!u._hadError){var f=a-l;if(o(f>=0,"have should not go down"),f>0){var m=u._buffer.slice(u._offset,u._offset+f);u._offset+=f,h?u.push(m):(d.push(m),p+=m.length)}if((0===l||u._offset>=u._chunkSize)&&(a=u._chunkSize,u._offset=0,u._buffer=i.allocUnsafe(u._chunkSize)),0===l){if(s+=n-c,n=c,!h)return!0;var b=u._handle.write(t,e,s,n,u._buffer,u._offset,u._chunkSize);return b.callback=g,void(b.buffer=e)}if(!h)return!1;r()}}v.buffer=e,v.callback=g},s.inherits(y,E),s.inherits(_,E),s.inherits(w,E),s.inherits(x,E),s.inherits(k,E),s.inherits(S,E),s.inherits(C,E)}).call(this,e("_process"))},{"./binding":34,_process:133,assert:25,buffer:48,stream:155,util:186}],36:[function(e,t,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==_(r))throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(e[i]=r[i])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+i),n);else for(var a=0;a<i;a++)e[n+a]=t[r+a]},flattenChunks:function(e){var t,r,i,n,a,s;for(i=0,t=0,r=e.length;t<r;t++)i+=e[t].length;for(s=new Uint8Array(i),n=0,t=0,r=e.length;t<r;t++)a=e[t],s.set(a,n),n+=a.length;return s}},s={arraySet:function(e,t,r,i,n){for(var a=0;a<i;a++)e[n+a]=t[r+a]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(i)},{}],37:[function(e,t,r){function i(e,t,r,i){for(var n=65535&e|0,a=e>>>16&65535|0,s=0;0!==r;){r-=s=r>2e3?2e3:r;do{a=a+(n=n+t[i++]|0)|0}while(--s);n%=65521,a%=65521}return n|a<<16|0}t.exports=i},{}],38:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],39:[function(e,t,r){function i(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}var n=i();function a(e,t,r,i){var a=n,s=i+r;e^=-1;for(var o=i;o<s;o++)e=e>>>8^a[255&(e^t[o])];return-1^e}t.exports=a},{}],40:[function(e,t,r){var i,n=e("../utils/common"),a=e("./trees"),s=e("./adler32"),o=e("./crc32"),c=e("./messages"),l=0,u=1,h=3,f=4,d=5,p=0,m=1,b=-2,v=-3,g=-5,y=-1,_=1,w=2,x=3,k=4,S=0,C=2,U=8,E=9,T=15,M=8,O=286,P=30,A=19,I=2*O+1,L=15,j=3,R=258,D=R+j+1,B=32,F=42,N=69,z=73,H=91,G=103,W=113,Y=666,X=1,V=2,q=3,Z=4,K=3;function J(e,t){return e.msg=c[t],t}function Q(e){return(e<<1)-(e>4?9:0)}function $(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(n.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function te(e,t){a._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function re(e,t){e.pending_buf[e.pending++]=t}function ie(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function ne(e,t,r,i){var a=e.avail_in;return a>i&&(a=i),0===a?0:(e.avail_in-=a,n.arraySet(t,e.input,e.next_in,a,r),1===e.state.wrap?e.adler=s(e.adler,t,a,r):2===e.state.wrap&&(e.adler=o(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)}function ae(e,t){var r,i,n=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match,c=e.strstart>e.w_size-D?e.strstart-(e.w_size-D):0,l=e.window,u=e.w_mask,h=e.prev,f=e.strstart+R,d=l[a+s-1],p=l[a+s];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(l[(r=t)+s]===p&&l[r+s-1]===d&&l[r]===l[a]&&l[++r]===l[a+1]){a+=2,r++;do{}while(l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&a<f);if(i=R-(f-a),a=f-R,i>s){if(e.match_start=t,s=i,i>=o)break;d=l[a+s-1],p=l[a+s]}}}while((t=h[t&u])>c&&0!=--n);return s<=e.lookahead?s:e.lookahead}function se(e){var t,r,i,a,s,o=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-D)){n.arraySet(e.window,e.window,o,o,0),e.match_start-=o,e.strstart-=o,e.block_start-=o,t=r=e.hash_size;do{i=e.head[--t],e.head[t]=i>=o?i-o:0}while(--r);t=r=o;do{i=e.prev[--t],e.prev[t]=i>=o?i-o:0}while(--r);a+=o}if(0===e.strm.avail_in)break;if(r=ne(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=r,e.lookahead+e.insert>=j)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+j-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<j)););}while(e.lookahead<D&&0!==e.strm.avail_in)}function oe(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(se(e),0===e.lookahead&&t===l)return X;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+r;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,te(e,!1),0===e.strm.avail_out))return X;if(e.strstart-e.block_start>=e.w_size-D&&(te(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),X)}function ce(e,t){for(var r,i;;){if(e.lookahead<D){if(se(e),e.lookahead<D&&t===l)return X;if(0===e.lookahead)break}if(r=0,e.lookahead>=j&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-D&&(e.match_length=ae(e,r)),e.match_length>=j)if(i=a._tr_tally(e,e.strstart-e.match_start,e.match_length-j),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=j){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(te(e,!1),0===e.strm.avail_out))return X}return e.insert=e.strstart<j-1?e.strstart:j-1,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?X:V}function le(e,t){for(var r,i,n;;){if(e.lookahead<D){if(se(e),e.lookahead<D&&t===l)return X;if(0===e.lookahead)break}if(r=0,e.lookahead>=j&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=j-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-D&&(e.match_length=ae(e,r),e.match_length<=5&&(e.strategy===_||e.match_length===j&&e.strstart-e.match_start>4096)&&(e.match_length=j-1)),e.prev_length>=j&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-j,i=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-j),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=j-1,e.strstart++,i&&(te(e,!1),0===e.strm.avail_out))return X}else if(e.match_available){if((i=a._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return X}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<j-1?e.strstart:j-1,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?X:V}function ue(e,t){for(var r,i,n,s,o=e.window;;){if(e.lookahead<=R){if(se(e),e.lookahead<=R&&t===l)return X;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=j&&e.strstart>0&&(i=o[n=e.strstart-1])===o[++n]&&i===o[++n]&&i===o[++n]){s=e.strstart+R;do{}while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);e.match_length=R-(s-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=j?(r=a._tr_tally(e,1,e.match_length-j),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(te(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?X:V}function he(e,t){for(var r;;){if(0===e.lookahead&&(se(e),0===e.lookahead)){if(t===l)return X;break}if(e.match_length=0,r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(te(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?X:V}function fe(e,t,r,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=i,this.func=n}function de(e){e.window_size=2*e.w_size,$(e.head),e.max_lazy_match=i[e.level].max_lazy,e.good_match=i[e.level].good_length,e.nice_match=i[e.level].nice_length,e.max_chain_length=i[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=j-1,e.match_available=0,e.ins_h=0}function pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=U,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*I),this.dyn_dtree=new n.Buf16(2*(2*P+1)),this.bl_tree=new n.Buf16(2*(2*A+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(L+1),this.heap=new n.Buf16(2*O+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*O+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=C,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?F:W,e.adler=2===t.wrap?0:1,t.last_flush=l,a._tr_init(t),p):J(e,b)}function be(e){var t=me(e);return t===p&&de(e.state),t}function ve(e,t){return e&&e.state?2!==e.state.wrap?b:(e.state.gzhead=t,p):b}function ge(e,t,r,i,a,s){if(!e)return b;var o=1;if(t===y&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),a<1||a>E||r!==U||i<8||i>15||t<0||t>9||s<0||s>k)return J(e,b);8===i&&(i=9);var c=new pe;return e.state=c,c.strm=e,c.wrap=o,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+j-1)/j),c.window=new n.Buf8(2*c.w_size),c.head=new n.Buf16(c.hash_size),c.prev=new n.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new n.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=s,c.method=r,be(e)}function ye(e,t){return ge(e,t,U,T,M,S)}function _e(e,t){var r,n,s,c;if(!e||!e.state||t>d||t<0)return e?J(e,b):b;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===Y&&t!==f)return J(e,0===e.avail_out?g:b);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===F)if(2===n.wrap)e.adler=0,re(n,31),re(n,139),re(n,8),n.gzhead?(re(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),re(n,255&n.gzhead.time),re(n,n.gzhead.time>>8&255),re(n,n.gzhead.time>>16&255),re(n,n.gzhead.time>>24&255),re(n,9===n.level?2:n.strategy>=w||n.level<2?4:0),re(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(re(n,255&n.gzhead.extra.length),re(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=o(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=N):(re(n,0),re(n,0),re(n,0),re(n,0),re(n,0),re(n,9===n.level?2:n.strategy>=w||n.level<2?4:0),re(n,K),n.status=W);else{var v=U+(n.w_bits-8<<4)<<8;v|=(n.strategy>=w||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(v|=B),v+=31-v%31,n.status=W,ie(n,v),0!==n.strstart&&(ie(n,e.adler>>>16),ie(n,65535&e.adler)),e.adler=1}if(n.status===N)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),ee(e),s=n.pending,n.pending!==n.pending_buf_size));)re(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=z)}else n.status=z;if(n.status===z)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),ee(e),s=n.pending,n.pending===n.pending_buf_size)){c=1;break}c=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,re(n,c)}while(0!==c);n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),0===c&&(n.gzindex=0,n.status=H)}else n.status=H;if(n.status===H)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),ee(e),s=n.pending,n.pending===n.pending_buf_size)){c=1;break}c=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,re(n,c)}while(0!==c);n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),0===c&&(n.status=G)}else n.status=G;if(n.status===G&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ee(e),n.pending+2<=n.pending_buf_size&&(re(n,255&e.adler),re(n,e.adler>>8&255),e.adler=0,n.status=W)):n.status=W),0!==n.pending){if(ee(e),0===e.avail_out)return n.last_flush=-1,p}else if(0===e.avail_in&&Q(t)<=Q(r)&&t!==f)return J(e,g);if(n.status===Y&&0!==e.avail_in)return J(e,g);if(0!==e.avail_in||0!==n.lookahead||t!==l&&n.status!==Y){var y=n.strategy===w?he(n,t):n.strategy===x?ue(n,t):i[n.level].func(n,t);if(y!==q&&y!==Z||(n.status=Y),y===X||y===q)return 0===e.avail_out&&(n.last_flush=-1),p;if(y===V&&(t===u?a._tr_align(n):t!==d&&(a._tr_stored_block(n,0,0,!1),t===h&&($(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),ee(e),0===e.avail_out))return n.last_flush=-1,p}return t!==f?p:n.wrap<=0?m:(2===n.wrap?(re(n,255&e.adler),re(n,e.adler>>8&255),re(n,e.adler>>16&255),re(n,e.adler>>24&255),re(n,255&e.total_in),re(n,e.total_in>>8&255),re(n,e.total_in>>16&255),re(n,e.total_in>>24&255)):(ie(n,e.adler>>>16),ie(n,65535&e.adler)),ee(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?p:m)}function we(e){var t;return e&&e.state?(t=e.state.status)!==F&&t!==N&&t!==z&&t!==H&&t!==G&&t!==W&&t!==Y?J(e,b):(e.state=null,t===W?J(e,v):p):b}function xe(e,t){var r,i,a,o,c,l,u,h,f=t.length;if(!e||!e.state)return b;if(2===(o=(r=e.state).wrap)||1===o&&r.status!==F||r.lookahead)return b;for(1===o&&(e.adler=s(e.adler,t,f,0)),r.wrap=0,f>=r.w_size&&(0===o&&($(r.head),r.strstart=0,r.block_start=0,r.insert=0),h=new n.Buf8(r.w_size),n.arraySet(h,t,f-r.w_size,r.w_size,0),t=h,f=r.w_size),c=e.avail_in,l=e.next_in,u=e.input,e.avail_in=f,e.next_in=0,e.input=t,se(r);r.lookahead>=j;){i=r.strstart,a=r.lookahead-(j-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+j-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++}while(--a);r.strstart=i,r.lookahead=j-1,se(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=j-1,r.match_available=0,e.next_in=l,e.input=u,e.avail_in=c,r.wrap=o,p}i=[new fe(0,0,0,0,oe),new fe(4,4,8,4,ce),new fe(4,5,16,8,ce),new fe(4,6,32,32,ce),new fe(4,4,16,16,le),new fe(8,16,32,32,le),new fe(8,16,128,128,le),new fe(8,32,128,256,le),new fe(32,128,258,1024,le),new fe(32,258,258,4096,le)],r.deflateInit=ye,r.deflateInit2=ge,r.deflateReset=be,r.deflateResetKeep=me,r.deflateSetHeader=ve,r.deflate=_e,r.deflateEnd=we,r.deflateSetDictionary=xe,r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":36,"./adler32":37,"./crc32":39,"./messages":44,"./trees":45}],41:[function(e,t,r){var i=30,n=12;t.exports=function(e,t){var r,a,s,o,c,l,u,h,f,d,p,m,b,v,g,y,_,w,x,k,S,C,U,E,T;r=e.state,a=e.next_in,E=e.input,s=a+(e.avail_in-5),o=e.next_out,T=e.output,c=o-(t-e.avail_out),l=o+(e.avail_out-257),u=r.dmax,h=r.wsize,f=r.whave,d=r.wnext,p=r.window,m=r.hold,b=r.bits,v=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,_=(1<<r.distbits)-1;e:do{b<15&&(m+=E[a++]<<b,b+=8,m+=E[a++]<<b,b+=8),w=v[m&y];t:for(;;){if(m>>>=x=w>>>24,b-=x,0==(x=w>>>16&255))T[o++]=65535&w;else{if(!(16&x)){if(0==(64&x)){w=v[(65535&w)+(m&(1<<x)-1)];continue t}if(32&x){r.mode=n;break e}e.msg="invalid literal/length code",r.mode=i;break e}k=65535&w,(x&=15)&&(b<x&&(m+=E[a++]<<b,b+=8),k+=m&(1<<x)-1,m>>>=x,b-=x),b<15&&(m+=E[a++]<<b,b+=8,m+=E[a++]<<b,b+=8),w=g[m&_];r:for(;;){if(m>>>=x=w>>>24,b-=x,!(16&(x=w>>>16&255))){if(0==(64&x)){w=g[(65535&w)+(m&(1<<x)-1)];continue r}e.msg="invalid distance code",r.mode=i;break e}if(S=65535&w,b<(x&=15)&&(m+=E[a++]<<b,(b+=8)<x&&(m+=E[a++]<<b,b+=8)),(S+=m&(1<<x)-1)>u){e.msg="invalid distance too far back",r.mode=i;break e}if(m>>>=x,b-=x,S>(x=o-c)){if((x=S-x)>f&&r.sane){e.msg="invalid distance too far back",r.mode=i;break e}if(C=0,U=p,0===d){if(C+=h-x,x<k){k-=x;do{T[o++]=p[C++]}while(--x);C=o-S,U=T}}else if(d<x){if(C+=h+d-x,(x-=d)<k){k-=x;do{T[o++]=p[C++]}while(--x);if(C=0,d<k){k-=x=d;do{T[o++]=p[C++]}while(--x);C=o-S,U=T}}}else if(C+=d-x,x<k){k-=x;do{T[o++]=p[C++]}while(--x);C=o-S,U=T}for(;k>2;)T[o++]=U[C++],T[o++]=U[C++],T[o++]=U[C++],k-=3;k&&(T[o++]=U[C++],k>1&&(T[o++]=U[C++]))}else{C=o-S;do{T[o++]=T[C++],T[o++]=T[C++],T[o++]=T[C++],k-=3}while(k>2);k&&(T[o++]=T[C++],k>1&&(T[o++]=T[C++]))}break}}break}}while(a<s&&o<l);a-=k=b>>3,m&=(1<<(b-=k<<3))-1,e.next_in=a,e.next_out=o,e.avail_in=a<s?s-a+5:5-(a-s),e.avail_out=o<l?l-o+257:257-(o-l),r.hold=m,r.bits=b}},{}],42:[function(e,t,r){var i=e("../utils/common"),n=e("./adler32"),a=e("./crc32"),s=e("./inffast"),o=e("./inftrees"),c=0,l=1,u=2,h=4,f=5,d=6,p=0,m=1,b=2,v=-2,g=-3,y=-4,_=-5,w=8,x=1,k=2,S=3,C=4,U=5,E=6,T=7,M=8,O=9,P=10,A=11,I=12,L=13,j=14,R=15,D=16,B=17,F=18,N=19,z=20,H=21,G=22,W=23,Y=24,X=25,V=26,q=27,Z=28,K=29,J=30,Q=31,$=852,ee=592,te=15;function re(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function ie(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ne(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=x,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32($),t.distcode=t.distdyn=new i.Buf32(ee),t.sane=1,t.back=-1,p):v}function ae(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,ne(e)):v}function se(e,t){var r,i;return e&&e.state?(i=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?v:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,ae(e))):v}function oe(e,t){var r,i;return e?(i=new ie,e.state=i,i.window=null,(r=se(e,t))!==p&&(e.state=null),r):v}function ce(e){return oe(e,te)}var le,ue,he=!0;function fe(e){if(he){var t;for(le=new i.Buf32(512),ue=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(l,e.lens,0,288,le,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(u,e.lens,0,32,ue,0,e.work,{bits:5}),he=!1}e.lencode=le,e.lenbits=9,e.distcode=ue,e.distbits=5}function de(e,t,r,n){var a,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new i.Buf8(s.wsize)),n>=s.wsize?(i.arraySet(s.window,t,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((a=s.wsize-s.wnext)>n&&(a=n),i.arraySet(s.window,t,r-n,a,s.wnext),(n-=a)?(i.arraySet(s.window,t,r-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}function pe(e,t){var r,$,ee,te,ie,ne,ae,se,oe,ce,le,ue,he,pe,me,be,ve,ge,ye,_e,we,xe,ke,Se,Ce=0,Ue=new i.Buf8(4),Ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return v;(r=e.state).mode===I&&(r.mode=L),ie=e.next_out,ee=e.output,ae=e.avail_out,te=e.next_in,$=e.input,ne=e.avail_in,se=r.hold,oe=r.bits,ce=ne,le=ae,xe=p;e:for(;;)switch(r.mode){case x:if(0===r.wrap){r.mode=L;break}for(;oe<16;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(2&r.wrap&&35615===se){r.check=0,Ue[0]=255&se,Ue[1]=se>>>8&255,r.check=a(r.check,Ue,2,0),se=0,oe=0,r.mode=k;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&se)<<8)+(se>>8))%31){e.msg="incorrect header check",r.mode=J;break}if((15&se)!==w){e.msg="unknown compression method",r.mode=J;break}if(oe-=4,we=8+(15&(se>>>=4)),0===r.wbits)r.wbits=we;else if(we>r.wbits){e.msg="invalid window size",r.mode=J;break}r.dmax=1<<we,e.adler=r.check=1,r.mode=512&se?P:I,se=0,oe=0;break;case k:for(;oe<16;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(r.flags=se,(255&r.flags)!==w){e.msg="unknown compression method",r.mode=J;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=J;break}r.head&&(r.head.text=se>>8&1),512&r.flags&&(Ue[0]=255&se,Ue[1]=se>>>8&255,r.check=a(r.check,Ue,2,0)),se=0,oe=0,r.mode=S;case S:for(;oe<32;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}r.head&&(r.head.time=se),512&r.flags&&(Ue[0]=255&se,Ue[1]=se>>>8&255,Ue[2]=se>>>16&255,Ue[3]=se>>>24&255,r.check=a(r.check,Ue,4,0)),se=0,oe=0,r.mode=C;case C:for(;oe<16;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}r.head&&(r.head.xflags=255&se,r.head.os=se>>8),512&r.flags&&(Ue[0]=255&se,Ue[1]=se>>>8&255,r.check=a(r.check,Ue,2,0)),se=0,oe=0,r.mode=U;case U:if(1024&r.flags){for(;oe<16;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}r.length=se,r.head&&(r.head.extra_len=se),512&r.flags&&(Ue[0]=255&se,Ue[1]=se>>>8&255,r.check=a(r.check,Ue,2,0)),se=0,oe=0}else r.head&&(r.head.extra=null);r.mode=E;case E:if(1024&r.flags&&((ue=r.length)>ne&&(ue=ne),ue&&(r.head&&(we=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),i.arraySet(r.head.extra,$,te,ue,we)),512&r.flags&&(r.check=a(r.check,$,ue,te)),ne-=ue,te+=ue,r.length-=ue),r.length))break e;r.length=0,r.mode=T;case T:if(2048&r.flags){if(0===ne)break e;ue=0;do{we=$[te+ue++],r.head&&we&&r.length<65536&&(r.head.name+=String.fromCharCode(we))}while(we&&ue<ne);if(512&r.flags&&(r.check=a(r.check,$,ue,te)),ne-=ue,te+=ue,we)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=M;case M:if(4096&r.flags){if(0===ne)break e;ue=0;do{we=$[te+ue++],r.head&&we&&r.length<65536&&(r.head.comment+=String.fromCharCode(we))}while(we&&ue<ne);if(512&r.flags&&(r.check=a(r.check,$,ue,te)),ne-=ue,te+=ue,we)break e}else r.head&&(r.head.comment=null);r.mode=O;case O:if(512&r.flags){for(;oe<16;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(se!==(65535&r.check)){e.msg="header crc mismatch",r.mode=J;break}se=0,oe=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=I;break;case P:for(;oe<32;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}e.adler=r.check=re(se),se=0,oe=0,r.mode=A;case A:if(0===r.havedict)return e.next_out=ie,e.avail_out=ae,e.next_in=te,e.avail_in=ne,r.hold=se,r.bits=oe,b;e.adler=r.check=1,r.mode=I;case I:if(t===f||t===d)break e;case L:if(r.last){se>>>=7&oe,oe-=7&oe,r.mode=q;break}for(;oe<3;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}switch(r.last=1&se,oe-=1,3&(se>>>=1)){case 0:r.mode=j;break;case 1:if(fe(r),r.mode=z,t===d){se>>>=2,oe-=2;break e}break;case 2:r.mode=B;break;case 3:e.msg="invalid block type",r.mode=J}se>>>=2,oe-=2;break;case j:for(se>>>=7&oe,oe-=7&oe;oe<32;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if((65535&se)!=(se>>>16^65535)){e.msg="invalid stored block lengths",r.mode=J;break}if(r.length=65535&se,se=0,oe=0,r.mode=R,t===d)break e;case R:r.mode=D;case D:if(ue=r.length){if(ue>ne&&(ue=ne),ue>ae&&(ue=ae),0===ue)break e;i.arraySet(ee,$,te,ue,ie),ne-=ue,te+=ue,ae-=ue,ie+=ue,r.length-=ue;break}r.mode=I;break;case B:for(;oe<14;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(r.nlen=257+(31&se),se>>>=5,oe-=5,r.ndist=1+(31&se),se>>>=5,oe-=5,r.ncode=4+(15&se),se>>>=4,oe-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=J;break}r.have=0,r.mode=F;case F:for(;r.have<r.ncode;){for(;oe<3;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}r.lens[Ee[r.have++]]=7&se,se>>>=3,oe-=3}for(;r.have<19;)r.lens[Ee[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ke={bits:r.lenbits},xe=o(c,r.lens,0,19,r.lencode,0,r.work,ke),r.lenbits=ke.bits,xe){e.msg="invalid code lengths set",r.mode=J;break}r.have=0,r.mode=N;case N:for(;r.have<r.nlen+r.ndist;){for(;be=(Ce=r.lencode[se&(1<<r.lenbits)-1])>>>16&255,ve=65535&Ce,!((me=Ce>>>24)<=oe);){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(ve<16)se>>>=me,oe-=me,r.lens[r.have++]=ve;else{if(16===ve){for(Se=me+2;oe<Se;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(se>>>=me,oe-=me,0===r.have){e.msg="invalid bit length repeat",r.mode=J;break}we=r.lens[r.have-1],ue=3+(3&se),se>>>=2,oe-=2}else if(17===ve){for(Se=me+3;oe<Se;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}oe-=me,we=0,ue=3+(7&(se>>>=me)),se>>>=3,oe-=3}else{for(Se=me+7;oe<Se;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}oe-=me,we=0,ue=11+(127&(se>>>=me)),se>>>=7,oe-=7}if(r.have+ue>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=J;break}for(;ue--;)r.lens[r.have++]=we}}if(r.mode===J)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=J;break}if(r.lenbits=9,ke={bits:r.lenbits},xe=o(l,r.lens,0,r.nlen,r.lencode,0,r.work,ke),r.lenbits=ke.bits,xe){e.msg="invalid literal/lengths set",r.mode=J;break}if(r.distbits=6,r.distcode=r.distdyn,ke={bits:r.distbits},xe=o(u,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ke),r.distbits=ke.bits,xe){e.msg="invalid distances set",r.mode=J;break}if(r.mode=z,t===d)break e;case z:r.mode=H;case H:if(ne>=6&&ae>=258){e.next_out=ie,e.avail_out=ae,e.next_in=te,e.avail_in=ne,r.hold=se,r.bits=oe,s(e,le),ie=e.next_out,ee=e.output,ae=e.avail_out,te=e.next_in,$=e.input,ne=e.avail_in,se=r.hold,oe=r.bits,r.mode===I&&(r.back=-1);break}for(r.back=0;be=(Ce=r.lencode[se&(1<<r.lenbits)-1])>>>16&255,ve=65535&Ce,!((me=Ce>>>24)<=oe);){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(be&&0==(240&be)){for(ge=me,ye=be,_e=ve;be=(Ce=r.lencode[_e+((se&(1<<ge+ye)-1)>>ge)])>>>16&255,ve=65535&Ce,!(ge+(me=Ce>>>24)<=oe);){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}se>>>=ge,oe-=ge,r.back+=ge}if(se>>>=me,oe-=me,r.back+=me,r.length=ve,0===be){r.mode=V;break}if(32&be){r.back=-1,r.mode=I;break}if(64&be){e.msg="invalid literal/length code",r.mode=J;break}r.extra=15&be,r.mode=G;case G:if(r.extra){for(Se=r.extra;oe<Se;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}r.length+=se&(1<<r.extra)-1,se>>>=r.extra,oe-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=W;case W:for(;be=(Ce=r.distcode[se&(1<<r.distbits)-1])>>>16&255,ve=65535&Ce,!((me=Ce>>>24)<=oe);){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(0==(240&be)){for(ge=me,ye=be,_e=ve;be=(Ce=r.distcode[_e+((se&(1<<ge+ye)-1)>>ge)])>>>16&255,ve=65535&Ce,!(ge+(me=Ce>>>24)<=oe);){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}se>>>=ge,oe-=ge,r.back+=ge}if(se>>>=me,oe-=me,r.back+=me,64&be){e.msg="invalid distance code",r.mode=J;break}r.offset=ve,r.extra=15&be,r.mode=Y;case Y:if(r.extra){for(Se=r.extra;oe<Se;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}r.offset+=se&(1<<r.extra)-1,se>>>=r.extra,oe-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=J;break}r.mode=X;case X:if(0===ae)break e;if(ue=le-ae,r.offset>ue){if((ue=r.offset-ue)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=J;break}ue>r.wnext?(ue-=r.wnext,he=r.wsize-ue):he=r.wnext-ue,ue>r.length&&(ue=r.length),pe=r.window}else pe=ee,he=ie-r.offset,ue=r.length;ue>ae&&(ue=ae),ae-=ue,r.length-=ue;do{ee[ie++]=pe[he++]}while(--ue);0===r.length&&(r.mode=H);break;case V:if(0===ae)break e;ee[ie++]=r.length,ae--,r.mode=H;break;case q:if(r.wrap){for(;oe<32;){if(0===ne)break e;ne--,se|=$[te++]<<oe,oe+=8}if(le-=ae,e.total_out+=le,r.total+=le,le&&(e.adler=r.check=r.flags?a(r.check,ee,le,ie-le):n(r.check,ee,le,ie-le)),le=ae,(r.flags?se:re(se))!==r.check){e.msg="incorrect data check",r.mode=J;break}se=0,oe=0}r.mode=Z;case Z:if(r.wrap&&r.flags){for(;oe<32;){if(0===ne)break e;ne--,se+=$[te++]<<oe,oe+=8}if(se!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=J;break}se=0,oe=0}r.mode=K;case K:xe=m;break e;case J:xe=g;break e;case Q:return y;default:return v}return e.next_out=ie,e.avail_out=ae,e.next_in=te,e.avail_in=ne,r.hold=se,r.bits=oe,(r.wsize||le!==e.avail_out&&r.mode<J&&(r.mode<q||t!==h))&&de(e,e.output,e.next_out,le-e.avail_out),ce-=e.avail_in,le-=e.avail_out,e.total_in+=ce,e.total_out+=le,r.total+=le,r.wrap&&le&&(e.adler=r.check=r.flags?a(r.check,ee,le,e.next_out-le):n(r.check,ee,le,e.next_out-le)),e.data_type=r.bits+(r.last?64:0)+(r.mode===I?128:0)+(r.mode===z||r.mode===R?256:0),(0===ce&&0===le||t===h)&&xe===p&&(xe=_),xe}function me(e){if(!e||!e.state)return v;var t=e.state;return t.window&&(t.window=null),e.state=null,p}function be(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?v:(r.head=t,t.done=!1,p):v}function ve(e,t){var r,i=t.length;return e&&e.state?0!==(r=e.state).wrap&&r.mode!==A?v:r.mode===A&&n(1,t,i,0)!==r.check?g:de(e,t,i,i)?(r.mode=Q,y):(r.havedict=1,p):v}r.inflateReset=ae,r.inflateReset2=se,r.inflateResetKeep=ne,r.inflateInit=ce,r.inflateInit2=oe,r.inflate=pe,r.inflateEnd=me,r.inflateGetHeader=be,r.inflateSetDictionary=ve,r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":36,"./adler32":37,"./crc32":39,"./inffast":41,"./inftrees":43}],43:[function(e,t,r){var i=e("../utils/common"),n=15,a=852,s=592,o=0,c=1,l=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,p,m,b,v,g){var y,_,w,x,k,S,C,U,E,T=g.bits,M=0,O=0,P=0,A=0,I=0,L=0,j=0,R=0,D=0,B=0,F=null,N=0,z=new i.Buf16(n+1),H=new i.Buf16(n+1),G=null,W=0;for(M=0;M<=n;M++)z[M]=0;for(O=0;O<p;O++)z[t[r+O]]++;for(I=T,A=n;A>=1&&0===z[A];A--);if(I>A&&(I=A),0===A)return m[b++]=20971520,m[b++]=20971520,g.bits=1,0;for(P=1;P<A&&0===z[P];P++);for(I<P&&(I=P),R=1,M=1;M<=n;M++)if(R<<=1,(R-=z[M])<0)return-1;if(R>0&&(e===o||1!==A))return-1;for(H[1]=0,M=1;M<n;M++)H[M+1]=H[M]+z[M];for(O=0;O<p;O++)0!==t[r+O]&&(v[H[t[r+O]]++]=O);if(e===o?(F=G=v,S=19):e===c?(F=u,N-=257,G=h,W-=257,S=256):(F=f,G=d,S=-1),B=0,O=0,M=P,k=b,L=I,j=0,w=-1,x=(D=1<<I)-1,e===c&&D>a||e===l&&D>s)return 1;for(;;){C=M-j,v[O]<S?(U=0,E=v[O]):v[O]>S?(U=G[W+v[O]],E=F[N+v[O]]):(U=96,E=0),y=1<<M-j,P=_=1<<L;do{m[k+(B>>j)+(_-=y)]=C<<24|U<<16|E|0}while(0!==_);for(y=1<<M-1;B&y;)y>>=1;if(0!==y?(B&=y-1,B+=y):B=0,O++,0==--z[M]){if(M===A)break;M=t[r+v[O]]}if(M>I&&(B&x)!==w){for(0===j&&(j=I),k+=P,R=1<<(L=M-j);L+j<A&&!((R-=z[L+j])<=0);)L++,R<<=1;if(D+=1<<L,e===c&&D>a||e===l&&D>s)return 1;m[w=B&x]=I<<24|L<<16|k-b|0}}return 0!==B&&(m[k+B]=M-j<<24|64<<16|0),g.bits=I,0}},{"../utils/common":36}],44:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],45:[function(e,t,r){var i=e("../utils/common"),n=4,a=0,s=1,o=2;function c(e){for(var t=e.length;--t>=0;)e[t]=0}var l=0,u=1,h=2,f=3,d=258,p=29,m=256,b=m+1+p,v=30,g=19,y=2*b+1,_=15,w=16,x=7,k=256,S=16,C=17,U=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,A=new Array(2*(b+2));c(A);var I=new Array(2*v);c(I);var L=new Array(P);c(L);var j=new Array(d-f+1);c(j);var R=new Array(p);c(R);var D,B,F,N=new Array(v);function z(e,t,r,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}function H(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function G(e){return e<256?L[e]:L[256+(e>>>7)]}function W(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function Y(e,t,r){e.bi_valid>w-r?(e.bi_buf|=t<<e.bi_valid&65535,W(e,e.bi_buf),e.bi_buf=t>>w-e.bi_valid,e.bi_valid+=r-w):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function X(e,t,r){Y(e,r[2*t],r[2*t+1])}function V(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function q(e){16===e.bi_valid?(W(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function Z(e,t){var r,i,n,a,s,o,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(a=0;a<=_;a++)e.bl_count[a]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<y;r++)(a=c[2*c[2*(i=e.heap[r])+1]+1]+1)>p&&(a=p,m++),c[2*i+1]=a,i>l||(e.bl_count[a]++,s=0,i>=d&&(s=f[i-d]),o=c[2*i],e.opt_len+=o*(a+s),h&&(e.static_len+=o*(u[2*i+1]+s)));if(0!==m){do{for(a=p-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(a=p;0!==a;a--)for(i=e.bl_count[a];0!==i;)(n=e.heap[--r])>l||(c[2*n+1]!==a&&(e.opt_len+=(a-c[2*n+1])*c[2*n],c[2*n+1]=a),i--)}}function K(e,t,r){var i,n,a=new Array(_+1),s=0;for(i=1;i<=_;i++)a[i]=s=s+r[i-1]<<1;for(n=0;n<=t;n++){var o=e[2*n+1];0!==o&&(e[2*n]=V(a[o]++,o))}}function J(){var e,t,r,i,n,a=new Array(_+1);for(r=0,i=0;i<p-1;i++)for(R[i]=r,e=0;e<1<<E[i];e++)j[r++]=i;for(j[r-1]=i,n=0,i=0;i<16;i++)for(N[i]=n,e=0;e<1<<T[i];e++)L[n++]=i;for(n>>=7;i<v;i++)for(N[i]=n<<7,e=0;e<1<<T[i]-7;e++)L[256+n++]=i;for(t=0;t<=_;t++)a[t]=0;for(e=0;e<=143;)A[2*e+1]=8,e++,a[8]++;for(;e<=255;)A[2*e+1]=9,e++,a[9]++;for(;e<=279;)A[2*e+1]=7,e++,a[7]++;for(;e<=287;)A[2*e+1]=8,e++,a[8]++;for(K(A,b+1,a),e=0;e<v;e++)I[2*e+1]=5,I[2*e]=V(e,5);D=new z(A,E,m+1,b,_),B=new z(I,T,0,v,_),F=new z(new Array(0),M,0,g,x)}function Q(e){var t;for(t=0;t<b;t++)e.dyn_ltree[2*t]=0;for(t=0;t<v;t++)e.dyn_dtree[2*t]=0;for(t=0;t<g;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*k]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function $(e){e.bi_valid>8?W(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function ee(e,t,r,n){$(e),n&&(W(e,r),W(e,~r)),i.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}function te(e,t,r,i){var n=2*t,a=2*r;return e[n]<e[a]||e[n]===e[a]&&i[t]<=i[r]}function re(e,t,r){for(var i=e.heap[r],n=r<<1;n<=e.heap_len&&(n<e.heap_len&&te(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!te(t,i,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=i}function ie(e,t,r){var i,n,a,s,o=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],n=e.pending_buf[e.l_buf+o],o++,0===i?X(e,n,t):(X(e,(a=j[n])+m+1,t),0!==(s=E[a])&&Y(e,n-=R[a],s),X(e,a=G(--i),r),0!==(s=T[a])&&Y(e,i-=N[a],s))}while(o<e.last_lit);X(e,k,t)}function ne(e,t){var r,i,n,a=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=y,r=0;r<c;r++)0!==a[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):a[2*r+1]=0;for(;e.heap_len<2;)a[2*(n=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[n]=0,e.opt_len--,o&&(e.static_len-=s[2*n+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)re(e,a,r);n=c;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],re(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=i,a[2*n]=a[2*r]+a[2*i],e.depth[n]=(e.depth[r]>=e.depth[i]?e.depth[r]:e.depth[i])+1,a[2*r+1]=a[2*i+1]=n,e.heap[1]=n++,re(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Z(e,t),K(a,l,e.bl_count)}function ae(e,t,r){var i,n,a=-1,s=t[1],o=0,c=7,l=4;for(0===s&&(c=138,l=3),t[2*(r+1)+1]=65535,i=0;i<=r;i++)n=s,s=t[2*(i+1)+1],++o<c&&n===s||(o<l?e.bl_tree[2*n]+=o:0!==n?(n!==a&&e.bl_tree[2*n]++,e.bl_tree[2*S]++):o<=10?e.bl_tree[2*C]++:e.bl_tree[2*U]++,o=0,a=n,0===s?(c=138,l=3):n===s?(c=6,l=3):(c=7,l=4))}function se(e,t,r){var i,n,a=-1,s=t[1],o=0,c=7,l=4;for(0===s&&(c=138,l=3),i=0;i<=r;i++)if(n=s,s=t[2*(i+1)+1],!(++o<c&&n===s)){if(o<l)do{X(e,n,e.bl_tree)}while(0!=--o);else 0!==n?(n!==a&&(X(e,n,e.bl_tree),o--),X(e,S,e.bl_tree),Y(e,o-3,2)):o<=10?(X(e,C,e.bl_tree),Y(e,o-3,3)):(X(e,U,e.bl_tree),Y(e,o-11,7));o=0,a=n,0===s?(c=138,l=3):n===s?(c=6,l=3):(c=7,l=4)}}function oe(e){var t;for(ae(e,e.dyn_ltree,e.l_desc.max_code),ae(e,e.dyn_dtree,e.d_desc.max_code),ne(e,e.bl_desc),t=g-1;t>=3&&0===e.bl_tree[2*O[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function ce(e,t,r,i){var n;for(Y(e,t-257,5),Y(e,r-1,5),Y(e,i-4,4),n=0;n<i;n++)Y(e,e.bl_tree[2*O[n]+1],3);se(e,e.dyn_ltree,t-1),se(e,e.dyn_dtree,r-1)}function le(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return s;for(t=32;t<m;t++)if(0!==e.dyn_ltree[2*t])return s;return a}c(N);var ue=!1;function he(e){ue||(J(),ue=!0),e.l_desc=new H(e.dyn_ltree,D),e.d_desc=new H(e.dyn_dtree,B),e.bl_desc=new H(e.bl_tree,F),e.bi_buf=0,e.bi_valid=0,Q(e)}function fe(e,t,r,i){Y(e,(l<<1)+(i?1:0),3),ee(e,t,r,!0)}function de(e){Y(e,u<<1,3),X(e,k,A),q(e)}function pe(e,t,r,i){var a,s,c=0;e.level>0?(e.strm.data_type===o&&(e.strm.data_type=le(e)),ne(e,e.l_desc),ne(e,e.d_desc),c=oe(e),a=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=a&&(a=s)):a=s=r+5,r+4<=a&&-1!==t?fe(e,t,r,i):e.strategy===n||s===a?(Y(e,(u<<1)+(i?1:0),3),ie(e,A,I)):(Y(e,(h<<1)+(i?1:0),3),ce(e,e.l_desc.max_code+1,e.d_desc.max_code+1,c+1),ie(e,e.dyn_ltree,e.dyn_dtree)),Q(e),i&&$(e)}function me(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(j[r]+m+1)]++,e.dyn_dtree[2*G(t)]++),e.last_lit===e.lit_bufsize-1}r._tr_init=he,r._tr_stored_block=fe,r._tr_flush_block=pe,r._tr_tally=me,r._tr_align=de},{"../utils/common":36}],46:[function(e,t,r){function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=i},{}],47:[function(e,t,r){arguments[4][33][0].apply(r,arguments)},{dup:33}],48:[function(e,t,r){(function(t){var i=e("base64-js"),n=e("ieee754"),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=t,r.SlowBuffer=g,r.INSPECT_MAX_BYTES=50;var s=2147483647;function o(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(r){return!1}}function c(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');var r=new Uint8Array(e);return Object.setPrototypeOf(r,t.prototype),r}function t(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return l(e,t,r)}function l(e,r,i){if("string"==typeof e)return d(e,r);if(ArrayBuffer.isView(e))return p(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_(e));if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return m(e,r,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return t.from(n,r,i);var a=b(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return t.from(e[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_(e))}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e,t,r){return u(e),e<=0?c(e):void 0!==t?"string"==typeof r?c(e).fill(t,r):c(e).fill(t):c(e)}function f(e){return u(e),c(e<0?0:0|v(e))}function d(e,r){if("string"==typeof r&&""!==r||(r="utf8"),!t.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i=0|y(e,r),n=c(i),a=n.write(e,r);return a!==i&&(n=n.slice(0,a)),n}function p(e){for(var t=e.length<0?0:0|v(e.length),r=c(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function m(e,r,i){if(r<0||e.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<r+(i||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===r&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,r):new Uint8Array(e,r,i),Object.setPrototypeOf(n,t.prototype),n}function b(e){if(t.isBuffer(e)){var r=0|v(e.length),i=c(r);return 0===i.length||e.copy(i,0,0,r),i}return void 0!==e.length?"number"!=typeof e.length||Q(e.length)?c(0):p(e):"Buffer"===e.type&&Array.isArray(e.data)?p(e.data):void 0}function v(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),t.alloc(+e)}function y(e,r){if(t.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+_(e));var i=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;for(var a=!1;;)switch(r){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return Z(e).length;default:if(a)return n?-1:X(e).length;r=(""+r).toLowerCase(),a=!0}}function w(e,t,r){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return D(this,t,r);case"utf8":case"utf-8":return A(this,t,r);case"ascii":return j(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return P(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function x(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function k(e,r,i,n,a){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),Q(i=+i)&&(i=a?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(a)return-1;i=e.length-1}else if(i<0){if(!a)return-1;i=0}if("string"==typeof r&&(r=t.from(r,n)),t.isBuffer(r))return 0===r.length?-1:S(e,r,i,n,a);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,r,i):Uint8Array.prototype.lastIndexOf.call(e,r,i):S(e,[r],i,n,a);throw new TypeError("val must be string, number or Buffer")}function S(e,t,r,i,n){var a,s=1,o=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,o/=2,c/=2,r/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n){var u=-1;for(a=r;a<o;a++)if(l(e,a)===l(t,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===c)return u*s}else-1!==u&&(a-=a-u),u=-1}else for(r+c>o&&(r=o-c),a=r;a>=0;a--){for(var h=!0,f=0;f<c;f++)if(l(e,a+f)!==l(t,f)){h=!1;break}if(h)return a}return-1}function C(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var a=t.length;i>a/2&&(i=a/2);for(var s=0;s<i;++s){var o=parseInt(t.substr(2*s,2),16);if(Q(o))return s;e[r+s]=o}return s}function U(e,t,r,i){return K(X(t,e.length-r),e,r,i)}function E(e,t,r,i){return K(V(t),e,r,i)}function T(e,t,r,i){return E(e,t,r,i)}function M(e,t,r,i){return K(Z(t),e,r,i)}function O(e,t,r,i){return K(q(t,e.length-r),e,r,i)}function P(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function A(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var a,s,o,c,l=e[n],u=null,h=l>239?4:l>223?3:l>191?2:1;if(n+h<=r)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(a=e[n+1]))&&(c=(31&l)<<6|63&a)>127&&(u=c);break;case 3:a=e[n+1],s=e[n+2],128==(192&a)&&128==(192&s)&&(c=(15&l)<<12|(63&a)<<6|63&s)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:a=e[n+1],s=e[n+2],o=e[n+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(c=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&c<1114112&&(u=c)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=h}return L(i)}r.kMaxLength=s,t.TYPED_ARRAY_SUPPORT=o(),t.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(t.prototype,Uint8Array.prototype),Object.setPrototypeOf(t,Uint8Array),t.alloc=function(e,t,r){return h(e,t,r)},t.allocUnsafe=function(e){return f(e)},t.allocUnsafeSlow=function(e){return f(e)},t.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==t.prototype},t.compare=function(e,r){if(J(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),J(r,Uint8Array)&&(r=t.from(r,r.offset,r.byteLength)),!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var i=e.length,n=r.length,a=0,s=Math.min(i,n);a<s;++a)if(e[a]!==r[a]){i=e[a],n=r[a];break}return i<n?-1:n<i?1:0},t.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);var i;if(void 0===r)for(r=0,i=0;i<e.length;++i)r+=e[i].length;var n=t.allocUnsafe(r),a=0;for(i=0;i<e.length;++i){var s=e[i];if(J(s,Uint8Array)&&(s=t.from(s)),!t.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,a),a+=s.length}return n},t.byteLength=y,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)x(this,t,t+1);return this},t.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)x(this,t,t+3),x(this,t+1,t+2);return this},t.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)x(this,t,t+7),x(this,t+1,t+6),x(this,t+2,t+5),x(this,t+3,t+4);return this},t.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?A(this,0,e):w.apply(this,arguments)},t.prototype.toLocaleString=t.prototype.toString,t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},a&&(t.prototype[a]=t.prototype.inspect),t.prototype.compare=function(e,r,i,n,a){if(J(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+_(e));if(void 0===r&&(r=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),r<0||i>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&r>=i)return 0;if(n>=a)return-1;if(r>=i)return 1;if(this===e)return 0;for(var s=(a>>>=0)-(n>>>=0),o=(i>>>=0)-(r>>>=0),c=Math.min(s,o),l=this.slice(n,a),u=e.slice(r,i),h=0;h<c;++h)if(l[h]!==u[h]){s=l[h],o=u[h];break}return s<o?-1:o<s?1:0},t.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},t.prototype.indexOf=function(e,t,r){return k(this,e,t,r,!0)},t.prototype.lastIndexOf=function(e,t,r){return k(this,e,t,r,!1)},t.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return C(this,e,t,r);case"utf8":case"utf-8":return U(this,e,t,r);case"ascii":return E(this,e,t,r);case"latin1":case"binary":return T(this,e,t,r);case"base64":return M(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function L(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);for(var r="",i=0;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=I));return r}function j(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function R(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function D(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",a=t;a<r;++a)n+=$[e[a]];return n}function B(e,t,r){for(var i=e.slice(t,r),n="",a=0;a<i.length;a+=2)n+=String.fromCharCode(i[a]+256*i[a+1]);return n}function F(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,r,i,n,a,s){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>a||r<s)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function z(e,t,r,i,n,a){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function H(e,t,r,i,a){return t=+t,r>>>=0,a||z(e,t,r,4),n.write(e,t,r,i,23,4),r+4}function G(e,t,r,i,a){return t=+t,r>>>=0,a||z(e,t,r,8),n.write(e,t,r,i,52,8),r+8}t.prototype.slice=function(e,r){var i=this.length;(e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(r=void 0===r?i:~~r)<0?(r+=i)<0&&(r=0):r>i&&(r=i),r<e&&(r=e);var n=this.subarray(e,r);return Object.setPrototypeOf(n,t.prototype),n},t.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i},t.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},t.prototype.readUInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),this[e]},t.prototype.readUInt16LE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUInt16BE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},t.prototype.readUInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},t.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var i=t,n=1,a=this[e+--i];i>0&&(n*=256);)a+=this[e+--i]*n;return a>=(n*=128)&&(a-=Math.pow(2,8*t)),a},t.prototype.readInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},t.prototype.readInt16LE=function(e,t){e>>>=0,t||F(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt16BE=function(e,t){e>>>=0,t||F(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,t){return e>>>=0,t||F(e,4,this.length),n.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,t){return e>>>=0,t||F(e,4,this.length),n.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,t){return e>>>=0,t||F(e,8,this.length),n.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,t){return e>>>=0,t||F(e,8,this.length),n.read(this,e,!1,52,8)},t.prototype.writeUIntLE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||N(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,a=0;for(this[t]=255&e;++a<r&&(n*=256);)this[t+a]=e/n&255;return t+r},t.prototype.writeUIntBE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||N(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,a=1;for(this[t+n]=255&e;--n>=0&&(a*=256);)this[t+n]=e/a&255;return t+r},t.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,255,0),this[t]=255&e,t+1},t.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},t.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);N(this,e,t,r,n-1,-n)}var a=0,s=1,o=0;for(this[t]=255&e;++a<r&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},t.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);N(this,e,t,r,n-1,-n)}var a=r-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},t.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},t.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},t.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeFloatLE=function(e,t,r){return H(this,e,t,!0,r)},t.prototype.writeFloatBE=function(e,t,r){return H(this,e,t,!1,r)},t.prototype.writeDoubleLE=function(e,t,r){return G(this,e,t,!0,r)},t.prototype.writeDoubleBE=function(e,t,r){return G(this,e,t,!1,r)},t.prototype.copy=function(e,r,i,n){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);var a=n-i;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,i,n);else if(this===e&&i<r&&r<n)for(var s=a-1;s>=0;--s)e[s+r]=this[s+i];else Uint8Array.prototype.set.call(e,this.subarray(i,n),r);return a},t.prototype.fill=function(e,r,i,n){if("string"==typeof e){if("string"==typeof r?(n=r,r=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!t.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var a=e.charCodeAt(0);("utf8"===n&&a<128||"latin1"===n)&&(e=a)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;var s;if(r>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=r;s<i;++s)this[s]=e;else{var o=t.isBuffer(e)?e:t.from(e,n),c=o.length;if(0===c)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-r;++s)this[s+r]=o[s%c]}return this};var W=/[^+/0-9A-Za-z-_]/g;function Y(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function X(e,t){var r;t=t||1/0;for(var i=e.length,n=null,a=[],s=0;s<i;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&a.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&a.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function V(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function q(e,t){for(var r,i,n,a=[],s=0;s<e.length&&!((t-=2)<0);++s)i=(r=e.charCodeAt(s))>>8,n=r%256,a.push(n),a.push(i);return a}function Z(e){return i.toByteArray(Y(e))}function K(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Q(e){return e!=e}var $=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)t[i+n]=e[r]+e[n];return t}()}).call(this,e("buffer").Buffer)},{"base64-js":29,buffer:48,ieee754:73}],49:[function(e,t,r){var i=e("buffer").Buffer;t.exports=function(e,t){if(i.isBuffer(e)&&i.isBuffer(t)){if("function"==typeof e.equals)return e.equals(t);if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}}},{buffer:48}],50:[function(e,t,r){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],51:[function(e,t,r){(function(e){function t(e){return Array.isArray?Array.isArray(e):"[object Array]"===b(e)}function i(e){return"boolean"==typeof e}function n(e){return null===e}function a(e){return null==e}function s(e){return"number"==typeof e}function o(e){return"string"==typeof e}function c(e){return"symbol"===_(e)}function l(e){return void 0===e}function u(e){return"[object RegExp]"===b(e)}function h(e){return"object"===_(e)&&null!==e}function f(e){return"[object Date]"===b(e)}function d(e){return"[object Error]"===b(e)||e instanceof Error}function p(e){return"function"==typeof e}function m(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===_(e)||void 0===e}function b(e){return Object.prototype.toString.call(e)}r.isArray=t,r.isBoolean=i,r.isNull=n,r.isNullOrUndefined=a,r.isNumber=s,r.isString=o,r.isSymbol=c,r.isUndefined=l,r.isRegExp=u,r.isObject=h,r.isDate=f,r.isError=d,r.isFunction=p,r.isPrimitive=m,r.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":76}],52:[function(e,t,r){var i=Object.create||C,n=Object.keys||U,a=Function.prototype.bind||E;function s(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=i(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0;var o,c=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),o=0===l.x}catch(T){o=!1}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,r){if(t)e.call(r);else for(var i=e.length,n=k(e,i),a=0;a<i;++a)n[a].call(r)}function f(e,t,r,i){if(t)e.call(r,i);else for(var n=e.length,a=k(e,n),s=0;s<n;++s)a[s].call(r,i)}function d(e,t,r,i,n){if(t)e.call(r,i,n);else for(var a=e.length,s=k(e,a),o=0;o<a;++o)s[o].call(r,i,n)}function p(e,t,r,i,n,a){if(t)e.call(r,i,n,a);else for(var s=e.length,o=k(e,s),c=0;c<s;++c)o[c].call(r,i,n,a)}function m(e,t,r,i){if(t)e.apply(r,i);else for(var n=e.length,a=k(e,n),s=0;s<n;++s)a[s].apply(r,i)}function b(e,t,r,n){var a,s,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]):(s=e._events=i(null),e._eventsCount=0),o){if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),!o.warned&&(a=u(e))&&a>0&&o.length>a){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,"object"===("undefined"==typeof console?"undefined":_(console))&&console.warn&&console.warn("%s: %s",c.name,c.message)}}else o=s[t]=r,++e._eventsCount;return e}function v(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function g(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=a.call(v,i);return n.listener=r,i.wrapFn=n,n}function y(e,t,r){var i=e._events;if(!i)return[];var n=i[t];return n?"function"==typeof n?r?[n.listener||n]:[n]:r?S(n):k(n,n.length):[]}function w(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function x(e,t){for(var r=t,i=r+1,n=e.length;i<n;r+=1,i+=1)e[r]=e[i];e.pop()}function k(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}function S(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function C(e){var t=function(){};return t.prototype=e,new t}function U(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t);return t}function E(e){var t=this;return function(){return t.apply(e,arguments)}}o?Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');c=e}}):s.defaultMaxListeners=c,s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){var t,r,i,n,a,s,o="error"===e;if(s=this._events)o=o&&null==s.error;else if(!o)return!1;if(o){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var c=new Error('Unhandled "error" event. ('+t+")");throw c.context=t,c}if(!(r=s[e]))return!1;var l="function"==typeof r;switch(i=arguments.length){case 1:h(r,l,this);break;case 2:f(r,l,this,arguments[1]);break;case 3:d(r,l,this,arguments[1],arguments[2]);break;case 4:p(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(n=new Array(i-1),a=1;a<i;a++)n[a-1]=arguments[a];m(r,l,this,n)}return!0},s.prototype.addListener=function(e,t){return b(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return b(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,g(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,g(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,a,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=i(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(a=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,a=s;break}if(a<0)return this;0===a?r.shift():x(r,a),1===r.length&&(n[e]=r[0]),n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.removeAllListeners=function(e){var t,r,a;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=i(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=i(null):delete r[e]),this;if(0===arguments.length){var s,o=n(r);for(a=0;a<o.length;++a)"removeListener"!==(s=o[a])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=i(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this},s.prototype.listeners=function(e){return y(this,e,!0)},s.prototype.rawListeners=function(e){return y(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):w.call(e,t)},s.prototype.listenerCount=w,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],53:[function(e,t,r){var i=e("./lib/parser");function n(){return(0,eval)("this")}t.exports={create:function(t,r){if(t instanceof(r=r||n()).ArrayBuffer){var a=e("./lib/dom-bufferstream");return new i(new a(t,0,t.byteLength,!0,r))}var s=e("./lib/bufferstream");return new i(new s(t,0,t.length,!0))}}},{"./lib/bufferstream":54,"./lib/dom-bufferstream":56,"./lib/parser":60}],54:[function(e,t,r){function i(e,t,r,i){this.buffer=e,this.offset=t||0,r="number"==typeof r?r:e.length,this.endPosition=this.offset+r,this.setBigEndian(i)}i.prototype={setBigEndian:function(e){this.bigEndian=!!e},nextUInt8:function(){var e=this.buffer.readUInt8(this.offset);return this.offset+=1,e},nextInt8:function(){var e=this.buffer.readInt8(this.offset);return this.offset+=1,e},nextUInt16:function(){var e=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,e},nextUInt32:function(){var e=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,e},nextInt16:function(){var e=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,e},nextInt32:function(){var e=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,e},nextFloat:function(){var e=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,e},nextDouble:function(){var e=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,e},nextBuffer:function(e){var t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},remainingLength:function(){return this.endPosition-this.offset},nextString:function(e){var t=this.buffer.toString("utf8",this.offset,this.offset+e);return this.offset+=e,t},mark:function(){var e=this;return{openWithOffset:function(t){return t=(t||0)+this.offset,new i(e.buffer,t,e.endPosition-t,e.bigEndian)},offset:this.offset}},offsetFrom:function(e){return this.offset-e.offset},skip:function(e){this.offset+=e},branch:function(e,t){return t="number"==typeof t?t:this.endPosition-(this.offset+e),new i(this.buffer,this.offset+e,t,this.bigEndian)}},t.exports=i},{}],55:[function(e,t,r){function i(e){return parseInt(e,10)}var n=3600,a=60;function s(e,t){e=e.map(i),t=t.map(i);var r=e[0],n=e[1]-1,a=e[2],s=t[0],o=t[1],c=t[2];return Date.UTC(r,n,a,s,o,c,0)/1e3}function o(e){var t=e.substr(0,10).split("-"),r=e.substr(11,8).split(":"),o=e.substr(19,6).split(":").map(i),c=o[0]*n+o[1]*a,l=s(t,r);if("number"==typeof(l-=c)&&!isNaN(l))return l}function c(e){var t=e.split(" "),r=s(t[0].split(":"),t[1].split(":"));if("number"==typeof r&&!isNaN(r))return r}function l(e){var t=19===e.length&&":"===e.charAt(4);return 25===e.length&&"T"===e.charAt(10)?o(e):t?c(e):void 0}t.exports={parseDateWithSpecFormat:c,parseDateWithTimezoneFormat:o,parseExifDate:l}},{}],56:[function(e,t,r){function i(e,t,r,i,n,a){this.global=n,t=t||0,r=r||e.byteLength-t,this.arrayBuffer=e.slice(t,t+r),this.view=new n.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(i),this.offset=0,this.parentOffset=(a||0)+t}i.prototype={setBigEndian:function(e){this.littleEndian=!e},nextUInt8:function(){var e=this.view.getUint8(this.offset);return this.offset+=1,e},nextInt8:function(){var e=this.view.getInt8(this.offset);return this.offset+=1,e},nextUInt16:function(){var e=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,e},nextUInt32:function(){var e=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},nextInt16:function(){var e=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},nextInt32:function(){var e=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},nextFloat:function(){var e=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},nextDouble:function(){var e=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},nextBuffer:function(e){var t=this.arrayBuffer.slice(this.offset,this.offset+e);return this.offset+=e,t},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(e){var t=this.arrayBuffer.slice(this.offset,this.offset+e);return t=String.fromCharCode.apply(null,new this.global.Uint8Array(t)),this.offset+=e,t},mark:function(){var e=this;return{openWithOffset:function(t){return t=(t||0)+this.offset,new i(e.arrayBuffer,t,e.arrayBuffer.byteLength-t,!e.littleEndian,e.global,e.parentOffset)},offset:this.offset,getParentOffset:function(){return e.parentOffset}}},offsetFrom:function(e){return this.parentOffset+this.offset-(e.offset+e.getParentOffset())},skip:function(e){this.offset+=e},branch:function(e,t){return t="number"==typeof t?t:this.arrayBuffer.byteLength-(this.offset+e),new i(this.arrayBuffer,this.offset+e,t,!this.littleEndian,this.global,this.parentOffset)}},t.exports=i},{}],57:[function(e,t,r){t.exports={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}}},{}],58:[function(e,t,r){function i(e,t){switch(e){case 1:return t.nextUInt8();case 3:case 8:return t.nextUInt16();case 4:case 9:return t.nextUInt32();case 5:return[t.nextUInt32(),t.nextUInt32()];case 6:return t.nextInt8();case 10:return[t.nextInt32(),t.nextInt32()];case 11:return t.nextFloat();case 12:return t.nextDouble();default:throw new Error("Invalid format while decoding: "+e)}}function n(e){switch(e){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function a(e,t){var r,a,s=t.nextUInt16(),o=t.nextUInt16(),c=n(o),l=t.nextUInt32(),u=c*l;if(u>4&&(t=e.openWithOffset(t.nextUInt32())),2===o){var h=(r=t.nextString(l)).indexOf("\0");-1!==h&&(r=r.substr(0,h))}else if(7===o)r=t.nextBuffer(l);else if(0!==o)for(r=[],a=0;a<l;++a)r.push(i(o,t));return u<4&&t.skip(4-u),[s,r,o]}function s(e,t,r){var i,n,s=t.nextUInt16();for(n=0;n<s;++n)r((i=a(e,t))[0],i[1],i[2])}function o(e){if("Exif\0\0"!==e.nextString(6))throw new Error("Invalid EXIF header");var t=e.mark(),r=e.nextUInt16();if(18761===r)e.setBigEndian(!1);else{if(19789!==r)throw new Error("Invalid TIFF header");e.setBigEndian(!0)}if(42!==e.nextUInt16())throw new Error("Invalid TIFF data");return t}t.exports={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(e,t){var r,i,n,a;try{r=o(e)}catch(b){return!1}var c=r.openWithOffset(e.nextUInt32()),l=this.IFD0;s(r,c,(function(e,r,a){switch(e){case 34853:n=r[0];break;case 34665:i=r[0];break;default:t(l,e,r,a)}}));var u=c.nextUInt32();if(0!==u){var h=r.openWithOffset(u);s(r,h,t.bind(null,this.IFD1))}if(n){var f=r.openWithOffset(n);s(r,f,t.bind(null,this.GPSIFD))}if(i){var d=r.openWithOffset(i),p=this.InteropIFD;s(r,d,(function(e,r,i){40965===e?a=r[0]:t(p,e,r,i)}))}if(a){var m=r.openWithOffset(a);s(r,m,t.bind(null,this.InteropIFD))}return!0}}},{}],59:[function(e,t,r){t.exports={parseSections:function(e,t){var r,i;for(e.setBigEndian(!0);e.remainingLength()>0&&218!==i;){if(255!==e.nextUInt8())throw new Error("Invalid JPEG section offset");r=(i=e.nextUInt8())>=208&&i<=217||218===i?0:e.nextUInt16()-2,t(i,e.branch(0,r)),e.skip(r)}},getSizeFromSOFSection:function(e){return e.skip(1),{height:e.nextUInt16(),width:e.nextUInt16()}},getSectionName:function(e){var t,r;switch(e){case 216:t="SOI";break;case 196:t="DHT";break;case 219:t="DQT";break;case 221:t="DRI";break;case 218:t="SOS";break;case 254:t="COM";break;case 217:t="EOI";break;default:e>=224&&e<=239?(t="APP",r=e-224):e>=192&&e<=207&&196!==e&&200!==e&&204!==e?(t="SOF",r=e-192):e>=208&&e<=215&&(t="RST",r=e-208)}var i={name:t};return"number"==typeof r&&(i.index=r),i}}},{}],60:[function(e,t,r){var i=e("./jpeg"),n=e("./exif"),a=e("./simplify");function s(e,t,r,i,n,a,s){this.startMarker=e,this.tags=t,this.imageSize=r,this.thumbnailOffset=i,this.thumbnailLength=n,this.thumbnailType=a,this.app1Offset=s}function o(e){this.stream=e,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}s.prototype={hasThumbnail:function(e){return!(!this.thumbnailOffset||!this.thumbnailLength||"string"==typeof e&&("image/jpeg"===e.toLowerCase().trim()?6!==this.thumbnailType:"image/tiff"!==e.toLowerCase().trim()||1!==this.thumbnailType))},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var e,t=this._getThumbnailStream();return i.parseSections(t,(function(t,r){"SOF"===i.getSectionName(t).name&&(e=i.getSizeFromSOFSection(r))})),e}},o.prototype={enableBinaryFields:function(e){return this.flags.readBinaryTags=!!e,this},enablePointers:function(e){return this.flags.hidePointers=!e,this},enableTagNames:function(e){return this.flags.resolveTagNames=!!e,this},enableImageSize:function(e){return this.flags.imageSize=!!e,this},enableReturnTags:function(e){return this.flags.returnTags=!!e,this},enableSimpleValues:function(e){return this.flags.simplifyValues=!!e,this},parse:function(){var t,r,o,c,l,u,h,f,d,p=this.stream.mark(),m=p.openWithOffset(0),b=this.flags;return b.resolveTagNames&&(h=e("./exif-tags")),b.resolveTagNames?(t={},f=function(e){return t[e.name]},d=function(e,r){t[e.name]=r}):(t=[],f=function(e){var r;for(r=0;r<t.length;++r)if(t[r].type===e.type&&t[r].section===e.section)return t.value},d=function(e,r){var i;for(i=0;i<t.length;++i)if(t[i].type===e.type&&t[i].section===e.section)return void(t.value=r)}),i.parseSections(m,(function(e,s){var f=s.offsetFrom(p);225===e?n.parseTags(s,(function(e,r,i,s){if(b.readBinaryTags||7!==s){if(513===r){if(o=i[0],b.hidePointers)return}else if(514===r){if(c=i[0],b.hidePointers)return}else if(259===r&&(l=i[0],b.hidePointers))return;if(b.returnTags)if(b.simplifyValues&&(i=a.simplifyValue(i,s)),b.resolveTagNames){var u=(e===n.GPSIFD?h.gps:h.exif)[r];u||(u=h.exif[r]),t.hasOwnProperty(u)||(t[u]=i)}else t.push({section:e,type:r,value:i})}}))&&(u=f):b.imageSize&&"SOF"===i.getSectionName(e).name&&(r=i.getSizeFromSOFSection(s))})),b.simplifyValues&&(a.castDegreeValues(f,d),a.castDateValues(f,d)),new s(p,t,r,o,c,l,u)}},t.exports=o},{"./exif":58,"./exif-tags":57,"./jpeg":59,"./simplify":61}],61:[function(e,t,r){var i=e("./exif"),n=e("./date"),a=[{section:i.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:i.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],s=[{section:i.SubIFD,type:306,name:"ModifyDate"},{section:i.SubIFD,type:36867,name:"DateTimeOriginal"},{section:i.SubIFD,type:36868,name:"CreateDate"},{section:i.SubIFD,type:306,name:"ModifyDate"}];t.exports={castDegreeValues:function(e,t){a.forEach((function(r){var i=e(r);if(i){var n=e({section:r.section,type:r.refType,name:r.refName})===r.posVal?1:-1,a=(i[0]+i[1]/60+i[2]/3600)*n;t(r,a)}}))},castDateValues:function(e,t){s.forEach((function(r){var i=e(r);if(i){var a=n.parseExifDate(i);void 0!==a&&t(r,a)}}))},simplifyValue:function(e,t){return Array.isArray(e)&&1===(e=e.map((function(e){return 10===t||5===t?e[0]/e[1]:e}))).length&&(e=e[0]),e}}},{"./date":55,"./exif":58}],62:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/toConsumableArray")),n=function(e){return(0,i.default)(e).map((function(e){return e.charCodeAt(0)}))},a=n("META-INF/mozilla.rsa"),s=n("[Content_Types].xml"),o=n("_rels/.rels");t.exports=function(e){var t=e instanceof Uint8Array?e:new Uint8Array(e);if(!(t&&t.length>1))return null;var r=function(e,r){r=Object.assign({offset:0},r);for(var i=0;i<e.length;i++)if(r.mask){if(e[i]!==(r.mask[i]&t[i+r.offset]))return!1}else if(e[i]!==t[i+r.offset])return!1;return!0},c=function(e,t){return r(n(e),t)};if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(r([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(r([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((r([73,73,42,0])||r([77,77,0,42]))&&r([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r([73,73,42,0])||r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(r([80,75,3,4])){if(r([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(r(a,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(c("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(c("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(c("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.findIndex((function(e,r,i){return r>=t&&80===i[r]&&75===i[r+1]&&3===i[r+2]&&4===i[r+3]}))},u=0,h=!1,f=null;do{var d=u+30;if(h||(h=r(s,{offset:d})||r(o,{offset:d})),f||(c("word/",{offset:d})?f={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:c("ppt/",{offset:d})?f={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:c("xl/",{offset:d})&&(f={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),h&&f)return f;u=l(t,d)}while(u>=0);if(f)return f}if(r([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(r([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(r([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([51,103,112,53])||r([0,0,0])&&r([102,116,121,112],{offset:4})&&(r([109,112,52,49],{offset:8})||r([109,112,52,50],{offset:8})||r([105,115,111,109],{offset:8})||r([105,115,111,50],{offset:8})||r([109,109,112,52],{offset:8})||r([77,52,86],{offset:8})||r([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(r([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(r([26,69,223,163])){var p=t.subarray(4,4100),m=p.findIndex((function(e,t,r){return 66===r[t]&&130===r[t+1]}));if(-1!==m){var b=m+3,v=function(e){return(0,i.default)(e).every((function(e,t){return p[b+t]===e.charCodeAt(0)}))};if(v("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(v("webm"))return{ext:"webm",mime:"video/webm"}}}if(r([0,0,0,20,102,116,121,112,113,116,32,32])||r([102,114,101,101],{offset:4})||r([102,116,121,112,113,116,32,32],{offset:4})||r([109,100,97,116],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(r([48,38,178,117,142,102,207,17,166,217]))return{ext:"wmv",mime:"video/x-ms-wmv"};if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(var g=0;g<2&&g<t.length-16;g++){if(r([73,68,51],{offset:g})||r([255,226],{offset:g,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([255,228],{offset:g,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([255,248],{offset:g,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([255,240],{offset:g,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(r([102,116,121,112,77,52,65],{offset:4})||r([77,52,65,32]))return{ext:"m4a",mime:"audio/mp4"};if(r([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(r([79,103,103,83]))return r([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:r([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:r([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:r([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:r([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(r([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(r([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(r([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(r([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(r([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===t[0]||70===t[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([119,79,70,70])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(r([119,79,70,50])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(r([37,33]))return{ext:"ps",mime:"application/postscript"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(r([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(r([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(r([77,83,67,70])||r([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(r([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(r([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(r([0,0,0,12,106,80,32,32,13,10,135,10])){if(r([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(r([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(r([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(r([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(r([70,79,82,77,0]))return{ext:"aif",mime:"audio/aiff"};if(c("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([102,116,121,112],{offset:4})){if(r([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(r([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(r([104,101,105,99],{offset:8})||r([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(r([104,101,118,99],{offset:8})||r([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return r([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:null}},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/toConsumableArray":20}],63:[function(e,t,r){var i=e("is-callable"),n=Object.prototype.toString,a=Object.prototype.hasOwnProperty,s=function(e,t,r){for(var i=0,n=e.length;i<n;i++)a.call(e,i)&&(null==r?t(e[i],i,e):t.call(r,e[i],i,e))},o=function(e,t,r){for(var i=0,n=e.length;i<n;i++)null==r?t(e.charAt(i),i,e):t.call(r,e.charAt(i),i,e)},c=function(e,t,r){for(var i in e)a.call(e,i)&&(null==r?t(e[i],i,e):t.call(r,e[i],i,e))},l=function(e,t,r){if(!i(t))throw new TypeError("iterator must be a function");var a;arguments.length>=3&&(a=r),"[object Array]"===n.call(e)?s(e,t,a):"string"==typeof e?o(e,t,a):c(e,t,a)};t.exports=l},{"is-callable":77}],64:[function(e,t,r){function i(e,t,r,i){var a=0,s=void 0===(i=void 0===i?{}:i).loop?null:i.loop,o=void 0===i.palette?null:i.palette;if(t<=0||r<=0||t>65535||r>65535)throw new Error("Width/Height invalid.");function c(e){var t=e.length;if(t<2||t>256||t&t-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return t}e[a++]=71,e[a++]=73,e[a++]=70,e[a++]=56,e[a++]=57,e[a++]=97;var l=0,u=0;if(null!==o){for(var h=c(o);h>>=1;)++l;if(h=1<<l,--l,void 0!==i.background){if((u=i.background)>=h)throw new Error("Background index out of range.");if(0===u)throw new Error("Background index explicitly passed as 0.")}}if(e[a++]=255&t,e[a++]=t>>8&255,e[a++]=255&r,e[a++]=r>>8&255,e[a++]=(null!==o?128:0)|l,e[a++]=u,e[a++]=0,null!==o)for(var f=0,d=o.length;f<d;++f){var p=o[f];e[a++]=p>>16&255,e[a++]=p>>8&255,e[a++]=255&p}if(null!==s){if(s<0||s>65535)throw new Error("Loop count invalid.");e[a++]=33,e[a++]=255,e[a++]=11,e[a++]=78,e[a++]=69,e[a++]=84,e[a++]=83,e[a++]=67,e[a++]=65,e[a++]=80,e[a++]=69,e[a++]=50,e[a++]=46,e[a++]=48,e[a++]=3,e[a++]=1,e[a++]=255&s,e[a++]=s>>8&255,e[a++]=0}var m=!1;this.addFrame=function(t,r,i,s,l,u){if(!0===m&&(--a,m=!1),u=void 0===u?{}:u,t<0||r<0||t>65535||r>65535)throw new Error("x/y invalid.");if(i<=0||s<=0||i>65535||s>65535)throw new Error("Width/Height invalid.");if(l.length<i*s)throw new Error("Not enough pixels for the frame size.");var h=!0,f=u.palette;if(null==f&&(h=!1,f=o),null==f)throw new Error("Must supply either a local or global palette.");for(var d=c(f),p=0;d>>=1;)++p;d=1<<p;var b=void 0===u.delay?0:u.delay,v=void 0===u.disposal?0:u.disposal;if(v<0||v>3)throw new Error("Disposal out of range.");var g=!1,y=0;if(void 0!==u.transparent&&null!==u.transparent&&(g=!0,(y=u.transparent)<0||y>=d))throw new Error("Transparent color index.");if((0!==v||g||0!==b)&&(e[a++]=33,e[a++]=249,e[a++]=4,e[a++]=v<<2|(!0===g?1:0),e[a++]=255&b,e[a++]=b>>8&255,e[a++]=y,e[a++]=0),e[a++]=44,e[a++]=255&t,e[a++]=t>>8&255,e[a++]=255&r,e[a++]=r>>8&255,e[a++]=255&i,e[a++]=i>>8&255,e[a++]=255&s,e[a++]=s>>8&255,e[a++]=!0===h?128|p-1:0,!0===h)for(var _=0,w=f.length;_<w;++_){var x=f[_];e[a++]=x>>16&255,e[a++]=x>>8&255,e[a++]=255&x}return a=n(e,a,p<2?2:p,l)},this.end=function(){return!1===m&&(e[a++]=59,m=!0),a},this.getOutputBuffer=function(){return e},this.setOutputBuffer=function(t){e=t},this.getOutputBufferPosition=function(){return a},this.setOutputBufferPosition=function(e){a=e}}function n(e,t,r,i){e[t++]=r;var n=t++,a=1<<r,s=a-1,o=a+1,c=o+1,l=r+1,u=0,h=0;function f(r){for(;u>=r;)e[t++]=255&h,h>>=8,u-=8,t===n+256&&(e[n]=255,n=t++)}function d(e){h|=e<<u,u+=l,f(8)}var p=i[0]&s,m={};d(a);for(var b=1,v=i.length;b<v;++b){var g=i[b]&s,y=p<<8|g,_=m[y];if(void 0===_){for(h|=p<<u,u+=l;u>=8;)e[t++]=255&h,h>>=8,u-=8,t===n+256&&(e[n]=255,n=t++);4096===c?(d(a),c=o+1,l=r+1,m={}):(c>=1<<l&&++l,m[y]=c++),p=g}else p=_}return d(p),d(o),f(1),n+1===t?e[n]=0:(e[n]=t-n-1,e[t++]=0),t}function a(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,i=e[t++]|e[t++]<<8,n=e[t++],a=n>>7,o=1<<1+(7&n);e[t++],e[t++];var c=null,l=null;a&&(c=t,l=o,t+=3*o);var u=!0,h=[],f=0,d=null,p=0,m=null;for(this.width=r,this.height=i;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(0===T)break;t+=T}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var b=e[t++];f=e[t++]|e[t++]<<8,d=e[t++],0==(1&b)&&(d=null),p=b>>2&7,t++;break;case 254:for(;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(0===T)break;t+=T}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var v=e[t++]|e[t++]<<8,g=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,w=e[t++],x=w>>6&1,k=1<<1+(7&w),S=c,C=l,U=!1;w>>7&&(U=!0,S=t,C=k,t+=3*k);var E=t;for(t++;;){var T;if(!((T=e[t++])>=0))throw Error("Invalid block size");if(0===T)break;t+=T}h.push({x:v,y:g,width:y,height:_,has_local_palette:U,palette_offset:S,palette_size:C,data_offset:E,data_length:t-E,transparent_index:d,interlaced:!!x,delay:f,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return m},this.frameInfo=function(e){if(e<0||e>=h.length)throw new Error("Frame index out of range.");return h[e]},this.decodeAndBlitFrameBGRA=function(t,i){var n=this.frameInfo(t),a=n.width*n.height,o=new Uint8Array(a);s(e,n.data_offset,o,a);var c=n.palette_offset,l=n.transparent_index;null===l&&(l=256);var u=n.width,h=r-u,f=u,d=4*(n.y*r+n.x),p=4*((n.y+n.height)*r+n.x),m=d,b=4*h;!0===n.interlaced&&(b+=4*r*7);for(var v=8,g=0,y=o.length;g<y;++g){var _=o[g];if(0===f&&(f=u,(m+=b)>=p&&(b=4*h+4*r*(v-1),m=d+(u+h)*(v<<1),v>>=1)),_===l)m+=4;else{var w=e[c+3*_],x=e[c+3*_+1],k=e[c+3*_+2];i[m++]=k,i[m++]=x,i[m++]=w,i[m++]=255}--f}},this.decodeAndBlitFrameRGBA=function(t,i){var n=this.frameInfo(t),a=n.width*n.height,o=new Uint8Array(a);s(e,n.data_offset,o,a);var c=n.palette_offset,l=n.transparent_index;null===l&&(l=256);var u=n.width,h=r-u,f=u,d=4*(n.y*r+n.x),p=4*((n.y+n.height)*r+n.x),m=d,b=4*h;!0===n.interlaced&&(b+=4*r*7);for(var v=8,g=0,y=o.length;g<y;++g){var _=o[g];if(0===f&&(f=u,(m+=b)>=p&&(b=4*h+4*r*(v-1),m=d+(u+h)*(v<<1),v>>=1)),_===l)m+=4;else{var w=e[c+3*_],x=e[c+3*_+1],k=e[c+3*_+2];i[m++]=w,i[m++]=x,i[m++]=k,i[m++]=255}--f}}}function s(e,t,r,i){for(var n=e[t++],a=1<<n,s=a+1,o=s+1,c=n+1,l=(1<<c)-1,u=0,h=0,f=0,d=e[t++],p=new Int32Array(4096),m=null;;){for(;u<16&&0!==d;)h|=e[t++]<<u,u+=8,1===d?d=e[t++]:--d;if(u<c)break;var b=h&l;if(h>>=c,u-=c,b!==a){if(b===s)break;for(var v=b<o?b:m,g=0,y=v;y>a;)y=p[y]>>8,++g;var _=y;if(f+g+(v!==b?1:0)>i)return void console.log("Warning, gif stream longer than expected.");r[f++]=_;var w=f+=g;for(v!==b&&(r[f++]=_),y=v;g--;)y=p[y],r[--w]=255&y,y>>=8;null!==m&&o<4096&&(p[o++]=m<<8|_,o>=l+1&&c<12&&(++c,l=l<<1|1)),m=b}else o=s+1,l=(1<<(c=n+1))-1,m=null}return f!==i&&console.log("Warning, gif stream shorter than expected."),r}try{r.GifWriter=i,r.GifReader=a}catch(o){}},{}],65:[function(e,t,r){(function(e){var r=function(){function t(){if(f(this,t),0===arguments.length)throw new Error("constructor requires parameters");var r=arguments.length<=0?void 0:arguments[0];if(null!==r&&"object"===_(r))if(r instanceof t){var i=r.bitmap;this.bitmap={width:i.width,height:i.height,data:new e(i.width*i.height*4)},i.data.copy(this.bitmap.data)}else{if(!(r.width&&r.height&&r.data))throw new Error("unrecognized constructor parameters");this.bitmap=r}else{if("number"!=typeof r||"number"!=typeof(arguments.length<=1?void 0:arguments[1]))throw new Error("unrecognized constructor parameters");var n=r,a=arguments.length<=1?void 0:arguments[1],s=arguments.length<=2?void 0:arguments[2];this.bitmap={width:n,height:a},e.isBuffer(s)?this.bitmap.data=s:(this.bitmap.data=new e(n*a*4),"number"==typeof s&&this.fillRGBA(s))}}return p(t,[{key:"blit",value:function(e,t,r,i,n,a,s){if(i+a>this.bitmap.width)throw new Error("copy exceeds width of source bitmap");if(t+a>e.bitmap.width)throw new Error("copy exceeds width of target bitmap");if(n+s>this.bitmap.height)throw new Error("copy exceeds height of source bitmap");if(r+s>e.bitmap.height)throw new Erro("copy exceeds height of target bitmap");for(var o=this.bitmap.data,c=e.bitmap.data,l=4*this.bitmap.width,u=4*e.bitmap.width,h=4*a,f=n*l+4*i,d=r*u+4*t;--s>=0;)o.copy(c,d,f,f+h),f+=l,d+=u;return this}},{key:"fillRGBA",value:function(e){for(var t=this.bitmap.data,r=4*this.bitmap.height,i=0;i<r;)t.writeUInt32BE(e,i),i+=4;for(;i<t.length;)t.copy(t,i,0,r),i+=r;return this}},{key:"getRGBA",value:function(e,t){var r=4*(t*this.bitmap.width+e);return this.bitmap.data.readUInt32BE(r)}},{key:"getRGBASet",value:function(){for(var e=new Set,t=this.bitmap.data,r=0;r<t.length;r+=4)e.add(t.readUInt32BE(r,!0));return e}},{key:"greyscale",value:function(){var e=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,(function(t,r,i){var n=Math.round(.299*e[i]+.587*e[i+1]+.114*e[i+2]);e[i]=n,e[i+1]=n,e[i+2]=n})),this}},{key:"reframe",value:function(e,r,i,n,a){var s,o=e<0?0:e,c=r<0?0:r,l=i+o>this.bitmap.width?this.bitmap.width-o:i,u=n+c>this.bitmap.height?this.bitmap.height-c:n,h=e<0?-e:0,f=r<0?-r:0;if(void 0===a){if(o!==e||c!=r||l!==i||u!==n)throw new GifError("fillRGBA required for this reframing");s=new t(i,n)}else s=new t(i,n,a);return this.blit(s,h,f,o,c,l,u),this.bitmap=s.bitmap,this}},{key:"scale",value:function(t){if(1!==t){if(!Number.isInteger(t)||t<1)throw new Error("the scale must be an integer >= 1");for(var r,i=this.bitmap.width,n=this.bitmap.height,a=i*t*4,s=this.bitmap.data,o=new e(n*a*t),c=0,l=0,u=0;u<n;++u){r=l;for(var h=0;h<i;++h){for(var f=s.readUInt32BE(c,!0),d=0;d<t;++d)o.writeUInt32BE(f,l),l+=4;c+=4}for(var p=1;p<t;++p)o.copy(o,l,r,l),l+=a,r+=a}return this.bitmap={width:i*t,height:n*t,data:o},this}}},{key:"scanAllCoords",value:function(e){for(var t=this.bitmap.width,r=this.bitmap.data.length,i=0,n=0,a=0;a<r;a+=4)e(i,n,a),++i===t&&(i=0,++n)}},{key:"scanAllIndexes",value:function(e){for(var t=this.bitmap.data.length,r=0;r<t;r+=4)e(r)}}]),t}();t.exports=r}).call(this,e("buffer").Buffer)},{buffer:48}],66:[function(e,t,r){var a=p((function e(t,r,i){f(this,e),this.width=i.width,this.height=i.height,this.loops=i.loops,this.usesTransparency=i.usesTransparency,this.colorScope=i.colorScope,this.frames=r,this.buffer=t}));a.GlobalColorsPreferred=0,a.GlobalColorsOnly=1,a.LocalColorsOnly=2;var o=function(e){i(r,e);var t=n(r);function r(e){var i;return f(this,r),i=t.call(this,e),e instanceof Error&&(i.stack="Gif"+e.stack),i}return p(r)}(s(Error));r.Gif=a,r.GifError=o},{}],67:[function(e,t,r){(function(t,i){var n,a=e("omggif"),s=e("./gif"),o=s.Gif,c=s.GifError;t.nextTick((function(){n=e("./gifutil")}));var l=e("./gifframe").GifFrame,u=200,h=100,d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,e),this._transparentRGB=null,"number"==typeof t.transparentRGB&&0!==t.transparentRGB&&(this._transparentRGBA=256*t.transparentRGB),this._testInitialBufferSize=0}return p(e,[{key:"decodeGif",value:function(e){try{var t;try{t=new a.GifReader(e)}catch(u){throw new c(u)}for(var r=t.numFrames(),i=[],n={width:t.width,height:t.height,loops:t.loopCount(),usesTransparency:!1},s=0;s<r;++s){var l=this._decodeFrame(t,s,n.usesTransparency);i.push(l.frame),l.usesTransparency&&(n.usesTransparency=!0)}return Promise.resolve(new o(e,i,n))}catch(u){return Promise.reject(u)}}},{key:"encodeGif",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(null===e||0===e.length)throw new c("there are no frames");var r=n.getMaxDimensions(e);return(t=Object.assign({},t)).width=r.maxWidth,t.height=r.maxHeight,t.loops=t.loops||0,t.colorScope=t.colorScope||o.GlobalColorsPreferred,Promise.resolve(this._encodeGif(e,t))}catch(i){return Promise.reject(i)}}},{key:"_decodeFrame",value:function(e,t,r){var n,a;try{if(n=e.frameInfo(t),a=new i(e.width*e.height*4),e.decodeAndBlitFrameRGBA(t,a),n.width!==e.width||n.height!==e.height){if(n.y&&(a=a.slice(n.y*e.width*4)),e.width>n.width)for(var s=0;s<n.height;++s)a.copy(a,s*n.width*4,4*(n.x+s*e.width),4*(n.x+s*e.width)+4*n.width);a=a.slice(0,n.width*n.height*4)}}catch(f){throw new c(f)}var o=!1;if(null===this._transparentRGBA){if(!r)for(var u=3;u<a.length;u+=4)0===a[u]&&(o=!0,u=a.length)}else for(var h=3;h<a.length;h+=4)0===a[h]&&(a.writeUInt32BE(this._transparentRGBA,h-3),o=!0);return{frame:new l(n.width,n.height,a,{xOffset:n.x,yOffset:n.y,disposalMethod:n.disposal,interlaced:n.interlaced,delayCentisecs:n.delay}),usesTransparency:o}}},{key:"_encodeGif",value:function(e,t){var r;if(t.colorScope===o.LocalColorsOnly)r=n.getColorInfo(e,0);else if(!(r=n.getColorInfo(e,256)).colors){if(t.colorScope===o.GlobalColorsOnly)throw new c("Too many color indexes for global color table");t.colorScope=o.LocalColorsOnly}t.usesTransparency=r.usesTransparency;var i=r.palettes;return t.colorScope===o.LocalColorsOnly?g(e,t,2e3,i):v(e,t,2e3,r)}},{key:"_getSizeEstimateGlobal",value:function(e,t){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;var r=u+768,i=x(e);return t.forEach((function(e){r+=_(e,i)})),r}},{key:"_getSizeEstimateLocal",value:function(e,t){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;for(var r=u,i=0;i<t.length;++i){var n=x(e[i]);r+=_(t[i],n)}return r}}]),e}();function m(e,t){var r=e.indexOf(t);return-1===r?null:r}function b(e,t){for(var r,i=0,n=e.length-1;i<=n;)if(e[r=Math.floor((i+n)/2)]>t)n=r-1;else{if(!(e[r]<t))return r;i=r+1}return null}function v(e,t,r,n){var s={colors:n.colors.slice(),usesTransparency:n.usesTransparency};y(s);var l,u={palette:s.colors,loop:t.loops},h=new i(r);try{l=new a.GifWriter(h,t.width,t.height,u)}catch(d){throw new c(d)}for(var f=0;f<e.length;++f)h=k(l,f,e[f],n,!1);return new o(h.slice(0,l.end()),e,t)}function g(e,t,r,n){var s,l={loop:t.loops},u=new i(r);try{s=new a.GifWriter(u,t.width,t.height,l)}catch(f){throw new c(f)}for(var h=0;h<e.length;++h)u=k(s,h,e[h],n[h],!0);return new o(u.slice(0,s.end()),e,t)}function y(e){var t=e.colors;e.usesTransparency&&t.push(0);for(var r=t.length,i=2;r>i;)i<<=1;t.length=i,t.fill(0,r)}function _(e,t){var r=e.bitmap.width*e.bitmap.height;return r=Math.ceil(r*t/8),r+=Math.ceil(r/255),h+r+768}function w(e,t,r){for(var n=r.colors,a=n.length<=8?m:b,s=t.bitmap.data,o=new i(s.length/4),l=n.length,u=0,h=0;u<s.length;){if(0!==s[u+3]){var f=s.readUInt32BE(u,!0)>>8&16777215;o[h]=a(n,f)}else o[h]=l;u+=4,++h}if(r.usesTransparency){if(256===l)throw new c("Frame ".concat(e," already has 256 colors")+"and so can't use transparency")}else l=null;return{buffer:o,transparentIndex:l}}function x(e){var t=e.indexCount,r=0;for(--t;t;)++r,t>>=1;return r>0?r:1}function k(e,t,r,n,a){if(r.interlaced)throw new c("writing interlaced GIFs is not supported");var s=w(t,r,n),o={delay:r.delayCentisecs,disposal:r.disposalMethod,transparent:s.transparentIndex};a&&(y(n),o.palette=n.colors);try{for(var l,u=e.getOutputBuffer(),h=e.getOutputBufferPosition(),f=!0;f;)if(l=e.addFrame(r.xOffset,r.yOffset,r.bitmap.width,r.bitmap.height,s.buffer,o),f=!1,l>=u.length-1){var d=new i(1.5*u.length);u.copy(d),e.setOutputBuffer(d),e.setOutputBufferPosition(h),u=d,f=!0}return u}catch(p){throw new c(p)}}r.GifCodec=d}).call(this,e("_process"),e("buffer").Buffer)},{"./gif":66,"./gifframe":68,"./gifutil":69,_process:133,buffer:48,omggif:64}],68:[function(e,t,r){var a=e("./bitmapimage");e("./gif");var s=function(e){i(r,e);var t=n(r);function r(){var e;f(this,r);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];if(e=t.call.apply(t,[this].concat(n)),n[0]instanceof r){var o=n[0];e.xOffset=o.xOffset,e.yOffset=o.yOffset,e.disposalMethod=o.disposalMethod,e.delayCentisecs=o.delayCentisecs,e.interlaced=o.interlaced}else{var c=n[n.length-1],l={};"object"!==_(c)||c instanceof a||(l=c),e.xOffset=l.xOffset||0,e.yOffset=l.yOffset||0,e.disposalMethod=void 0!==l.disposalMethod?l.disposalMethod:r.DisposeToBackgroundColor,e.delayCentisecs=l.delayCentisecs||8,e.interlaced=l.interlaced||!1}return e}return p(r,[{key:"getPalette",value:function(){for(var e=new Set,t=this.bitmap.data,r=0,i=!1;r<t.length;){if(0===t[r+3])i=!0;else{var n=t.readUInt32BE(r,!0)>>8&16777215;e.add(n)}r+=4}var a=new Array(e.size),s=e.values();for(r=0;r<a.length;++r)a[r]=s.next().value;a.sort((function(e,t){return e-t}));var o=a.length;return i&&++o,{colors:a,usesTransparency:i,indexCount:o}}}]),r}(a);s.DisposeToAnything=0,s.DisposeNothing=1,s.DisposeToBackgroundColor=2,s.DisposeToPrevious=3,r.GifFrame=s},{"./bitmapimage":65,"./gif":66}],69:[function(e,t,r){(function(t){var i=e("fs"),n=e("image-q"),a=e("./bitmapimage"),s=e("./gifframe").GifFrame,o=e("./gif").GifError,c=e("./gifcodec").GifCodec,l=[".jpg",".jpeg",".png",".bmp"],u=new c;function h(e,t,r,i,a){var s=Array.isArray(e)?e:[e];if(a){if(["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"].indexOf(a.ditherAlgorithm)<0)throw new Error("Invalid ditherAlgorithm '".concat(a.ditherAlgorithm,"'"));void 0===a.serpentine&&(a.serpentine=!0),void 0===a.minimumColorDistanceToDither&&(a.minimumColorDistanceToDither=0),void 0===a.calculateErrorLikeGIMP&&(a.calculateErrorLikeGIMP=!1)}var o,c=new n.distance.Euclidean,l=new n.palette[t](c,r,i);o=a?new n.image.ErrorDiffusionArray(c,n.image.ErrorDiffusionArrayKernel[a.ditherAlgorithm],a.serpentine,a.minimumColorDistanceToDither,a.calculateErrorLikeGIMP):new n.image.NearestColor(c);var u=[];s.forEach((function(e){for(var t=e.bitmap.data,r=new ArrayBuffer(t.length),i=new Uint32Array(r),a=0,s=0;a<t.length;a+=4,++s)i[s]=t.readUInt32LE(a,!0);var o=n.utils.PointContainer.fromUint32Array(i,e.bitmap.width,e.bitmap.height);l.sample(o),u.push(o)}));for(var h=l.quantize(),f=0;f<s.length;++f)for(var d=s[f].bitmap.data,p=o.quantize(u[f],h).toUint32Array(),m=0,b=0;m<d.length;m+=4,++b)d.writeUInt32LE(p[b],m)}function f(e){return new Promise((function(t,r){i.readFile(e,(function(e,i){return e?r(e):t(i)}))}))}function d(e,t){return new Promise((function(r,n){i.writeFile(e,t,(function(e){return e?n(e):r()}))}))}r.cloneFrames=function(e){var t=[];return e.forEach((function(e){t.push(new s(e))})),t},r.getColorInfo=function(e,t){for(var r=!1,i=[],n=0;n<e.length;++n){var a=e[n].getPalette();if(a.usesTransparency&&(r=!0),a.indexCount>256)throw new o("Frame ".concat(n," uses more than 256 color indexes"));i.push(a)}if(0===t)return{usesTransparency:r,palettes:i};var s=new Set;i.forEach((function(e){e.colors.forEach((function(e){s.add(e)}))}));var c=s.size;if(r&&++c,t&&c>t)return{usesTransparency:r,palettes:i};for(var l=new Array(s.size),u=s.values(),h=0;h<l.length;++h)l[h]=u.next().value;return l.sort((function(e,t){return e-t})),{colors:l,indexCount:c,usesTransparency:r,palettes:i}},r.copyAsJimp=function(e,t){return r.shareAsJimp(e,new a(t))},r.getMaxDimensions=function(e){var t=0,r=0;return e.forEach((function(e){var i=e.xOffset+e.bitmap.width;i>t&&(t=i);var n=e.yOffset+e.bitmap.height;n>r&&(r=n)})),{maxWidth:t,maxHeight:r}},r.quantizeDekker=function(e,t,r){h(e,"NeuQuantFloat",t=t||256,0,r)},r.quantizeSorokin=function(e,t,r,i){var n;switch(t=t||256,r=r||"min-pop"){case"min-pop":n=2;break;case"top-pop":n=1;break;default:throw new Error("Invalid quantizeSorokin histogram '".concat(r,"'"))}h(e,"RGBQuant",t,n,i)},r.quantizeWu=function(e,t,r,i){if(t=t||256,(r=r||5)<1||r>8)throw new Error("Invalid quantization quality");h(e,"WuQuant",t,r,i)},r.read=function(e,r){return r=r||u,t.isBuffer(e)?r.decodeGif(e):f(e).then((function(e){return r.decodeGif(e)}))},r.shareAsJimp=function(e,t){var r=new e(t.bitmap.width,t.bitmap.height,0);return r.bitmap.data=t.bitmap.data,r},r.write=function(e,t,r,i){i=i||u;var n=e.match(/\.[a-zA-Z]+$/);if(null!==n&&l.includes(n[0].toLowerCase()))throw new Error("GIF '".concat(e,"' has an unexpected suffix"));return i.encodeGif(t,r).then((function(t){return d(e,t.buffer).then((function(){return t}))}))}}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":76,"./bitmapimage":65,"./gif":66,"./gifcodec":67,"./gifframe":68,fs:47,"image-q":74}],70:[function(e,t,r){var i=e("./bitmapimage"),n=e("./gif"),a=n.Gif,s=n.GifError,o=e("./gifcodec").GifCodec,c=e("./gifframe").GifFrame,l=e("./gifutil");t.exports={BitmapImage:i,Gif:a,GifCodec:o,GifFrame:c,GifUtil:l,GifError:s}},{"./bitmapimage":65,"./gif":66,"./gifcodec":67,"./gifframe":68,"./gifutil":69}],71:[function(e,t,r){(function(e){var r;r=void 0!==a?a:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=r}).call(this,void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{}],72:[function(e,t,r){var i=e("http"),n=e("url"),a=t.exports;for(var s in i)i.hasOwnProperty(s)&&(a[s]=i[s]);function o(e){if("string"==typeof e&&(e=n.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}a.request=function(e,t){return e=o(e),i.request.call(this,e,t)},a.get=function(e,t){return e=o(e),i.get.call(this,e,t)}},{http:156,url:180}],73:[function(e,t,r){r.read=function(e,t,r,i,n){var a,s,o=8*n-i-1,c=(1<<o)-1,l=c>>1,u=-7,h=r?n-1:0,f=r?-1:1,d=e[t+h];for(h+=f,a=d&(1<<-u)-1,d>>=-u,u+=o;u>0;a=256*a+e[t+h],h+=f,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=i;u>0;s=256*s+e[t+h],h+=f,u-=8);if(0===a)a=1-l;else{if(a===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,i),a-=l}return(d?-1:1)*s*Math.pow(2,a-i)},r.write=function(e,t,r,i,n,a){var s,o,c,l=8*a-n-1,u=(1<<l)-1,h=u>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:a-1,p=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=u?(o=0,s=u):s+h>=1?(o=(t*c-1)*Math.pow(2,n),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;e[r+d]=255&o,d+=p,o/=256,n-=8);for(s=s<<n|o,l+=n;l>0;e[r+d]=255&s,d+=p,s/=256,l-=8);e[r+d-p]|=128*m}},{}],74:[function(e,t,r){!function(e,i){"object"===_(r)&&"object"===_(t)?t.exports=i():"object"===_(r)?r.iq=i():e.iq=i()}(this,(function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * iq.ts - Image Quantization Library
      		 */
var i=r(1);t.constants=i;var n=r(3);t.conversion=n;var a=r(12);t.distance=a;var s=r(20);t.palette=s;var o=r(30);t.image=o;var c=r(35);t.quality=c;var l=r(37);t.utils=l},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * constants.ts - part of Image Quantization Library
      		 */
var i=r(2);t.bt709=i},function(e,t){var r,i,n;!function(e){e[e.RED=.2126]="RED",e[e.GREEN=.7152]="GREEN",e[e.BLUE=.0722]="BLUE",e[e.WHITE=1]="WHITE"}(r||(r={})),t.Y=r,function(e){e[e.RED=.64]="RED",e[e.GREEN=.3]="GREEN",e[e.BLUE=.15]="BLUE",e[e.WHITE=.3127]="WHITE"}(i||(i={})),t.x=i,function(e){e[e.RED=.33]="RED",e[e.GREEN=.6]="GREEN",e[e.BLUE=.06]="BLUE",e[e.WHITE=.329]="WHITE"}(n||(n={})),t.y=n},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * iq.ts - Image Quantization Library
      		 */
var i=r(4);t.rgb2xyz=i.rgb2xyz;var n=r(5);t.rgb2hsl=n.rgb2hsl;var a=r(7);t.rgb2lab=a.rgb2lab;var s=r(9);t.lab2xyz=s.lab2xyz;var o=r(10);t.lab2rgb=o.lab2rgb;var c=r(8);t.xyz2lab=c.xyz2lab;var l=r(11);t.xyz2rgb=l.xyz2rgb},function(e,t){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * rgb2xyz.ts - part of Image Quantization Library
      		 */
function r(e){return e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92}function i(e,t,i){return{x:.4124*(e=r(e/255))+.3576*(t=r(t/255))+.1805*(i=r(i/255)),y:.2126*e+.7152*t+.0722*i,z:.0193*e+.1192*t+.9505*i}}t.rgb2xyz=i},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * rgb2hsl.ts - part of Image Quantization Library
      		 */
var i=r(6);function n(e,t,r){var n=i.min3(e,t,r),a=i.max3(e,t,r),s=a-n,o=(n+a)/510,c=0;o>0&&o<1&&(c=s/(o<.5?a+n:510-a-n));var l=0;return s>0&&(l=a===e?(t-r)/s:a===t?2+(r-e)/s:4+(e-t)/s,(l*=60)<0&&(l+=360)),{h:l,s:c,l:o}}t.rgb2hsl=n},function(e,t){function r(e){return e*(Math.PI/180)}function i(e,t,r){var i=e;return i<t&&(i=t),i<r&&(i=r),i}function n(e,t,r){var i=e;return i>t&&(i=t),i>r&&(i=r),i}function a(e,t,r){return e>r&&(e=r),e<t&&(e=t),0|e}function s(e){return(e=Math.round(e))>255?e=255:e<0&&(e=0),e}function o(e){return e>255?e=255:e<0&&(e=0),e}function c(e,t){var r,i=_(e[0]);if("number"===i||"string"===i){for(var n=Object.create(null),a=0,s=e.length;a<s;a++){var o=e[a];n[o]||0===n[o]||(n[o]=a)}r=e.sort((function(e,r){return t(e,r)||n[e]-n[r]}))}else{var c=e.slice(0);r=e.sort((function(e,r){return t(e,r)||c.indexOf(e)-c.indexOf(r)}))}return r}t.degrees2radians=r,t.max3=i,t.min3=n,t.intInRange=a,t.inRange0to255Rounded=s,t.inRange0to255=o,t.stableSort=c},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * rgb2lab.ts - part of Image Quantization Library
      		 */
var i=r(4),n=r(8);function a(e,t,r){var a=i.rgb2xyz(e,t,r);return n.xyz2lab(a.x,a.y,a.z)}t.rgb2lab=a},function(e,t){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * xyz2lab.ts - part of Image Quantization Library
      		 */
var r=.95047,i=1,n=1.08883;function a(e){return e>.008856?Math.pow(e,1/3):7.787*e+16/116}function s(e,t,s){if(e=a(e/r),t=a(t/i),s=a(s/n),116*t-16<0)throw new Error("xxx");return{L:Math.max(0,116*t-16),a:500*(e-t),b:200*(t-s)}}t.xyz2lab=s},function(e,t){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * lab2xyz.ts - part of Image Quantization Library
      		 */
var r=.95047,i=1,n=1.08883;function a(e){return e>.206893034?Math.pow(e,3):(e-16/116)/7.787}function s(e,t,s){var o=(e+16)/116,c=o-s/200;return{x:r*a(t/500+o),y:i*a(o),z:n*a(c)}}t.lab2xyz=s},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * lab2rgb.ts - part of Image Quantization Library
      		 */
var i=r(9),n=r(11);function a(e,t,r){var a=i.lab2xyz(e,t,r);return n.xyz2rgb(a.x,a.y,a.z)}t.lab2rgb=a},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * xyz2rgb.ts - part of Image Quantization Library
      		 */
var i=r(6);function n(e){return e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e}function a(e,t,r){var a=n(3.2406*e+-1.5372*t+-.4986*r),s=n(-.9689*e+1.8758*t+.0415*r),o=n(.0557*e+-.204*t+1.057*r);return{r:i.inRange0to255Rounded(255*a),g:i.inRange0to255Rounded(255*s),b:i.inRange0to255Rounded(255*o)}}t.xyz2rgb=a},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * iq.ts - Image Quantization Library
      		 */
var i=r(13);t.AbstractDistanceCalculator=i.AbstractDistanceCalculator;var n=r(14);t.CIE94Textiles=n.CIE94Textiles,t.CIE94GraphicArts=n.CIE94GraphicArts;var a=r(15);t.CIEDE2000=a.CIEDE2000;var s=r(16);t.CMETRIC=s.CMETRIC;var o=r(17);t.AbstractEuclidean=o.AbstractEuclidean,t.Euclidean=o.Euclidean,t.EuclideanRgbQuantWOAlpha=o.EuclideanRgbQuantWOAlpha,t.EuclideanRgbQuantWithAlpha=o.EuclideanRgbQuantWithAlpha;var c=r(18);t.AbstractManhattan=c.AbstractManhattan,t.Manhattan=c.Manhattan,t.ManhattanSRGB=c.ManhattanSRGB,t.ManhattanNommyde=c.ManhattanNommyde;var l=r(19);t.PNGQUANT=l.PNGQUANT},function(e,t){var r=function(){function e(){this._setDefaults(),this.setWhitePoint(255,255,255,255)}return e.prototype.setWhitePoint=function(e,t,r,i){this._whitePoint={r:e>0?255/e:0,g:t>0?255/t:0,b:r>0?255/r:0,a:i>0?255/i:0},this._maxDistance=this.calculateRaw(e,t,r,i,0,0,0,0)},e.prototype.calculateNormalized=function(e,t){return this.calculateRaw(e.r,e.g,e.b,e.a,t.r,t.g,t.b,t.a)/this._maxDistance},e.prototype._setDefaults=function(){},e}();t.AbstractDistanceCalculator=r},function(e,t,r){var i=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=r(13),a=r(7),s=r(6),o=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.calculateRaw=function(e,t,r,i,n,o,c,l){var u=a.rgb2lab(s.inRange0to255(e*this._whitePoint.r),s.inRange0to255(t*this._whitePoint.g),s.inRange0to255(r*this._whitePoint.b)),h=a.rgb2lab(s.inRange0to255(n*this._whitePoint.r),s.inRange0to255(o*this._whitePoint.g),s.inRange0to255(c*this._whitePoint.b)),f=u.L-h.L,d=u.a-h.a,p=u.b-h.b,m=Math.sqrt(u.a*u.a+u.b*u.b),b=m-Math.sqrt(h.a*h.a+h.b*h.b),v=d*d+p*p-b*b;v=v<0?0:Math.sqrt(v);var g=(l-i)*this._whitePoint.a*this._kA;return Math.sqrt(Math.pow(f/this._Kl,2)+Math.pow(b/(1+this._K1*m),2)+Math.pow(v/(1+this._K2*m),2)+Math.pow(g,2))},t}(n.AbstractDistanceCalculator);
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * cie94.ts - part of Image Quantization Library
      		 */t.AbstractCIE94=o;var c=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype._setDefaults=function(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255},t}(o);t.CIE94Textiles=c;var l=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype._setDefaults=function(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255},t}(o);t.CIE94GraphicArts=l},function(e,t,r){var i=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=r(13),a=r(7),s=r(6),o=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.calculateRaw=function(e,r,i,n,o,c,l,u){var h=a.rgb2lab(s.inRange0to255(e*this._whitePoint.r),s.inRange0to255(r*this._whitePoint.g),s.inRange0to255(i*this._whitePoint.b)),f=a.rgb2lab(s.inRange0to255(o*this._whitePoint.r),s.inRange0to255(c*this._whitePoint.g),s.inRange0to255(l*this._whitePoint.b)),d=(u-n)*this._whitePoint.a*t._kA,p=this.calculateRawInLab(h,f);return Math.sqrt(p+d*d)},t.prototype.calculateRawInLab=function(e,r){var i=e.L,n=e.a,a=e.b,s=r.L,o=r.a,c=r.b,l=Math.sqrt(n*n+a*a),u=Math.sqrt(o*o+c*c),h=Math.pow((l+u)/2,7),f=.5*(1-Math.sqrt(h/(h+t._pow25to7))),d=(1+f)*n,p=(1+f)*o,m=Math.sqrt(d*d+a*a),b=Math.sqrt(p*p+c*c),v=m*b,g=t._calculatehp(a,d),y=t._calculatehp(c,p),_=Math.abs(g-y),w=s-i,x=b-m,k=t._calculate_dHp(v,_,y,g),S=t._calculate_ahp(v,_,g,y),C=t._calculateT(S),U=(m+b)/2,E=Math.pow((i+s)/2-50,2),T=1+.015*E/Math.sqrt(20+E),M=1+.045*U,O=1+.015*C*U,P=t._calculateRT(S,U),A=w/T,I=x/M,L=k/O;return Math.pow(A,2)+Math.pow(I,2)+Math.pow(L,2)+P*I*L},t._calculatehp=function(e,r){var i=Math.atan2(e,r);return i>=0?i:i+t._deg360InRad},t._calculateRT=function(e,r){var i=Math.pow(r,7),n=2*Math.sqrt(i/(i+t._pow25to7)),a=t._deg30InRad*Math.exp(-Math.pow((e-t._deg275InRad)/t._deg25InRad,2));return-Math.sin(2*a)*n},t._calculateT=function(e){return 1-.17*Math.cos(e-t._deg30InRad)+.24*Math.cos(2*e)+.32*Math.cos(3*e+t._deg6InRad)-.2*Math.cos(4*e-t._deg63InRad)},t._calculate_ahp=function(e,r,i,n){var a=i+n;return 0==e?a:r<=t._deg180InRad?a/2:a<t._deg360InRad?(a+t._deg360InRad)/2:(a-t._deg360InRad)/2},t._calculate_dHp=function(e,r,i,n){var a;return a=0==e?0:r<=t._deg180InRad?i-n:i<=n?i-n+t._deg360InRad:i-n-t._deg360InRad,2*Math.sqrt(e)*Math.sin(a/2)},t._kA=25/255,t._pow25to7=Math.pow(25,7),t._deg360InRad=s.degrees2radians(360),t._deg180InRad=s.degrees2radians(180),t._deg30InRad=s.degrees2radians(30),t._deg6InRad=s.degrees2radians(6),t._deg63InRad=s.degrees2radians(63),t._deg275InRad=s.degrees2radians(275),t._deg25InRad=s.degrees2radians(25),t}(n.AbstractDistanceCalculator);
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * ciede2000.ts - part of Image Quantization Library
      		 */t.CIEDE2000=o},function(e,t,r){var i=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.calculateRaw=function(e,t,r,i,n,a,s,o){var c=(e+n)/2*this._whitePoint.r,l=(e-n)*this._whitePoint.r,u=(t-a)*this._whitePoint.g,h=(r-s)*this._whitePoint.b,f=((512+c)*l*l>>8)+4*u*u+((767-c)*h*h>>8),d=(o-i)*this._whitePoint.a;return Math.sqrt(f+d*d)},t}(r(13).AbstractDistanceCalculator);
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * cmetric.ts - part of Image Quantization Library
      		 */t.CMETRIC=n},function(e,t,r){var i=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=r(13),a=r(2),s=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.calculateRaw=function(e,t,r,i,n,a,s,o){var c=n-e,l=a-t,u=s-r,h=o-i;return Math.sqrt(this._kR*c*c+this._kG*l*l+this._kB*u*u+this._kA*h*h)},t}(n.AbstractDistanceCalculator);
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * euclidean.ts - part of Image Quantization Library
      		 */t.AbstractEuclidean=s;var o=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype._setDefaults=function(){this._kR=1,this._kG=1,this._kB=1,this._kA=1},t}(s);t.Euclidean=o;var c=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype._setDefaults=function(){this._kR=a.Y.RED,this._kG=a.Y.GREEN,this._kB=a.Y.BLUE,this._kA=1},t}(s);t.EuclideanRgbQuantWithAlpha=c;var l=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype._setDefaults=function(){this._kR=a.Y.RED,this._kG=a.Y.GREEN,this._kB=a.Y.BLUE,this._kA=0},t}(s);t.EuclideanRgbQuantWOAlpha=l},function(e,t,r){var i=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=r(13),a=r(2),s=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.calculateRaw=function(e,t,r,i,n,a,s,o){var c=n-e,l=a-t,u=s-r,h=o-i;return c<0&&(c=0-c),l<0&&(l=0-l),u<0&&(u=0-u),h<0&&(h=0-h),this._kR*c+this._kG*l+this._kB*u+this._kA*h},t}(n.AbstractDistanceCalculator);
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * manhattanNeuQuant.ts - part of Image Quantization Library
      		 */t.AbstractManhattan=s;var o=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype._setDefaults=function(){this._kR=1,this._kG=1,this._kB=1,this._kA=1},t}(s);t.Manhattan=o;var c=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype._setDefaults=function(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1},t}(s);t.ManhattanNommyde=c;var l=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype._setDefaults=function(){this._kR=a.Y.RED,this._kG=a.Y.GREEN,this._kB=a.Y.BLUE,this._kA=1},t}(s);t.ManhattanSRGB=l},function(e,t,r){var i=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.calculateRaw=function(e,t,r,i,n,a,s,o){var c=(o-i)*this._whitePoint.a;return this._colordifference_ch(e*this._whitePoint.r,n*this._whitePoint.r,c)+this._colordifference_ch(t*this._whitePoint.g,a*this._whitePoint.g,c)+this._colordifference_ch(r*this._whitePoint.b,s*this._whitePoint.b,c)},t.prototype._colordifference_ch=function(e,t,r){var i=e-t,n=i+r;return i*i+n*n},t}(r(13).AbstractDistanceCalculator);
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * pngQuant.ts - part of Image Quantization Library
      		 */t.PNGQUANT=n},function(e,t,r){var i=r(21);t.NeuQuant=i.NeuQuant;var n=r(25);t.NeuQuantFloat=n.NeuQuantFloat;var a=r(26);t.RGBQuant=a.RGBQuant;var s=r(27);t.ColorHistogram=s.ColorHistogram;var o=r(29);t.WuQuant=o.WuQuant,t.WuColorCube=o.WuColorCube},function(e,t,r){
/**
      		 * @preserve TypeScript port:
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * neuquant.ts - part of Image Quantization Library
      		 */
var i=r(22),n=r(24),a=3,s=function(){function e(e){this.r=this.g=this.b=this.a=e}return e.prototype.toPoint=function(){return n.Point.createByRGBA(this.r>>a,this.g>>a,this.b>>a,this.a>>a)},e.prototype.subtract=function(e,t,r,i){this.r-=0|e,this.g-=0|t,this.b-=0|r,this.a-=0|i},e}(),o=function(){function e(e,t){void 0===t&&(t=256),this._distance=e,this._pointArray=[],this._sampleFactor=1,this._networkSize=t,this._distance.setWhitePoint(255<<a,255<<a,255<<a,255<<a)}return e.prototype.sample=function(e){this._pointArray=this._pointArray.concat(e.getPointArray())},e.prototype.quantize=function(){return this._init(),this._learn(),this._buildPalette()},e.prototype._init=function(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(var t=0;t<this._networkSize;t++)this._network[t]=new s((t<<a+8)/this._networkSize|0),this._freq[t]=e._initialBias/this._networkSize|0,this._bias[t]=0},e.prototype._learn=function(){var t=this._sampleFactor,r=this._pointArray.length;r<e._minpicturebytes&&(t=1);var i,n=30+(t-1)/3|0,s=r/t|0,o=s/e._nCycles|0,c=e._initAlpha,l=(this._networkSize>>3)*e._radiusBias,u=l>>e._radiusBiasShift;u<=1&&(u=0);for(var h=0;h<u;h++)this._radPower[h]=c*((u*u-h*h)*e._radBias/(u*u))>>>0;i=r<e._minpicturebytes?1:r%e._prime1!=0?e._prime1:r%e._prime2!=0?e._prime2:r%e._prime3!=0?e._prime3:e._prime4,h=0;for(var f=0;h<s;){var d=this._pointArray[f],p=d.b<<a,m=d.g<<a,b=d.r<<a,v=d.a<<a,g=this._contest(p,m,b,v);if(this._alterSingle(c,g,p,m,b,v),0!==u&&this._alterNeighbour(u,g,p,m,b,v),(f+=i)>=r&&(f-=r),0===o&&(o=1),++h%o==0){c-=c/n|0,(u=(l-=l/e._radiusDecrease|0)>>e._radiusBiasShift)<=1&&(u=0);for(var y=0;y<u;y++)this._radPower[y]=c*((u*u-y*y)*e._radBias/(u*u))>>>0}}},e.prototype._buildPalette=function(){var e=new i.Palette;return this._network.forEach((function(t){e.add(t.toPoint())})),e.sort(),e},e.prototype._alterNeighbour=function(t,r,i,n,a,s){var o=r-t;o<-1&&(o=-1);var c=r+t;c>this._networkSize&&(c=this._networkSize);for(var l=r+1,u=r-1,h=1;l<c||u>o;){var f,d=this._radPower[h++]/e._alphaRadBias;l<c&&(f=this._network[l++]).subtract(d*(f.r-a),d*(f.g-n),d*(f.b-i),d*(f.a-s)),u>o&&(f=this._network[u--]).subtract(d*(f.r-a),d*(f.g-n),d*(f.b-i),d*(f.a-s))}},e.prototype._alterSingle=function(t,r,i,n,a,s){t/=e._initAlpha;var o=this._network[r];o.subtract(t*(o.r-a),t*(o.g-n),t*(o.b-i),t*(o.a-s))},e.prototype._contest=function(t,r,i,n){for(var s=1020<<a,o=~(1<<31),c=o,l=-1,u=l,h=0;h<this._networkSize;h++){var f=this._network[h],d=this._distance.calculateNormalized(f,{r:i,g:r,b:t,a:n})*s|0;d<o&&(o=d,l=h);var p=d-(this._bias[h]>>e._initialBiasShift-a);p<c&&(c=p,u=h);var m=this._freq[h]>>e._betaShift;this._freq[h]-=m,this._bias[h]+=m<<e._gammaShift}return this._freq[l]+=e._beta,this._bias[l]-=e._betaGamma,u},e._prime1=499,e._prime2=491,e._prime3=487,e._prime4=503,e._minpicturebytes=e._prime4,e._nCycles=100,e._initialBiasShift=16,e._initialBias=1<<e._initialBiasShift,e._gammaShift=10,e._betaShift=10,e._beta=e._initialBias>>e._betaShift,e._betaGamma=e._initialBias<<e._gammaShift-e._betaShift,e._radiusBiasShift=6,e._radiusBias=1<<e._radiusBiasShift,e._radiusDecrease=30,e._alphaBiasShift=10,e._initAlpha=1<<e._alphaBiasShift,e._radBiasShift=8,e._radBias=1<<e._radBiasShift,e._alphaRadBiasShift=e._alphaBiasShift+e._radBiasShift,e._alphaRadBias=1<<e._alphaRadBiasShift,e}();t.NeuQuant=o},function(e,t,r){var i=r(23),n=r(5),a=10;function s(e,t){for(var r=360/t,i=1,n=r-r/2;i<t;i++,n+=r)if(e>=n&&e<n+r)return i;return 0}t.hueGroup=s;var o=function(){function e(){this._pointArray=[],this._i32idx={},this._pointContainer=new i.PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}return e.prototype.add=function(e){this._pointArray.push(e),this._pointContainer.setWidth(this._pointArray.length)},e.prototype.has=function(e){for(var t=this._pointArray.length-1;t>=0;t--)if(e.uint32===this._pointArray[t].uint32)return!0;return!1},e.prototype.getNearestColor=function(e,t){return this._pointArray[0|this.getNearestIndex(e,t)]},e.prototype.getPointContainer=function(){return this._pointContainer},e.prototype._nearestPointFromCache=function(e){return"number"==typeof this._i32idx[e]?this._i32idx[e]:-1},e.prototype.getNearestIndex=function(e,t){var r=this._nearestPointFromCache(""+t.uint32);if(r>=0)return r;var i=Number.MAX_VALUE;r=0;for(var n=0,a=this._pointArray.length;n<a;n++){var s=this._pointArray[n],o=e.calculateRaw(t.r,t.g,t.b,t.a,s.r,s.g,s.b,s.a);o<i&&(i=o,r=n)}return this._i32idx[t.uint32]=r,r},e.prototype.sort=function(){this._i32idx={},this._pointArray.sort((function(e,t){var r=n.rgb2hsl(e.r,e.g,e.b),i=n.rgb2hsl(t.r,t.g,t.b),o=e.r===e.g&&e.g===e.b?0:1+s(r.h,a),c=(t.r===t.g&&t.g===t.b?0:1+s(i.h,a))-o;if(c)return-c;var l=e.getLuminosity(!0),u=t.getLuminosity(!0);if(u-l!=0)return u-l;var h=(100*i.s|0)-(100*r.s|0);return h?-h:0}))},e}();t.Palette=o},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * pointContainer.ts - part of Image Quantization Library
      		 */
var i=r(24),n=function(){function e(){this._width=0,this._height=0,this._pointArray=[]}return e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e.prototype.setWidth=function(e){this._width=e},e.prototype.setHeight=function(e){this._height=e},e.prototype.getPointArray=function(){return this._pointArray},e.prototype.clone=function(){var t=new e;t._width=this._width,t._height=this._height;for(var r=0,n=this._pointArray.length;r<n;r++)t._pointArray[r]=i.Point.createByUint32(0|this._pointArray[r].uint32);return t},e.prototype.toUint32Array=function(){for(var e=this._pointArray.length,t=new Uint32Array(e),r=0;r<e;r++)t[r]=this._pointArray[r].uint32;return t},e.prototype.toUint8Array=function(){return new Uint8Array(this.toUint32Array().buffer)},e.fromHTMLImageElement=function(t){var r=t.naturalWidth,i=t.naturalHeight,n=document.createElement("canvas");return n.width=r,n.height=i,n.getContext("2d").drawImage(t,0,0,r,i,0,0,r,i),e.fromHTMLCanvasElement(n)},e.fromHTMLCanvasElement=function(t){var r=t.width,i=t.height,n=t.getContext("2d").getImageData(0,0,r,i);return e.fromImageData(n)},e.fromNodeCanvas=function(t){return e.fromHTMLCanvasElement(t)},e.fromImageData=function(t){var r=t.width,i=t.height;return e.fromCanvasPixelArray(t.data,r,i)},e.fromArray=function(t,r,i){var n=new Uint8Array(t);return e.fromUint8Array(n,r,i)},e.fromCanvasPixelArray=function(t,r,i){return e.fromArray(t,r,i)},e.fromUint8Array=function(t,r,i){return e.fromUint32Array(new Uint32Array(t.buffer),r,i)},e.fromUint32Array=function(t,r,n){var a=new e;a._width=r,a._height=n;for(var s=0,o=t.length;s<o;s++)a._pointArray[s]=i.Point.createByUint32(0|t[s]);return a},e}();t.PointContainer=n},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * point.ts - part of Image Quantization Library
      		 */
var i=r(2),n=function(){function e(){this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}return e.createByQuadruplet=function(t){var r=new e;return r.r=0|t[0],r.g=0|t[1],r.b=0|t[2],r.a=0|t[3],r._loadUINT32(),r._loadQuadruplet(),r},e.createByRGBA=function(t,r,i,n){var a=new e;return a.r=0|t,a.g=0|r,a.b=0|i,a.a=0|n,a._loadUINT32(),a._loadQuadruplet(),a},e.createByUint32=function(t){var r=new e;return r.uint32=t>>>0,r._loadRGBA(),r._loadQuadruplet(),r},e.prototype.from=function(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this.uint32=e.uint32,this.rgba[0]=e.r,this.rgba[1]=e.g,this.rgba[2]=e.b,this.rgba[3]=e.a},e.prototype.getLuminosity=function(e){var t=this.r,r=this.g,n=this.b;return e&&(t=Math.min(255,255-this.a+this.a*t/255),r=Math.min(255,255-this.a+this.a*r/255),n=Math.min(255,255-this.a+this.a*n/255)),t*i.Y.RED+r*i.Y.GREEN+n*i.Y.BLUE},e.prototype._loadUINT32=function(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0},e.prototype._loadRGBA=function(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255},e.prototype._loadQuadruplet=function(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a},e}();t.Point=n},function(e,t,r){
/**
      		 * @preserve TypeScript port:
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * neuquant.ts - part of Image Quantization Library
      		 */
var i=r(22),n=r(24),a=3,s=function(){function e(e){this.r=this.g=this.b=this.a=e}return e.prototype.toPoint=function(){return n.Point.createByRGBA(this.r>>a,this.g>>a,this.b>>a,this.a>>a)},e.prototype.subtract=function(e,t,r,i){this.r-=e,this.g-=t,this.b-=r,this.a-=i},e}(),o=function(){function e(e,t){void 0===t&&(t=256),this._distance=e,this._pointArray=[],this._sampleFactor=1,this._networkSize=t,this._distance.setWhitePoint(255<<a,255<<a,255<<a,255<<a)}return e.prototype.sample=function(e){this._pointArray=this._pointArray.concat(e.getPointArray())},e.prototype.quantize=function(){return this._init(),this._learn(),this._buildPalette()},e.prototype._init=function(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(var t=0;t<this._networkSize;t++)this._network[t]=new s((t<<a+8)/this._networkSize),this._freq[t]=e._initialBias/this._networkSize,this._bias[t]=0},e.prototype._learn=function(){var t=this._sampleFactor,r=this._pointArray.length;r<e._minpicturebytes&&(t=1);var i,n=30+(t-1)/3,s=r/t,o=s/e._nCycles|0,c=e._initAlpha,l=(this._networkSize>>3)*e._radiusBias,u=l>>e._radiusBiasShift;u<=1&&(u=0);for(var h=0;h<u;h++)this._radPower[h]=c*((u*u-h*h)*e._radBias/(u*u));i=r<e._minpicturebytes?1:r%e._prime1!=0?e._prime1:r%e._prime2!=0?e._prime2:r%e._prime3!=0?e._prime3:e._prime4,h=0;for(var f=0;h<s;){var d=this._pointArray[f],p=d.b<<a,m=d.g<<a,b=d.r<<a,v=d.a<<a,g=this._contest(p,m,b,v);if(this._alterSingle(c,g,p,m,b,v),0!=u&&this._alterNeighbour(u,g,p,m,b,v),(f+=i)>=r&&(f-=r),0==o&&(o=1),++h%o==0){c-=c/n,(u=(l-=l/e._radiusDecrease)>>e._radiusBiasShift)<=1&&(u=0);for(var y=0;y<u;y++)this._radPower[y]=c*((u*u-y*y)*e._radBias/(u*u))}}},e.prototype._buildPalette=function(){var e=new i.Palette;return this._network.forEach((function(t){e.add(t.toPoint())})),e.sort(),e},e.prototype._alterNeighbour=function(t,r,i,n,a,s){var o=r-t;o<-1&&(o=-1);var c=r+t;c>this._networkSize&&(c=this._networkSize);for(var l=r+1,u=r-1,h=1;l<c||u>o;){var f,d=this._radPower[h++]/e._alphaRadBias;l<c&&(f=this._network[l++]).subtract(d*(f.r-a),d*(f.g-n),d*(f.b-i),d*(f.a-s)),u>o&&(f=this._network[u--]).subtract(d*(f.r-a),d*(f.g-n),d*(f.b-i),d*(f.a-s))}},e.prototype._alterSingle=function(t,r,i,n,a,s){t/=e._initAlpha;var o=this._network[r];o.subtract(t*(o.r-a),t*(o.g-n),t*(o.b-i),t*(o.a-s))},e.prototype._contest=function(t,r,i,n){for(var s=1020<<a,o=~(1<<31),c=o,l=-1,u=l,h=0;h<this._networkSize;h++){var f=this._network[h],d=this._distance.calculateNormalized(f,{r:i,g:r,b:t,a:n})*s;d<o&&(o=d,l=h);var p=d-(this._bias[h]>>e._initialBiasShift-a);p<c&&(c=p,u=h);var m=this._freq[h]>>e._betaShift;this._freq[h]-=m,this._bias[h]+=m<<e._gammaShift}return this._freq[l]+=e._beta,this._bias[l]-=e._betaGamma,u},e._prime1=499,e._prime2=491,e._prime3=487,e._prime4=503,e._minpicturebytes=e._prime4,e._nCycles=100,e._initialBiasShift=16,e._initialBias=1<<e._initialBiasShift,e._gammaShift=10,e._betaShift=10,e._beta=e._initialBias>>e._betaShift,e._betaGamma=e._initialBias<<e._gammaShift-e._betaShift,e._radiusBiasShift=6,e._radiusBias=1<<e._radiusBiasShift,e._radiusDecrease=30,e._alphaBiasShift=10,e._initAlpha=1<<e._alphaBiasShift,e._radBiasShift=8,e._radBias=1<<e._radBiasShift,e._alphaRadBiasShift=e._alphaBiasShift+e._radBiasShift,e._alphaRadBias=1<<e._alphaRadBiasShift,e}();t.NeuQuantFloat=o},function(e,t,r){
/**
      		 * @preserve TypeScript port:
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * rgbquant.ts - part of Image Quantization Library
      		 */
var i=r(22),n=r(24),a=r(27),s=r(6),o=function(){function e(e,t,r){this.index=e,this.color=t,this.distance=r}return e}(),c=function(){function e(e,t,r){void 0===t&&(t=256),void 0===r&&(r=2),this._distance=e,this._colors=t,this._histogram=new a.ColorHistogram(r,t),this._initialDistance=.01,this._distanceIncrement=.005}return e.prototype.sample=function(e){this._histogram.sample(e)},e.prototype.quantize=function(){var e=this._histogram.getImportanceSortedColorsIDXI32();if(0===e.length)throw new Error("No colors in image");var t=this._buildPalette(e);return t.sort(),t},e.prototype._buildPalette=function(e){for(var t=new i.Palette,r=t.getPointContainer().getPointArray(),a=new Array(e.length),c=0;c<e.length;c++)r.push(n.Point.createByUint32(e[c])),a[c]=1;for(var l=r.length,u=[],h=l,f=this._initialDistance;h>this._colors;){for(u.length=0,c=0;c<l;c++)if(0!==a[c])for(var d=r[c],p=c+1;p<l;p++)if(0!==a[p]){var m=r[p],b=this._distance.calculateNormalized(d,m);b<f&&(u.push(new o(p,m,b)),a[p]=0,h--)}f+=h>3*this._colors?this._initialDistance:this._distanceIncrement}if(h<this._colors){s.stableSort(u,(function(e,t){return t.distance-e.distance}));for(var v=0;h<this._colors&&v<u.length;)a[u[v].index]=1,h++,v++}for(var g=r.length,y=g-1;y>=0;y--)0===a[y]&&(y!==g-1&&(r[y]=r[g-1]),--g);return r.length=g,t},e}();t.RGBQuant=c},function(e,t,r){
/**
      		 * @preserve TypeScript port:
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * colorHistogram.ts - part of Image Quantization Library
      		 */
var i=r(28),n=r(6),a=function(){function e(t,r){this._method=t,this._minHueCols=r<<2,this._initColors=r<<2,this._hueStats=new i.HueStatistics(e._hueGroups,this._minHueCols),this._histogram=Object.create(null)}return e.prototype.sample=function(e){switch(this._method){case 1:this._colorStats1D(e);break;case 2:this._colorStats2D(e)}},e.prototype.getImportanceSortedColorsIDXI32=function(){var e,t=this,r=n.stableSort(Object.keys(this._histogram),(function(e,r){return t._histogram[r]-t._histogram[e]}));if(0===r.length)return[];switch(this._method){case 1:var i=Math.min(r.length,this._initColors),a=r[i-1],s=this._histogram[a];e=r.slice(0,i);for(var o=i,c=r.length;o<c&&this._histogram[r[o]]==s;)e.push(r[o++]);this._hueStats.injectIntoArray(e);break;case 2:e=r;break;default:throw new Error("Incorrect method")}return e.map((function(e){return+e}))},e.prototype._colorStats1D=function(e){for(var t=this._histogram,r=e.getPointArray(),i=r.length,n=0;n<i;n++){var a=r[n].uint32;this._hueStats.check(a),a in t?t[a]++:t[a]=1}},e.prototype._colorStats2D=function(t){var r=this,i=t.getWidth(),n=t.getHeight(),a=t.getPointArray(),s=e._boxSize[0],o=e._boxSize[1],c=s*o,l=this._makeBoxes(i,n,s,o),u=this._histogram;l.forEach((function(t){var n=Math.round(t.w*t.h/c)*e._boxPixels;n<2&&(n=2);var s={};r._iterateBox(t,i,(function(e){var t=a[e].uint32;r._hueStats.check(t),t in u?u[t]++:t in s?++s[t]>=n&&(u[t]=s[t]):s[t]=1}))})),this._hueStats.injectIntoDictionary(u)},e.prototype._iterateBox=function(e,t,r){var i=e,n=i.y*t+i.x,a=(i.y+i.h-1)*t+(i.x+i.w-1),s=t-i.w+1,o=0,c=n;do{r.call(this,c),c+=++o%i.w==0?s:1}while(c<=a)},e.prototype._makeBoxes=function(e,t,r,i){for(var n=e%r,a=t%i,s=e-n,o=t-a,c=[],l=0;l<t;l+=i)for(var u=0;u<e;u+=r)c.push({x:u,y:l,w:u==s?n:r,h:l==o?a:i});return c},e._boxSize=[64,64],e._boxPixels=2,e._hueGroups=10,e}();t.ColorHistogram=a},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * hueStatistics.ts - part of Image Quantization Library
      		 */
var i=r(5),n=r(22),a=function(){function e(){this.num=0,this.cols=[]}return e}(),s=function(){function e(e,t){this._numGroups=e,this._minCols=t,this._stats=[];for(var r=0;r<=e;r++)this._stats[r]=new a;this._groupsFull=0}return e.prototype.check=function(e){this._groupsFull==this._numGroups+1&&(this.check=function(){});var t=255&e,r=e>>>8&255,a=e>>>16&255,s=t==r&&r==a?0:1+n.hueGroup(i.rgb2hsl(t,r,a).h,this._numGroups),o=this._stats[s],c=this._minCols;o.num++,o.num>c||(o.num==c&&this._groupsFull++,o.num<=c&&this._stats[s].cols.push(e))},e.prototype.injectIntoDictionary=function(e){for(var t=0;t<=this._numGroups;t++)this._stats[t].num<=this._minCols&&this._stats[t].cols.forEach((function(t){e[t]?e[t]++:e[t]=1}))},e.prototype.injectIntoArray=function(e){for(var t=0;t<=this._numGroups;t++)this._stats[t].num<=this._minCols&&this._stats[t].cols.forEach((function(t){-1==e.indexOf(t)&&e.push(t)}))},e}();t.HueStatistics=s},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * wuQuant.ts - part of Image Quantization Library
      		 */
var i=r(22),n=r(24);function a(e){for(var t=[],r=0;r<e;r++)t[r]=0;return t}function s(e,t,r,i){for(var n=new Array(e),a=0;a<e;a++){n[a]=new Array(t);for(var s=0;s<t;s++){n[a][s]=new Array(r);for(var o=0;o<r;o++){n[a][s][o]=new Array(i);for(var c=0;c<i;c++)n[a][s][o][c]=0}}}return n}function o(e,t,r){for(var i=new Array(e),n=0;n<e;n++){i[n]=new Array(t);for(var a=0;a<t;a++){i[n][a]=new Array(r);for(var s=0;s<r;s++)i[n][a][s]=0}}return i}function c(e,t,r,i,n){for(var a=0;a<t;a++){e[a]=[];for(var s=0;s<r;s++){e[a][s]=[];for(var o=0;o<i;o++)e[a][s][o]=n}}}function l(e,t,r){for(var i=0;i<t;i++)e[i]=r}var u=function(){function e(){}return e}();t.WuColorCube=u;var h=function(){function e(e,t,r){void 0===t&&(t=256),void 0===r&&(r=5),this._distance=e,this._setQuality(r),this._initialize(t)}return e.prototype.sample=function(e){for(var t=e.getPointArray(),r=0,i=t.length;r<i;r++)this._addColor(t[r]);this._pixels=this._pixels.concat(t)},e.prototype.quantize=function(){this._preparePalette();for(var e=new i.Palette,t=0;t<this._colors;t++)if(this._sums[t]>0){var r=this._sums[t],a=this._reds[t]/r,s=this._greens[t]/r,o=this._blues[t]/r,c=this._alphas[t]/r,l=n.Point.createByRGBA(0|a,0|s,0|o,0|c);e.add(l)}return e.sort(),e},e.prototype._preparePalette=function(){this._calculateMoments();for(var t=0,r=a(this._colors),i=1;i<this._colors;++i){this._cut(this._cubes[t],this._cubes[i])?(r[t]=this._cubes[t].volume>1?this._calculateVariance(this._cubes[t]):0,r[i]=this._cubes[i].volume>1?this._calculateVariance(this._cubes[i]):0):(r[t]=0,i--),t=0;for(var n=r[0],s=1;s<=i;++s)r[s]>n&&(n=r[s],t=s);if(n<=0){this._colors=i+1;break}}for(var o=[],c=[],l=[],u=[],h=0;h<this._colors;++h){var f=e._volume(this._cubes[h],this._weights);f>0?(o[h]=e._volume(this._cubes[h],this._momentsRed)/f|0,c[h]=e._volume(this._cubes[h],this._momentsGreen)/f|0,l[h]=e._volume(this._cubes[h],this._momentsBlue)/f|0,u[h]=e._volume(this._cubes[h],this._momentsAlpha)/f|0):(o[h]=0,c[h]=0,l[h]=0,u[h]=0)}this._reds=a(this._colors+1),this._greens=a(this._colors+1),this._blues=a(this._colors+1),this._alphas=a(this._colors+1),this._sums=a(this._colors+1),s=0;for(var d=this._pixels.length;s<d;s++){for(var p=this._pixels[s],m=-1,b=Number.MAX_VALUE,v=0;v<this._colors;v++){var g=o[v],y=c[v],_=l[v],w=u[v],x=this._distance.calculateRaw(g,y,_,w,p.r,p.g,p.b,p.a);x<b&&(b=x,m=v)}this._reds[m]+=p.r,this._greens[m]+=p.g,this._blues[m]+=p.b,this._alphas[m]+=p.a,this._sums[m]++}},e.prototype._addColor=function(e){var t=8-this._significantBitsPerChannel,r=1+(e.r>>t),i=1+(e.g>>t),n=1+(e.b>>t),a=1+(e.a>>t);this._weights[a][r][i][n]++,this._momentsRed[a][r][i][n]+=e.r,this._momentsGreen[a][r][i][n]+=e.g,this._momentsBlue[a][r][i][n]+=e.b,this._momentsAlpha[a][r][i][n]+=e.a,this._moments[a][r][i][n]+=this._table[e.r]+this._table[e.g]+this._table[e.b]+this._table[e.a]},e.prototype._calculateMoments=function(){for(var e=[],t=[],r=[],i=[],n=[],a=[],s=o(this._sideSize,this._sideSize,this._sideSize),u=o(this._sideSize,this._sideSize,this._sideSize),h=o(this._sideSize,this._sideSize,this._sideSize),f=o(this._sideSize,this._sideSize,this._sideSize),d=o(this._sideSize,this._sideSize,this._sideSize),p=o(this._sideSize,this._sideSize,this._sideSize),m=1;m<=this._alphaMaxSideIndex;++m){c(s,this._sideSize,this._sideSize,this._sideSize,0),c(u,this._sideSize,this._sideSize,this._sideSize,0),c(h,this._sideSize,this._sideSize,this._sideSize,0),c(f,this._sideSize,this._sideSize,this._sideSize,0),c(d,this._sideSize,this._sideSize,this._sideSize,0),c(p,this._sideSize,this._sideSize,this._sideSize,0);for(var b=1;b<=this._maxSideIndex;++b){l(e,this._sideSize,0),l(t,this._sideSize,0),l(r,this._sideSize,0),l(i,this._sideSize,0),l(n,this._sideSize,0),l(a,this._sideSize,0);for(var v=1;v<=this._maxSideIndex;++v)for(var g=0,y=0,_=0,w=0,x=0,k=0,S=1;S<=this._maxSideIndex;++S)g+=this._weights[m][b][v][S],y+=this._momentsRed[m][b][v][S],_+=this._momentsGreen[m][b][v][S],w+=this._momentsBlue[m][b][v][S],x+=this._momentsAlpha[m][b][v][S],k+=this._moments[m][b][v][S],e[S]+=g,t[S]+=y,r[S]+=_,i[S]+=w,n[S]+=x,a[S]+=k,s[b][v][S]=s[b-1][v][S]+e[S],u[b][v][S]=u[b-1][v][S]+t[S],h[b][v][S]=h[b-1][v][S]+r[S],f[b][v][S]=f[b-1][v][S]+i[S],d[b][v][S]=d[b-1][v][S]+n[S],p[b][v][S]=p[b-1][v][S]+a[S],this._weights[m][b][v][S]=this._weights[m-1][b][v][S]+s[b][v][S],this._momentsRed[m][b][v][S]=this._momentsRed[m-1][b][v][S]+u[b][v][S],this._momentsGreen[m][b][v][S]=this._momentsGreen[m-1][b][v][S]+h[b][v][S],this._momentsBlue[m][b][v][S]=this._momentsBlue[m-1][b][v][S]+f[b][v][S],this._momentsAlpha[m][b][v][S]=this._momentsAlpha[m-1][b][v][S]+d[b][v][S],this._moments[m][b][v][S]=this._moments[m-1][b][v][S]+p[b][v][S]}}},e._volumeFloat=function(e,t){return t[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMaximum]-t[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMaximum]-t[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMaximum]+t[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]-t[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMaximum]+t[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]+t[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-t[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(t[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMinimum]-t[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]-t[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+t[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]-t[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]+t[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]+t[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]-t[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum])},e._volume=function(t,r){return 0|e._volumeFloat(t,r)},e._top=function(t,r,i,n){var a;switch(r){case e.alpha:a=n[i][t.redMaximum][t.greenMaximum][t.blueMaximum]-n[i][t.redMaximum][t.greenMinimum][t.blueMaximum]-n[i][t.redMinimum][t.greenMaximum][t.blueMaximum]+n[i][t.redMinimum][t.greenMinimum][t.blueMaximum]-(n[i][t.redMaximum][t.greenMaximum][t.blueMinimum]-n[i][t.redMaximum][t.greenMinimum][t.blueMinimum]-n[i][t.redMinimum][t.greenMaximum][t.blueMinimum]+n[i][t.redMinimum][t.greenMinimum][t.blueMinimum]);break;case e.red:a=n[t.alphaMaximum][i][t.greenMaximum][t.blueMaximum]-n[t.alphaMaximum][i][t.greenMinimum][t.blueMaximum]-n[t.alphaMinimum][i][t.greenMaximum][t.blueMaximum]+n[t.alphaMinimum][i][t.greenMinimum][t.blueMaximum]-(n[t.alphaMaximum][i][t.greenMaximum][t.blueMinimum]-n[t.alphaMaximum][i][t.greenMinimum][t.blueMinimum]-n[t.alphaMinimum][i][t.greenMaximum][t.blueMinimum]+n[t.alphaMinimum][i][t.greenMinimum][t.blueMinimum]);break;case e.green:a=n[t.alphaMaximum][t.redMaximum][i][t.blueMaximum]-n[t.alphaMaximum][t.redMinimum][i][t.blueMaximum]-n[t.alphaMinimum][t.redMaximum][i][t.blueMaximum]+n[t.alphaMinimum][t.redMinimum][i][t.blueMaximum]-(n[t.alphaMaximum][t.redMaximum][i][t.blueMinimum]-n[t.alphaMaximum][t.redMinimum][i][t.blueMinimum]-n[t.alphaMinimum][t.redMaximum][i][t.blueMinimum]+n[t.alphaMinimum][t.redMinimum][i][t.blueMinimum]);break;case e.blue:a=n[t.alphaMaximum][t.redMaximum][t.greenMaximum][i]-n[t.alphaMaximum][t.redMaximum][t.greenMinimum][i]-n[t.alphaMaximum][t.redMinimum][t.greenMaximum][i]+n[t.alphaMaximum][t.redMinimum][t.greenMinimum][i]-(n[t.alphaMinimum][t.redMaximum][t.greenMaximum][i]-n[t.alphaMinimum][t.redMaximum][t.greenMinimum][i]-n[t.alphaMinimum][t.redMinimum][t.greenMaximum][i]+n[t.alphaMinimum][t.redMinimum][t.greenMinimum][i]);break;default:throw new Error("impossible")}return 0|a},e._bottom=function(t,r,i){switch(r){case e.alpha:return-i[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMaximum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMaximum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMaximum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMaximum]-(-i[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMinimum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMinimum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMinimum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum]);case e.red:return-i[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMaximum]+i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMaximum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMaximum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMaximum]-(-i[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMinimum]+i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMinimum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMinimum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum]);case e.green:return-i[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMaximum]+i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMaximum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMaximum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMaximum]-(-i[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMinimum]+i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMinimum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMinimum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum]);case e.blue:return-i[t.alphaMaximum][t.redMaximum][t.greenMaximum][t.blueMinimum]+i[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMinimum]+i[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMinimum]-i[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMinimum]-(-i[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMinimum]+i[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMinimum]+i[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMinimum]-i[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum]);default:return 0}},e.prototype._calculateVariance=function(t){var r=e._volume(t,this._momentsRed),i=e._volume(t,this._momentsGreen),n=e._volume(t,this._momentsBlue),a=e._volume(t,this._momentsAlpha);return e._volumeFloat(t,this._moments)-(r*r+i*i+n*n+a*a)/e._volume(t,this._weights)},e.prototype._maximize=function(t,r,i,n,a,s,o,c,l){for(var u=0|e._bottom(t,r,this._momentsRed),h=0|e._bottom(t,r,this._momentsGreen),f=0|e._bottom(t,r,this._momentsBlue),d=0|e._bottom(t,r,this._momentsAlpha),p=0|e._bottom(t,r,this._weights),m=0,b=-1,v=i;v<n;++v){var g=u+e._top(t,r,v,this._momentsRed),y=h+e._top(t,r,v,this._momentsGreen),_=f+e._top(t,r,v,this._momentsBlue),w=d+e._top(t,r,v,this._momentsAlpha),x=p+e._top(t,r,v,this._weights);if(0!=x){var k=g*g+y*y+_*_+w*w,S=k/x;g=a-g,y=s-y,_=o-_,w=c-w,0!=(x=l-x)&&(S+=(k=g*g+y*y+_*_+w*w)/x)>m&&(m=S,b=v)}}return{max:m,position:b}},e.prototype._cut=function(t,r){var i,n=e._volume(t,this._momentsRed),a=e._volume(t,this._momentsGreen),s=e._volume(t,this._momentsBlue),o=e._volume(t,this._momentsAlpha),c=e._volume(t,this._weights),l=this._maximize(t,e.red,t.redMinimum+1,t.redMaximum,n,a,s,o,c),u=this._maximize(t,e.green,t.greenMinimum+1,t.greenMaximum,n,a,s,o,c),h=this._maximize(t,e.blue,t.blueMinimum+1,t.blueMaximum,n,a,s,o,c),f=this._maximize(t,e.alpha,t.alphaMinimum+1,t.alphaMaximum,n,a,s,o,c);if(f.max>=l.max&&f.max>=u.max&&f.max>=h.max){if(i=e.alpha,f.position<0)return!1}else i=l.max>=f.max&&l.max>=u.max&&l.max>=h.max?e.red:u.max>=f.max&&u.max>=l.max&&u.max>=h.max?e.green:e.blue;switch(r.redMaximum=t.redMaximum,r.greenMaximum=t.greenMaximum,r.blueMaximum=t.blueMaximum,r.alphaMaximum=t.alphaMaximum,i){case e.red:r.redMinimum=t.redMaximum=l.position,r.greenMinimum=t.greenMinimum,r.blueMinimum=t.blueMinimum,r.alphaMinimum=t.alphaMinimum;break;case e.green:r.greenMinimum=t.greenMaximum=u.position,r.redMinimum=t.redMinimum,r.blueMinimum=t.blueMinimum,r.alphaMinimum=t.alphaMinimum;break;case e.blue:r.blueMinimum=t.blueMaximum=h.position,r.redMinimum=t.redMinimum,r.greenMinimum=t.greenMinimum,r.alphaMinimum=t.alphaMinimum;break;case e.alpha:r.alphaMinimum=t.alphaMaximum=f.position,r.blueMinimum=t.blueMinimum,r.redMinimum=t.redMinimum,r.greenMinimum=t.greenMinimum}return t.volume=(t.redMaximum-t.redMinimum)*(t.greenMaximum-t.greenMinimum)*(t.blueMaximum-t.blueMinimum)*(t.alphaMaximum-t.alphaMinimum),r.volume=(r.redMaximum-r.redMinimum)*(r.greenMaximum-r.greenMinimum)*(r.blueMaximum-r.blueMinimum)*(r.alphaMaximum-r.alphaMinimum),!0},e.prototype._initialize=function(e){this._colors=e,this._cubes=[];for(var t=0;t<e;t++)this._cubes[t]=new u;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(var r=0;r<256;++r)this._table[r]=r*r;this._pixels=[]},e.prototype._setQuality=function(e){void 0===e&&(e=5),this._significantBitsPerChannel=e,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1},e.alpha=3,e.red=2,e.green=1,e.blue=0,e}();t.WuQuant=h},function(e,t,r){var i=r(31);t.NearestColor=i.NearestColor;var n=r(32);t.ErrorDiffusionArray=n.ErrorDiffusionArray,t.ErrorDiffusionArrayKernel=n.ErrorDiffusionArrayKernel;var a=r(33);t.ErrorDiffusionRiemersma=a.ErrorDiffusionRiemersma},function(e,t){var r=function(){function e(e){this._distance=e}return e.prototype.quantize=function(e,t){for(var r=e.getPointArray(),i=e.getWidth(),n=e.getHeight(),a=0;a<n;a++)for(var s=0,o=a*i;s<i;s++,o++){var c=r[o];c.from(t.getNearestColor(this._distance,c))}return e},e}();t.NearestColor=r},function(e,t,r){var i=r(24),n=r(6);!function(e){e[e.FloydSteinberg=0]="FloydSteinberg",e[e.FalseFloydSteinberg=1]="FalseFloydSteinberg",e[e.Stucki=2]="Stucki",e[e.Atkinson=3]="Atkinson",e[e.Jarvis=4]="Jarvis",e[e.Burkes=5]="Burkes",e[e.Sierra=6]="Sierra",e[e.TwoSierra=7]="TwoSierra",e[e.SierraLite=8]="SierraLite"}(t.ErrorDiffusionArrayKernel||(t.ErrorDiffusionArrayKernel={}));var a=t.ErrorDiffusionArrayKernel,s=function(){function e(e,t,r,i,n){void 0===r&&(r=!0),void 0===i&&(i=0),void 0===n&&(n=!1),this._setKernel(t),this._distance=e,this._minColorDistance=i,this._serpentine=r,this._calculateErrorLikeGIMP=n}return e.prototype.quantize=function(e,t){for(var r=e.getPointArray(),a=new i.Point,s=e.getWidth(),o=e.getHeight(),c=[],l=1,u=1,h=0;h<this._kernel.length;h++){var f=this._kernel[h][2]+1;u<f&&(u=f)}for(h=0;h<u;h++)this._fillErrorLine(c[h]=[],s);for(var d=0;d<o;d++){this._serpentine&&(l*=-1);var p=d*s,m=1==l?0:s-1,b=1==l?s:-1;this._fillErrorLine(c[0],s),c.push(c.shift());for(var v=c[0],g=m,y=p+m;g!==b;g+=l,y+=l){var _=r[y],w=v[g];a.from(_);var x=i.Point.createByRGBA(n.inRange0to255Rounded(_.r+w[0]),n.inRange0to255Rounded(_.g+w[1]),n.inRange0to255Rounded(_.b+w[2]),n.inRange0to255Rounded(_.a+w[3])),k=t.getNearestColor(this._distance,x);if(_.from(k),!(this._minColorDistance&&this._distance.calculateNormalized(_,k)<this._minColorDistance)){var S=void 0,C=void 0,U=void 0,E=void 0;this._calculateErrorLikeGIMP?(S=x.r-k.r,C=x.g-k.g,U=x.b-k.b,E=x.a-k.a):(S=a.r-k.r,C=a.g-k.g,U=a.b-k.b,E=a.a-k.a);var T=1==l?0:this._kernel.length-1,M=1==l?this._kernel.length:-1;for(h=T;h!==M;h+=l){var O=this._kernel[h][1]*l,P=this._kernel[h][2];if(O+g>=0&&O+g<s&&P+d>=0&&P+d<o){var A=this._kernel[h][0],I=c[P][O+g];I[0]=I[0]+S*A,I[1]=I[1]+C*A,I[2]=I[2]+U*A,I[3]=I[3]+E*A}}}}}return e},e.prototype._fillErrorLine=function(e,t){e.length>t&&(e.length=t);for(var r=e.length,i=0;i<r;i++){var n=e[i];n[0]=n[1]=n[2]=n[3]=0}for(i=r;i<t;i++)e[i]=[0,0,0,0]},e.prototype._setKernel=function(e){switch(e){case a.FloydSteinberg:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case a.FalseFloydSteinberg:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case a.Stucki:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case a.Atkinson:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case a.Jarvis:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case a.Burkes:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case a.Sierra:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case a.TwoSierra:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case a.SierraLite:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error("ErrorDiffusionArray: unknown kernel = "+e)}},e}();t.ErrorDiffusionArray=s},function(e,t,r){var i=r(34),n=r(24),a=r(6),s=function(){function e(e,t,r){void 0===t&&(t=16),void 0===r&&(r=1),this._distance=e,this._errorPropagation=r,this._errorQueueSize=t,this._max=this._errorQueueSize,this._createWeights()}return e.prototype.quantize=function(e,t){for(var r=this,s=new i.HilbertCurveBase,o=e.getPointArray(),c=e.getWidth(),l=e.getHeight(),u=[],h=0,f=0;f<this._errorQueueSize;f++)u[f]={r:0,g:0,b:0,a:0};return s.walk(c,l,(function(e,i){for(var s=o[e+i*c],l=s.r,f=s.g,d=s.b,p=s.a,m=0;m<r._errorQueueSize;m++){var b=r._weights[m],v=u[(m+h)%r._errorQueueSize];l+=v.r*b,f+=v.g*b,d+=v.b*b,p+=v.a*b}var g=n.Point.createByRGBA(a.inRange0to255Rounded(l),a.inRange0to255Rounded(f),a.inRange0to255Rounded(d),a.inRange0to255Rounded(p)),y=t.getNearestColor(r._distance,g),_=((h=(h+1)%r._errorQueueSize)+r._errorQueueSize-1)%r._errorQueueSize;u[_].r=s.r-y.r,u[_].g=s.g-y.g,u[_].b=s.b-y.b,u[_].a=s.a-y.a,s.from(y)})),e},e.prototype._createWeights=function(){this._weights=[];for(var e=Math.exp(Math.log(this._max)/(this._errorQueueSize-1)),t=0,r=1;t<this._errorQueueSize;t++)this._weights[t]=(r+.5|0)/this._max*this._errorPropagation,r*=e},e}();t.ErrorDiffusionRiemersma=s},function(e,t){var r;!function(e){e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.DOWN=4]="DOWN"}(r||(r={}));var i=function(){function e(){}return e.prototype.walk=function(e,t,i){this._x=0,this._y=0,this._d=0,this._width=e,this._height=t,this._callback=i;var n=Math.max(e,t);this._level=Math.log(n)/Math.log(2)+1|0,this._walkHilbert(r.UP),this._visit(r.NONE)},e.prototype._walkHilbert=function(e){if(!(this._level<1)){switch(this._level--,e){case r.LEFT:this._walkHilbert(r.UP),this._visit(r.RIGHT),this._walkHilbert(r.LEFT),this._visit(r.DOWN),this._walkHilbert(r.LEFT),this._visit(r.LEFT),this._walkHilbert(r.DOWN);break;case r.RIGHT:this._walkHilbert(r.DOWN),this._visit(r.LEFT),this._walkHilbert(r.RIGHT),this._visit(r.UP),this._walkHilbert(r.RIGHT),this._visit(r.RIGHT),this._walkHilbert(r.UP);break;case r.UP:this._walkHilbert(r.LEFT),this._visit(r.DOWN),this._walkHilbert(r.UP),this._visit(r.RIGHT),this._walkHilbert(r.UP),this._visit(r.UP),this._walkHilbert(r.RIGHT);break;case r.DOWN:this._walkHilbert(r.RIGHT),this._visit(r.UP),this._walkHilbert(r.DOWN),this._visit(r.LEFT),this._walkHilbert(r.DOWN),this._visit(r.DOWN),this._walkHilbert(r.LEFT)}this._level++}},e.prototype._visit=function(e){switch(this._x>=0&&this._x<this._width&&this._y>=0&&this._y<this._height&&(this._callback(this._x,this._y,this._d),this._d++),e){case r.LEFT:this._x--;break;case r.RIGHT:this._x++;break;case r.UP:this._y--;break;case r.DOWN:this._y++}},e}();t.HilbertCurveBase=i},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * iq.ts - Image Quantization Library
      		 */
var i=r(36);t.SSIM=i.SSIM},function(e,t,r){var i=r(2),n=.01,a=.03,s=function(){function e(){}return e.prototype.compare=function(e,t){if(e.getHeight()!==t.getHeight()||e.getWidth()!==t.getWidth())throw new Error("Images have different sizes!");var r=255,i=Math.pow(n*r,2),s=Math.pow(a*r,2),o=0,c=0;return this._iterate(e,t,(function(e,t,r,n){for(var a=0,l=0,u=0,h=0;h<e.length;h++)l+=Math.pow(e[h]-r,2),u+=Math.pow(t[h]-n,2),a+=(e[h]-r)*(t[h]-n);var f=e.length-1;l/=f,u/=f;var d=(2*r*n+i)*(2*(a/=f)+s),p=(Math.pow(r,2)+Math.pow(n,2)+i)*(l+u+s);c+=d/p,o++})),c/o},e.prototype._iterate=function(e,t,r){for(var i=8,n=e.getWidth(),a=e.getHeight(),s=0;s<a;s+=i)for(var o=0;o<n;o+=i){var c=Math.min(i,n-o),l=Math.min(i,a-s),u=this._calculateLumaValuesForWindow(e,o,s,c,l),h=this._calculateLumaValuesForWindow(t,o,s,c,l);r(u,h,this._calculateAverageLuma(u),this._calculateAverageLuma(h))}},e.prototype._calculateLumaValuesForWindow=function(e,t,r,n,a){for(var s=e.getPointArray(),o=[],c=0,l=r;l<r+a;l++)for(var u=l*e.getWidth(),h=t;h<t+n;h++){var f=s[u+h];o[c]=f.r*i.Y.RED+f.g*i.Y.GREEN+f.b*i.Y.BLUE,c++}return o},e.prototype._calculateAverageLuma=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length},e}();t.SSIM=s},function(e,t,r){
/**
      		 * @preserve
      		 * Copyright 2015-2016 Igor Bezkrovnyi
      		 * All rights reserved. (MIT Licensed)
      		 *
      		 * iq.ts - Image Quantization Library
      		 */
var i=r(6);t.arithmetic=i;var n=r(28);t.HueStatistics=n.HueStatistics;var a=r(22);t.Palette=a.Palette;var s=r(24);t.Point=s.Point;var o=r(23);t.PointContainer=o.PointContainer}])}))},{}],75:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},{}],76:[function(e,t,r){function i(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function n(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&i(e.slice(0,0))}
/*!
      	 * Determine if an object is a Buffer
      	 *
      	 * @author   Feross Aboukhadijeh <https://feross.org>
      	 * @license  MIT
      	 */
t.exports=function(e){return null!=e&&(i(e)||n(e)||!!e._isBuffer)}},{}],77:[function(e,t,r){var i=Function.prototype.toString,n=/^\s*class\b/,a=function(e){try{var t=i.call(e);return n.test(t)}catch(r){return!1}},s=function(e){try{return!a(e)&&(i.call(e),!0)}catch(t){return!1}},o=Object.prototype.toString,c="[object Function]",l="[object GeneratorFunction]",u="function"==typeof Symbol&&"symbol"===_(Symbol.toStringTag);t.exports=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!==_(e))return!1;if("function"==typeof e&&!e.prototype)return!0;if(u)return s(e);if(a(e))return!1;var t=o.call(e);return t===c||t===l}},{}],78:[function(e,t,r){t.exports=n;var i=Object.prototype.toString;function n(e){var t=i.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||void 0!==a&&(e===a.setTimeout||e===a.alert||e===a.confirm||e===a.prompt)}},{}],79:[function(e,t,r){var i={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},{}],80:[function(e,t,r){var i=e("./lib/encoder"),n=e("./lib/decoder");t.exports={encode:i,decode:n}},{"./lib/decoder":81,"./lib/encoder":82}],81:[function(e,t,i){(function(e){var i=function(){var e=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,r=799,i=3406,n=2276,a=1567,s=3784,o=5793,c=2896;function l(){}function u(e,t){for(var r,i,n=0,a=[],s=16;s>0&&!e[s-1];)s--;a.push({children:[],index:0});var o,c=a[0];for(r=0;r<s;r++){for(i=0;i<e[r];i++){for((c=a.pop()).children[c.index]=t[n];c.index>0;){if(0===a.length)throw new Error("Could not recreate Huffman Table");c=a.pop()}for(c.index++,a.push(c);a.length<=r;)a.push(o={children:[],index:0}),c.children[c.index]=o.children,c=o;n++}r+1<s&&(a.push(o={children:[],index:0}),c.children[c.index]=o.children,c=o)}return a[0].children}function h(t,r,i,n,a,s,o,c,l,u){i.precision,i.samplesPerLine,i.scanLines;var h=i.mcusPerLine,f=i.progressive;i.maxH,i.maxV;var d=r,p=0,m=0;function b(){if(m>0)return m--,p>>m&1;if(255==(p=t[r++])){var e=t[r++];if(e)throw new Error("unexpected marker: "+(p<<8|e).toString(16))}return m=7,p>>>7}function v(e){for(var t,r=e;null!==(t=b());){if("number"==typeof(r=r[t]))return r;if("object"!==_(r))throw new Error("invalid huffman sequence")}return null}function g(e){for(var t=0;e>0;){var r=b();if(null===r)return;t=t<<1|r,e--}return t}function y(e){var t=g(e);return t>=1<<e-1?t:t+(-1<<e)+1}function w(t,r){var i=v(t.huffmanTableDC),n=0===i?0:y(i);r[0]=t.pred+=n;for(var a=1;a<64;){var s=v(t.huffmanTableAC),o=15&s,c=s>>4;if(0!==o)r[e[a+=c]]=y(o),a++;else{if(c<15)break;a+=16}}}function x(e,t){var r=v(e.huffmanTableDC),i=0===r?0:y(r)<<l;t[0]=e.pred+=i}function k(e,t){t[0]|=b()<<l}var S=0;function C(t,r){if(S>0)S--;else for(var i=s,n=o;i<=n;){var a=v(t.huffmanTableAC),c=15&a,u=a>>4;if(0!==c)r[e[i+=u]]=y(c)*(1<<l),i++;else{if(u<15){S=g(u)+(1<<u)-1;break}i+=16}}}var U,E=0;function T(t,r){for(var i=s,n=o,a=0;i<=n;){var c=e[i],u=r[c]<0?-1:1;switch(E){case 0:var h=v(t.huffmanTableAC),f=15&h;if(a=h>>4,0===f)a<15?(S=g(a)+(1<<a),E=4):(a=16,E=1);else{if(1!==f)throw new Error("invalid ACn encoding");U=y(f),E=a?2:3}continue;case 1:case 2:r[c]?r[c]+=(b()<<l)*u:0==--a&&(E=2==E?3:0);break;case 3:r[c]?r[c]+=(b()<<l)*u:(r[c]=U<<l,E=0);break;case 4:r[c]&&(r[c]+=(b()<<l)*u)}i++}4===E&&0==--S&&(E=0)}function M(e,t,r,i,n){var a=r%h,s=(r/h|0)*e.v+i,o=a*e.h+n;void 0===e.blocks[s]&&u.tolerantDecoding||t(e,e.blocks[s][o])}function O(e,t,r){var i=r/e.blocksPerLine|0,n=r%e.blocksPerLine;void 0===e.blocks[i]&&u.tolerantDecoding||t(e,e.blocks[i][n])}var P,A,I,L,j,R,D=n.length;R=f?0===s?0===c?x:k:0===c?C:T:w;var B,F,N,z,H=0;for(F=1==D?n[0].blocksPerLine*n[0].blocksPerColumn:h*i.mcusPerColumn,a||(a=F);H<F;){for(A=0;A<D;A++)n[A].pred=0;if(S=0,1==D)for(P=n[0],j=0;j<a;j++)O(P,R,H),H++;else for(j=0;j<a;j++){for(A=0;A<D;A++)for(N=(P=n[A]).h,z=P.v,I=0;I<z;I++)for(L=0;L<N;L++)M(P,R,H,I,L);if(++H===F)break}if(H===F)do{if(255===t[r]&&0!==t[r+1])break;r+=1}while(r<t.length-2);if(m=0,(B=t[r]<<8|t[r+1])<65280)throw new Error("marker was not found");if(!(B>=65488&&B<=65495))break;r+=2}return r-d}function f(e,l){var u,h,f=[],d=l.blocksPerLine,p=l.blocksPerColumn,m=d<<3,v=new Int32Array(64),g=new Uint8Array(64);function y(e,u,h){var f,d,p,m,b,v,g,y,_,w,x=l.quantizationTable,k=h;for(w=0;w<64;w++)k[w]=e[w]*x[w];for(w=0;w<8;++w){var S=8*w;0!=k[1+S]||0!=k[2+S]||0!=k[3+S]||0!=k[4+S]||0!=k[5+S]||0!=k[6+S]||0!=k[7+S]?(f=o*k[0+S]+128>>8,d=o*k[4+S]+128>>8,p=k[2+S],m=k[6+S],b=c*(k[1+S]-k[7+S])+128>>8,y=c*(k[1+S]+k[7+S])+128>>8,v=k[3+S]<<4,g=k[5+S]<<4,_=f-d+1>>1,f=f+d+1>>1,d=_,_=p*s+m*a+128>>8,p=p*a-m*s+128>>8,m=_,_=b-g+1>>1,b=b+g+1>>1,g=_,_=y+v+1>>1,v=y-v+1>>1,y=_,_=f-m+1>>1,f=f+m+1>>1,m=_,_=d-p+1>>1,d=d+p+1>>1,p=_,_=b*n+y*i+2048>>12,b=b*i-y*n+2048>>12,y=_,_=v*r+g*t+2048>>12,v=v*t-g*r+2048>>12,g=_,k[0+S]=f+y,k[7+S]=f-y,k[1+S]=d+g,k[6+S]=d-g,k[2+S]=p+v,k[5+S]=p-v,k[3+S]=m+b,k[4+S]=m-b):(_=o*k[0+S]+512>>10,k[0+S]=_,k[1+S]=_,k[2+S]=_,k[3+S]=_,k[4+S]=_,k[5+S]=_,k[6+S]=_,k[7+S]=_)}for(w=0;w<8;++w){var C=w;0!=k[8+C]||0!=k[16+C]||0!=k[24+C]||0!=k[32+C]||0!=k[40+C]||0!=k[48+C]||0!=k[56+C]?(f=o*k[0+C]+2048>>12,d=o*k[32+C]+2048>>12,p=k[16+C],m=k[48+C],b=c*(k[8+C]-k[56+C])+2048>>12,y=c*(k[8+C]+k[56+C])+2048>>12,v=k[24+C],g=k[40+C],_=f-d+1>>1,f=f+d+1>>1,d=_,_=p*s+m*a+2048>>12,p=p*a-m*s+2048>>12,m=_,_=b-g+1>>1,b=b+g+1>>1,g=_,_=y+v+1>>1,v=y-v+1>>1,y=_,_=f-m+1>>1,f=f+m+1>>1,m=_,_=d-p+1>>1,d=d+p+1>>1,p=_,_=b*n+y*i+2048>>12,b=b*i-y*n+2048>>12,y=_,_=v*r+g*t+2048>>12,v=v*t-g*r+2048>>12,g=_,k[0+C]=f+y,k[56+C]=f-y,k[8+C]=d+g,k[48+C]=d-g,k[16+C]=p+v,k[40+C]=p-v,k[24+C]=m+b,k[32+C]=m-b):(_=o*h[w+0]+8192>>14,k[0+C]=_,k[8+C]=_,k[16+C]=_,k[24+C]=_,k[32+C]=_,k[40+C]=_,k[48+C]=_,k[56+C]=_)}for(w=0;w<64;++w){var U=128+(k[w]+8>>4);u[w]=U<0?0:U>255?255:U}}b(m*p*8);for(var _=0;_<p;_++){var w=_<<3;for(u=0;u<8;u++)f.push(new Uint8Array(m));for(var x=0;x<d;x++){y(l.blocks[_][x],g,v);var k=0,S=x<<3;for(h=0;h<8;h++){var C=f[w+h];for(u=0;u<8;u++)C[S+u]=g[k++]}}}return f}function d(e){return e<0?0:e>255?255:e}l.prototype={load:function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){var e=new Uint8Array(t.response||t.mozResponseArrayBuffer);this.parse(e),this.onload&&this.onload()}.bind(this),t.send(null)},parse:function(t){var r=1e3*this.opts.maxResolutionInMP*1e3,i=0;function n(){var e=t[i]<<8|t[i+1];return i+=2,e}function a(){var e=n(),r=t.subarray(i,i+e-2);return i+=r.length,r}function s(e){var t,r,i=0,n=0;for(r in e.components)e.components.hasOwnProperty(r)&&(i<(t=e.components[r]).h&&(i=t.h),n<t.v&&(n=t.v));var a=Math.ceil(e.samplesPerLine/8/i),s=Math.ceil(e.scanLines/8/n);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];var o=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/i),c=Math.ceil(Math.ceil(e.scanLines/8)*t.v/n),l=a*t.h,u=s*t.v,h=[];b(u*l*256);for(var f=0;f<u;f++){for(var d=[],p=0;p<l;p++)d.push(new Int32Array(64));h.push(d)}t.blocksPerLine=o,t.blocksPerColumn=c,t.blocks=h}e.maxH=i,e.maxV=n,e.mcusPerLine=a,e.mcusPerColumn=s}t.length;var o,c,l=null,d=null,p=[],m=[],v=[],g=[],y=n();if(65496!=y)throw new Error("SOI not found");for(y=n();65497!=y;){switch(y){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var _=a();65504===y&&74===_[0]&&70===_[1]&&73===_[2]&&70===_[3]&&0===_[4]&&(l={version:{major:_[5],minor:_[6]},densityUnits:_[7],xDensity:_[8]<<8|_[9],yDensity:_[10]<<8|_[11],thumbWidth:_[12],thumbHeight:_[13],thumbData:_.subarray(14,14+3*_[12]*_[13])}),65505===y&&69===_[0]&&120===_[1]&&105===_[2]&&102===_[3]&&0===_[4]&&(this.exifBuffer=_.subarray(5,_.length)),65518===y&&65===_[0]&&100===_[1]&&111===_[2]&&98===_[3]&&101===_[4]&&0===_[5]&&(d={version:_[6],flags0:_[7]<<8|_[8],flags1:_[9]<<8|_[10],transformCode:_[11]});break;case 65499:for(var w=n()+i-2;i<w;){var x=t[i++];b(256);var k=new Int32Array(64);if(x>>4==0)for(Y=0;Y<64;Y++)k[e[Y]]=t[i++];else{if(x>>4!=1)throw new Error("DQT: invalid table spec");for(Y=0;Y<64;Y++)k[e[Y]]=n()}p[15&x]=k}break;case 65472:case 65473:case 65474:n(),(o={}).extended=65473===y,o.progressive=65474===y,o.precision=t[i++],o.scanLines=n(),o.samplesPerLine=n(),o.components={},o.componentsOrder=[];var S=o.scanLines*o.samplesPerLine;if(S>r){var C=Math.ceil((S-r)/1e6);throw new Error("maxResolutionInMP limit exceeded by ".concat(C,"MP"))}var U,E=t[i++];for(G=0;G<E;G++){U=t[i];var T=t[i+1]>>4,M=15&t[i+1],O=t[i+2];o.componentsOrder.push(U),o.components[U]={h:T,v:M,quantizationIdx:O},i+=3}s(o),m.push(o);break;case 65476:var P=n();for(G=2;G<P;){var A=t[i++],I=new Uint8Array(16),L=0;for(Y=0;Y<16;Y++,i++)L+=I[Y]=t[i];b(16+L);var j=new Uint8Array(L);for(Y=0;Y<L;Y++,i++)j[Y]=t[i];G+=17+L,(A>>4==0?g:v)[15&A]=u(I,j)}break;case 65501:n(),c=n();break;case 65498:n();var R=t[i++],D=[];for(G=0;G<R;G++){X=o.components[t[i++]];var B=t[i++];X.huffmanTableDC=g[B>>4],X.huffmanTableAC=v[15&B],D.push(X)}var F=t[i++],N=t[i++],z=t[i++],H=h(t,i,o,D,c,F,N,z>>4,15&z,this.opts);i+=H;break;case 65535:255!==t[i]&&i--;break;default:if(255==t[i-3]&&t[i-2]>=192&&t[i-2]<=254){i-=3;break}throw new Error("unknown JPEG marker "+y.toString(16))}y=n()}if(1!=m.length)throw new Error("only single frame JPEGs supported");for(var G=0;G<m.length;G++){var W=m[G].components;for(var Y in W)W[Y].quantizationTable=p[W[Y].quantizationIdx],delete W[Y].quantizationIdx}for(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=l,this.adobe=d,this.components=[],G=0;G<o.componentsOrder.length;G++){var X=o.components[o.componentsOrder[G]];this.components.push({lines:f(o,X),scaleX:X.h/o.maxH,scaleY:X.v/o.maxV})}},getData:function(e,t){var r,i,n,a,s,o,c,l,u,h,f,p,m,v,g,y,_,w,x,k,S,C=this.width/e,U=this.height/t,E=0,T=e*t*this.components.length;b(T);var M=new Uint8Array(T);switch(this.components.length){case 1:for(r=this.components[0],h=0;h<t;h++)for(s=r.lines[0|h*r.scaleY*U],u=0;u<e;u++)f=s[0|u*r.scaleX*C],M[E++]=f;break;case 2:for(r=this.components[0],i=this.components[1],h=0;h<t;h++)for(s=r.lines[0|h*r.scaleY*U],o=i.lines[0|h*i.scaleY*U],u=0;u<e;u++)f=s[0|u*r.scaleX*C],M[E++]=f,f=o[0|u*i.scaleX*C],M[E++]=f;break;case 3:for(S=!0,this.adobe&&this.adobe.transformCode?S=!0:void 0!==this.opts.colorTransform&&(S=!!this.opts.colorTransform),r=this.components[0],i=this.components[1],n=this.components[2],h=0;h<t;h++)for(s=r.lines[0|h*r.scaleY*U],o=i.lines[0|h*i.scaleY*U],c=n.lines[0|h*n.scaleY*U],u=0;u<e;u++)S?(f=s[0|u*r.scaleX*C],p=o[0|u*i.scaleX*C],w=d(f+1.402*((m=c[0|u*n.scaleX*C])-128)),x=d(f-.3441363*(p-128)-.71413636*(m-128)),k=d(f+1.772*(p-128))):(w=s[0|u*r.scaleX*C],x=o[0|u*i.scaleX*C],k=c[0|u*n.scaleX*C]),M[E++]=w,M[E++]=x,M[E++]=k;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(S=!1,this.adobe&&this.adobe.transformCode?S=!0:void 0!==this.opts.colorTransform&&(S=!!this.opts.colorTransform),r=this.components[0],i=this.components[1],n=this.components[2],a=this.components[3],h=0;h<t;h++)for(s=r.lines[0|h*r.scaleY*U],o=i.lines[0|h*i.scaleY*U],c=n.lines[0|h*n.scaleY*U],l=a.lines[0|h*a.scaleY*U],u=0;u<e;u++)S?(f=s[0|u*r.scaleX*C],p=o[0|u*i.scaleX*C],m=c[0|u*n.scaleX*C],v=l[0|u*a.scaleX*C],g=255-d(f+1.402*(m-128)),y=255-d(f-.3441363*(p-128)-.71413636*(m-128)),_=255-d(f+1.772*(p-128))):(g=s[0|u*r.scaleX*C],y=o[0|u*i.scaleX*C],_=c[0|u*n.scaleX*C],v=l[0|u*a.scaleX*C]),M[E++]=255-g,M[E++]=255-y,M[E++]=255-_,M[E++]=255-v;break;default:throw new Error("Unsupported color mode")}return M},copyToImageData:function(e,t){var r,i,n,a,s,o,c,l,u,h=e.width,f=e.height,p=e.data,m=this.getData(h,f),b=0,v=0;switch(this.components.length){case 1:for(i=0;i<f;i++)for(r=0;r<h;r++)n=m[b++],p[v++]=n,p[v++]=n,p[v++]=n,t&&(p[v++]=255);break;case 3:for(i=0;i<f;i++)for(r=0;r<h;r++)c=m[b++],l=m[b++],u=m[b++],p[v++]=c,p[v++]=l,p[v++]=u,t&&(p[v++]=255);break;case 4:for(i=0;i<f;i++)for(r=0;r<h;r++)s=m[b++],o=m[b++],n=m[b++],c=255-d(s*(1-(a=m[b++])/255)+a),l=255-d(o*(1-a/255)+a),u=255-d(n*(1-a/255)+a),p[v++]=c,p[v++]=l,p[v++]=u,t&&(p[v++]=255);break;default:throw new Error("Unsupported color mode")}}};var p=0,m=0;function b(){var e=p+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0);if(e>m){var t=Math.ceil((e-m)/1024/1024);throw new Error("maxMemoryUsageInMB limit exceeded by at least ".concat(t,"MB"))}p=e}return l.resetMaxMemoryUsage=function(e){p=0,m=e},l.getBytesAllocated=function(){return p},l.requestMemoryAllocation=b,l}();function n(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r(r({},{colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512}),n),s=new Uint8Array(t),o=new i;o.opts=a,i.resetMaxMemoryUsage(1024*a.maxMemoryUsageInMB*1024),o.parse(s);var c=a.formatAsRGBA?4:3,l=o.width*o.height*c;try{i.requestMemoryAllocation(l);var u={width:o.width,height:o.height,exifBuffer:o.exifBuffer,data:a.useTArray?new Uint8Array(l):new e(l)}}catch(h){throw h instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+l):h}return o.copyToImageData(u,a.formatAsRGBA),u}void 0!==t?t.exports=n:void 0!==a&&(a["jpeg-js"]=a["jpeg-js"]||{},a["jpeg-js"].decode=n)}).call(this,e("buffer").Buffer)},{buffer:48}],82:[function(e,t,r){(function(e){function r(r){var i,n,a,s,o,c=Math.floor,l=new Array(64),u=new Array(64),h=new Array(64),f=new Array(64),d=new Array(65535),p=new Array(65535),m=new Array(64),b=new Array(64),v=[],g=0,y=7,_=new Array(64),w=new Array(64),x=new Array(64),k=new Array(256),S=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],U=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],M=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],I=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var i=c((t[r]*e+50)/100);i<1?i=1:i>255&&(i=255),l[C[r]]=i}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a=0;a<64;a++){var s=c((n[a]*e+50)/100);s<1?s=1:s>255&&(s=255),u[C[a]]=s}for(var o=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],d=0,p=0;p<8;p++)for(var m=0;m<8;m++)h[d]=1/(l[C[d]]*o[p]*o[m]*8),f[d]=1/(u[C[d]]*o[p]*o[m]*8),d++}function j(e,t){for(var r=0,i=0,n=new Array,a=1;a<=16;a++){for(var s=1;s<=e[a];s++)n[t[i]]=[],n[t[i]][0]=r,n[t[i]][1]=a,i++,r++;r*=2}return n}function R(){i=j(U,E),n=j(O,P),a=j(T,M),s=j(A,I)}function D(){for(var e=1,t=2,r=1;r<=15;r++){for(var i=e;i<t;i++)p[32767+i]=r,d[32767+i]=[],d[32767+i][1]=r,d[32767+i][0]=i;for(var n=-(t-1);n<=-e;n++)p[32767+n]=r,d[32767+n]=[],d[32767+n][1]=r,d[32767+n][0]=t-1+n;e<<=1,t<<=1}}function B(){for(var e=0;e<256;e++)S[e]=19595*e,S[e+256>>0]=38470*e,S[e+512>>0]=7471*e+32768,S[e+768>>0]=-11059*e,S[e+1024>>0]=-21709*e,S[e+1280>>0]=32768*e+8421375,S[e+1536>>0]=-27439*e,S[e+1792>>0]=-5329*e}function F(e){for(var t=e[0],r=e[1]-1;r>=0;)t&1<<r&&(g|=1<<y),r--,--y<0&&(255==g?(N(255),N(0)):N(g),y=7,g=0)}function N(e){v.push(e)}function z(e){N(e>>8&255),N(255&e)}function H(e,t){var r,i,n,a,s,o,c,l,u,h,f=0,d=8,p=64;for(u=0;u<d;++u){r=e[f],i=e[f+1],n=e[f+2],a=e[f+3],s=e[f+4],o=e[f+5],c=e[f+6];var b=r+(l=e[f+7]),v=r-l,g=i+c,y=i-c,_=n+o,w=n-o,x=a+s,k=a-s,S=b+x,C=b-x,U=g+_,E=g-_;e[f]=S+U,e[f+4]=S-U;var T=.707106781*(E+C);e[f+2]=C+T,e[f+6]=C-T;var M=.382683433*((S=k+w)-(E=y+v)),O=.5411961*S+M,P=1.306562965*E+M,A=.707106781*(U=w+y),I=v+A,L=v-A;e[f+5]=L+O,e[f+3]=L-O,e[f+1]=I+P,e[f+7]=I-P,f+=8}for(f=0,u=0;u<d;++u){r=e[f],i=e[f+8],n=e[f+16],a=e[f+24],s=e[f+32],o=e[f+40],c=e[f+48];var j=r+(l=e[f+56]),R=r-l,D=i+c,B=i-c,F=n+o,N=n-o,z=a+s,H=a-s,G=j+z,W=j-z,Y=D+F,X=D-F;e[f]=G+Y,e[f+32]=G-Y;var V=.707106781*(X+W);e[f+16]=W+V,e[f+48]=W-V;var q=.382683433*((G=H+N)-(X=B+R)),Z=.5411961*G+q,K=1.306562965*X+q,J=.707106781*(Y=N+B),Q=R+J,$=R-J;e[f+40]=$+Z,e[f+24]=$-Z,e[f+8]=Q+K,e[f+56]=Q-K,f++}for(u=0;u<p;++u)h=e[u]*t[u],m[u]=h>0?h+.5|0:h-.5|0;return m}function G(){z(65504),z(16),N(74),N(70),N(73),N(70),N(0),N(1),N(1),N(0),z(1),z(1),N(0),N(0)}function W(e){if(e){z(65505),69===e[0]&&120===e[1]&&105===e[2]&&102===e[3]?z(e.length+2):(z(e.length+5+2),N(69),N(120),N(105),N(102),N(0));for(var t=0;t<e.length;t++)N(e[t])}}function Y(e,t){z(65472),z(17),N(8),z(t),z(e),N(3),N(1),N(17),N(0),N(2),N(17),N(1),N(3),N(17),N(1)}function X(){z(65499),z(132),N(0);for(var e=0;e<64;e++)N(l[e]);N(1);for(var t=0;t<64;t++)N(u[t])}function V(){z(65476),z(418),N(0);for(var e=0;e<16;e++)N(U[e+1]);for(var t=0;t<=11;t++)N(E[t]);N(16);for(var r=0;r<16;r++)N(T[r+1]);for(var i=0;i<=161;i++)N(M[i]);N(1);for(var n=0;n<16;n++)N(O[n+1]);for(var a=0;a<=11;a++)N(P[a]);N(17);for(var s=0;s<16;s++)N(A[s+1]);for(var o=0;o<=161;o++)N(I[o])}function q(){z(65498),z(12),N(3),N(1),N(0),N(2),N(17),N(3),N(17),N(0),N(63),N(0)}function Z(e,t,r,i,n){for(var a,s=n[0],o=n[240],c=16,l=63,u=64,h=H(e,t),f=0;f<u;++f)b[C[f]]=h[f];var m=b[0]-r;r=b[0],0==m?F(i[0]):(F(i[p[a=32767+m]]),F(d[a]));for(var v=63;v>0&&0==b[v];v--);if(0==v)return F(s),r;for(var g,y=1;y<=v;){for(var _=y;0==b[y]&&y<=v;++y);var w=y-_;if(w>=c){g=w>>4;for(var x=1;x<=g;++x)F(o);w&=15}a=32767+b[y],F(n[(w<<4)+p[a]]),F(d[a]),y++}return v!=l&&F(s),r}function K(){for(var e=String.fromCharCode,t=0;t<256;t++)k[t]=e(t)}function J(e){e<=0&&(e=1),e>100&&(e=100),o!=e&&(L(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),o=e)}function Q(){(new Date).getTime(),r||(r=50),K(),R(),D(),B(),J(r),(new Date).getTime()}this.encode=function(r,o){(new Date).getTime(),o&&J(o),v=new Array,g=0,y=7,z(65496),G(),W(r.exifBuffer),X(),Y(r.width,r.height),V(),q();var c=0,l=0,u=0;g=0,y=7,this.encode.displayName="_encode_";for(var d,p,m,b,k,C,U,E,T,M=r.data,O=r.width,P=r.height,A=4*O,I=0;I<P;){for(d=0;d<A;){for(C=k=A*I+d,U=-1,E=0,T=0;T<64;T++)C=k+(E=T>>3)*A+(U=4*(7&T)),I+E>=P&&(C-=A*(I+1+E-P)),d+U>=A&&(C-=d+U-A+4),p=M[C++],m=M[C++],b=M[C++],_[T]=(S[p]+S[m+256>>0]+S[b+512>>0]>>16)-128,w[T]=(S[p+768>>0]+S[m+1024>>0]+S[b+1280>>0]>>16)-128,x[T]=(S[p+1280>>0]+S[m+1536>>0]+S[b+1792>>0]>>16)-128;c=Z(_,h,c,i,a),l=Z(w,f,l,n,s),u=Z(x,f,u,n,s),d+=32}I+=8}if(y>=0){var L=[];L[1]=y+1,L[0]=(1<<y+1)-1,F(L)}return z(65497),void 0===t?new Uint8Array(v):new e(v)},Q()}function i(e,t){return void 0===t&&(t=50),{data:new r(t).encode(e,t),width:e.width,height:e.height}}void 0!==t?t.exports=i:void 0!==a&&(a["jpeg-js"]=a["jpeg-js"]||{},a["jpeg-js"].encode=i)}).call(this,e("buffer").Buffer)},{buffer:48}],83:[function(e,t,r){(function(r){var i=e("path"),n=e("fs"),a=parseInt("0777",8);function s(e,t,o,c){"function"==typeof t?(o=t,t={}):t&&"object"===_(t)||(t={mode:t});var l=t.mode,u=t.fs||n;void 0===l&&(l=a&~r.umask()),c||(c=null);var h=o||function(){};e=i.resolve(e),u.mkdir(e,l,(function(r){if(!r)return h(null,c=c||e);"ENOENT"===r.code?s(i.dirname(e),t,(function(r,i){r?h(r,i):s(e,t,h,i)})):u.stat(e,(function(e,t){e||!t.isDirectory()?h(r,c):h(null,c)}))}))}t.exports=s.mkdirp=s.mkdirP=s,s.sync=function e(t,s,o){s&&"object"===_(s)||(s={mode:s});var c=s.mode,l=s.fs||n;void 0===c&&(c=a&~r.umask()),o||(o=null),t=i.resolve(t);try{l.mkdirSync(t,c),o=o||t}catch(h){if("ENOENT"===h.code)o=e(i.dirname(t),s,o),e(t,s,o);else{var u;try{u=l.statSync(t)}catch(f){throw h}if(!u.isDirectory())throw h}}return o}}).call(this,e("_process"))},{_process:133,fs:47,path:107}],84:[function(e,t,r){var i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function s(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function o(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(n){return!1}}t.exports=o()?Object.assign:function(e,t){for(var r,o,c=s(e),l=1;l<arguments.length;l++){for(var u in r=Object(arguments[l]))n.call(r,u)&&(c[u]=r[u]);if(i){o=i(r);for(var h=0;h<o.length;h++)a.call(r,o[h])&&(c[o[h]]=r[o[h]])}}return c}},{}],85:[function(e,t,r){arguments[4][64][0].apply(r,arguments)},{dup:64}],86:[function(e,t,r){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":87,"./lib/inflate":88,"./lib/utils/common":89,"./lib/zlib/constants":92}],87:[function(e,t,r){var i=e("./zlib/deflate"),n=e("./utils/common"),a=e("./utils/strings"),s=e("./zlib/messages"),o=e("./zlib/zstream"),c=Object.prototype.toString,l=0,u=4,h=0,f=1,d=2,p=-1,m=0,b=8;function v(e){if(!(this instanceof v))return new v(e);this.options=n.assign({level:p,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var r=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==h)throw new Error(s[r]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var l;if(l="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=i.deflateSetDictionary(this.strm,l))!==h)throw new Error(s[r]);this._dict_set=!0}}function g(e,t){var r=new v(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}function y(e,t){return(t=t||{}).raw=!0,g(e,t)}function _(e,t){return(t=t||{}).gzip=!0,g(e,t)}v.prototype.push=function(e,t){var r,s,o=this.strm,p=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?u:l,"string"==typeof e?o.input=a.string2buf(e):"[object ArrayBuffer]"===c.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new n.Buf8(p),o.next_out=0,o.avail_out=p),(r=i.deflate(o,s))!==f&&r!==h)return this.onEnd(r),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||s!==u&&s!==d)||("string"===this.options.to?this.onData(a.buf2binstring(n.shrinkBuf(o.output,o.next_out))):this.onData(n.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&r!==f);return s===u?(r=i.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===h):s!==d||(this.onEnd(h),o.avail_out=0,!0)},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=v,r.deflate=g,r.deflateRaw=y,r.gzip=_},{"./utils/common":89,"./utils/strings":90,"./zlib/deflate":94,"./zlib/messages":99,"./zlib/zstream":101}],88:[function(e,t,r){var i=e("./zlib/inflate"),n=e("./utils/common"),a=e("./utils/strings"),s=e("./zlib/constants"),o=e("./zlib/messages"),c=e("./zlib/zstream"),l=e("./zlib/gzheader"),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=i.inflateInit2(this.strm,t.windowBits);if(r!==s.Z_OK)throw new Error(o[r]);this.header=new l,i.inflateGetHeader(this.strm,this.header)}function f(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}function d(e,t){return(t=t||{}).raw=!0,f(e,t)}h.prototype.push=function(e,t){var r,o,c,l,h,f,d=this.strm,p=this.options.chunkSize,m=this.options.dictionary,b=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?d.input=a.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new n.Buf8(p),d.next_out=0,d.avail_out=p),(r=i.inflate(d,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&m&&(f="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,r=i.inflateSetDictionary(this.strm,f)),r===s.Z_BUF_ERROR&&!0===b&&(r=s.Z_OK,b=!1),r!==s.Z_STREAM_END&&r!==s.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&r!==s.Z_STREAM_END&&(0!==d.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(c=a.utf8border(d.output,d.next_out),l=d.next_out-c,h=a.buf2string(d.output,c),d.next_out=l,d.avail_out=p-l,l&&n.arraySet(d.output,d.output,c,l,0),this.onData(h)):this.onData(n.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(b=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==s.Z_STREAM_END);return r===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(r=i.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),d.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=h,r.inflate=f,r.inflateRaw=d,r.ungzip=f},{"./utils/common":89,"./utils/strings":90,"./zlib/constants":92,"./zlib/gzheader":95,"./zlib/inflate":97,"./zlib/messages":99,"./zlib/zstream":101}],89:[function(e,t,r){arguments[4][36][0].apply(r,arguments)},{dup:36}],90:[function(e,t,r){var i=e("./common"),n=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(l){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){a=!1}for(var s=new i.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function c(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var r="",s=0;s<t;s++)r+=String.fromCharCode(e[s]);return r}s[254]=s[254]=1,r.string2buf=function(e){var t,r,n,a,s,o=e.length,c=0;for(a=0;a<o;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),c+=r<128?1:r<2048?2:r<65536?3:4;for(t=new i.Buf8(c),s=0,a=0;s<c;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|63&r):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t},r.buf2binstring=function(e){return c(e,e.length)},r.binstring2buf=function(e){for(var t=new i.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,i,n,a,o=t||e.length,l=new Array(2*o);for(i=0,r=0;r<o;)if((n=e[r++])<128)l[i++]=n;else if((a=s[n])>4)l[i++]=65533,r+=a-1;else{for(n&=2===a?31:3===a?15:7;a>1&&r<o;)n=n<<6|63&e[r++],a--;a>1?l[i++]=65533:n<65536?l[i++]=n:(n-=65536,l[i++]=55296|n>>10&1023,l[i++]=56320|1023&n)}return c(l,i)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+s[e[r]]>t?r:t}},{"./common":89}],91:[function(e,t,r){arguments[4][37][0].apply(r,arguments)},{dup:37}],92:[function(e,t,r){arguments[4][38][0].apply(r,arguments)},{dup:38}],93:[function(e,t,r){arguments[4][39][0].apply(r,arguments)},{dup:39}],94:[function(e,t,r){var i,n=e("../utils/common"),a=e("./trees"),s=e("./adler32"),o=e("./crc32"),c=e("./messages"),l=0,u=1,h=3,f=4,d=5,p=0,m=1,b=-2,v=-3,g=-5,y=-1,_=1,w=2,x=3,k=4,S=0,C=2,U=8,E=9,T=15,M=8,O=286,P=30,A=19,I=2*O+1,L=15,j=3,R=258,D=R+j+1,B=32,F=42,N=69,z=73,H=91,G=103,W=113,Y=666,X=1,V=2,q=3,Z=4,K=3;function J(e,t){return e.msg=c[t],t}function Q(e){return(e<<1)-(e>4?9:0)}function $(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(n.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function te(e,t){a._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function re(e,t){e.pending_buf[e.pending++]=t}function ie(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function ne(e,t,r,i){var a=e.avail_in;return a>i&&(a=i),0===a?0:(e.avail_in-=a,n.arraySet(t,e.input,e.next_in,a,r),1===e.state.wrap?e.adler=s(e.adler,t,a,r):2===e.state.wrap&&(e.adler=o(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)}function ae(e,t){var r,i,n=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match,c=e.strstart>e.w_size-D?e.strstart-(e.w_size-D):0,l=e.window,u=e.w_mask,h=e.prev,f=e.strstart+R,d=l[a+s-1],p=l[a+s];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(l[(r=t)+s]===p&&l[r+s-1]===d&&l[r]===l[a]&&l[++r]===l[a+1]){a+=2,r++;do{}while(l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&a<f);if(i=R-(f-a),a=f-R,i>s){if(e.match_start=t,s=i,i>=o)break;d=l[a+s-1],p=l[a+s]}}}while((t=h[t&u])>c&&0!=--n);return s<=e.lookahead?s:e.lookahead}function se(e){var t,r,i,a,s,o=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-D)){n.arraySet(e.window,e.window,o,o,0),e.match_start-=o,e.strstart-=o,e.block_start-=o,t=r=e.hash_size;do{i=e.head[--t],e.head[t]=i>=o?i-o:0}while(--r);t=r=o;do{i=e.prev[--t],e.prev[t]=i>=o?i-o:0}while(--r);a+=o}if(0===e.strm.avail_in)break;if(r=ne(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=r,e.lookahead+e.insert>=j)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+j-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<j)););}while(e.lookahead<D&&0!==e.strm.avail_in)}function oe(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(se(e),0===e.lookahead&&t===l)return X;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+r;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,te(e,!1),0===e.strm.avail_out))return X;if(e.strstart-e.block_start>=e.w_size-D&&(te(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),X)}function ce(e,t){for(var r,i;;){if(e.lookahead<D){if(se(e),e.lookahead<D&&t===l)return X;if(0===e.lookahead)break}if(r=0,e.lookahead>=j&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-D&&(e.match_length=ae(e,r)),e.match_length>=j)if(i=a._tr_tally(e,e.strstart-e.match_start,e.match_length-j),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=j){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(te(e,!1),0===e.strm.avail_out))return X}return e.insert=e.strstart<j-1?e.strstart:j-1,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?X:V}function le(e,t){for(var r,i,n;;){if(e.lookahead<D){if(se(e),e.lookahead<D&&t===l)return X;if(0===e.lookahead)break}if(r=0,e.lookahead>=j&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=j-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-D&&(e.match_length=ae(e,r),e.match_length<=5&&(e.strategy===_||e.match_length===j&&e.strstart-e.match_start>4096)&&(e.match_length=j-1)),e.prev_length>=j&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-j,i=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-j),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=j-1,e.strstart++,i&&(te(e,!1),0===e.strm.avail_out))return X}else if(e.match_available){if((i=a._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return X}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<j-1?e.strstart:j-1,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?X:V}function ue(e,t){for(var r,i,n,s,o=e.window;;){if(e.lookahead<=R){if(se(e),e.lookahead<=R&&t===l)return X;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=j&&e.strstart>0&&(i=o[n=e.strstart-1])===o[++n]&&i===o[++n]&&i===o[++n]){s=e.strstart+R;do{}while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);e.match_length=R-(s-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=j?(r=a._tr_tally(e,1,e.match_length-j),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(te(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?X:V}function he(e,t){for(var r;;){if(0===e.lookahead&&(se(e),0===e.lookahead)){if(t===l)return X;break}if(e.match_length=0,r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(te(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===f?(te(e,!0),0===e.strm.avail_out?q:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?X:V}function fe(e,t,r,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=i,this.func=n}function de(e){e.window_size=2*e.w_size,$(e.head),e.max_lazy_match=i[e.level].max_lazy,e.good_match=i[e.level].good_length,e.nice_match=i[e.level].nice_length,e.max_chain_length=i[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=j-1,e.match_available=0,e.ins_h=0}function pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=U,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*I),this.dyn_dtree=new n.Buf16(2*(2*P+1)),this.bl_tree=new n.Buf16(2*(2*A+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(L+1),this.heap=new n.Buf16(2*O+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*O+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=C,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?F:W,e.adler=2===t.wrap?0:1,t.last_flush=l,a._tr_init(t),p):J(e,b)}function be(e){var t=me(e);return t===p&&de(e.state),t}function ve(e,t){return e&&e.state?2!==e.state.wrap?b:(e.state.gzhead=t,p):b}function ge(e,t,r,i,a,s){if(!e)return b;var o=1;if(t===y&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),a<1||a>E||r!==U||i<8||i>15||t<0||t>9||s<0||s>k)return J(e,b);8===i&&(i=9);var c=new pe;return e.state=c,c.strm=e,c.wrap=o,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+j-1)/j),c.window=new n.Buf8(2*c.w_size),c.head=new n.Buf16(c.hash_size),c.prev=new n.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new n.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=s,c.method=r,be(e)}function ye(e,t){return ge(e,t,U,T,M,S)}function _e(e,t){var r,n,s,c;if(!e||!e.state||t>d||t<0)return e?J(e,b):b;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===Y&&t!==f)return J(e,0===e.avail_out?g:b);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===F)if(2===n.wrap)e.adler=0,re(n,31),re(n,139),re(n,8),n.gzhead?(re(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),re(n,255&n.gzhead.time),re(n,n.gzhead.time>>8&255),re(n,n.gzhead.time>>16&255),re(n,n.gzhead.time>>24&255),re(n,9===n.level?2:n.strategy>=w||n.level<2?4:0),re(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(re(n,255&n.gzhead.extra.length),re(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=o(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=N):(re(n,0),re(n,0),re(n,0),re(n,0),re(n,0),re(n,9===n.level?2:n.strategy>=w||n.level<2?4:0),re(n,K),n.status=W);else{var v=U+(n.w_bits-8<<4)<<8;v|=(n.strategy>=w||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(v|=B),v+=31-v%31,n.status=W,ie(n,v),0!==n.strstart&&(ie(n,e.adler>>>16),ie(n,65535&e.adler)),e.adler=1}if(n.status===N)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),ee(e),s=n.pending,n.pending!==n.pending_buf_size));)re(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=z)}else n.status=z;if(n.status===z)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),ee(e),s=n.pending,n.pending===n.pending_buf_size)){c=1;break}c=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,re(n,c)}while(0!==c);n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),0===c&&(n.gzindex=0,n.status=H)}else n.status=H;if(n.status===H)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),ee(e),s=n.pending,n.pending===n.pending_buf_size)){c=1;break}c=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,re(n,c)}while(0!==c);n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),0===c&&(n.status=G)}else n.status=G;if(n.status===G&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ee(e),n.pending+2<=n.pending_buf_size&&(re(n,255&e.adler),re(n,e.adler>>8&255),e.adler=0,n.status=W)):n.status=W),0!==n.pending){if(ee(e),0===e.avail_out)return n.last_flush=-1,p}else if(0===e.avail_in&&Q(t)<=Q(r)&&t!==f)return J(e,g);if(n.status===Y&&0!==e.avail_in)return J(e,g);if(0!==e.avail_in||0!==n.lookahead||t!==l&&n.status!==Y){var y=n.strategy===w?he(n,t):n.strategy===x?ue(n,t):i[n.level].func(n,t);if(y!==q&&y!==Z||(n.status=Y),y===X||y===q)return 0===e.avail_out&&(n.last_flush=-1),p;if(y===V&&(t===u?a._tr_align(n):t!==d&&(a._tr_stored_block(n,0,0,!1),t===h&&($(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),ee(e),0===e.avail_out))return n.last_flush=-1,p}return t!==f?p:n.wrap<=0?m:(2===n.wrap?(re(n,255&e.adler),re(n,e.adler>>8&255),re(n,e.adler>>16&255),re(n,e.adler>>24&255),re(n,255&e.total_in),re(n,e.total_in>>8&255),re(n,e.total_in>>16&255),re(n,e.total_in>>24&255)):(ie(n,e.adler>>>16),ie(n,65535&e.adler)),ee(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?p:m)}function we(e){var t;return e&&e.state?(t=e.state.status)!==F&&t!==N&&t!==z&&t!==H&&t!==G&&t!==W&&t!==Y?J(e,b):(e.state=null,t===W?J(e,v):p):b}function xe(e,t){var r,i,a,o,c,l,u,h,f=t.length;if(!e||!e.state)return b;if(2===(o=(r=e.state).wrap)||1===o&&r.status!==F||r.lookahead)return b;for(1===o&&(e.adler=s(e.adler,t,f,0)),r.wrap=0,f>=r.w_size&&(0===o&&($(r.head),r.strstart=0,r.block_start=0,r.insert=0),h=new n.Buf8(r.w_size),n.arraySet(h,t,f-r.w_size,r.w_size,0),t=h,f=r.w_size),c=e.avail_in,l=e.next_in,u=e.input,e.avail_in=f,e.next_in=0,e.input=t,se(r);r.lookahead>=j;){i=r.strstart,a=r.lookahead-(j-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+j-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++}while(--a);r.strstart=i,r.lookahead=j-1,se(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=j-1,r.match_available=0,e.next_in=l,e.input=u,e.avail_in=c,r.wrap=o,p}i=[new fe(0,0,0,0,oe),new fe(4,4,8,4,ce),new fe(4,5,16,8,ce),new fe(4,6,32,32,ce),new fe(4,4,16,16,le),new fe(8,16,32,32,le),new fe(8,16,128,128,le),new fe(8,32,128,256,le),new fe(32,128,258,1024,le),new fe(32,258,258,4096,le)],r.deflateInit=ye,r.deflateInit2=ge,r.deflateReset=be,r.deflateResetKeep=me,r.deflateSetHeader=ve,r.deflate=_e,r.deflateEnd=we,r.deflateSetDictionary=xe,r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":89,"./adler32":91,"./crc32":93,"./messages":99,"./trees":100}],95:[function(e,t,r){function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=i},{}],96:[function(e,t,r){arguments[4][41][0].apply(r,arguments)},{dup:41}],97:[function(e,t,r){arguments[4][42][0].apply(r,arguments)},{"../utils/common":89,"./adler32":91,"./crc32":93,"./inffast":96,"./inftrees":98,dup:42}],98:[function(e,t,r){arguments[4][43][0].apply(r,arguments)},{"../utils/common":89,dup:43}],99:[function(e,t,r){arguments[4][44][0].apply(r,arguments)},{dup:44}],100:[function(e,t,r){var i=e("../utils/common"),n=4,a=0,s=1,o=2;function c(e){for(var t=e.length;--t>=0;)e[t]=0}var l=0,u=1,h=2,f=3,d=258,p=29,m=256,b=m+1+p,v=30,g=19,y=2*b+1,_=15,w=16,x=7,k=256,S=16,C=17,U=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,A=new Array(2*(b+2));c(A);var I=new Array(2*v);c(I);var L=new Array(P);c(L);var j=new Array(d-f+1);c(j);var R=new Array(p);c(R);var D,B,F,N=new Array(v);function z(e,t,r,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}function H(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function G(e){return e<256?L[e]:L[256+(e>>>7)]}function W(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function Y(e,t,r){e.bi_valid>w-r?(e.bi_buf|=t<<e.bi_valid&65535,W(e,e.bi_buf),e.bi_buf=t>>w-e.bi_valid,e.bi_valid+=r-w):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function X(e,t,r){Y(e,r[2*t],r[2*t+1])}function V(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function q(e){16===e.bi_valid?(W(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function Z(e,t){var r,i,n,a,s,o,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(a=0;a<=_;a++)e.bl_count[a]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<y;r++)(a=c[2*c[2*(i=e.heap[r])+1]+1]+1)>p&&(a=p,m++),c[2*i+1]=a,i>l||(e.bl_count[a]++,s=0,i>=d&&(s=f[i-d]),o=c[2*i],e.opt_len+=o*(a+s),h&&(e.static_len+=o*(u[2*i+1]+s)));if(0!==m){do{for(a=p-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(a=p;0!==a;a--)for(i=e.bl_count[a];0!==i;)(n=e.heap[--r])>l||(c[2*n+1]!==a&&(e.opt_len+=(a-c[2*n+1])*c[2*n],c[2*n+1]=a),i--)}}function K(e,t,r){var i,n,a=new Array(_+1),s=0;for(i=1;i<=_;i++)a[i]=s=s+r[i-1]<<1;for(n=0;n<=t;n++){var o=e[2*n+1];0!==o&&(e[2*n]=V(a[o]++,o))}}function J(){var e,t,r,i,n,a=new Array(_+1);for(r=0,i=0;i<p-1;i++)for(R[i]=r,e=0;e<1<<E[i];e++)j[r++]=i;for(j[r-1]=i,n=0,i=0;i<16;i++)for(N[i]=n,e=0;e<1<<T[i];e++)L[n++]=i;for(n>>=7;i<v;i++)for(N[i]=n<<7,e=0;e<1<<T[i]-7;e++)L[256+n++]=i;for(t=0;t<=_;t++)a[t]=0;for(e=0;e<=143;)A[2*e+1]=8,e++,a[8]++;for(;e<=255;)A[2*e+1]=9,e++,a[9]++;for(;e<=279;)A[2*e+1]=7,e++,a[7]++;for(;e<=287;)A[2*e+1]=8,e++,a[8]++;for(K(A,b+1,a),e=0;e<v;e++)I[2*e+1]=5,I[2*e]=V(e,5);D=new z(A,E,m+1,b,_),B=new z(I,T,0,v,_),F=new z(new Array(0),M,0,g,x)}function Q(e){var t;for(t=0;t<b;t++)e.dyn_ltree[2*t]=0;for(t=0;t<v;t++)e.dyn_dtree[2*t]=0;for(t=0;t<g;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*k]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function $(e){e.bi_valid>8?W(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function ee(e,t,r,n){$(e),n&&(W(e,r),W(e,~r)),i.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}function te(e,t,r,i){var n=2*t,a=2*r;return e[n]<e[a]||e[n]===e[a]&&i[t]<=i[r]}function re(e,t,r){for(var i=e.heap[r],n=r<<1;n<=e.heap_len&&(n<e.heap_len&&te(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!te(t,i,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=i}function ie(e,t,r){var i,n,a,s,o=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],n=e.pending_buf[e.l_buf+o],o++,0===i?X(e,n,t):(X(e,(a=j[n])+m+1,t),0!==(s=E[a])&&Y(e,n-=R[a],s),X(e,a=G(--i),r),0!==(s=T[a])&&Y(e,i-=N[a],s))}while(o<e.last_lit);X(e,k,t)}function ne(e,t){var r,i,n,a=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=y,r=0;r<c;r++)0!==a[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):a[2*r+1]=0;for(;e.heap_len<2;)a[2*(n=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[n]=0,e.opt_len--,o&&(e.static_len-=s[2*n+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)re(e,a,r);n=c;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],re(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=i,a[2*n]=a[2*r]+a[2*i],e.depth[n]=(e.depth[r]>=e.depth[i]?e.depth[r]:e.depth[i])+1,a[2*r+1]=a[2*i+1]=n,e.heap[1]=n++,re(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Z(e,t),K(a,l,e.bl_count)}function ae(e,t,r){var i,n,a=-1,s=t[1],o=0,c=7,l=4;for(0===s&&(c=138,l=3),t[2*(r+1)+1]=65535,i=0;i<=r;i++)n=s,s=t[2*(i+1)+1],++o<c&&n===s||(o<l?e.bl_tree[2*n]+=o:0!==n?(n!==a&&e.bl_tree[2*n]++,e.bl_tree[2*S]++):o<=10?e.bl_tree[2*C]++:e.bl_tree[2*U]++,o=0,a=n,0===s?(c=138,l=3):n===s?(c=6,l=3):(c=7,l=4))}function se(e,t,r){var i,n,a=-1,s=t[1],o=0,c=7,l=4;for(0===s&&(c=138,l=3),i=0;i<=r;i++)if(n=s,s=t[2*(i+1)+1],!(++o<c&&n===s)){if(o<l)do{X(e,n,e.bl_tree)}while(0!=--o);else 0!==n?(n!==a&&(X(e,n,e.bl_tree),o--),X(e,S,e.bl_tree),Y(e,o-3,2)):o<=10?(X(e,C,e.bl_tree),Y(e,o-3,3)):(X(e,U,e.bl_tree),Y(e,o-11,7));o=0,a=n,0===s?(c=138,l=3):n===s?(c=6,l=3):(c=7,l=4)}}function oe(e){var t;for(ae(e,e.dyn_ltree,e.l_desc.max_code),ae(e,e.dyn_dtree,e.d_desc.max_code),ne(e,e.bl_desc),t=g-1;t>=3&&0===e.bl_tree[2*O[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function ce(e,t,r,i){var n;for(Y(e,t-257,5),Y(e,r-1,5),Y(e,i-4,4),n=0;n<i;n++)Y(e,e.bl_tree[2*O[n]+1],3);se(e,e.dyn_ltree,t-1),se(e,e.dyn_dtree,r-1)}function le(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return s;for(t=32;t<m;t++)if(0!==e.dyn_ltree[2*t])return s;return a}c(N);var ue=!1;function he(e){ue||(J(),ue=!0),e.l_desc=new H(e.dyn_ltree,D),e.d_desc=new H(e.dyn_dtree,B),e.bl_desc=new H(e.bl_tree,F),e.bi_buf=0,e.bi_valid=0,Q(e)}function fe(e,t,r,i){Y(e,(l<<1)+(i?1:0),3),ee(e,t,r,!0)}function de(e){Y(e,u<<1,3),X(e,k,A),q(e)}function pe(e,t,r,i){var a,s,c=0;e.level>0?(e.strm.data_type===o&&(e.strm.data_type=le(e)),ne(e,e.l_desc),ne(e,e.d_desc),c=oe(e),a=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=a&&(a=s)):a=s=r+5,r+4<=a&&-1!==t?fe(e,t,r,i):e.strategy===n||s===a?(Y(e,(u<<1)+(i?1:0),3),ie(e,A,I)):(Y(e,(h<<1)+(i?1:0),3),ce(e,e.l_desc.max_code+1,e.d_desc.max_code+1,c+1),ie(e,e.dyn_ltree,e.dyn_dtree)),Q(e),i&&$(e)}function me(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(j[r]+m+1)]++,e.dyn_dtree[2*G(t)]++),e.last_lit===e.lit_bufsize-1}r._tr_init=he,r._tr_stored_block=fe,r._tr_flush_block=pe,r._tr_tally=me,r._tr_align=de},{"../utils/common":89}],101:[function(e,t,r){arguments[4][46][0].apply(r,arguments)},{dup:46}],102:[function(e,t,r){function i(e,t){if(!(e=e.replace(/\t+/g," ").trim()))return null;var r=e.indexOf(" ");if(-1===r)throw new Error("no named row at line "+t);var i=e.substring(0,r);e=(e=(e=(e=e.substring(r+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map((function(e){return e.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)}));for(var a=[],s=0;s<e.length;s++){var o=e[s];0===s?a.push({key:o[0],data:""}):s===e.length-1?a[a.length-1].data=n(o[0]):(a[a.length-1].data=n(o[0]),a.push({key:o[1],data:""}))}var c={key:i,data:{}};return a.forEach((function(e){c.data[e.key]=e.data})),c}function n(e){return e&&0!==e.length?0===e.indexOf('"')||0===e.indexOf("'")?e.substring(1,e.length-1):-1!==e.indexOf(",")?a(e):parseInt(e,10):""}function a(e){return e.split(",").map((function(e){return parseInt(e,10)}))}t.exports=function(e){if(!e)throw new Error("no data provided");var t={pages:[],chars:[],kernings:[]},r=(e=e.toString().trim()).split(/\r\n?|\n/g);if(0===r.length)throw new Error("no data in BMFont file");for(var n=0;n<r.length;n++){var a=i(r[n],n);if(a)if("page"===a.key){if("number"!=typeof a.data.id)throw new Error("malformed file at line "+n+" -- needs page id=N");if("string"!=typeof a.data.file)throw new Error("malformed file at line "+n+' -- needs page file="path"');t.pages[a.data.id]=a.data.file}else"chars"===a.key||"kernings"===a.key||("char"===a.key?t.chars.push(a.data):"kerning"===a.key?t.kernings.push(a.data):t[a.key]=a.data)}return t}},{}],103:[function(e,t,r){var i=[66,77,70];function n(e,t,r){if(r>t.length-1)return 0;var i=t.readUInt8(r++),n=t.readInt32LE(r);switch(r+=4,i){case 1:e.info=a(t,r);break;case 2:e.common=s(t,r);break;case 3:e.pages=o(t,r,n);break;case 4:e.chars=c(t,r,n);break;case 5:e.kernings=l(t,r,n)}return 5+n}function a(e,t){var r={};r.size=e.readInt16LE(t);var i=e.readUInt8(t+2);return r.smooth=i>>7&1,r.unicode=i>>6&1,r.italic=i>>5&1,r.bold=i>>4&1,i>>3&1&&(r.fixedHeight=1),r.charset=e.readUInt8(t+3)||"",r.stretchH=e.readUInt16LE(t+4),r.aa=e.readUInt8(t+6),r.padding=[e.readInt8(t+7),e.readInt8(t+8),e.readInt8(t+9),e.readInt8(t+10)],r.spacing=[e.readInt8(t+11),e.readInt8(t+12)],r.outline=e.readUInt8(t+13),r.face=h(e,t+14),r}function s(e,t){var r={};return r.lineHeight=e.readUInt16LE(t),r.base=e.readUInt16LE(t+2),r.scaleW=e.readUInt16LE(t+4),r.scaleH=e.readUInt16LE(t+6),r.pages=e.readUInt16LE(t+8),e.readUInt8(t+10),r.packed=0,r.alphaChnl=e.readUInt8(t+11),r.redChnl=e.readUInt8(t+12),r.greenChnl=e.readUInt8(t+13),r.blueChnl=e.readUInt8(t+14),r}function o(e,t,r){for(var i=[],n=u(e,t),a=n.length+1,s=r/a,o=0;o<s;o++)i[o]=e.slice(t,t+n.length).toString("utf8"),t+=a;return i}function c(e,t,r){for(var i=[],n=r/20,a=0;a<n;a++){var s={},o=20*a;s.id=e.readUInt32LE(t+0+o),s.x=e.readUInt16LE(t+4+o),s.y=e.readUInt16LE(t+6+o),s.width=e.readUInt16LE(t+8+o),s.height=e.readUInt16LE(t+10+o),s.xoffset=e.readInt16LE(t+12+o),s.yoffset=e.readInt16LE(t+14+o),s.xadvance=e.readInt16LE(t+16+o),s.page=e.readUInt8(t+18+o),s.chnl=e.readUInt8(t+19+o),i[a]=s}return i}function l(e,t,r){for(var i=[],n=r/10,a=0;a<n;a++){var s={},o=10*a;s.first=e.readUInt32LE(t+0+o),s.second=e.readUInt32LE(t+4+o),s.amount=e.readInt16LE(t+8+o),i[a]=s}return i}function u(e,t){for(var r=t;r<e.length&&0!==e[r];r++);return e.slice(t,r)}function h(e,t){return u(e,t).toString("utf8")}t.exports=function(e){if(e.length<6)throw new Error("invalid buffer length for BMFont");var t=i.every((function(t,r){return e.readUInt8(r)===t}));if(!t)throw new Error("BMFont missing BMF byte header");var r=3;if(e.readUInt8(r++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var a={kernings:[],chars:[]},s=0;s<5;s++)r+=n(a,e,r);return a}},{}],104:[function(e,t,r){var i=e("./parse-attribs"),n=e("xml-parse-from-string"),a={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};function s(e){return o(e).reduce((function(e,t){return e[c(t.nodeName)]=t.nodeValue,e}),{})}function o(e){for(var t=[],r=0;r<e.attributes.length;r++)t.push(e.attributes[r]);return t}function c(e){return a[e.toLowerCase()]||e}t.exports=function(e){e=e.toString();var t=n(e),r={pages:[],chars:[],kernings:[]};["info","common"].forEach((function(e){var n=t.getElementsByTagName(e)[0];n&&(r[e]=i(s(n)))}));var a=t.getElementsByTagName("pages")[0];if(!a)throw new Error("malformed file -- no <pages> element");for(var o=a.getElementsByTagName("page"),c=0;c<o.length;c++){var l=o[c],u=parseInt(l.getAttribute("id"),10),h=l.getAttribute("file");if(isNaN(u))throw new Error('malformed file -- page "id" attribute is NaN');if(!h)throw new Error('malformed file -- needs page "file" attribute');r.pages[parseInt(u,10)]=h}return["chars","kernings"].forEach((function(e){var n=t.getElementsByTagName(e)[0];if(n)for(var a=e.substring(0,e.length-1),o=n.getElementsByTagName(a),c=0;c<o.length;c++){var l=o[c];r[e].push(i(s(l)))}})),r}},{"./parse-attribs":105,"xml-parse-from-string":188}],105:[function(e,t,r){var i="chasrset";function n(e){return e.split(",").map((function(e){return parseInt(e,10)}))}t.exports=function(e){for(var t in i in e&&(e.charset=e[i],delete e[i]),e)"face"!==t&&"charset"!==t&&(e[t]="padding"===t||"spacing"===t?n(e[t]):parseInt(e[t],10));return e}},{}],106:[function(e,t,r){var i=e("trim"),n=e("for-each"),a=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};var t={};return n(i(e).split("\n"),(function(e){var r=e.indexOf(":"),n=i(e.slice(0,r)).toLowerCase(),s=i(e.slice(r+1));void 0===t[n]?t[n]=s:a(t[n])?t[n].push(s):t[n]=[t[n],s]})),t}},{"for-each":63,trim:179}],107:[function(e,t,r){(function(e){function t(e,t){for(var r=0,i=e.length-1;i>=0;i--){var n=e[i];"."===n?e.splice(i,1):".."===n?(e.splice(i,1),r++):r&&(e.splice(i,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function i(e){"string"!=typeof e&&(e+="");var t,r=0,i=-1,n=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!n){r=t+1;break}}else-1===i&&(n=!1,i=t+1);return-1===i?"":e.slice(r,i)}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],i=0;i<e.length;i++)t(e[i],i,e)&&r.push(e[i]);return r}r.resolve=function(){for(var r="",i=!1,a=arguments.length-1;a>=-1&&!i;a--){var s=a>=0?arguments[a]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(r=s+"/"+r,i="/"===s.charAt(0))}return(i?"/":"")+(r=t(n(r.split("/"),(function(e){return!!e})),!i).join("/"))||"."},r.normalize=function(e){var i=r.isAbsolute(e),s="/"===a(e,-1);return(e=t(n(e.split("/"),(function(e){return!!e})),!i).join("/"))||i||(e="."),e&&s&&(e+="/"),(i?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},r.relative=function(e,t){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var n=i(e.split("/")),a=i(t.split("/")),s=Math.min(n.length,a.length),o=s,c=0;c<s;c++)if(n[c]!==a[c]){o=c;break}var l=[];for(c=o;c<n.length;c++)l.push("..");return(l=l.concat(a.slice(o))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,i=-1,n=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!n){i=a;break}}else n=!1;return-1===i?r?"/":".":r&&1===i?"/":e.slice(0,i)},r.basename=function(e,t){var r=i(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,r=0,i=-1,n=!0,a=0,s=e.length-1;s>=0;--s){var o=e.charCodeAt(s);if(47!==o)-1===i&&(n=!1,i=s+1),46===o?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1);else if(!n){r=s+1;break}}return-1===t||-1===i||0===a||1===a&&t===i-1&&t===r+1?"":e.slice(t,i)};var a="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,e("_process"))},{_process:133}],108:[function(e,t,r){(function(r){var i="function"==typeof Symbol&&"symbol"===_(Symbol.iterator)?function(e){return _(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_(e)},n=e("http"),a=e("https"),s=e("url"),o=e("querystring"),c=e("zlib"),l=e("util"),u=function(e,t){if("string"!=typeof e&&!e.hasOwnProperty("url"))throw new Error("Missing url option from options for request method.");var l="object"===(void 0===e?"undefined":i(e))?s.parse(e.url):s.parse(e),u={hostname:l.hostname,port:l.port||("http:"===l.protocol.toLowerCase()?80:443),path:l.path,method:"GET",headers:{},auth:l.auth||null,parse:"none",stream:!1};if("object"===(void 0===e?"undefined":i(e))&&(u=Object.assign(u,e)),u.port=Number(u.port),u.hasOwnProperty("timeout")&&delete u.timeout,!0===u.compressed&&(u.headers["accept-encoding"]="gzip, deflate"),e.hasOwnProperty("form")){if("object"!==i(e.form))throw new Error("phin 'form' option must be of type Object if present.");var h=o.stringify(e.form);u.headers["Content-Type"]="application/x-www-form-urlencoded",u.headers["Content-Length"]=r.byteLength(h),e.data=h}var f=void 0,d=function(e){var i=e;!0===u.compressed&&("gzip"===e.headers["content-encoding"]?i=e.pipe(c.createGunzip()):"deflate"===e.headers["content-encoding"]&&(i=e.pipe(c.createInflate()))),!0===u.stream?(e.stream=i,t(null,e)):(e.body=new r([]),i.on("data",(function(t){e.body=r.concat([e.body,t])})),i.on("end",(function(){if(t){if("json"===u.parse)try{e.body=JSON.parse(e.body.toString())}catch(r){return void t("Invalid JSON received.",e)}t(null,e)}})))};switch(l.protocol.toLowerCase()){case"http:":f=n.request(u,d);break;case"https:":f=a.request(u,d);break;default:return void(t&&t(new Error("Invalid / unknown URL protocol. Expected HTTP or HTTPS."),null))}if("number"==typeof e.timeout&&f.setTimeout(e.timeout,(function(){f.abort(),t(new Error("Timeout has been reached."),null),t=null})),f.on("error",(function(e){t&&t(e,null)})),e.hasOwnProperty("data")){var p=e.data;if(!(e.data instanceof r)&&"object"===i(e.data))if("application/x-www-form-urlencoded"===(u.headers["content-type"]||u.headers["Content-Type"]))p=o.stringify(e.data);else try{p=JSON.stringify(e.data)}catch(m){t(new Error("Couldn't stringify object. (Likely due to a circular reference.)"),null)}f.write(p)}f.end()};u.promisified=function(e,t){return new Promise((function(t,r){u(e,(function(e,i){e?r(e):t(i)}))}))},l.promisify&&(u[l.promisify.custom]=u.promisified),t.exports=u}).call(this,e("buffer").Buffer)},{buffer:48,http:156,https:72,querystring:137,url:180,util:186,zlib:35}],109:[function(e,t,r){function i(e,t,r,i,s,o){o||(o={});for(var c=void 0===o.threshold?.1:o.threshold,f=35215*c*c,d=0,p=0;p<s;p++)for(var m=0;m<i;m++){var b=4*(p*i+m);if(a(e,t,b,b)>f)o.includeAA||!n(e,m,p,i,s,t)&&!n(t,m,p,i,s,e)?(r&&u(r,b,255,0,0),d++):r&&u(r,b,255,255,0);else if(r){var v=l(h(e,b),.1);u(r,b,v,v,v)}}return d}function n(e,t,r,i,s,o){for(var c,l,u,h,f=Math.max(t-1,0),d=Math.max(r-1,0),p=Math.min(t+1,i-1),m=Math.min(r+1,s-1),b=4*(r*i+t),v=0,g=0,y=0,_=0,w=0,x=f;x<=p;x++)for(var k=d;k<=m;k++)if(x!==t||k!==r){var S=a(e,e,b,4*(k*i+x),!0);if(0===S?v++:S<0?y++:S>0&&g++,v>2)return!1;o&&(S<_&&(_=S,c=x,l=k),S>w&&(w=S,u=x,h=k))}return!o||0!==y&&0!==g&&(!n(e,c,l,i,s)&&!n(o,c,l,i,s)||!n(e,u,h,i,s)&&!n(o,u,h,i,s))}function a(e,t,r,i,n){var a=e[r+3]/255,u=t[i+3]/255,h=l(e[r+0],a),f=l(e[r+1],a),d=l(e[r+2],a),p=l(t[i+0],u),m=l(t[i+1],u),b=l(t[i+2],u),v=s(h,f,d)-s(p,m,b);if(n)return v;var g=o(h,f,d)-o(p,m,b),y=c(h,f,d)-c(p,m,b);return.5053*v*v+.299*g*g+.1957*y*y}function s(e,t,r){return.29889531*e+.58662247*t+.11448223*r}function o(e,t,r){return.59597799*e-.2741761*t-.32180189*r}function c(e,t,r){return.21147017*e-.52261711*t+.31114694*r}function l(e,t){return 255+(e-255)*t}function u(e,t,r,i,n){e[t+0]=r,e[t+1]=i,e[t+2]=n,e[t+3]=255}function h(e,t){var r=e[t+3]/255;return s(l(e[t+0],r),l(e[t+1],r),l(e[t+2],r))}t.exports=i},{}],110:[function(e,t,r){(function(t){var i=e("./interlace"),n={1:{0:0,1:0,2:0,3:255},2:{0:0,1:0,2:0,3:1},3:{0:0,1:1,2:2,3:255},4:{0:0,1:1,2:2,3:3}};function a(e,t){var r=[],i=0;function n(){if(i===e.length)throw new Error("Ran out of data");var n,a,s,o,c,l,u,h,f=e[i];switch(i++,t){default:throw new Error("unrecognised depth");case 16:u=e[i],i++,r.push((f<<8)+u);break;case 4:u=15&f,h=f>>4,r.push(h,u);break;case 2:c=3&f,l=f>>2&3,u=f>>4&3,h=f>>6&3,r.push(h,u,l,c);break;case 1:n=1&f,a=f>>1&1,s=f>>2&1,o=f>>3&1,c=f>>4&1,l=f>>5&1,u=f>>6&1,h=f>>7&1,r.push(h,u,l,c,o,s,a,n)}}return{get:function(e){for(;r.length<e;)n();var t=r.slice(0,e);return r=r.slice(e),t},resetAfterLine:function(){r.length=0},end:function(){if(i!==e.length)throw new Error("extra data found")}}}function s(e,t,r,i,a,s){for(var o=e.width,c=e.height,l=e.index,u=0;u<c;u++)for(var h=0;h<o;h++){for(var f=r(h,u,l),d=0;d<4;d++){var p=n[i][d];if(255===p)t[f+d]=255;else{var m=p+s;if(m===a.length)throw new Error("Ran out of data");t[f+d]=a[m]}}s+=i}return s}function o(e,t,r,i,a,s){for(var o=e.width,c=e.height,l=e.index,u=0;u<c;u++){for(var h=0;h<o;h++)for(var f=a.get(i),d=r(h,u,l),p=0;p<4;p++){var m=n[i][p];t[d+p]=255!==m?f[m]:s}a.resetAfterLine()}}r.dataToBitMap=function(e,r){var n,c=r.width,l=r.height,u=r.depth,h=r.bpp,f=r.interlace;if(8!==u)var d=a(e,u);n=u<=8?new t(c*l*4):new Uint16Array(c*l*4);var p,m,b=Math.pow(2,u)-1,v=0;if(f)p=i.getImagePasses(c,l),m=i.getInterlaceIterator(c,l);else{var g=0;m=function(){var e=g;return g+=4,e},p=[{width:c,height:l}]}for(var y=0;y<p.length;y++)8===u?v=s(p[y],n,m,h,e,v):o(p[y],n,m,h,d,b);if(8===u){if(v!==e.length)throw new Error("extra data found")}else d.end();return n}}).call(this,e("buffer").Buffer)},{"./interlace":120,buffer:48}],111:[function(e,t,r){(function(r){var i=e("./constants");t.exports=function(e,t,n,a){var s,o=-1!==[i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(a.colorType);if(a.colorType===a.inputColorType){var c=(s=new ArrayBuffer(2),new DataView(s).setInt16(0,256,!0),256!==new Int16Array(s)[0]);if(8===a.bitDepth||16===a.bitDepth&&c)return e}var l=16!==a.bitDepth?e:new Uint16Array(e.buffer),u=255,h=i.COLORTYPE_TO_BPP_MAP[a.inputColorType];4!=h||a.inputHasAlpha||(h=3);var f=i.COLORTYPE_TO_BPP_MAP[a.colorType];16===a.bitDepth&&(u=65535,f*=2);var d=new r(t*n*f),p=0,m=0,b=a.bgColor||{};function v(e,t){var r,n,s,c=u;switch(a.inputColorType){case i.COLORTYPE_COLOR_ALPHA:c=e[t+3],r=e[t],n=e[t+1],s=e[t+2];break;case i.COLORTYPE_COLOR:r=e[t],n=e[t+1],s=e[t+2];break;case i.COLORTYPE_ALPHA:c=e[t+1],n=r=e[t],s=r;break;case i.COLORTYPE_GRAYSCALE:n=r=e[t],s=r;break;default:throw new Error("input color type:"+a.inputColorType+" is not supported at present")}return a.inputHasAlpha&&(o||(c/=u,r=Math.min(Math.max(Math.round((1-c)*b.red+c*r),0),u),n=Math.min(Math.max(Math.round((1-c)*b.green+c*n),0),u),s=Math.min(Math.max(Math.round((1-c)*b.blue+c*s),0),u))),{red:r,green:n,blue:s,alpha:c}}void 0===b.red&&(b.red=u),void 0===b.green&&(b.green=u),void 0===b.blue&&(b.blue=u);for(var g=0;g<n;g++)for(var y=0;y<t;y++){var _=v(l,p);switch(a.colorType){case i.COLORTYPE_COLOR_ALPHA:case i.COLORTYPE_COLOR:8===a.bitDepth?(d[m]=_.red,d[m+1]=_.green,d[m+2]=_.blue,o&&(d[m+3]=_.alpha)):(d.writeUInt16BE(_.red,m),d.writeUInt16BE(_.green,m+2),d.writeUInt16BE(_.blue,m+4),o&&d.writeUInt16BE(_.alpha,m+6));break;case i.COLORTYPE_ALPHA:case i.COLORTYPE_GRAYSCALE:var w=(_.red+_.green+_.blue)/3;8===a.bitDepth?(d[m]=w,o&&(d[m+1]=_.alpha)):(d.writeUInt16BE(w,m),o&&d.writeUInt16BE(_.alpha,m+2))}p+=h,m+=f}return d}}).call(this,e("buffer").Buffer)},{"./constants":113,buffer:48}],112:[function(e,t,r){(function(r,i){var n=e("util"),a=e("stream"),s=t.exports=function(){a.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};n.inherits(s,a),s.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t}),r.nextTick(function(){this._process(),this._paused&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},s.prototype.write=function(e,t){return this.writable?(r=i.isBuffer(e)?e:new i(e,t||this._encoding),this._buffers.push(r),this._buffered+=r.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",new Error("Stream not writable")),!1);var r},s.prototype.end=function(e,t){e&&this.write(e,t),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},s.prototype.destroySoon=s.prototype.end,s.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("There are some read requests waiting on finished stream")),this.destroy()},s.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},s.prototype._processReadAllowingLess=function(e){this._reads.shift();var t=this._buffers[0];t.length>e.length?(this._buffered-=e.length,this._buffers[0]=t.slice(e.length),e.func.call(this,t.slice(0,e.length))):(this._buffered-=t.length,this._buffers.shift(),e.func.call(this,t))},s.prototype._processRead=function(e){this._reads.shift();for(var t=0,r=0,n=new i(e.length);t<e.length;){var a=this._buffers[r++],s=Math.min(a.length,e.length-t);a.copy(n,t,0,s),t+=s,s!==a.length&&(this._buffers[--r]=a.slice(s))}r>0&&this._buffers.splice(0,r),this._buffered-=e.length,e.func.call(this,n)},s.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){var e=this._reads[0];if(e.allowLess)this._processReadAllowingLess(e);else{if(!(this._buffered>=e.length))break;this._processRead(e)}}this._buffers&&this._buffers.length>0&&null===this._buffers[0]&&this._end()}catch(t){this.emit("error",t)}}}).call(this,e("_process"),e("buffer").Buffer)},{_process:133,buffer:48,stream:155,util:186}],113:[function(e,t,r){t.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},{}],114:[function(e,t,r){var i=[];!function(){for(var e=0;e<256;e++){for(var t=e,r=0;r<8;r++)1&t?t=3988292384^t>>>1:t>>>=1;i[e]=t}}();var n=t.exports=function(){this._crc=-1};n.prototype.write=function(e){for(var t=0;t<e.length;t++)this._crc=i[255&(this._crc^e[t])]^this._crc>>>8;return!0},n.prototype.crc32=function(){return-1^this._crc},n.crc32=function(e){for(var t=-1,r=0;r<e.length;r++)t=i[255&(t^e[r])]^t>>>8;return-1^t}},{}],115:[function(e,t,r){(function(r){var i=e("./paeth-predictor");function n(e,t,r,i,n){for(var a=0;a<r;a++)i[n+a]=e[t+a]}function a(e,t,r){for(var i=0,n=t+r,a=t;a<n;a++)i+=Math.abs(e[a]);return i}function s(e,t,r,i,n,a){for(var s=0;s<r;s++){var o=s>=a?e[t+s-a]:0,c=e[t+s]-o;i[n+s]=c}}function o(e,t,r,i){for(var n=0,a=0;a<r;a++){var s=a>=i?e[t+a-i]:0,o=e[t+a]-s;n+=Math.abs(o)}return n}function c(e,t,r,i,n){for(var a=0;a<r;a++){var s=t>0?e[t+a-r]:0,o=e[t+a]-s;i[n+a]=o}}function l(e,t,r){for(var i=0,n=t+r,a=t;a<n;a++){var s=t>0?e[a-r]:0,o=e[a]-s;i+=Math.abs(o)}return i}function u(e,t,r,i,n,a){for(var s=0;s<r;s++){var o=s>=a?e[t+s-a]:0,c=t>0?e[t+s-r]:0,l=e[t+s]-(o+c>>1);i[n+s]=l}}function h(e,t,r,i){for(var n=0,a=0;a<r;a++){var s=a>=i?e[t+a-i]:0,o=t>0?e[t+a-r]:0,c=e[t+a]-(s+o>>1);n+=Math.abs(c)}return n}function f(e,t,r,n,a,s){for(var o=0;o<r;o++){var c=o>=s?e[t+o-s]:0,l=t>0?e[t+o-r]:0,u=t>0&&o>=s?e[t+o-(r+s)]:0,h=e[t+o]-i(c,l,u);n[a+o]=h}}function d(e,t,r,n){for(var a=0,s=0;s<r;s++){var o=s>=n?e[t+s-n]:0,c=t>0?e[t+s-r]:0,l=t>0&&s>=n?e[t+s-(r+n)]:0,u=e[t+s]-i(o,c,l);a+=Math.abs(u)}return a}var p={0:n,1:s,2:c,3:u,4:f},m={0:a,1:o,2:l,3:h,4:d};t.exports=function(e,t,i,n,a){var s;if("filterType"in n&&-1!==n.filterType){if("number"!=typeof n.filterType)throw new Error("unrecognised filter types");s=[n.filterType]}else s=[0,1,2,3,4];16===n.bitDepth&&(a*=2);for(var o=t*a,c=0,l=0,u=new r((o+1)*i),h=s[0],f=0;f<i;f++){if(s.length>1)for(var d=1/0,b=0;b<s.length;b++){var v=m[s[b]](e,l,o,a);v<d&&(h=s[b],d=v)}u[c]=h,c++,p[h](e,l,o,u,c,a),c+=o,l+=o}return u}}).call(this,e("buffer").Buffer)},{"./paeth-predictor":124,buffer:48}],116:[function(e,t,r){(function(r){var i=e("util"),n=e("./chunkstream"),a=e("./filter-parse"),s=t.exports=function(e){n.call(this);var t=[],i=this;this._filter=new a(e,{read:this.read.bind(this),write:function(e){t.push(e)},complete:function(){i.emit("complete",r.concat(t))}}),this._filter.start()};i.inherits(s,n)}).call(this,e("buffer").Buffer)},{"./chunkstream":112,"./filter-parse":118,buffer:48,util:186}],117:[function(e,t,r){(function(t){var i=e("./sync-reader"),n=e("./filter-parse");r.process=function(e,r){var a=[],s=new i(e);return new n(r,{read:s.read.bind(s),write:function(e){a.push(e)},complete:function(){}}).start(),s.process(),t.concat(a)}}).call(this,e("buffer").Buffer)},{"./filter-parse":118,"./sync-reader":131,buffer:48}],118:[function(e,t,r){(function(r){var i=e("./interlace"),n=e("./paeth-predictor");function a(e,t,r){var i=e*t;return 8!==r&&(i=Math.ceil(i/(8/r))),i}var s=t.exports=function(e,t){var r=e.width,n=e.height,s=e.interlace,o=e.bpp,c=e.depth;if(this.read=t.read,this.write=t.write,this.complete=t.complete,this._imageIndex=0,this._images=[],s)for(var l=i.getImagePasses(r,n),u=0;u<l.length;u++)this._images.push({byteWidth:a(l[u].width,o,c),height:l[u].height,lineIndex:0});else this._images.push({byteWidth:a(r,o,c),height:n,lineIndex:0});this._xComparison=8===c?o:16===c?2*o:1};s.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},s.prototype._unFilterType1=function(e,t,r){for(var i=this._xComparison,n=i-1,a=0;a<r;a++){var s=e[1+a],o=a>n?t[a-i]:0;t[a]=s+o}},s.prototype._unFilterType2=function(e,t,r){for(var i=this._lastLine,n=0;n<r;n++){var a=e[1+n],s=i?i[n]:0;t[n]=a+s}},s.prototype._unFilterType3=function(e,t,r){for(var i=this._xComparison,n=i-1,a=this._lastLine,s=0;s<r;s++){var o=e[1+s],c=a?a[s]:0,l=s>n?t[s-i]:0,u=Math.floor((l+c)/2);t[s]=o+u}},s.prototype._unFilterType4=function(e,t,r){for(var i=this._xComparison,a=i-1,s=this._lastLine,o=0;o<r;o++){var c=e[1+o],l=s?s[o]:0,u=o>a?t[o-i]:0,h=o>a&&s?s[o-i]:0,f=n(u,l,h);t[o]=c+f}},s.prototype._reverseFilterLine=function(e){var t,i=e[0],n=this._images[this._imageIndex],a=n.byteWidth;if(0===i)t=e.slice(1,a+1);else switch(t=new r(a),i){case 1:this._unFilterType1(e,t,a);break;case 2:this._unFilterType2(e,t,a);break;case 3:this._unFilterType3(e,t,a);break;case 4:this._unFilterType4(e,t,a);break;default:throw new Error("Unrecognised filter type - "+i)}this.write(t),n.lineIndex++,n.lineIndex>=n.height?(this._lastLine=null,this._imageIndex++,n=this._images[this._imageIndex]):this._lastLine=t,n?this.read(n.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this,e("buffer").Buffer)},{"./interlace":120,"./paeth-predictor":124,buffer:48}],119:[function(e,t,r){(function(e){function r(e,t,r,i,n){for(var a=0,s=0;s<i;s++)for(var o=0;o<r;o++){var c=n[e[a]];if(!c)throw new Error("index "+e[a]+" not in palette");for(var l=0;l<4;l++)t[a+l]=c[l];a+=4}}function i(e,t,r,i,n){for(var a=0,s=0;s<i;s++)for(var o=0;o<r;o++){var c=!1;if(1===n.length?n[0]===e[a]&&(c=!0):n[0]===e[a]&&n[1]===e[a+1]&&n[2]===e[a+2]&&(c=!0),c)for(var l=0;l<4;l++)t[a+l]=0;a+=4}}function n(e,t,r,i,n){for(var a=255,s=Math.pow(2,n)-1,o=0,c=0;c<i;c++)for(var l=0;l<r;l++){for(var u=0;u<4;u++)t[o+u]=Math.floor(e[o+u]*a/s+.5);o+=4}}t.exports=function(t,a){var s=a.depth,o=a.width,c=a.height,l=a.colorType,u=a.transColor,h=a.palette,f=t;return 3===l?r(t,f,o,c,h):(u&&i(t,f,o,c,u),8!==s&&(16===s&&(f=new e(o*c*4)),n(t,f,o,c,s))),f}}).call(this,e("buffer").Buffer)},{buffer:48}],120:[function(e,t,r){var i=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];r.getImagePasses=function(e,t){for(var r=[],n=e%8,a=t%8,s=(e-n)/8,o=(t-a)/8,c=0;c<i.length;c++){for(var l=i[c],u=s*l.x.length,h=o*l.y.length,f=0;f<l.x.length&&l.x[f]<n;f++)u++;for(f=0;f<l.y.length&&l.y[f]<a;f++)h++;u>0&&h>0&&r.push({width:u,height:h,index:c})}return r},r.getInterlaceIterator=function(e){return function(t,r,n){var a=t%i[n].x.length,s=(t-a)/i[n].x.length*8+i[n].x[a],o=r%i[n].y.length;return 4*s+((r-o)/i[n].y.length*8+i[n].y[o])*e*4}}},{}],121:[function(e,t,r){(function(r){var i=e("util"),n=e("stream"),a=e("./constants"),s=e("./packer"),o=t.exports=function(e){n.call(this);var t=e||{};this._packer=new s(t),this._deflate=this._packer.createDeflate(),this.readable=!0};i.inherits(o,n),o.prototype.pack=function(e,t,i,n){this.emit("data",new r(a.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(t,i)),n&&this.emit("data",this._packer.packGAMA(n));var s=this._packer.filterData(e,t,i);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(e){this.emit("data",this._packer.packIDAT(e))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(s)}}).call(this,e("buffer").Buffer)},{"./constants":113,"./packer":123,buffer:48,stream:155,util:186}],122:[function(e,t,r){(function(r){var i=!0,n=e("zlib");n.deflateSync||(i=!1);var a=e("./constants"),s=e("./packer");t.exports=function(e,t){if(!i)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var o=new s(t||{}),c=[];c.push(new r(a.PNG_SIGNATURE)),c.push(o.packIHDR(e.width,e.height)),e.gamma&&c.push(o.packGAMA(e.gamma));var l=o.filterData(e.data,e.width,e.height),u=n.deflateSync(l,o.getDeflateOptions());if(l=null,!u||!u.length)throw new Error("bad png - invalid compressed data response");return c.push(o.packIDAT(u)),c.push(o.packIEND()),r.concat(c)}}).call(this,e("buffer").Buffer)},{"./constants":113,"./packer":123,buffer:48,zlib:35}],123:[function(e,t,r){(function(r){var i=e("./constants"),n=e("./crc"),a=e("./bitpacker"),s=e("./filter-pack"),o=e("zlib"),c=t.exports=function(e){if(this._options=e,e.deflateChunkSize=e.deflateChunkSize||32768,e.deflateLevel=null!=e.deflateLevel?e.deflateLevel:9,e.deflateStrategy=null!=e.deflateStrategy?e.deflateStrategy:3,e.inputHasAlpha=null==e.inputHasAlpha||e.inputHasAlpha,e.deflateFactory=e.deflateFactory||o.createDeflate,e.bitDepth=e.bitDepth||8,e.colorType="number"==typeof e.colorType?e.colorType:i.COLORTYPE_COLOR_ALPHA,e.inputColorType="number"==typeof e.inputColorType?e.inputColorType:i.COLORTYPE_COLOR_ALPHA,-1===[i.COLORTYPE_GRAYSCALE,i.COLORTYPE_COLOR,i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(e.colorType))throw new Error("option color type:"+e.colorType+" is not supported at present");if(-1===[i.COLORTYPE_GRAYSCALE,i.COLORTYPE_COLOR,i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(e.inputColorType))throw new Error("option input color type:"+e.inputColorType+" is not supported at present");if(8!==e.bitDepth&&16!==e.bitDepth)throw new Error("option bit depth:"+e.bitDepth+" is not supported at present")};c.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},c.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},c.prototype.filterData=function(e,t,r){var n=a(e,t,r,this._options),o=i.COLORTYPE_TO_BPP_MAP[this._options.colorType];return s(n,t,r,this._options,o)},c.prototype._packChunk=function(e,t){var i=t?t.length:0,a=new r(i+12);return a.writeUInt32BE(i,0),a.writeUInt32BE(e,4),t&&t.copy(a,8),a.writeInt32BE(n.crc32(a.slice(4,a.length-4)),a.length-4),a},c.prototype.packGAMA=function(e){var t=new r(4);return t.writeUInt32BE(Math.floor(e*i.GAMMA_DIVISION),0),this._packChunk(i.TYPE_gAMA,t)},c.prototype.packIHDR=function(e,t){var n=new r(13);return n.writeUInt32BE(e,0),n.writeUInt32BE(t,4),n[8]=this._options.bitDepth,n[9]=this._options.colorType,n[10]=0,n[11]=0,n[12]=0,this._packChunk(i.TYPE_IHDR,n)},c.prototype.packIDAT=function(e){return this._packChunk(i.TYPE_IDAT,e)},c.prototype.packIEND=function(){return this._packChunk(i.TYPE_IEND,null)}}).call(this,e("buffer").Buffer)},{"./bitpacker":111,"./constants":113,"./crc":114,"./filter-pack":115,buffer:48,zlib:35}],124:[function(e,t,r){t.exports=function(e,t,r){var i=e+t-r,n=Math.abs(i-e),a=Math.abs(i-t),s=Math.abs(i-r);return n<=a&&n<=s?e:a<=s?t:r}},{}],125:[function(e,t,r){var i=e("util"),n=e("zlib"),a=e("./chunkstream"),s=e("./filter-parse-async"),o=e("./parser"),c=e("./bitmapper"),l=e("./format-normaliser"),u=t.exports=function(e){a.call(this),this._parser=new o(e,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this)}),this._options=e,this.writable=!0,this._parser.start()};i.inherits(u,a),u.prototype._handleError=function(e){this.emit("error",e),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},u.prototype._inflateData=function(e){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=n.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{var t=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,r=Math.max(t,n.Z_MIN_CHUNK);this._inflate=n.createInflate({chunkSize:r});var i=t,a=this.emit.bind(this,"error");this._inflate.on("error",(function(e){i&&a(e)})),this._filter.on("complete",this._complete.bind(this));var s=this._filter.write.bind(this._filter);this._inflate.on("data",(function(e){i&&(e.length>i&&(e=e.slice(0,i)),i-=e.length,s(e))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(e)},u.prototype._handleMetaData=function(e){this.emit("metadata",e),this._bitmapInfo=Object.create(e),this._filter=new s(this._bitmapInfo)},u.prototype._handleTransColor=function(e){this._bitmapInfo.transColor=e},u.prototype._handlePalette=function(e){this._bitmapInfo.palette=e},u.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"),this.destroySoon())},u.prototype._complete=function(e){if(!this.errord){try{var t=c.dataToBitMap(e,this._bitmapInfo),r=l(t,this._bitmapInfo);t=null}catch(i){return void this._handleError(i)}this.emit("parsed",r)}}},{"./bitmapper":110,"./chunkstream":112,"./filter-parse-async":116,"./format-normaliser":119,"./parser":127,util:186,zlib:35}],126:[function(e,t,r){(function(r){var i=!0,n=e("zlib"),a=e("./sync-inflate");n.deflateSync||(i=!1);var s=e("./sync-reader"),o=e("./filter-parse-sync"),c=e("./parser"),l=e("./bitmapper"),u=e("./format-normaliser");t.exports=function(e,t){if(!i)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var h,f,d;function p(e){h=e}function m(e){f=e}function b(e){f.transColor=e}function v(e){f.palette=e}function g(e){d=e}var y=[];function _(e){y.push(e)}var w=new s(e);if(new c(t,{read:w.read.bind(w),error:p,metadata:m,gamma:g,palette:v,transColor:b,inflateData:_}).start(),w.process(),h)throw h;var x,k=r.concat(y);if(y.length=0,f.interlace)x=n.inflateSync(k);else{var S=(1+(f.width*f.bpp*f.depth+7>>3))*f.height;x=a(k,{chunkSize:S,maxLength:S})}if(k=null,!x||!x.length)throw new Error("bad png - invalid inflate data response");var C=o.process(x,f);k=null;var U=l.dataToBitMap(C,f);C=null;var E=u(U,f);return f.data=E,f.gamma=d||0,f}}).call(this,e("buffer").Buffer)},{"./bitmapper":110,"./filter-parse-sync":117,"./format-normaliser":119,"./parser":127,"./sync-inflate":130,"./sync-reader":131,buffer:48,zlib:35}],127:[function(e,t,r){(function(r){var i=e("./constants"),n=e("./crc"),a=t.exports=function(e,t){this._options=e,e.checkCRC=!1!==e.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[i.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[i.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[i.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[i.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[i.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[i.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=t.read,this.error=t.error,this.metadata=t.metadata,this.gamma=t.gamma,this.transColor=t.transColor,this.palette=t.palette,this.parsed=t.parsed,this.inflateData=t.inflateData,this.finished=t.finished};a.prototype.start=function(){this.read(i.PNG_SIGNATURE.length,this._parseSignature.bind(this))},a.prototype._parseSignature=function(e){for(var t=i.PNG_SIGNATURE,r=0;r<t.length;r++)if(e[r]!==t[r])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},a.prototype._parseChunkBegin=function(e){for(var t=e.readUInt32BE(0),a=e.readUInt32BE(4),s="",o=4;o<8;o++)s+=String.fromCharCode(e[o]);var c=Boolean(32&e[4]);if(this._hasIHDR||a===i.TYPE_IHDR){if(this._crc=new n,this._crc.write(new r(s)),this._chunks[a])return this._chunks[a](t);c?this.read(t+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+s))}else this.error(new Error("Expected IHDR on beggining"))},a.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},a.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},a.prototype._parseChunkEnd=function(e){var t=e.readInt32BE(0),r=this._crc.crc32();this._options.checkCRC&&r!==t?this.error(new Error("Crc error - "+t+" - "+r)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},a.prototype._handleIHDR=function(e){this.read(e,this._parseIHDR.bind(this))},a.prototype._parseIHDR=function(e){this._crc.write(e);var t=e.readUInt32BE(0),r=e.readUInt32BE(4),n=e[8],a=e[9],s=e[10],o=e[11],c=e[12];if(8===n||4===n||2===n||1===n||16===n)if(a in i.COLORTYPE_TO_BPP_MAP)if(0===s)if(0===o)if(0===c||1===c){this._colorType=a;var l=i.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:t,height:r,depth:n,interlace:Boolean(c),palette:Boolean(a&i.COLORTYPE_PALETTE),color:Boolean(a&i.COLORTYPE_COLOR),alpha:Boolean(a&i.COLORTYPE_ALPHA),bpp:l,colorType:a}),this._handleChunkEnd()}else this.error(new Error("Unsupported interlace method"));else this.error(new Error("Unsupported filter method"));else this.error(new Error("Unsupported compression method"));else this.error(new Error("Unsupported color type"));else this.error(new Error("Unsupported bit depth "+n))},a.prototype._handlePLTE=function(e){this.read(e,this._parsePLTE.bind(this))},a.prototype._parsePLTE=function(e){this._crc.write(e);for(var t=Math.floor(e.length/3),r=0;r<t;r++)this._palette.push([e[3*r],e[3*r+1],e[3*r+2],255]);this.palette(this._palette),this._handleChunkEnd()},a.prototype._handleTRNS=function(e){this.read(e,this._parseTRNS.bind(this))},a.prototype._parseTRNS=function(e){if(this._crc.write(e),this._colorType===i.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(e.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(var t=0;t<e.length;t++)this._palette[t][3]=e[t];this.palette(this._palette)}this._colorType===i.COLORTYPE_GRAYSCALE&&this.transColor([e.readUInt16BE(0)]),this._colorType===i.COLORTYPE_COLOR&&this.transColor([e.readUInt16BE(0),e.readUInt16BE(2),e.readUInt16BE(4)]),this._handleChunkEnd()},a.prototype._handleGAMA=function(e){this.read(e,this._parseGAMA.bind(this))},a.prototype._parseGAMA=function(e){this._crc.write(e),this.gamma(e.readUInt32BE(0)/i.GAMMA_DIVISION),this._handleChunkEnd()},a.prototype._handleIDAT=function(e){this.read(-e,this._parseIDAT.bind(this,e))},a.prototype._parseIDAT=function(e,t){if(this._crc.write(t),this._colorType===i.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(t);var r=e-t.length;r>0?this._handleIDAT(r):this._handleChunkEnd()},a.prototype._handleIEND=function(e){this.read(e,this._parseIEND.bind(this))},a.prototype._parseIEND=function(e){this._crc.write(e),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this,e("buffer").Buffer)},{"./constants":113,"./crc":114,buffer:48}],128:[function(e,t,r){var i=e("./parser-sync"),n=e("./packer-sync");r.read=function(e,t){return i(e,t||{})},r.write=function(e,t){return n(e,t)}},{"./packer-sync":122,"./parser-sync":126}],129:[function(e,t,r){(function(t,i){var n=e("util"),a=e("stream"),s=e("./parser-async"),o=e("./packer-async"),c=e("./png-sync"),l=r.PNG=function(e){a.call(this),e=e||{},this.width=0|e.width,this.height=0|e.height,this.data=this.width>0&&this.height>0?new i(4*this.width*this.height):null,e.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new s(e),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(e){this.data=e,this.emit("parsed",e)}.bind(this)),this._packer=new o(e),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};n.inherits(l,a),l.sync=c,l.prototype.pack=function(){return this.data&&this.data.length?(t.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},l.prototype.parse=function(e,t){var r,i;return t&&(r=function(e){this.removeListener("error",i),this.data=e,t(null,this)}.bind(this),i=function(e){this.removeListener("parsed",r),t(e,null)}.bind(this),this.once("parsed",r),this.once("error",i)),this.end(e),this},l.prototype.write=function(e){return this._parser.write(e),!0},l.prototype.end=function(e){this._parser.end(e)},l.prototype._metadata=function(e){this.width=e.width,this.height=e.height,this.emit("metadata",e)},l.prototype._gamma=function(e){this.gamma=e},l.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},l.bitblt=function(e,t,r,i,n,a,s,o){if(i|=0,n|=0,a|=0,s|=0,o|=0,(r|=0)>e.width||i>e.height||r+n>e.width||i+a>e.height)throw new Error("bitblt reading outside image");if(s>t.width||o>t.height||s+n>t.width||o+a>t.height)throw new Error("bitblt writing outside image");for(var c=0;c<a;c++)e.data.copy(t.data,(o+c)*t.width+s<<2,(i+c)*e.width+r<<2,(i+c)*e.width+r+n<<2)},l.prototype.bitblt=function(e,t,r,i,n,a,s){return l.bitblt(this,e,t,r,i,n,a,s),this},l.adjustGamma=function(e){if(e.gamma){for(var t=0;t<e.height;t++)for(var r=0;r<e.width;r++)for(var i=e.width*t+r<<2,n=0;n<3;n++){var a=e.data[i+n]/255;a=Math.pow(a,1/2.2/e.gamma),e.data[i+n]=Math.round(255*a)}e.gamma=0}},l.prototype.adjustGamma=function(){l.adjustGamma(this)}}).call(this,e("_process"),e("buffer").Buffer)},{"./packer-async":121,"./parser-async":125,"./png-sync":128,_process:133,buffer:48,stream:155,util:186}],130:[function(e,t,r){(function(i,n){var a=e("assert").ok,s=e("zlib"),o=e("util"),c=e("buffer").kMaxLength;function l(e){if(!(this instanceof l))return new l(e);e&&e.chunkSize<s.Z_MIN_CHUNK&&(e.chunkSize=s.Z_MIN_CHUNK),s.Inflate.call(this,e),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,e&&null!=e.maxLength&&(this._maxLength=e.maxLength)}function u(e){return new l(e)}function h(e,t){t&&i.nextTick(t),e._handle&&(e._handle.close(),e._handle=null)}function f(e,t){if("string"==typeof t&&(t=n.from(t)),!(t instanceof n))throw new TypeError("Not a string or buffer");var r=e._finishFlushFlag;return null==r&&(r=s.Z_FINISH),e._processChunk(t,r)}function d(e,t){return f(new l(t),e)}l.prototype._processChunk=function(e,t,r){if("function"==typeof r)return s.Inflate._processChunk.call(this,e,t,r);var i,o=this,l=e&&e.length,u=this._chunkSize-this._offset,f=this._maxLength,d=0,p=[],m=0;function b(e,t){if(!o._hadError){var r=u-t;if(a(r>=0,"have should not go down"),r>0){var i=o._buffer.slice(o._offset,o._offset+r);if(o._offset+=r,i.length>f&&(i=i.slice(0,f)),p.push(i),m+=i.length,0==(f-=i.length))return!1}return(0===t||o._offset>=o._chunkSize)&&(u=o._chunkSize,o._offset=0,o._buffer=n.allocUnsafe(o._chunkSize)),0===t&&(d+=l-e,l=e,!0)}}this.on("error",(function(e){i=e})),a(this._handle,"zlib binding closed");do{var v=this._handle.writeSync(t,e,d,l,this._buffer,this._offset,u);v=v||this._writeState}while(!this._hadError&&b(v[0],v[1]));if(this._hadError)throw i;if(m>=c)throw h(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+c.toString(16)+" bytes");var g=n.concat(p,m);return h(this),g},o.inherits(l,s.Inflate),t.exports=r=d,r.Inflate=l,r.createInflate=u,r.inflateSync=d}).call(this,e("_process"),e("buffer").Buffer)},{_process:133,assert:25,buffer:48,util:186,zlib:35}],131:[function(e,t,r){var i=t.exports=function(e){this._buffer=e,this._reads=[]};i.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t})},i.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){var e=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=e.length||e.allowLess))break;this._reads.shift();var t=this._buffer;this._buffer=t.slice(e.length),e.func.call(this,t.slice(0,e.length))}return this._reads.length>0?new Error("There are some read requests waitng on finished stream"):this._buffer.length>0?new Error("unrecognised content at end of stream"):void 0}},{}],132:[function(e,t,r){(function(e){function r(t,r,i,n){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var a,s,o=arguments.length;switch(o){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,r)}));case 3:return e.nextTick((function(){t.call(null,r,i)}));case 4:return e.nextTick((function(){t.call(null,r,i,n)}));default:for(a=new Array(o-1),s=0;s<a.length;)a[s++]=arguments[s];return e.nextTick((function(){t.apply(null,a)}))}}void 0===e||0==="1.0.04".indexOf("v0.")||0==="1.0.04".indexOf("v1.")&&0!=="1.0.04".indexOf("v1.8.")?t.exports={nextTick:r}:t.exports=e}).call(this,e("_process"))},{_process:133}],133:[function(e,t,r){var i,n,a=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function c(e){if(i===setTimeout)return setTimeout(e,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}function l(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(e){i=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var u,h=[],f=!1,d=-1;function p(){f&&u&&(f=!1,u.length?h=u.concat(h):d=-1,h.length&&m())}function m(){if(!f){var e=c(p);f=!0;for(var t=h.length;t;){for(u=h,h=[];++d<t;)u&&u[d].run();d=-1,t=h.length}u=null,f=!1,l(e)}}function b(e,t){this.fun=e,this.array=t}function v(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];h.push(new b(e,t)),1!==h.length||f||c(m)},b.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=v,a.addListener=v,a.once=v,a.off=v,a.removeListener=v,a.removeAllListeners=v,a.emit=v,a.prependListener=v,a.prependOnceListener=v,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],134:[function(e,t,r){(function(e){!function(i){var n="object"==_(r)&&r&&!r.nodeType&&r,a="object"==_(t)&&t&&!t.nodeType&&t,s="object"==_(e)&&e;s.global!==s&&s.window!==s&&s.self!==s||(i=s);var o,c,l=2147483647,u=36,h=1,f=26,d=38,p=700,m=72,b=128,v="-",g=/^xn--/,y=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=u-h,S=Math.floor,C=String.fromCharCode;function U(e){throw new RangeError(x[e])}function E(e,t){for(var r=e.length,i=[];r--;)i[r]=t(e[r]);return i}function T(e,t){var r=e.split("@"),i="";return r.length>1&&(i=r[0]+"@",e=r[1]),i+E((e=e.replace(w,".")).split("."),t).join(".")}function M(e){for(var t,r,i=[],n=0,a=e.length;n<a;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<a?56320==(64512&(r=e.charCodeAt(n++)))?i.push(((1023&t)<<10)+(1023&r)+65536):(i.push(t),n--):i.push(t);return i}function O(e){return E(e,(function(e){var t="";return e>65535&&(t+=C((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=C(e)})).join("")}function P(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:u}function A(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function I(e,t,r){var i=0;for(e=r?S(e/p):e>>1,e+=S(e/t);e>k*f>>1;i+=u)e=S(e/k);return S(i+(k+1)*e/(e+d))}function L(e){var t,r,i,n,a,s,o,c,d,p,g=[],y=e.length,_=0,w=b,x=m;for((r=e.lastIndexOf(v))<0&&(r=0),i=0;i<r;++i)e.charCodeAt(i)>=128&&U("not-basic"),g.push(e.charCodeAt(i));for(n=r>0?r+1:0;n<y;){for(a=_,s=1,o=u;n>=y&&U("invalid-input"),((c=P(e.charCodeAt(n++)))>=u||c>S((l-_)/s))&&U("overflow"),_+=c*s,!(c<(d=o<=x?h:o>=x+f?f:o-x));o+=u)s>S(l/(p=u-d))&&U("overflow"),s*=p;x=I(_-a,t=g.length+1,0==a),S(_/t)>l-w&&U("overflow"),w+=S(_/t),_%=t,g.splice(_++,0,w)}return O(g)}function j(e){var t,r,i,n,a,s,o,c,d,p,g,y,_,w,x,k=[];for(y=(e=M(e)).length,t=b,r=0,a=m,s=0;s<y;++s)(g=e[s])<128&&k.push(C(g));for(i=n=k.length,n&&k.push(v);i<y;){for(o=l,s=0;s<y;++s)(g=e[s])>=t&&g<o&&(o=g);for(o-t>S((l-r)/(_=i+1))&&U("overflow"),r+=(o-t)*_,t=o,s=0;s<y;++s)if((g=e[s])<t&&++r>l&&U("overflow"),g==t){for(c=r,d=u;!(c<(p=d<=a?h:d>=a+f?f:d-a));d+=u)x=c-p,w=u-p,k.push(C(A(p+x%w,0))),c=S(x/w);k.push(C(A(c,0))),a=I(r,_,i==n),r=0,++i}++r,++t}return k.join("")}function R(e){return T(e,(function(e){return g.test(e)?L(e.slice(4).toLowerCase()):e}))}function D(e){return T(e,(function(e){return y.test(e)?"xn--"+j(e):e}))}if(o={version:"1.4.1",ucs2:{decode:M,encode:O},decode:L,encode:j,toASCII:D,toUnicode:R},n&&a)if(t.exports==n)a.exports=o;else for(c in o)o.hasOwnProperty(c)&&(n[c]=o[c]);else i.punycode=o}(this)}).call(this,void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{}],135:[function(e,t,r){function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,a){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var o=/\+/g;e=e.split(t);var c=1e3;a&&"number"==typeof a.maxKeys&&(c=a.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var h,f,d,p,m=e[u].replace(o,"%20"),b=m.indexOf(r);b>=0?(h=m.substr(0,b),f=m.substr(b+1)):(h=m,f=""),d=decodeURIComponent(h),p=decodeURIComponent(f),i(s,d)?n(s[d])?s[d].push(p):s[d]=[s[d],p]:s[d]=p}return s};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],136:[function(e,t,r){var i=function(e){switch(_(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"===_(e)?a(s(e),(function(s){var o=encodeURIComponent(i(s))+r;return n(e[s])?a(e[s],(function(e){return o+encodeURIComponent(i(e))})).join(t):o+encodeURIComponent(i(e[s]))})).join(t):o?encodeURIComponent(i(o))+r+encodeURIComponent(i(e)):""};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var r=[],i=0;i<e.length;i++)r.push(t(e[i],i));return r}var s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],137:[function(e,t,r){r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":135,"./encode":136}],138:[function(e,t,r){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":139}],139:[function(e,t,r){var i=e("process-nextick-args"),n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=h;var a=e("core-util-is");a.inherits=e("inherits");var s=e("./_stream_readable"),o=e("./_stream_writable");a.inherits(h,s);for(var c=n(o.prototype),l=0;l<c.length;l++){var u=c[l];h.prototype[u]||(h.prototype[u]=o.prototype[u])}function h(e){if(!(this instanceof h))return new h(e);s.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||i.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},{"./_stream_readable":141,"./_stream_writable":143,"core-util-is":51,inherits:75,"process-nextick-args":132}],140:[function(e,t,r){t.exports=a;var i=e("./_stream_transform"),n=e("core-util-is");function a(e){if(!(this instanceof a))return new a(e);i.call(this,e)}n.inherits=e("inherits"),n.inherits(a,i),a.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":142,"core-util-is":51,inherits:75}],141:[function(e,t,r){(function(r,i){var n=e("process-nextick-args");t.exports=x;var a,s=e("isarray");x.ReadableState=w,e("events").EventEmitter;var o=function(e,t){return e.listeners(t).length},c=e("./internal/streams/stream"),l=e("safe-buffer").Buffer,u=i.Uint8Array||function(){};function h(e){return l.from(e)}function f(e){return l.isBuffer(e)||e instanceof u}var d=e("core-util-is");d.inherits=e("inherits");var p=e("util"),m=void 0;m=p&&p.debuglog?p.debuglog("stream"):function(){};var b,v=e("./internal/streams/BufferList"),g=e("./internal/streams/destroy");d.inherits(x,c);var y=["error","close","destroy","pause","resume"];function _(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function w(t,r){t=t||{};var i=r instanceof(a=a||e("./_stream_duplex"));this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,s=t.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i&&(s||0===s)?s:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(b||(b=e("string_decoder/").StringDecoder),this.decoder=new b(t.encoding),this.encoding=t.encoding)}function x(t){if(a=a||e("./_stream_duplex"),!(this instanceof x))return new x(t);this._readableState=new w(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),c.call(this)}function k(e,t,r,i,n){var a,s=e._readableState;return null===t?(s.reading=!1,O(e,s)):(n||(a=C(s,t)),a?e.emit("error",a):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=h(t)),i?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):S(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?S(e,s,t,!1):I(e,s)):S(e,s,t,!1))):i||(s.reading=!1)),U(s)}function S(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&P(e)),I(e,t)}function C(e,t){var r;return f(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function U(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}Object.defineProperty(x.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=g.destroy,x.prototype._undestroy=g.undestroy,x.prototype._destroy=function(e,t){this.push(null),t(e)},x.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=l.from(e,t),t=""),r=!0),k(this,e,t,!1,r)},x.prototype.unshift=function(e){return k(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(t){return b||(b=e("string_decoder/").StringDecoder),this._readableState.decoder=new b(t),this._readableState.encoding=t,this};var E=8388608;function T(e){return e>=E?e=E:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function M(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=T(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,P(e)}}function P(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(m("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(A,e):A(e))}function A(e){m("emit readable"),e.emit("readable"),F(e)}function I(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(L,e,t))}function L(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(m("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function j(e){return function(){var t=e._readableState;m("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,F(e))}}function R(e){m("readable nexttick read 0"),e.read(0)}function D(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}function B(e,t){t.reading||(m("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),F(e),t.flowing&&!t.reading&&e.read(0)}function F(e){var t=e._readableState;for(m("flow",t.flowing);t.flowing&&null!==e.read(););}function N(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=z(e,t.buffer,t.decoder),r);var r}function z(e,t,r){var i;return e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():r?H(e,t):G(e,t),i}function H(e,t){var r=t.head,i=1,n=r.data;for(e-=n.length;r=r.next;){var a=r.data,s=e>a.length?a.length:e;if(s===a.length?n+=a:n+=a.slice(0,e),0==(e-=s)){s===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(s));break}++i}return t.length-=i,n}function G(e,t){var r=l.allocUnsafe(e),i=t.head,n=1;for(i.data.copy(r),e-=i.data.length;i=i.next;){var a=i.data,s=e>a.length?a.length:e;if(a.copy(r,r.length-e,0,s),0==(e-=s)){s===a.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=a.slice(s));break}++n}return t.length-=n,r}function W(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(Y,t,e))}function Y(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function X(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}x.prototype.read=function(e){m("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return m("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?W(this):P(this),null;if(0===(e=M(e,t))&&t.ended)return 0===t.length&&W(this),null;var i,n=t.needReadable;return m("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&m("length less than watermark",n=!0),t.ended||t.reading?m("reading or ended",n=!1):n&&(m("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=M(r,t))),null===(i=e>0?N(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&W(this)),null!==i&&this.emit("data",i),i},x.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},x.prototype.pipe=function(e,t){var i=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,m("pipe count=%d opts=%j",a.pipesCount,t);var s=t&&!1===t.end||e===r.stdout||e===r.stderr?y:l;function c(e,t){m("onunpipe"),e===i&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,f())}function l(){m("onend"),e.end()}a.endEmitted?n.nextTick(s):i.once("end",s),e.on("unpipe",c);var u=j(i);e.on("drain",u);var h=!1;function f(){m("cleanup"),e.removeListener("close",v),e.removeListener("finish",g),e.removeListener("drain",u),e.removeListener("error",b),e.removeListener("unpipe",c),i.removeListener("end",l),i.removeListener("end",y),i.removeListener("data",p),h=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||u()}var d=!1;function p(t){m("ondata"),d=!1,!1!==e.write(t)||d||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==X(a.pipes,e))&&!h&&(m("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,d=!0),i.pause())}function b(t){m("onerror",t),y(),e.removeListener("error",b),0===o(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",g),y()}function g(){m("onfinish"),e.removeListener("close",v),y()}function y(){m("unpipe"),i.unpipe(e)}return i.on("data",p),_(e,"error",b),e.once("close",v),e.once("finish",g),e.emit("pipe",i),a.flowing||(m("pipe resume"),i.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<n;a++)i[a].emit("unpipe",this,r);return this}var s=X(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},x.prototype.on=function(e,t){var r=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&P(this):n.nextTick(R,this))}return r},x.prototype.addListener=x.prototype.on,x.prototype.resume=function(){var e=this._readableState;return e.flowing||(m("resume"),e.flowing=!0,D(this,e)),this},x.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this},x.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var n in e.on("end",(function(){if(m("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){m("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n||(r.objectMode||n&&n.length)&&(t.push(n)||(i=!0,e.pause()))})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var a=0;a<y.length;a++)e.on(y[a],this.emit.bind(this,y[a]));return this._read=function(t){m("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),x._fromList=N}).call(this,e("_process"),void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{"./_stream_duplex":139,"./internal/streams/BufferList":144,"./internal/streams/destroy":145,"./internal/streams/stream":146,_process:133,"core-util-is":51,events:52,inherits:75,isarray:79,"process-nextick-args":132,"safe-buffer":147,"string_decoder/":148,util:33}],142:[function(e,t,r){t.exports=s;var i=e("./_stream_duplex"),n=e("core-util-is");function a(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);i.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o)}function o(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){c(e,t,r)})):c(this,null,null)}function c(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}n.inherits=e("inherits"),n.inherits(s,i),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},s.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var r=this;i.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}},{"./_stream_duplex":139,"core-util-is":51,inherits:75}],143:[function(e,t,r){(function(r,i,n){var a=e("process-nextick-args");function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){D(t,e)}}t.exports=_;var o,c=!r.browser&&["v0.10","v0.9."].indexOf("1.0.04".slice(0,5))>-1?n:a.nextTick;_.WritableState=y;var l=e("core-util-is");l.inherits=e("inherits");var u={deprecate:e("util-deprecate")},h=e("./internal/streams/stream"),f=e("safe-buffer").Buffer,d=i.Uint8Array||function(){};function p(e){return f.from(e)}function m(e){return f.isBuffer(e)||e instanceof d}var b,v=e("./internal/streams/destroy");function g(){}function y(t,r){o=o||e("./_stream_duplex"),t=t||{};var i=r instanceof o;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,a=t.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i&&(a||0===a)?a:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===t.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){T(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function _(t){if(o=o||e("./_stream_duplex"),!(b.call(_,this)||this instanceof o))return new _(t);this._writableState=new y(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),h.call(this)}function w(e,t){var r=new Error("write after end");e.emit("error",r),a.nextTick(t,r)}function x(e,t,r,i){var n=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),a.nextTick(i,s),n=!1),n}function k(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,r)),t}function S(e,t,r,i,n,a){if(!r){var s=k(t,i,n);i!==s&&(r=!0,n="buffer",i=s)}var o=t.objectMode?1:i.length;t.length+=o;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:a,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,o,i,n,a);return c}function C(e,t,r,i,n,a,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,a,t.onwrite),t.sync=!1}function U(e,t,r,i,n){--t.pendingcb,r?(a.nextTick(n,i),a.nextTick(j,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),j(e,t))}function E(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function T(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(E(r),t)U(e,r,i,t,n);else{var a=A(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||P(e,r),i?c(M,e,r,a,n):M(e,r,a,n)}}function M(e,t,r,i){r||O(e,t),t.pendingcb--,i(),j(e,t)}function O(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function P(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),a=t.corkedRequestsFree;a.entry=r;for(var o=0,c=!0;r;)n[o]=r,r.isBuf||(c=!1),r=r.next,o+=1;n.allBuffers=c,C(e,t,!0,t.length,n,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,h=r.callback;if(C(e,t,!1,t.objectMode?1:l.length,l,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function A(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function I(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),j(e,t)}))}function L(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(I,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function j(e,t){var r=A(t);return r&&(L(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function R(e,t,r){t.ending=!0,j(e,t),r&&(t.finished?a.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function D(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}l.inherits(_,h),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:u.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(b=Function.prototype[Symbol.hasInstance],Object.defineProperty(_,Symbol.hasInstance,{value:function(e){return!!b.call(this,e)||this===_&&e&&e._writableState instanceof y}})):b=function(e){return e instanceof this},_.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},_.prototype.write=function(e,t,r){var i=this._writableState,n=!1,a=!i.objectMode&&m(e);return a&&!f.isBuffer(e)&&(e=p(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=g),i.ended?w(this,r):(a||x(this,i,e,r))&&(i.pendingcb++,n=S(this,i,a,e,t,r)),n},_.prototype.cork=function(){this._writableState.corked++},_.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||P(this,e))},_.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),_.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},_.prototype._writev=null,_.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||R(this,i,r)},Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),_.prototype.destroy=v.destroy,_.prototype._undestroy=v.undestroy,_.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{},e("timers").setImmediate)},{"./_stream_duplex":139,"./internal/streams/destroy":145,"./internal/streams/stream":146,_process:133,"core-util-is":51,inherits:75,"process-nextick-args":132,"safe-buffer":147,timers:176,"util-deprecate":183}],144:[function(e,t,r){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=e("safe-buffer").Buffer,a=e("util");function s(e,t,r){e.copy(t,r)}t.exports=function(){function e(){i(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t=n.allocUnsafe(e>>>0),r=this.head,i=0;r;)s(r.data,t,i),i+=r.data.length,r=r.next;return t},e}(),a&&a.inspect&&a.inspect.custom&&(t.exports.prototype[a.inspect.custom]=function(){var e=a.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":147,util:33}],145:[function(e,t,r){var i=e("process-nextick-args");function n(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return n||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||i.nextTick(s,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(i.nextTick(s,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)})),this)}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function s(e,t){e.emit("error",t)}t.exports={destroy:n,undestroy:a}},{"process-nextick-args":132}],146:[function(e,t,r){t.exports=e("events").EventEmitter},{events:52}],147:[function(e,t,r){var i=e("buffer"),n=i.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=i:(a(i,r),r.Buffer=s),a(n,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:48}],148:[function(e,t,r){var i=e("safe-buffer").Buffer,n=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function s(e){var t=a(e);if("string"!=typeof t&&(i.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){var t;switch(this.encoding=s(e),this.encoding){case"utf16le":this.text=p,this.end=m,t=4;break;case"utf8":this.fillLast=h,t=4;break;case"base64":this.text=b,this.end=v,t=3;break;default:return this.write=g,void(this.end=y)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function c(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function l(e,t,r){var i=t.length-1;if(i<r)return 0;var n=c(t[i]);return n>=0?(n>0&&(e.lastNeed=n-1),n):--i<r||-2===n?0:(n=c(t[i]))>=0?(n>0&&(e.lastNeed=n-2),n):--i<r||-2===n?0:(n=c(t[i]))>=0?(n>0&&(2===n?n=0:e.lastNeed=n-3),n):0}function u(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}function h(e){var t=this.lastTotal-this.lastNeed,r=u(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function f(e,t){var r=l(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t}function p(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function m(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function b(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function v(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function g(e){return e.toString(this.encoding)}function y(e){return e&&e.length?this.write(e):""}r.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=d,o.prototype.text=f,o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":147}],149:[function(e,t,r){t.exports=e("./readable").PassThrough},{"./readable":150}],150:[function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":139,"./lib/_stream_passthrough.js":140,"./lib/_stream_readable.js":141,"./lib/_stream_transform.js":142,"./lib/_stream_writable.js":143}],151:[function(e,t,r){t.exports=e("./readable").Transform},{"./readable":150}],152:[function(e,t,r){t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":143}],153:[function(e,t,r){var i=function(e){var t,r=Object.prototype,i=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function c(e,t,r,i){var n=t&&t.prototype instanceof m?t:m,a=Object.create(n.prototype),s=new M(i||[]);return a._invoke=C(e,r,s),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(i){return{type:"throw",arg:i}}}e.wrap=c;var u="suspendedStart",h="suspendedYield",f="executing",d="completed",p={};function m(){}function b(){}function v(){}var g={};g[a]=function(){return this};var y=Object.getPrototypeOf,w=y&&y(y(O([])));w&&w!==r&&i.call(w,a)&&(g=w);var x=v.prototype=m.prototype=Object.create(g);function k(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function S(e){function t(r,n,a,s){var o=l(e[r],e,n);if("throw"!==o.type){var c=o.arg,u=c.value;return u&&"object"===_(u)&&i.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,a,s)}),(function(e){t("throw",e,a,s)})):Promise.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return t("throw",e,a,s)}))}s(o.arg)}var r;function n(e,i){function n(){return new Promise((function(r,n){t(e,i,r,n)}))}return r=r?r.then(n,n):n()}this._invoke=n}function C(e,t,r){var i=u;return function(n,a){if(i===f)throw new Error("Generator is already running");if(i===d){if("throw"===n)throw a;return P()}for(r.method=n,r.arg=a;;){var s=r.delegate;if(s){var o=U(s,r);if(o){if(o===p)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===u)throw i=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=f;var c=l(e,t,r);if("normal"===c.type){if(i=r.done?d:h,c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=d,r.method="throw",r.arg=c.arg)}}}function U(e,r){var i=e.iterator[r.method];if(i===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,U(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=l(i,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,p;var a=n.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function O(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:P}}function P(){return{value:t,done:!0}}return b.prototype=x.constructor=v,v.constructor=b,v[o]=b.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},k(S.prototype),S.prototype[s]=function(){return this},e.AsyncIterator=S,e.async=function(t,r,i,n){var a=new S(c(t,r,i,n));return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(x),x[o]="Generator",x[a]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}},e.values=O,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return o.type="throw",o.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),p}},e}("object"===_(t)?t.exports:{});try{regeneratorRuntime=i}catch(n){Function("r","regeneratorRuntime = r")(i)}},{}],154:[function(e,t,r){var i=e("buffer"),n=i.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=i:(a(i,r),r.Buffer=s),s.prototype=Object.create(n.prototype),a(n,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:48}],155:[function(e,t,r){t.exports=n;var i=e("events").EventEmitter;function n(){i.call(this)}e("inherits")(n,i),n.Readable=e("readable-stream/readable.js"),n.Writable=e("readable-stream/writable.js"),n.Duplex=e("readable-stream/duplex.js"),n.Transform=e("readable-stream/transform.js"),n.PassThrough=e("readable-stream/passthrough.js"),n.Stream=n,n.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function a(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",a),e._isStdio||t&&!1===t.end||(r.on("end",o),r.on("close",c));var s=!1;function o(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(u(),0===i.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",n),e.removeListener("drain",a),r.removeListener("end",o),r.removeListener("close",c),r.removeListener("error",l),e.removeListener("error",l),r.removeListener("end",u),r.removeListener("close",u),e.removeListener("close",u)}return r.on("error",l),e.on("error",l),r.on("end",u),r.on("close",u),e.on("close",u),e.emit("pipe",r),e}},{events:52,inherits:75,"readable-stream/duplex.js":138,"readable-stream/passthrough.js":149,"readable-stream/readable.js":150,"readable-stream/transform.js":151,"readable-stream/writable.js":152}],156:[function(e,t,r){(function(t){var i=e("./lib/request"),n=e("./lib/response"),a=e("xtend"),s=e("builtin-status-codes"),o=e("url"),c=r;c.request=function(e,r){e="string"==typeof e?o.parse(e):a(e);var n=-1===t.location.protocol.search(/^https?:$/)?"http:":"",s=e.protocol||n,c=e.hostname||e.host,l=e.port,u=e.path||"/";c&&-1!==c.indexOf(":")&&(c="["+c+"]"),e.url=(c?s+"//"+c:"")+(l?":"+l:"")+u,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var h=new i(e);return r&&h.on("response",r),h},c.get=function(e,t){var r=c.request(e,t);return r.end(),r},c.ClientRequest=i,c.IncomingMessage=n.IncomingMessage,c.Agent=function(){},c.Agent.defaultMaxSockets=4,c.globalAgent=new c.Agent,c.STATUS_CODES=s,c.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{"./lib/request":158,"./lib/response":159,"builtin-status-codes":50,url:180,xtend:189}],157:[function(e,t,r){(function(e){var t;function i(){if(void 0!==t)return t;if(e.XMLHttpRequest){t=new e.XMLHttpRequest;try{t.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(r){t=null}}else t=null;return t}function n(e){var t=i();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(r){}return!1}function a(e){return"function"==typeof e}r.fetch=a(e.fetch)&&a(e.ReadableStream),r.writableStream=a(e.WritableStream),r.abortController=a(e.AbortController),r.arraybuffer=r.fetch||n("arraybuffer"),r.msstream=!r.fetch&&n("ms-stream"),r.mozchunkedarraybuffer=!r.fetch&&n("moz-chunked-arraybuffer"),r.overrideMimeType=r.fetch||!!i()&&a(i().overrideMimeType),t=null}).call(this,void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{}],158:[function(e,t,r){(function(r,i,n){var a=e("./capability"),s=e("inherits"),o=e("./response"),c=e("readable-stream"),l=o.IncomingMessage,u=o.readyStates;function h(e,t){return a.fetch&&t?"fetch":a.mozchunkedarraybuffer?"moz-chunked-arraybuffer":a.msstream?"ms-stream":a.arraybuffer&&e?"arraybuffer":"text"}var f=t.exports=function(e){var t,r=this;c.Writable.call(r),r._opts=e,r._body=[],r._headers={},e.auth&&r.setHeader("Authorization","Basic "+n.from(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){r.setHeader(t,e.headers[t])}));var i=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!a.abortController)i=!1,t=!0;else if("prefer-streaming"===e.mode)t=!1;else if("allow-wrong-content-type"===e.mode)t=!a.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");t=!0}r._mode=h(t,i),r._fetchTimer=null,r.on("finish",(function(){r._onFinish()}))};function d(e){try{var t=e.status;return null!==t&&0!==t}catch(r){return!1}}s(f,c.Writable),f.prototype.setHeader=function(e,t){var r=this,i=e.toLowerCase();-1===p.indexOf(i)&&(r._headers[i]={name:e,value:t})},f.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},f.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},f.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t=e._opts,n=e._headers,s=null;"GET"!==t.method&&"HEAD"!==t.method&&(s=new Blob(e._body,{type:(n["content-type"]||{}).value||""}));var o=[];if(Object.keys(n).forEach((function(e){var t=n[e].name,r=n[e].value;Array.isArray(r)?r.forEach((function(e){o.push([t,e])})):o.push([t,r])})),"fetch"===e._mode){var c=null;if(a.abortController){var l=new AbortController;c=l.signal,e._fetchAbortController=l,"requestTimeout"in t&&0!==t.requestTimeout&&(e._fetchTimer=i.setTimeout((function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()}),t.requestTimeout))}i.fetch(e._opts.url,{method:e._opts.method,headers:o,body:s||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin",signal:c}).then((function(t){e._fetchResponse=t,e._connect()}),(function(t){i.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)}))}else{var h=e._xhr=new i.XMLHttpRequest;try{h.open(e._opts.method,e._opts.url,!0)}catch(f){return void r.nextTick((function(){e.emit("error",f)}))}"responseType"in h&&(h.responseType=e._mode),"withCredentials"in h&&(h.withCredentials=!!t.withCredentials),"text"===e._mode&&"overrideMimeType"in h&&h.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in t&&(h.timeout=t.requestTimeout,h.ontimeout=function(){e.emit("requestTimeout")}),o.forEach((function(e){h.setRequestHeader(e[0],e[1])})),e._response=null,h.onreadystatechange=function(){switch(h.readyState){case u.LOADING:case u.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(h.onprogress=function(){e._onXHRProgress()}),h.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{h.send(s)}catch(f){return void r.nextTick((function(){e.emit("error",f)}))}}}},f.prototype._onXHRProgress=function(){var e=this;d(e._xhr)&&!e._destroyed&&(e._response||e._connect(),e._response._onXHRProgress())},f.prototype._connect=function(){var e=this;e._destroyed||(e._response=new l(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",(function(t){e.emit("error",t)})),e.emit("response",e._response))},f.prototype._write=function(e,t,r){this._body.push(e),r()},f.prototype.abort=f.prototype.destroy=function(){var e=this;e._destroyed=!0,i.clearTimeout(e._fetchTimer),e._response&&(e._response._destroyed=!0),e._xhr?e._xhr.abort():e._fetchAbortController&&e._fetchAbortController.abort()},f.prototype.end=function(e,t,r){var i=this;"function"==typeof e&&(r=e,e=void 0),c.Writable.prototype.end.call(i,e,t,r)},f.prototype.flushHeaders=function(){},f.prototype.setTimeout=function(){},f.prototype.setNoDelay=function(){},f.prototype.setSocketKeepAlive=function(){};var p=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,e("_process"),void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{},e("buffer").Buffer)},{"./capability":157,"./response":159,_process:133,buffer:48,inherits:75,"readable-stream":174}],159:[function(e,t,r){(function(t,i,n){var a=e("./capability"),s=e("inherits"),o=e("readable-stream"),c=r.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},l=r.IncomingMessage=function(e,r,s,c){var l=this;if(o.Readable.call(l),l._mode=s,l.headers={},l.rawHeaders=[],l.trailers={},l.rawTrailers=[],l.on("end",(function(){t.nextTick((function(){l.emit("close")}))})),"fetch"===s){if(l._fetchResponse=r,l.url=r.url,l.statusCode=r.status,l.statusMessage=r.statusText,r.headers.forEach((function(e,t){l.headers[t.toLowerCase()]=e,l.rawHeaders.push(t,e)})),a.writableStream){var u=new WritableStream({write:function(e){return new Promise((function(t,r){l._destroyed?r():l.push(n.from(e))?t():l._resumeFetch=t}))},close:function(){i.clearTimeout(c),l._destroyed||l.push(null)},abort:function(e){l._destroyed||l.emit("error",e)}});try{return void r.body.pipeTo(u).catch((function(e){i.clearTimeout(c),l._destroyed||l.emit("error",e)}))}catch(p){}}var h=r.body.getReader();function m(){h.read().then((function(e){if(!l._destroyed){if(e.done)return i.clearTimeout(c),void l.push(null);l.push(n.from(e.value)),m()}})).catch((function(e){i.clearTimeout(c),l._destroyed||l.emit("error",e)}))}m()}else if(l._xhr=e,l._pos=0,l.url=e.responseURL,l.statusCode=e.status,l.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var r=t[1].toLowerCase();"set-cookie"===r?(void 0===l.headers[r]&&(l.headers[r]=[]),l.headers[r].push(t[2])):void 0!==l.headers[r]?l.headers[r]+=", "+t[2]:l.headers[r]=t[2],l.rawHeaders.push(t[1],t[2])}})),l._charset="x-user-defined",!a.overrideMimeType){var f=l.rawHeaders["mime-type"];if(f){var d=f.match(/;\s*charset=([^;])(;|$)/);d&&(l._charset=d[1].toLowerCase())}l._charset||(l._charset="utf-8")}};s(l,o.Readable),l.prototype._read=function(){var e=this,t=e._resumeFetch;t&&(e._resumeFetch=null,t())},l.prototype._onXHRProgress=function(){var e=this,t=e._xhr,r=null;switch(e._mode){case"text":if((r=t.responseText).length>e._pos){var a=r.substr(e._pos);if("x-user-defined"===e._charset){for(var s=n.alloc(a.length),o=0;o<a.length;o++)s[o]=255&a.charCodeAt(o);e.push(s)}else e.push(a,e._charset);e._pos=r.length}break;case"arraybuffer":if(t.readyState!==c.DONE||!t.response)break;r=t.response,e.push(n.from(new Uint8Array(r)));break;case"moz-chunked-arraybuffer":if(r=t.response,t.readyState!==c.LOADING||!r)break;e.push(n.from(new Uint8Array(r)));break;case"ms-stream":if(r=t.response,t.readyState!==c.LOADING)break;var l=new i.MSStreamReader;l.onprogress=function(){l.result.byteLength>e._pos&&(e.push(n.from(new Uint8Array(l.result.slice(e._pos)))),e._pos=l.result.byteLength)},l.onload=function(){e.push(null)},l.readAsArrayBuffer(r)}e._xhr.readyState===c.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,e("_process"),void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{},e("buffer").Buffer)},{"./capability":157,_process:133,buffer:48,inherits:75,"readable-stream":174}],160:[function(e,t,r){function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var n={};function a(e,t,r){function a(e,r,i){return"string"==typeof t?t:t(e,r,i)}r||(r=Error);var s=function(e){function t(t,r,i){return e.call(this,a(t,r,i))||this}return i(t,e),t}(r);s.prototype.name=r.name,s.prototype.code=e,n[e]=s}function s(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}function o(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function c(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function l(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}a("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),a("ERR_INVALID_ARG_TYPE",(function(e,t,r){var i,n;if("string"==typeof t&&o(t,"not ")?(i="must not be",t=t.replace(/^not /,"")):i="must be",c(e," argument"))n="The ".concat(e," ").concat(i," ").concat(s(t,"type"));else{var a=l(e,".")?"property":"argument";n='The "'.concat(e,'" ').concat(a," ").concat(i," ").concat(s(t,"type"))}return n+=". Received type ".concat(_(r))}),TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n},{}],161:[function(e,t,r){(function(e){var r=new Set;function i(t){if(!r.has(t)){var i=t+" is an experimental feature. This feature could change at any time";r.add(t),e.emitWarning(i,"ExperimentalWarning")}}function n(){}t.exports.emitExperimentalWarning=e.emitWarning?i:n}).call(this,e("_process"))},{_process:133}],162:[function(e,t,r){(function(r){var i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=l;var n=e("./_stream_readable"),a=e("./_stream_writable");e("inherits")(l,n);for(var s=i(a.prototype),o=0;o<s.length;o++){var c=s[o];l.prototype[c]||(l.prototype[c]=a.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);n.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||r.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,e("_process"))},{"./_stream_readable":164,"./_stream_writable":166,_process:133,inherits:75}],163:[function(e,t,r){t.exports=n;var i=e("./_stream_transform");function n(e){if(!(this instanceof n))return new n(e);i.call(this,e)}e("inherits")(n,i),n.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":165,inherits:75}],164:[function(e,t,r){(function(r,i){var n;t.exports=E,E.ReadableState=U,e("events").EventEmitter;var a=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),o=e("buffer").Buffer,c=i.Uint8Array||function(){};function l(e){return o.from(e)}function u(e){return o.isBuffer(e)||e instanceof c}var h,f=e("util");h=f&&f.debuglog?f.debuglog("stream"):function(){};var d,p,m=e("./internal/streams/buffer_list"),b=e("./internal/streams/destroy"),v=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,y=g.ERR_INVALID_ARG_TYPE,_=g.ERR_STREAM_PUSH_AFTER_EOF,w=g.ERR_METHOD_NOT_IMPLEMENTED,x=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,k=e("../experimentalWarning").emitExperimentalWarning;e("inherits")(E,s);var S=["error","close","destroy","pause","resume"];function C(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function U(t,r,i){n=n||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=r instanceof n),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=v(this,t,"readableHighWaterMark",i),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=e("string_decoder/").StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function E(t){if(n=n||e("./_stream_duplex"),!(this instanceof E))return new E(t);var r=this instanceof n;this._readableState=new U(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function T(e,t,r,i,n){h("readableAddChunk",t);var a,s=e._readableState;if(null===t)s.reading=!1,L(e,s);else if(n||(a=O(s,t)),a)e.emit("error",a);else if(s.objectMode||t&&t.length>0)if("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=l(t)),i)s.endEmitted?e.emit("error",new x):M(e,s,t,!0);else if(s.ended)e.emit("error",new _);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?M(e,s,t,!1):D(e,s)):M(e,s,t,!1)}else i||(s.reading=!1,D(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function M(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&j(e)),D(e,t)}function O(e,t){var r;return u(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new y("chunk",["string","Buffer","Uint8Array"],t)),r}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),E.prototype.destroy=b.destroy,E.prototype._undestroy=b.undestroy,E.prototype._destroy=function(e,t){t(e)},E.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=o.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},E.prototype.unshift=function(e){return T(this,e,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(t){return d||(d=e("string_decoder/").StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=this._readableState.decoder.encoding,this};var P=8388608;function A(e){return e>=P?e=P:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=A(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function L(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?j(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,R(e)))}}function j(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(R,e))}function R(e){var t=e._readableState;h("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||e.emit("readable"),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,W(e)}function D(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(B,e,t))}function B(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(h("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function F(e){return function(){var t=e._readableState;h("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,W(e))}}function N(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function z(e){h("readable nexttick read 0"),e.read(0)}function H(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(G,e,t))}function G(e,t){h("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),W(e),t.flowing&&!t.reading&&e.read(0)}function W(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function Y(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function X(e){var t=e._readableState;h("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(V,t,e))}function V(e,t){h("endReadableNT",e.endEmitted,e.length),e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function q(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}E.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?X(this):j(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&X(this),null;var i,n=t.needReadable;return h("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",n=!0),t.ended||t.reading?h("reading or ended",n=!1):n&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(i=e>0?Y(e,t):null)?(t.needReadable=!0,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&X(this)),null!==i&&this.emit("data",i),i},E.prototype._read=function(e){this.emit("error",new w("_read()"))},E.prototype.pipe=function(e,t){var i=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,h("pipe count=%d opts=%j",n.pipesCount,t);var s=t&&!1===t.end||e===r.stdout||e===r.stderr?v:c;function o(e,t){h("onunpipe"),e===i&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,f())}function c(){h("onend"),e.end()}n.endEmitted?r.nextTick(s):i.once("end",s),e.on("unpipe",o);var l=F(i);e.on("drain",l);var u=!1;function f(){h("cleanup"),e.removeListener("close",m),e.removeListener("finish",b),e.removeListener("drain",l),e.removeListener("error",p),e.removeListener("unpipe",o),i.removeListener("end",c),i.removeListener("end",v),i.removeListener("data",d),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||l()}function d(t){h("ondata");var r=e.write(t);h("dest.write",r),!1===r&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==q(n.pipes,e))&&!u&&(h("false write response, pause",n.awaitDrain),n.awaitDrain++),i.pause())}function p(t){h("onerror",t),v(),e.removeListener("error",p),0===a(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",b),v()}function b(){h("onfinish"),e.removeListener("close",m),v()}function v(){h("unpipe"),i.unpipe(e)}return i.on("data",d),C(e,"error",p),e.once("close",m),e.once("finish",b),e.emit("pipe",i),n.flowing||(h("pipe resume"),i.resume()),e},E.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<n;a++)i[a].emit("unpipe",this,{hasUnpiped:!1});return this}var s=q(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},E.prototype.on=function(e,t){var i=s.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,h("on readable",n.length,n.reading),n.length?j(this):n.reading||r.nextTick(z,this))),i},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(e,t){var i=s.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(N,this),i},E.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(N,this),t},E.prototype.resume=function(){var e=this._readableState;return e.flowing||(h("resume"),e.flowing=!e.readableListening,H(this,e)),e.paused=!1,this},E.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},E.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var n in e.on("end",(function(){if(h("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){h("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n||(r.objectMode||n&&n.length)&&(t.push(n)||(i=!0,e.pause()))})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var a=0;a<S.length;a++)e.on(S[a],this.emit.bind(this,S[a]));return this._read=function(t){h("wrapped _read",t),i&&(i=!1,e.resume())},this},"function"==typeof Symbol&&(E.prototype[Symbol.asyncIterator]=function(){return k("Readable[Symbol.asyncIterator]"),void 0===p&&(p=e("./internal/streams/async_iterator")),p(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),E._fromList=Y,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}})}).call(this,e("_process"),void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{"../errors":160,"../experimentalWarning":161,"./_stream_duplex":162,"./internal/streams/async_iterator":167,"./internal/streams/buffer_list":168,"./internal/streams/destroy":169,"./internal/streams/state":172,"./internal/streams/stream":173,_process:133,buffer:48,events:52,inherits:75,"string_decoder/":175,util:33}],165:[function(e,t,r){t.exports=u;var i=e("../errors").codes,n=i.ERR_METHOD_NOT_IMPLEMENTED,a=i.ERR_MULTIPLE_CALLBACK,s=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=i.ERR_TRANSFORM_WITH_LENGTH_0,c=e("./_stream_duplex");function l(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(null===i)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);c.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new o;if(e._transformState.transforming)throw new s;return e.push(null)}e("inherits")(u,c),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new n("_transform()"))},u.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},{"../errors":160,"./_stream_duplex":162,inherits:75}],166:[function(e,t,r){(function(r,i){function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){G(t,e)}}var a;t.exports=U,U.WritableState=C;var s={deprecate:e("util-deprecate")},o=e("./internal/streams/stream"),c=e("buffer").Buffer,l=i.Uint8Array||function(){};function u(e){return c.from(e)}function h(e){return c.isBuffer(e)||e instanceof l}var f,d=e("./internal/streams/destroy"),p=e("./internal/streams/state").getHighWaterMark,m=e("../errors").codes,b=m.ERR_INVALID_ARG_TYPE,v=m.ERR_METHOD_NOT_IMPLEMENTED,g=m.ERR_MULTIPLE_CALLBACK,y=m.ERR_STREAM_CANNOT_PIPE,_=m.ERR_STREAM_DESTROYED,w=m.ERR_STREAM_NULL_VALUES,x=m.ERR_STREAM_WRITE_AFTER_END,k=m.ERR_UNKNOWN_ENCODING;function S(){}function C(t,r,i){a=a||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=r instanceof a),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=p(this,t,"writableHighWaterMark",i),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===t.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){L(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function U(t){var r=this instanceof(a=a||e("./_stream_duplex"));if(!r&&!f.call(U,this))return new U(t);this._writableState=new C(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),o.call(this)}function E(e,t){var i=new x;e.emit("error",i),r.nextTick(t,i)}function T(e,t,i,n){var a;return null===i?a=new w:"string"==typeof i||t.objectMode||(a=new b("chunk",["string","Buffer"],i)),!a||(e.emit("error",a),r.nextTick(n,a),!1)}function M(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r)),t}function O(e,t,r,i,n,a){if(!r){var s=M(t,i,n);i!==s&&(r=!0,n="buffer",i=s)}var o=t.objectMode?1:i.length;t.length+=o;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:a,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else P(e,t,!1,o,i,n,a);return c}function P(e,t,r,i,n,a,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new _("write")):r?e._writev(n,t.onwrite):e._write(n,a,t.onwrite),t.sync=!1}function A(e,t,i,n,a){--t.pendingcb,i?(r.nextTick(a,n),r.nextTick(z,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(a(n),e._writableState.errorEmitted=!0,e.emit("error",n),z(e,t))}function I(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function L(e,t){var i=e._writableState,n=i.sync,a=i.writecb;if("function"!=typeof a)throw new g;if(I(i),t)A(e,i,n,t,a);else{var s=B(i)||e.destroyed;s||i.corked||i.bufferProcessing||!i.bufferedRequest||D(e,i),n?r.nextTick(j,e,i,s,a):j(e,i,s,a)}}function j(e,t,r,i){r||R(e,t),t.pendingcb--,i(),z(e,t)}function R(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function D(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,a=new Array(i),s=t.corkedRequestsFree;s.entry=r;for(var o=0,c=!0;r;)a[o]=r,r.isBuf||(c=!1),r=r.next,o+=1;a.allBuffers=c,P(e,t,!0,t.length,a,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,h=r.callback;if(P(e,t,!1,t.objectMode?1:l.length,l,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function B(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function F(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),z(e,t)}))}function N(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(F,e,t)))}function z(e,t){var r=B(t);return r&&(N(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function H(e,t,i){t.ending=!0,z(e,t),i&&(t.finished?r.nextTick(i):e.once("finish",i)),t.ended=!0,e.writable=!1}function G(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree.next=e}e("inherits")(U,o),C.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(C.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(U,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===U&&e&&e._writableState instanceof C}})):f=function(e){return e instanceof this},U.prototype.pipe=function(){this.emit("error",new y)},U.prototype.write=function(e,t,r){var i=this._writableState,n=!1,a=!i.objectMode&&h(e);return a&&!c.isBuffer(e)&&(e=u(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=S),i.ending?E(this,r):(a||T(this,i,e,r))&&(i.pendingcb++,n=O(this,i,a,e,t,r)),n},U.prototype.cork=function(){this._writableState.corked++},U.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||D(this,e))},U.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new k(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(U.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(U.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),U.prototype._write=function(e,t,r){r(new v("_write()"))},U.prototype._writev=null,U.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||H(this,i,r),this},Object.defineProperty(U.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(U.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),U.prototype.destroy=d.destroy,U.prototype._undestroy=d.undestroy,U.prototype._destroy=function(e,t){t(e)}}).call(this,e("_process"),void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{"../errors":160,"./_stream_duplex":162,"./internal/streams/destroy":169,"./internal/streams/state":172,"./internal/streams/stream":173,_process:133,buffer:48,inherits:75,"util-deprecate":183}],167:[function(e,t,r){(function(r){var i;function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=e("./end-of-stream"),s=Symbol("lastResolve"),o=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[s];if(null!==t){var r=e[f].read();null!==r&&(e[u]=null,e[s]=null,e[o]=null,t(d(r,!1)))}}function m(e){r.nextTick(p,e)}function b(e,t){return function(r,i){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,i)}),i)}}var v=Object.getPrototypeOf((function(){})),g=Object.setPrototypeOf((n(i={get stream(){return this[f]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(t,i){r.nextTick((function(){e[c]?i(e[c]):t(d(void 0,!0))}))}));var i,n=this[u];if(n)i=new Promise(b(n,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));i=new Promise(this[h])}return this[u]=i,i}},Symbol.asyncIterator,(function(){return this})),n(i,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),i),v),y=function(e){var t,r=Object.create(g,(n(t={},f,{value:e,writable:!0}),n(t,s,{value:null,writable:!0}),n(t,o,{value:null,writable:!0}),n(t,c,{value:null,writable:!0}),n(t,l,{value:e._readableState.endEmitted,writable:!0}),n(t,h,{value:function(e,t){var i=r[f].read();i?(r[u]=null,r[s]=null,r[o]=null,e(d(i,!1))):(r[s]=e,r[o]=t)},writable:!0}),t));return r[u]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[o];return null!==t&&(r[u]=null,r[s]=null,r[o]=null,t(e)),void(r[c]=e)}var i=r[s];null!==i&&(r[u]=null,r[s]=null,r[o]=null,i(d(void 0,!0))),r[l]=!0})),e.on("readable",m.bind(null,r)),r};t.exports=y}).call(this,e("_process"))},{"./end-of-stream":170,_process:133}],168:[function(e,t,r){function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),i.forEach((function(t){n(e,t,r[t])}))}return e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=e("buffer").Buffer,s=e("util").inspect,o=s&&s.custom||"inspect";function c(e,t,r){a.prototype.copy.call(e,t,r)}t.exports=function(){function e(){this.head=null,this.tail=null,this.length=0}var t=e.prototype;return t.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},t.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},t.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},t.clear=function(){this.head=this.tail=null,this.length=0},t.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},t.concat=function(e){if(0===this.length)return a.alloc(0);for(var t=a.allocUnsafe(e>>>0),r=this.head,i=0;r;)c(r.data,t,i),i+=r.data.length,r=r.next;return t},t.consume=function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r},t.first=function(){return this.head.data},t._getString=function(e){var t=this.head,r=1,i=t.data;for(e-=i.length;t=t.next;){var n=t.data,a=e>n.length?n.length:e;if(a===n.length?i+=n:i+=n.slice(0,e),0==(e-=a)){a===n.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(a));break}++r}return this.length-=r,i},t._getBuffer=function(e){var t=a.allocUnsafe(e),r=this.head,i=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var n=r.data,s=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,s),0==(e-=s)){s===n.length?(++i,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(s));break}++i}return this.length-=i,t},t[o]=function(e,t){return s(this,i({},t,{depth:0,customInspect:!1}))},e}()},{buffer:48,util:33}],169:[function(e,t,r){(function(e){function r(t,r){var a=this,o=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return o||c?(r?r(t):!t||this._writableState&&this._writableState.errorEmitted||e.nextTick(s,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!r&&t?(e.nextTick(i,a,t),a._writableState&&(a._writableState.errorEmitted=!0)):r?(e.nextTick(n,a),r(t)):e.nextTick(n,a)})),this)}function i(e,t){s(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function s(e,t){e.emit("error",t)}t.exports={destroy:r,undestroy:a}}).call(this,e("_process"))},{_process:133}],170:[function(e,t,r){var i=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function n(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];e.apply(this,i)}}}function a(){}function s(e){return e.setHeader&&"function"==typeof e.abort}function o(e,t,r){if("function"==typeof t)return o(e,null,t);t||(t={}),r=n(r||a);var c=t.readable||!1!==t.readable&&e.readable,l=t.writable||!1!==t.writable&&e.writable,u=function(){e.writable||f()},h=e._writableState&&e._writableState.finished,f=function(){l=!1,h=!0,c||r.call(e)},d=e._readableState&&e._readableState.endEmitted,p=function(){c=!1,d=!0,l||r.call(e)},m=function(t){r.call(e,t)},b=function(){var t;return c&&!d?(e._readableState&&e._readableState.ended||(t=new i),r.call(e,t)):l&&!h?(e._writableState&&e._writableState.ended||(t=new i),r.call(e,t)):void 0},v=function(){e.req.on("finish",f)};return s(e)?(e.on("complete",f),e.on("abort",b),e.req?v():e.on("request",v)):l&&!e._writableState&&(e.on("end",u),e.on("close",u)),e.on("end",p),e.on("finish",f),!1!==t.error&&e.on("error",m),e.on("close",b),function(){e.removeListener("complete",f),e.removeListener("abort",b),e.removeListener("request",v),e.req&&e.req.removeListener("finish",f),e.removeListener("end",u),e.removeListener("close",u),e.removeListener("finish",f),e.removeListener("end",p),e.removeListener("error",m),e.removeListener("close",b)}}t.exports=o},{"../../../errors":160}],171:[function(e,t,r){var i;function n(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}var a=e("../../../errors").codes,s=a.ERR_MISSING_ARGS,o=a.ERR_STREAM_DESTROYED;function c(e){if(e)throw e}function l(e){return e.setHeader&&"function"==typeof e.abort}function u(t,r,a,s){s=n(s);var c=!1;t.on("close",(function(){c=!0})),void 0===i&&(i=e("./end-of-stream")),i(t,{readable:r,writable:a},(function(e){if(e)return s(e);c=!0,s()}));var u=!1;return function(e){if(!c&&!u)return u=!0,l(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new o("pipe"))}}function h(e){e()}function f(e,t){return e.pipe(t)}function d(e){return e.length?"function"!=typeof e[e.length-1]?c:e.pop():c}function p(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i,n=d(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var a=t.map((function(e,r){var s=r<t.length-1;return u(e,s,r>0,(function(e){i||(i=e),e&&a.forEach(h),s||(a.forEach(h),n(i))}))}));return t.reduce(f)}t.exports=p},{"../../../errors":160,"./end-of-stream":170}],172:[function(e,t,r){var i=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;function n(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}function a(e,t,r,a){var s=n(t,a,r);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new i(a?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}t.exports={getHighWaterMark:a}},{"../../../errors":160}],173:[function(e,t,r){arguments[4][146][0].apply(r,arguments)},{dup:146,events:52}],174:[function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":162,"./lib/_stream_passthrough.js":163,"./lib/_stream_readable.js":164,"./lib/_stream_transform.js":165,"./lib/_stream_writable.js":166,"./lib/internal/streams/end-of-stream.js":170,"./lib/internal/streams/pipeline.js":171}],175:[function(e,t,r){arguments[4][148][0].apply(r,arguments)},{dup:148,"safe-buffer":154}],176:[function(e,t,r){(function(t,i){var n=e("process/browser.js").nextTick,s=Function.prototype.apply,o=Array.prototype.slice,c={},l=0;function u(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new u(s.call(setTimeout,a,arguments),clearTimeout)},r.setInterval=function(){return new u(s.call(setInterval,a,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(a,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r.setImmediate="function"==typeof t?t:function(e){var t=l++,i=!(arguments.length<2)&&o.call(arguments,1);return c[t]=!0,n((function(){c[t]&&(i?e.apply(null,i):e.call(null),r.clearImmediate(t))})),t},r.clearImmediate="function"==typeof i?i:function(e){delete c[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":133,timers:176}],177:[function(e,t,r){(function(e){Object.defineProperty(r,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"===_(Symbol.iterator)?function(e){return _(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_(e)};r.clone=o,r.addLast=u,r.addFirst=h,r.removeLast=f,r.removeFirst=d,r.insert=p,r.removeAt=m,r.replaceAt=b,r.getIn=v,r.set=g,r.setIn=w,r.update=x,r.updateIn=k,r.merge=S,r.mergeDeep=C,r.mergeIn=U,r.omit=E,r.addDefaults=T;
/*!
      	 * Timm
      	 *
      	 * Immutability helpers with fast reads and acceptable writes.
      	 *
      	 * @copyright Guillermo Grau Panea 2016
      	 * @license MIT
      	 */
var i="INVALID_ARGS";function n(e){throw new Error(e)}function a(e){var t=Object.keys(e);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t}var s={}.hasOwnProperty;function o(e){if(Array.isArray(e))return e.slice();for(var t=a(e),r={},i=0;i<t.length;i++){var n=t[i];r[n]=e[n]}return r}function c(e,t,r){var s=r;null==s&&n(i);for(var u=!1,h=arguments.length,f=Array(h>3?h-3:0),d=3;d<h;d++)f[d-3]=arguments[d];for(var p=0;p<f.length;p++){var m=f[p];if(null!=m){var b=a(m);if(b.length)for(var v=0;v<=b.length;v++){var g=b[v];if(!e||void 0===s[g]){var y=m[g];t&&l(s[g])&&l(y)&&(y=c(e,t,s[g],y)),void 0!==y&&y!==s[g]&&(u||(u=!0,s=o(s)),s[g]=y)}}}}return s}function l(e){var r=void 0===e?"undefined":t(e);return null!=e&&"object"===r}function u(e,t){return Array.isArray(t)?e.concat(t):e.concat([t])}function h(e,t){return Array.isArray(t)?t.concat(e):[t].concat(e)}function f(e){return e.length?e.slice(0,e.length-1):e}function d(e){return e.length?e.slice(1):e}function p(e,t,r){return e.slice(0,t).concat(Array.isArray(r)?r:[r]).concat(e.slice(t))}function m(e,t){return t>=e.length||t<0?e:e.slice(0,t).concat(e.slice(t+1))}function b(e,t,r){if(e[t]===r)return e;for(var i=e.length,n=Array(i),a=0;a<i;a++)n[a]=e[a];return n[t]=r,n}function v(e,t){if(!Array.isArray(t)&&n(i),null!=e){for(var r=e,a=0;a<t.length;a++){var s=t[a];if(void 0===(r=null!=r?r[s]:void 0))return r}return r}}function g(e,t,r){var i=null==e?"number"==typeof t?[]:{}:e;if(i[t]===r)return i;var n=o(i);return n[t]=r,n}function y(e,t,r,i){var n=void 0,a=t[i];return n=i===t.length-1?r:y(l(e)&&l(e[a])?e[a]:"number"==typeof t[i+1]?[]:{},t,r,i+1),g(e,a,n)}function w(e,t,r){return t.length?y(e,t,r,0):r}function x(e,t,r){return g(e,t,r(null==e?void 0:e[t]))}function k(e,t,r){return w(e,t,r(v(e,t)))}function S(e,t,r,i,n,a){for(var s=arguments.length,o=Array(s>6?s-6:0),l=6;l<s;l++)o[l-6]=arguments[l];return o.length?c.call.apply(c,[null,!1,!1,e,t,r,i,n,a].concat(o)):c(!1,!1,e,t,r,i,n,a)}function C(e,t,r,i,n,a){for(var s=arguments.length,o=Array(s>6?s-6:0),l=6;l<s;l++)o[l-6]=arguments[l];return o.length?c.call.apply(c,[null,!1,!0,e,t,r,i,n,a].concat(o)):c(!1,!0,e,t,r,i,n,a)}function U(e,t,r,i,n,a,s){var o=v(e,t);null==o&&(o={});for(var l=arguments.length,u=Array(l>7?l-7:0),h=7;h<l;h++)u[h-7]=arguments[h];return w(e,t,u.length?c.call.apply(c,[null,!1,!1,o,r,i,n,a,s].concat(u)):c(!1,!1,o,r,i,n,a,s))}function E(e,t){for(var r=Array.isArray(t)?t:[t],i=!1,n=0;n<r.length;n++)if(s.call(e,r[n])){i=!0;break}if(!i)return e;for(var o={},c=a(e),l=0;l<c.length;l++){var u=c[l];r.indexOf(u)>=0||(o[u]=e[u])}return o}function T(e,t,r,i,n,a){for(var s=arguments.length,o=Array(s>6?s-6:0),l=6;l<s;l++)o[l-6]=arguments[l];return o.length?c.call.apply(c,[null,!0,!1,e,t,r,i,n,a].concat(o)):c(!0,!1,e,t,r,i,n,a)}var M={clone:o,addLast:u,addFirst:h,removeLast:f,removeFirst:d,insert:p,removeAt:m,replaceAt:b,getIn:v,set:g,setIn:w,update:x,updateIn:k,merge:S,mergeDeep:C,mergeIn:U,omit:E,addDefaults:T};r.default=M}).call(this,e("_process"))},{_process:133}],178:[function(e,t,r){!function(e){var r=/^\s+/,i=/\s+$/,n=0,s=e.round,o=e.min,c=e.max,l=e.random;function u(e,t){if(t=t||{},(e=e||"")instanceof u)return e;if(!(this instanceof u))return new u(e,t);var r=h(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=s(100*this._a)/100,this._format=t.format||r.format,this._gradientType=t.gradientType,this._r<1&&(this._r=s(this._r)),this._g<1&&(this._g=s(this._g)),this._b<1&&(this._b=s(this._b)),this._ok=r.ok,this._tc_id=n++}function h(e){var t={r:0,g:0,b:0},r=1,i=null,n=null,a=null,s=!1,l=!1;return"string"==typeof e&&(e=Q(e)),"object"==_(e)&&(J(e.r)&&J(e.g)&&J(e.b)?(t=f(e.r,e.g,e.b),s=!0,l="%"===String(e.r).substr(-1)?"prgb":"rgb"):J(e.h)&&J(e.s)&&J(e.v)?(i=W(e.s),n=W(e.v),t=b(e.h,i,n),s=!0,l="hsv"):J(e.h)&&J(e.s)&&J(e.l)&&(i=W(e.s),a=W(e.l),t=p(e.h,i,a),s=!0,l="hsl"),e.hasOwnProperty("a")&&(r=e.a)),r=D(r),{ok:s,format:e.format||l,r:o(255,c(t.r,0)),g:o(255,c(t.g,0)),b:o(255,c(t.b,0)),a:r}}function f(e,t,r){return{r:255*B(e,255),g:255*B(t,255),b:255*B(r,255)}}function d(e,t,r){e=B(e,255),t=B(t,255),r=B(r,255);var i,n,a=c(e,t,r),s=o(e,t,r),l=(a+s)/2;if(a==s)i=n=0;else{var u=a-s;switch(n=l>.5?u/(2-a-s):u/(a+s),a){case e:i=(t-r)/u+(t<r?6:0);break;case t:i=(r-e)/u+2;break;case r:i=(e-t)/u+4}i/=6}return{h:i,s:n,l:l}}function p(e,t,r){var i,n,a;function s(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}if(e=B(e,360),t=B(t,100),r=B(r,100),0===t)i=n=a=r;else{var o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;i=s(c,o,e+1/3),n=s(c,o,e),a=s(c,o,e-1/3)}return{r:255*i,g:255*n,b:255*a}}function m(e,t,r){e=B(e,255),t=B(t,255),r=B(r,255);var i,n,a=c(e,t,r),s=o(e,t,r),l=a,u=a-s;if(n=0===a?0:u/a,a==s)i=0;else{switch(a){case e:i=(t-r)/u+(t<r?6:0);break;case t:i=(r-e)/u+2;break;case r:i=(e-t)/u+4}i/=6}return{h:i,s:n,v:l}}function b(t,r,i){t=6*B(t,360),r=B(r,100),i=B(i,100);var n=e.floor(t),a=t-n,s=i*(1-r),o=i*(1-a*r),c=i*(1-(1-a)*r),l=n%6;return{r:255*[i,o,s,s,c,i][l],g:255*[c,i,i,o,s,s][l],b:255*[s,s,c,i,i,o][l]}}function v(e,t,r,i){var n=[G(s(e).toString(16)),G(s(t).toString(16)),G(s(r).toString(16))];return i&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function g(e,t,r,i,n){var a=[G(s(e).toString(16)),G(s(t).toString(16)),G(s(r).toString(16)),G(Y(i))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function y(e,t,r,i){return[G(Y(i)),G(s(e).toString(16)),G(s(t).toString(16)),G(s(r).toString(16))].join("")}function w(e,t){t=0===t?0:t||10;var r=u(e).toHsl();return r.s-=t/100,r.s=F(r.s),u(r)}function x(e,t){t=0===t?0:t||10;var r=u(e).toHsl();return r.s+=t/100,r.s=F(r.s),u(r)}function k(e){return u(e).desaturate(100)}function S(e,t){t=0===t?0:t||10;var r=u(e).toHsl();return r.l+=t/100,r.l=F(r.l),u(r)}function C(e,t){t=0===t?0:t||10;var r=u(e).toRgb();return r.r=c(0,o(255,r.r-s(-t/100*255))),r.g=c(0,o(255,r.g-s(-t/100*255))),r.b=c(0,o(255,r.b-s(-t/100*255))),u(r)}function U(e,t){t=0===t?0:t||10;var r=u(e).toHsl();return r.l-=t/100,r.l=F(r.l),u(r)}function E(e,t){var r=u(e).toHsl(),i=(r.h+t)%360;return r.h=i<0?360+i:i,u(r)}function T(e){var t=u(e).toHsl();return t.h=(t.h+180)%360,u(t)}function M(e){var t=u(e).toHsl(),r=t.h;return[u(e),u({h:(r+120)%360,s:t.s,l:t.l}),u({h:(r+240)%360,s:t.s,l:t.l})]}function O(e){var t=u(e).toHsl(),r=t.h;return[u(e),u({h:(r+90)%360,s:t.s,l:t.l}),u({h:(r+180)%360,s:t.s,l:t.l}),u({h:(r+270)%360,s:t.s,l:t.l})]}function P(e){var t=u(e).toHsl(),r=t.h;return[u(e),u({h:(r+72)%360,s:t.s,l:t.l}),u({h:(r+216)%360,s:t.s,l:t.l})]}function A(e,t,r){t=t||6,r=r||30;var i=u(e).toHsl(),n=360/r,a=[u(e)];for(i.h=(i.h-(n*t>>1)+720)%360;--t;)i.h=(i.h+n)%360,a.push(u(i));return a}function I(e,t){t=t||6;for(var r=u(e).toHsv(),i=r.h,n=r.s,a=r.v,s=[],o=1/t;t--;)s.push(u({h:i,s:n,v:a})),a=(a+o)%1;return s}u.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var t,r,i,n=this.toRgb();return t=n.r/255,r=n.g/255,i=n.b/255,.2126*(t<=.03928?t/12.92:e.pow((t+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:e.pow((r+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:e.pow((i+.055)/1.055,2.4))},setAlpha:function(e){return this._a=D(e),this._roundA=s(100*this._a)/100,this},toHsv:function(){var e=m(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=m(this._r,this._g,this._b),t=s(360*e.h),r=s(100*e.s),i=s(100*e.v);return 1==this._a?"hsv("+t+", "+r+"%, "+i+"%)":"hsva("+t+", "+r+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=d(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=d(this._r,this._g,this._b),t=s(360*e.h),r=s(100*e.s),i=s(100*e.l);return 1==this._a?"hsl("+t+", "+r+"%, "+i+"%)":"hsla("+t+", "+r+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return v(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return g(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:s(this._r),g:s(this._g),b:s(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+s(this._r)+", "+s(this._g)+", "+s(this._b)+")":"rgba("+s(this._r)+", "+s(this._g)+", "+s(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:s(100*B(this._r,255))+"%",g:s(100*B(this._g,255))+"%",b:s(100*B(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+s(100*B(this._r,255))+"%, "+s(100*B(this._g,255))+"%, "+s(100*B(this._b,255))+"%)":"rgba("+s(100*B(this._r,255))+"%, "+s(100*B(this._g,255))+"%, "+s(100*B(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(j[v(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+y(this._r,this._g,this._b,this._a),r=t,i=this._gradientType?"GradientType = 1, ":"";if(e){var n=u(e);r="#"+y(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=!1,i=this._a<1&&this._a>=0;return t||!i||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return u(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(S,arguments)},brighten:function(){return this._applyModification(C,arguments)},darken:function(){return this._applyModification(U,arguments)},desaturate:function(){return this._applyModification(w,arguments)},saturate:function(){return this._applyModification(x,arguments)},greyscale:function(){return this._applyModification(k,arguments)},spin:function(){return this._applyModification(E,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(A,arguments)},complement:function(){return this._applyCombination(T,arguments)},monochromatic:function(){return this._applyCombination(I,arguments)},splitcomplement:function(){return this._applyCombination(P,arguments)},triad:function(){return this._applyCombination(M,arguments)},tetrad:function(){return this._applyCombination(O,arguments)}},u.fromRatio=function(e,t){if("object"==_(e)){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]="a"===i?e[i]:W(e[i]));e=r}return u(e,t)},u.equals=function(e,t){return!(!e||!t)&&u(e).toRgbString()==u(t).toRgbString()},u.random=function(){return u.fromRatio({r:l(),g:l(),b:l()})},u.mix=function(e,t,r){r=0===r?0:r||50;var i=u(e).toRgb(),n=u(t).toRgb(),a=r/100;return u({r:(n.r-i.r)*a+i.r,g:(n.g-i.g)*a+i.g,b:(n.b-i.b)*a+i.b,a:(n.a-i.a)*a+i.a})},u.readability=function(t,r){var i=u(t),n=u(r);return(e.max(i.getLuminance(),n.getLuminance())+.05)/(e.min(i.getLuminance(),n.getLuminance())+.05)},u.isReadable=function(e,t,r){var i,n,a=u.readability(e,t);switch(n=!1,(i=$(r)).level+i.size){case"AAsmall":case"AAAlarge":n=a>=4.5;break;case"AAlarge":n=a>=3;break;case"AAAsmall":n=a>=7}return n},u.mostReadable=function(e,t,r){var i,n,a,s,o=null,c=0;n=(r=r||{}).includeFallbackColors,a=r.level,s=r.size;for(var l=0;l<t.length;l++)(i=u.readability(e,t[l]))>c&&(c=i,o=u(t[l]));return u.isReadable(e,o,{level:a,size:s})||!n?o:(r.includeFallbackColors=!1,u.mostReadable(e,["#fff","#000"],r))};var L=u.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},j=u.hexNames=R(L);function R(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}function D(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function B(t,r){z(t)&&(t="100%");var i=H(t);return t=o(r,c(0,parseFloat(t))),i&&(t=parseInt(t*r,10)/100),e.abs(t-r)<1e-6?1:t%r/parseFloat(r)}function F(e){return o(1,c(0,e))}function N(e){return parseInt(e,16)}function z(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function H(e){return"string"==typeof e&&-1!=e.indexOf("%")}function G(e){return 1==e.length?"0"+e:""+e}function W(e){return e<=1&&(e=100*e+"%"),e}function Y(t){return e.round(255*parseFloat(t)).toString(16)}function X(e){return N(e)/255}var V,q,Z,K=(q="[\\s|\\(]+("+(V="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+V+")[,|\\s]+("+V+")\\s*\\)?",Z="[\\s|\\(]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")\\s*\\)?",{CSS_UNIT:new RegExp(V),rgb:new RegExp("rgb"+q),rgba:new RegExp("rgba"+Z),hsl:new RegExp("hsl"+q),hsla:new RegExp("hsla"+Z),hsv:new RegExp("hsv"+q),hsva:new RegExp("hsva"+Z),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function J(e){return!!K.CSS_UNIT.exec(e)}function Q(e){e=e.replace(r,"").replace(i,"").toLowerCase();var t,n=!1;if(L[e])e=L[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=K.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=K.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=K.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=K.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=K.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=K.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=K.hex8.exec(e))?{r:N(t[1]),g:N(t[2]),b:N(t[3]),a:X(t[4]),format:n?"name":"hex8"}:(t=K.hex6.exec(e))?{r:N(t[1]),g:N(t[2]),b:N(t[3]),format:n?"name":"hex"}:(t=K.hex4.exec(e))?{r:N(t[1]+""+t[1]),g:N(t[2]+""+t[2]),b:N(t[3]+""+t[3]),a:X(t[4]+""+t[4]),format:n?"name":"hex8"}:!!(t=K.hex3.exec(e))&&{r:N(t[1]+""+t[1]),g:N(t[2]+""+t[2]),b:N(t[3]+""+t[3]),format:n?"name":"hex"}}function $(e){var t,r;return"AA"!==(t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==t&&(t="AA"),"small"!==(r=(e.size||"small").toLowerCase())&&"large"!==r&&(r="small"),{level:t,size:r}}void 0!==t&&t.exports?t.exports=u:a.tinycolor=u}(Math)},{}],179:[function(e,t,r){function i(e){return e.replace(/^\s*|\s*$/g,"")}(r=t.exports=i).left=function(e){return e.replace(/^\s*/,"")},r.right=function(e){return e.replace(/\s*$/,"")}},{}],180:[function(e,t,r){var i=e("punycode"),n=e("./util");function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}r.parse=w,r.resolve=k,r.resolveObject=S,r.format=x,r.Url=a;var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(l),h=["%","/","?",";","#"].concat(u),f=["/","?","#"],d=255,p=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=e("querystring");function w(e,t,r){if(e&&n.isObject(e)&&e instanceof a)return e;var i=new a;return i.parse(e,t,r),i}function x(e){return n.isString(e)&&(e=w(e)),e instanceof a?e.format():a.prototype.format.call(e)}function k(e,t){return w(e,!1,!0).resolve(t)}function S(e,t){return e?w(e,!1,!0).resolveObject(t):t}a.prototype.parse=function(e,t,r){if(!n.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+_(e));var a=e.indexOf("?"),o=-1!==a&&a<e.indexOf("#")?"?":"#",l=e.split(o),w=/\\/g;l[0]=l[0].replace(w,"/");var x=e=l.join(o);if(x=x.trim(),!r&&1===e.split("#").length){var k=c.exec(x);if(k)return this.path=x,this.href=x,this.pathname=k[1],k[2]?(this.search=k[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var S=s.exec(x);if(S){var C=(S=S[0]).toLowerCase();this.protocol=C,x=x.substr(S.length)}if(r||S||x.match(/^\/\/[^@\/]+@[^@\/]+/)){var U="//"===x.substr(0,2);!U||S&&v[S]||(x=x.substr(2),this.slashes=!0)}if(!v[S]&&(U||S&&!g[S])){for(var E,T,M=-1,O=0;O<f.length;O++)-1!==(P=x.indexOf(f[O]))&&(-1===M||P<M)&&(M=P);for(-1!==(T=-1===M?x.lastIndexOf("@"):x.lastIndexOf("@",M))&&(E=x.slice(0,T),x=x.slice(T+1),this.auth=decodeURIComponent(E)),M=-1,O=0;O<h.length;O++){var P;-1!==(P=x.indexOf(h[O]))&&(-1===M||P<M)&&(M=P)}-1===M&&(M=x.length),this.host=x.slice(0,M),x=x.slice(M),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var I=this.hostname.split(/\./),L=(O=0,I.length);O<L;O++){var j=I[O];if(j&&!j.match(p)){for(var R="",D=0,B=j.length;D<B;D++)j.charCodeAt(D)>127?R+="x":R+=j[D];if(!R.match(p)){var F=I.slice(0,O),N=I.slice(O+1),z=j.match(m);z&&(F.push(z[1]),N.unshift(z[2])),N.length&&(x="/"+N.join(".")+x),this.hostname=F.join(".");break}}}this.hostname.length>d?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=i.toASCII(this.hostname));var H=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+H,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==x[0]&&(x="/"+x))}if(!b[C])for(O=0,L=u.length;O<L;O++){var W=u[O];if(-1!==x.indexOf(W)){var Y=encodeURIComponent(W);Y===W&&(Y=escape(W)),x=x.split(W).join(Y)}}var X=x.indexOf("#");-1!==X&&(this.hash=x.substr(X),x=x.slice(0,X));var V=x.indexOf("?");if(-1!==V?(this.search=x.substr(V),this.query=x.substr(V+1),t&&(this.query=y.parse(this.query)),x=x.slice(0,V)):t&&(this.search="",this.query={}),x&&(this.pathname=x),g[C]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){H=this.pathname||"";var q=this.search||"";this.path=H+q}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",a=!1,s="";this.host?a=e+this.host:this.hostname&&(a=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query));var o=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==a?(a="//"+(a||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):a||(a=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),t+a+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(o=o.replace("#","%23"))+i},a.prototype.resolve=function(e){return this.resolveObject(w(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(n.isString(e)){var t=new a;t.parse(e,!1,!0),e=t}for(var r=new a,i=Object.keys(this),s=0;s<i.length;s++){var o=i[s];r[o]=this[o]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),l=0;l<c.length;l++){var u=c[l];"protocol"!==u&&(r[u]=e[u])}return g[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){for(var h=Object.keys(e),f=0;f<h.length;f++){var d=h[f];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||v[e.protocol])r.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),r.pathname=p.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var m=r.pathname||"",b=r.search||"";r.path=m+b}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var y=r.pathname&&"/"===r.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=_||y||r.host&&e.pathname,x=w,k=r.pathname&&r.pathname.split("/")||[],S=(p=e.pathname&&e.pathname.split("/")||[],r.protocol&&!g[r.protocol]);if(S&&(r.hostname="",r.port=null,r.host&&(""===k[0]?k[0]=r.host:k.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),w=w&&(""===p[0]||""===k[0])),_)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,k=p;else if(p.length)k||(k=[]),k.pop(),k=k.concat(p),r.search=e.search,r.query=e.query;else if(!n.isNullOrUndefined(e.search))return S&&(r.hostname=r.host=k.shift(),(M=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=M.shift(),r.host=r.hostname=M.shift())),r.search=e.search,r.query=e.query,n.isNull(r.pathname)&&n.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!k.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var C=k.slice(-1)[0],U=(r.host||e.host||k.length>1)&&("."===C||".."===C)||""===C,E=0,T=k.length;T>=0;T--)"."===(C=k[T])?k.splice(T,1):".."===C?(k.splice(T,1),E++):E&&(k.splice(T,1),E--);if(!w&&!x)for(;E--;E)k.unshift("..");!w||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),U&&"/"!==k.join("/").substr(-1)&&k.push("");var M,O=""===k[0]||k[0]&&"/"===k[0].charAt(0);return S&&(r.hostname=r.host=O?"":k.length?k.shift():"",(M=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=M.shift(),r.host=r.hostname=M.shift())),(w=w||r.host&&k.length)&&!O&&k.unshift(""),k.length?r.pathname=k.join("/"):(r.pathname=null,r.path=null),n.isNull(r.pathname)&&n.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},a.prototype.parseHost=function(){var e=this.host,t=o.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":181,punycode:134,querystring:137}],181:[function(e,t,r){t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"===_(e)&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],182:[function(e,t,r){(function(r){!function(){var i={};function n(){void 0===r&&console.log.apply(console,arguments)}"object"==_(t)?t.exports=i:self.UTIF=i,function(e,t){var r,i,a;r="function"==typeof Symbol&&"symbol"===_(Symbol.iterator)?function(e){return _(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_(e)},i=function(){function e(e){this.message="JPEG error: "+e}return e.prototype=Error(),e.prototype.name="JpegError",e.constructor=e}(),a=function(){function e(e,t){this.message=e,this.g=t}return e.prototype=Error(),e.prototype.name="DNLMarkerError",e.constructor=e}(),function(){function t(){this.M=null,this.B=-1}function n(e,t){for(var r,i,n=0,a=[],s=16;0<s&&!e[s-1];)s--;a.push({children:[],index:0});var o,c=a[0];for(r=0;r<s;r++){for(i=0;i<e[r];i++){for((c=a.pop()).children[c.index]=t[n];0<c.index;)c=a.pop();for(c.index++,a.push(c);a.length<=r;)a.push(o={children:[],index:0}),c.children[c.index]=o.children,c=o;n++}r+1<s&&(a.push(o={children:[],index:0}),c.children[c.index]=o.children,c=o)}return a[0].children}function s(e,t,n,s,o,u,h,f,d){function p(){if(0<L)return L--,I>>L&1;if(255===(I=e[t++])){var r=e[t++];if(r){if(220===r&&O){t+=2;var s=e[t++]<<8|e[t++];if(0<s&&s!==n.g)throw new a("Found DNL marker (0xFFDC) while parsing scan data",s)}throw new i("unexpected marker "+(I<<8|r).toString(16))}}return L=7,I>>>7}function m(e){for(;;){if("number"==typeof(e=e[p()]))return e;if("object"!==(void 0===e?"undefined":r(e)))throw new i("invalid huffman sequence")}}function b(e){for(var t=0;0<e;)t=t<<1|p(),e--;return t}function v(e){if(1===e)return 1===p()?1:-1;var t=b(e);return t>=1<<e-1?t:t+(-1<<e)+1}function g(e,t){var r=m(e.D);for(r=0===r?0:v(r),e.a[t]=e.m+=r,r=1;64>r;){var i=m(e.o),n=15&i;if(i>>=4,0===n){if(15>i)break;r+=16}else r+=i,e.a[t+l[r]]=v(n),r++}}function y(e,t){var r=m(e.D);r=0===r?0:v(r)<<d,e.a[t]=e.m+=r}function _(e,t){e.a[t]|=p()<<d}function w(e,t){if(0<j)j--;else for(var r=u;r<=h;){var i=m(e.o),n=15&i;if(i>>=4,0===n){if(15>i){j=b(i)+(1<<i)-1;break}r+=16}else r+=i,e.a[t+l[r]]=v(n)*(1<<d),r++}}function x(e,t){for(var r,n=u,a=0;n<=h;){r=t+l[n];var s=0>e.a[r]?-1:1;switch(R){case 0:if(r=15&(a=m(e.o)),a>>=4,0===r)15>a?(j=b(a)+(1<<a),R=4):(a=16,R=1);else{if(1!==r)throw new i("invalid ACn encoding");k=v(r),R=a?2:3}continue;case 1:case 2:e.a[r]?e.a[r]+=s*(p()<<d):0==--a&&(R=2===R?3:0);break;case 3:e.a[r]?e.a[r]+=s*(p()<<d):(e.a[r]=k<<d,R=0);break;case 4:e.a[r]&&(e.a[r]+=s*(p()<<d))}n++}4===R&&0==--j&&(R=0)}for(var k,S,C,U,E,T,M,O=9<arguments.length&&void 0!==arguments[9]&&arguments[9],P=n.P,A=t,I=0,L=0,j=0,R=0,D=s.length,B=n.S?0===u?0===f?y:_:0===f?w:x:g,F=0,N=1===D?s[0].c*s[0].l:P*n.O;F<N;){var z=o?Math.min(N-F,o):N;for(S=0;S<D;S++)s[S].m=0;if(j=0,1===D){var H=s[0];for(E=0;E<z;E++)B(H,64*((H.c+1)*(F/H.c|0)+F%H.c)),F++}else for(E=0;E<z;E++){for(S=0;S<D;S++)for(T=(H=s[S]).h,M=H.j,C=0;C<M;C++)for(U=0;U<T;U++)B(H,64*((H.c+1)*((F/P|0)*H.j+C)+(F%P*H.h+U)));F++}if(L=0,(H=c(e,t))&&H.f&&((0,_util.warn)("decodeScan - unexpected MCU data, current marker is: "+H.f),t=H.offset),!(H=H&&H.F)||65280>=H)throw new i("marker was not found");if(!(65488<=H&&65495>=H))break;t+=2}return(H=c(e,t))&&H.f&&((0,_util.warn)("decodeScan - unexpected Scan data, current marker is: "+H.f),t=H.offset),t-A}function o(e,t){for(var r=t.c,n=t.l,a=new Int16Array(64),s=0;s<n;s++)for(var o=0;o<r;o++){var c=64*((t.c+1)*s+o),l=a,u=t.G,h=t.a;if(!u)throw new i("missing required Quantization Table.");for(var f=0;64>f;f+=8){var d=h[c+f],p=h[c+f+1],m=h[c+f+2],b=h[c+f+3],v=h[c+f+4],g=h[c+f+5],y=h[c+f+6],_=h[c+f+7];if(d*=u[f],0==(p|m|b|v|g|y|_))d=5793*d+512>>10,l[f]=d,l[f+1]=d,l[f+2]=d,l[f+3]=d,l[f+4]=d,l[f+5]=d,l[f+6]=d,l[f+7]=d;else{p*=u[f+1],m*=u[f+2],b*=u[f+3],v*=u[f+4],g*=u[f+5];var w=5793*d+128>>8,x=5793*v+128>>8,k=m,S=y*=u[f+6];x=(w=w+x+1>>1)-x,d=3784*k+1567*S+128>>8,k=1567*k-3784*S+128>>8,g=(v=(v=2896*(p-(_*=u[f+7]))+128>>8)+(g<<=4)+1>>1)-g,b=(_=(_=2896*(p+_)+128>>8)+(b<<=4)+1>>1)-b,S=(w=w+(S=d)+1>>1)-S,k=(x=x+k+1>>1)-k,d=2276*v+3406*_+2048>>12,v=3406*v-2276*_+2048>>12,_=d,d=799*b+4017*g+2048>>12,b=4017*b-799*g+2048>>12,g=d,l[f]=w+_,l[f+7]=w-_,l[f+1]=x+g,l[f+6]=x-g,l[f+2]=k+b,l[f+5]=k-b,l[f+3]=S+v,l[f+4]=S-v}}for(u=0;8>u;++u)d=l[u],0==((p=l[u+8])|(m=l[u+16])|(b=l[u+24])|(v=l[u+32])|(g=l[u+40])|(y=l[u+48])|(_=l[u+56]))?(d=-2040>(d=5793*d+8192>>14)?0:2024<=d?255:d+2056>>4,h[c+u]=d,h[c+u+8]=d,h[c+u+16]=d,h[c+u+24]=d,h[c+u+32]=d,h[c+u+40]=d,h[c+u+48]=d,h[c+u+56]=d):(w=5793*d+2048>>12,x=5793*v+2048>>12,d=3784*(k=m)+1567*(S=y)+2048>>12,k=1567*k-3784*S+2048>>12,S=d,g=(v=(v=2896*(p-_)+2048>>12)+g+1>>1)-g,b=(_=(_=2896*(p+_)+2048>>12)+b+1>>1)-b,d=2276*v+3406*_+2048>>12,v=3406*v-2276*_+2048>>12,_=d,d=799*b+4017*g+2048>>12,b=4017*b-799*g+2048>>12,p=(x=(x=(w=4112+(w+x+1>>1))-x)+k+1>>1)+(g=d),y=x-g,g=(k=x-k)-b,d=16>(d=(w=w+S+1>>1)+_)?0:4080<=d?255:d>>4,p=16>p?0:4080<=p?255:p>>4,m=16>(m=k+b)?0:4080<=m?255:m>>4,b=16>(b=(S=w-S)+v)?0:4080<=b?255:b>>4,v=16>(v=S-v)?0:4080<=v?255:v>>4,g=16>g?0:4080<=g?255:g>>4,y=16>y?0:4080<=y?255:y>>4,_=16>(_=w-_)?0:4080<=_?255:_>>4,h[c+u]=d,h[c+u+8]=p,h[c+u+16]=m,h[c+u+24]=b,h[c+u+32]=v,h[c+u+40]=g,h[c+u+48]=y,h[c+u+56]=_)}return t.a}function c(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t,i=e.length-1;if(r=r<t?r:t,t>=i)return null;var n=e[t]<<8|e[t+1];if(65472<=n&&65534>=n)return{f:null,F:n,offset:t};for(var a=e[r]<<8|e[r+1];!(65472<=a&&65534>=a);){if(++r>=i)return null;a=e[r]<<8|e[r+1]}return{f:n.toString(16),F:a,offset:r}}var l=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);t.prototype={parse:function(e){function t(){var t=e[d]<<8|e[d+1];return d+=2,t}function r(){var r=t(),i=c(e,r=d+r-2,d);return i&&i.f&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+i.f),r=i.offset),r=e.subarray(d,r),d+=r.length,r}function u(e){for(var t=Math.ceil(e.v/8/e.s),r=Math.ceil(e.g/8/e.u),i=0;i<e.b.length;i++){E=e.b[i];var n=Math.ceil(Math.ceil(e.v/8)*E.h/e.s),a=Math.ceil(Math.ceil(e.g/8)*E.j/e.u);E.a=new Int16Array(64*r*E.j*(t*E.h+1)),E.c=n,E.l=a}e.P=t,e.O=r}var h=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).N,f=void 0===h?null:h,d=0,p=null,m=0;h=[];var b=[],v=[],g=t();if(65496!==g)throw new i("SOI not found");for(g=t();65497!==g;){switch(g){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var y=r();65518===g&&65===y[0]&&100===y[1]&&111===y[2]&&98===y[3]&&101===y[4]&&(p={version:y[5]<<8|y[6],Y:y[7]<<8|y[8],Z:y[9]<<8|y[10],W:y[11]});break;case 65499:g=t()+d-2;for(var _;d<g;){var w=e[d++],x=new Uint16Array(64);if(0==w>>4)for(y=0;64>y;y++)x[_=l[y]]=e[d++];else{if(1!=w>>4)throw new i("DQT - invalid table spec");for(y=0;64>y;y++)x[_=l[y]]=t()}h[15&w]=x}break;case 65472:case 65473:case 65474:if(k)throw new i("Only single frame JPEGs supported");t();var k={};for(k.X=65473===g,k.S=65474===g,k.precision=e[d++],g=t(),k.g=f||g,k.v=t(),k.b=[],k.C={},y=e[d++],g=x=w=0;g<y;g++){_=e[d];var S=e[d+1]>>4,C=15&e[d+1];w<S&&(w=S),x<C&&(x=C),S=k.b.push({h:S,j:C,T:e[d+2],G:null}),k.C[_]=S-1,d+=3}k.s=w,k.u=x,u(k);break;case 65476:for(_=t(),g=2;g<_;){for(w=e[d++],x=new Uint8Array(16),y=S=0;16>y;y++,d++)S+=x[y]=e[d];for(C=new Uint8Array(S),y=0;y<S;y++,d++)C[y]=e[d];g+=17+S,(0==w>>4?v:b)[15&w]=n(x,C)}break;case 65501:t();var U=t();break;case 65498:for(y=1==++m&&!f,t(),w=e[d++],_=[],g=0;g<w;g++){x=k.C[e[d++]];var E=k.b[x];x=e[d++],E.D=v[x>>4],E.o=b[15&x],_.push(E)}g=e[d++],w=e[d++],x=e[d++];try{var T=s(e,d,k,_,U,g,w,x>>4,15&x,y);d+=T}catch(M){if(M instanceof a)return(0,_util.warn)('Attempting to re-parse JPEG image using "scanLines" parameter found in DNL marker (0xFFDC) segment.'),this.parse(e,{N:M.g});throw M}break;case 65500:d+=4;break;case 65535:255!==e[d]&&d--;break;default:if(255===e[d-3]&&192<=e[d-2]&&254>=e[d-2])d-=3;else{if(!(y=c(e,d-2))||!y.f)throw new i("unknown marker "+g.toString(16));(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+y.f),d=y.offset}}g=t()}for(this.width=k.v,this.height=k.g,this.A=p,this.b=[],g=0;g<k.b.length;g++)(U=h[(E=k.b[g]).T])&&(E.G=U),this.b.push({R:o(k,E),U:E.h/k.s,V:E.j/k.u,c:E.c,l:E.l});this.i=this.b.length},L:function(e,t){var r,i,n=this.width/e,a=this.height/t,s=this.b.length,o=e*t*s,c=new Uint8ClampedArray(o),l=new Uint32Array(e);for(i=0;i<s;i++){var u=this.b[i],h=u.U*n,f=u.V*a,d=i,p=u.R,m=u.c+1<<3;for(r=0;r<e;r++)u=0|r*h,l[r]=(4294967288&u)<<3|7&u;for(h=0;h<t;h++)for(u=m*(4294967288&(u=0|h*f))|(7&u)<<3,r=0;r<e;r++)c[d]=p[u+l[r]],d+=s}if(a=this.M)for(i=0;i<o;)for(n=u=0;u<s;u++,i++,n+=2)c[i]=(c[i]*a[n]>>8)+a[n+1];return c},w:function(){return this.A?!!this.A.W:3===this.i?0!==this.B:1===this.B},I:function(e){for(var t,r,i,n=0,a=e.length;n<a;n+=3)t=e[n],r=e[n+1],i=e[n+2],e[n]=t-179.456+1.402*i,e[n+1]=t+135.459-.344*r-.714*i,e[n+2]=t-226.816+1.772*r;return e},K:function(e){for(var t,r,i,n,a=0,s=0,o=e.length;s<o;s+=4)t=e[s],r=e[s+1],i=e[s+2],n=e[s+3],e[a++]=r*(-660635669420364e-19*r+.000437130475926232*i-54080610064599e-18*t+.00048449797120281*n-.154362151871126)-122.67195406894+i*(-.000957964378445773*i+.000817076911346625*t-.00477271405408747*n+1.53380253221734)+t*(.000961250184130688*t-.00266257332283933*n+.48357088451265)+n*(-.000336197177618394*n+.484791561490776),e[a++]=107.268039397724+r*(219927104525741e-19*r-.000640992018297945*i+.000659397001245577*t+.000426105652938837*n-.176491792462875)+i*(-.000778269941513683*i+.00130872261408275*t+.000770482631801132*n-.151051492775562)+t*(.00126935368114843*t-.00265090189010898*n+.25802910206845)+n*(-.000318913117588328*n-.213742400323665),e[a++]=r*(-.000570115196973677*r-263409051004589e-19*i+.0020741088115012*t-.00288260236853442*n+.814272968359295)-20.810012546947+i*(-153496057440975e-19*i-.000132689043961446*t+.000560833691242812*n-.195152027534049)+t*(.00174418132927582*t-.00255243321439347*n+.116935020465145)+n*(-.000343531996510555*n+.24165260232407);return e.subarray(0,a)},J:function(e){for(var t,r,i,n=0,a=e.length;n<a;n+=4)t=e[n],r=e[n+1],i=e[n+2],e[n]=434.456-t-1.402*i,e[n+1]=119.541-t+.344*r+.714*i,e[n+2]=481.816-t-1.772*r;return e},H:function(e){for(var t,r,i,n,a=0,s=1/255,o=0,c=e.length;o<c;o+=4)t=e[o]*s,r=e[o+1]*s,i=e[o+2]*s,n=e[o+3]*s,e[a++]=255+t*(-4.387332384609988*t+54.48615194189176*r+18.82290502165302*i+212.25662451639585*n-285.2331026137004)+r*(1.7149763477362134*r-5.6096736904047315*i-17.873870861415444*n-5.497006427196366)+i*(-2.5217340131683033*i-21.248923337353073*n+17.5119270841813)-n*(21.86122147463605*n+189.48180835922747),e[a++]=255+t*(8.841041422036149*t+60.118027045597366*r+6.871425592049007*i+31.159100130055922*n-79.2970844816548)+r*(-15.310361306967817*r+17.575251261109482*i+131.35250912493976*n-190.9453302588951)+i*(4.444339102852739*i+9.8632861493405*n-24.86741582555878)-n*(20.737325471181034*n+187.80453709719578),e[a++]=255+t*(.8842522430003296*t+8.078677503112928*r+30.89978309703729*i-.23883238689178934*n-14.183576799673286)+r*(10.49593273432072*r+63.02378494754052*i+50.606957656360734*n-112.23884253719248)+i*(.03296041114873217*i+115.60384449646641*n-193.58209356861505)-n*(22.33816807309886*n+180.12613974708367);return e.subarray(0,a)},getData:function(e,t,r){if(4<this.i)throw new i("Unsupported color mode");if(e=this.L(e,t),1===this.i&&r){r=e.length,t=new Uint8ClampedArray(3*r);for(var n=0,a=0;a<r;a++){var s=e[a];t[n++]=s,t[n++]=s,t[n++]=s}return t}if(3===this.i&&this.w())return this.I(e);if(4===this.i){if(this.w())return r?this.K(e):this.J(e);if(r)return this.H(e)}return e}},e.JpegDecoder=t}(),e.encodeImage=function(t,r,i,n){var a={t256:[r],t257:[i],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[i],t279:[r*i*4],t282:[1],t283:[1],t284:[1],t286:[0],t287:[0],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(n)for(var s in n)a[s]=n[s];var o=new Uint8Array(e.encode([a])),c=new Uint8Array(t),l=new Uint8Array(1e3+r*i*4);for(s=0;s<o.length;s++)l[s]=o[s];for(s=0;s<c.length;s++)l[1e3+s]=c[s];return l.buffer},e.encode=function(t){var r=new Uint8Array(2e4),i=4,n=e._binBE;r[0]=77,r[1]=77,r[3]=42;var a=8;n.writeUint(r,i,a),i+=4;for(var s=0;s<t.length;s++){var o=e._writeIFD(n,r,a,t[s]);a=o[1],s<t.length-1&&n.writeUint(r,o[0],a)}return r.slice(0,a).buffer},e.decode=function(t){e.decode._decodeG3.allow2D=null;var r=new Uint8Array(t),i=0,n=e._binBE.readASCII(r,i,2);i+=2;var a="II"==n?e._binLE:e._binBE;a.readUshort(r,i),i+=2;var s=a.readUint(r,i);i+=4;for(var o=[];;){var c=e._readIFD(a,r,s,o);if(0==(s=a.readUint(r,c)))break}return o},e.decodeImages=function(t,r){for(var i=new Uint8Array(t),a=e._binBE.readASCII(i,0,2),s=0;s<r.length;s++){var o=r[s];if(null!=o.t256){o.isLE="II"==a,o.width=o.t256[0],o.height=o.t257[0];var c=o.t259?o.t259[0]:1,l=o.t266?o.t266[0]:1;o.t284&&2==o.t284[0]&&n("PlanarConfiguration 2 should not be used!");var u=(o.t258?Math.min(32,o.t258[0]):1)*(o.t277?o.t277[0]:1),h=8*Math.ceil(o.width*u/8),f=o.t273;null==f&&(f=o.t324);var d=o.t279;1==c&&1==f.length&&(d=[o.height*(h>>>3)]),null==d&&(d=o.t325);var p=new Uint8Array(o.height*(h>>>3)),m=0;if(null!=o.t322){for(var b=o.t322[0],v=o.t323[0],g=Math.floor((o.width+b-1)/b),y=Math.floor((o.height+v-1)/v),_=new Uint8Array(0|Math.ceil(b*v*u/8)),w=0;w<y;w++)for(var x=0;x<g;x++){for(var k=w*g+x,S=0;S<_.length;S++)_[S]=0;e.decode._decompress(o,i,f[k],d[k],c,_,0,l),6==c?p=_:e._copyTile(_,0|Math.ceil(b*u/8),v,p,0|Math.ceil(o.width*u/8),o.height,0|Math.ceil(x*b*u/8),w*v)}m=8*p.length}else{var C=o.t278?o.t278[0]:o.height;for(C=Math.min(C,o.height),k=0;k<f.length;k++)e.decode._decompress(o,i,f[k],d[k],c,p,0|Math.ceil(m/8),l),m+=h*C;m=Math.min(m,8*p.length)}o.data=new Uint8Array(p.buffer,0,0|Math.ceil(m/8))}}},e.decode._decompress=function(r,i,a,s,o,c,l,u){if(1==o)for(var h=0;h<s;h++)c[l+h]=i[a+h];else if(3==o)e.decode._decodeG3(i,a,s,c,l,r.width,u);else if(4==o)e.decode._decodeG4(i,a,s,c,l,r.width,u);else if(5==o)e.decode._decodeLZW(i,a,c,l);else if(6==o)e.decode._decodeOldJPEG(r,i,a,s,c,l);else if(7==o)e.decode._decodeNewJPEG(r,i,a,s,c,l);else if(8==o)for(var f=new Uint8Array(i.buffer,a,s),d=t.inflate(f),p=0;p<d.length;p++)c[l+p]=d[p];else 32773==o?e.decode._decodePackBits(i,a,s,c,l):32809==o?e.decode._decodeThunder(i,a,s,c,l):n("Unknown compression",o);if(r.t317&&2==r.t317[0])for(var m=r.t277?r.t277[0]:1,b=r.t278?r.t278[0]:r.height,v=r.width*m,g=0;g<b;g++){var y=l+g*v;if(3==m)for(h=3;h<v;h+=3)c[y+h]=c[y+h]+c[y+h-3]&255,c[y+h+1]=c[y+h+1]+c[y+h-2]&255,c[y+h+2]=c[y+h+2]+c[y+h-1]&255;else for(h=m;h<v;h++)c[y+h]=c[y+h]+c[y+h-m]&255}},e.decode._decodeNikon=function(e,t,r,i,a){var s,o;n(e.slice(t,t+100)),s=e[t],o=e[++t],t++,n(s.toString(16),o.toString(16),r)},e.decode._decodeNewJPEG=function(t,r,i,n,a,s){var o=t.t347,c=o?o.length:0,l=new Uint8Array(c+n);if(o){for(var u=216,h=217,f=0,d=0;d<c-1&&(255!=o[d]||o[d+1]!=h);d++)l[f++]=o[d];var p=r[i],m=r[i+1];for(255==p&&m==u||(l[f++]=p,l[f++]=m),d=2;d<n;d++)l[f++]=r[i+d]}else for(d=0;d<n;d++)l[d]=r[i+d];if(32803==t.t262){var b=t.t258[0],v=(new LosslessJpegDecoder).decode(l),g=v.length;if(16==b)for(d=0;d<g;d++)a[s++]=255&v[d],a[s++]=v[d]>>>8;else{if(12!=b)throw new Error("unsupported bit depth "+b);for(d=0;d<g;d+=2)a[s++]=v[d]>>>4,a[s++]=255&(v[d]<<4|v[d+1]>>>8),a[s++]=255&v[d+1]}}else{var y=new e.JpegDecoder;y.parse(l);var _=y.getData(y.width,y.height);for(d=0;d<_.length;d++)a[s+d]=_[d]}6==t.t262[0]&&(t.t262[0]=2)},e.decode._decodeOldJPEGInit=function(e,t,r,i){var a,s,o,c,l,u=216,h=219,f=196,d=221,p=192,m=218,b=0,v=0,g=!1,y=e.t513,_=y?y[0]:0,w=e.t514,x=w?w[0]:0,k=e.t324||e.t273||y,S=e.t530,C=0,U=0,E=e.t277?e.t277[0]:1,T=e.t515;if(k&&(v=k[0],g=k.length>1),!g){if(255==t[r]&&t[r+1]==u)return{jpegOffset:r};if(null!=y&&(255==t[r+_]&&t[r+_+1]==u?b=r+_:n("JPEGInterchangeFormat does not point to SOI"),null==w?n("JPEGInterchangeFormatLength field is missing"):(_>=v||_+x<=v)&&n("JPEGInterchangeFormatLength field value is invalid"),null!=b))return{jpegOffset:b}}if(null!=S&&(C=S[0],U=S[1]),null!=y&&null!=w)if(x>=2&&_+x<=v){for(a=255==t[r+_+x-2]&&t[r+_+x-1]==u?new Uint8Array(x-2):new Uint8Array(x),o=0;o<a.length;o++)a[o]=t[r+_+o];n("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else n("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==a){var M=0,O=[];O[M++]=255,O[M++]=u;var P=e.t519;if(null==P)throw new Error("JPEGQTables tag is missing");for(o=0;o<P.length;o++)for(O[M++]=255,O[M++]=h,O[M++]=0,O[M++]=67,O[M++]=o,c=0;c<64;c++)O[M++]=t[r+P[o]+c];for(l=0;l<2;l++){var A=e[0==l?"t520":"t521"];if(null==A)throw new Error((0==l?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(o=0;o<A.length;o++){O[M++]=255,O[M++]=f;var I=19;for(c=0;c<16;c++)I+=t[r+A[o]+c];for(O[M++]=I>>>8,O[M++]=255&I,O[M++]=o|l<<4,c=0;c<16;c++)O[M++]=t[r+A[o]+c];for(c=0;c<I;c++)O[M++]=t[r+A[o]+16+c]}}if(O[M++]=255,O[M++]=p,O[M++]=0,O[M++]=8+3*E,O[M++]=8,O[M++]=e.height>>>8&255,O[M++]=255&e.height,O[M++]=e.width>>>8&255,O[M++]=255&e.width,O[M++]=E,1==E)O[M++]=1,O[M++]=17,O[M++]=0;else for(o=0;o<3;o++)O[M++]=o+1,O[M++]=0!=o?17:(15&C)<<4|15&U,O[M++]=o;null!=T&&0!=T[0]&&(O[M++]=255,O[M++]=d,O[M++]=0,O[M++]=4,O[M++]=T[0]>>>8&255,O[M++]=255&T[0]),a=new Uint8Array(O)}var L=-1;for(o=0;o<a.length-1;){if(255==a[o]&&a[o+1]==p){L=o;break}o++}if(-1==L){var j=new Uint8Array(a.length+10+3*E);j.set(a);var R=a.length;if(L=a.length,(a=j)[R++]=255,a[R++]=p,a[R++]=0,a[R++]=8+3*E,a[R++]=8,a[R++]=e.height>>>8&255,a[R++]=255&e.height,a[R++]=e.width>>>8&255,a[R++]=255&e.width,a[R++]=E,1==E)a[R++]=1,a[R++]=17,a[R++]=0;else for(o=0;o<3;o++)a[R++]=o+1,a[R++]=0!=o?17:(15&C)<<4|15&U,a[R++]=o}if(255==t[v]&&t[v+1]==m){var D=t[v+2]<<8|t[v+3];for((s=new Uint8Array(D+2))[0]=t[v],s[1]=t[v+1],s[2]=t[v+2],s[3]=t[v+3],o=0;o<D-2;o++)s[o+4]=t[v+o+4]}else{var B=0;if((s=new Uint8Array(8+2*E))[B++]=255,s[B++]=m,s[B++]=0,s[B++]=6+2*E,s[B++]=E,1==E)s[B++]=1,s[B++]=0;else for(o=0;o<3;o++)s[B++]=o+1,s[B++]=o<<4|o;s[B++]=0,s[B++]=63,s[B++]=0}return{jpegOffset:r,tables:a,sosMarker:s,sofPosition:L}},e.decode._decodeOldJPEG=function(t,r,i,n,a,s){var o,c,l,u=e.decode._decodeOldJPEGInit(t,r,i,n);if(null!=u.jpegOffset)for(o=i+n-u.jpegOffset,l=new Uint8Array(o),d=0;d<o;d++)l[d]=r[u.jpegOffset+d];else{for(c=u.tables.length,(l=new Uint8Array(c+u.sosMarker.length+n+2)).set(u.tables),l[u.sofPosition+5]=t.height>>>8&255,l[u.sofPosition+6]=255&t.height,l[u.sofPosition+7]=t.width>>>8&255,l[u.sofPosition+8]=255&t.width,255==r[i]&&r[i+1]==SOS||(l.set(u.sosMarker,bufoff),bufoff+=sosMarker.length),d=0;d<n;d++)l[bufoff++]=r[i+d];l[bufoff++]=255,l[bufoff++]=EOI}var h=new e.JpegDecoder;h.parse(l);for(var f=h.getData(h.width,h.height),d=0;d<f.length;d++)a[s+d]=f[d];6==t.t262[0]&&(t.t262[0]=2)},e.decode._decodePackBits=function(e,t,r,i,n){for(var a=new Int8Array(e.buffer),s=new Int8Array(i.buffer),o=t+r;t<o;){var c=a[t];if(t++,c>=0&&c<128)for(var l=0;l<c+1;l++)s[n]=a[t],n++,t++;if(c>=-127&&c<0){for(l=0;l<1-c;l++)s[n]=a[t],n++;t++}}},e.decode._decodeThunder=function(e,t,r,i,n){for(var a=[0,1,0,-1],s=[0,1,2,3,0,-3,-2,-1],o=t+r,c=2*n,l=0;t<o;){var u=e[t],h=u>>>6,f=63&u;if(t++,3==h&&(l=15&f,i[c>>>1]|=l<<4*(1-c&1),c++),0==h)for(var d=0;d<f;d++)i[c>>>1]|=l<<4*(1-c&1),c++;if(2==h)for(d=0;d<2;d++)4!=(p=f>>>3*(1-d)&7)&&(l+=s[p],i[c>>>1]|=l<<4*(1-c&1),c++);if(1==h)for(d=0;d<3;d++){var p;2!=(p=f>>>2*(2-d)&3)&&(l+=a[p],i[c>>>1]|=l<<4*(1-c&1),c++)}}},e.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},e.decode._lens=function(){var e=function(e,t,r,i){for(var n=0;n<t.length;n++)e[t[n]]=r+n*i},t="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",r="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",i="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",n="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",a="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";t=t.split(","),r=r.split(","),i=i.split(","),n=n.split(","),a=a.split(",");var s={},o={};return e(s,t,0,1),e(s,i,64,64),e(s,a,1792,64),e(o,r,0,1),e(o,n,64,64),e(o,a,1792,64),[s,o]}(),e.decode._decodeG4=function(t,r,i,n,a,s,o){for(var c=e.decode,l=r<<3,u=0,h="",f=[],d=[],p=0;p<s;p++)d.push(0);d=c._makeDiff(d);for(var m=0,b=0,v=0,g=0,y=0,_=0,w="",x=0,k=8*Math.ceil(s/8);l>>>3<r+i;){v=c._findDiff(d,m+(0==m?0:1),1-y),g=c._findDiff(d,v,y);var S=0;if(1==o&&(S=t[l>>>3]>>>7-(7&l)&1),2==o&&(S=t[l>>>3]>>>(7&l)&1),l++,h+=S,"H"==w){if(null!=c._lens[y][h]){var C=c._lens[y][h];h="",u+=C,C<64&&(c._addNtimes(f,u,y),m+=u,y=1-y,u=0,0==--x&&(w=""))}}else"0001"==h&&(h="",c._addNtimes(f,g-m,y),m=g),"001"==h&&(h="",w="H",x=2),null!=c._dmap[h]&&(b=v+c._dmap[h],c._addNtimes(f,b-m,y),m=b,h="",y=1-y);f.length==s&&""==w&&(c._writeBits(f,n,8*a+_*k),y=0,_++,m=0,d=c._makeDiff(f),f=[])}},e.decode._findDiff=function(e,t,r){for(var i=0;i<e.length;i+=2)if(e[i]>=t&&e[i+1]==r)return e[i]},e.decode._makeDiff=function(e){var t=[];1==e[0]&&t.push(0,1);for(var r=1;r<e.length;r++)e[r-1]!=e[r]&&t.push(r,e[r]);return t.push(e.length,0,e.length,1),t},e.decode._decodeG3=function(t,r,i,n,a,s,o){for(var c=e.decode,l=r<<3,u=0,h="",f=[],d=[],p=0;p<s;p++)f.push(0);for(var m=0,b=0,v=0,g=0,y=0,_=-1,w="",x=0,k=!1,S=8*Math.ceil(s/8);l>>>3<r+i;){v=c._findDiff(d,m+(0==m?0:1),1-y),g=c._findDiff(d,v,y);var C=0;if(1==o&&(C=t[l>>>3]>>>7-(7&l)&1),2==o&&(C=t[l>>>3]>>>(7&l)&1),l++,h+=C,k){if(null!=c._lens[y][h]){var U=c._lens[y][h];h="",u+=U,U<64&&(c._addNtimes(f,u,y),y=1-y,u=0)}}else"H"==w?null!=c._lens[y][h]&&(U=c._lens[y][h],h="",u+=U,U<64&&(c._addNtimes(f,u,y),m+=u,y=1-y,u=0,0==--x&&(w=""))):("0001"==h&&(h="",c._addNtimes(f,g-m,y),m=g),"001"==h&&(h="",w="H",x=2),null!=c._dmap[h]&&(b=v+c._dmap[h],c._addNtimes(f,b-m,y),m=b,h="",y=1-y));h.endsWith("000000000001")&&(_>=0&&c._writeBits(f,n,8*a+_*S),1==o&&(k=1==(t[l>>>3]>>>7-(7&l)&1)),2==o&&(k=1==(t[l>>>3]>>>(7&l)&1)),l++,null==c._decodeG3.allow2D&&(c._decodeG3.allow2D=k),c._decodeG3.allow2D||(k=!0,l--),h="",y=0,_++,m=0,d=c._makeDiff(f),f=[])}f.length==s&&c._writeBits(f,n,8*a+_*S)},e.decode._addNtimes=function(e,t,r){for(var i=0;i<t;i++)e.push(r)},e.decode._writeBits=function(e,t,r){for(var i=0;i<e.length;i++)t[r+i>>>3]|=e[i]<<7-(r+i&7)},e.decode._decodeLZW=function(t,r,i,n){if(null==e.decode._lzwTab){for(var a=new Uint32Array(65535),s=new Uint16Array(65535),o=new Uint8Array(2e6),c=0;c<256;c++)o[c<<2]=c,a[c]=c<<2,s[c]=1;e.decode._lzwTab=[a,s,o]}for(var l=e.decode._copyData,u=e.decode._lzwTab[0],h=e.decode._lzwTab[1],f=(o=e.decode._lzwTab[2],258),d=1032,p=9,m=r<<3,b=256,v=257,g=0,y=0;g=(t[m>>>3]<<16|t[m+8>>>3]<<8|t[m+16>>>3])>>24-(7&m)-p&(1<<p)-1,m+=p,g!=v;){if(g==b){if(p=9,f=258,d=1032,g=(t[m>>>3]<<16|t[m+8>>>3]<<8|t[m+16>>>3])>>24-(7&m)-p&(1<<p)-1,m+=p,g==v)break;i[n]=g,n++}else if(g<f){var _=u[g],w=h[g];l(o,_,i,n,w),n+=w,y>=f?(u[f]=d,o[u[f]]=_[0],h[f]=1,d=d+1+3&-4,f++):(u[f]=d,l(o,u[y],o,d,x=h[y]),o[d+x]=o[_],x++,h[f]=x,f++,d=d+x+3&-4),f+1==1<<p&&p++}else{var x;y>=f?(u[f]=d,h[f]=0,f++):(u[f]=d,l(o,u[y],o,d,x=h[y]),o[d+x]=o[d],x++,h[f]=x,f++,l(o,d,i,n,x),n+=x,d=d+x+3&-4),f+1==1<<p&&p++}y=g}},e.decode._copyData=function(e,t,r,i,n){for(var a=0;a<n;a+=4)r[i+a]=e[t+a],r[i+a+1]=e[t+a+1],r[i+a+2]=e[t+a+2],r[i+a+3]=e[t+a+3]},e.tags={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffset",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",296:"ResolutionUnit",297:"PageNumber",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffset",325:"TileByteCounts",330:"SubIFDs",336:"DotRange",338:"ExtraSample",339:"SampleFormat",347:"JPEGTables",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",700:"XMP",33421:"CFARepeatPatternDim",33422:"CFAPattern",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33723:"IPTC/NAA",34377:"Photoshop",34665:"ExifIFD",34675:"ICC Profile",34850:"ExposureProgram",34853:"GPSInfo",34855:"ISOSpeedRatings",34858:"TimeZoneOffset",34859:"SelfTimeMode",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37377:"ShutterSpeedValue",37378:"ApertureValue",37380:"ExposureBiasValue",37383:"MeteringMode",37385:"Flash",37386:"FocalLength",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37398:"TIFF/EPStandardID",37399:"SensingMethod",37500:"MakerNote",37510:"UserComment",37724:"ImageSourceData",40092:"XPComment",40094:"XPKeywords",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelXDimension",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50733:"BayerGreenSplit",50738:"AntiAliasStrength",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50727:"AnalogBalance",50728:"AsShotNeutral",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50827:"OriginalRawFileName",50829:"ActiveArea",50830:"MaskedAreas",50931:"CameraCalibrationSignature",50932:"ProfileCalibrationSignature",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualityFinalSize",51091:"OriginalDefaultCropSize",51125:"DefaultUserCrop"},e.ttypes={256:3,257:3,258:3,259:3,262:3,273:4,274:3,277:3,278:4,279:4,282:5,283:5,284:3,286:5,287:5,296:3,305:2,306:2,338:3,513:4,514:4,34665:4},e._readIFD=function(t,r,i,a){var s=t.readUshort(r,i);i+=2;var o={};a.push(o);for(var c=0;c<s;c++){var l=t.readUshort(r,i);i+=2;var u=t.readUshort(r,i);i+=2;var h=t.readUint(r,i);i+=4;var f=t.readUint(r,i);i+=4;var d=[];if(o["t"+l]=d,1==u||7==u)for(var p=0;p<h;p++)d.push(r[(h<5?i-4:f)+p]);if(2==u&&d.push(t.readASCII(r,h<5?i-4:f,h-1)),3==u)for(p=0;p<h;p++)d.push(t.readUshort(r,(h<3?i-4:f)+2*p));if(4==u)for(p=0;p<h;p++)d.push(t.readUint(r,(h<2?i-4:f)+4*p));if(5==u)for(p=0;p<h;p++)d.push(t.readUint(r,f+8*p)/t.readUint(r,f+8*p+4));if(8==u)for(p=0;p<h;p++)d.push(t.readShort(r,(h<3?i-4:f)+2*p));if(9==u)for(p=0;p<h;p++)d.push(t.readInt(r,(h<2?i-4:f)+4*p));if(10==u)for(p=0;p<h;p++)d.push(t.readInt(r,f+8*p)/t.readInt(r,f+8*p+4));if(11==u)for(p=0;p<h;p++)d.push(t.readFloat(r,f+4*p));if(12==u)for(p=0;p<h;p++)d.push(t.readDouble(r,f+8*p));if(0!=h&&0==d.length&&n("unknown TIFF tag type: ",u,"num:",h),330==l)for(p=0;p<h;p++)e._readIFD(t,r,d[p],a)}return i},e._writeIFD=function(t,r,i,n){var a=Object.keys(n);t.writeUshort(r,i,a.length);for(var s=(i+=2)+12*a.length+4,o=0;o<a.length;o++){var c=a[o],l=parseInt(c.slice(1)),u=e.ttypes[l];if(null==u)throw new Error("unknown type of tag: "+l);var h=n[c];2==u&&(h=h[0]+"\0");var f=h.length;t.writeUshort(r,i,l),i+=2,t.writeUshort(r,i,u),i+=2,t.writeUint(r,i,f);var d=[-1,1,1,2,4,8,0,0,0,0,0,0,8][u]*f,p=i+=4;if(d>4&&(t.writeUint(r,i,s),p=s),2==u&&t.writeASCII(r,p,h),3==u)for(var m=0;m<f;m++)t.writeUshort(r,p+2*m,h[m]);if(4==u)for(m=0;m<f;m++)t.writeUint(r,p+4*m,h[m]);if(5==u)for(m=0;m<f;m++)t.writeUint(r,p+8*m,Math.round(1e4*h[m])),t.writeUint(r,p+8*m+4,1e4);if(12==u)for(m=0;m<f;m++)t.writeDouble(r,p+8*m,h[m]);d>4&&(s+=d+=1&d),i+=4}return[i,s]},e.toRGBA8=function(e){var t=e.width,r=e.height,i=t*r,a=4*i,s=e.data,o=new Uint8Array(4*i),c=e.t262[0],l=e.t258?Math.min(32,e.t258[0]):1,u=e.isLE?1:0;if(0==c)for(var h=Math.ceil(l*t/8),f=0;f<r;f++){var d=f*h,p=f*t;if(1==l)for(var m=0;m<t;m++){var b=p+m<<2,v=s[d+(m>>3)]>>7-(7&m)&1;o[b]=o[b+1]=o[b+2]=255*(1-v),o[b+3]=255}if(4==l)for(m=0;m<t;m++)b=p+m<<2,v=s[d+(m>>1)]>>4-4*(1&m)&15,o[b]=o[b+1]=o[b+2]=17*(15-v),o[b+3]=255;if(8==l)for(m=0;m<t;m++)b=p+m<<2,v=s[d+m],o[b]=o[b+1]=o[b+2]=255-v,o[b+3]=255}else if(1==c)for(h=Math.ceil(l*t/8),f=0;f<r;f++){if(d=f*h,p=f*t,1==l)for(m=0;m<t;m++)b=p+m<<2,v=s[d+(m>>3)]>>7-(7&m)&1,o[b]=o[b+1]=o[b+2]=255*v,o[b+3]=255;if(2==l)for(m=0;m<t;m++)b=p+m<<2,v=s[d+(m>>2)]>>6-2*(3&m)&3,o[b]=o[b+1]=o[b+2]=85*v,o[b+3]=255;if(8==l)for(m=0;m<t;m++)b=p+m<<2,v=s[d+m],o[b]=o[b+1]=o[b+2]=v,o[b+3]=255;if(16==l)for(m=0;m<t;m++)b=p+m<<2,v=s[d+(2*m+u)],o[b]=o[b+1]=o[b+2]=Math.min(255,v),o[b+3]=255}else if(2==c)if(8==l)if(e.t338)if(e.t338[0]>0)for(m=0;m<a;m++)o[m]=s[m];else for(m=0;m<a;m+=4)o[m]=s[m],o[m+1]=s[m+1],o[m+2]=s[m+2],o[m+3]=255;else{if(4==(w=e.t258?e.t258.length:3))for(m=0;m<a;m++)o[m]=s[m];if(3==w)for(m=0;m<i;m++){var g=3*m;o[b=m<<2]=s[g],o[b+1]=s[g+1],o[b+2]=s[g+2],o[b+3]=255}}else for(m=0;m<i;m++)g=6*m,o[b=m<<2]=s[g],o[b+1]=s[g+2],o[b+2]=s[g+4],o[b+3]=255;else if(3==c){var y=e.t320;for(m=0;m<i;m++){b=m<<2;var _=s[m];o[b]=y[_]>>8,o[b+1]=y[256+_]>>8,o[b+2]=y[512+_]>>8,o[b+3]=255}}else if(5==c){var w,x=(w=e.t258?e.t258.length:4)>4?1:0;for(m=0;m<i;m++){b=m<<2;var k=m*w,S=255-s[k],C=255-s[k+1],U=255-s[k+2],E=(255-s[k+3])*(1/255);o[b]=~~(S*E+.5),o[b+1]=~~(C*E+.5),o[b+2]=~~(U*E+.5),o[b+3]=255*(1-x)+s[k+4]*x}}else n("Unknown Photometric interpretation: "+c);return o},e.replaceIMG=function(){for(var t=document.getElementsByTagName("img"),r=0;r<t.length;r++){var i=t[r],n=i.getAttribute("src");if(null!=n){var a=n.split(".").pop().toLowerCase();if("tif"==a||"tiff"==a){var s=new XMLHttpRequest;e._xhrs.push(s),e._imgs.push(i),s.open("GET",n),s.responseType="arraybuffer",s.onload=e._imgLoaded,s.send()}}}},e._xhrs=[],e._imgs=[],e._imgLoaded=function(t){var r=t.target.response,i=e.decode(r),n=i[0];e.decodeImages(r,i);var a=e.toRGBA8(n),s=n.width,o=n.height,c=e._xhrs.indexOf(t.target),l=e._imgs[c];e._xhrs.splice(c,1),e._imgs.splice(c,1);var u=document.createElement("canvas");u.width=s,u.height=o;for(var h=u.getContext("2d"),f=h.createImageData(s,o),d=0;d<a.length;d++)f.data[d]=a[d];h.putImageData(f,0,0);var p=["style","class","id"];for(d=0;d<p.length;d++)u.setAttribute(p[d],l.getAttribute(p[d]));l.parentNode.replaceChild(u,l)},e._binBE={nextZero:function(e,t){for(;0!=e[t];)t++;return t},readUshort:function(e,t){return e[t]<<8|e[t+1]},readShort:function(t,r){var i=e._binBE.ui8;return i[0]=t[r+1],i[1]=t[r+0],e._binBE.i16[0]},readInt:function(t,r){var i=e._binBE.ui8;return i[0]=t[r+3],i[1]=t[r+2],i[2]=t[r+1],i[3]=t[r+0],e._binBE.i32[0]},readUint:function(t,r){var i=e._binBE.ui8;return i[0]=t[r+3],i[1]=t[r+2],i[2]=t[r+1],i[3]=t[r+0],e._binBE.ui32[0]},readASCII:function(e,t,r){for(var i="",n=0;n<r;n++)i+=String.fromCharCode(e[t+n]);return i},readFloat:function(t,r){for(var i=e._binBE.ui8,n=0;n<4;n++)i[n]=t[r+3-n];return e._binBE.fl32[0]},readDouble:function(t,r){for(var i=e._binBE.ui8,n=0;n<8;n++)i[n]=t[r+7-n];return e._binBE.fl64[0]},writeUshort:function(e,t,r){e[t]=r>>8&255,e[t+1]=255&r},writeUint:function(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:function(e,t,r){for(var i=0;i<r.length;i++)e[t+i]=r.charCodeAt(i)},writeDouble:function(t,r,i){e._binBE.fl64[0]=i;for(var n=0;n<8;n++)t[r+n]=e._binBE.ui8[7-n]}},e._binBE.ui8=new Uint8Array(8),e._binBE.i16=new Int16Array(e._binBE.ui8.buffer),e._binBE.i32=new Int32Array(e._binBE.ui8.buffer),e._binBE.ui32=new Uint32Array(e._binBE.ui8.buffer),e._binBE.fl32=new Float32Array(e._binBE.ui8.buffer),e._binBE.fl64=new Float64Array(e._binBE.ui8.buffer),e._binLE={nextZero:e._binBE.nextZero,readUshort:function(e,t){return e[t+1]<<8|e[t]},readShort:function(t,r){var i=e._binBE.ui8;return i[0]=t[r+0],i[1]=t[r+1],e._binBE.i16[0]},readInt:function(t,r){var i=e._binBE.ui8;return i[0]=t[r+0],i[1]=t[r+1],i[2]=t[r+2],i[3]=t[r+3],e._binBE.i32[0]},readUint:function(t,r){var i=e._binBE.ui8;return i[0]=t[r+0],i[1]=t[r+1],i[2]=t[r+2],i[3]=t[r+3],e._binBE.ui32[0]},readASCII:e._binBE.readASCII,readFloat:function(t,r){for(var i=e._binBE.ui8,n=0;n<4;n++)i[n]=t[r+n];return e._binBE.fl32[0]},readDouble:function(t,r){for(var i=e._binBE.ui8,n=0;n<8;n++)i[n]=t[r+n];return e._binBE.fl64[0]}},e._copyTile=function(e,t,r,i,n,a,s,o){for(var c=Math.min(t,n-s),l=Math.min(r,a-o),u=0;u<l;u++)for(var h=(o+u)*n+s,f=u*t,d=0;d<c;d++)i[h+d]=e[f+d]}}(i,"function"==typeof e?e("pako"):self.pako)}()}).call(this,e("_process"))},{_process:133,pako:86}],183:[function(e,t,r){(function(e){function r(e,t){if(i("noDeprecation"))return e;var r=!1;function n(){if(!r){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}return n}function i(t){try{if(!e.localStorage)return!1}catch(i){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=r}).call(this,void 0!==ve?ve:"undefined"!=typeof self?self:void 0!==a?a:{})},{}],184:[function(e,t,r){arguments[4][26][0].apply(r,arguments)},{dup:26}],185:[function(e,t,r){arguments[4][27][0].apply(r,arguments)},{dup:27}],186:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{"./support/isBuffer":185,_process:133,dup:28,inherits:184}],187:[function(e,t,r){var i=e("global/window"),n=e("is-function"),a=e("parse-headers"),s=e("xtend");function o(e,t){for(var r=0;r<e.length;r++)t(e[r])}function c(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function l(e,t,r){var i=e;return n(t)?(r=t,"string"==typeof e&&(i={uri:e})):i=s(t,{uri:e}),i.callback=r,i}function u(e,t,r){return h(t=l(e,t,r))}function h(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,r=function(r,i,n){t||(t=!0,e.callback(r,i,n))};function i(){4===d.readyState&&setTimeout(o,0)}function n(){var e=void 0;if(e=d.response?d.response:d.responseText||f(d),_)try{e=JSON.parse(e)}catch(t){}return e}function s(e){return clearTimeout(p),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,r(e,w)}function o(){if(!h){var t;clearTimeout(p),t=e.useXDR&&void 0===d.status?200:1223===d.status?204:d.status;var i=w,s=null;return 0!==t?(i={body:n(),statusCode:t,method:b,headers:{},url:m,rawRequest:d},d.getAllResponseHeaders&&(i.headers=a(d.getAllResponseHeaders()))):s=new Error("Internal XMLHttpRequest Error"),r(s,i,i.body)}}var l,h,d=e.xhr||null;d||(d=e.cors||e.useXDR?new u.XDomainRequest:new u.XMLHttpRequest);var p,m=d.url=e.uri||e.url,b=d.method=e.method||"GET",v=e.body||e.data,g=d.headers=e.headers||{},y=!!e.sync,_=!1,w={body:void 0,headers:{},statusCode:0,method:b,url:m,rawRequest:d};if("json"in e&&!1!==e.json&&(_=!0,g.accept||g.Accept||(g.Accept="application/json"),"GET"!==b&&"HEAD"!==b&&(g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json"),v=JSON.stringify(!0===e.json?v:e.json))),d.onreadystatechange=i,d.onload=o,d.onerror=s,d.onprogress=function(){},d.onabort=function(){h=!0},d.ontimeout=s,d.open(b,m,!y,e.username,e.password),y||(d.withCredentials=!!e.withCredentials),!y&&e.timeout>0&&(p=setTimeout((function(){if(!h){h=!0,d.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",s(e)}}),e.timeout)),d.setRequestHeader)for(l in g)g.hasOwnProperty(l)&&d.setRequestHeader(l,g[l]);else if(e.headers&&!c(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(d.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(d),d.send(v||null),d}function f(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(r){}return null}function d(){}t.exports=u,t.exports.default=u,u.XMLHttpRequest=i.XMLHttpRequest||d,u.XDomainRequest="withCredentials"in new u.XMLHttpRequest?u.XMLHttpRequest:i.XDomainRequest,o(["get","put","post","patch","head","delete"],(function(e){u["delete"===e?"del":e]=function(t,r,i){return(r=l(t,r,i)).method=e.toUpperCase(),h(r)}}))},{"global/window":71,"is-function":78,"parse-headers":106,xtend:189}],188:[function(e,t,r){t.exports=void 0!==self.DOMParser?function(e){return(new self.DOMParser).parseFromString(e,"application/xml")}:void 0!==self.ActiveXObject&&new self.ActiveXObject("Microsoft.XMLDOM")?function(e){var t=new self.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}:function(e){var t=document.createElement("div");return t.innerHTML=e,t}},{}],189:[function(e,t,r){t.exports=n;var i=Object.prototype.hasOwnProperty;function n(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)i.call(r,n)&&(e[n]=r[n])}return e}},{}],190:[function(e,t,r){function i(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a;return{r:(e.r*e.a+t.r*t.a*(1-e.a))/i,g:(e.g*e.a+t.g*t.a*(1-e.a))/i,b:(e.b*e.a+t.b*t.a*(1-e.a))/i,a:i}}function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a;return{r:(t.r*t.a+e.r*e.a*(1-t.a))/i,g:(t.g*t.a+e.g*e.a*(1-t.a))/i,b:(t.b*t.a+e.b*e.a*(1-t.a))/i,a:i}}function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a,o=t.r*t.a,c=t.g*t.a,l=t.b*t.a;return{r:(n*o+n*(1-t.a)+o*(1-e.a))/i,g:(a*c+a*(1-t.a)+c*(1-e.a))/i,b:(s*l+s*(1-t.a)+l*(1-e.a))/i,a:i}}function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a;return{r:(n+t.r*t.a)/i,g:(a+t.g*t.a)/i,b:(s+t.b*t.a)/i,a:i}}function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a,o=t.r*t.a,c=t.g*t.a,l=t.b*t.a;return{r:(n*t.a+o*e.a-n*o+n*(1-t.a)+o*(1-e.a))/i,g:(a*t.a+c*e.a-a*c+a*(1-t.a)+c*(1-e.a))/i,b:(s*t.a+l*e.a-s*l+s*(1-t.a)+l*(1-e.a))/i,a:i}}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a,o=t.r*t.a,c=t.g*t.a,l=t.b*t.a;return{r:(2*o<=t.a?2*n*o+n*(1-t.a)+o*(1-e.a):n*(1+t.a)+o*(1+e.a)-2*o*n-t.a*e.a)/i,g:(2*c<=t.a?2*a*c+a*(1-t.a)+c*(1-e.a):a*(1+t.a)+c*(1+e.a)-2*c*a-t.a*e.a)/i,b:(2*l<=t.a?2*s*l+s*(1-t.a)+l*(1-e.a):s*(1+t.a)+l*(1+e.a)-2*l*s-t.a*e.a)/i,a:i}}function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a,o=t.r*t.a,c=t.g*t.a,l=t.b*t.a;return{r:(Math.min(n*t.a,o*e.a)+n*(1-t.a)+o*(1-e.a))/i,g:(Math.min(a*t.a,c*e.a)+a*(1-t.a)+c*(1-e.a))/i,b:(Math.min(s*t.a,l*e.a)+s*(1-t.a)+l*(1-e.a))/i,a:i}}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a,o=t.r*t.a,c=t.g*t.a,l=t.b*t.a;return{r:(Math.max(n*t.a,o*e.a)+n*(1-t.a)+o*(1-e.a))/i,g:(Math.max(a*t.a,c*e.a)+a*(1-t.a)+c*(1-e.a))/i,b:(Math.max(s*t.a,l*e.a)+s*(1-t.a)+l*(1-e.a))/i,a:i}}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a,o=t.r*t.a,c=t.g*t.a,l=t.b*t.a;return{r:(2*n<=e.a?2*n*o+n*(1-t.a)+o*(1-e.a):n*(1+t.a)+o*(1+e.a)-2*o*n-t.a*e.a)/i,g:(2*a<=e.a?2*a*c+a*(1-t.a)+c*(1-e.a):a*(1+t.a)+c*(1+e.a)-2*c*a-t.a*e.a)/i,b:(2*s<=e.a?2*s*l+s*(1-t.a)+l*(1-e.a):s*(1+t.a)+l*(1+e.a)-2*l*s-t.a*e.a)/i,a:i}}function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a,o=t.r*t.a,c=t.g*t.a,l=t.b*t.a;return{r:(n+o-2*Math.min(n*t.a,o*e.a))/i,g:(a+c-2*Math.min(a*t.a,c*e.a))/i,b:(s+l-2*Math.min(s*t.a,l*e.a))/i,a:i}}function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.a*=r;var i=t.a+e.a-t.a*e.a,n=e.r*e.a,a=e.g*e.a,s=e.b*e.a,o=t.r*t.a,c=t.g*t.a,l=t.b*t.a;return{r:(n*t.a+o*e.a-2*n*o+n*(1-t.a)+o*(1-e.a))/i,g:(a*t.a+c*e.a-2*a*c+a*(1-t.a)+c*(1-e.a))/i,b:(s*t.a+l*e.a-2*s*l+s*(1-t.a)+l*(1-e.a))/i,a:i}}Object.defineProperty(r,"__esModule",{value:!0}),r.srcOver=i,r.dstOver=n,r.multiply=a,r.add=s,r.screen=o,r.overlay=c,r.darken=l,r.lighten=u,r.hardLight=h,r.difference=f,r.exclusion=d},{}],191:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var n=e("@jimp/utils"),a=i(e("../constants")),s=i(e("./composite-modes"));function o(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0;if("function"==typeof i&&(o=i,i={}),!(e instanceof this.constructor))return n.throwError.call(this,"The source must be a Jimp image",o);if("number"!=typeof t||"number"!=typeof r)return n.throwError.call(this,"x and y must be numbers",o);var c=i,l=c.mode,u=c.opacitySource,h=c.opacityDest;l||(l=a.BLEND_SOURCE_OVER),("number"!=typeof u||u<0||u>1)&&(u=1),("number"!=typeof h||h<0||h>1)&&(h=1);var f=s[l];t=Math.round(t),r=Math.round(r);var d=this;return 1!==h&&d.opacity(h),e.scanQuiet(0,0,e.bitmap.width,e.bitmap.height,(function(e,i,n){var s=d.getPixelIndex(t+e,r+i,a.EDGE_CROP),o=f({r:this.bitmap.data[n+0]/255,g:this.bitmap.data[n+1]/255,b:this.bitmap.data[n+2]/255,a:this.bitmap.data[n+3]/255},{r:d.bitmap.data[s+0]/255,g:d.bitmap.data[s+1]/255,b:d.bitmap.data[s+2]/255,a:d.bitmap.data[s+3]/255},u);d.bitmap.data[s+0]=this.constructor.limit255(255*o.r),d.bitmap.data[s+1]=this.constructor.limit255(255*o.g),d.bitmap.data[s+2]=this.constructor.limit255(255*o.b),d.bitmap.data[s+3]=this.constructor.limit255(255*o.a)})),(0,n.isNodePattern)(o)&&o.call(this,null,this),this}t.exports=r.default},{"../constants":192,"./composite-modes":190,"@babel/runtime/helpers/interopRequireWildcard":12,"@jimp/utils":235}],192:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.EDGE_CROP=r.EDGE_WRAP=r.EDGE_EXTEND=r.BLEND_EXCLUSION=r.BLEND_DIFFERENCE=r.BLEND_HARDLIGHT=r.BLEND_LIGHTEN=r.BLEND_DARKEN=r.BLEND_OVERLAY=r.BLEND_SCREEN=r.BLEND_ADD=r.BLEND_MULTIPLY=r.BLEND_DESTINATION_OVER=r.BLEND_SOURCE_OVER=r.VERTICAL_ALIGN_BOTTOM=r.VERTICAL_ALIGN_MIDDLE=r.VERTICAL_ALIGN_TOP=r.HORIZONTAL_ALIGN_RIGHT=r.HORIZONTAL_ALIGN_CENTER=r.HORIZONTAL_ALIGN_LEFT=r.AUTO=void 0;var i=-1;r.AUTO=i;var n=1;r.HORIZONTAL_ALIGN_LEFT=n;var a=2;r.HORIZONTAL_ALIGN_CENTER=a;var s=4;r.HORIZONTAL_ALIGN_RIGHT=s;var o=8;r.VERTICAL_ALIGN_TOP=o;var c=16;r.VERTICAL_ALIGN_MIDDLE=c;var l=32;r.VERTICAL_ALIGN_BOTTOM=l;var u="srcOver";r.BLEND_SOURCE_OVER=u;var h="dstOver";r.BLEND_DESTINATION_OVER=h;var f="multiply";r.BLEND_MULTIPLY=f;var d="add";r.BLEND_ADD=d;var p="screen";r.BLEND_SCREEN=p;var m="overlay";r.BLEND_OVERLAY=m;var b="darken";r.BLEND_DARKEN=b;var v="lighten";r.BLEND_LIGHTEN=v;var g="hardLight";r.BLEND_HARDLIGHT=g;var y="difference";r.BLEND_DIFFERENCE=y;var _="exclusion";r.BLEND_EXCLUSION=_;var w=1;r.EDGE_EXTEND=w;var x=2;r.EDGE_WRAP=x;var k=3;r.EDGE_CROP=k},{}],193:[function(e,t,r){(function(t){var i=e("@babel/runtime/helpers/interopRequireWildcard"),n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.addConstants=Y,r.addJimpMethods=X,r.jimpEvMethod=V,r.jimpEvChange=q,Object.defineProperty(r,"addType",{enumerable:!0,get:function(){return T.addType}}),r.default=void 0;for(var s=n(e("@babel/runtime/helpers/construct")),o=n(e("@babel/runtime/helpers/slicedToArray")),c=n(e("@babel/runtime/helpers/classCallCheck")),l=n(e("@babel/runtime/helpers/createClass")),u=n(e("@babel/runtime/helpers/possibleConstructorReturn")),h=n(e("@babel/runtime/helpers/getPrototypeOf")),f=n(e("@babel/runtime/helpers/assertThisInitialized")),d=n(e("@babel/runtime/helpers/inherits")),p=n(e("@babel/runtime/helpers/defineProperty")),m=n(e("@babel/runtime/helpers/typeof")),b=n(e("fs")),v=n(e("path")),g=n(e("events")),y=e("@jimp/utils"),_=n(e("any-base")),w=n(e("mkdirp")),x=n(e("pixelmatch")),k=n(e("tinycolor2")),S=n(e("./modules/phash")),C=n(e("./request")),U=n(e("./composite")),E=n(e("./utils/promisify")),T=i(e("./utils/mime")),M=e("./utils/image-bitmap"),O=i(e("./constants")),P="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",A=[NaN,NaN],I=2;I<65;I++){var L=(0,_.default)(_.default.BIN,P.slice(0,I))(new Array(65).join("1"));A.push(L.length)}function j(){}function R(e){return Object.prototype.toString.call(e).toLowerCase().indexOf("arraybuffer")>-1}function D(e){for(var r=t.alloc(e.byteLength),i=new Uint8Array(e),n=0;n<r.length;++n)r[n]=i[n];return r}function B(e,r){(0,C.default)(e,(function(i,n,a){if(i)return r(i);if("headers"in n&&"location"in n.headers)return e.url=n.headers.location,B(e,r);if("object"===(0,m.default)(a)&&t.isBuffer(a))return r(null,a);var s="Could not load Buffer from <"+e.url+"> (HTTP: "+n.statusCode+")";return new Error(s)}))}function F(e,t){b.default&&"function"==typeof b.default.readFile&&!e.match(/^(http|ftp)s?:\/\/./)?b.default.readFile(e,t):B({url:e},t)}function N(e){return e&&"object"===(0,m.default)(e)&&"number"==typeof e.width&&"number"==typeof e.height&&(t.isBuffer(e.data)||e.data instanceof Uint8Array||"function"==typeof Uint8ClampedArray&&e.data instanceof Uint8ClampedArray)&&(e.data.length===e.width*e.height*4||e.data.length===e.width*e.height*3)}function z(e){if(e.length%3!=0)throw new Error("Buffer length is incorrect");for(var r=t.allocUnsafe(e.length/3*4),i=0,n=0;n<e.length;n++)r[i]=e[n],(n+1)%3==0&&(r[++i]=255),i++;return r}var H,G={data:null,width:null,height:null},W=function(e){function r(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];(0,c.default)(this,r),e=(0,u.default)(this,(0,h.default)(r).call(this)),(0,p.default)((0,f.default)(e),"bitmap",G),(0,p.default)((0,f.default)(e),"_background",0),(0,p.default)((0,f.default)(e),"_originalMime",r.MIME_PNG),(0,p.default)((0,f.default)(e),"_exif",null),(0,p.default)((0,f.default)(e),"_rgba",!0),(0,p.default)((0,f.default)(e),"writeAsync",(function(t){return(0,E.default)(e.write,(0,f.default)(e),t)})),(0,p.default)((0,f.default)(e),"getBase64Async",(function(t){return(0,E.default)(e.getBase64,(0,f.default)(e),t)})),(0,p.default)((0,f.default)(e),"getBuffer",M.getBuffer),(0,p.default)((0,f.default)(e),"getBufferAsync",M.getBufferAsync),(0,p.default)((0,f.default)(e),"getPixelColour",e.getPixelColor),(0,p.default)((0,f.default)(e),"setPixelColour",e.setPixelColor);var s=(0,f.default)(e),o=j;function l(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0];(i||{}).methodName="constructor",setTimeout((function(){var e;i&&o===j?s.emitError("constructor",i):i||s.emitMulti("constructor","initialized"),(e=o).call.apply(e,[s].concat(t))}),1)}if(R(n[0])&&(n[0]=D(n[0])),"number"==typeof n[0]&&"number"==typeof n[1]||parseInt(n[0],10)&&parseInt(n[1],10)){var d=parseInt(n[0],10),b=parseInt(n[1],10);if(o=n[2],"number"==typeof n[2]&&(e._background=n[2],o=n[3]),"string"==typeof n[2]&&(e._background=r.cssColorToHex(n[2]),o=n[3]),void 0===o&&(o=j),"function"!=typeof o)return(0,u.default)(e,y.throwError.call((0,f.default)(e),"cb must be a function",l));e.bitmap={data:t.alloc(d*b*4),width:d,height:b};for(var v=0;v<e.bitmap.data.length;v+=4)e.bitmap.data.writeUInt32BE(e._background,v);l(null,(0,f.default)(e))}else if("object"===(0,m.default)(n[0])&&n[0].url){if("function"!=typeof(o=n[1]||j))return(0,u.default)(e,y.throwError.call((0,f.default)(e),"cb must be a function",l));B(n[0],(function(t,r){if(t)return y.throwError.call((0,f.default)(e),t,l);e.parseBitmap(r,n[0].url,l)}))}else if(n[0]instanceof r){var g=n[0];if(void 0===(o=n[1])&&(o=j),"function"!=typeof o)return(0,u.default)(e,y.throwError.call((0,f.default)(e),"cb must be a function",l));e.bitmap={data:t.from(g.bitmap.data),width:g.bitmap.width,height:g.bitmap.height},e._quality=g._quality,e._deflateLevel=g._deflateLevel,e._deflateStrategy=g._deflateStrategy,e._filterType=g._filterType,e._rgba=g._rgba,e._background=g._background,e._originalMime=g._originalMime,l(null,(0,f.default)(e))}else if(N(n[0])){var _=n[0];o=n[1]||j;var w=_.width*_.height*4===_.data.length?t.from(_.data):z(_.data);e.bitmap={data:w,width:_.width,height:_.height},l(null,(0,f.default)(e))}else if("string"==typeof n[0]){var x=n[0];if(void 0===(o=n[1])&&(o=j),"function"!=typeof o)return(0,u.default)(e,y.throwError.call((0,f.default)(e),"cb must be a function",l));F(x,(function(t,r){if(t)return y.throwError.call((0,f.default)(e),t,l);e.parseBitmap(r,x,l)}))}else if("object"===(0,m.default)(n[0])&&t.isBuffer(n[0])){var k=n[0];if("function"!=typeof(o=n[1]))return(0,u.default)(e,y.throwError.call((0,f.default)(e),"cb must be a function",l));e.parseBitmap(k,null,l)}else{"function"!=typeof(o=n[n.length-1])&&"function"!=typeof(o=n[n.length-2])&&(o=j);var S=r.__extraConstructors.find((function(e){return e.test.apply(e,n)}));if(!S)return(0,u.default)(e,y.throwError.call((0,f.default)(e),"No matching constructor overloading was found. Please see the docs for how to call the Jimp constructor.",l));new Promise((function(t,r){var i;return(i=S.run).call.apply(i,[(0,f.default)(e),t,r].concat(n))})).then((function(){return l(null,(0,f.default)(e))})).catch(l)}return e}return(0,d.default)(r,e),(0,l.default)(r,[{key:"parseBitmap",value:function(e,t,r){M.parseBitmap.call(this,e,null,r)}},{key:"rgba",value:function(e,t){return"boolean"!=typeof e?y.throwError.call(this,"bool must be a boolean, true for RGBA or false for RGB",t):(this._rgba=e,(0,y.isNodePattern)(t)&&t.call(this,null,this),this)}},{key:"emitMulti",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=Object.assign(r,{methodName:e,eventName:t}),this.emit("any",r),e&&this.emit(e,r),this.emit(t,r)}},{key:"emitError",value:function(e,t){this.emitMulti(e,"error",t)}},{key:"getHeight",value:function(){return this.bitmap.height}},{key:"getWidth",value:function(){return this.bitmap.width}},{key:"inspect",value:function(){return"<Jimp "+(this.bitmap===G?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}},{key:"toString",value:function(){return"[object Jimp]"}},{key:"getMIME",value:function(){return this._originalMime||r.MIME_PNG}},{key:"getExtension",value:function(){var e=this.getMIME();return T.getExtension(e)}},{key:"write",value:function(e,t){var r=this;if(!b.default||!b.default.createWriteStream)throw new Error("Cant access the filesystem. You can use the getBase64 method.");if("string"!=typeof e)return y.throwError.call(this,"path must be a string",t);if(void 0===t&&(t=j),"function"!=typeof t)return y.throwError.call(this,"cb must be a function",t);var i=T.getType(e)||this.getMIME(),n=v.default.parse(e);return n.dir&&w.default.sync(n.dir),this.getBuffer(i,(function(i,n){if(i)return y.throwError.call(r,i,t);var a=b.default.createWriteStream(e);a.on("open",(function(){a.write(n),a.end()})).on("error",(function(e){return y.throwError.call(r,e,t)})),a.on("finish",(function(){t.call(r,null,r)}))})),this}},{key:"getBase64",value:function(e,t){return e===r.AUTO&&(e=this.getMIME()),"string"!=typeof e?y.throwError.call(this,"mime must be a string",t):"function"!=typeof t?y.throwError.call(this,"cb must be a function",t):(this.getBuffer(e,(function(r,i){if(r)return y.throwError.call(this,r,t);var n="data:"+e+";base64,"+i.toString("base64");t.call(this,null,n)})),this)}},{key:"hash",value:function(e,t){if("function"==typeof(e=e||64)&&(t=e,e=64),"number"!=typeof e)return y.throwError.call(this,"base must be a number",t);if(e<2||e>64)return y.throwError.call(this,"base must be a number between 2 and 64",t);var r=this.pHash();for(r=(0,_.default)(_.default.BIN,P.slice(0,e))(r);r.length<A[e];)r="0"+r;return(0,y.isNodePattern)(t)&&t.call(this,null,r),r}},{key:"pHash",value:function(){var e=new S.default;return e.getHash(this)}},{key:"distanceFromHash",value:function(e){var t=new S.default,r=t.getHash(this);return t.distance(r,e)}},{key:"getPixelIndex",value:function(e,t,i,n){var a,s;if("function"==typeof i&&void 0===n&&(n=i,i=null),i||(i=r.EDGE_EXTEND),"number"!=typeof e||"number"!=typeof t)return y.throwError.call(this,"x and y must be numbers",n);a=e=Math.round(e),s=t=Math.round(t),i===r.EDGE_EXTEND&&(e<0&&(a=0),e>=this.bitmap.width&&(a=this.bitmap.width-1),t<0&&(s=0),t>=this.bitmap.height&&(s=this.bitmap.height-1)),i===r.EDGE_WRAP&&(e<0&&(a=this.bitmap.width+e),e>=this.bitmap.width&&(a=e%this.bitmap.width),t<0&&(a=this.bitmap.height+t),t>=this.bitmap.height&&(s=t%this.bitmap.height));var o=this.bitmap.width*s+a<<2;return(a<0||a>=this.bitmap.width)&&(o=-1),(s<0||s>=this.bitmap.height)&&(o=-1),(0,y.isNodePattern)(n)&&n.call(this,null,o),o}},{key:"getPixelColor",value:function(e,t,r){if("number"!=typeof e||"number"!=typeof t)return y.throwError.call(this,"x and y must be numbers",r);e=Math.round(e),t=Math.round(t);var i=this.getPixelIndex(e,t),n=this.bitmap.data.readUInt32BE(i);return(0,y.isNodePattern)(r)&&r.call(this,null,n),n}},{key:"setPixelColor",value:function(e,t,r,i){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof r)return y.throwError.call(this,"hex, x and y must be numbers",i);t=Math.round(t),r=Math.round(r);var n=this.getPixelIndex(t,r);return this.bitmap.data.writeUInt32BE(e,n),(0,y.isNodePattern)(i)&&i.call(this,null,this),this}},{key:"hasAlpha",value:function(){for(var e=0;e<this.bitmap.height;e++)for(var t=0;t<this.bitmap.width;t++){var r=this.bitmap.width*e+t<<2;if(255!==this.bitmap.data[r+3])return!0}return!1}},{key:"scanIterator",value:function(e,t,r,i){return"number"!=typeof e||"number"!=typeof t?y.throwError.call(this,"x and y must be numbers"):"number"!=typeof r||"number"!=typeof i?y.throwError.call(this,"w and h must be numbers"):(0,y.scanIterator)(this,e,t,r,i)}}]),r}(g.default);function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W;Object.entries(e).forEach((function(e){var r=(0,o.default)(e,2),i=r[0],n=r[1];t[i]=n}))}function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W;Object.entries(e).forEach((function(e){var r=(0,o.default)(e,2),i=r[0],n=r[1];t.prototype[i]=n}))}function V(e,t,r){var i="before-"+t,n=t.replace(/e$/,"")+"ed";W.prototype[e]=function(){for(var t,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];var c,l=s[r.length-1],u=this;"function"==typeof l?(t=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=r[0],s=r[1];a?u.emitError(e,a):u.emitMulti(e,n,(0,p.default)({},e,s)),l.apply(this,r)},s[s.length-1]=t):t=!1,this.emitMulti(e,i);try{c=r.apply(this,s),t||this.emitMulti(e,n,(0,p.default)({},e,c))}catch(h){h.methodName=e,this.emitError(e,h)}return c},W.prototype[e+"Quiet"]=r}function q(e,t){V(e,"change",t)}Y(O),X({composite:U.default}),W.__extraConstructors=[],W.appendConstructorOption=function(e,t,r){W.__extraConstructors.push({name:e,test:t,run:r})},W.read=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Promise((function(e,r){(0,s.default)(W,t.concat([function(t,i){t?r(t):e(i)}]))}))},W.create=W.read,W.rgbaToInt=function(e,t,r,i,n){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof r||"number"!=typeof i)return y.throwError.call(this,"r, g, b and a must be numbers",n);if(e<0||e>255)return y.throwError.call(this,"r must be between 0 and 255",n);if((t<0||t>255)&&y.throwError.call(this,"g must be between 0 and 255",n),r<0||r>255)return y.throwError.call(this,"b must be between 0 and 255",n);if(i<0||i>255)return y.throwError.call(this,"a must be between 0 and 255",n);e=Math.round(e),r=Math.round(r),t=Math.round(t),i=Math.round(i);var a=e*Math.pow(256,3)+t*Math.pow(256,2)+r*Math.pow(256,1)+i*Math.pow(256,0);return(0,y.isNodePattern)(n)&&n.call(this,null,a),a},W.intToRGBA=function(e,t){if("number"!=typeof e)return y.throwError.call(this,"i must be a number",t);var r={};return r.r=Math.floor(e/Math.pow(256,3)),r.g=Math.floor((e-r.r*Math.pow(256,3))/Math.pow(256,2)),r.b=Math.floor((e-r.r*Math.pow(256,3)-r.g*Math.pow(256,2))/Math.pow(256,1)),r.a=Math.floor((e-r.r*Math.pow(256,3)-r.g*Math.pow(256,2)-r.b*Math.pow(256,1))/Math.pow(256,0)),(0,y.isNodePattern)(t)&&t.call(this,null,r),r},W.cssColorToHex=function(e){return"number"==typeof(e=e||0)?Number(e):parseInt((0,k.default)(e).toHex8(),16)},W.limit255=function(e){return e=Math.max(e,0),e=Math.min(e,255)},W.diff=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;if(!(e instanceof W&&t instanceof W))return y.throwError.call(this,"img1 and img2 must be an Jimp images");var i=e.bitmap,n=t.bitmap;if(i.width===n.width&&i.height===n.height||(i.width*i.height>n.width*n.height?e=e.cloneQuiet().resize(n.width,n.height):t=t.cloneQuiet().resize(i.width,i.height)),"number"!=typeof r||r<0||r>1)return y.throwError.call(this,"threshold must be a number between 0 and 1");var a=new W(i.width,i.height,4294967295);return{percent:(0,x.default)(i.data,n.data,a.bitmap.data,a.bitmap.width,a.bitmap.height,{threshold:r})/(a.bitmap.width*a.bitmap.height),image:a}},W.distance=function(e,t){var r=new S.default,i=r.getHash(e),n=r.getHash(t);return r.distance(i,n)},W.compareHashes=function(e,t){return(new S.default).distance(e,t)},W.colorDiff=function(e,t){var r=function(e){return Math.pow(e,2)},i=Math.max,n=195075;return 0===e.a||e.a||(e.a=255),0===t.a||t.a||(t.a=255),(i(r(e.r-t.r),r(e.r-t.r-e.a+t.a))+i(r(e.g-t.g),r(e.g-t.g-e.a+t.a))+i(r(e.b-t.b),r(e.b-t.b-e.a+t.a)))/n},V("clone","clone",(function(e){var t=new W(this);return(0,y.isNodePattern)(e)&&e.call(t,null,t),t})),q("background",(function(e,t){return"number"!=typeof e?y.throwError.call(this,"hex must be a hexadecimal rgba value",t):(this._background=e,(0,y.isNodePattern)(t)&&t.call(this,null,this),this)})),q("scan",(function(e,t,r,i,n,a){if("number"!=typeof e||"number"!=typeof t)return y.throwError.call(this,"x and y must be numbers",a);if("number"!=typeof r||"number"!=typeof i)return y.throwError.call(this,"w and h must be numbers",a);if("function"!=typeof n)return y.throwError.call(this,"f must be a function",a);var s=(0,y.scan)(this,e,t,r,i,n);return(0,y.isNodePattern)(a)&&a.call(this,null,s),s})),void 0!==a&&"object"===(void 0===a?"undefined":(0,m.default)(a))&&(H=a),"undefined"!=typeof self&&"object"===("undefined"==typeof self?"undefined":(0,m.default)(self))&&(H=self),H.Jimp=W,H.Buffer=t;var Z=W;r.default=Z}).call(this,e("buffer").Buffer)},{"./composite":191,"./constants":192,"./modules/phash":194,"./request":195,"./utils/image-bitmap":196,"./utils/mime":197,"./utils/promisify":198,"@babel/runtime/helpers/assertThisInitialized":3,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/construct":5,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/getPrototypeOf":9,"@babel/runtime/helpers/inherits":10,"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/interopRequireWildcard":12,"@babel/runtime/helpers/possibleConstructorReturn":17,"@babel/runtime/helpers/slicedToArray":19,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235,"any-base":23,buffer:48,events:52,fs:47,mkdirp:83,path:107,pixelmatch:109,tinycolor2:178}],194:[function(e,t,r){function i(e,t){this.size=this.size||e,this.smallerSize=this.smallerSize||t,s(this.size)}function n(e){var t={};return t.r=Math.floor(e/Math.pow(256,3)),t.g=Math.floor((e-t.r*Math.pow(256,3))/Math.pow(256,2)),t.b=Math.floor((e-t.r*Math.pow(256,3)-t.g*Math.pow(256,2))/Math.pow(256,1)),t.a=Math.floor((e-t.r*Math.pow(256,3)-t.g*Math.pow(256,2)-t.b*Math.pow(256,1))/Math.pow(256,0)),t}i.prototype.size=32,i.prototype.smallerSize=8,i.prototype.distance=function(e,t){for(var r=0,i=0;i<e.length;i++)e[i]!==t[i]&&r++;return r/e.length},i.prototype.getHash=function(e){(e=e.clone().resize(this.size,this.size)).grayscale();for(var t=[],r=0;r<e.bitmap.width;r++){t[r]=[];for(var i=0;i<e.bitmap.height;i++)t[r][i]=n(e.getPixelColor(r,i)).b}for(var a=o(t,this.size),s=0,c=0;c<this.smallerSize;c++)for(var l=0;l<this.smallerSize;l++)s+=a[c][l];for(var u=s/(this.smallerSize*this.smallerSize),h="",f=0;f<this.smallerSize;f++)for(var d=0;d<this.smallerSize;d++)h+=a[f][d]>u?"1":"0";return h};var a=[];function s(e){for(var t=1;t<e;t++)a[t]=1;a[0]=1/Math.sqrt(2)}function o(e,t){for(var r=t,i=[],n=0;n<r;n++){i[n]=[];for(var s=0;s<r;s++){for(var o=0,c=0;c<r;c++)for(var l=0;l<r;l++)o+=Math.cos((2*c+1)/(2*r)*n*Math.PI)*Math.cos((2*l+1)/(2*r)*s*Math.PI)*e[c][l];o*=a[n]*a[s]/4,i[n][s]=o}}return i}t.exports=i},{}],195:[function(e,t,r){(function(r,i){var n=e("@babel/runtime/helpers/interopRequireDefault");n(e("@babel/runtime/helpers/defineProperty")),n(e("@babel/runtime/helpers/extends")),r.browser,t.exports=function(e,t){var r=new XMLHttpRequest;r.open("GET",e.url,!0),r.responseType="arraybuffer",r.addEventListener("load",(function(){if(r.status<400)try{var n=i.from(this.response);t(null,r,n)}catch(a){return t(new Error("Response is not a buffer for url "+e.url+". Error: "+a.message))}else t(new Error("HTTP Status "+r.status+" for url "+e.url))})),r.addEventListener("error",(function(e){t(e)})),r.send()}}).call(this,e("_process"),e("buffer").Buffer)},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/extends":8,"@babel/runtime/helpers/interopRequireDefault":11,_process:133,buffer:48,phin:108}],196:[function(e,t,r){(function(t){var i=e("@babel/runtime/helpers/interopRequireWildcard"),n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.parseBitmap=v,r.getBuffer=y,r.getBufferAsync=_;var a=n(e("@babel/runtime/helpers/slicedToArray")),s=n(e("file-type")),o=n(e("exif-parser")),c=e("@jimp/utils"),l=i(e("../constants")),u=i(e("./mime")),h=n(e("./promisify"));function f(e,t){var r=(0,s.default)(e);return r?r.mime:t?u.getType(t):null}function d(e){return e._exif&&e._exif.tags&&e._exif.tags.Orientation||1}function p(e){var t=e.getWidth(),r=e.getHeight();switch(d(e)){case 1:default:return null;case 2:return function(e,r){return[t-e-1,r]};case 3:return function(e,i){return[t-e-1,r-i-1]};case 4:return function(e,t){return[e,r-t-1]};case 5:return function(e,t){return[t,e]};case 6:return function(e,t){return[t,r-e-1]};case 7:return function(e,i){return[t-i-1,r-e-1]};case 8:return function(e,r){return[t-r-1,e]}}}function m(e,r,i,n){for(var s=e.bitmap.data,o=e.bitmap.width,c=t.alloc(s.length),l=0;l<r;l++)for(var u=0;u<i;u++){var h=n(l,u),f=(0,a.default)(h,2),d=f[0],p=r*u+l<<2,m=o*f[1]+d<<2,b=s.readUInt32BE(m);c.writeUInt32BE(b,p)}e.bitmap.data=c,e.bitmap.width=r,e.bitmap.height=i}function b(e){if(!(d(e)<2)){var t=p(e),r=d(e)>4;m(e,r?e.bitmap.height:e.bitmap.width,r?e.bitmap.width:e.bitmap.height,t)}}function v(e,t,r){var i=f(e,t);if("string"!=typeof i)return r(new Error("Could not find MIME for Buffer <"+t+">"));this._originalMime=i.toLowerCase();try{var n=this.getMIME();if(!this.constructor.decoders[n])return c.throwError.call(this,"Unsupported MIME type: "+n,r);this.bitmap=this.constructor.decoders[n](e)}catch(a){return r.call(this,a,this)}try{this._exif=o.default.create(e).parse(),b(this)}catch(a){}return r.call(this,null,this),this}function g(e,t){return new e(t.bitmap.width,t.bitmap.height,t._background).composite(t,0,0).bitmap}function y(e,r){if(e===l.AUTO&&(e=this.getMIME()),"string"!=typeof e)return c.throwError.call(this,"mime must be a string",r);if("function"!=typeof r)return c.throwError.call(this,"cb must be a function",r);if(e=e.toLowerCase(),this._rgba&&this.constructor.hasAlpha[e]?this.bitmap.data=t.from(this.bitmap.data):this.bitmap.data=g(this.constructor,this).data,this.constructor.encoders[e]){var i=this.constructor.encoders[e](this);r.call(this,null,i)}else r.call(this,"Unsupported MIME type: "+e);return this}function _(e){return(0,h.default)(y,this,e)}}).call(this,e("buffer").Buffer)},{"../constants":192,"./mime":197,"./promisify":198,"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/interopRequireWildcard":12,"@babel/runtime/helpers/slicedToArray":19,"@jimp/utils":235,buffer:48,"exif-parser":53,"file-type":62}],197:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getExtension=r.getType=r.addType=void 0;var i={},n=function(e){return Object.entries(i).find((function(t){return t[1].includes(e)}))||[]},a=function(e,t){i[e]=t};r.addType=a;var s=function(e){var t=e.split("/").slice(-1),r=t[t.length-1].split(".").pop();return n(r)[0]};r.getType=s;var o=function(e){return(i[e.toLowerCase()]||[])[0]};r.getExtension=o},{}],198:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];return new Promise((function(r,n){i.push((function(e,t){e&&n(e),r(t)})),e.bind(t).apply(void 0,i)}))},n=i;r.default=n,t.exports=r.default},{}],199:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireWildcard"),n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=h;var a=n(e("@babel/runtime/helpers/toConsumableArray")),s=n(e("@babel/runtime/helpers/defineProperty")),o=n(e("@babel/runtime/helpers/slicedToArray")),c=i(e("@jimp/core"));function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(r,!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.default,r={hasAlpha:{},encoders:{},decoders:{},class:{},constants:{}};function i(e){Object.entries(e).forEach((function(e){var t=(0,o.default)(e,2),i=t[0],n=t[1];r[i]=u({},r[i],{},n)}))}function n(e){var t=e();Array.isArray(t.mime)?c.addType.apply(void 0,(0,a.default)(t.mime)):Object.entries(t.mime).forEach((function(e){return c.addType.apply(void 0,(0,a.default)(e))})),delete t.mime,i(t)}function s(e){var t=e(c.jimpEvChange)||{};t.class||t.constants?i(t):i({class:t})}return e.types&&(e.types.forEach(n),t.decoders=u({},t.decoders,{},r.decoders),t.encoders=u({},t.encoders,{},r.encoders),t.hasAlpha=u({},t.hasAlpha,{},r.hasAlpha)),e.plugins&&e.plugins.forEach(s),(0,c.addJimpMethods)(r.class,t),(0,c.addConstants)(r.constants,t),c.default}t.exports=r.default},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/interopRequireWildcard":12,"@babel/runtime/helpers/slicedToArray":19,"@babel/runtime/helpers/toConsumableArray":20,"@jimp/core":193}],200:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@jimp/custom")),a=i(e("@jimp/types")),s=i(e("@jimp/plugins")),o=(0,n.default)({types:[a.default],plugins:[s.default]});r.default=o,t.exports=r.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/custom":199,"@jimp/plugins":228,"@jimp/types":234}],201:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/typeof")),a=e("@jimp/utils"),s=function(){return{blit:function(e,t,r,i,s,o,c,l){if(!(e instanceof this.constructor))return a.throwError.call(this,"The source must be a Jimp image",l);if("number"!=typeof t||"number"!=typeof r)return a.throwError.call(this,"x and y must be numbers",l);if("function"==typeof i)l=i,i=0,s=0,o=e.bitmap.width,c=e.bitmap.height;else{if((0,n.default)(i)!==(0,n.default)(s)||(0,n.default)(s)!==(0,n.default)(o)||(0,n.default)(o)!==(0,n.default)(c))return a.throwError.call(this,"srcx, srcy, srcw, srch must be numbers",l);i=i||0,s=s||0,o=o||e.bitmap.width,c=c||e.bitmap.height}t=Math.round(t),r=Math.round(r),i=Math.round(i),s=Math.round(s),o=Math.round(o),c=Math.round(c);var u=this.bitmap.width,h=this.bitmap.height,f=this;return e.scanQuiet(i,s,o,c,(function(e,n,a){var o=t+e-i,c=r+n-s;if(o>=0&&c>=0&&u-o>0&&h-c>0){var l=f.getPixelIndex(o,c),d={r:this.bitmap.data[a],g:this.bitmap.data[a+1],b:this.bitmap.data[a+2],a:this.bitmap.data[a+3]},p={r:f.bitmap.data[l],g:f.bitmap.data[l+1],b:f.bitmap.data[l+2],a:f.bitmap.data[l+3]};f.bitmap.data[l]=(d.a*(d.r-p.r)-p.r+255>>8)+p.r,f.bitmap.data[l+1]=(d.a*(d.g-p.g)-p.g+255>>8)+p.g,f.bitmap.data[l+2]=(d.a*(d.b-p.b)-p.b+255>>8)+p.b,f.bitmap.data[l+3]=this.constructor.limit255(p.a+d.a)}})),(0,a.isNodePattern)(l)&&l.call(this,null,this),this}}};r.default=s,t.exports=r.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235}],202:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.shgTable=r.mulTable=void 0;var i=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1];r.mulTable=i;var n=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18];r.shgTable=n},{}],203:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=e("./blur-tables"),a=function(){return{blur:function(e,t){if("number"!=typeof e)return i.throwError.call(this,"r must be a number",t);if(e<1)return i.throwError.call(this,"r must be greater than 0",t);for(var r,a,s,o,c,l,u,h,f,d,p,m,b,v,g=this.bitmap.width-1,y=this.bitmap.height-1,_=e+1,w=n.mulTable[e],x=n.shgTable[e],k=[],S=[],C=[],U=[],E=[],T=[],M=2;M-- >0;){for(m=0,b=0,l=0;l<this.bitmap.height;l++){for(r=this.bitmap.data[b]*_,a=this.bitmap.data[b+1]*_,s=this.bitmap.data[b+2]*_,o=this.bitmap.data[b+3]*_,u=1;u<=e;u++)h=b+((u>g?g:u)<<2),r+=this.bitmap.data[h++],a+=this.bitmap.data[h++],s+=this.bitmap.data[h++],o+=this.bitmap.data[h];for(c=0;c<this.bitmap.width;c++)k[m]=r,S[m]=a,C[m]=s,U[m]=o,0===l&&(E[c]=((h=c+_)<g?h:g)<<2,T[c]=(h=c-e)>0?h<<2:0),f=b+E[c],d=b+T[c],r+=this.bitmap.data[f++]-this.bitmap.data[d++],a+=this.bitmap.data[f++]-this.bitmap.data[d++],s+=this.bitmap.data[f++]-this.bitmap.data[d++],o+=this.bitmap.data[f]-this.bitmap.data[d],m++;b+=this.bitmap.width<<2}for(c=0;c<this.bitmap.width;c++){for(r=k[p=c]*_,a=S[p]*_,s=C[p]*_,o=U[p]*_,u=1;u<=e;u++)r+=k[p+=u>y?0:this.bitmap.width],a+=S[p],s+=C[p],o+=U[p];for(m=c<<2,l=0;l<this.bitmap.height;l++)v=o*w>>>x,this.bitmap.data[m+3]=v,v>255&&(this.bitmap.data[m+3]=255),v>0?(v=255/v,this.bitmap.data[m]=(r*w>>>x)*v,this.bitmap.data[m+1]=(a*w>>>x)*v,this.bitmap.data[m+2]=(s*w>>>x)*v):(this.bitmap.data[m+2]=0,this.bitmap.data[m+1]=0,this.bitmap.data[m]=0),0===c&&(E[l]=((h=l+_)<y?h:y)*this.bitmap.width,T[l]=(h=l-e)>0?h*this.bitmap.width:0),f=c+E[l],d=c+T[l],r+=k[f]-k[d],a+=S[f]-S[d],s+=C[f]-C[d],o+=U[f]-U[d],m+=this.bitmap.width<<2}}return(0,i.isNodePattern)(t)&&t.call(this,null,this),this}}};r.default=a,t.exports=r.default},{"./blur-tables":202,"@jimp/utils":235}],204:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{circle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;"function"==typeof e&&(t=e,e={});var r=e.radius||(this.bitmap.width>this.bitmap.height?this.bitmap.height:this.bitmap.width)/2,n={x:"number"==typeof e.x?e.x:this.bitmap.width/2,y:"number"==typeof e.y?e.y:this.bitmap.height/2};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,i){var a=Math.sqrt(Math.pow(e-n.x,2)+Math.pow(t-n.y,2));r-a<=0?this.bitmap.data[i+3]=0:r-a<1&&(this.bitmap.data[i+3]=255*(r-a))})),(0,i.isNodePattern)(t)&&t.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],205:[function(e,t,r){(function(i){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/toConsumableArray")),s=n(e("tinycolor2")),o=e("@jimp/utils");function c(e,t,r,i){for(var n=[0,0,0],a=(t.length-1)/2,s=0;s<t.length;s+=1)for(var o=0;o<t[s].length;o+=1){var c=e.getPixelIndex(r+s-a,i+o-a);n[0]+=e.bitmap.data[c]*t[s][o],n[1]+=e.bitmap.data[c+1]*t[s][o],n[2]+=e.bitmap.data[c+2]*t[s][o]}return n}var l=function(e){return null!=e};function u(e){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,r){var i=parseInt(.2126*this.bitmap.data[r]+.7152*this.bitmap.data[r+1]+.0722*this.bitmap.data[r+2],10);this.bitmap.data[r]=i,this.bitmap.data[r+1]=i,this.bitmap.data[r+2]=i})),(0,o.isNodePattern)(e)&&e.call(this,null,this),this}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;return{r:(t.r-e.r)*(r/100)+e.r,g:(t.g-e.g)*(r/100)+e.g,b:(t.b-e.b)*(r/100)+e.b}}function f(e,t){var r=this;return e&&Array.isArray(e)?(e=e.map((function(e){return"xor"!==e.apply&&"mix"!==e.apply||(e.params[0]=(0,s.default)(e.params[0]).toRgb()),e})),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(i,n,c){var l={r:r.bitmap.data[c],g:r.bitmap.data[c+1],b:r.bitmap.data[c+2]},u=function(e,t){return r.constructor.limit255(l[e]+t)};e.forEach((function(e){if("mix"===e.apply)l=h(l,e.params[0],e.params[1]);else if("tint"===e.apply)l=h(l,{r:255,g:255,b:255},e.params[0]);else if("shade"===e.apply)l=h(l,{r:0,g:0,b:0},e.params[0]);else if("xor"===e.apply)l={r:l.r^e.params[0].r,g:l.g^e.params[0].g,b:l.b^e.params[0].b};else if("red"===e.apply)l.r=u("r",e.params[0]);else if("green"===e.apply)l.g=u("g",e.params[0]);else if("blue"===e.apply)l.b=u("b",e.params[0]);else{var i;if("hue"===e.apply&&(e.apply="spin"),!(l=(0,s.default)(l))[e.apply])return o.throwError.call(r,"action "+e.apply+" not supported",t);l=(i=l)[e.apply].apply(i,(0,a.default)(e.params)).toRgb()}})),r.bitmap.data[c]=l.r,r.bitmap.data[c+1]=l.g,r.bitmap.data[c+2]=l.b})),(0,o.isNodePattern)(t)&&t.call(this,null,this),this):o.throwError.call(this,"actions must be an array",t)}var d=function(){return{brightness:function(e,t){return"number"!=typeof e?o.throwError.call(this,"val must be numbers",t):e<-1||e>1?o.throwError.call(this,"val must be a number between -1 and +1",t):(this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,r,i){e<0?(this.bitmap.data[i]=this.bitmap.data[i]*(1+e),this.bitmap.data[i+1]=this.bitmap.data[i+1]*(1+e),this.bitmap.data[i+2]=this.bitmap.data[i+2]*(1+e)):(this.bitmap.data[i]=this.bitmap.data[i]+(255-this.bitmap.data[i])*e,this.bitmap.data[i+1]=this.bitmap.data[i+1]+(255-this.bitmap.data[i+1])*e,this.bitmap.data[i+2]=this.bitmap.data[i+2]+(255-this.bitmap.data[i+2])*e)})),(0,o.isNodePattern)(t)&&t.call(this,null,this),this)},contrast:function(e,t){if("number"!=typeof e)return o.throwError.call(this,"val must be numbers",t);if(e<-1||e>1)return o.throwError.call(this,"val must be a number between -1 and +1",t);var r=(e+1)/(1-e);function i(e){return(e=Math.floor(r*(e-127)+127))<0?0:e>255?255:e}return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,r){this.bitmap.data[r]=i(this.bitmap.data[r]),this.bitmap.data[r+1]=i(this.bitmap.data[r+1]),this.bitmap.data[r+2]=i(this.bitmap.data[r+2])})),(0,o.isNodePattern)(t)&&t.call(this,null,this),this},posterize:function(e,t){return"number"!=typeof e?o.throwError.call(this,"n must be numbers",t):(e<2&&(e=2),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,r,i){this.bitmap.data[i]=Math.floor(this.bitmap.data[i]/255*(e-1))/(e-1)*255,this.bitmap.data[i+1]=Math.floor(this.bitmap.data[i+1]/255*(e-1))/(e-1)*255,this.bitmap.data[i+2]=Math.floor(this.bitmap.data[i+2]/255*(e-1))/(e-1)*255})),(0,o.isNodePattern)(t)&&t.call(this,null,this),this)},greyscale:u,grayscale:u,opacity:function(e,t){return"number"!=typeof e?o.throwError.call(this,"f must be a number",t):e<0||e>1?o.throwError.call(this,"f must be a number from 0 to 1",t):(this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,r,i){var n=this.bitmap.data[i+3]*e;this.bitmap.data[i+3]=n})),(0,o.isNodePattern)(t)&&t.call(this,null,this),this)},sepia:function(e){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,r){var i=this.bitmap.data[r],n=this.bitmap.data[r+1],a=this.bitmap.data[r+2];a=.272*(i=.393*i+.769*n+.189*a)+.534*(n=.349*i+.686*n+.168*a)+.131*a,this.bitmap.data[r]=i<255?i:255,this.bitmap.data[r+1]=n<255?n:255,this.bitmap.data[r+2]=a<255?a:255})),(0,o.isNodePattern)(e)&&e.call(this,null,this),this},fade:function(e,t){return"number"!=typeof e?o.throwError.call(this,"f must be a number",t):e<0||e>1?o.throwError.call(this,"f must be a number from 0 to 1",t):(this.opacity(1-e),(0,o.isNodePattern)(t)&&t.call(this,null,this),this)},convolution:function(e,t,r){"function"==typeof t&&void 0===r&&(r=t,t=null),t||(t=this.constructor.EDGE_EXTEND);var n,a,s,c,l,u,h,f,d,p,m=i.from(this.bitmap.data),b=e.length,v=e[0].length,g=Math.floor(b/2),y=Math.floor(v/2),_=-g,w=-y;return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(r,i,o){c=0,s=0,a=0;for(var b=_;b<=g;b++)for(var v=w;v<=y;v++)f=r+v,d=i+b,n=e[b+g][v+y],-1===(p=this.getPixelIndex(f,d,t))?(h=0,u=0,l=0):(l=this.bitmap.data[p+0],u=this.bitmap.data[p+1],h=this.bitmap.data[p+2]),a+=n*l,s+=n*u,c+=n*h;a<0&&(a=0),s<0&&(s=0),c<0&&(c=0),a>255&&(a=255),s>255&&(s=255),c>255&&(c=255),m[o+0]=a,m[o+1]=s,m[o+2]=c})),this.bitmap.data=m,(0,o.isNodePattern)(r)&&r.call(this,null,this),this},opaque:function(e){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,r){this.bitmap.data[r+3]=255})),(0,o.isNodePattern)(e)&&e.call(this,null,this),this},pixelate:function(e,t,r,i,n,a){if("function"==typeof t)a=t,n=null,i=null,r=null,t=null;else{if("number"!=typeof e)return o.throwError.call(this,"size must be a number",a);if(l(t)&&"number"!=typeof t)return o.throwError.call(this,"x must be a number",a);if(l(r)&&"number"!=typeof r)return o.throwError.call(this,"y must be a number",a);if(l(i)&&"number"!=typeof i)return o.throwError.call(this,"w must be a number",a);if(l(n)&&"number"!=typeof n)return o.throwError.call(this,"h must be a number",a)}var s=[[1/16,2/16,1/16],[2/16,.25,2/16],[1/16,2/16,1/16]];t=t||0,r=r||0,i=l(i)?i:this.bitmap.width-t,n=l(n)?n:this.bitmap.height-r;var u=this.cloneQuiet();return this.scanQuiet(t,r,i,n,(function(t,r,i){t=e*Math.floor(t/e),r=e*Math.floor(r/e);var n=c(u,s,t,r);this.bitmap.data[i]=n[0],this.bitmap.data[i+1]=n[1],this.bitmap.data[i+2]=n[2]})),(0,o.isNodePattern)(a)&&a.call(this,null,this),this},convolute:function(e,t,r,i,n,a){if(!Array.isArray(e))return o.throwError.call(this,"the kernel must be an array",a);if("function"==typeof t)a=t,t=null,r=null,i=null,n=null;else{if(l(t)&&"number"!=typeof t)return o.throwError.call(this,"x must be a number",a);if(l(r)&&"number"!=typeof r)return o.throwError.call(this,"y must be a number",a);if(l(i)&&"number"!=typeof i)return o.throwError.call(this,"w must be a number",a);if(l(n)&&"number"!=typeof n)return o.throwError.call(this,"h must be a number",a)}var s=(e.length-1)/2;t=l(t)?t:s,r=l(r)?r:s,i=l(i)?i:this.bitmap.width-t,n=l(n)?n:this.bitmap.height-r;var u=this.cloneQuiet();return this.scanQuiet(t,r,i,n,(function(t,r,i){var n=c(u,e,t,r);this.bitmap.data[i]=this.constructor.limit255(n[0]),this.bitmap.data[i+1]=this.constructor.limit255(n[1]),this.bitmap.data[i+2]=this.constructor.limit255(n[2])})),(0,o.isNodePattern)(a)&&a.call(this,null,this),this},color:f,colour:f}};r.default=d,t.exports=r.default}).call(this,e("buffer").Buffer)},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/toConsumableArray":20,"@jimp/utils":235,buffer:48,tinycolor2:178}],206:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{contain:function(e,t,r,n,a){if("number"!=typeof e||"number"!=typeof t)return i.throwError.call(this,"w and h must be numbers",a);"string"==typeof r&&("function"==typeof n&&void 0===a&&(a=n),n=r,r=null),"function"==typeof r&&(void 0===a&&(a=r),n=null,r=null),"function"==typeof n&&void 0===a&&(a=n,n=null);var s=7&(r=r||this.constructor.HORIZONTAL_ALIGN_CENTER|this.constructor.VERTICAL_ALIGN_MIDDLE),o=r>>3;if((0===s||s&s-1)&&(0===o||o&o-1))return i.throwError.call(this,"only use one flag per alignment direction",a);var c=s>>1,l=o>>1,u=e/t>this.bitmap.width/this.bitmap.height?t/this.bitmap.height:e/this.bitmap.width,h=this.cloneQuiet().scale(u,n);return this.resize(e,t,n),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,r){this.bitmap.data.writeUInt32BE(this._background,r)})),this.blit(h,(this.bitmap.width-h.bitmap.width)/2*c,(this.bitmap.height-h.bitmap.height)/2*l),(0,i.isNodePattern)(a)&&a.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],207:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{cover:function(e,t,r,n,a){if("number"!=typeof e||"number"!=typeof t)return i.throwError.call(this,"w and h must be numbers",a);r&&"function"==typeof r&&void 0===a?(a=r,r=null,n=null):"function"==typeof n&&void 0===a&&(a=n,n=null);var s=7&(r=r||this.constructor.HORIZONTAL_ALIGN_CENTER|this.constructor.VERTICAL_ALIGN_MIDDLE),o=r>>3;if((0===s||s&s-1)&&(0===o||o&o-1))return i.throwError.call(this,"only use one flag per alignment direction",a);var c=s>>1,l=o>>1,u=e/t>this.bitmap.width/this.bitmap.height?e/this.bitmap.width:t/this.bitmap.height;return this.scale(u,n),this.crop((this.bitmap.width-e)/2*c,(this.bitmap.height-t)/2*l,e,t),(0,i.isNodePattern)(a)&&a.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],208:[function(e,t,r){(function(i){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=n(e("@babel/runtime/helpers/typeof")),s=e("@jimp/utils");function o(e){return e("crop",(function(e,t,r,n,a){if("number"!=typeof e||"number"!=typeof t)return s.throwError.call(this,"x and y must be numbers",a);if("number"!=typeof r||"number"!=typeof n)return s.throwError.call(this,"w and h must be numbers",a);if(e=Math.round(e),t=Math.round(t),r=Math.round(r),n=Math.round(n),0===e&&r===this.bitmap.width){var o=r*t+e<<2,c=o+n*r<<2;this.bitmap.data=this.bitmap.data.slice(o,c)}else{var l=i.allocUnsafe(r*n*4),u=0;this.scanQuiet(e,t,r,n,(function(e,t,r){var i=this.bitmap.data.readUInt32BE(r,!0);l.writeUInt32BE(i,u,!0),u+=4})),this.bitmap.data=l}return this.bitmap.width=r,this.bitmap.height=n,(0,s.isNodePattern)(a)&&a.call(this,null,this),this})),{class:{autocrop:function(){for(var e,t=this.bitmap.width,r=this.bitmap.height,i=1,n=0,o=2e-4,c=!0,l=!1,u=arguments.length,h=new Array(u),f=0;f<u;f++)h[f]=arguments[f];for(var d=0,p=h.length;d<p;d++)if("number"==typeof h[d]&&(o=h[d]),"boolean"==typeof h[d]&&(c=h[d]),"function"==typeof h[d]&&(e=h[d]),"object"===(0,a.default)(h[d])){var m=h[d];void 0!==m.tolerance&&(o=m.tolerance),void 0!==m.cropOnlyFrames&&(c=m.cropOnlyFrames),void 0!==m.cropSymmetric&&(l=m.cropSymmetric),void 0!==m.leaveBorder&&(n=m.leaveBorder)}var b=this.getPixelColor(0,0),v=this.constructor.intToRGBA(b),g=0,y=0,_=0,w=0;b=this.getPixelColor(0,0);e:for(var x=0;x<r-i;x++){for(var k=0;k<t;k++){var S=this.getPixelColor(k,x),C=this.constructor.intToRGBA(S);if(this.constructor.colorDiff(v,C)>o)break e}g++}b=this.getPixelColor(t,0);e:for(var U=0;U<t-i;U++){for(var E=0+g;E<r;E++){var T=this.getPixelColor(U,E),M=this.constructor.intToRGBA(T);if(this.constructor.colorDiff(v,M)>o)break e}y++}b=this.getPixelColor(0,r);e:for(var O=r-1;O>=g+i;O--){for(var P=t-y-1;P>=0;P--){var A=this.getPixelColor(P,O),I=this.constructor.intToRGBA(A);if(this.constructor.colorDiff(v,I)>o)break e}_++}b=this.getPixelColor(t,r);e:for(var L=t-1;L>=0+y+i;L--){for(var j=r-1;j>=0+g;j--){var R=this.getPixelColor(L,j),D=this.constructor.intToRGBA(R);if(this.constructor.colorDiff(v,D)>o)break e}w++}if(w-=n,y-=n,g-=n,_-=n,l){var B=Math.min(y,w),F=Math.min(g,_);w=B,y=B,g=F,_=F}var N=t-((w=w>=0?w:0)+(y=y>=0?y:0)),z=r-((_=_>=0?_:0)+(g=g>=0?g:0));return(c?0!==y&&0!==g&&0!==w&&0!==_:0!==y||0!==g||0!==w||0!==_)&&this.crop(y,g,N,z),(0,s.isNodePattern)(e)&&e.call(this,null,this),this}}}}t.exports=r.default}).call(this,e("buffer").Buffer)},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235,buffer:48}],209:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/typeof")),a=e("@jimp/utils"),s=function(){return{displace:function(e,t,r){if("object"!==(0,n.default)(e)||e.constructor!==this.constructor)return a.throwError.call(this,"The source must be a Jimp image",r);if("number"!=typeof t)return a.throwError.call(this,"factor must be a number",r);var i=this.cloneQuiet();return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(r,n,a){var s=e.bitmap.data[a]/256*t;s=Math.round(s);var o=this.getPixelIndex(r+s,n);this.bitmap.data[o]=i.bitmap.data[a],this.bitmap.data[o+1]=i.bitmap.data[a+1],this.bitmap.data[o+2]=i.bitmap.data[a+2]})),(0,a.isNodePattern)(r)&&r.call(this,null,this),this}}};r.default=s,t.exports=r.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235}],210:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils");function n(e){var t=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,r,i){var n=t[((3&r)<<2)+e%4];this.bitmap.data[i]=Math.min(this.bitmap.data[i]+n,255),this.bitmap.data[i+1]=Math.min(this.bitmap.data[i+1]+n,255),this.bitmap.data[i+2]=Math.min(this.bitmap.data[i+2]+n,255)})),(0,i.isNodePattern)(e)&&e.call(this,null,this),this}var a=function(){return{dither565:n,dither16:n}};r.default=a,t.exports=r.default},{"@jimp/utils":235}],211:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{fisheye:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{r:2.5},r=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(r=t,t={r:2.5});var n=this.cloneQuiet(),a=n.bitmap,s=a.width,o=a.height;return n.scanQuiet(0,0,s,o,(function(r,i){var a=r/s,c=i/o,l=Math.sqrt(Math.pow(a-.5,2)+Math.pow(c-.5,2)),u=2*Math.pow(l,t.r),h=(a-.5)/l,f=(c-.5)/l,d=Math.round((u*h+.5)*s),p=Math.round((u*f+.5)*o),m=n.getPixelColor(d,p);e.setPixelColor(m,r,i)})),this.setPixelColor(n.getPixelColor(s/2,o/2),s/2,o/2),(0,i.isNodePattern)(r)&&r.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],212:[function(e,t,r){(function(i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@jimp/utils");function a(e,t,r){if("boolean"!=typeof e||"boolean"!=typeof t)return n.throwError.call(this,"horizontal and vertical must be Booleans",r);var a=i.alloc(this.bitmap.data.length);return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(r,i,n){var s=e?this.bitmap.width-1-r:r,o=t?this.bitmap.height-1-i:i,c=this.bitmap.width*o+s<<2,l=this.bitmap.data.readUInt32BE(n);a.writeUInt32BE(l,c)})),this.bitmap.data=i.from(a),(0,n.isNodePattern)(r)&&r.call(this,null,this),this}var s=function(){return{flip:a,mirror:a}};r.default=s,t.exports=r.default}).call(this,e("buffer").Buffer)},{"@jimp/utils":235,buffer:48}],213:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{gaussian:function(e,t){if("number"!=typeof e)return i.throwError.call(this,"r must be a number",t);if(e<1)return i.throwError.call(this,"r must be greater than 0",t);for(var r=Math.ceil(2.57*e),n=2*r+1,a=e*e*2,s=a*Math.PI,o=[],c=0;c<n;c++){o[c]=[];for(var l=0;l<n;l++){var u=Math.pow(l-r,2)+Math.pow(c-r,2);o[c][l]=Math.exp(-u/a)/s}}for(var h=0;h<this.bitmap.height;h++)for(var f=0;f<this.bitmap.width;f++)for(var d=0,p=0,m=0,b=0,v=0,g=0;g<n;g++){for(var y=0;y<n;y++){var _=Math.min(this.bitmap.width-1,Math.max(0,y+f-r)),w=Math.min(this.bitmap.height-1,Math.max(0,g+h-r)),x=o[g][y],k=w*this.bitmap.width+_<<2;d+=this.bitmap.data[k]*x,p+=this.bitmap.data[k+1]*x,m+=this.bitmap.data[k+2]*x,b+=this.bitmap.data[k+3]*x,v+=x}var S=h*this.bitmap.width+f<<2;this.bitmap.data[S]=Math.round(d/v),this.bitmap.data[S+1]=Math.round(p/v),this.bitmap.data[S+2]=Math.round(m/v),this.bitmap.data[S+3]=Math.round(b/v)}return(0,i.isNodePattern)(t)&&t.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],214:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{invert:function(e){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,r){this.bitmap.data[r]=255-this.bitmap.data[r],this.bitmap.data[r+1]=255-this.bitmap.data[r+1],this.bitmap.data[r+2]=255-this.bitmap.data[r+2]})),(0,i.isNodePattern)(e)&&e.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],215:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{mask:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;if(!(e instanceof this.constructor))return i.throwError.call(this,"The source must be a Jimp image",n);if("number"!=typeof t||"number"!=typeof r)return i.throwError.call(this,"x and y must be numbers",n);t=Math.round(t),r=Math.round(r);var a=this.bitmap.width,s=this.bitmap.height,o=this;return e.scanQuiet(0,0,e.bitmap.width,e.bitmap.height,(function(e,i,n){var c=t+e,l=r+i;if(c>=0&&l>=0&&c<a&&l<s){var u=o.getPixelIndex(c,l),h=this.bitmap.data,f=(h[n+0]+h[n+1]+h[n+2])/3;o.bitmap.data[u+3]*=f/255}})),(0,i.isNodePattern)(n)&&n.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],216:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils");function n(){var e={r:new Array(256).fill(0),g:new Array(256).fill(0),b:new Array(256).fill(0)};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,r,i){e.r[this.bitmap.data[i+0]]++,e.g[this.bitmap.data[i+1]]++,e.b[this.bitmap.data[i+2]]++})),e}var a=function(e,t,r){return 255*(e-t)/(r-t)},s=function(e){return[e.findIndex((function(e){return e>0})),255-e.slice().reverse().findIndex((function(e){return e>0}))]},o=function(){return{normalize:function(e){var t=n.call(this),r={r:s(t.r),g:s(t.g),b:s(t.b)};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,i){var n=this.bitmap.data[i+0],s=this.bitmap.data[i+1],o=this.bitmap.data[i+2];this.bitmap.data[i+0]=a(n,r.r[0],r.r[1]),this.bitmap.data[i+1]=a(s,r.g[0],r.g[1]),this.bitmap.data[i+2]=a(o,r.b[0],r.b[1])})),(0,i.isNodePattern)(e)&&e.call(this,null,this),this}}};r.default=o,t.exports=r.default},{"@jimp/utils":235}],217:[function(e,t,r){(function(i){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/typeof")),s=n(e("@babel/runtime/helpers/toConsumableArray")),o=n(e("path")),c=n(e("load-bmfont")),l=e("@jimp/utils"),u=e("./measure-text");function h(e,t,r,i,n){return n===e.HORIZONTAL_ALIGN_LEFT?0:n===e.HORIZONTAL_ALIGN_CENTER?(i-(0,u.measureText)(t,r))/2:i-(0,u.measureText)(t,r)}function f(e,t,r,i,n){if(n.width>0&&n.height>0){var a=t.pages[n.page];e.blit(a,r+n.xoffset,i+n.yoffset,n.x,n.y,n.width,n.height)}return e}function d(e,t,r,i,n){for(var a=0;a<i.length;a++){var s=void 0;s=e.chars[i[a]]?i[a]:/\s/.test(i[a])?"":"?";var o=e.chars[s]||{},c=e.kernings[s];f(this,e,t,r,o||{}),t+=(c&&c[i[a+1]]?c[i[a+1]]:0)+(o.xadvance||n)}}function p(e,t,r){var i=t.split(" "),n=[],a=[],o=0;return i.forEach((function(t){var i=[].concat((0,s.default)(a),[t]).join(" "),c=(0,u.measureText)(e,i);c<=r?(c>o&&(o=c),a.push(t)):(n.push(a),a=[t])})),n.push(a),{lines:n,longestLine:o}}function m(e,t,r){var i=r.map((function(r){return e.read(t+"/"+r)}));return Promise.all(i)}var b="browser/lib/",v=function(){return{constants:{measureText:u.measureText,measureTextHeight:u.measureTextHeight,FONT_SANS_8_BLACK:o.default.join(b,"fonts/open-sans/open-sans-8-black/open-sans-8-black.fnt"),FONT_SANS_10_BLACK:o.default.join(b,"fonts/open-sans/open-sans-10-black/open-sans-10-black.fnt"),FONT_SANS_12_BLACK:o.default.join(b,"fonts/open-sans/open-sans-12-black/open-sans-12-black.fnt"),FONT_SANS_14_BLACK:o.default.join(b,"fonts/open-sans/open-sans-14-black/open-sans-14-black.fnt"),FONT_SANS_16_BLACK:o.default.join(b,"fonts/open-sans/open-sans-16-black/open-sans-16-black.fnt"),FONT_SANS_32_BLACK:o.default.join(b,"fonts/open-sans/open-sans-32-black/open-sans-32-black.fnt"),FONT_SANS_64_BLACK:o.default.join(b,"fonts/open-sans/open-sans-64-black/open-sans-64-black.fnt"),FONT_SANS_128_BLACK:o.default.join(b,"fonts/open-sans/open-sans-128-black/open-sans-128-black.fnt"),FONT_SANS_8_WHITE:o.default.join(b,"fonts/open-sans/open-sans-8-white/open-sans-8-white.fnt"),FONT_SANS_16_WHITE:o.default.join(b,"fonts/open-sans/open-sans-16-white/open-sans-16-white.fnt"),FONT_SANS_32_WHITE:o.default.join(b,"fonts/open-sans/open-sans-32-white/open-sans-32-white.fnt"),FONT_SANS_64_WHITE:o.default.join(b,"fonts/open-sans/open-sans-64-white/open-sans-64-white.fnt"),FONT_SANS_128_WHITE:o.default.join(b,"fonts/open-sans/open-sans-128-white/open-sans-128-white.fnt"),loadFont:function(e,t){var r=this;return"string"!=typeof e?l.throwError.call(this,"file must be a string",t):new Promise((function(i,n){t=t||function(e,t){e?n(e):i(t)},(0,c.default)(e,(function(i,n){var a={},s={};if(i)return l.throwError.call(r,i,t);for(var c=0;c<n.chars.length;c++)a[String.fromCharCode(n.chars[c].id)]=n.chars[c];for(var u=0;u<n.kernings.length;u++){var h=String.fromCharCode(n.kernings[u].first);s[h]=s[h]||{},s[h][String.fromCharCode(n.kernings[u].second)]=n.kernings[u].amount}m(r,o.default.dirname(e),n.pages).then((function(e){t(null,{chars:a,kernings:s,pages:e,common:n.common,info:n.info})}))}))}))}},class:{print:function(e,t,r,i,n,s,o){var c,f,m=this;if("function"==typeof n&&void 0===o&&(o=n,n=1/0),void 0===n&&(n=1/0),"function"==typeof s&&void 0===o&&(o=s,s=1/0),void 0===s&&(s=1/0),"object"!==(0,a.default)(e))return l.throwError.call(this,"font must be a Jimp loadFont",o);if("number"!=typeof t||"number"!=typeof r||"number"!=typeof n)return l.throwError.call(this,"x, y and maxWidth must be numbers",o);if("number"!=typeof n)return l.throwError.call(this,"maxWidth must be a number",o);if("number"!=typeof s)return l.throwError.call(this,"maxHeight must be a number",o);"object"===(0,a.default)(i)&&null!==i.text&&void 0!==i.text?(c=i.alignmentX||this.constructor.HORIZONTAL_ALIGN_LEFT,f=i.alignmentY||this.constructor.VERTICAL_ALIGN_TOP,i=i.text):(c=this.constructor.HORIZONTAL_ALIGN_LEFT,f=this.constructor.VERTICAL_ALIGN_TOP,i=i.toString()),s!==1/0&&f===this.constructor.VERTICAL_ALIGN_BOTTOM?r+=s-(0,u.measureTextHeight)(e,i,n):s!==1/0&&f===this.constructor.VERTICAL_ALIGN_MIDDLE&&(r+=s/2-(0,u.measureTextHeight)(e,i,n)/2);var b=Object.entries(e.chars)[0][1].xadvance,v=p(e,i,n),g=v.lines,y=v.longestLine;return g.forEach((function(i){var a=i.join(" "),s=h(m.constructor,e,a,n,c);d.call(m,e,t+s,r,a,b),r+=e.common.lineHeight})),(0,l.isNodePattern)(o)&&o.call(this,null,this,{x:t+y,y:r}),this}}}};r.default=v,t.exports=r.default}).call(this,"/../../node_modules/@jimp/plugin-print/dist")},{"./measure-text":218,"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/toConsumableArray":20,"@babel/runtime/helpers/typeof":21,"@jimp/utils":235,"load-bmfont":219,path:107}],218:[function(e,t,r){function i(e,t){for(var r=0,i=0;i<t.length;i++)if(e.chars[t[i]]){var n=e.kernings[t[i]]&&e.kernings[t[i]][t[i+1]]?e.kernings[t[i]][t[i+1]]:0;r+=(e.chars[t[i]].xadvance||0)+n}return r}function n(e,t,r){for(var n=t.split(" "),a="",s=e.common.lineHeight,o=0;o<n.length;o++){var c=a+n[o]+" ";i(e,c)>r&&o>0?(s+=e.common.lineHeight,a=n[o]+" "):a=c}return s}Object.defineProperty(r,"__esModule",{value:!0}),r.measureText=i,r.measureTextHeight=n},{}],219:[function(e,t,r){(function(r){var i=e("xhr"),n=function(){},a=e("parse-bmfont-ascii"),s=e("parse-bmfont-xml"),o=e("parse-bmfont-binary"),c=e("./lib/is-binary"),l=e("xtend"),u=self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;function h(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}function f(e){if(u)return l(e,{responseType:"arraybuffer"});if(void 0===self.XMLHttpRequest)throw new Error("your browser does not support XHR loading");var t=new self.XMLHttpRequest;return t.overrideMimeType("text/plain; charset=x-user-defined"),l({xhr:t},e)}t.exports=function(e,t){t="function"==typeof t?t:n,"string"==typeof e?e={uri:e}:e||(e={}),e.binary&&(e=f(e)),i(e,(function(i,l,u){if(i)return t(i);if(!/^2/.test(l.statusCode))return t(new Error("http status code: "+l.statusCode));if(!u)return t(new Error("no body result"));var f,d=!1;if(h(u)){var p=new Uint8Array(u);u=new r(p,"binary")}c(u)&&(d=!0,"string"==typeof u&&(u=new r(u,"binary"))),d||(r.isBuffer(u)&&(u=u.toString(e.encoding)),u=u.trim());try{var m=l.headers["content-type"];f=d?o(u):/json/.test(m)||"{"===u.charAt(0)?JSON.parse(u):/xml/.test(m)||"<"===u.charAt(0)?s(u):a(u)}catch(b){t(new Error("error parsing font "+b.message)),t=n}t(null,f)}))}}).call(this,e("buffer").Buffer)},{"./lib/is-binary":220,buffer:48,"parse-bmfont-ascii":102,"parse-bmfont-binary":103,"parse-bmfont-xml":104,xhr:187,xtend:189}],220:[function(e,t,r){(function(r){var i=e("buffer-equal"),n=new r([66,77,70,3]);t.exports=function(e){return"string"==typeof e?"BMF"===e.substring(0,3):e.length>4&&i(e.slice(0,4),n)}}).call(this,e("buffer").Buffer)},{buffer:48,"buffer-equal":49}],221:[function(e,t,r){(function(i){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=e("@jimp/utils"),s=n(e("./modules/resize")),o=n(e("./modules/resize2")),c=function(){return{constants:{RESIZE_NEAREST_NEIGHBOR:"nearestNeighbor",RESIZE_BILINEAR:"bilinearInterpolation",RESIZE_BICUBIC:"bicubicInterpolation",RESIZE_HERMITE:"hermiteInterpolation",RESIZE_BEZIER:"bezierInterpolation"},class:{resize:function(e,t,r,n){if("number"!=typeof e||"number"!=typeof t)return a.throwError.call(this,"w and h must be numbers",n);if("function"==typeof r&&void 0===n&&(n=r,r=null),e===this.constructor.AUTO&&t===this.constructor.AUTO)return a.throwError.call(this,"w and h cannot both be set to auto",n);if(e===this.constructor.AUTO&&(e=this.bitmap.width*(t/this.bitmap.height)),t===this.constructor.AUTO&&(t=this.bitmap.height*(e/this.bitmap.width)),e<0||t<0)return a.throwError.call(this,"w and h must be positive numbers",n);if(e=Math.round(e),t=Math.round(t),"function"==typeof o.default[r]){var c={data:i.alloc(e*t*4),width:e,height:t};o.default[r](this.bitmap,c),this.bitmap=c}else{var l=this,u=new s.default(this.bitmap.width,this.bitmap.height,e,t,!0,!0,(function(r){l.bitmap.data=i.from(r),l.bitmap.width=e,l.bitmap.height=t}));u.resize(this.bitmap.data)}return(0,a.isNodePattern)(n)&&n.call(this,null,this),this}}}};r.default=c,t.exports=r.default}).call(this,e("buffer").Buffer)},{"./modules/resize":222,"./modules/resize2":223,"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/utils":235,buffer:48}],222:[function(e,t,r){function i(e,t,r,i,n,a,s){this.widthOriginal=Math.abs(Math.floor(e)||0),this.heightOriginal=Math.abs(Math.floor(t)||0),this.targetWidth=Math.abs(Math.floor(r)||0),this.targetHeight=Math.abs(Math.floor(i)||0),this.colorChannels=n?4:3,this.interpolationPass=Boolean(a),this.resizeCallback="function"==typeof s?s:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}i.prototype.initialize=function(){if(!(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0))throw new Error("Invalid settings specified for the resizer.");this.configurePasses()},i.prototype.configurePasses=function(){this.widthOriginal===this.targetWidth?this.resizeWidth=this.bypassResizer:(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass?(this.initializeFirstPassBuffers(!0),this.resizeWidth=4===this.colorChannels?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB):(this.initializeFirstPassBuffers(!1),this.resizeWidth=4===this.colorChannels?this.resizeWidthRGBA:this.resizeWidthRGB)),this.heightOriginal===this.targetHeight?this.resizeHeight=this.bypassResizer:(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass?(this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated):(this.initializeSecondPassBuffers(!1),this.resizeHeight=4===this.colorChannels?this.resizeHeightRGBA:this.resizeHeightRGB))},i.prototype._resizeWidthInterpolatedRGBChannels=function(e,t){var r,i,n=t?4:3,a=this.ratioWeightWidthPass,s=this.widthBuffer,o=0,c=0,l=0,u=0,h=0;for(r=0;o<1/3;r+=n,o+=a)for(c=r,l=0;c<this.widthPassResultSize;l+=this.originalWidthMultipliedByChannels,c+=this.targetWidthMultipliedByChannels)s[c]=e[l],s[c+1]=e[l+1],s[c+2]=e[l+2],t&&(s[c+3]=e[l+3]);for(o-=1/3,i=this.widthOriginal-1;o<i;r+=n,o+=a)for(u=1-(h=o%1),c=r,l=Math.floor(o)*n;c<this.widthPassResultSize;l+=this.originalWidthMultipliedByChannels,c+=this.targetWidthMultipliedByChannels)s[c+0]=e[l+0]*u+e[l+n+0]*h,s[c+1]=e[l+1]*u+e[l+n+1]*h,s[c+2]=e[l+2]*u+e[l+n+2]*h,t&&(s[c+3]=e[l+3]*u+e[l+n+3]*h);for(i=this.originalWidthMultipliedByChannels-n;r<this.targetWidthMultipliedByChannels;r+=n)for(c=r,l=i;c<this.widthPassResultSize;l+=this.originalWidthMultipliedByChannels,c+=this.targetWidthMultipliedByChannels)s[c]=e[l],s[c+1]=e[l+1],s[c+2]=e[l+2],t&&(s[c+3]=e[l+3]);return s},i.prototype._resizeWidthRGBChannels=function(e,t){var r=t?4:3,i=this.ratioWeightWidthPass,n=1/i,a=this.originalWidthMultipliedByChannels-r+1,s=this.targetWidthMultipliedByChannels-r+1,o=this.outputWidthWorkBench,c=this.widthBuffer,l=this.outputWidthWorkBenchOpaquePixelsCount,u=0,h=0,f=0,d=0,p=0,m=0,b=0,v=1,g=0,y=0,_=0,w=0;do{for(p=0;p<this.originalHeightMultipliedByChannels;)o[p++]=0,o[p++]=0,o[p++]=0,t&&(o[p++]=0,l[p/r-1]=0);u=i;do{for(h=1+f-d,v=Math.min(u,h),p=0,m=f;p<this.originalHeightMultipliedByChannels;m+=a)g=e[m],y=e[++m],_=e[++m],w=t?e[++m]:255,o[p++]+=(w?g:0)*v,o[p++]+=(w?y:0)*v,o[p++]+=(w?_:0)*v,t&&(o[p++]+=w*v,l[p/r-1]+=w?v:0);if(!(u>=h)){d+=u;break}d=f+=r,u-=h}while(u>0&&f<this.originalWidthMultipliedByChannels);for(p=0,m=b;p<this.originalHeightMultipliedByChannels;m+=s)u=t?l[p/r]:1,v=t?u?1/u:0:n,c[m]=o[p++]*v,c[++m]=o[p++]*v,c[++m]=o[p++]*v,t&&(c[++m]=o[p++]*n);b+=r}while(b<this.targetWidthMultipliedByChannels);return c},i.prototype._resizeHeightRGBChannels=function(e,t){var r=this.ratioWeightHeightPass,i=1/r,n=this.outputHeightWorkBench,a=this.heightBuffer,s=this.outputHeightWorkBenchOpaquePixelsCount,o=0,c=0,l=0,u=0,h=0,f=0,d=0,p=1,m=0,b=0,v=0,g=0;do{for(h=0;h<this.targetWidthMultipliedByChannels;)n[h++]=0,n[h++]=0,n[h++]=0,t&&(n[h++]=0,s[h/4-1]=0);o=r;do{for(c=1+l-u,p=Math.min(o,c),d=l,h=0;h<this.targetWidthMultipliedByChannels;)m=e[d++],b=e[d++],v=e[d++],g=t?e[d++]:255,n[h++]+=(g?m:0)*p,n[h++]+=(g?b:0)*p,n[h++]+=(g?v:0)*p,t&&(n[h++]+=g*p,s[h/4-1]+=g?p:0);if(!(o>=c)){u+=o;break}u=l=d,o-=c}while(o>0&&l<this.widthPassResultSize);for(h=0;h<this.targetWidthMultipliedByChannels;)o=t?s[h/4]:1,p=t?o?1/o:0:i,a[f++]=Math.round(n[h++]*p),a[f++]=Math.round(n[h++]*p),a[f++]=Math.round(n[h++]*p),t&&(a[f++]=Math.round(n[h++]*i))}while(f<this.finalResultSize);return a},i.prototype.resizeWidthInterpolatedRGB=function(e){return this._resizeWidthInterpolatedRGBChannels(e,!1)},i.prototype.resizeWidthInterpolatedRGBA=function(e){return this._resizeWidthInterpolatedRGBChannels(e,!0)},i.prototype.resizeWidthRGB=function(e){return this._resizeWidthRGBChannels(e,!1)},i.prototype.resizeWidthRGBA=function(e){return this._resizeWidthRGBChannels(e,!0)},i.prototype.resizeHeightInterpolated=function(e){for(var t,r=this.ratioWeightHeightPass,i=this.heightBuffer,n=0,a=0,s=0,o=0,c=0,l=0,u=0;n<1/3;n+=r)for(s=0;s<this.targetWidthMultipliedByChannels;)i[a++]=Math.round(e[s++]);for(n-=1/3,t=this.heightOriginal-1;n<t;n+=r)for(l=1-(u=n%1),c=(o=Math.floor(n)*this.targetWidthMultipliedByChannels)+this.targetWidthMultipliedByChannels,s=0;s<this.targetWidthMultipliedByChannels;++s)i[a++]=Math.round(e[o++]*l+e[c++]*u);for(;a<this.finalResultSize;)for(s=0,o=t*this.targetWidthMultipliedByChannels;s<this.targetWidthMultipliedByChannels;++s)i[a++]=Math.round(e[o++]);return i},i.prototype.resizeHeightRGB=function(e){return this._resizeHeightRGBChannels(e,!1)},i.prototype.resizeHeightRGBA=function(e){return this._resizeHeightRGBChannels(e,!0)},i.prototype.resize=function(e){this.resizeCallback(this.resizeHeight(this.resizeWidth(e)))},i.prototype.bypassResizer=function(e){return e},i.prototype.initializeFirstPassBuffers=function(e){this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),e||(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3&&(this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)))},i.prototype.initializeSecondPassBuffers=function(e){this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),e||(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3&&(this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)))},i.prototype.generateFloatBuffer=function(e){try{return new Float32Array(e)}catch(t){return[]}},i.prototype.generateFloat64Buffer=function(e){try{return new Float64Array(e)}catch(t){return[]}},i.prototype.generateUint8Buffer=function(e){try{return new Uint8Array(e)}catch(t){return[]}},t.exports=i},{}],223:[function(e,t,r){(function(e){t.exports={nearestNeighbor:function(e,t){for(var r=e.width,i=e.height,n=t.width,a=t.height,s=e.data,o=t.data,c=0;c<a;c++)for(var l=0;l<n;l++){var u=4*(c*n+l),h=4*(Math.floor(c*i/a)*r+Math.floor(l*r/n));o[u++]=s[h++],o[u++]=s[h++],o[u++]=s[h++],o[u++]=s[h++]}},bilinearInterpolation:function(e,t){for(var r=e.width,i=e.height,n=t.width,a=t.height,s=e.data,o=t.data,c=function(e,t,r,i,n){return t===i?r:Math.round((e-t)*n+(i-e)*r)},l=function(e,t,i,n,a,l,u,h){var f=4*(u*r+n)+t,d=4*(u*r+a)+t,p=c(i,n,s[f],a,s[d]);if(h===u)o[e+t]=p;else{d=4*(h*r+a)+t;var m=c(i,n,s[f=4*(h*r+n)+t],a,s[d]);o[e+t]=c(l,u,p,h,m)}},u=0;u<a;u++)for(var h=0;h<n;h++){var f=4*(u*n+h),d=h*r/n,p=Math.floor(d),m=Math.min(Math.ceil(d),r-1),b=u*i/a,v=Math.floor(b),g=Math.min(Math.ceil(b),i-1);l(f,0,d,p,m,b,v,g),l(f,1,d,p,m,b,v,g),l(f,2,d,p,m,b,v,g),l(f,3,d,p,m,b,v,g)}},_interpolate2D:function(t,r,i,n){for(var a=t.data,s=r.data,o=t.width,c=t.height,l=r.width,u=r.height,h=Math.max(1,Math.floor(o/l)),f=l*h,d=Math.max(1,Math.floor(c/u)),p=u*d,m=e.alloc(f*c*4),b=0;b<c;b++)for(var v=0;v<f;v++)for(var g=v*(o-1)/f,y=Math.floor(g),_=g-y,w=4*(b*o+y),x=4*(b*f+v),k=0;k<4;k++){var S=w+k,C=y>0?a[S-4]:2*a[S]-a[S+4],U=a[S],E=a[S+4],T=y<o-2?a[S+8]:2*a[S+4]-a[S];m[x+k]=n(C,U,E,T,_)}for(var M=e.alloc(f*p*4),O=0;O<p;O++)for(var P=0;P<f;P++)for(var A=O*(c-1)/p,I=Math.floor(A),L=A-I,j=4*(I*f+P),R=4*(O*f+P),D=0;D<4;D++){var B=j+D,F=I>0?m[B-4*f]:2*m[B]-m[B+4*f],N=m[B],z=m[B+4*f],H=I<c-2?m[B+8*f]:2*m[B+4*f]-m[B];M[R+D]=n(F,N,z,H,L)}var G=h*d;if(G>1)for(var W=0;W<u;W++)for(var Y=0;Y<l;Y++){for(var X=0,V=0,q=0,Z=0,K=0,J=0;J<d;J++)for(var Q=W*d+J,$=0;$<h;$++){var ee=4*(Q*f+(Y*h+$)),te=M[ee+3];te&&(X+=M[ee],V+=M[ee+1],q+=M[ee+2],K++),Z+=te}var re=4*(W*l+Y);s[re]=K?Math.round(X/K):0,s[re+1]=K?Math.round(V/K):0,s[re+2]=K?Math.round(q/K):0,s[re+3]=Math.round(Z/G)}else r.data=M},bicubicInterpolation:function(e,t,r){var i=function(e,t,r,i,n){var a=i-r-e+t,s=e-t-a,o=r-e,c=t;return Math.max(0,Math.min(255,a*(n*n*n)+s*(n*n)+o*n+c))};return this._interpolate2D(e,t,r,i)},hermiteInterpolation:function(e,t,r){var i=function(e,t,r,i,n){var a=t,s=.5*(r-e),o=e-2.5*t+2*r-.5*i,c=.5*(i-e)+1.5*(t-r);return Math.max(0,Math.min(255,Math.round(((c*n+o)*n+s)*n+a)))};return this._interpolate2D(e,t,r,i)},bezierInterpolation:function(e,t,r){var i=function(e,t,r,i,n){var a=1-n,s=t*a*a*a,o=3*(t+(r-e)/4)*a*a*n,c=3*(r-(i-t)/4)*a*n*n,l=r*n*n*n;return Math.max(0,Math.min(255,Math.round(s+o+c+l)))};return this._interpolate2D(e,t,r,i)}}}).call(this,e("buffer").Buffer)},{buffer:48}],224:[function(e,t,r){(function(i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@jimp/utils");function a(e,t){var r=(e%=360)*Math.PI/180,n=Math.cos(r),a=Math.sin(r),s=this.bitmap.width,o=this.bitmap.height;if(!0===t||"string"==typeof t){(s=Math.ceil(Math.abs(this.bitmap.width*n)+Math.abs(this.bitmap.height*a))+1)%2!=0&&s++,(o=Math.ceil(Math.abs(this.bitmap.width*a)+Math.abs(this.bitmap.height*n))+1)%2!=0&&o++;var c=this.cloneQuiet();this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,r){this.bitmap.data.writeUInt32BE(this._background,r)}));var l=Math.max(s,o,this.bitmap.width,this.bitmap.height);this.resize(l,l,t),this.blit(c,this.bitmap.width/2-c.bitmap.width/2,this.bitmap.height/2-c.bitmap.height/2)}var u=this.bitmap.width,h=this.bitmap.height,f=i.alloc(this.bitmap.data.length);function d(e,t){return function(r,i){return{x:r+e,y:i+t}}}for(var p=d(-u/2,-h/2),m=d(u/2+.5,h/2+.5),b=1;b<=h;b++)for(var v=1;v<=u;v++){var g=p(v,b),y=m(n*g.x-a*g.y,n*g.y+a*g.x),_=u*(b-1)+v-1<<2;if(y.x>=0&&y.x<u&&y.y>=0&&y.y<h){var w=(u*(0|y.y)+y.x|0)<<2,x=this.bitmap.data.readUInt32BE(w);f.writeUInt32BE(x,_)}else f.writeUInt32BE(this._background,_)}if(this.bitmap.data=f,!0===t||"string"==typeof t){var k=u/2-s/2,S=h/2-o/2;this.crop(k,S,s,o)}}var s=function(){return{rotate:function(e,t,r){return null==t&&(t=!0),"function"==typeof t&&void 0===r&&(r=t,t=!0),"number"!=typeof e?n.throwError.call(this,"deg must be a number",r):"boolean"!=typeof t&&"string"!=typeof t?n.throwError.call(this,"mode must be a boolean or a string",r):(a.call(this,e,t,r),(0,n.isNodePattern)(r)&&r.call(this,null,this),this)}}};r.default=s,t.exports=r.default}).call(this,e("buffer").Buffer)},{"@jimp/utils":235,buffer:48}],225:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{scale:function(e,t,r){if("number"!=typeof e)return i.throwError.call(this,"f must be a number",r);if(e<0)return i.throwError.call(this,"f must be a positive number",r);"function"==typeof t&&void 0===r&&(r=t,t=null);var n=this.bitmap.width*e,a=this.bitmap.height*e;return this.resize(n,a,t),(0,i.isNodePattern)(r)&&r.call(this,null,this),this},scaleToFit:function(e,t,r,n){if("number"!=typeof e||"number"!=typeof t)return i.throwError.call(this,"w and h must be numbers",n);"function"==typeof r&&void 0===n&&(n=r,r=null);var a=e/t>this.bitmap.width/this.bitmap.height?t/this.bitmap.height:e/this.bitmap.width;return this.scale(a,r),(0,i.isNodePattern)(n)&&n.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],226:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{shadow:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(r=t,t={});var n=t,a=n.opacity,s=void 0===a?.7:a,o=n.size,c=void 0===o?1.1:o,l=n.x,u=void 0===l?-25:l,h=n.y,f=void 0===h?25:h,d=n.blur,p=void 0===d?5:d,m=this.clone(),b=this.clone();return b.scan(0,0,b.bitmap.width,b.bitmap.height,(function(t,r,i){b.bitmap.data[i]=0,b.bitmap.data[i+1]=0,b.bitmap.data[i+2]=0,b.bitmap.data[i+3]=b.constructor.limit255(b.bitmap.data[i+3]*s),e.bitmap.data[i]=0,e.bitmap.data[i+1]=0,e.bitmap.data[i+2]=0,e.bitmap.data[i+3]=0})),b.resize(b.bitmap.width*c,b.bitmap.height*c).blur(p),this.composite(b,u,f),this.composite(m,0,0),(0,i.isNodePattern)(r)&&r.call(this,null,this),this}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],227:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@jimp/utils"),n=function(){return{threshold:function(e,t){var r=this,n=e.max,a=e.replace,s=void 0===a?255:a,o=e.autoGreyscale,c=void 0===o||o;return"number"!=typeof n?i.throwError.call(this,"max must be a number",t):"number"!=typeof s?i.throwError.call(this,"replace must be a number",t):"boolean"!=typeof c?i.throwError.call(this,"autoGreyscale must be a boolean",t):(n=this.constructor.limit255(n),s=this.constructor.limit255(s),c&&this.greyscale(),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,t,i){var a=r.bitmap.data[i]<n?r.bitmap.data[i]:s;r.bitmap.data[i]=a,r.bitmap.data[i+1]=a,r.bitmap.data[i+2]=a})),(0,i.isNodePattern)(t)&&t.call(this,null,this),this)}}};r.default=n,t.exports=r.default},{"@jimp/utils":235}],228:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/toConsumableArray")),a=e("timm"),s=i(e("@jimp/plugin-blit")),o=i(e("@jimp/plugin-blur")),c=i(e("@jimp/plugin-circle")),l=i(e("@jimp/plugin-color")),u=i(e("@jimp/plugin-contain")),h=i(e("@jimp/plugin-cover")),f=i(e("@jimp/plugin-crop")),d=i(e("@jimp/plugin-displace")),p=i(e("@jimp/plugin-dither")),m=i(e("@jimp/plugin-fisheye")),b=i(e("@jimp/plugin-flip")),v=i(e("@jimp/plugin-gaussian")),g=i(e("@jimp/plugin-invert")),y=i(e("@jimp/plugin-mask")),_=i(e("@jimp/plugin-normalize")),w=i(e("@jimp/plugin-print")),x=i(e("@jimp/plugin-resize")),k=i(e("@jimp/plugin-rotate")),S=i(e("@jimp/plugin-scale")),C=i(e("@jimp/plugin-shadow")),U=i(e("@jimp/plugin-threshold")),E=[s.default,o.default,c.default,l.default,u.default,h.default,f.default,d.default,p.default,m.default,b.default,v.default,g.default,y.default,_.default,w.default,x.default,k.default,S.default,C.default,U.default],T=function(e){var t=E.map((function(t){var r=t(e)||{};return r.class||r.constants||(r={class:r}),r}));return a.mergeDeep.apply(void 0,(0,n.default)(t))};r.default=T,t.exports=r.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/helpers/toConsumableArray":20,"@jimp/plugin-blit":201,"@jimp/plugin-blur":203,"@jimp/plugin-circle":204,"@jimp/plugin-color":205,"@jimp/plugin-contain":206,"@jimp/plugin-cover":207,"@jimp/plugin-crop":208,"@jimp/plugin-displace":209,"@jimp/plugin-dither":210,"@jimp/plugin-fisheye":211,"@jimp/plugin-flip":212,"@jimp/plugin-gaussian":213,"@jimp/plugin-invert":214,"@jimp/plugin-mask":215,"@jimp/plugin-normalize":216,"@jimp/plugin-print":217,"@jimp/plugin-resize":221,"@jimp/plugin-rotate":224,"@jimp/plugin-scale":225,"@jimp/plugin-shadow":226,"@jimp/plugin-threshold":227,timm:177}],229:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/defineProperty")),a=i(e("bmp-js")),s=e("@jimp/utils"),o="image/bmp",c="image/x-ms-bmp";function l(e){return(0,s.scan)(e,0,0,e.bitmap.width,e.bitmap.height,(function(e,t,r){var i=this.bitmap.data[r+0],n=this.bitmap.data[r+1],a=this.bitmap.data[r+2],s=this.bitmap.data[r+3];this.bitmap.data[r+0]=s,this.bitmap.data[r+1]=a,this.bitmap.data[r+2]=n,this.bitmap.data[r+3]=i})).bitmap}function u(e){return(0,s.scan)({bitmap:e},0,0,e.width,e.height,(function(t,r,i){var n=this.bitmap.data[i+0],a=this.bitmap.data[i+1],s=this.bitmap.data[i+2],o=this.bitmap.data[i+3];this.bitmap.data[i+0]=o,this.bitmap.data[i+1]=s,this.bitmap.data[i+2]=a,this.bitmap.data[i+3]=e.is_with_alpha?n:255})).bitmap}var h=function(e){return u(a.default.decode(e))},f=function(e){return a.default.encode(l(e)).data},d=function(){var e,t;return{mime:(0,n.default)({},o,["bmp"]),constants:{MIME_BMP:o,MIME_X_MS_BMP:c},decoders:(e={},(0,n.default)(e,o,h),(0,n.default)(e,c,h),e),encoders:(t={},(0,n.default)(t,o,f),(0,n.default)(t,c,f),t)}};r.default=d,t.exports=r.default},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/utils":235,"bmp-js":30}],230:[function(e,t,r){(function(i){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("omggif")),o=e("gifwrap"),c="image/gif",l=function(){return{mime:(0,a.default)({},c,["gif"]),constants:{MIME_GIF:c},decoders:(0,a.default)({},c,(function(e){var t=new s.default.GifReader(e),r=i.alloc(t.width*t.height*4);return t.decodeAndBlitFrameRGBA(0,r),{data:r,width:t.width,height:t.height}})),encoders:(0,a.default)({},c,(function(e){var t=new o.BitmapImage(e.bitmap);o.GifUtil.quantizeDekker(t,256);var r=new o.GifFrame(t);return(new o.GifCodec).encodeGif([r],{}).then((function(e){return e.buffer}))}))}};r.default=l,t.exports=r.default}).call(this,e("buffer").Buffer)},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,buffer:48,gifwrap:70,omggif:85}],231:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/defineProperty")),a=i(e("jpeg-js")),s=e("@jimp/utils"),o="image/jpeg",c=function(){return{mime:(0,n.default)({},o,["jpeg","jpg","jpe"]),constants:{MIME_JPEG:o},decoders:(0,n.default)({},o,a.default.decode),encoders:(0,n.default)({},o,(function(e){return a.default.encode(e.bitmap,e._quality).data})),class:{_quality:100,quality:function(e,t){return"number"!=typeof e?s.throwError.call(this,"n must be a number",t):e<0||e>100?s.throwError.call(this,"n must be a number 0 - 100",t):(this._quality=Math.round(e),(0,s.isNodePattern)(t)&&t.call(this,null,this),this)}}}};r.default=c,t.exports=r.default},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/utils":235,"jpeg-js":80}],232:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/defineProperty")),a=e("pngjs"),s=e("@jimp/utils"),o="image/png",c=-1,l=0,u=1,h=2,f=3,d=4,p=function(){return{mime:(0,n.default)({},o,["png"]),constants:{MIME_PNG:o,PNG_FILTER_AUTO:c,PNG_FILTER_NONE:l,PNG_FILTER_SUB:u,PNG_FILTER_UP:h,PNG_FILTER_AVERAGE:f,PNG_FILTER_PATH:d},hasAlpha:(0,n.default)({},o,!0),decoders:(0,n.default)({},o,a.PNG.sync.read),encoders:(0,n.default)({},o,(function(e){var t=new a.PNG({width:e.bitmap.width,height:e.bitmap.height});return t.data=e.bitmap.data,a.PNG.sync.write(t,{width:e.bitmap.width,height:e.bitmap.height,deflateLevel:e._deflateLevel,deflateStrategy:e._deflateStrategy,filterType:e._filterType,colorType:"number"==typeof e._colorType?e._colorType:e._rgba?6:2,inputHasAlpha:e._rgba})})),class:{_deflateLevel:9,_deflateStrategy:3,_filterType:c,_colorType:null,deflateLevel:function(e,t){return"number"!=typeof e?s.throwError.call(this,"l must be a number",t):e<0||e>9?s.throwError.call(this,"l must be a number 0 - 9",t):(this._deflateLevel=Math.round(e),(0,s.isNodePattern)(t)&&t.call(this,null,this),this)},deflateStrategy:function(e,t){return"number"!=typeof e?s.throwError.call(this,"s must be a number",t):e<0||e>3?s.throwError.call(this,"s must be a number 0 - 3",t):(this._deflateStrategy=Math.round(e),(0,s.isNodePattern)(t)&&t.call(this,null,this),this)},filterType:function(e,t){return"number"!=typeof e?s.throwError.call(this,"n must be a number",t):e<-1||e>4?s.throwError.call(this,"n must be -1 (auto) or a number 0 - 4",t):(this._filterType=Math.round(e),(0,s.isNodePattern)(t)&&t.call(this,null,this),this)},colorType:function(e,t){return"number"!=typeof e?s.throwError.call(this,"s must be a number",t):0!==e&&2!==e&&4!==e&&6!==e?s.throwError.call(this,"s must be a number 0, 2, 4, 6.",t):(this._colorType=Math.round(e),(0,s.isNodePattern)(t)&&t.call(this,null,this),this)}}}};r.default=p,t.exports=r.default},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/utils":235,pngjs:129}],233:[function(e,t,r){(function(i){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("utif")),o="image/tiff",c=function(){return{mime:(0,a.default)({},o,["tiff","tif"]),constants:{MIME_TIFF:o},decoders:(0,a.default)({},o,(function(e){var t=s.default.decode(e),r=t[0];s.default.decodeImages(e,t);var n=s.default.toRGBA8(r);return{data:i.from(n),width:r.t256[0],height:r.t257[0]}})),encoders:(0,a.default)({},o,(function(e){var t=s.default.encodeImage(e.bitmap.data,e.bitmap.width,e.bitmap.height);return i.from(t)}))}};r.default=c,t.exports=r.default}).call(this,e("buffer").Buffer)},{"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":11,buffer:48,utif:182}],234:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("timm"),a=i(e("@jimp/jpeg")),s=i(e("@jimp/png")),o=i(e("@jimp/bmp")),c=i(e("@jimp/tiff")),l=i(e("@jimp/gif")),u=function(){return(0,n.mergeDeep)((0,a.default)(),(0,s.default)(),(0,o.default)(),(0,c.default)(),(0,l.default)())};r.default=u,t.exports=r.default},{"@babel/runtime/helpers/interopRequireDefault":11,"@jimp/bmp":229,"@jimp/gif":230,"@jimp/jpeg":231,"@jimp/png":232,"@jimp/tiff":233,timm:177}],235:[function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.isNodePattern=s,r.throwError=o,r.scan=c,r.scanIterator=l;var n=i(e("@babel/runtime/regenerator")),a=n.default.mark(l);function s(e){if(void 0===e)return!1;if("function"!=typeof e)throw new TypeError("Callback must be a function");return!0}function o(e,t){if("string"==typeof e&&(e=new Error(e)),"function"==typeof t)return t.call(this,e);throw e}function c(e,t,r,i,n,a){t=Math.round(t),r=Math.round(r),i=Math.round(i),n=Math.round(n);for(var s=r;s<r+n;s++)for(var o=t;o<t+i;o++){var c=e.bitmap.width*s+o<<2;a.call(e,o,s,c)}return e}function l(e,t,r,i,s){var o,c,l;return n.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=Math.round(t),r=Math.round(r),i=Math.round(i),s=Math.round(s),o=r;case 5:if(!(o<r+s)){n.next=17;break}c=t;case 7:if(!(c<t+i)){n.next=14;break}return l=e.bitmap.width*o+c<<2,n.next=11,{x:c,y:o,idx:l,image:e};case 11:c++,n.next=7;break;case 14:o++,n.next=5;break;case 17:case"end":return n.stop()}}),a)}},{"@babel/runtime/helpers/interopRequireDefault":11,"@babel/runtime/regenerator":22}]},{},[200])(200)}(Ef);var Tf=Ef.exports;function Mf(e,t){this.x=e||0,this.y=t||0}Mf.prototype={copy:function(){return new Mf(this.x,this.y)}};var Of=Mf,Pf=Of,Af={};function If(e){return e.toFixed(3).replace(".000","")}function Lf(e){return e>0?1:e<0?-1:0}function jf(e,t){var r=new Pf;return r.y=Lf(t.x-e.x),r.x=-Lf(t.y-e.y),r}function Rf(e,t,r,i){var n,a,s;return n=t.x-e.x,a=t.y-e.y,s=i.x-r.x,n*(i.y-r.y)-s*a}var Df,Bf,Ff,Nf,zf={luminance:function(e,t,r){return Math.round(.2126*e+.7153*t+.0721*r)},between:function(e,t,r){return e>=t&&e<=r},clamp:function(e,t,r){return Math.min(r,Math.max(t,e))},isNumber:function(e){return"number"==typeof e},setHtmlAttr:function(e,t,r){var i=" "+t+'="'+r+'"';return e=-1===e.indexOf(" "+t+'="')?e.replace(/<[a-z]+/i,(function(e){return e+i})):e.replace(function(e){return Af[e]||(Af[e]=new RegExp(" "+e+'="((?:\\\\(?=")"|[^"])+)"',"i")),Af[e]}(t),i)},renderCurve:function(e,t){t=t||{x:1,y:1};var r=e.c[3*(e.n-1)+2],i=["M "+If(r.x*t.x)+" "+If(r.y*t.y)];return e.tag.forEach((function(r,n){var a=3*n,s=e.c[a],o=e.c[a+1],c=e.c[a+2];"CURVE"===r?i.push("C "+If(s.x*t.x)+" "+If(s.y*t.y)+", "+If(o.x*t.x)+" "+If(o.y*t.y)+", "+If(c.x*t.x)+" "+If(c.y*t.y)):"CORNER"===r&&i.push("L "+If(o.x*t.x)+" "+If(o.y*t.y)+" "+If(c.x*t.x)+" "+If(c.y*t.y))})),i.join(" ")},bezier:function(e,t,r,i,n){var a=1-e,s=new Pf;return s.x=a*a*a*t.x+a*a*e*3*r.x+e*e*a*3*i.x+e*e*e*n.x,s.y=a*a*a*t.y+a*a*e*3*r.y+e*e*a*3*i.y+e*e*e*n.y,s},tangent:function(e,t,r,i,n,a){var s,o,c,l,u,h,f,d;return u=(l=-2*(s=Rf(e,t,n,a))+2*(o=Rf(t,r,n,a)))*l-4*(c=s-2*o+Rf(r,i,n,a))*s,0===c||u<0?-1:(d=(-l-(h=Math.sqrt(u)))/(2*c),(f=(-l+h)/(2*c))>=0&&f<=1?f:d>=0&&d<=1?d:-1)},mod:function(e,t){return e>=t?e%t:e>=0?e:t-1-(-1-e)%t},xprod:function(e,t){return e.x*t.y-e.y*t.x},cyclic:function(e,t,r){return e<=r?e<=t&&t<r:e<=t||t<r},sign:Lf,quadform:function(e,t){var r,i,n,a=new Array(3);for(a[0]=t.x,a[1]=t.y,a[2]=1,n=0,r=0;r<3;r++)for(i=0;i<3;i++)n+=a[r]*e.at(r,i)*a[i];return n},interval:function(e,t,r){var i=new Pf;return i.x=t.x+e*(r.x-t.x),i.y=t.y+e*(r.y-t.y),i},dorth_infty:jf,ddenom:function(e,t){var r=jf(e,t);return r.y*(t.x-e.x)-r.x*(t.y-e.y)},dpara:function(e,t,r){var i,n,a;return i=t.x-e.x,n=t.y-e.y,a=r.x-e.x,i*(r.y-e.y)-a*n},cprod:Rf,iprod:function(e,t,r){var i,n;return i=t.x-e.x,n=t.y-e.y,i*(r.x-e.x)+n*(r.y-e.y)},iprod1:function(e,t,r,i){var n,a;return n=t.x-e.x,a=t.y-e.y,n*(i.x-r.x)+a*(i.y-r.y)},ddist:function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}};function Hf(){if(Bf)return Df;Bf=1;var e=zf,t=null;try{t=Tf}catch(c){}var r=Gf(),i=256,n=i-1;function a(e,t){return i*e+t}function s(t,r){if((t="number"==typeof t?e.clamp(Math.round(t),0,n):0)>(r="number"==typeof r?e.clamp(Math.round(r),0,n):n))throw new Error('Invalid range "'+t+"..."+r+'"');return[t,r]}function o(e,i){if(this.data=null,this.pixels=0,this._sortedIndexes=null,this._cachedStats={},this._lookupTableH=null,"number"==typeof e)this._createArray(e);else if(e instanceof r)this._collectValuesBitmap(e);else{if(!(t&&e instanceof t))throw new Error("Unsupported image source");this._collectValuesJimp(e,i)}}return o.MODE_LUMINANCE="luminance",o.MODE_R="r",o.MODE_G="g",o.MODE_B="b",o.prototype={_createArray:function(e){var t=e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:Uint32Array;return this.pixels=e,this.data=new t(i)},_collectValuesJimp:function(t,r){var i=t.bitmap.data,n=this._createArray(t.bitmap.width*t.bitmap.height);t.scan(0,0,t.bitmap.width,t.bitmap.height,(function(t,a,s){var c=r===o.MODE_R?i[s]:r===o.MODE_G?i[s+1]:r===o.MODE_B?i[s+2]:e.luminance(i[s],i[s+1],i[s+2]);n[c]++}))},_collectValuesBitmap:function(e){for(var t=this._createArray(e.size),r=e.data.length,i=0;i<r;i++)t[e.data[i]]++},_getSortedIndexes:function(e){if(!e&&this._sortedIndexes)return this._sortedIndexes;for(var t=this.data,r=new Array(i),n=0;n<i;n++)r[n]=n;return r.sort((function(e,r){return t[e]>t[r]?1:t[e]<t[r]?-1:0})),this._sortedIndexes=r,r},_thresholdingBuildLookupTable:function(){var e,t,r,n,s=new Float64Array(i*i),o=new Float64Array(i*i),c=new Float64Array(i*i),l=this.pixels;for(e=1;e<i;++e)r=a(e,e),n=this.data[e]/l,s[r]=n,o[r]=e*n;for(e=1;e<i-1;++e)n=this.data[e+1]/l,s[(r=a(1,e))+1]=s[r]+n,o[r+1]=o[r]+(e+1)*n;for(e=2;e<i;e++)for(t=e+1;t<i;t++)s[a(e,t)]=s[a(1,t)]-s[a(1,e-1)],o[a(e,t)]=o[a(1,t)]-o[a(1,e-1)];for(e=1;e<i;++e)for(t=e+1;t<i;t++)c[r=a(e,t)]=0!==s[r]?o[r]*o[r]/s[r]:0;return this._lookupTableH=c},multilevelThresholding:function(e,t,r){if(t=s(t,r),r=t[1],t=t[0],(e=Math.min(r-t-2,~~e))<1)return[];this._lookupTableH||this._thresholdingBuildLookupTable();var i=this._lookupTableH,n=null,o=0;return e>4&&console.log("[Warning]: Threshold computation for more than 5 levels may take a long time"),function t(s,c,l,u){s=(s||0)+1,c=c||0,l=l||new Array(e);for(var h,f=(u=u||0)+1,d=s;d<r-e+u;d++)h=c+i[a(s,d)],l[f-1]=d,f+1<e+1?t(d,h,l,f):(h+=i[a(d+1,r)],o<h&&(o=h,n=l.slice()))}(t||0),n||[]},autoThreshold:function(e,t){var r=this.multilevelThresholding(1,e,t);return r.length?r[0]:null},getDominantColor:function(t,r,i){r=(t=s(t,r))[1],t=t[0],i=i||1;var a,o,c,l=this.data,u=-1,h=-1;if(t===r)return l[t]?t:-1;for(a=t;a<=r;a++){for(c=0,o=~~(i/-2);o<i;o++)c+=e.between(a+o,0,n)?l[a+o]:0;var f=c>h,d=h===c&&(u<0||l[a]>l[u]);(f||d)&&(u=a,h=c)}return h<=0?-1:u},getStats:function(e,t,r){if(t=(e=s(e,t))[1],e=e[0],!r&&this._cachedStats[e+"-"+t])return this._cachedStats[e+"-"+t];var n,a,o,c,l,u,h,f=this.data,d=this._getSortedIndexes(),p=0,m=null,b=0,v=0,g=0,y=0,_=0;for(l=e;l<=t;l++)p+=f[l],g+=f[l]*l,y+=0===f[l]?0:1,_<f[l]&&(_=f[l]);for(n=g/p,o=p/(t-e),c=p/y,a=Math.floor(p/2),l=0;l<i;l++)u=f[h=d[l]],h<e||h>t||(v+=u,b+=Math.pow(h-n,2)*u,null===m&&v>=a&&(m=h));return this._cachedStats[e+"-"+t]={levels:{mean:n,median:m,stdDev:Math.sqrt(b/p),unique:y},pixelsPerLevel:{mean:o,median:c,peak:_},pixels:p}}},Df=o}function Gf(){if(Nf)return Ff;Nf=1;var e=Of,t=zf;function r(e,t){this._histogram=null,this.width=e,this.height=t,this.size=e*t,this.arrayBuffer=new ArrayBuffer(this.size),this.data=new Uint8Array(this.arrayBuffer)}return Ff=r,Hf(),r.prototype={getValueAt:function(e,t){var r="number"==typeof e&&"number"!=typeof t?e:this.pointToIndex(e,t);return this.data[r]},indexToPoint:function(r){var i=new e;return t.between(r,0,this.size)?(i.y=Math.floor(r/this.width),i.x=r-i.y*this.width):(i.x=-1,i.y=-1),i},pointToIndex:function(r,i){var n=r,a=i;return r instanceof e&&(n=r.x,a=r.y),t.between(n,0,this.width)&&t.between(a,0,this.height)?this.width*a+n:-1},copy:function(e){var t,i=new r(this.width,this.height),n="function"==typeof e;for(t=0;t<this.size;t++)i.data[t]=n?e(this.data[t],t):this.data[t];return i},histogram:function(){var e=Hf();return this._histogram||(this._histogram=new e(this)),this._histogram}},Ff}var Wf=function(e){this.n=e,this.tag=new Array(e),this.c=new Array(3*e),this.alphaCurve=0,this.vertex=new Array(e),this.alpha=new Array(e),this.alpha0=new Array(e),this.beta=new Array(e)};var Yf=function(){this.area=0,this.len=0,this.curve={},this.pt=[],this.minX=1e5,this.minY=1e5,this.maxX=-1,this.maxY=-1};function Xf(){this.data=[0,0,0,0,0,0,0,0,0]}Xf.prototype.at=function(e,t){return this.data[3*e+t]};var Vf=Xf;var qf=function(e,t,r,i,n){this.x=e,this.y=t,this.xy=r,this.x2=i,this.y2=n},Zf=Of;var Kf=function(){this.pen=0,this.c=[new Zf,new Zf],this.t=0,this.s=0,this.alpha=0},Jf=Tf,Qf=Gf(),$f=Wf,ed=Of,td=Yf,rd=Vf,id=qf,nd=Kf,ad=zf;function sd(e){this._luminanceData=null,this._pathlist=[],this._imageLoadingIdentifier=null,this._imageLoaded=!1,this._processed=!1,this._params={turnPolicy:sd.TURNPOLICY_MINORITY,turdSize:2,alphaMax:1,optCurve:!0,optTolerance:.2,threshold:sd.THRESHOLD_AUTO,blackOnWhite:!0,color:sd.COLOR_AUTO,background:sd.COLOR_TRANSPARENT,width:null,height:null},e&&this.setParameters(e)}sd.COLOR_AUTO="auto",sd.COLOR_TRANSPARENT="transparent",sd.THRESHOLD_AUTO=-1,sd.TURNPOLICY_BLACK="black",sd.TURNPOLICY_WHITE="white",sd.TURNPOLICY_LEFT="left",sd.TURNPOLICY_RIGHT="right",sd.TURNPOLICY_MINORITY="minority",sd.TURNPOLICY_MAJORITY="majority";var od=[sd.TURNPOLICY_BLACK,sd.TURNPOLICY_WHITE,sd.TURNPOLICY_LEFT,sd.TURNPOLICY_RIGHT,sd.TURNPOLICY_MINORITY,sd.TURNPOLICY_MAJORITY];sd.prototype={_bmToPathlist:function(){var e,t,r=this,i=this._params.threshold,n=this._params.blackOnWhite,a=new ed(0,0);function s(t){for(var r=e.pointToIndex(t);r<e.size&&1!==e.data[r];)r++;return r<e.size&&e.indexToPoint(r)}function o(t,r){var i,n,a;for(i=2;i<5;i++){for(a=0,n=1-i;n<=i-1;n++)a+=e.getValueAt(t+n,r+i-1)?1:-1,a+=e.getValueAt(t+i-1,r+n-1)?1:-1,a+=e.getValueAt(t+n-1,r-i)?1:-1,a+=e.getValueAt(t-i,r+n)?1:-1;if(a>0)return 1;if(a<0)return 0}return 0}function c(t){var i,n=new td,a=t.x,s=t.y,c=0,l=1;for(n.sign=e.getValueAt(t.x,t.y)?"+":"-";n.pt.push(new ed(a,s)),a>n.maxX&&(n.maxX=a),a<n.minX&&(n.minX=a),s>n.maxY&&(n.maxY=s),s<n.minY&&(n.minY=s),n.len++,a+=c,s+=l,n.area-=a*l,a!==t.x||s!==t.y;){var u=e.getValueAt(a+(c+l-1)/2,s+(l-c-1)/2),h=e.getValueAt(a+(c-l-1)/2,s+(l+c-1)/2);h&&!u?"right"===r._params.turnPolicy||"black"===r._params.turnPolicy&&"+"===n.sign||"white"===r._params.turnPolicy&&"-"===n.sign||"majority"===r._params.turnPolicy&&o(a,s)||"minority"===r._params.turnPolicy&&!o(a,s)?(i=c,c=-l,l=i):(i=c,c=l,l=-i):h?(i=c,c=-l,l=i):u||(i=c,c=l,l=-i)}return n}function l(t){var r,i,n,a,s,o,c,l=t.pt[0].y,u=t.len;for(s=1;s<u;s++)if(r=t.pt[s].x,(i=t.pt[s].y)!==l){for(a=l<i?l:i,n=t.maxX,o=r;o<n;o++)c=e.pointToIndex(o,a),e.data[c]=e.data[c]?0:1;l=i}}for(i===sd.THRESHOLD_AUTO&&(i=this._luminanceData.histogram().autoThreshold()||128),e=this._luminanceData.copy((function(e){return(n?e>i:e<i)?0:1})),this._pathlist=[];a=s(a);)l(t=c(a)),t.area>r._params.turdSize&&this._pathlist.push(t)},_processPath:function(){var e=this;function t(e){var t,r,i;e.x0=e.pt[0].x,e.y0=e.pt[0].y,e.sums=[];var n=e.sums;for(n.push(new id(0,0,0,0,0)),t=0;t<e.len;t++)r=e.pt[t].x-e.x0,i=e.pt[t].y-e.y0,n.push(new id(n[t].x+r,n[t].y+i,n[t].xy+r*i,n[t].x2+r*r,n[t].y2+i*i))}function r(e){var t=e.len,r=e.pt,i=new Array(t),n=new Array(t),a=new Array(4);e.lon=new Array(t);var s,o,c,l,u,h,f,d,p=[new ed,new ed],m=new ed,b=new ed,v=new ed,g=0;for(o=t-1;o>=0;o--)r[o].x!=r[g].x&&r[o].y!=r[g].y&&(g=o+1),n[o]=g;for(o=t-1;o>=0;o--){for(a[0]=a[1]=a[2]=a[3]=0,a[(3+3*(r[ad.mod(o+1,t)].x-r[o].x)+(r[ad.mod(o+1,t)].y-r[o].y))/2]++,p[0].x=0,p[0].y=0,p[1].x=0,p[1].y=0,g=n[o],l=o;;){if(s=0,a[(3+3*ad.sign(r[g].x-r[l].x)+ad.sign(r[g].y-r[l].y))/2]++,a[0]&&a[1]&&a[2]&&a[3]){i[o]=l,s=1;break}if(m.x=r[g].x-r[o].x,m.y=r[g].y-r[o].y,ad.xprod(p[0],m)<0||ad.xprod(p[1],m)>0)break;if(Math.abs(m.x)<=1&&Math.abs(m.y)<=1||(b.x=m.x+(m.y>=0&&(m.y>0||m.x<0)?1:-1),b.y=m.y+(m.x<=0&&(m.x<0||m.y<0)?1:-1),ad.xprod(p[0],b)>=0&&(p[0].x=b.x,p[0].y=b.y),b.x=m.x+(m.y<=0&&(m.y<0||m.x<0)?1:-1),b.y=m.y+(m.x>=0&&(m.x>0||m.y<0)?1:-1),ad.xprod(p[1],b)<=0&&(p[1].x=b.x,p[1].y=b.y)),g=n[l=g],!ad.cyclic(g,o,l))break}0===s&&(v.x=ad.sign(r[g].x-r[l].x),v.y=ad.sign(r[g].y-r[l].y),m.x=r[l].x-r[o].x,m.y=r[l].y-r[o].y,u=ad.xprod(p[0],m),h=ad.xprod(p[0],v),f=ad.xprod(p[1],m),d=ad.xprod(p[1],v),c=1e7,h<0&&(c=Math.floor(u/-h)),d>0&&(c=Math.min(c,Math.floor(-f/d))),i[o]=ad.mod(l+c,t))}for(c=i[t-1],e.lon[t-1]=c,o=t-2;o>=0;o--)ad.cyclic(o+1,i[o],c)&&(c=i[o]),e.lon[o]=c;for(o=t-1;ad.cyclic(ad.mod(o+1,t),c,e.lon[o]);o--)e.lon[o]=c}function i(e){function t(e,t,r){var i,n,a,s,o,c,l,u,h,f,d,p=e.len,m=e.pt,b=e.sums,v=0;return r>=p&&(r-=p,v=1),0===v?(i=b[r+1].x-b[t].x,n=b[r+1].y-b[t].y,s=b[r+1].x2-b[t].x2,a=b[r+1].xy-b[t].xy,o=b[r+1].y2-b[t].y2,c=r+1-t):(i=b[r+1].x-b[t].x+b[p].x,n=b[r+1].y-b[t].y+b[p].y,s=b[r+1].x2-b[t].x2+b[p].x2,a=b[r+1].xy-b[t].xy+b[p].xy,o=b[r+1].y2-b[t].y2+b[p].y2,c=r+1-t+p),u=(m[t].x+m[r].x)/2-m[0].x,h=(m[t].y+m[r].y)/2-m[0].y,d=m[r].x-m[t].x,l=(f=-(m[r].y-m[t].y))*f*((s-2*i*u)/c+u*u)+2*f*d*((a-i*h-n*u)/c+u*h)+d*d*((o-2*n*h)/c+h*h),Math.sqrt(l)}var r,i,n,a,s,o,c,l=e.len,u=new Array(l+1),h=new Array(l+1),f=new Array(l),d=new Array(l+1),p=new Array(l+1),m=new Array(l+1);for(r=0;r<l;r++)(c=ad.mod(e.lon[ad.mod(r-1,l)]-1,l))==r&&(c=ad.mod(r+1,l)),f[r]=c<r?l:c;for(i=1,r=0;r<l;r++)for(;i<=f[r];)d[i]=r,i++;for(r=0,i=0;r<l;i++)p[i]=r,r=f[r];for(p[i]=l,r=l,i=n=i;i>0;i--)m[i]=r,r=d[r];for(m[0]=0,u[0]=0,i=1;i<=n;i++)for(r=m[i];r<=p[i];r++){for(o=-1,a=p[i-1];a>=d[r];a--)s=t(e,a,r)+u[a],(o<0||s<o)&&(h[r]=a,o=s);u[r]=o}for(e.m=n,e.po=new Array(n),r=l,i=n-1;r>0;i--)r=h[r],e.po[i]=r}function n(e){function t(e,t,r,i,n){for(var a,s,o,c,l,u,h,f,d,p,m,b=e.len,v=e.sums,g=0;r>=b;)r-=b,g+=1;for(;t>=b;)t-=b,g-=1;for(;r<0;)r+=b,g-=1;for(;t<0;)t+=b,g+=1;a=v[r+1].x-v[t].x+g*v[b].x,s=v[r+1].y-v[t].y+g*v[b].y,o=v[r+1].x2-v[t].x2+g*v[b].x2,c=v[r+1].xy-v[t].xy+g*v[b].xy,l=v[r+1].y2-v[t].y2+g*v[b].y2,u=r+1-t+g*b,i.x=a/u,i.y=s/u,h=(o-a*a/u)/u,f=(c-a*s/u)/u,h-=p=(h+(d=(l-s*s/u)/u)+Math.sqrt((h-d)*(h-d)+4*f*f))/2,d-=p,Math.abs(h)>=Math.abs(d)?0!==(m=Math.sqrt(h*h+f*f))&&(n.x=-f/m,n.y=h/m):0!==(m=Math.sqrt(d*d+f*f))&&(n.x=-d/m,n.y=f/m),0===m&&(n.x=n.y=0)}var r,i,n,a,s,o,c,l,u,h,f,d,p,m,b,v=e.m,g=e.po,y=e.len,_=e.pt,w=e.x0,x=e.y0,k=new Array(v),S=new Array(v),C=new Array(v),U=new Array(3),E=new ed;for(e.curve=new $f(v),i=0;i<v;i++)n=g[ad.mod(i+1,v)],n=ad.mod(n-g[i],y)+g[i],k[i]=new ed,S[i]=new ed,t(e,g[i],n,k[i],S[i]);for(i=0;i<v;i++)if(C[i]=new rd,0===(r=S[i].x*S[i].x+S[i].y*S[i].y))for(n=0;n<3;n++)for(a=0;a<3;a++)C[i].data[3*n+a]=0;else for(U[0]=S[i].y,U[1]=-S[i].x,U[2]=-U[1]*k[i].y-U[0]*k[i].x,s=0;s<3;s++)for(a=0;a<3;a++)C[i].data[3*s+a]=U[s]*U[a]/r;for(i=0;i<v;i++){for(o=new rd,c=new ed,E.x=_[g[i]].x-w,E.y=_[g[i]].y-x,n=ad.mod(i-1,v),s=0;s<3;s++)for(a=0;a<3;a++)o.data[3*s+a]=C[n].at(s,a)+C[i].at(s,a);for(;;){if(0!==(h=o.at(0,0)*o.at(1,1)-o.at(0,1)*o.at(1,0))){c.x=(-o.at(0,2)*o.at(1,1)+o.at(1,2)*o.at(0,1))/h,c.y=(o.at(0,2)*o.at(1,0)-o.at(1,2)*o.at(0,0))/h;break}for(o.at(0,0)>o.at(1,1)?(U[0]=-o.at(0,1),U[1]=o.at(0,0)):o.at(1,1)?(U[0]=-o.at(1,1),U[1]=o.at(1,0)):(U[0]=1,U[1]=0),r=U[0]*U[0]+U[1]*U[1],U[2]=-U[1]*E.y-U[0]*E.x,s=0;s<3;s++)for(a=0;a<3;a++)o.data[3*s+a]+=U[s]*U[a]/r}if(l=Math.abs(c.x-E.x),u=Math.abs(c.y-E.y),l<=.5&&u<=.5)e.curve.vertex[i]=new ed(c.x+w,c.y+x);else{if(f=ad.quadform(o,E),p=E.x,m=E.y,0!==o.at(0,0))for(b=0;b<2;b++)c.y=E.y-.5+b,c.x=-(o.at(0,1)*c.y+o.at(0,2))/o.at(0,0),l=Math.abs(c.x-E.x),d=ad.quadform(o,c),l<=.5&&d<f&&(f=d,p=c.x,m=c.y);if(0!==o.at(1,1))for(b=0;b<2;b++)c.x=E.x-.5+b,c.y=-(o.at(1,0)*c.x+o.at(1,2))/o.at(1,1),u=Math.abs(c.y-E.y),d=ad.quadform(o,c),u<=.5&&d<f&&(f=d,p=c.x,m=c.y);for(s=0;s<2;s++)for(a=0;a<2;a++)c.x=E.x-.5+s,c.y=E.y-.5+a,(d=ad.quadform(o,c))<f&&(f=d,p=c.x,m=c.y);e.curve.vertex[i]=new ed(p+w,m+x)}}}function a(e){var t,r,i,n=e.curve,a=n.n,s=n.vertex;for(t=0,r=a-1;t<r;t++,r--)i=s[t],s[t]=s[r],s[r]=i}function s(t){var r,i,n,a,s,o,c,l,u,h=t.curve.n,f=t.curve;for(r=0;r<h;r++)i=ad.mod(r+1,h),n=ad.mod(r+2,h),u=ad.interval(.5,f.vertex[n],f.vertex[i]),0!==(s=ad.ddenom(f.vertex[r],f.vertex[n]))?(a=ad.dpara(f.vertex[r],f.vertex[i],f.vertex[n])/s,o=(a=Math.abs(a))>1?1-1/a:0,o/=.75):o=4/3,f.alpha0[i]=o,o>=e._params.alphaMax?(f.tag[i]="CORNER",f.c[3*i+1]=f.vertex[i],f.c[3*i+2]=u):(o<.55?o=.55:o>1&&(o=1),c=ad.interval(.5+.5*o,f.vertex[r],f.vertex[i]),l=ad.interval(.5+.5*o,f.vertex[n],f.vertex[i]),f.tag[i]="CURVE",f.c[3*i+0]=c,f.c[3*i+1]=l,f.c[3*i+2]=u),f.alpha[i]=o,f.beta[i]=.5;f.alphaCurve=1}function o(t){function r(e,t,r,i,n,a,s){var o,c,l,u,h,f,d,p,m,b,v,g,y,_,w,x,k,S,C,U,E,T,M=e.curve.n,O=e.curve,P=O.vertex;if(t==r)return 1;if(o=t,h=ad.mod(t+1,M),0===(u=a[c=ad.mod(o+1,M)]))return 1;for(p=ad.ddist(P[t],P[h]),o=c;o!=r;o=c){if(c=ad.mod(o+1,M),l=ad.mod(o+2,M),a[c]!=u)return 1;if(ad.sign(ad.cprod(P[t],P[h],P[c],P[l]))!=u)return 1;if(ad.iprod1(P[t],P[h],P[c],P[l])<p*ad.ddist(P[c],P[l])*-.999847695156)return 1}if(v=O.c[3*ad.mod(t,M)+2].copy(),g=P[ad.mod(t+1,M)].copy(),y=P[ad.mod(r,M)].copy(),_=O.c[3*ad.mod(r,M)+2].copy(),f=s[r]-s[t],f-=ad.dpara(P[0],O.c[3*t+2],O.c[3*r+2])/2,t>=r&&(f+=s[M]),S=ad.dpara(v,g,y),C=ad.dpara(v,g,_),U=ad.dpara(v,y,_),C==S)return 1;if(E=C/(C-S),0===(x=C*(T=U/(U-(S+U-C)))/2))return 1;for(k=f/x,d=2-Math.sqrt(4-k/.3),i.c[0]=ad.interval(T*d,v,g),i.c[1]=ad.interval(E*d,_,y),i.alpha=d,i.t=T,i.s=E,g=i.c[0].copy(),y=i.c[1].copy(),i.pen=0,o=ad.mod(t+1,M);o!=r;o=c){if(c=ad.mod(o+1,M),(T=ad.tangent(v,g,y,_,P[o],P[c]))<-.5)return 1;if(w=ad.bezier(T,v,g,y,_),0===(p=ad.ddist(P[o],P[c])))return 1;if(m=ad.dpara(P[o],P[c],w)/p,Math.abs(m)>n)return 1;if(ad.iprod(P[o],P[c],w)<0||ad.iprod(P[c],P[o],w)<0)return 1;i.pen+=m*m}for(o=t;o!=r;o=c){if(c=ad.mod(o+1,M),(T=ad.tangent(v,g,y,_,O.c[3*o+2],O.c[3*c+2]))<-.5)return 1;if(w=ad.bezier(T,v,g,y,_),0===(p=ad.ddist(O.c[3*o+2],O.c[3*c+2])))return 1;if(m=ad.dpara(O.c[3*o+2],O.c[3*c+2],w)/p,b=ad.dpara(O.c[3*o+2],O.c[3*c+2],P[c])/p,(b*=.75*O.alpha[c])<0&&(m=-m,b=-b),m<b-n)return 1;m<b&&(i.pen+=(m-b)*(m-b))}return 0}var i,n,a,s,o,c,l,u,h,f,d=t.curve,p=d.n,m=d.vertex,b=new Array(p+1),v=new Array(p+1),g=new Array(p+1),y=new Array(p+1),_=new nd,w=new Array(p),x=new Array(p+1);for(n=0;n<p;n++)"CURVE"==d.tag[n]?w[n]=ad.sign(ad.dpara(m[ad.mod(n-1,p)],m[n],m[ad.mod(n+1,p)])):w[n]=0;for(c=0,x[0]=0,s=d.vertex[0],n=0;n<p;n++)o=ad.mod(n+1,p),"CURVE"==d.tag[o]&&(c+=.3*(l=d.alpha[o])*(4-l)*ad.dpara(d.c[3*n+2],m[o],d.c[3*o+2])/2,c+=ad.dpara(s,d.c[3*n+2],d.c[3*o+2])/2),x[n+1]=c;for(b[0]=-1,v[0]=0,g[0]=0,a=1;a<=p;a++)for(b[a]=a-1,v[a]=v[a-1],g[a]=g[a-1]+1,n=a-2;n>=0&&!r(t,n,ad.mod(a,p),_,e._params.optTolerance,w,x);n--)(g[a]>g[n]+1||g[a]==g[n]+1&&v[a]>v[n]+_.pen)&&(b[a]=n,v[a]=v[n]+_.pen,g[a]=g[n]+1,y[a]=_,_=new nd);for(i=g[p],u=new $f(i),h=new Array(i),f=new Array(i),a=p,n=i-1;n>=0;n--)b[a]==a-1?(u.tag[n]=d.tag[ad.mod(a,p)],u.c[3*n+0]=d.c[3*ad.mod(a,p)+0],u.c[3*n+1]=d.c[3*ad.mod(a,p)+1],u.c[3*n+2]=d.c[3*ad.mod(a,p)+2],u.vertex[n]=d.vertex[ad.mod(a,p)],u.alpha[n]=d.alpha[ad.mod(a,p)],u.alpha0[n]=d.alpha0[ad.mod(a,p)],u.beta[n]=d.beta[ad.mod(a,p)],h[n]=f[n]=1):(u.tag[n]="CURVE",u.c[3*n+0]=y[a].c[0],u.c[3*n+1]=y[a].c[1],u.c[3*n+2]=d.c[3*ad.mod(a,p)+2],u.vertex[n]=ad.interval(y[a].s,d.c[3*ad.mod(a,p)+2],m[ad.mod(a,p)]),u.alpha[n]=y[a].alpha,u.alpha0[n]=y[a].alpha,h[n]=y[a].s,f[n]=y[a].t),a=b[a];for(n=0;n<i;n++)o=ad.mod(n+1,i),u.beta[n]=h[n]/(h[n]+f[o]);u.alphaCurve=1,t.curve=u}for(var c=0;c<this._pathlist.length;c++){var l=this._pathlist[c];t(l),r(l),i(l),n(l),"-"===l.sign&&a(l),s(l),e._params.optCurve&&o(l)}},_validateParameters:function(e){if(e&&e.turnPolicy&&-1===od.indexOf(e.turnPolicy)){var t="'"+od.join("', '")+"'";throw new Error("Bad turnPolicy value. Allowed values are: "+t)}if(e&&null!=e.threshold&&e.threshold!==sd.THRESHOLD_AUTO&&("number"!=typeof e.threshold||!ad.between(e.threshold,0,255)))throw new Error("Bad threshold value. Expected to be an integer in range 0..255");if(e&&null!=e.optCurve&&"boolean"!=typeof e.optCurve)throw new Error("'optCurve' must be Boolean")},_processLoadedImage:function(e){var t=new Qf(e.bitmap.width,e.bitmap.height),r=e.bitmap.data;e.scan(0,0,e.bitmap.width,e.bitmap.height,(function(e,i,n){var a=r[n+3]/255,s=255+(r[n+0]-255)*a,o=255+(r[n+1]-255)*a,c=255+(r[n+2]-255)*a;t.data[n/4]=ad.luminance(s,o,c)})),this._luminanceData=t,this._imageLoaded=!0},loadImage:function(e,t){var r=this,i={};this._imageLoadingIdentifier=i,this._imageLoaded=!1,e instanceof Jf?(this._imageLoadingIdentifier=null,this._imageLoaded=!0,r._processLoadedImage(e),t.call(r,null)):Jf.read(e,(function(e,n){if(r._imageLoadingIdentifier!==i){var a=e||new Error("Another image was loaded instead");return t.call(r,a)}r._imageLoadingIdentifier=null,r._processLoadedImage(n),t.call(r,null)}))},setParameters:function(e){var t,r;for(t in this._validateParameters(e),this._params)this._params.hasOwnProperty(t)&&e.hasOwnProperty(t)&&(r=this._params[t],this._params[t]=e[t],r!==this._params[t]&&-1===["color","background"].indexOf(t)&&(this._processed=!1))},getPathTag:function(e,t){if((e=0===arguments.length?this._params.color:e)===sd.COLOR_AUTO&&(e=this._params.blackOnWhite?"black":"white"),!this._imageLoaded)throw new Error("Image should be loaded first");this._processed||(this._bmToPathlist(),this._processPath(),this._processed=!0);var r='<path d="';return r+=this._pathlist.map((function(e){return ad.renderCurve(e.curve,t)})).join(" "),r+='" stroke="none" fill="'+e+'" fill-rule="evenodd"/>'},getSymbol:function(e){return'<symbol viewBox="0 0 '+this._luminanceData.width+" "+this._luminanceData.height+'" id="'+e+'">'+this.getPathTag("")+"</symbol>"},getSVG:function(){var e=this._params.width||this._luminanceData.width,t=this._params.height||this._luminanceData.height,r={x:this._params.width?this._params.width/this._luminanceData.width:1,y:this._params.height?this._params.height/this._luminanceData.height:1};return'<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+t+'" viewBox="0 0 '+e+" "+t+'" version="1.1">\n'+(this._params.background!==sd.COLOR_TRANSPARENT?'\t<rect x="0" y="0" width="100%" height="100%" fill="'+this._params.background+'" />\n':"")+"\t"+this.getPathTag(this._params.color,r)+"\n</svg>"}};var cd=sd,ld=cd,ud=zf;function hd(e){this._potrace=new ld,this._calculatedThreshold=null,this._params={threshold:ld.THRESHOLD_AUTO,blackOnWhite:!0,steps:hd.STEPS_AUTO,background:ld.COLOR_TRANSPARENT,fillStrategy:hd.FILL_DOMINANT,rangeDistribution:hd.RANGES_AUTO},e&&this.setParameters(e)}for(var fd in ld)Object.prototype.hasOwnProperty.call(ld,fd)&&fd===fd.toUpperCase()&&(hd[fd]=ld[fd]);hd.STEPS_AUTO=-1,hd.FILL_SPREAD="spread",hd.FILL_DOMINANT="dominant",hd.FILL_MEDIAN="median",hd.FILL_MEAN="mean",hd.RANGES_AUTO="auto",hd.RANGES_EQUAL="equal",hd.prototype={_addExtraColorStop:function(e){var t=this._params.blackOnWhite,r=e[e.length-1],i=t?0:r.value,n=t?r.value:255;if(n-i>25&&1!==r.colorIntensity){var a=this._getImageHistogram(),s=a.getStats(i,n).levels,o=s.mean+s.stdDev<=25?s.mean+s.stdDev:s.mean-s.stdDev<=25?s.mean-s.stdDev:25,c=(t?a.getStats(0,o):a.getStats(o,255)).levels.mean;e.push({value:Math.abs((t?0:255)-o),colorIntensity:isNaN(c)?0:(t?255-c:c)/255})}return e},_calcColorIntensity:function(e){var t=this._params.blackOnWhite,r=this._params.fillStrategy,i=r!==hd.FILL_SPREAD?this._getImageHistogram():null,n=Math.abs(this._paramThreshold()-(t?0:255));return e.map((function(a,s){var o=s+1===e.length?t?-1:256:e[s+1],c=Math.round(t?o+1:a),l=Math.round(t?a:o-1),u=s/(e.length-1),h=l-c,f=i.getStats(c,l),d=-1;if(0===f.pixels)return{value:a,colorIntensity:0};switch(r){case hd.FILL_SPREAD:d=(t?c:l)+(t?1:-1)*h*Math.max(.5,n/255)*u;break;case hd.FILL_DOMINANT:d=i.getDominantColor(c,l,ud.clamp(h,1,5));break;case hd.FILL_MEAN:d=f.levels.mean;break;case hd.FILL_MEDIAN:d=f.levels.median}return 0!==s&&(d=t?ud.clamp(d,c,l-Math.round(.1*h)):ud.clamp(d,c+Math.round(.1*h),l)),{value:a,colorIntensity:-1===d?0:(t?255-d:d)/255}}))},_getImageHistogram:function(){return this._potrace._luminanceData.histogram()},_getRanges:function(){var e=this._paramSteps();if(!Array.isArray(e))return this._params.rangeDistribution===hd.RANGES_AUTO?this._getRangesAuto():this._getRangesEquallyDistributed();var t=[],r=this._paramThreshold(),i=this._params.blackOnWhite;return e.forEach((function(e){-1===t.indexOf(e)&&ud.between(e,0,255)&&t.push(e)})),t.length||t.push(r),t=t.sort((function(e,t){return e<t===i?1:-1})),i&&t[0]<r?t.unshift(r):!i&&t[t.length-1]<r&&t.push(r),this._calcColorIntensity(t)},_getRangesAuto:function(){var e,t=this._getImageHistogram(),r=this._paramSteps(!0);if(this._params.threshold===ld.THRESHOLD_AUTO)e=t.multilevelThresholding(r);else{var i=this._paramThreshold();e=this._params.blackOnWhite?t.multilevelThresholding(r-1,0,i):t.multilevelThresholding(r-1,i,255),this._params.blackOnWhite?e.push(i):e.unshift(i)}return this._params.blackOnWhite&&(e=e.reverse()),this._calcColorIntensity(e)},_getRangesEquallyDistributed:function(){for(var e,t=this._params.blackOnWhite,r=t?this._paramThreshold():255-this._paramThreshold(),i=this._paramSteps(),n=r/i,a=[],s=i-1;s>=0;)e=Math.min(r,(s+1)*n),e=t?e:255-e,s--,a.push(e);return this._calcColorIntensity(a)},_paramSteps:function(e){var t=this._params.steps;if(Array.isArray(t))return e?t.length:t;if(t===hd.STEPS_AUTO&&this._params.threshold===ld.THRESHOLD_AUTO)return 4;var r=this._params.blackOnWhite?this._paramThreshold():255-this._paramThreshold();return t===hd.STEPS_AUTO?r>200?4:3:Math.min(r,Math.max(2,t))},_paramThreshold:function(){if(null!==this._calculatedThreshold)return this._calculatedThreshold;if(this._params.threshold!==ld.THRESHOLD_AUTO)return this._calculatedThreshold=this._params.threshold,this._calculatedThreshold;var e=this._getImageHistogram().multilevelThresholding(2);return this._calculatedThreshold=this._params.blackOnWhite?e[1]:e[0],this._calculatedThreshold=this._calculatedThreshold||128,this._calculatedThreshold},_pathTags:function(e){var t=this._getRanges(),r=this._potrace,i=this._params.blackOnWhite;t.length>=10&&(t=this._addExtraColorStop(t)),r.setParameters({blackOnWhite:i});var n=0;return t.map((function(t){var i=t.colorIntensity;if(0===i)return"";var a=n&&1!==i?(n-i)/(n-1):i;a=ud.clamp(parseFloat(a.toFixed(3)),0,1),n+=(1-n)*a,r.setParameters({threshold:t.value});var s=e?r.getPathTag(""):r.getPathTag();return s=ud.setHtmlAttr(s,"fill-opacity",a.toFixed(3)),0===a||-1!==s.indexOf(' d=""')?"":s}))},loadImage:function(e,t){var r=this;this._potrace.loadImage(e,(function(e){r._calculatedThreshold=null,t.call(r,e)}))},setParameters:function(e){if(e){if(this._potrace.setParameters(e),e.steps&&!Array.isArray(e.steps)&&(!ud.isNumber(e.steps)||!ud.between(e.steps,1,255)))throw new Error("Bad 'steps' value");for(var t in this._params)this._params.hasOwnProperty(t)&&e.hasOwnProperty(t)&&(this._params[t]=e[t]);this._calculatedThreshold=null}},getSymbol:function(e){return'<symbol viewBox="0 0 '+this._potrace._luminanceData.width+" "+this._potrace._luminanceData.height+'" id="'+e+'">'+this._pathTags(!0).join("")+"</symbol>"},getSVG:function(){var e=this._potrace._luminanceData.width,t=this._potrace._luminanceData.height,r=this._pathTags(!1);return('<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+t+'" viewBox="0 0 '+e+" "+t+'" version="1.1">\n\t'+(this._params.background!==ld.COLOR_TRANSPARENT?'<rect x="0" y="0" width="100%" height="100%" fill="'+this._params.background+'" />\n\t':"")+r.join("\n\t")+"\n</svg>").replace(/\n(?:\t*\n)+(\t*)/g,"\n$1")}};var dd=cd,pd=hd;var md={trace:function(e,t,r){2===arguments.length&&(r=t,t={});var i=new dd(t);i.loadImage(e,(function(e){if(e)return r(e);r(null,i.getSVG(),i)}))},posterize:function(e,t,r){2===arguments.length&&(r=t,t={});var i=new pd(t);i.loadImage(e,(function(e){if(e)return r(e);r(null,i.getSVG(),i)}))},Potrace:dd,Posterizer:pd},bd=_e(md),vd={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},gd=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function yd(e){return e>=48&&e<=57}function _d(e){return e>=48&&e<=57||43===e||45===e||46===e}function wd(e){this.index=0,this.path=e,this.max=e.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function xd(e){for(;e.index<e.max&&(10===(t=e.path.charCodeAt(e.index))||13===t||8232===t||8233===t||32===t||9===t||11===t||12===t||160===t||t>=5760&&gd.indexOf(t)>=0);)e.index++;var t}function kd(e){var t=e.path.charCodeAt(e.index);return 48===t?(e.param=0,void e.index++):49===t?(e.param=1,void e.index++):void(e.err="SvgPath: arc flag can be 0 or 1 only (at pos "+e.index+")")}function Sd(e){var t,r=e.index,i=r,n=e.max,a=!1,s=!1,o=!1,c=!1;if(i>=n)e.err="SvgPath: missed param (at pos "+i+")";else if(43!==(t=e.path.charCodeAt(i))&&45!==t||(t=++i<n?e.path.charCodeAt(i):0),yd(t)||46===t){if(46!==t){if(a=48===t,t=++i<n?e.path.charCodeAt(i):0,a&&i<n&&t&&yd(t))return void(e.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+r+")");for(;i<n&&yd(e.path.charCodeAt(i));)i++,s=!0;t=i<n?e.path.charCodeAt(i):0}if(46===t){for(c=!0,i++;yd(e.path.charCodeAt(i));)i++,o=!0;t=i<n?e.path.charCodeAt(i):0}if(101===t||69===t){if(c&&!s&&!o)return void(e.err="SvgPath: invalid float exponent (at pos "+i+")");if(43!==(t=++i<n?e.path.charCodeAt(i):0)&&45!==t||i++,!(i<n&&yd(e.path.charCodeAt(i))))return void(e.err="SvgPath: invalid float exponent (at pos "+i+")");for(;i<n&&yd(e.path.charCodeAt(i));)i++}e.index=i,e.param=parseFloat(e.path.slice(r,i))+0}else e.err="SvgPath: param should start with 0..9 or `.` (at pos "+i+")"}function Cd(e){var t,r;r=(t=e.path[e.segmentStart]).toLowerCase();var i=e.data;if("m"===r&&i.length>2&&(e.result.push([t,i[0],i[1]]),i=i.slice(2),r="l",t="m"===t?"l":"L"),"r"===r)e.result.push([t].concat(i));else for(;i.length>=vd[r]&&(e.result.push([t].concat(i.splice(0,vd[r]))),vd[r]););}function Ud(e){var t,r,i,n,a,s=e.max;if(e.segmentStart=e.index,t=e.path.charCodeAt(e.index),r=97==(32|t),function(e){switch(32|e){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(t))if(n=vd[e.path[e.index].toLowerCase()],e.index++,xd(e),e.data=[],n){for(i=!1;;){for(a=n;a>0;a--){if(!r||3!==a&&4!==a?Sd(e):kd(e),e.err.length)return void Cd(e);e.data.push(e.param),xd(e),i=!1,e.index<s&&44===e.path.charCodeAt(e.index)&&(e.index++,xd(e),i=!0)}if(!i){if(e.index>=e.max)break;if(!_d(e.path.charCodeAt(e.index)))break}}Cd(e)}else Cd(e);else e.err="SvgPath: bad command "+e.path[e.index]+" (at pos "+e.index+")"}function Ed(){if(!(this instanceof Ed))return new Ed;this.queue=[],this.cache=null}Ed.prototype.matrix=function(e){return 1===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&0===e[4]&&0===e[5]||(this.cache=null,this.queue.push(e)),this},Ed.prototype.translate=function(e,t){return 0===e&&0===t||(this.cache=null,this.queue.push([1,0,0,1,e,t])),this},Ed.prototype.scale=function(e,t){return 1===e&&1===t||(this.cache=null,this.queue.push([e,0,0,t,0,0])),this},Ed.prototype.rotate=function(e,t,r){var i,n,a;return 0!==e&&(this.translate(t,r),i=e*Math.PI/180,n=Math.cos(i),a=Math.sin(i),this.queue.push([n,a,-a,n,0,0]),this.cache=null,this.translate(-t,-r)),this},Ed.prototype.skewX=function(e){return 0!==e&&(this.cache=null,this.queue.push([1,0,Math.tan(e*Math.PI/180),1,0,0])),this},Ed.prototype.skewY=function(e){return 0!==e&&(this.cache=null,this.queue.push([1,Math.tan(e*Math.PI/180),0,1,0,0])),this},Ed.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var e=1;e<this.queue.length;e++)this.cache=(t=this.cache,r=this.queue[e],[t[0]*r[0]+t[2]*r[1],t[1]*r[0]+t[3]*r[1],t[0]*r[2]+t[2]*r[3],t[1]*r[2]+t[3]*r[3],t[0]*r[4]+t[2]*r[5]+t[4],t[1]*r[4]+t[3]*r[5]+t[5]]);var t,r;return this.cache},Ed.prototype.calc=function(e,t,r){var i;return this.queue.length?(this.cache||(this.cache=this.toArray()),[e*(i=this.cache)[0]+t*i[2]+(r?0:i[4]),e*i[1]+t*i[3]+(r?0:i[5])]):[e,t]};var Td=Ed,Md=Td,Od={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},Pd=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,Ad=/[\s,]+/,Id=2*Math.PI;function Ld(e,t,r,i){var n=e*r+t*i;return n>1&&(n=1),n<-1&&(n=-1),(e*i-t*r<0?-1:1)*Math.acos(n)}function jd(e,t){var r=4/3*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),a=Math.cos(e+t),s=Math.sin(e+t);return[i,n,i-n*r,n+i*r,a+s*r,s-a*r,a,s]}var Rd=1e-10,Dd=Math.PI/180;function Bd(e,t,r){if(!(this instanceof Bd))return new Bd(e,t,r);this.rx=e,this.ry=t,this.ax=r}Bd.prototype.transform=function(e){var t=Math.cos(this.ax*Dd),r=Math.sin(this.ax*Dd),i=[this.rx*(e[0]*t+e[2]*r),this.rx*(e[1]*t+e[3]*r),this.ry*(-e[0]*r+e[2]*t),this.ry*(-e[1]*r+e[3]*t)],n=i[0]*i[0]+i[2]*i[2],a=i[1]*i[1]+i[3]*i[3],s=((i[0]-i[3])*(i[0]-i[3])+(i[2]+i[1])*(i[2]+i[1]))*((i[0]+i[3])*(i[0]+i[3])+(i[2]-i[1])*(i[2]-i[1])),o=(n+a)/2;if(s<Rd*o)return this.rx=this.ry=Math.sqrt(o),this.ax=0,this;var c=i[0]*i[1]+i[2]*i[3],l=o+(s=Math.sqrt(s))/2,u=o-s/2;return this.ax=Math.abs(c)<Rd&&Math.abs(l-a)<Rd?90:180*Math.atan(Math.abs(c)>Math.abs(l-a)?(l-n)/c:c/(l-a))/Math.PI,this.ax>=0?(this.rx=Math.sqrt(l),this.ry=Math.sqrt(u)):(this.ax+=90,this.rx=Math.sqrt(u),this.ry=Math.sqrt(l)),this},Bd.prototype.isDegenerate=function(){return this.rx<Rd*this.ry||this.ry<Rd*this.rx};var Fd=function(e){var t=new wd(e),r=t.max;for(xd(t);t.index<r&&!t.err.length;)Ud(t);return t.result.length&&("mM".indexOf(t.result[0][0])<0?(t.err="SvgPath: string should start with `M` or `m`",t.result=[]):t.result[0][0]="M"),{err:t.err,segments:t.result}},Nd=function(e){var t,r,i=new Md;return e.split(Pd).forEach((function(e){if(e.length)if(void 0===Od[e])switch(r=e.split(Ad).map((function(e){return+e||0})),t){case"matrix":return void(6===r.length&&i.matrix(r));case"scale":return void(1===r.length?i.scale(r[0],r[0]):2===r.length&&i.scale(r[0],r[1]));case"rotate":return void(1===r.length?i.rotate(r[0],0,0):3===r.length&&i.rotate(r[0],r[1],r[2]));case"translate":return void(1===r.length?i.translate(r[0],0):2===r.length&&i.translate(r[0],r[1]));case"skewX":return void(1===r.length&&i.skewX(r[0]));case"skewY":return void(1===r.length&&i.skewY(r[0]))}else t=e})),i},zd=Td,Hd=function(e,t,r,i,n,a,s,o,c){var l=Math.sin(c*Id/360),u=Math.cos(c*Id/360),h=u*(e-r)/2+l*(t-i)/2,f=-l*(e-r)/2+u*(t-i)/2;if(0===h&&0===f)return[];if(0===s||0===o)return[];s=Math.abs(s),o=Math.abs(o);var d=h*h/(s*s)+f*f/(o*o);d>1&&(s*=Math.sqrt(d),o*=Math.sqrt(d));var p=function(e,t,r,i,n,a,s,o,c,l){var u=l*(e-r)/2+c*(t-i)/2,h=-c*(e-r)/2+l*(t-i)/2,f=s*s,d=o*o,p=u*u,m=h*h,b=f*d-f*m-d*p;b<0&&(b=0),b/=f*m+d*p;var v=(b=Math.sqrt(b)*(n===a?-1:1))*s/o*h,g=b*-o/s*u,y=l*v-c*g+(e+r)/2,_=c*v+l*g+(t+i)/2,w=(u-v)/s,x=(h-g)/o,k=(-u-v)/s,S=(-h-g)/o,C=Ld(1,0,w,x),U=Ld(w,x,k,S);return 0===a&&U>0&&(U-=Id),1===a&&U<0&&(U+=Id),[y,_,C,U]}(e,t,r,i,n,a,s,o,l,u),m=[],b=p[2],v=p[3],g=Math.max(Math.ceil(Math.abs(v)/(Id/4)),1);v/=g;for(var y=0;y<g;y++)m.push(jd(b,v)),b+=v;return m.map((function(e){for(var t=0;t<e.length;t+=2){var r=e[t+0],i=e[t+1],n=u*(r*=s)-l*(i*=o),a=l*r+u*i;e[t+0]=n+p[0],e[t+1]=a+p[1]}return e}))},Gd=Bd;function Wd(e){if(!(this instanceof Wd))return new Wd(e);var t=Fd(e);this.segments=t.segments,this.err=t.err,this.__stack=[]}Wd.from=function(e){if("string"==typeof e)return new Wd(e);if(e instanceof Wd){var t=new Wd("");return t.err=e.err,t.segments=e.segments.map((function(e){return e.slice()})),t.__stack=e.__stack.map((function(e){return zd().matrix(e.toArray())})),t}throw new Error("SvgPath.from: invalid param type "+e)},Wd.prototype.__matrix=function(e){var t,r=this;e.queue.length&&this.iterate((function(i,n,a,s){var o,c,l,u;switch(i[0]){case"v":c=0===(o=e.calc(0,i[1],!0))[0]?["v",o[1]]:["l",o[0],o[1]];break;case"V":c=(o=e.calc(a,i[1],!1))[0]===e.calc(a,s,!1)[0]?["V",o[1]]:["L",o[0],o[1]];break;case"h":c=0===(o=e.calc(i[1],0,!0))[1]?["h",o[0]]:["l",o[0],o[1]];break;case"H":c=(o=e.calc(i[1],s,!1))[1]===e.calc(a,s,!1)[1]?["H",o[0]]:["L",o[0],o[1]];break;case"a":case"A":var h=e.toArray(),f=Gd(i[1],i[2],i[3]).transform(h);if(h[0]*h[3]-h[1]*h[2]<0&&(i[5]=i[5]?"0":"1"),o=e.calc(i[6],i[7],"a"===i[0]),"A"===i[0]&&i[6]===a&&i[7]===s||"a"===i[0]&&0===i[6]&&0===i[7]){c=["a"===i[0]?"l":"L",o[0],o[1]];break}c=f.isDegenerate()?["a"===i[0]?"l":"L",o[0],o[1]]:[i[0],f.rx,f.ry,f.ax,i[4],i[5],o[0],o[1]];break;case"m":u=n>0,c=["m",(o=e.calc(i[1],i[2],u))[0],o[1]];break;default:for(c=[l=i[0]],u=l.toLowerCase()===l,t=1;t<i.length;t+=2)o=e.calc(i[t],i[t+1],u),c.push(o[0],o[1])}r.segments[n]=c}),!0)},Wd.prototype.__evaluateStack=function(){var e,t;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(e=zd(),t=this.__stack.length;--t>=0;)e.matrix(this.__stack[t].toArray());this.__matrix(e),this.__stack=[]}},Wd.prototype.toString=function(){var e="",t="",r=!1;this.__evaluateStack();for(var i=0,n=this.segments.length;i<n;i++){var a=this.segments[i],s=a[0];s!==t||"m"===s||"M"===s?("m"===s&&"z"===t&&(e+=" "),e+=s,r=!1):r=!0;for(var o=1;o<a.length;o++){var c=a[o];1===o?r&&c>=0&&(e+=" "):c>=0&&(e+=" "),e+=c}t=s}return e},Wd.prototype.translate=function(e,t){return this.__stack.push(zd().translate(e,t||0)),this},Wd.prototype.scale=function(e,t){return this.__stack.push(zd().scale(e,t||0===t?t:e)),this},Wd.prototype.rotate=function(e,t,r){return this.__stack.push(zd().rotate(e,t||0,r||0)),this},Wd.prototype.skewX=function(e){return this.__stack.push(zd().skewX(e)),this},Wd.prototype.skewY=function(e){return this.__stack.push(zd().skewY(e)),this},Wd.prototype.matrix=function(e){return this.__stack.push(zd().matrix(e)),this},Wd.prototype.transform=function(e){return e.trim()?(this.__stack.push(Nd(e)),this):this},Wd.prototype.round=function(e){var t,r=0,i=0,n=0,a=0;return e=e||0,this.__evaluateStack(),this.segments.forEach((function(s){var o=s[0].toLowerCase()===s[0];switch(s[0]){case"H":case"h":return o&&(s[1]+=n),n=s[1]-s[1].toFixed(e),void(s[1]=+s[1].toFixed(e));case"V":case"v":return o&&(s[1]+=a),a=s[1]-s[1].toFixed(e),void(s[1]=+s[1].toFixed(e));case"Z":case"z":return n=r,void(a=i);case"M":case"m":return o&&(s[1]+=n,s[2]+=a),n=s[1]-s[1].toFixed(e),a=s[2]-s[2].toFixed(e),r=n,i=a,s[1]=+s[1].toFixed(e),void(s[2]=+s[2].toFixed(e));case"A":case"a":return o&&(s[6]+=n,s[7]+=a),n=s[6]-s[6].toFixed(e),a=s[7]-s[7].toFixed(e),s[1]=+s[1].toFixed(e),s[2]=+s[2].toFixed(e),s[3]=+s[3].toFixed(e+2),s[6]=+s[6].toFixed(e),void(s[7]=+s[7].toFixed(e));default:return t=s.length,o&&(s[t-2]+=n,s[t-1]+=a),n=s[t-2]-s[t-2].toFixed(e),a=s[t-1]-s[t-1].toFixed(e),void s.forEach((function(t,r){r&&(s[r]=+s[r].toFixed(e))}))}})),this},Wd.prototype.iterate=function(e,t){var r,i,n,a=this.segments,s={},o=!1,c=0,l=0,u=0,h=0;if(t||this.__evaluateStack(),a.forEach((function(t,r){var i=e(t,r,c,l);Array.isArray(i)&&(s[r]=i,o=!0);var n=t[0]===t[0].toLowerCase();switch(t[0]){case"m":case"M":return c=t[1]+(n?c:0),l=t[2]+(n?l:0),u=c,void(h=l);case"h":case"H":return void(c=t[1]+(n?c:0));case"v":case"V":return void(l=t[1]+(n?l:0));case"z":case"Z":return c=u,void(l=h);default:c=t[t.length-2]+(n?c:0),l=t[t.length-1]+(n?l:0)}})),!o)return this;for(n=[],r=0;r<a.length;r++)if(void 0!==s[r])for(i=0;i<s[r].length;i++)n.push(s[r][i]);else n.push(a[r]);return this.segments=n,this},Wd.prototype.abs=function(){return this.iterate((function(e,t,r,i){var n,a=e[0],s=a.toUpperCase();if(a!==s)switch(e[0]=s,a){case"v":return void(e[1]+=i);case"a":return e[6]+=r,void(e[7]+=i);default:for(n=1;n<e.length;n++)e[n]+=n%2?r:i}}),!0),this},Wd.prototype.rel=function(){return this.iterate((function(e,t,r,i){var n,a=e[0],s=a.toLowerCase();if(a!==s&&(0!==t||"M"!==a))switch(e[0]=s,a){case"V":return void(e[1]-=i);case"A":return e[6]-=r,void(e[7]-=i);default:for(n=1;n<e.length;n++)e[n]-=n%2?r:i}}),!0),this},Wd.prototype.unarc=function(){return this.iterate((function(e,t,r,i){var n,a,s,o=[],c=e[0];return"A"!==c&&"a"!==c?null:("a"===c?(a=r+e[6],s=i+e[7]):(a=e[6],s=e[7]),0===(n=Hd(r,i,a,s,e[4],e[5],e[1],e[2],e[3])).length?[["a"===e[0]?"l":"L",e[6],e[7]]]:(n.forEach((function(e){o.push(["C",e[2],e[3],e[4],e[5],e[6],e[7]])})),o))})),this},Wd.prototype.unshort=function(){var e,t,r,i,n,a=this.segments;return this.iterate((function(s,o,c,l){var u,h=s[0],f=h.toUpperCase();o&&("T"===f?(u="t"===h,"Q"===(r=a[o-1])[0]?(e=r[1]-c,t=r[2]-l):"q"===r[0]?(e=r[1]-r[3],t=r[2]-r[4]):(e=0,t=0),i=-e,n=-t,u||(i+=c,n+=l),a[o]=[u?"q":"Q",i,n,s[1],s[2]]):"S"===f&&(u="s"===h,"C"===(r=a[o-1])[0]?(e=r[3]-c,t=r[4]-l):"c"===r[0]?(e=r[3]-r[5],t=r[4]-r[6]):(e=0,t=0),i=-e,n=-t,u||(i+=c,n+=l),a[o]=[u?"c":"C",i,n,s[1],s[2],s[3],s[4]]))})),this};var Yd=_e(Wd);function Xd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new Promise((function(n,a){bd.trace(e,(function(e,s){var o;e&&a(e);var c=/<path d=\"(.+?)\"/,l=null===(o=c.exec(s))||void 0===o?void 0:o[1],u=Yd(l).scale(1/t).translate(Number(r),Number(i)).round(1).toString();s=s.replace(c,'<path d="'.concat(u,'"')),n(s)}))}))}function Vd(e){return qd.apply(this,arguments)}function qd(){return qd=v(m().mark((function e(t){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var r=t.fill;t.clone(function(){var i=v(m().mark((function i(n){var a;return m().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.path&&(n.path.visible=!1),n.set("fill","black"),a=t.toObject(),!r){i.next=7;break}a.src=Zd(n),i.next=10;break;case 7:return i.next=9,Kd(n);case 9:a.svg=i.sent;case 10:e(a);case 11:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())})));case 1:case"end":return e.stop()}}),e)}))),qd.apply(this,arguments)}function Zd(e){return e.toDataURL({format:"jpeg",multiplier:10,enableRetinaScaling:!0})}function Kd(e){return new Promise((function(t,r){var i=400/e.fontSize/e.scaleX,n=e.toDataURL({multiplier:i}),a=e.getBoundingRect(!0);Xd(n,i,a.left,a.top).then((function(e){t(e)})).catch((function(e){r(e)}))}))}var Jd={"i-text":Vd,text:Vd,MText:Vd},Qd=function(){function e(){f(this,e)}var t;return p(e,null,[{key:"toObject",value:(t=v(m().mark((function e(t){var r,i,n,a,s,o,c,l,u;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.type,i=void 0===r?"":r,n=t.fill,a="image"===i,o=t.getBoundingRect(!0),"function"!=typeof Jd[i]){e.next=9;break}return e.next=6,Jd[i](t);case 6:s=e.sent,e.next=29;break;case 9:if(a){e.next=26;break}if(!n){e.next=19;break}return s=t.toObject(),e.next=14,new Promise((function(e){t.clone((function(t){t.set({fill:"black",strokeWidth:.1}),e(t)}))}));case 14:c=e.sent,l=c.toDataURL({format:"jpeg",multiplier:10,enableRetinaScaling:!0}),s.src=l,e.next=24;break;case 19:return s=t.toObject(),e.next=22,new Promise((function(e){t.clone((function(t){t.set({strokeWidth:1}),e(t)}))}));case 22:u=e.sent,s.svg=u.toSVG((function(e){var t=u.ownMatrixCache.value;return e.replace(/transform="(.*?)\)"/,'transform="matrix('.concat(t[0]," ").concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4]," ").concat(t[5],' )"'))}));case 24:e.next=29;break;case 26:return s=t.toObject(),e.next=29,new Promise((function(e){t.clone((function(t){t.set({scaleX:1,scaleY:1}),t.setCoords(),s.src=t.toDataURL({format:"jpeg"}),e()}))}));case 29:return s.width=o.width,s.height=o.height,s.left=o.left,s.top=o.top,e.abrupt("return",s);case 34:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),$d=kf.fabric.Object.prototype.toObject;kf.fabric.Object.prototype.toObject=function(e){var t=$d.call(this,e);return t.id=this.id,t.name=this.name,this.hasBezierControl&&(t.hasBezierControl=h(this.hasBezierControl)),t.hasControls=this.hasControls,t.width=this.width,t.height=this.height,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.isLock=this.isLock,t.isVariableThickness=this.isVariableThickness,t};var ep=kf.fabric.Text.prototype._measureLine;kf.fabric.IText.prototype._fontSizeFraction=0,kf.fabric.IText.prototype.measureLine=function(e){var t=this._measureLine(e);return 0!==this.charSpacing&&(t.width-=this._getWidthOfCharSpacing()),t.width-=t.fitWidth,t.width<0&&(t.width=0),t},kf.fabric.IText.prototype._measureLine=function(e){var t=ep.call(this,e),i=this._textLines[e],n=this.getCompleteStyleDeclaration(0,0),a=n.fontSize/this.CACHE_FONT_SIZE,s=this.getMeasuringContext();s.save(),this._setTextStyles(s,n,!0);var o=s.measureText(i.join(""));s.restore();var c=o.actualBoundingBoxRight+o.actualBoundingBoxLeft;return r(r({},t),{},{fitWidth:(o.width-c)*a})},kf.fabric.IText.prototype.getHeightOfCharActual=function(e,t){var r,i;-1===t?(r=this._textLines[e].join(""),i=this.getCompleteStyleDeclaration(e,0)):(r=this._textLines[e][t],i=this.getCompleteStyleDeclaration(e,t));var n=i.fontSize/this.CACHE_FONT_SIZE,a=this.getMeasuringContext();a.save(),this._setTextStyles(a,i,!0);var s=a.measureText(r);return a.restore(),{charHeight:(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)*n,above:s.actualBoundingBoxAscent*n,below:s.actualBoundingBoxDescent*n}},kf.fabric.IText.prototype.getHeightOfLine=function(e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var t=this._textLines[e],r=this.getHeightOfCharActual(e,0),i=r.above,n=r.below,a=1,s=t.length;a<s;a++){var o=this.getHeightOfCharActual(e,a),c=o.above,l=o.below;i=Math.max(c,i),n=Math.max(l,n)}var u=i+n;return this.maxAbove=i,this.maxBelow=n,this.__lineHeights[e]=u*Number(this.lineHeight)},kf.fabric.IText.prototype._renderChars=function(e,t,r,i,n,a){var s,o,c,l,u,h="",f=0,d=this.path,p="ltr"===this.direction,m="ltr"===this.direction?1:-1,b=t.canvas.getAttribute("dir");t.save(),b!==this.direction&&(t.canvas.setAttribute("dir",p?"ltr":"rtl"),t.direction=p?"ltr":"rtl",t.textAlign=p?"left":"right"),n-=this.maxBelow;for(var v=0,g=r.length-1;v<=g;v++)l=!0,h+=r[v],c=this.__charBounds[a][v],0===f?(i+=m*(c.kernedWidth-c.width),f+=c.width):f+=c.kernedWidth,l||(s=s||this.getCompleteStyleDeclaration(a,v),o=this.getCompleteStyleDeclaration(a,v+1),l=kf.fabric.util.hasStyleChanged(s,o,!1)),l&&(d?(t.save(),t.translate(c.renderLeft,c.renderTop),t.rotate(c.angle),this._renderChar(e,t,a,v,h,-f/2,0),t.restore()):(u=i,this._renderChar(e,t,a,v,h,u,n,r[0])),h="",s=o,i+=m*f,f=0);t.restore()},kf.fabric.IText.prototype._renderChar=function(e,t,r,i,n,a,s,o){var c,l,u=this._getStyleDeclaration(r,i),h=this.getCompleteStyleDeclaration(r,i),f="fillText"===e&&h.fill,d="strokeText"===e&&h.stroke&&h.strokeWidth;if(d||f){t.save(),f&&(c=this._setFillStyles(t,h)),d&&(l=this._setStrokeStyles(t,h)),t.font=this._getFontDeclaration(h),u&&u.textBackgroundColor&&this._removeShadow(t),o||(o=n);var p=t.measureText(o).actualBoundingBoxLeft;f&&t.fillText(n,a-c.offsetX+p,s-c.offsetY),d&&t.strokeText(n,a-l.offsetX+p,s-l.offsetY),t.restore()}},kf.fabric.IText.prototype.renderCursor=function(e,t){var r,i=this.get2DCursorLocation(),n=i.lineIndex,a=i.charIndex>0?i.charIndex-1:0,s=this.getHeightOfLine(n)/Number(this.lineHeight),o=Number(this.scaleX)*((null===(r=this.canvas)||void 0===r?void 0:r.getZoom())||1),c=Number(this.cursorWidth)/o,l=e.topOffset,u=this.getValueOfPropertyAt(n,a,"deltaY");this.inCompositionMode&&this.renderSelection(e,t),t.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,a,"fill"),t.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,t.fillRect(e.left+e.leftOffset-c/2,l+e.top+u,c,s)},kf.fabric.Text.prototype.initDimensions=function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){for(var e=0,t=0,r=this._textLines[0],i=0;i<r.length;i++){var n=this.getCompleteStyleDeclaration(0,i);e=Math.max(e,this._measureChar(r[i],n).width),t=Math.max(t,this.getHeightOfChar(0,i))}var a=Math.max(e,t);this.width=this.path.width+2*a,this.height=this.path.height+2*a}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}};var tp=kf.fabric.Text.prototype.toObject;kf.fabric.Text.prototype.toObject=function(e){var t=tp.call(this,e);return t.path&&(t.path=new kf.fabric.Path(this.path.path,this.path)),t};var rp,ip=function(){function e(t){f(this,e),g(this,"options",void 0),g(this,"gridBackground",void 0),g(this,"grids",void 0),this.options=t,this.initGridBackground(t)}return p(e,[{key:"initGridBackground",value:function(e){var t,r=e.stageWidth,i=e.stageHeight,n=e.zoomRate;if(!r||!i)return console.error("请提供舞台尺寸大小！");for(var a=e.interval||10,s=e.defaultColor||"#EAEBEA",o=e.blodColor||"#D1D2D4",c=Math.ceil(i/10)-1,l=Math.ceil(r/10)-1,u=1,h=!1,f="",d="",p=0;p<c+l;p++){var m=p<c?"M 0 ".concat(u*a," L ").concat(r," ").concat(u*a):"M ".concat(u*a," 0 L ").concat(u*a," ").concat(i);u%a==0?d+=m:f+=m,u!==c||h?++u:(u=1,h=!0)}var b=new kf.fabric.Path(f);b.set({originX:"left",originY:"top",top:0,left:-1/n/2,fill:void 0,stroke:s,strokeWidth:1/n,opacity:1,selectable:!1,evented:!1,strokeUniform:!0,hoverCursor:"default"});var v=new kf.fabric.Path(d);v.set({originX:"left",originY:"top",top:0,left:-1/n/2,fill:void 0,stroke:o,strokeWidth:1/n,opacity:1,selectable:!1,evented:!1,strokeUniform:!0,hoverCursor:"default",width:r,height:i});var g=new kf.fabric.Path("\n      M 0 0 L ".concat(r," 0\n      M 0 ").concat(i," L ").concat(r," ").concat(i,"\n      M 0 0 L 0 ").concat(i,"\n      M ").concat(r," 0 L ").concat(r," ").concat(i,"\n    "),{name:"pathBorder",top:-1/n/2,left:-1/n/2,originX:"left",originY:"top",stroke:this.options.stageBorCor||"#43C9B0",strokeWidth:1/n,strokeLineCap:"square",selectable:!1,evented:!1,strokeUniform:!0,hoverCursor:"default"});(null===(t=this.grids)||void 0===t?void 0:t.length)>0?(this.grids[0].set(b),this.grids[1].set(v),this.grids[2].set(g)):(this.grids=[b,v,g],this.grids.forEach((function(t){e.addElement(t)})))}},{key:"resize",value:function(e,t,i){this.initGridBackground(r(r({},this.options),{},{stageWidth:e,stageHeight:t})),this.resetGridBackground(i)}},{key:"resetGridBackground",value:function(e){this.grids.forEach((function(t){var r={left:-1/e/2,strokeWidth:1/e};t.name&&(r.top=-1/e/2),t.set(r)}))}},{key:"onZoom",value:function(e){var t=e.zoomRate;this.resetGridBackground(t)}},{key:"onCanvasResize",value:function(e){var t=e.zoomRate;this.resetGridBackground(t)}}]),e}(),np=new Uint8Array(16);function ap(){if(!rp&&!(rp="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rp(np)}for(var sp=[],op=0;op<256;++op)sp.push((op+256).toString(16).slice(1));var cp={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function lp(e,t,r){if(cp.randomUUID&&!t&&!e)return cp.randomUUID();var i=(e=e||{}).random||(e.rng||ap)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=i[n];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(sp[e[t+0]]+sp[e[t+1]]+sp[e[t+2]]+sp[e[t+3]]+"-"+sp[e[t+4]]+sp[e[t+5]]+"-"+sp[e[t+6]]+sp[e[t+7]]+"-"+sp[e[t+8]]+sp[e[t+9]]+"-"+sp[e[t+10]]+sp[e[t+11]]+sp[e[t+12]]+sp[e[t+13]]+sp[e[t+14]]+sp[e[t+15]]).toLowerCase()}(i)}var up=function(e){i(r,e);var t=n(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return f(this,r),(e=t.call(this)).x=i,e.y=n,e}return p(r,[{key:"x",get:function(){return this[0]},set:function(e){this[0]=e}},{key:"y",get:function(){return this[1]},set:function(e){this[1]=e}},{key:"length",get:function(){return Math.hypot(this.x,this.y)}},{key:"dir",get:function(){return Math.atan2(this.y,this.x)}},{key:"copy",value:function(){return new r(this.x,this.y)}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"scale",value:function(e){return this.x*=e,this.y*=e,this}},{key:"rotate",value:function(e){var t=Math.cos(e),r=Math.sin(e),i=w(this,2),n=i[0],a=i[1];return this.x=n*t+a*-r,this.y=n*r+a*t,this}},{key:"cross",value:function(e){return this.x*e.y-e.x*this.y}},{key:"dot",value:function(e){return this.x*e.x+e.y*this.y}},{key:"normalize",value:function(){return this.scale(1/this.length)}}]),r}(s(Array));function hp(e,t){return new up(e.x+t.x,e.y+t.y)}function fp(e,t){return new up(e.x-t.x,e.y-t.y)}var dp=function(e,t,r){var i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.3,a=fp(e,t),s=fp(e,t),o=a.length/s.length;return i=o>1?fp(e,hp(t,fp(r,t).scale(1/o))):fp(hp(t,fp(e,t).scale(o)),r),{control1:{x:hp(t,i=i.scale(n)).x,y:hp(t,i).y},control2:{x:fp(t,i).x,y:fp(t,i).y}}},pp=function(){function e(t){f(this,e),g(this,"name","pen"),g(this,"options",void 0),g(this,"radius",2),g(this,"lineCache",void 0),g(this,"shape",void 0),g(this,"startPoint",void 0),g(this,"firstPen",[]),g(this,"penGroup",[[],[]]),g(this,"isDrawing",!1),g(this,"isEditing",!1),g(this,"BezierControl",void 0),g(this,"strokeWidth",1),this.strokeWidth=1/t.getZoom(),this.options=t}return p(e,[{key:"createPenPath",value:function(e){var t=new kf.fabric.Path(e,r({},Np()));return t.set("hasBezierControl",[]),t}},{key:"makePenPath",value:function(e,t,i,n,a){var s;"PC"!==this.options.client&&(null===(s=this.lineCache)||void 0===s||s.set({x2:e.x,y2:e.y}));var o=new kf.fabric.Line([e.x,e.y,e.x,e.y],r(r({},mp()),{},{evented:!1,selectable:!1,strokeWidth:this.strokeWidth}));this.lineCache=o;var c=this.radius,l="PC"!==this.options.client?3:0,u=this.makePenCircle(e,c),h=0;if(i){for(var f=0;f<2;f++){var d=t[f],p=i[f];Math.abs(d-p)<c+l&&h++}if(2===h){null==n||n.set({x2:t[0],y2:t[1]}),o=null;var m=this.clearAssistObject(!0),b=this.createPenPath(m);this.options.addElement(b),this.options.recordOperate(b),this.options.setSelection(b)}}return o&&(a[0].push(o),a[1].push(u),this.options.addElement(o),this.options.addElement(u)),this.options.renderCanvas(),o}},{key:"makePenCircle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new kf.fabric.Circle(r(r({},mp()),{},{left:e.x,top:e.y,strokeWidth:this.strokeWidth,fill:"white",radius:t,originX:"center",originY:"center",evented:!1,strokeUniform:!0,selectable:!1,hasBorders:!1,hasControls:!1,hoverCursor:"default"},i))}},{key:"createBezierPoint",value:function(e,t,i,n,a,s){var o,c,l=this,u=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],f=arguments.length>7?arguments[7]:void 0,d=arguments.length>8?arguments[8]:void 0,p=arguments.length>9?arguments[9]:void 0,m=a.get(n),b=m.cricle.getCenterPoint();if(f)o=e,c=t;else{var v=dp(new up(e.x,e.y),new up(b.x,b.y),new up(t.x,t.y),.3);o=v.control1,c=v.control2}var g=this.makePenCircle(o,2,{evented:!0,selectable:!0,visible:u}),y=this.makePenCircle(c,2,{evented:!0,selectable:!0,visible:u}),_=new kf.fabric.Line([o.x,o.y,c.x,c.y],r(r({},mp()),{},{evented:!1,selectable:!1,visible:u,strokeWidth:this.strokeWidth}));m.line=_,m.cricle1=g,m.cricle2=y;var w=function(){var e,t,r=i.path,a=r[n];n+1===r.length?(t=1,s||(t=0),e=r[t]):e=r[t=n+1];var o=h(a);"Q"===a[0]&&(o[1]=m.cricle1.left,o[2]=m.cricle1.top),"C"===a[0]&&(o[3]=m.cricle1.left,o[4]=m.cricle1.top);var c=h(e);"M"!==c[0]&&(c[1]=m.cricle2.left,c[2]=m.cricle2.top),r[n]=o,r[t]=c,l.updatePenPath(i,r),g.setCoords(),y.setCoords()};g.on("mousemove",(function(){l.calcDiagonal(g,y,1,m.cricle,_),w()})),y.on("mousemove",(function(){l.calcDiagonal(g,y,2,m.cricle,_),w()})),d&&this.calcDiagonal(g,y,2,m.cricle,_),p&&this.calcDiagonal(g,y,1,m.cricle,_);var x=this.options.getObjects().indexOf(m.cricle);return this.options.addElement(_),this.options.addElement(g),this.options.addElement(y),g.moveTo(x),y.moveTo(x),_.moveTo(x),{control1:o,control2:c}}},{key:"calcDiagonal",value:function(e,t,r,i,n){var a=i.getCenterPoint(),s={x:0,y:0};1===r?(s.y=a.y-e.top,s.x=a.x-e.left,t.set({top:a.y+s.y,left:a.x+s.x})):(s.y=a.y-t.top,s.x=a.x-t.left,e.set({top:a.y+s.y,left:a.x+s.x})),n.set({x1:e.left,y1:e.top,x2:t.left,y2:t.top})}},{key:"updatePenPath",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.path=t;var n=e._calcDimensions(),a=e.strokeWidth/2;e.set(r({width:n.width,height:n.height,left:n.left,top:n.top,pathOffset:{x:n.width/2+n.left+a,y:n.height/2+n.top+a},dirty:!0},i)),e.setCoords(),this.options.renderCanvas()}},{key:"onMouseDblClick",value:function(e){var t,r,i=this;if(e.target&&(Object.hasOwn(e.target,"hasBezierControl")&&"path"===(null===(t=e.target)||void 0===t?void 0:t.type)&&!this.isEditing)){this.exitEdit();var n=e.target,a=new Map;this.BezierControl=a,this.isEditing=!0,this.options.setSelectable(!1),this.shape=n,this.options.setSelection(),null===(r=this.shape)||void 0===r||r.set({lockMovementX:!0,lockMovementY:!0});var s=[],o=kf.fabric.util.transformPath(n.path,n.calcOwnMatrix(),n.pathOffset);this.updatePenPath(n,o,{scaleX:1,scaleY:1,angle:0,skewX:0,skewY:0});var c=n.path;c.forEach((function(e,t){var r=!0,l=c[c.length-1];if(c[0][1]===l[l.length-2]&&c[0][2]===l[l.length-1]||(r=!1),0!==t||!r){var u={};a.set(t,u);var f,d=i.makePenCircle({x:o[t][o[t].length-2],y:o[t][o[t].length-1]},i.radius,{evented:!0,selectable:!0});if(u.cricle=d,s.push(d),n.hasBezierControl[t]){var p,m,b=!1,v=!1,g={x:0,y:0},y={x:0,y:0},_=c[t];if("M"===_[0]){var w=c[t+1];y.x=w[1],y.y=w[2],b=!0}"Q"===_[0]&&(g.x=_[1],g.y=_[2]),"C"===_[0]&&(g.x=_[3],g.y=_[4]),t+1===c.length?(m=1,r||(m=0),p=c[m]):p=c[m=t+1],"M"===p[0]?v=!0:(y.x=p[1],y.y=p[2]),i.createBezierPoint(g,y,n,t,a,r,!1,!0,b,v)}var x=!1;d.on("mousedblclick",(function(){if(!n.hasBezierControl[t]){n.hasBezierControl[t]=!0;var e,s,o=c[t];r?1===t?(s=c.length-1,e=c[s]):e=c[s=t-1]:0===t?(s=c.length-1,e=c[s]):e=c[s=t-1];var l,u,f={x:e[e.length-2],y:e[e.length-1]},d={x:0,y:0};t+1===c.length?(u=1,r||(u=0),l=c[u]):l=c[u=t+1],d.x=l[l.length-2],d.y=l[l.length-1],"Q"===o[0]&&(f.x=o[1],f.y=o[2]),"Q"===l[0]&&(d.x=l[1],d.y=l[2]);var p=i.createBezierPoint(f,d,n,t,a,r),m=p.control1,b=p.control2,v=h(o);"Q"===o[0]?(v[0]="C",v.splice(3,0,m.x,m.y)):"L"===o[0]&&(v[0]="Q",v.splice(1,0,m.x,m.y));var g=h(l);"L"===l[0]?(g[0]="Q",g.splice(1,0,b.x,b.y)):"Q"===l[0]&&(g[0]="C",g.splice(1,0,b.x,b.y)),c[t]=v,c[u]=g,i.updatePenPath(n,c)}})),d.on("mousemove",(function(){if(x){var e,s,o=d.getCenterPoint(),l=c[t];t+1===c.length?(s=1,r||(s=0),e=c[s]):e=c[s=t+1];var u=a.get(t);if(null!=u&&u.cricle2){var p=f.x-o.x,m=f.y-o.y;u.cricle2.set({top:u.c2DownPoint.top-m,left:u.c2DownPoint.left-p}),u.cricle1.set({top:u.c1DownPoint.top-m,left:u.c1DownPoint.left-p}),u.line.set({x1:u.lineDownPoint.x1-p,y1:u.lineDownPoint.y1-m,x2:u.lineDownPoint.x2-p,y2:u.lineDownPoint.y2-m}),u.cricle1.setCoords(),u.cricle2.setCoords()}r&&t===c.length-1&&(c[0][1]=o.x,c[0][2]=o.y);var b=h(l);"M"===l[0]&&(b[1]=o.x,b[2]=o.y),"L"===l[0]&&(b[1]=o.x,b[2]=o.y),"Q"===l[0]&&(n.hasBezierControl[t]&&(b[1]=u.cricle1.left,b[2]=u.cricle1.top),b[3]=o.x,b[4]=o.y),"C"===l[0]&&(b[3]=u.cricle1.left,b[4]=u.cricle1.top,b[5]=o.x,b[6]=o.y);var v=h(e);"Q"===v[0]&&n.hasBezierControl[t]&&(v[1]=u.cricle2.left,v[2]=u.cricle2.top),"C"===v[0]&&(v[1]=u.cricle2.left,v[2]=u.cricle2.top),c[t]=b,c[s]=v,i.updatePenPath(n,c)}})),d.on("mousedown",(function(e){x=!0,f=d.getCenterPoint();var i=a.get(t);i.cricle1&&(i.c1DownPoint={top:i.cricle1.top,left:i.cricle1.left},i.c2DownPoint={top:i.cricle2.top,left:i.cricle2.left},i.lineDownPoint={x1:i.line.x1,y1:i.line.y1,x2:i.line.x2,y2:i.line.y2}),s.forEach((function(e,t){var i=t+1;r||(i=t);var n,s,o,c,l,u,h=a.get(i);e.id!==d.id?(null==h||null===(n=h.line)||void 0===n||n.set({visible:!1}),null==h||null===(s=h.cricle1)||void 0===s||s.set({visible:!1}),null==h||null===(o=h.cricle2)||void 0===o||o.set({visible:!1}),e.set({fill:"white"})):(null==h||null===(c=h.line)||void 0===c||c.set({visible:!0}),null==h||null===(l=h.cricle1)||void 0===l||l.set({visible:!0}),null==h||null===(u=h.cricle2)||void 0===u||u.set({visible:!0}),e.set({fill:$h.stroke}))})),ut("cricleEvent",(function(){e.isFire||(d.fire("mousedblclick"),d.fire("mousedown",{isFire:!0}))}))})),d.on("mouseup",(function(){x=!1})),i.options.addElement(d)}}))}}},{key:"startDrawPen",value:function(){this.isDrawing=!0}},{key:"clearAssistObject",value:function(e){var t=this;this.lineCache=void 0;var r="M ".concat(this.firstPen[0]," ").concat(this.firstPen[1]);return this.penGroup[0].forEach((function(i,n){if(t.options.removeElement(i),t.options.removeElement(t.penGroup[1][n]),!e&&n===t.penGroup[1].length-1){var a=t.createPenPath(r);return a.set("hasBezierControl",[]),t.options.addElement(a),t.options.recordOperate(a),void t.options.setSelection(a)}r+=" L ".concat(i.x2," ").concat(i.y2)})),this.penGroup[0]=[],this.penGroup[1]=[],r}},{key:"onExitDrawMode",value:function(){this.exitPen()}},{key:"exitPen",value:function(){var e,t=localStorage.getItem("setOption")?JSON.parse(localStorage.getItem("setOption")):{openAdsorb:!1,perPixelTargetFind:!1};this.options.setOpenAdsorb(t.openAdsorb),null===(e=this.shape)||void 0===e||e.set({lockMovementX:!1,lockMovementY:!1}),this.options.setDefaultCursor(),this.isEditing&&this.exitEdit(),this.isDrawing&&(this.clearAssistObject(),this.isDrawing=!1,this.options.setSelectable(!0),this.shape=null,this.firstPen=[],this.options.reCalcStrokeWidth())}},{key:"exitEdit",value:function(){var e=this;this.shape&&(this.isEditing=!1,this.BezierControl.forEach((function(t){for(var r in t){var i=t[r];i instanceof kf.fabric.Object&&(i.off(),e.options.removeElement(i))}})),this.options.setSelectable(!0),this.options.recordOperate(this.shape),this.shape&&this.options.setSelection(this.shape),this.shape=null)}},{key:"destroyed",value:function(){}},{key:"onZoom",value:function(e){var t=e.zoomRate;this.strokeWidth=1/t}},{key:"onMouseDown",value:function(e){var t;if(this.isDrawing){this.options.setSelectable(!1);var r=this.startPoint=this.options.getPointer(e),i=[r.x,r.y,r.x,r.y],n=this.firstPen,a=i;null!==(t=n)&&void 0!==t&&t.length||(this.firstPen=i,a=null),this.shape=this.makePenPath(r,n,a,this.shape,this.penGroup),this.shape||(this.exitPen(),n=[])}else"Mobile"===this.options.client&&this.isEditing&&!e.target&&this.options.exitDrawMode()}},{key:"onMouseMove",value:function(e){if("PC"===this.options.client&&this.isDrawing&&this.shape){var t=this.options.getPointer(e)||{x:0,y:0};this.shape.set({x1:this.startPoint.x,y1:this.startPoint.y,x2:t.x,y2:t.y}),this.options.renderCanvas()}}}]),e}();function mp(){return{id:"el-"+lp(),name:$h.name,strokeWidth:$h.strokeWidth,stroke:$h.stroke,fill:$h.fill}}function bp(){return"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"el","-").concat(lp())}function vp(e,t,r){var i=t.x,n=t.y,a=e.x,s=e.y,o=i+(a-i)*Math.cos(r*Math.PI/180)-(s-n)*Math.sin(r*Math.PI/180),c=n+(a-i)*Math.sin(r*Math.PI/180)+(s-n)*Math.cos(r*Math.PI/180);return{x:Number(o.toFixed(1)),y:Number(c.toFixed(1)),angle:r}}function gp(e,t){var r;return t!==qh.MM?"".concat(null===(r=e/25.4)||void 0===r?void 0:r.toFixed(3)):"".concat(null==e?void 0:e.toFixed(1))}function yp(e){return 25.4*e}var _p=function(){function e(t){f(this,e),g(this,"rulerX",void 0),g(this,"rulerY",void 0),g(this,"unit",qh.MM),g(this,"preParams",void 0),this.rulerX=t.rulerX,this.rulerY=t.rulerY,this.unit=t.unit,this.preParams={stageX:t.stageX,stageY:t.stageY,canvasWidth:t.canvasWidth,canvasHeight:t.canvasHeight,zoomRate:t.zoomRate},this.drawAll(t.stageX,t.stageY,t.canvasWidth,t.canvasHeight,t.zoomRate)}return p(e,[{key:"getGridSize",value:function(e){var t,r=100;return this.unit===qh.INCH?(t=yp(1),r=yp(10)):e<=.1?(t=400,r=200):e<=.75?t=200:e<=1.25?t=50:e<2.5?t=10:(t=5,r=50),{gridSize:t,fullUnit:r}}},{key:"drawX",value:function(e,t,r){this.rulerX&&(this.rulerX.width=r,this.draw(this.rulerX,!1,e,t,r))}},{key:"drawY",value:function(e,t,r){this.rulerY&&(this.rulerY.height=r,this.draw(this.rulerY,!0,e,t,r))}},{key:"draw",value:function(e,t,r,i,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,s=e.getContext("2d");if(s){s.clearRect(0,0,e.width,e.height),s.save();var o=r,c=0,l=0,u=0;t?(s.translate(a,0),s.rotate(90*Math.PI/180),c=a,l=10,u=0):(c=0,l=a-10,u=a);var h=this.getGridSize(r),f=h.gridSize,d=h.fullUnit,p=-i,m=0;p<0?(m-=p%f*o,p-=p%f):(m+=(f-p%f)*o,p=p+f-p%f);var b=f*o;for(s.beginPath(),s.strokeStyle="rgb(210, 210, 210)";p<=n/r-i;)s.moveTo(m,u),Number(p.toFixed(2))%d==0?(s.lineTo(m,c),s.fillText(parseInt(gp(p,this.unit)).toString(),m+2,l)):s.lineTo(m,l),m+=b,p+=f;s.stroke(),s.closePath(),s.restore()}}},{key:"drawAll",value:function(e,t,r,i,n){this.preParams={stageX:e,stageY:t,canvasWidth:r,canvasHeight:i,zoomRate:n},this.drawX(n,e,r),this.drawY(n,t,i)}},{key:"onCanvasDraging",value:function(e){var t=e.stageX,r=e.stageY,i=e.canvasWidth,n=e.canvasHeight,a=e.zoomRate;this.drawAll(t,r,i,n,a)}},{key:"onCanvasResize",value:function(e){var t=e.stageX,r=e.stageY,i=e.canvasWidth,n=e.canvasHeight,a=e.zoomRate;this.drawAll(t,r,i,n,a)}},{key:"onZoom",value:function(e){var t=e.stageX,r=e.stageY,i=e.canvasWidth,n=e.canvasHeight,a=e.zoomRate;this.drawAll(t,r,i,n,a)}},{key:"onUnitChange",value:function(e){console.log("ruler unit type",e),this.unit=e;var t=this.preParams,r=t.stageX,i=t.stageY,n=t.canvasWidth,a=t.canvasHeight,s=t.zoomRate;this.drawAll(r,i,n,a,s)}}]),e}(),wp={ruler:_p,gridBackground:ip,pen:pp},xp=["onMouseDown","onMouseMove","onMouseUp","onSelected","onCanvasDraging","onCanvasResize","onZoom","onExitDrawMode","onMouseDblClick","onUnitChange"],kp=function(){function e(){f(this,e),g(this,"_plugins",void 0),this._plugins=[]}return p(e,[{key:"parse",value:function(e,t){var i=this;e.forEach((function(e){var n=e.name,a=void 0===n?"":n,s=e.options;if(wp[a]){var o=new wp[a](r(r({},s),t)),c={name:a,_plugin:o};xp.forEach((function(e){c[e]=o[e]})),i.addPlugin(c,o)}else i.addPlugin(e)}))}},{key:"getPlugin",value:function(e){return this._plugins.find((function(t){return t.name===e}))||null}},{key:"addPlugin",value:function(e,t){this.includePlugin(e)||(this._plugins.push(e),this.bindFunc(e,t||e))}},{key:"removePlugin",value:function(e){var t=this._plugins.findIndex((function(t){return e.name===t.name}));t>=0&&this._plugins.splice(t,1)}},{key:"includePlugin",value:function(e){for(var t=0;t<this._plugins.length;t++)if(this._plugins[t].name===e.name)return this._plugins[t];return!1}},{key:"bindFunc",value:function(e,t){xp.forEach((function(r){de(e[r])&&(e[r]=e[r].bind(t))}))}},{key:"onMouseDown",value:function(e){this._plugins.forEach((function(t){de(t.onMouseDown)&&t.onMouseDown(e)}))}},{key:"onMouseMove",value:function(e){this._plugins.forEach((function(t){de(t.onMouseMove)&&t.onMouseMove(e)}))}},{key:"onMouseUp",value:function(e){this._plugins.forEach((function(t){de(t.onMouseUp)&&t.onMouseUp(e)}))}},{key:"onMouseDblClick",value:function(e){this._plugins.forEach((function(t){de(t.onMouseDblClick)&&t.onMouseDblClick(e)}))}},{key:"onSelected",value:function(e){this._plugins.forEach((function(t){de(t.onSelected)&&t.onSelected(e)}))}},{key:"onCanvasDraging",value:function(e){this._plugins.forEach((function(t){de(t.onCanvasDraging)&&t.onCanvasDraging(e)}))}},{key:"onCanvasResize",value:function(e){this._plugins.forEach((function(t){de(t.onCanvasResize)&&t.onCanvasResize(e)}))}},{key:"onZoom",value:function(e){this._plugins.forEach((function(t){de(t.onZoom)&&t.onZoom(e)}))}},{key:"onUnitChange",value:function(e){this._plugins.forEach((function(t){de(t.onUnitChange)&&t.onUnitChange(e)}))}},{key:"setOpenAdsorb",value:function(e){this._plugins.forEach((function(t){de(t.setOpenAdsorb)&&t.setOpenAdsorb(e)}))}},{key:"adsorbCalcXY",value:function(e){this._plugins.forEach((function(t){de(t.calcXY)&&t.calcXY(e.target,e.e)}))}},{key:"adsorbSetGaps",value:function(){this._plugins.forEach((function(e){de(e.setGaps)&&e.setGaps()}))}},{key:"onSelectionUpdated",value:function(e){this._plugins.forEach((function(t){de(t.onSelectionUpdated)&&t.onSelectionUpdated(e)}))}},{key:"onSelectionCreated",value:function(e){this._plugins.forEach((function(t){de(t.onSelectionCreated)&&t.onSelectionCreated(e)}))}},{key:"onExitDrawMode",value:function(e){this._plugins.forEach((function(t){de(t.onExitDrawMode)&&t.onExitDrawMode(e)}))}},{key:"destroy",value:function(){this._plugins=[]}}]),e}(),Sp=p((function e(){f(this,e),g(this,"Mesh",void 0);var t=kf.fabric.util.createClass(kf.fabric.Image.filters.BaseFilter,{type:"Mesh",initialize:function(e){this.setOptions(r({type:"Mesh",webgl:!1},e))},applyTo2d:function(e){var t=e.sourceWidth,r=e.sourceHeight,i=Math.ceil(r/6)-0,n=Math.ceil(t/6)-0,a=document.createElement("canvas");a.width=t,a.height=r;var s=a.getContext("2d");s.putImageData(e.imageData,0,0),s.save();for(var o="rgba(".concat(255,", ").concat(255,", ").concat(255,", ").concat(.1,")"),c=0;c<n;c++)s.beginPath(),s.strokeStyle=o,s.lineWidth=1,s.moveTo(6*c,0),s.lineTo(6*c,r),s.stroke();for(var l=0;l<i;l++)s.beginPath(),s.strokeStyle=o,s.lineWidth=1,s.moveTo(0,6*l),s.lineTo(t,6*l),s.stroke();s.restore();for(var u=s.getImageData(0,0,t,r),h=e.imageData.data,f=0;f<h.length;f+=4)0===h[f+3]&&(u.data[f]=0,u.data[f+1]=0,u.data[f+2]=0,u.data[f+3]=0);e.imageData=u}});this.Mesh=t,kf.fabric.Image.filters.Mesh=t,kf.fabric.Image.filters.Mesh.fromObject=kf.fabric.Image.filters.BaseFilter.fromObject})),Cp=function(){function e(){var t=this;f(this,e),g(this,"Sketch",void 0),g(this,"radius",1),g(this,"sigma",.7);var i=kf.fabric.util.createClass(kf.fabric.Image.filters.BaseFilter,{type:"Sketch",initialize:function(e){this.setOptions(r({type:"Sketch",webgl:!1},e))},applyTo2d:function(e){var r=e.sourceWidth,i=e.sourceHeight,n=document.createElement("canvas");n.width=r,n.height=i;for(var a=e.originalImageData.data,s=[],o=0;o<a.length;o+=4){var c=.3*a[o]+.59*a[o+1]+.11*a[o+2];s.push(c),s.push(c),s.push(c),s.push(a[o+3]);var l=255-c;a[o]=l,a[o+1]=l,a[o+2]=l}e.originalImageData=t.gaussBlur(e.originalImageData,t.radius,t.sigma),a=e.originalImageData.data;for(var u=0;u<a.length;u+=4){var h=Math.min(s[u]+s[u]*a[u]/(255-a[u]),255);a[u]=h,a[u+1]=h,a[u+2]=h}e.imageData=e.originalImageData}});this.Sketch=i,kf.fabric.Image.filters.Sketch=i,kf.fabric.Image.filters.Sketch.fromObject=kf.fabric.Image.filters.BaseFilter.fromObject}return p(e,[{key:"gaussBlur",value:function(e,t,r){for(var i=e.data,n=e.width,a=e.height,s=2*(t=t||5)+1,o=[],c=0,l=1/(2*(r=r||t/3)*r*Math.PI),u=-l*Math.PI,h=-t;h<=t;h++)for(var f=-t;f<=t;f++){var d=l*Math.exp((h*h+f*f)*u);o.push(d),c+=d}for(var p=(t+1)*(t+1),m=0;m<p;m++)o[m]=o[m]/c;for(var b=0;b<n;b++)for(var v=0;v<a;v++){for(var g=0,y=0,_=0,w=-t;w<=t;w++)for(var x=this.handleEdge(w,b,n),k=-t;k<=t;k++){var S=4*(this.handleEdge(k,v,a)*n+x),C=k+t,U=w+t;g+=i[S]*o[C*s+U],y+=i[S+1]*o[C*s+U],_+=i[S+2]*o[C*s+U]}var E=4*(v*n+b);i[E]=~~g,i[E+1]=~~y,i[E+2]=~~_}return e}},{key:"handleEdge",value:function(e,t,r){var i=t+e;return i<0?i=-i:i>=r&&(i=r+e-t),i}}]),e}(),Up=p((function e(){f(this,e),g(this,"Comic",void 0);var t=kf.fabric.util.createClass(kf.fabric.Image.filters.BaseFilter,{type:"Comic",initialize:function(e){this.setOptions(r({type:"Comic",webgl:!1},e))},applyTo2d:function(e){var t=e.sourceWidth,r=e.sourceHeight,i=document.createElement("canvas");i.width=t,i.height=r;for(var n=i.getContext("2d"),a=e.originalImageData.data,s=0;s<a.length;s+=4){var o=(a[s+0]+a[s+1]+a[s+2])/3;a[s+0]=a[s+1]=a[s+2]=o>=128?255:0}n.putImageData(e.originalImageData,0,0),e.imageData=e.originalImageData}});this.Comic=t,kf.fabric.Image.filters.Comic=t,kf.fabric.Image.filters.Comic.fromObject=kf.fabric.Image.filters.BaseFilter.fromObject})),Ep=p((function e(){f(this,e),g(this,"ColorScale",void 0);var t=kf.fabric.util.createClass(kf.fabric.Image.filters.BaseFilter,{type:"ColorScale",input_shadows:0,input_highlights:255,initialize:function(e){this.setOptions(r({type:"ColorScale",webgl:!1},e))},applyTo2d:function(e){for(var t=this.input_shadows,r=this.input_highlights,i=e.imageData.data,n=0;n<i.length;n+=4){var a=i[n+0],s=i[n+1],o=i[n+2];i[n+0]=(a-t)/(r-t)*255+0,i[n+1]=(s-t)/(r-t)*255+0,i[n+2]=(o-t)/(r-t)*255+0,i[n+0]=Math.min(255,Math.max(0,i[n+0])),i[n+1]=Math.min(255,Math.max(0,i[n+1])),i[n+2]=Math.min(255,Math.max(0,i[n+2]))}}});this.ColorScale=t,kf.fabric.Image.filters.ColorScale=t,kf.fabric.Image.filters.ColorScale.fromObject=kf.fabric.Image.filters.BaseFilter.fromObject})),Tp=p((function e(){f(this,e),g(this,"Mesh",new Sp),g(this,"Sketch",new Cp),g(this,"Comic",new Up),g(this,"ColorScale",new Ep)})),Mp=1,Op=1,Pp=["top","centerY","bottom"],Ap=["left","centerX","right"],Ip=function(){function e(t){f(this,e),g(this,"switch",!0),g(this,"unit",void 0),g(this,"el",void 0),g(this,"name","referLine"),g(this,"options",void 0),g(this,"selectArray",[]),g(this,"coordsArray",[]),g(this,"cacheTop",void 0),g(this,"cacheLeft",void 0),g(this,"gaps",{top:0,bottom:0,centerY:0,left:0,right:0,centerX:0}),g(this,"threshold",3),g(this,"startPoint",{}),g(this,"mousePoint",{}),g(this,"adsorbOffset",{x:0,y:0}),g(this,"XreferLineArray",[[],[],[]]),g(this,"YreferLineArray",[[],[],[]]),this.unit=t.unit,this.options=t}return p(e,[{key:"setOpenAdsorb",value:function(e){this.switch=e}},{key:"getAllIndex",value:function(e,t){var r=[];return t.forEach((function(t,i){t===e&&r.push(i)})),r}},{key:"getObjectRect",value:function(e){var t=e.getBoundingRect(!0);return{el:e,top:Number(t.top),bottom:Number(t.top+t.height),centerY:Number(t.top+t.height/2),left:Number(t.left),right:Number(t.left+t.width),centerX:Number(t.left+t.width/2),width:t.width,height:t.height}}},{key:"calcXY",value:function(e,t){var r=this;if(this.switch&&this.coordsArray.length){!this.startPoint.x&&t&&(this.startPoint=this.options.getPointer(t)),this.cacheLeft=void 0,this.cacheTop=void 0,Op=this.options.getZoom(),Mp=1/Op,this.clearReferLine();var i,n,a=this.getObjectRect(e),s=[],o=[];this.coordsArray.forEach((function(e){var t=[];Pp.forEach((function(r){var i=[Math.abs(a.top-e[r]),Math.abs(a.bottom-e[r]),Math.abs(a.centerY-e[r])],n=Math.min.apply(Math,i);t.push(Number(n.toFixed(1)))}));var c=Math.min.apply(Math,t);if(c<r.threshold&&(n||(n=c),c<n&&(s=[],n=c),c<=n)){var l=r.getAllIndex(c,t),u=[];l.forEach((function(t){s.length||u.push(Pp[t]),s.length&&s[0].val[Pp[t]]===e[Pp[t]]&&u.push(Pp[t])})),u.length&&s.push({keys:u,val:e})}var h=[];Ap.forEach((function(t){var r=[Math.abs(a.left-e[t]),Math.abs(a.right-e[t]),Math.abs(a.centerX-e[t])],i=Math.min.apply(Math,r);h.push(Number(i.toFixed(1)))}));var f=Math.min.apply(Math,h);if(f<r.threshold&&(i||(i=f),f<i&&(o=[],i=f),f<=i)){var d=r.getAllIndex(f,h),p=[];d.forEach((function(t){o.length||p.push(Ap[t]),o.length&&o[0].val[Ap[t]]===e[Ap[t]]&&p.push(Ap[t])})),p.length&&o.push({keys:p,val:e})}})),(s.length||o.length)&&(o.length&&(this.cacheLeft=o,this.createXLine(o,a)),s.length&&(this.cacheTop=s,this.createYLine(s,a)),t&&this.mouseAdsorb(a))}}},{key:"createXLine",value:function(e,t){var i,n,a,s,o=[],c=[],l=new Array(3),u=new Array(3),h=new Array(3);e.forEach((function(e){var i=Math.min(e.val.top,t.top),n=Math.max(e.val.bottom,t.bottom),a=!1;e.val.el.intersectsWithObject(t.el)||e.val.top<=t.top&&e.val.bottom>=t.top||e.val.bottom>=t.bottom&&e.val.top<=t.bottom||(a=!0),e.keys.forEach((function(s){var c,f=Number(e.val[s]);if("centerX"===s&&(f-=Mp/2),"right"===s&&(f-=Mp),a){var d=function(r){e.val.bottom>t.bottom?(!ct(u[r])||u[r]>e.val.top)&&(u[r]=e.val.top):(!ct(l[r])||l[r]<e.val.bottom)&&(l[r]=e.val.bottom)},p=e.val[e.keys[0]];switch("centerX"===e.keys[0]&&(p-=Mp/2),"right"===e.keys[0]&&(p-=Mp),e.keys[0]){case"left":h[0]=p,d(0);break;case"centerX":h[1]=p,d(1);break;case"right":h[2]=p,d(2)}c=new kf.fabric.Line([f,i,f,n],r({},Lp()))}else c=new kf.fabric.Line([f,i,f,n],r({},Lp()));o.push(c)}))})),(i=this.XreferLineArray[0]).push.apply(i,o),(n=this.options).addElement.apply(n,o);for(var f=0;f<h.length;f++){var d=h[f];l[f]&&c.push(new kf.fabric.Line([d,l[f],d,t.top],r(r({},Lp()),{},{stroke:"red"}))),u[f]&&c.push(new kf.fabric.Line([d,t.bottom,d,u[f]],r(r({},Lp()),{},{stroke:"red"})))}c.length&&(this.createGap(c,!1),(a=this.XreferLineArray[1]).push.apply(a,c),(s=this.options).addElement.apply(s,c))}},{key:"createYLine",value:function(e,t){var i,n,a,s,o=[],c=[],l=new Array(3),u=new Array(3),h=new Array(3);e.forEach((function(e){var i=Math.min(e.val.left,t.left),n=Math.max(e.val.right,t.right),a=!1;e.val.el.intersectsWithObject(t.el)||e.val.left<=t.left&&e.val.right>=t.left||e.val.right>=t.right&&e.val.left<=t.right||(a=!0),e.keys.forEach((function(s){var c,f=Number(e.val[s]);if("centerY"===s&&(f-=Mp/2),"bottom"===s&&(f-=Mp),a){var d=function(r){e.val.left>t.left?(!ct(u[r])||u[r]>e.val.left)&&(u[r]=e.val.left):(!ct(l[r])||l[r]<e.val.right)&&(l[r]=e.val.right)},p=e.val[e.keys[0]];switch("centerY"===e.keys[0]&&(p-=Mp/2),"bottom"===e.keys[0]&&(p-=Mp),e.keys[0]){case"top":h[0]=p,d(0);break;case"centerY":h[1]=p,d(1);break;case"bottom":h[2]=p,d(2)}c=new kf.fabric.Line([i,f,n,f],r({},Lp()))}else c=new kf.fabric.Line([i,f,n,f],r({},Lp()));o.push(c)}))})),(i=this.YreferLineArray[0]).push.apply(i,o),(n=this.options).addElement.apply(n,o);for(var f=0;f<h.length;f++){var d=h[f];l[f]&&c.push(new kf.fabric.Line([l[f],d,t.left,d],r(r({},Lp()),{},{stroke:"red"}))),u[f]&&c.push(new kf.fabric.Line([t.right,d,u[f],d],r(r({},Lp()),{},{stroke:"red"})))}c.length&&(this.createGap(c,!0),(a=this.YreferLineArray[1]).push.apply(a,c),(s=this.options).addElement.apply(s,c))}},{key:"createGap",value:function(e,t){for(var i,n=[],a=0;a<e.length;a++){var s=e[a],o=s.getPointByOrigin("center","center"),c=new kf.fabric.Text("".concat(gp(t?s.width:s.height,this.unit)).concat(this.unit),r(r({},Lp()),{},{fill:"red",stroke:void 0,fontSize:16/Op}));t?(c.setPositionByOrigin(o,"center","bottom"),this.YreferLineArray[2].push(c)):(c.setPositionByOrigin(o,"right","center"),this.XreferLineArray[2].push(c)),n.push(c)}(i=this.options).addElement.apply(i,n)}},{key:"mouseAdsorb",value:function(e){var t=this;if(this.XreferLineArray[0].length){var r,i=this.XreferLineArray[0][0].x1,n=Math.min(Math.abs(e.left-i),Math.abs(e.centerX-i),Math.abs(e.right-i));Ap.forEach((function(r){var a=e[r];Math.abs(a-i)===n&&("left"===r&&(i+=t.gaps.left),"centerX"===r&&(i=i-e.width/2+t.gaps.left),"right"===r&&(i=i-e.width+Mp+t.gaps.left))})),Math.abs(i-e.el.left)>this.threshold+Mp&&(i=e.el.left,this.cacheLeft=void 0,delete this.mousePoint.x),null===(r=e.el)||void 0===r||r.set({left:i})}if(this.YreferLineArray[0].length){var a,s=this.YreferLineArray[0][0].y1,o=Math.min(Math.abs(e.top-s),Math.abs(e.centerY-s),Math.abs(e.bottom-s));Pp.forEach((function(r){var i=e[r];Math.abs(i-s)===o&&("top"===r&&(s+=t.gaps.top),"centerY"===r&&(s=s-e.height/2+t.gaps.top),"bottom"===r&&(s=s-e.height+Mp+t.gaps.top))})),Math.abs(s-e.el.top)>this.threshold+Mp&&(s=e.el.top,this.cacheTop=void 0),null===(a=e.el)||void 0===a||a.set({top:s})}this.options.renderAll();var c=this.getObjectRect(e.el);this.clearReferLine(),this.cacheLeft&&this.createXLine(this.cacheLeft,c),this.cacheTop&&this.createYLine(this.cacheTop,c)}},{key:"setGaps",value:function(){var e=this.options.getActiveObject(),t=this.getObjectRect(e);this.gaps.top=Math.abs(Number((Number(e.top)-t.top).toFixed(1))),this.gaps.centerY=Math.abs(Number((Number(e.top)-t.centerY).toFixed(1))),this.gaps.bottom=Math.abs(Number((Number(e.top)-t.bottom).toFixed(1))),this.gaps.left=Math.abs(Number((Number(e.left)-t.left).toFixed(1))),this.gaps.centerX=Math.abs(Number((Number(e.left)-t.centerX).toFixed(1))),this.gaps.right=Math.abs(Number((Number(e.left)-t.right).toFixed(1)))}},{key:"onSelectionUpdated",value:function(e){this.onMouseDown(e)}},{key:"onSelectionCreated",value:function(e){this.onMouseDown(e)}},{key:"onMouseDown",value:function(e){var t=this;if(this.el=e,null!=e&&e.selected){this.setGaps();var r=e.selected;if(this.clearObjects(),r.forEach((function(e){var r=e.getBoundingRect(!0),i={id:e.id,name:e.name,top:r.top,bottom:r.top+r.height,centerY:r.top+r.height/2,left:r.left,right:r.left+r.width,centerX:r.left+r.width/2,width:r.width,height:r.height};t.selectArray.push(i)})),!this.coordsArray.length)this.options.getAllValidObjects().forEach((function(e){if(e.id&&e.name){for(var r=0;r<t.selectArray.length;r++){if(t.selectArray[r].id===e.id)return}var i=e.getBoundingRect(!0),n={el:e,id:e.id,name:e.name,top:i.top,bottom:i.top+i.height,centerY:i.top+i.height/2,left:i.left,right:i.left+i.width,centerX:i.left+i.width/2,width:i.width,height:i.height};t.coordsArray.push(n)}return e.id&&e.name}))}}},{key:"onMouseUp",value:function(){this.startPoint={},this.mousePoint={},this.cacheLeft=void 0,this.cacheTop=void 0,this.adsorbOffset={x:0,y:0},this.clearReferLine()}},{key:"clearObjects",value:function(){this.selectArray=[],this.coordsArray=[]}},{key:"clearReferLine",value:function(){var e=this;this.XreferLineArray.forEach((function(t){t.forEach((function(t){e.options.removeElement(t)}))})),this.YreferLineArray.forEach((function(t){t.forEach((function(t){e.options.removeElement(t)}))})),this.XreferLineArray=[[],[],[]],this.YreferLineArray=[[],[],[]]}},{key:"onUnitChange",value:function(e){this.unit=e}}]),e}();function Lp(){return{strokeWidth:Mp,stroke:$h.stroke,evented:!1,selectable:!1}}var jp=function(){function e(){f(this,e),g(this,"_stack",void 0),this._stack=[]}return p(e,[{key:"push",value:function(e){this._stack.push(e)}},{key:"pop",value:function(){return this._stack.pop()}},{key:"top",value:function(){return this._stack[this._stack.length-1]}},{key:"isEmpty",value:function(){return 0===this._stack.length}},{key:"getStack",value:function(){return this._stack}},{key:"clear",value:function(){this._stack=[]}}]),e}(),Rp=function(){function e(t){f(this,e),g(this,"operateStack",void 0),g(this,"redoStack",void 0),g(this,"maxLimit",50),g(this,"options",void 0),this.options=t,this.operateStack=new jp,this.redoStack=new jp,this.maxLimit=t.operateMaxLimit||this.maxLimit}return p(e,[{key:"pushCommand",value:function(e,t){var r={};e.forEach((function(e){r[e.id]=e})),this.operateStack.push({allIds:t,objJsons:r}),this.redoStack.clear()}},{key:"undo",value:function(){if(!this.operateStack.isEmpty()){var e=this.operateStack.pop();if(e){this.redoStack.push(e);var t=this.operateStack.top();this.update(e,t)}else console.log("清除舞台")}}},{key:"redo",value:function(){if(!this.redoStack.isEmpty()){var e=this.redoStack.pop();if(e){var t=this.operateStack.top();this.update(t,e),this.operateStack.push(e)}else console.log("无操作")}}},{key:"update",value:function(e,t){var r,i,n,a=this,s=new Set(null==t?void 0:t.allIds),o=new Set(null==e?void 0:e.allIds),c=[],l=[],u=[];(s.forEach((function(r){var i=a.findObjAttribute(r,t);i&&(o.has(r)?((e.objJsons[r]||t.objJsons[r])&&u.push(i),o.delete(r)):l.push(i))})),o.forEach((function(e){c.push(e)})),c.length>0)&&(console.log("delete>>>"),(r=this.options).removeElement.apply(r,c));l.length>0&&(console.log("add>>>"),(i=this.options).addElement.apply(i,l));u.length>0&&(console.log("update>>>"),(n=this.options).updateElement.apply(n,u))}},{key:"findObjAttribute",value:function(e,t){if(t.objJsons[e])return r({},t.objJsons[e]);for(var i=this.operateStack.getStack(),n=i.length-1;n>=0;n--)if(i[n].objJsons[e])return r({},i[n].objJsons[e]);return null}},{key:"getOperateStack",value:function(){return this.operateStack}},{key:"getRedoStack",value:function(){return this.redoStack}},{key:"destroy",value:function(){this.operateStack.clear(),this.redoStack.clear()}}]),e}(),Dp=function(e){return e.LEFT="left",e.RIGHT="right",e}(Dp||{}),Bp=function(e){return e.PLANE="plane",e.CYLINDER="cylinder",e}(Bp||{}),Fp=function(e){i(U,e);var t,s,o,c,l,u,d,b,y,_,w,x,k,S,C=n(U);function U(e){var t;return f(this,U),g(a(t=C.call(this)),"canvas",void 0),g(a(t),"isDrawing",void 0),g(a(t),"isDragMode",void 0),g(a(t),"drawType",void 0),g(a(t),"whiteScreen",void 0),g(a(t),"filters",new Tp),g(a(t),"drawMinSize",.5),g(a(t),"backgroundImg",void 0),g(a(t),"canvasOptions",void 0),g(a(t),"pluginManager",void 0),g(a(t),"operateManager",void 0),g(a(t),"referLine",void 0),g(a(t),"id",void 0),g(a(t),"screenChangeRatio",1),g(a(t),"preSelection",void 0),g(a(t),"viewportRatio",.9),g(a(t),"svgPath",""),g(a(t),"svgSize",100),g(a(t),"isImageExtrac",!1),g(a(t),"pathText",""),g(a(t),"batchPreview",[]),g(a(t),"unit",void 0),g(a(t),"workMode",void 0),g(a(t),"originStageWidth",void 0),g(a(t),"originStageHeight",void 0),t.unit=e.unit,kf.fabric.enableGLFiltering=!1,t.canvasOptions=r({minZoom:.6,maxZoom:5},e),t.originStageWidth=t.canvasOptions.stageWidth,t.originStageHeight=t.canvasOptions.stageHeight,t.workMode=Bp.PLANE,t.canvas=new kf.fabric.Canvas(e.container,{backgroundColor:"rgb(230,230,230)",imageSmoothingEnabled:!1,selection:!e.noSelection}),e.viewportRatio&&(t.viewportRatio=e.viewportRatio),kf.fabric.Object.prototype.objectCaching=!1,e.isOpenControlIcon&&new Uf(kf.fabric,a(t)),t.canvas.setWidth(e.width),t.canvas.setHeight(e.height),t.isDrawing=!1,t.isDragMode=!1,t.drawType=Vh.NONE,t.pluginManager=new kp,t.operateManager=new Rp({operateMaxLimit:t.canvasOptions.operateMaxLimit||50,addElement:t.addElementFromJson.bind(a(t)),removeElement:t.removeElementFromJson.bind(a(t)),updateElement:t.updateElementFromJson.bind(a(t))}),t.initBackdrop(e),t.addIntelligentAdsorptionPlugin(),t.initEventListener(),t.initDragMode(),t.initDrawTools(),t.initPluginManagre({stageBorCor:e.stageBorCor||""}),t.throttleRender=function(e,t,r){var i=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Re(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),be(e,t,{leading:i,maxWait:t,trailing:n})}(t.throttleRender,20),t.centerStage=be(t.centerStage,100),t.id=e.id||bp("canvas"),console.log("Running at fabric.js ".concat(kf.fabric.version," timeStamp: ").concat(new Date)),t.setPreciseSelection(e.perPixelTargetFind),t.setOpenAdsorb(e.openAdsorb),t.canvas.preserveObjectStacking=!0,t.bindListener(),t}return p(U,[{key:"toggleControlsCanvas",value:function(e){this.canvas=e,new Uf(kf.fabric,this)}},{key:"initBackdrop",value:function(e){this.whiteScreen=new kf.fabric.Rect({left:0,top:0,width:e.stageWidth||400,height:e.stageHeight||300,fill:"white",strokeWidth:0,strokeUniform:!0,selectable:!1,evented:!1}),this.canvas.add(this.whiteScreen);var t=new kf.fabric.Point((this.canvas.getWidth()-(this.whiteScreen.width||0))/2,(this.canvas.getHeight()-(this.whiteScreen.height||0))/2);this.canvas.relativePan(t),this.centerStage()}},{key:"addIntelligentAdsorptionPlugin",value:function(){var e=new Ip({addElement:this.canvas.add.bind(this.canvas),removeElement:this.canvas.remove.bind(this.canvas),getObjects:this.canvas.getObjects.bind(this.canvas),whiteScreenData:this.whiteScreenData,getAllValidObjects:this.getAllValidObjects.bind(this),getZoom:this.getZoom.bind(this),getPointer:this.canvas.getPointer.bind(this.canvas),renderAll:this.canvas.renderAll.bind(this.canvas),getActiveObject:this.canvas.getActiveObject.bind(this.canvas),unit:this.unit});this.addPlugin(e)}},{key:"initPluginManagre",value:function(e){var t=this;if(this.canvasOptions.plugins){var i=this.getCanvasDetail();this.pluginManager.parse(this.canvasOptions.plugins,r(r(r({stageWidth:this.canvasOptions.stageWidth,stageHeight:this.canvasOptions.stageHeight},i),e),{},{unit:this.unit,addElement:function(e){t.canvas.add(e)},removeElement:function(e){t.canvas.remove(e)},renderCanvas:function(){t.canvas.requestRenderAll()},setSelectable:this.setSelectable.bind(this),getPointer:function(e){return t.canvas.getPointer(e.e)},getObjects:function(){return t.canvas.getObjects()},setSelection:function(e){e?t.canvas.setActiveObject(e):t.canvas.discardActiveObject()},reCalcStrokeWidth:function(){t.reCalcStrokeWidth.apply(t,arguments)},getZoom:function(){return t.getZoom()},exitDrawMode:function(){return t.exitDrawMode()},setDefaultCursor:function(){t.setCursor(Zh.default)},setOpenAdsorb:function(e){t.setOpenAdsorb(e)},recordOperate:this.recordOperate.bind(this),client:this.canvasOptions.client||"PC"}))}}},{key:"bindListener",value:function(){this.onDrawPathTextMouseUp=this.onDrawPathTextMouseUp.bind(this),this.onEndDraw=this.onEndDraw.bind(this)}},{key:"throttleRender",value:function(){this.canvas.requestRenderAll()}},{key:"resize",value:function(e,t){ct(e)&&(this.canvas.setWidth(e),this.canvasOptions.width=e),ct(t)&&(this.canvasOptions.height=t,this.canvas.setHeight(t)),this.centerStage()}},{key:"setCursor",value:function(e){this.canvas.defaultCursor=e,this.canvas.setCursor(e)}},{key:"setBorderHover",value:function(e,t){"image"!==(null==e?void 0:e.type)&&(t?null==e||e.set({stroke:af.hoverBorderColor}):null==e||e.set({stroke:e.originStroke?e.originStroke:af.borderColor}),this.canvas.requestRenderAll())}},{key:"initEventListener",value:function(){var e=this;this.canvas.on("mouse:down",(function(t){de(e.pluginManager.onMouseDown)&&e.pluginManager.onMouseDown(t),e.setBorderHover(t.target,!1),e.emit(ef.MOUSE_DOWN,t),"Mobile"===e.canvasOptions.client&&t.target&&ut("canvasMouseDown",(function(){e.canvas.fire("mouse:dblclick",t)}))})),this.canvas.on("mouse:move",(function(t){de(e.pluginManager.onMouseMove)&&e.pluginManager.onMouseMove(t),e.emit(ef.MOUSE_MOVE,t)})),this.canvas.on("mouse:up",(function(t){de(e.pluginManager.onMouseUp)&&e.pluginManager.onMouseUp(t),e.emit(ef.MOUSE_UP,t)})),this.canvas.on("mouse:over",(function(t){e.setBorderHover(t.target,!0)})),this.canvas.on("mouse:out",(function(t){var r;(null===(r=t.target)||void 0===r?void 0:r.type)===sf?t.target.getObjects().forEach((function(t){e.setBorderHover(t,!1)})):e.setBorderHover(t.target,!1)})),this.canvas.on("mouse:dblclick",(function(t){e.isDragMode||(de(e.pluginManager.onMouseDblClick)&&e.pluginManager.onMouseDblClick(t),t.target&&Object.hasOwn(t.target,"hasBezierControl")&&t.target.hasBezierControl&&e.setOpenAdsorb(!1))}));var t=!1,r=be(v(m().mark((function t(){var r,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(r=e.selection)&&(i=e.calcObjProperty(r),e.emit(ef.ELEMENT_MODIFY,i));case 2:case"end":return t.stop()}}),t)}))),100),i=function(){e.canvas.selection&&(t=!0,r(),de(e.pluginManager.adsorbSetGaps)&&e.pluginManager.adsorbSetGaps())},n=function(){var t,r=e.selection;window.selected=r,r&&(t=e.calcObjProperty(r),e.emit(ef.SELECTION_CHANGE,t,r))};this.canvas.on("selection:updated",(function(t){de(e.pluginManager.onSelectionUpdated)&&e.pluginManager.onSelectionUpdated(t),n()})).on("selection:created",(function(t){de(e.pluginManager.onSelectionCreated)&&e.pluginManager.onSelectionCreated(t),n()})).on("object:added",(function(t){var r;null!==(r=t.target)&&void 0!==r&&r.id&&e.emit(ef.ADDED,t)})).on("object:removed",(function(t){var r;null!==(r=t.target)&&void 0!==r&&r.id&&e.emit(ef.REMOVED,t)})).on("selection:cleared",(function(){e.emit(ef.SELECTION_CLEAR),window.selected=null})).on("text:changed",i).on("object:moving",(function(t){t.target&&e.canvas.selection&&de(e.pluginManager.adsorbCalcXY)&&e.pluginManager.adsorbCalcXY(t),i()})).on("object:scaling",(function(){e.selection&&e.reCalcStrokeWidth(e.selection),i()})).on("object:rotating",i).on("object:skewing",i).on("mouse:up",function(){var r=v(m().mark((function r(i){var n,a;return m().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=16;break}if(t=!1,!(n=e.selection)){r.next=16;break}if(de(e.pluginManager.onMouseUp)&&e.pluginManager.onMouseUp(i),n.type===sf||n.name===$h.name){r.next=7;break}return r.abrupt("return");case 7:if(n.type!==sf){r.next=14;break}return r.next=10,e.transformGroup(n);case 10:a=r.sent,e.recordOperate.apply(e,h(a)),r.next=15;break;case 14:e.recordOperate(n);case 15:e.computedElementZindex();case 16:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}},{key:"_toFixed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Number(e.toFixed(t))}},{key:"toJSON",value:function(e){var t=this,r=e.left,i=void 0===r?0:r,n=e.top,a=void 0===n?0:n,s=e.width,o=void 0===s?0:s,c=e.height,l=void 0===c?0:c,u=e.angle,h=void 0===u?0:u,f=e.scaleX,d=void 0===f?0:f,p=e.scaleY,m=void 0===p?0:p,b=e.isLock,v=void 0===b||b,g=e.type,y=e.hasBezierControl,_=e.isVariableThickness,w=e.hasControls,x=e.originStroke,k={id:e.id,type:g,left:i,top:a,width:o*d,height:l*m,angle:this._toFixed(h),isLock:v,hasBezierControl:y,isVariableThickness:_,hasControls:w,originStroke:x};if(e.type===rf.IText&&(k.hasPath=!!e.path),g===sf){var S=e.getObjects().map((function(e){return t.toJSON(e)}));k.children=S}return k}},{key:"getCanvasData",value:(S=v(m().mark((function e(){var t,r,i,n,a,s,o;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),t=this.getAllValidObjects(),r=[],i=0;case 5:if(!(i<t.length)){e.next=28;break}if(t[i].type!==rf.group){e.next=21;break}return e.next=9,this.transformGroup(t[i]);case 9:n=e.sent,a=0;case 11:if(!(a<n.length)){e.next=19;break}return e.next=14,Qd.toObject(n[a]);case 14:s=e.sent,r.push(s);case 16:a++,e.next=11;break;case 19:e.next=25;break;case 21:return e.next=23,Qd.toObject(t[i]);case 23:o=e.sent,r.push(o);case 25:i++,e.next=5;break;case 28:return e.abrupt("return",r);case 29:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{key:"addPlugin",value:function(e){this.pluginManager.addPlugin(e)}},{key:"removePlugin",value:function(e){this.pluginManager.removePlugin(e)}},{key:"drawShape",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:60,y:60},i=null,n=(this.originStageWidth-t.x)/2,a=(this.originStageHeight-t.y)/2;switch(e){case Vh.TRIANGLE:i=new kf.fabric.Triangle(r(r({},Np()),{},{left:n,top:a,width:t.x,height:t.y}));break;case Vh.CIRCLE:i=new kf.fabric.Ellipse(r(r({},Np()),{},{left:n,top:a,rx:t.x/2,ry:t.y/2}));break;case Vh.RECT:i=new kf.fabric.Rect(r(r({},Np()),{},{left:n,top:a,width:t.x,height:t.y}))}i&&(this.reCalcStrokeWidth(i),this.canvas.add(i),this.setObjectControlsToUnlock(),this.canvas.setActiveObject(i).requestRenderAll())}},{key:"initDrawTools",value:function(){var e,t,i=this,n={name:"drawTool",onMouseDown:function(n){if(!n.target&&i.isDrawing&&!e){switch(i.canvas.selection=!1,t=i.canvas.getPointer(n.e),i.drawType){case Vh.RECT:e=new kf.fabric.Rect(r(r({},Np()),{},{left:t.x,top:t.y,width:0,height:0}));break;case Vh.CIRCLE:e=new kf.fabric.Ellipse(r(r({},Np()),{},{left:t.x,top:t.y,rx:0,ry:0}));break;case Vh.LINE:e=new kf.fabric.Line([t.x,t.y,t.x,t.y],Np());break;case Vh.TEXT:e=new kf.fabric.IText("Hello",r(r({},Np()),{},{left:t.x,top:t.y,fontFamily:"Times New Roman"}));break;case Vh.TRIANGLE:e=new kf.fabric.Triangle(r(r({},Np()),{},{left:t.x,top:t.y,width:0,height:0}));break;case Vh.SVG:i.handleSvgImage(t.x,t.y)}e&&(i.reCalcStrokeWidth(e),e.originStroke=Jh.engrave,i.canvas.add(e)),i.setObjectControlsToUnlock()}},onMouseMove:function(r){if(i.isDrawing&&e){var n=i.canvas.getPointer(r.e)||{x:0,y:0},a=Math.min(n.x,t.x),s=Math.min(n.y,t.y),o=Math.abs(n.x-t.x),c=Math.abs(n.y-t.y),l=r.e.shiftKey,u=r.e.altKey;switch(l&&(o=c=Math.max(o,c)),u?(e.set({originX:"center",originY:"center"}),o*=2,c*=2):e.set({originX:"left",originY:"top"}),i.drawType){case Vh.RECT:e.set({left:a,top:s,width:o,height:c});break;case Vh.CIRCLE:e.set({left:a,top:s,rx:o/2,ry:c/2});break;case Vh.LINE:var h=t.x,f=t.y,d=n.x,p=n.y;if(l)Math.abs(h-d)>Math.abs(f-p)?p=f:d=h;if(u)h-=d-h,f-=p-f;e.set({x1:h,y1:f,x2:d,y2:p});break;case Vh.TRIANGLE:e.set({left:a,top:s,width:o,height:c})}i.canvas.requestRenderAll()}},onMouseUp:function(t){if(i.isDrawing){if(i.isDrawing=!1,i.canvas.selection=!0,i.setCursor(Zh.default),e){if(i.drawType!==Vh.TEXT&&Number(e.width)<i.drawMinSize&&Number(e.height)<i.drawMinSize)return i.canvas.remove(e),e.off(),void(e=null);if(t.e.altKey){var r=e.getPointByOrigin("left","top"),n=r.x,a=r.y;e.set({left:n,top:a,originX:"left",originY:"top"})}e.setCoords(),i.computedElementZindex(),i.recordOperate(e),i.canvas.setActiveObject(e).requestRenderAll()}e=null}}};this.addPlugin(n)}},{key:"selection",get:function(){return this.canvas.getActiveObject()}},{key:"selections",get:function(){return this.canvas.getActiveObjects()}},{key:"whiteScreenData",get:function(){return this.whiteScreen.toObject()}},{key:"initDragMode",value:function(){var e=this,t=!1,r={name:"dragStage",onMouseDown:function(){e.isDragMode&&(e.canvas.selection=!1,t=!0)},onMouseMove:function(r){var i=r.e;if(e.isDragMode&&(e.setCursor(Zh.grab),t)){var n=new kf.fabric.Point(i.movementX,i.movementY);if(e.canvas.relativePan(n),de(e.pluginManager.onCanvasDraging)){var a=e.getCanvasDetail();e.pluginManager.onCanvasDraging(a)}}},onMouseUp:function(){t=!1,e.isDragMode&&(e.canvas.selection=!0,e.isDragMode&&e.setCursor(Zh.grab))}};this.addPlugin(r)}},{key:"startImageExtract",value:function(){this.isImageExtrac=!0,this.resize(this.canvasOptions.width,this.canvasOptions.height),this.setSelectable(!1),this.canvas.discardActiveObject(),this.backgroundImg.moveTo(this.canvas.getObjects().length)}},{key:"stopImageExtract",value:function(){this.isImageExtrac=!1,this.setSelectable(!0),this.backgroundImg.moveTo(1)}},{key:"startDrawRect",value:function(){this.drawType=Vh.RECT,this.isDrawing=!0,this.setCursor(Zh.crosshair)}},{key:"startDrawCircle",value:function(){this.drawType=Vh.CIRCLE,this.isDrawing=!0,this.setCursor(Zh.crosshair)}},{key:"startDrawLine",value:function(){this.drawType=Vh.LINE,this.isDrawing=!0,this.setCursor(Zh.crosshair)}},{key:"startDrawText",value:function(){this.drawType=Vh.TEXT,this.isDrawing=!0,this.setCursor(Zh.text)}},{key:"reverseTextPathSide",value:function(){var e=this.selection;e&&e.type===rf.IText&&e.path&&(e.pathSide===Dp.LEFT?e.pathSide=Dp.RIGHT:e.pathSide=Dp.LEFT,this.recordOperate(e))}},{key:"convertPathToText",value:function(e){var t=this.selection,r=this.createTextFromPath(e,t);r&&(this.canvas.remove(t),this.recordOperate(r,t))}},{key:"convertElementToText",value:(k=v(m().mark((function e(t){var r,i=this;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.selection)&&(r.type===rf.path?this.convertPathToText(t):r.clone(function(){var e=v(m().mark((function e(n){var a,s,o,c,l,u,h,f,d,p;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.set("fill","black"),a=n.toDataURL({multiplier:5}),s=n.getBoundingRect(!0),o=s.left,c=s.top,e.next=6,Xd(a,5,o,c);case 6:l=e.sent,u=new DOMParser,h=u.parseFromString(l,"image/svg+xml"),(f=h.getElementsByTagName("path")[0].getAttribute("d"))&&((d=new kf.fabric.Path(f)).set({fill:"",stroke:"orange"}),i.reCalcStrokeWidth(d),(p=i.createTextFromPath(t,d))&&(i.canvas.remove(r),i.recordOperate(p,r)));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"createTextFromPath",value:function(e,t){if(!(Number(t.width)<.1||Number(t.height)<.1)){var i=kf.fabric.util.transformPath(t.path,t.calcTransformMatrix(),t.pathOffset);t=new kf.fabric.Path(i,t);var n=kf.fabric.util.getPathSegmentsInfo(i),a=new kf.fabric.IText(e,r({fontFamily:"Times New Roman",path:t,top:t.top,left:t.left},Np())),s=a.measureLine(0).width/e.length,o=n[n.length-1].length/e.length;if(s>o){var c=o/s*40;a.set({fontSize:c>>0})}var l=1e3*(o-s)/40;l<0&&(l=0),a.set({charSpacing:l>>0}),this.reCalcStrokeWidth(a);var u=Number(a.width)-a.path.width,h=Number(a.height)-a.path.height;return a.set({left:Number(a.left)-u/2,top:Number(a.top)-h/2}),this.canvas.add(a),this.canvas.setActiveObject(a),a}this.canvas.isDrawingMode=!1}},{key:"onDrawPathTextMouseUp",value:function(e){var t=e.path,r=this.createTextFromPath(this.pathText,t);r&&this.recordOperate(r),this.canvas.isDrawingMode=!1,this.canvas.off("before:path:created",this.onDrawPathTextMouseUp)}},{key:"onEndDraw",value:function(e){this.canvas.remove(e.path),this.canvas.off("path:created",this.onEndDraw)}},{key:"startDrawPathText",value:function(e){this.canvas.isDrawingMode=!0,this.pathText=e,this.canvas.off("before:path:created",this.onDrawPathTextMouseUp),this.canvas.off("path:created",this.onEndDraw),this.canvas.on("before:path:created",this.onDrawPathTextMouseUp),this.canvas.on("path:created",this.onEndDraw)}},{key:"startDrawPen",value:function(){this.setSelectable(!1);var e=this.pluginManager.getPlugin("pen");e&&(this.setOpenAdsorb(!1),this.setCursor(Zh.crosshair),e._plugin.startDrawPen())}},{key:"startDrawTriangle",value:function(){this.drawType=Vh.TRIANGLE,this.isDrawing=!0,this.setCursor(Zh.crosshair)}},{key:"startDrawSvg",value:function(e){this.svgPath=e,this.drawType=Vh.SVG,this.isDrawing=!0,this.setCursor(Zh.crosshair)}},{key:"handleSvgImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=document.createElement("img");r.src=this.svgPath;var i=Math.min(this.svgSize/r.width,this.svgSize/r.width);this.loadResource(r,{scaleX:i,scaleY:i,top:t,left:e})}},{key:"moveElement",value:(x=v(m().mark((function e(t,r){var i,n,a,s,o,c;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=this.selection)){e.next=16;break}if(n=i.left,a=void 0===n?0:n,s=i.top,o=void 0===s?0:s,i.set({left:a+t,top:o+r}),i.setCoords(),this.throttleRender(),this.canvas.fire("object:moving"),!i){e.next=16;break}if(i.type!==sf){e.next=15;break}return e.next=11,this.transformGroup(i);case 11:c=e.sent,this.recordOperate.apply(this,h(c)),e.next=16;break;case 15:this.recordOperate(i);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"endDraw",value:function(){var e=this.pluginManager.getPlugin("drawTool");(null==e?void 0:e.onMouseUp)&&(null==e||e.onMouseUp({e:new MouseEvent("mouseup")}))}},{key:"exitDrawMode",value:function(){this.endDraw(),this.isDrawing=!1,this.canvas.isDrawingMode=!1,this.canvas.selection=!0,this.setCursor(Zh.default),this.canvas.discardActiveObject();var e=localStorage.getItem("setOption")?JSON.parse(localStorage.getItem("setOption")):{openAdsorb:!1,perPixelTargetFind:!1};if(this.setOpenAdsorb(e.openAdsorb),de(this.pluginManager.onExitDrawMode)){var t=this.getCanvasDetail();this.pluginManager.onExitDrawMode(t)}this.throttleRender()}},{key:"removeSelection",value:function(){var e;if(this.canvas.selection){var t=this.canvas.getActiveObjects();this.canvas.discardActiveObject(),(e=this.canvas).remove.apply(e,h(t)),this.recordOperate.apply(this,h(t))}}},{key:"startDragStage",value:function(){this.isDragMode||this.isImageExtrac||(this.isDragMode=!0,this.preSelection=this.canvas.getActiveObjects(),this.canvas.discardActiveObject(),this.setSelectableAll(!1),this.setCursor(Zh.grab))}},{key:"stopDragStage",value:function(){this.isDragMode&&!this.isImageExtrac&&(this.isDragMode=!1,this.setSelectableAll(!0),this.preSelection&&this.preSelection.length>0&&(1===this.preSelection.length?this.canvas.setActiveObject(this.preSelection[0]).requestRenderAll():this.selectAt(this.preSelection)),this.setCursor(Zh.default))}},{key:"setSelectableAll",value:function(e){var t=this.getAllValidObjects();null==t||t.forEach((function(t){t.selectable=e}))}},{key:"selectAll",value:function(){var e=this.getAllValidObjects();if(0!==e.length){this.canvas.discardActiveObject();var t=new kf.fabric.ActiveSelection(e,{canvas:this.canvas});this.canvas.setActiveObject(t),this.canvas.requestRenderAll()}}},{key:"selectAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canvas.discardActiveObject();var i=new kf.fabric.ActiveSelection(e,r({canvas:this.canvas},t));return this.canvas.setActiveObject(i),this.canvas.requestRenderAll(),i}},{key:"selectAtObj",value:function(e){this.canvas.discardActiveObject(),this.canvas.setActiveObject(e)}},{key:"undo",value:function(){console.log("undo"),this.operateManager.undo(),this.emit(ef.OPERATE)}},{key:"redo",value:function(){console.log("redo"),this.operateManager.redo(),this.emit(ef.OPERATE)}},{key:"reCalcStrokeWidth",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=[];0===t.length&&(t=this.getAllValidObjects()),t.forEach((function(e){e.type===sf||e.type===rf.group?i.push.apply(i,h(e.getObjects())):i.push(e)}));var n=this.canvas.getZoom();i.forEach((function(e){if(e.strokeWidth&&0!==e.strokeWidth){var t=Math.max(e.scaleX||1,e.scaleY||1),r=e.group?Math.max(Number(e.group.scaleX),Number(e.group.scaleY)):1,i=n*("i-text"===e.type?t*r:1);e.set("strokeWidth",$h.strokeWidth/i)}}))}},{key:"centerStage",value:function(){var e,t=this.canvas.getWidth(),r=this.canvas.getHeight(),i=(this.whiteScreen.width||0)/(this.whiteScreen.height||0),n=t*this.viewportRatio,a=r*this.viewportRatio,s=n/(this.whiteScreen.width||1),o=a/(this.whiteScreen.height||1);if(s<o?(e=new kf.fabric.Point(-(t-n)/2,-(r-n/i)/2),this.screenChangeRatio=s):(e=new kf.fabric.Point(-(t-a*i)/2,-(r-a)/2),this.screenChangeRatio=o),this.canvas.setZoom(this.screenChangeRatio),this.canvas.absolutePan(e),this.reCalcStrokeWidth(),this.emit(ef.ZOOM_IN,this.screenChangeRatio),de(this.pluginManager.onCanvasResize)){var c=this.getCanvasDetail();this.pluginManager.onCanvasResize(c)}}},{key:"zoomIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,r=this.canvas.getPointer(e,!0),i=this.canvas.getZoom()*t,n=this.canvasOptions.maxZoom||1;if(i>n&&(i=n),this.canvas.zoomToPoint(r,i),this.reCalcStrokeWidth(),de(this.pluginManager.onZoom)){var a=this.getCanvasDetail();this.pluginManager.onZoom(a)}this.throttleRender(),this.screenChangeRatio=i,this.emit(ef.ZOOM_IN,i)}},{key:"updateZoom",value:function(){this.reCalcStrokeWidth();var e=this.getCanvasDetail();this.pluginManager.onZoom(e)}},{key:"zoomOut",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,r=this.canvas.getPointer(e,!0),i=this.canvas.getZoom()/t,n=this.canvasOptions.minZoom||1;if(i<n&&(i=n),this.canvas.zoomToPoint(r,i),this.reCalcStrokeWidth(),de(this.pluginManager.onZoom)){var a=this.getCanvasDetail();this.pluginManager.onZoom(a)}this.throttleRender(),this.emit(ef.ZOOM_OUT,i)}},{key:"zoomFinger",value:function(e,t){if(this.canvas.zoomToPoint(e,t),de(this.pluginManager.onZoom)){var r=this.getCanvasDetail();this.pluginManager.onZoom(r)}this.screenChangeRatio=t,this.emit(ef.ZOOM_OUT,t)}},{key:"loadSVGFromString",value:function(e,t){var r=this;return new Promise((function(i){kf.fabric.loadSVGFromString(e,function(){var e=v(m().mark((function e(n){var a,s,o;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.forEach((function(e){var t=e.stroke?e.stroke:e.fill;r._strokeColorToProcessMode(t)&&e.set({originStroke:t}),e.set(Np())})),(a=r.canvas).add.apply(a,h(n)),s=r.selectAt(n),t&&t(s),r.reCalcStrokeWidth.apply(r,h(n)),r.computedElementZindex(),e.next=8,r.transformGroup(s);case 8:o=e.sent,r.recordOperate.apply(r,h(o)),r.setObjectControlsToLock(),r.throttleRender(),r.selectAt(n),i();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}},{key:"imagefromURL",value:function(e,t){var r=this;return new Promise((function(i){kf.fabric.Image.fromURL(e,(function(e){e.set({id:bp(),name:Qh}),r.canvas.add(e),r.computedElementZindex(),r.recordOperate(e),r.canvas.setActiveObject(e),r.setObjectControlsToLock(),i()}),t)}))}},{key:"setBackground",value:function(e,t){var r=(null==t?void 0:t.width)||this.originStageWidth||e.width,i=(null==t?void 0:t.height)||this.originStageHeight||e.height,n=r/e.width,a=i/e.height;this.backgroundImg?this.backgroundImg.setElement(e):(this.backgroundImg=new kf.fabric.Image(e),this.canvas.insertAt(this.backgroundImg,1,!1),this.workMode===Bp.PLANE?this.backgroundImg.set({angle:0,left:0}):this.backgroundImg.set({angle:90,left:this.originStageHeight})),this.backgroundImg.set({scaleX:n,scaleY:a}),this.backgroundImg.set({selectable:!1,evented:!1}),this.throttleRender()}},{key:"imageExtract",value:function(e){var t,r,i,n,a,s=this,o=this.canvas.getZoom(),c=this.canvasOptions.container.getBoundingClientRect(),l=this.canvas.viewportTransform[4],u=this.canvas.viewportTransform[5],h=c.left+l,f=c.top+u,d=!1;if(e.left>h?r=(e.left-h)/o:e.left<h&&(r=0),e.top>f?i=(e.top-f)/o:e.top<f&&(i=0),e.width+e.left>h&&(n=(e.width+e.left-h)/o),n>this.canvasOptions.stageWidth&&(n=this.canvasOptions.stageWidth),e.width+e.left<h&&(console.error("w error"),d=!0),e.height+e.top>f&&(a=(e.height+e.top-f)/o),a>this.canvasOptions.stageHeight&&(a=this.canvasOptions.stageHeight),e.height+e.top<f&&(console.error("h error"),d=!0),(r>this.canvasOptions.stageWidth||i>this.canvasOptions.stageHeight)&&(console.error("x || y error"),d=!0),d)return d;if(this.backgroundImg){var p=this.backgroundImg.scaleY,m=this.backgroundImg.scaleY;i/=m,a/=m,r/=p,n/=p;var b=null===(t=this.backgroundImg)||void 0===t?void 0:t.toDataURL({top:i,left:r,width:n-r,height:a-i,quality:1,withoutTransform:!0});kf.fabric.Image.fromURL(b,(function(e){e.set({id:bp(),name:Qh,top:i*m,left:r*p,scaleX:p,scaleY:m}),s.canvas.add(e),s.canvas.setActiveObject(e),s.recordOperate(e)}))}}},{key:"clearBackground",value:function(){var e;null!==(e=this.backgroundImg)&&void 0!==e&&e.canvas&&this.canvas.remove(this.backgroundImg),this.canvas.add(this.whiteScreen)}},{key:"updateProperty",value:function(e,t){var r=this,i=this.selections,n=this.selection;if(e in n&&i.length>0){if("fill"===e)i.forEach((function(e){if("image"!==e.type)switch(t){case Kh.engrave:e.set({fill:"",stroke:Jh.engrave,originStroke:Jh.engrave,strokeWidth:$h.strokeWidth}),r.reCalcStrokeWidth(e);break;case Kh.fillEngrave:e.set({fill:Jh.fillEngrave,stroke:Jh.fillEngrave,originStroke:Jh.fillEngrave});break;case Kh.cut:e.set({fill:"",stroke:Jh.cut,originStroke:Jh.cut,strokeWidth:$h.strokeWidth}),r.reCalcStrokeWidth(e)}}));else if("height"===e){var a=t/n.height;n.isLock?(n.set("scaleY",a),n.set("scaleX",a),this.emit(ef.UPDATE_ELEMENT_PROPERTY,{type:"width",value:Number((n.width*a).toFixed(1))})):n.set("scaleY",a),this.reCalcStrokeWidth(n),this.computedElementZindex()}else if("width"===e){var s=t/n.width;n.isLock?(n.set("scaleY",s),n.set("scaleX",s),this.emit(ef.UPDATE_ELEMENT_PROPERTY,{type:"height",value:Number((n.height*s).toFixed(1))})):n.set("scaleX",s),this.reCalcStrokeWidth(n),this.computedElementZindex()}else"angle"===e?n.rotate(t):n.set(e,t);i.length>=2?this.transformGroup(n).then((function(e){r.recordOperate.apply(r,h(e))})):this.recordOperate(n),this.throttleRender()}}},{key:"flipElement",value:(w=v(m().mark((function e(t){var r,i,n;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.canvas.getActiveObject())){e.next=16;break}if(r.rotate(-(r.angle||0)),"x"===t?r.toggle("flipX"):r.toggle("flipY"),r.setCoords(),this.canvas.requestRenderAll(),i=this.toJSON(r),r.type!==sf&&"group"!==r.type){e.next=14;break}return e.next=10,this.transformGroup(r);case 10:n=e.sent,this.recordOperate.apply(this,h(n)),e.next=15;break;case 14:this.recordOperate(r);case 15:this.emit(ef.ELEMENT_MODIFY,i);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"rotate",value:(_=v(m().mark((function e(t){var r,i,n;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.selection){e.next=3;break}return e.abrupt("return");case 3:if(r.rotate((r.angle||0)+t),r.setCoords(),this.canvas.requestRenderAll(),i=this.toJSON(r),r.type!==sf&&"group"!==r.type){e.next=14;break}return e.next=10,this.transformGroup(r);case 10:n=e.sent,this.recordOperate.apply(this,h(n)),e.next=15;break;case 14:this.recordOperate(r);case 15:this.emit(ef.ELEMENT_MODIFY,i);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"getZoom",value:function(){return this.canvas.getZoom()}},{key:"setZoomToCenterPoint",value:function(e){var t=this.canvas.getCenterPoint();return this.canvas.zoomToPoint(t,e)}},{key:"getStageOffset",value:function(){var e=this.whiteScreen.getBoundingRect(),t=this.getZoom();return e.left/=t,e.top/=t,{offsetX:e.left,offsetY:e.top}}},{key:"getCanvasSize",value:function(){return{width:this.canvas.getWidth(),height:this.canvas.getHeight()}}},{key:"getCanvasDetail",value:function(){var e=this.getStageOffset(),t=e.offsetX,r=e.offsetY,i=this.canvas.getZoom(),n=this.getCanvasSize();return{stageX:t,stageY:r,canvasWidth:n.width,canvasHeight:n.height,zoomRate:i}}},{key:"setAlignProcess",value:(y=v(m().mark((function e(t){var r,i,n,a,s,o,c,l,u,f,d,p,b,v,g,y,_,w,x,k,S;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.selections,this.selectAt(r),e.t0=t,e.next=e.t0===tf.LEFT?5:e.t0===tf.RIGHT?8:e.t0===tf.UP?11:e.t0===tf.DOWN?14:e.t0===tf.XCENTER?17:e.t0===tf.YCENTER?19:e.t0===tf.HCENTER?21:e.t0===tf.VCENTER?28:35;break;case 5:return n=null===(i=this.selection)||void 0===i?void 0:i.width,r.forEach((function(e){var t=-n/2+e.getBoundingRect(!0,!0).width/2,r=e.getPointByOrigin("center","center").y,i=new kf.fabric.Point(t,r);e.setPositionByOrigin(i,"center","center")})),e.abrupt("break",35);case 8:return s=null===(a=this.selection)||void 0===a?void 0:a.width,r.forEach((function(e){var t=s/2-e.getBoundingRect(!0,!0).width/2,r=e.getPointByOrigin("center","center").y,i=new kf.fabric.Point(t,r);e.setPositionByOrigin(i,"center","center")})),e.abrupt("break",35);case 11:return c=null===(o=this.selection)||void 0===o?void 0:o.height,r.forEach((function(e){var t=-c/2+e.getBoundingRect(!0,!0).height/2,r=e.getPointByOrigin("center","center").x,i=new kf.fabric.Point(r,t);e.setPositionByOrigin(i,"center","center")})),e.abrupt("break",35);case 14:return u=null===(l=this.selection)||void 0===l?void 0:l.height,r.forEach((function(e){var t=u/2-e.getBoundingRect(!0,!0).height/2,r=e.getPointByOrigin("center","center").x,i=new kf.fabric.Point(r,t);e.setPositionByOrigin(i,"center","center")})),e.abrupt("break",35);case 17:return r.forEach((function(e){var t=e.getPointByOrigin("center","center").x,r=new kf.fabric.Point(t,0);e.setPositionByOrigin(r,"center","center")})),e.abrupt("break",35);case 19:return r.forEach((function(e){var t=e.getPointByOrigin("center","center").y,r=new kf.fabric.Point(0,t);e.setPositionByOrigin(r,"center","center")})),e.abrupt("break",35);case 21:return d=null===(f=this.selection)||void 0===f?void 0:f.width,p=r.map((function(e){return e.getBoundingRect().width})).reduce((function(e,t){return e+t}),0),b=(d-p)/(r.length-1),v=-d/2,h(r).sort((function(e,t){return e.left-t.left})).forEach((function(e){var t=e.getPointByOrigin("center","center").y,r=v+e.getBoundingRect().width/2;v+=e.getBoundingRect().width+b;var i=new kf.fabric.Point(r,t);e.setPositionByOrigin(i,"center","center")})),e.abrupt("break",35);case 28:return y=null===(g=this.selection)||void 0===g?void 0:g.height,_=r.map((function(e){return e.getBoundingRect().height})).reduce((function(e,t){return e+t}),0),w=(y-_)/(r.length-1),x=-y/2,h(r).sort((function(e,t){return e.left-t.left})).forEach((function(e){var t=e.getPointByOrigin("center","center").x,r=x+e.getBoundingRect().height/2;x+=e.getBoundingRect().height+w;var i=new kf.fabric.Point(t,r);e.setPositionByOrigin(i,"center","center")})),e.abrupt("break",35);case 35:return k=this.selectAt(r),e.next=38,this.transformGroup(k);case 38:S=e.sent,this.recordOperate.apply(this,h(S));case 40:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"destroy",value:function(){this.pluginManager.destroy(),this.canvas.dispose(),this.operateManager.destroy()}},{key:"addElementFromJson",value:function(){var e=this;this.canvas.discardActiveObject();for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];this.createElementInstance(r,(function(t){t&&(e.reCalcStrokeWidth(t),e.canvas.add(t),e.computedElementZindex())}))}},{key:"removeElementFromJson",value:function(){var e=this;this.canvas.discardActiveObject();for(var t=this.getAllValidObjects(),r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];i.forEach((function(r){var i=t.find((function(e){return e.id===r}));i&&e.canvas.remove(i)}))}},{key:"updateElementFromJson",value:function(){var e=this;this.canvas.discardActiveObject();for(var t=this.getAllValidObjects(),r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];i.forEach((function(r){var i=t.find((function(e){return e.id===r.id}));if(i){i.type===rf.line&&(delete r.x1,delete r.x2,delete r.y1,delete r.y2),i.set(r),e.reCalcStrokeWidth(i),"image"===i.type&&i.setSrc(r.src,(function(){e.canvas.requestRenderAll()})),i.setCoords();var n=e.calcObjProperty(i);e.emit(ef.LOCK,n)}})),this.canvas.requestRenderAll()}},{key:"recordOperate",value:function(){for(var e=this,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var n=r.map((function(t){return e.getObjectOperateAttribute(t)})),a=this.getAllValidObjects().map((function(e){return e.id})),s=new Set(a);this.operateManager.pushCommand(n,s)}},{key:"_calcArea",value:function(e){var t=e.width,r=void 0===t?0:t,i=e.height,n=void 0===i?0:i,a=e.scaleX,s=void 0===a?0:a,o=e.scaleY;return r*s*n*(void 0===o?0:o)*(e.group&&e.group.scaleX||1)*(e.group&&e.group.scaleY||1)}},{key:"computedElementZindex",value:function(){var e=this,t=this.getAllValidObjects();t.sort((function(t,r){var i=e._calcArea(t);return e._calcArea(r)-i})),t.forEach((function(e,t){e.zIndex!==10+t&&(e.moveTo(10+t),e.set({zIndex:10+t}))}))}},{key:"getObjectOperateAttribute",value:function(e){var t=this,r={},i=nf.slice();switch(e.type){case rf.circle:i.push("radius");break;case rf.polygon:i.push("points");break;case rf.rect:case rf.ellipse:i.push("rx","ry");break;case rf.line:i.push("x1","y1","x2","y2");break;case rf.IText:case rf.Text:i.push("text","path","fontFamily","fontSize","charSpacing","pathSide");break;case rf.path:i.push("path","pathOffset");break;case rf.image:i.push("src");break;case rf.group:var n=e.getObjects().map((function(e){return t.getObjectOperateAttribute(e)}));r.objects=n}var a=e.toObject();return i.forEach((function(t){r[t]=a[t]||e.get(t)})),r.scaleX=e.get("scaleX"),r.scaleY=e.get("scaleY"),r}},{key:"getAllValidObjects",value:function(){return this.canvas.getObjects().filter((function(e){return e.name===Qh}))}},{key:"copy",value:function(){if(this.selection){var e=this.selection;U.Clipboard=[];var t,r=e.top,i=e.left;if(U.Clipboard._postion={top:r,left:i},e.type===sf)(t=U.Clipboard).push.apply(t,h(e._objects));else U.Clipboard.push(e)}}},{key:"paste",value:(b=v(m().mark((function e(){var t,r,i,n,a,s,o,c,l;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==U.Clipboard.length){e.next=2;break}return e.abrupt("return");case 2:if(t={},r=[],!(U.Clipboard.length>1)){e.next=29;break}i=0;case 6:if(!(i<U.Clipboard.length)){e.next=18;break}return n=U.Clipboard[i],e.next=10,this._deepClone(n);case 10:a=e.sent,this.setObjectIdAndParams(a,{originStroke:n.originStroke}),this.canvas.add(a),r.push(a),t[n.id]=a.id;case 15:i++,e.next=6;break;case 18:return(s=this.selectAt(r)).set({left:U.Clipboard._postion.left+10,top:U.Clipboard._postion.top+10}),s.setCoords(),e.next=23,this.transformGroup(s);case 23:o=e.sent,this.recordOperate.apply(this,h(o)),U.Clipboard=o,U.Clipboard._postion={left:s.left,top:s.top},e.next=44;break;case 29:return c=U.Clipboard[0],this.setBorderHover(c,!1),this.canvas.discardActiveObject(),e.next=34,this._deepClone(c);case 34:l=e.sent,this.setObjectIdAndParams(l,{left:U.Clipboard._postion.left+10,top:U.Clipboard._postion.top+10,originStroke:c.originStroke}),this.canvas.add(l),t[c.id]=l.id,l.setCoords(),this.canvas.setActiveObject(l),this.recordOperate(l),U.Clipboard[0]=l,U.Clipboard._postion={left:l.left,top:l.top},l.isLock?this.setObjectControlsToLock():this.setObjectControlsToUnlock();case 44:return this.computedElementZindex(),e.abrupt("return",t);case 46:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"_deepClone",value:function(e){return new Promise((function(t){e.clone((function(e){t(e)}))}))}},{key:"transformGroup",value:function(e){return new Promise((function(t){null==e||e.clone((function(r){r.ungroupOnCanvas();var i=r.getObjects().map((function(t,r){var i=e.getObjects()[r];return t.set({id:i.id,name:i.name,scaleX:i.scaleX*e.scaleX,scaleY:i.scaleY*e.scaleY,originStroke:i.originStroke}),t}));t(i)}))}))}},{key:"setObjectIdAndParams",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qh;e.set(r({id:bp(),name:i},t))}},{key:"calcObjProperty",value:function(e){return this.toJSON(e)}},{key:"getActiveJSON",value:function(){var e=this.canvas.getActiveObject();if(e)return this.calcObjProperty(e)}},{key:"getSaveCanvasObjects",value:function(){var e=this.selections;this.canvas.discardActiveObject();var t=this.getAllValidObjects();if(t=t.map((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&void 0===e[t]&&(e[t]="");return r(r({},e.toObject()),{},{originStroke:e.originStroke})})),e){var i=new kf.fabric.ActiveSelection(e,{canvas:this.canvas});this.canvas.setActiveObject(i)}return t}},{key:"importProject",value:function(e){var t=this;return new Promise((function(r){var i=0,n=[];0!==e.length?t.createElementInstance(e,(function(a){i++,a&&(n.push(a),t.canvas.add(a)),i>=e.length&&(t.recordOperate.apply(t,n),t.computedElementZindex(),r())})):r()}))}},{key:"loadResource",value:function(e,t){return e instanceof Image?this.imagefromURL(e.src,t):this.loadSVGFromString(e)}},{key:"createElementInstance",value:(d=v(m().mark((function e(t,r){var i,n=this;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){switch(e.fill||(e.fill=""),e.type){case rf.rect:i=new kf.fabric.Rect(e);break;case rf.polygon:i=new kf.fabric.Polygon(e.points,e);break;case rf.circle:i=new kf.fabric.Circle(e);break;case rf.ellipse:i=new kf.fabric.Ellipse(e);break;case rf.line:i=new kf.fabric.Line([e.x1,e.y1,e.x2,e.y2],e);break;case rf.IText:case rf.Text:i=new kf.fabric.IText(e.text,e),e.path&&i.set("path",new kf.fabric.Path(e.path.path,e.path));break;case rf.image:var t=e.src;kf.fabric.Image.fromURL(t,(function(e){r&&r(e)}),e);break;case rf.path:var a=e.path;i=new kf.fabric.Path(a,e);break;case rf.group:var s=e.objects;if(s.length>0){var o=[];n.createElementInstance(s,(function(t){if(o.push(t),o.length===s.length){delete e.objects;var i=new kf.fabric.Group(o,e);null==r||r(i)}}))}return}rf.image!==e.type&&r&&r(i)}));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)})},{key:"updateSelectedStatus",value:function(){this.selections.length>0&&(this.selections[0].isLock?this.setObjectControlsToLock():this.setObjectControlsToUnlock(),this.throttleRender())}},{key:"setObjectControlsToLock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.canvas.uniformScaling=!0,e&&this.selections.forEach((function(e){e.isLock=!0})),this.selection&&(this.selection.isLock=!0),this.setMiddleControlsVisible(!1)}},{key:"setObjectControlsToUnlock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.canvas.uniformScaling=!1,e&&this.selections.forEach((function(e){e.isLock=!1})),this.selection&&(this.selection.isLock=!1),this.setMiddleControlsVisible(!0)}},{key:"setMiddleControlsVisible",value:function(e){kf.fabric.Object.prototype.controls.ml.visible=e,kf.fabric.Object.prototype.controls.mr.visible=e,kf.fabric.Object.prototype.controls.mb.visible=e,kf.fabric.Object.prototype.controls.mt.visible=e}},{key:"getCanvasDataURL",value:function(){return this.canvas.toDataURL({multiplier:.2,quality:.2})}},{key:"setSelectable",value:function(e){this.setSelectableAll(e),this.canvas.selection=e,e||this.canvas.discardActiveObject()}},{key:"canvasDragMove",value:function(e,t){var r=new kf.fabric.Point(e,t);this.canvas.relativePan(r)}},{key:"setImageSrc",value:function(e){var t=this,r=this.canvas.getActiveObject(),i=r.width/2,n=r.height/2,a=e.width/2+e.left,s=e.height/2+e.top,o=r.getPointByOrigin("center","center"),c=(a-i)*r.scaleX,l=(s-n)*r.scaleY,u=vp({x:o.x+c,y:o.y+l},o,r.angle||0);r.setSrc(e.base64,(function(e){e.setPositionByOrigin(u,"center","center"),t.canvas.discardActiveObject(),t.canvas.setActiveObject(e),t.canvas.requestRenderAll(),t.recordOperate(e)}),{width:e.width,height:e.height})}},{key:"setPreciseSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.canvas.perPixelTargetFind=e,this.canvas.targetFindTolerance=4}},{key:"setOpenAdsorb",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];de(this.pluginManager.setOpenAdsorb)&&this.pluginManager.setOpenAdsorb(e),e?(kf.fabric.Object.prototype.snapAngle=90,kf.fabric.Object.prototype.snapThreshold=5):(kf.fabric.Object.prototype.snapAngle=0,kf.fabric.Object.prototype.snapThreshold=null)}},{key:"_strokeColorToProcessMode",value:function(e){var t="";switch(e){case"#000000":t=Kh.engrave;break;case"#E61F19":case"#00FF00":t=Kh.cut;break;case"#17489C":t=Kh.fillEngrave}return t}},{key:"getPointer",value:function(e){return this.canvas.getPointer(e)}},{key:"arrayCreation",value:(u=v(m().mark((function e(t,r){var i,n,a,s,o,c,l,u,f,d,p,b,v,g,y;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.clearBatchPreview(),i=this.selection,n=i.getBoundingRect(!0),a=[],(null==i?void 0:i.type)!==sf){e.next=11;break}return e.next=7,this.transformGroup(i);case 7:s=e.sent,a.push.apply(a,h(s)),e.next=12;break;case 11:a.push(i);case 12:o=[],c=0;case 14:if(!(c<t.columns)){e.next=43;break}l=0;case 16:if(!(l<t.rows)){e.next=40;break}if(0!==c||0!==l){e.next=19;break}return e.abrupt("continue",37);case 19:u=0;case 20:if(!(u<a.length)){e.next=37;break}return f=a[u],d=f.getPointByOrigin("right","top"),p=n.width-i.scaleX*i.strokeWidth,b=n.height-i.scaleY*i.strokeWidth,e.next=27,this._deepClone(f);case 27:v=e.sent,this.setObjectIdAndParams(v),g=d.x+(p+t.columnSpacing)*c,y=d.y+(b+t.rowSpacing)*l,v.setPositionByOrigin({x:g,y:y},"right","top"),o.push(v),this.canvas.add(v);case 34:u++,e.next=20;break;case 37:l++,e.next=16;break;case 40:c++,e.next=14;break;case 43:this.batchPreview=o,r&&(this.batchPreview=[],this.recordOperate.apply(this,o));case 45:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"centricCreation",value:(l=v(m().mark((function e(t,r){var i,n,a,s,o,c,l,u,f,d,p,b;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.clearBatchPreview(),i=this.selection,n=[],(null==i?void 0:i.type)!==sf){e.next=10;break}return e.next=6,this.transformGroup(i);case 6:a=e.sent,n.push.apply(n,h(a)),e.next=11;break;case 10:n.push(i);case 11:s=[],o=0;case 13:if(!(o<t.copyCount)){e.next=35;break}c=0;case 15:if(!(c<n.length)){e.next=32;break}return l=n[c],u=l.getPointByOrigin("center","center"),f={x:u.x,y:u.y},d=t.gapAngle*(o+1),p=vp(f,{x:t.x,y:t.y},d),e.next=23,this._deepClone(l);case 23:b=e.sent,this.setObjectIdAndParams(b),b.setPositionByOrigin({x:p.x,y:p.y},"center","center"),b.rotate(t.autorotation?(b.angle||0)+p.angle:b.angle||0),s.push(b),this.canvas.add(b);case 29:c++,e.next=15;break;case 32:o++,e.next=13;break;case 35:this.batchPreview=s,r&&(this.batchPreview=[],this.recordOperate.apply(this,s));case 37:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"materialCreation",value:(c=v(m().mark((function e(t,i){var n,a,s,o,c,l,u,h,f,d,p,b,v,g,y,_,w,x,k,S,C,U,E,T,M,O,P,A,I,L,j,R,D,B,F,N,z,H,G,W,Y,X,V=this;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.clearBatchPreview(),a=this.selection,s=a.getBoundingRect(!0),o=[],c=a.getPointByOrigin("left","top"),l=a.getPointByOrigin("left","center"),u=a.getPointByOrigin("center","bottom"),h=c.x,d=c.y,b=2,v="Speed(mm/s)",g="Power(%)",y="3mm椴木板",_=(t.speedMax-t.speedMin)/(t.speedRow-1),w=(t.powerMax-t.powerMin)/(t.powerColumn-1),x=0;case 16:if(!(x<t.powerColumn)){e.next=44;break}k=0;case 18:if(!(k<t.speedRow)){e.next=41;break}if(S="".concat((t.speedMax-_*k).toFixed()),C="".concat((t.powerMin+w*x).toFixed()),0===x&&((U=new kf.fabric.IText(S,r(r({},Np()),{},{fontSize:8,textAlign:"right",fontFamily:"Times New Roman"}))).setPositionByOrigin({x:l.x-b,y:l.y+(s.height+t.speedRowSpacing)*k},"right","center"),o.push(U),U.left<h&&(h=U.left)),0===k&&((E=new kf.fabric.IText(C,r(r({},Np()),{},{fontSize:8,textAlign:"center",fontFamily:"Times New Roman"}))).setPositionByOrigin({x:u.x+(s.width+t.powerColumnSpacing)*x,y:u.y+(s.height+t.speedRowSpacing)*(t.speedRow-1)+3},"center","top"),o.push(E),T=E.getPointByOrigin("left","bottom"),p=T.y),M=a,0===x&&0===k){e.next=37;break}return O=a.getPointByOrigin("right","top"),P=s.width-a.scaleX*a.strokeWidth,A=s.height-a.scaleY*a.strokeWidth,e.next=30,this._deepClone(a);case 30:M=e.sent,this.setObjectIdAndParams(M),I=O.x+(P+t.powerColumnSpacing)*x,L=O.y+(A+t.speedRowSpacing)*k,M.setPositionByOrigin({x:I,y:L},"right","top"),f=I,o.push(M);case 37:i&&(M.set({fill:Jh.fillEngrave,stroke:"",strokeWidth:0}),j=r(r({},j=this.calcObjProperty(M)),{},{fillEngrave:{power:Number(C),speed:Number(S),repeat:1},processMode:Kh.fillEngrave}),this.emit(ef.PROPERTYMANAGER,j),this.emit(ef.SELECTION_CHANGE,j,M));case 38:k++,e.next=18;break;case 41:x++,e.next=16;break;case 44:(R=new kf.fabric.IText(g,r(r({},Np()),{},{fontSize:12,textAlign:"center",fontFamily:"Times New Roman"}))).setPositionByOrigin({x:h+(f+s.width-h)/2,y:p+b},"center","top"),o.push(R),(D=new kf.fabric.IText(v,r(r({},Np()),{},{fontSize:12,angle:-90,textAlign:"center",fontFamily:"Times New Roman"}))).setPositionByOrigin({x:h-b,y:d+(p-d)/2},"center","bottom"),o.push(D),(B=new kf.fabric.IText(y,r(r({},Np()),{},{fontSize:12,textAlign:"center",fontFamily:"Times New Roman"}))).setPositionByOrigin({x:h+(f-h)/2,y:d-b-2},"center","bottom"),o.push(B),h=c.x-30,d=c.y-20,p=c.y+(s.height+t.speedRowSpacing)*t.speedRow+23,F=20,N=new kf.fabric.Path("\n      M ".concat(h," ").concat(d," L ").concat(h+F," ").concat(d,"\n      M ").concat(h," ").concat(d," L ").concat(h," ").concat(d+F,"\n    "),r({},Np())),o.push(N),f-=2,z=new kf.fabric.Path("\n      M ".concat(f+F," ").concat(d," L ").concat(f," ").concat(d,"\n      M ").concat(f+F," ").concat(d," L ").concat(f+F," ").concat(d+F,"\n    "),r({},Np())),o.push(z),H=new kf.fabric.Path("\n      M ".concat(f+F," ").concat(p," L ").concat(f+F," ").concat(p-F,"\n      M ").concat(f+F," ").concat(p," L ").concat(f," ").concat(p,"\n    "),r({},Np())),o.push(H),G=new kf.fabric.Path("\n      M ".concat(h," ").concat(p," L ").concat(h+F," ").concat(p,"\n      M ").concat(h," ").concat(p," L ").concat(h," ").concat(p-F,"\n    "),r({},Np())),o.push(G),(n=this.canvas).add.apply(n,o),this.reCalcStrokeWidth.apply(this,o),this.batchPreview=o,i&&(o.push(a),this.canvas.discardActiveObject(),W=this.selectAt(o,Np()),(Y=W.toGroup()).set({fill:"",strokeWidth:0}),this.recordOperate(Y),this.canvas.requestRenderAll(),this.batchPreview=[],o.forEach((function(e){if(e.type===rf.IText||"path"===e.type){var t=V.calcObjProperty(e);t=r(r({},t),{},{engrave:{power:50,speed:60,repeat:1},processMode:Kh.engrave}),V.emit(ef.SELECTION_CHANGE,t,e)}})),X=this.calcObjProperty(Y),this.emit(ef.SELECTION_CHANGE,X,Y));case 70:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"clearBatchPreview",value:function(){var e;(e=this.canvas).remove.apply(e,h(this.batchPreview)),this.batchPreview=[]}},{key:"setActiveObjectToGroup",value:(o=v(m().mark((function e(){var t,r,i,n,a,s,o,c;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],r=this.canvas.getActiveObjects(),this.canvas.discardActiveObject(),i=0;i<r.length;i++)"group"===(n=r[i]).type?(a=n.toActiveSelection(),t.push.apply(t,h(a._objects))):t.push(n);s=this.selectAt(t),(o=s.toGroup()).set({id:bp(),name:$h.name}),this.emit(ef.ADDED,{target:o}),this.recordOperate(o),c=this.calcObjProperty(o),this.emit(ef.SELECTION_CHANGE,c,o);case 11:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"ungroupToActiveObject",value:(s=v(m().mark((function e(){var t,r,i,n;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selection,r=t.toActiveSelection(),e.next=4,this.transformGroup(r);case 4:i=e.sent,this.recordOperate.apply(this,h(i)),n=this.calcObjProperty(r),this.emit(ef.SELECTION_CHANGE,n,r);case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setLayerActiveObject",value:function(e){var t=this.canvas.getObjects(),r=[];e.forEach((function(e){var i=t.find((function(t){return t.id===e}));i&&r.push(i)})),1===r.length?this.canvas.setActiveObject(r[0]):r.length>1&&this.selectAt(r,{originX:"left",originY:"top"}),this.canvas.requestRenderAll()}},{key:"removeCanvasObjects",value:function(e){var t=this;if(e.length){var r=h(e),i=this.selection,n=[];i.id&&"activeSelection"!==i.type?e.includes(i.id)||n.push(i):i._objects.forEach((function(t){e.includes(t.id)||n.push(t)})),this.canvas.discardActiveObject();var a=this.canvas.getObjects();r.forEach((function(e){var r=a.find((function(t){return t.id===e}));r&&t.canvas.remove(r)})),this.canvas.requestRenderAll(),n.length&&this.selectAt(n)}}},{key:"setUnitType",value:function(e){de(this.pluginManager.onUnitChange)&&this.pluginManager.onUnitChange(e)}},{key:"cloneAddCanvas",value:(t=v(m().mark((function e(t){var r,i,n,a=arguments;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},i=a.length>2?a[2]:void 0,e.next=4,this._deepClone(t);case 4:n=e.sent,this.setObjectIdAndParams(n),n.set(r),i&&i(n),this.canvas.add(n),this.recordOperate(n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getClosestCanvasElementCentrePoint",value:function(){var e=this.selections;this.canvas.discardActiveObject();var t=this.getAllValidObjects().map((function(e){return e.getCenterPoint()}));return t.sort((function(e,t){return e.y-t.y})),0===t.length?null:t.length>0?(e.length>1?this.selectAt(e):1===e.length&&this.canvas.setActiveObject(e[0]),t):void 0}},{key:"switchCanvasMode",value:function(e){var t,r,i,n;(this.workMode=e,e===Bp.PLANE)?(t=this.originStageWidth,r=this.originStageHeight,null===(i=this.backgroundImg)||void 0===i||i.set({angle:0,left:0})):(t=this.originStageHeight,r=this.originStageWidth,null===(n=this.backgroundImg)||void 0===n||n.set({angle:90,left:t}));this.canvasOptions.stageWidth=t,this.canvasOptions.stageHeight=r,this.whiteScreen.set({width:t,height:r});var a=this.canvas.getZoom(),s=this.pluginManager.getPlugin("gridBackground");s&&(s._plugin.resize(t,r,a),this.backgroundImg&&s._plugin.grids.forEach((function(e){"pathBorder"!==e.name&&e.set("opacity",.2)}))),this.throttleRender()}}]),U}(xf.EventEmitter);function Np(){return r(r({},$h),{},{id:bp()})}g(Fp,"Clipboard",[]);var zp=function(){function e(t){var r;f(this,e),g(this,"offset",{x:0,y:0}),g(this,"curOffset",{x:0,y:0}),g(this,"mousePosition",{x:0,y:0}),g(this,"maxScale",8),g(this,"minScale",.4),g(this,"scaleStep",.2),g(this,"scale",1),g(this,"preScale",1),g(this,"width",void 0),g(this,"height",void 0),g(this,"x",0),g(this,"y",0),g(this,"canvas",void 0),g(this,"displacement",{scale:1,originScale:1,pageX:0,pageY:0,pageX2:0,pageY2:0,moveable:!1}),this.canvas=t,this.width=t.options.width,this.height=t.options.height,this.scale=(null===(r=t.options)||void 0===r?void 0:r.scale)||1,this.touchstart=this.touchstart.bind(this),this.touchmove=this.touchmove.bind(this),this.touchend=this.touchend.bind(this),this.onMousewheel=this.onMousewheel.bind(this),this.initEventListener(),this.paint=function(e,t){var r=t.wait,i=void 0===r?200:r,n=t.prevent,a=void 0!==n&&n,s=t.stop,o=void 0!==s&&s,c=!0;if(!de(e))throw new Error("useThrottle hook 第一个参数需要传入函数");return function(t){c&&(e(),setTimeout((function(){c=!0}),i)),c=!1,a&&(null==t||t.preventDefault()),o&&(null==t||t.stopPropagation())}}(this.paint.bind(this),{wait:15}),this.initZoom()}return p(e,[{key:"initEventListener",value:function(){this.canvas.target.addEventListener("wheel",this.onMousewheel,{passive:!1})}},{key:"onMousewheel",value:function(e){if(e.preventDefault(),this.mousePosition.x=e.offsetX,this.mousePosition.y=e.offsetY,e.wheelDelta>0){if(this.scale=parseFloat((this.scaleStep+this.scale).toFixed(2)),this.scale>this.maxScale)return void(this.scale=this.maxScale)}else if(this.scale=parseFloat((this.scale-this.scaleStep).toFixed(2)),this.scale<this.minScale)return void(this.scale=this.minScale);this.zoom()}},{key:"zoom",value:function(){this.offset.x=this.mousePosition.x-(this.mousePosition.x-this.offset.x)*this.scale/this.preScale,this.offset.y=this.mousePosition.y-(this.mousePosition.y-this.offset.y)*this.scale/this.preScale,this.paint(),this.preScale=this.scale,this.curOffset.x=this.offset.x,this.curOffset.y=this.offset.y}},{key:"touchstart",value:function(e){e.preventDefault();var t=e.touches[0],r=e.touches[1];if(this.displacement.pageX=t.pageX,this.displacement.pageY=t.pageY,r&&(this.displacement.pageX2=r.pageX,this.displacement.pageY2=r.pageY),this.displacement.originScale=this.scale||1,r){var i=this.getPosition(e);this.x=i.x,this.y=i.y}else this.x=t.pageX,this.y=t.pageY;this.canvas.target.addEventListener("touchmove",this.touchmove,{passive:!1}),this.canvas.target.addEventListener("touchend",this.touchend,{passive:!1})}},{key:"getPosition",value:function(e){var t=e.touches,r=t[0],i=t[1];return{x:(r.pageX+i.pageX)/2,y:(r.pageY+i.pageY)/2}}},{key:"touchmove",value:function(e){e.preventDefault();var t=e.touches,r=t[0],i=t[1];if(i){this.displacement.pageX2||(this.displacement.pageX2=i.pageX),this.displacement.pageY2||(this.displacement.pageY2=i.pageY);var n=this.getDistance({x:r.pageX,y:r.pageY},{x:i.pageX,y:i.pageY})/this.getDistance({x:this.displacement.pageX,y:this.displacement.pageY},{x:this.displacement.pageX2,y:this.displacement.pageY2});n=Number(n.toFixed(5));var a=this.displacement.originScale*n;this.scale=a,this.mousePosition.x=this.width/2,this.mousePosition.y=this.height/2,this.zoom()}else this.offset.x=this.curOffset.x+(r.pageX-this.x),this.offset.y=this.curOffset.y+(r.pageY-this.y),this.paint()}},{key:"getDistance",value:function(e,t){return Math.hypot(t.x-e.x,t.y-e.y)}},{key:"touchend",value:function(){this.curOffset.x=this.offset.x,this.curOffset.y=this.offset.y,this.canvas.target.removeEventListener("touchmove",this.touchmove),this.canvas.target.removeEventListener("touchend",this.touchend)}},{key:"initZoom",value:function(){this.mousePosition.x=this.width/2,this.mousePosition.y=this.height/2,this.zoom()}},{key:"reset",value:function(){}},{key:"draw",value:function(){this.canvas.options.useCache||this.canvas.options.useOffscreen?this.canvas.endPainting():this.canvas.executeOperateHistory()}},{key:"paint",value:function(){var e;this.clear(),this.canvas.ctx.translate(this.offset.x,this.offset.y),null===(e=this.canvas.ctx)||void 0===e||e.scale(this.scale,this.scale),this.canvas.initStageBackground(this.canvas.options),this.draw()}},{key:"clear",value:function(){this.canvas.target.width=this.canvas.options.width,this.canvas.initCanvasBackground(this.canvas.options)}},{key:"destroy",value:function(){var e,t;null===(e=this.canvas.target)||void 0===e||e.removeEventListener("wheel",this.onMousewheel),null===(t=this.canvas.target)||void 0===t||t.removeEventListener("touchstart",this.touchstart)}}]),e}(),Hp=function(){function e(t){f(this,e),g(this,"_left",void 0),g(this,"_top",void 0),g(this,"target",void 0),g(this,"ctx",void 0),g(this,"offscreen",{}),g(this,"options",void 0),g(this,"events",void 0),g(this,"operateHistory",[]),g(this,"canvasCache",{}),this.options=t,this.target=t.target,this.ctx=t.target.getContext("2d"),this.initCache(t),this.initCanvasBackground(t),this.initStageBackground(t),t.isMoveCanvas&&(this.target.style.cursor="move",this.events=new zp(this))}return p(e,[{key:"initOffscreen",value:function(e){this.options.useOffscreen&&(this.offscreen.useOffscreen=this.options.useOffscreen,this.offscreen.imageBitmap=e,this.endPainting())}},{key:"initCache",value:function(e){e.useCache&&(this.canvasCache.useCache=e.useCache,this.canvasCache.cacheCanvas=document.createElement("canvas"),this.canvasCache.cacheCanvas.width=e.width||400,this.canvasCache.cacheCanvas.height=e.height||300,this.canvasCache.cacheCtx=this.canvasCache.cacheCanvas.getContext("2d"))}},{key:"initCanvasBackground",value:function(e){var t=e.width,r=e.height;this.target.width=t||400,this.target.height=r||300;var i=this.ctx;i.beginPath(),i.clearRect(0,0,t,r),i.fillStyle=e.canvasBackgroundColor,i.fillRect(0,0,t,r),i.closePath()}},{key:"initStageBackground",value:function(e){if(e.isInitStage){var t=e.stageWidth,r=e.stageHeight,i=.5+(this._left=(e.width-t)/2),n=.5+(this._top=(e.height-r)/2),a=this.ctx;a.beginPath(),a.fillStyle=e.stageBackgroundColor,a.fillRect(i,n,t,e.stageHeight),a.lineWidth=e.stageBorderWidth,a.strokeStyle=e.stageBorderColor,a.strokeRect(i,n,t,e.stageHeight),a.closePath()}}},{key:"drawLine",value:function(e,t){var r,i,n=this,a=null===(r=this.options.machineOptions)||void 0===r?void 0:r.S;i=this.options.useCache?this.canvasCache.cacheCtx:this.ctx,this.ctx.save(),i.lineWidth=this.options.strokeWidth||1,e.forEach((function(t,r){if(0===r);else{var s;i.beginPath();var o=null===(s=n.options.strokeStyle)||void 0===s?void 0:s.split(",");o&&o.length>1&&(o[o.length-1]=t.s/a+")",o=o.join(",")),i.strokeStyle=o,i.moveTo(e[r-1].x+n._left,e[r-1].y+n._top),i.lineTo(t.x+n._left,t.y+n._top),i.stroke()}})),this.ctx.restore(),(null==t||!t.isHistory)&&this.addOperateHistory(this.drawLine,e,t),this.options.useCache&&this.endPainting()}},{key:"endPainting",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=null;this.options.useOffscreen?r=this.offscreen.imageBitmap:this.options.useCache&&(r=this.canvasCache.cacheCanvas),this.ctx.drawImage(r,e,t)}},{key:"addOperateHistory",value:function(e,t,r){this.operateHistory.push({fn:e.bind(this),arg:t,options:r})}},{key:"executeOperateHistory",value:function(){this.operateHistory.forEach((function(e){e.fn(e.arg,r(r({},e.options),{},{isHistory:!0}))}))}},{key:"clearRect",value:function(){this.ctx.clearRect(0,0,this.options.width,this.options.height),this.operateHistory=[]}},{key:"destroy",value:function(){this.events.destroy(),this.clearRect(),this.ctx=null,this.target=null}}]),e}();function Gp(){return new Worker(""+new URL("OffscreenCanvasWorker-d4a672d7.js",o.meta.url).href)}function Wp(t){var i,n=t.state,a=t.canvasIds,s=t.canvasSize,o=t.handleSwitchModel,c=t.toggleMultCanvas,h=t.addMultCanvas,f=t.onResize,d=t.setZoom,p=ue(),b=te(),g=fe(),y=we(),_=J().t,x=re(),k=Be(),S=B(),C=B(!1),U=B(!1),E=B(""),T=B(10),M=B(1),O=B(_("editor.casswoodBoard3mm")),P=B(1),A=B(!1),I=B(""),L=B("beforeSend"),j=B(p.isConnectedDevice),R=B(!1),D=B(!1),F=B(!1),N=B([{label:_("editor.lineEngrave"),key:ke.engrave},{label:_("editor.fillEngrave"),key:ke.fillEngrave},{label:_("editor.lineCut"),key:ke.cut}]),z=B([{label:_("editor.engrave"),key:ke.fillEngrave}]),H=l((function(){return oe(g.currProperty)})),G=l((function(){return a.value.map((function(e,t){return{name:_("editor.currentPage",{page:t+1}),id:e,index:t+1}}))})),W=B(!1),X=u({text:j.value?_("editor.startPro"):_("editor.connectDev"),isConnected:j.value}),V=l((function(){return R.value||D.value}));function q(e,t){var r,i=null===(r=g.canvas())||void 0===r?void 0:r.whiteScreenData;return{width:i.width/2-e/2,height:i.height/2-t/2}}var Z=function(){var t=v(m().mark((function t(){var r,i,n,s,o,l,u,f;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=x.params.projectID,!g.localProjectId||!r.includes("project")){t.next=7;break}i=g.localProjectList,(n=i.find((function(e){return e.projectId===r})))?K(n):h(),t.next=36;break;case 7:if("material"!==r){t.next=35;break}if(s=y.materialSource.svgList){t.next=13;break}h(),t.next=33;break;case 13:o=e(s),t.prev=14,o.s();case 16:if((l=o.n()).done){t.next=24;break}if(!(u=l.value)){t.next=22;break}return h(),t.next=22,null===(f=g.canvas())||void 0===f?void 0:f.loadSVGFromString(u,(function(e){var t=e.getObjects(),r=Ee(e.width)/e.width,i=Ee(e.height)/e.height;null==e||e.set({scaleX:r,scaleY:i,left:q(e.width*r,e.height*i).width,top:q(e.width*r,e.height*i).height}),null==t||t.forEach((function(e){$(e)})),Q(t)}));case 22:t.next=16;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(14),o.e(t.t0);case 29:return t.prev=29,o.f(),t.finish(29);case 32:c(a.value[0]);case 33:t.next=36;break;case 35:h();case 36:Y((function(){var t,r=e(me.instance.getList());try{for(r.s();!(t=r.n()).done;){var i=w(t.value,2)[1];null==i||i.setUnitType(k.setOption.unit)}}catch(n){r.e(n)}finally{r.f()}}));case 37:case"end":return t.stop()}}),t,null,[[14,26,29,32]])})));return function(){return t.apply(this,arguments)}}(),K=function(){var e=v(m().mark((function e(t){var i,n,a,s,o;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.remark=t.remark,i=t.canvasList,n=t.processList,a=0;case 4:if(!(a<i.length)){e.next=13;break}return o=i[a],h(),e.next=9,null===(s=g.canvas())||void 0===s?void 0:s.importProject(o.objects);case 9:o.objects.forEach((function(e){g.setElementProperty(r({id:e.id},n[e.id]))}));case 10:a++,e.next=4;break;case 13:c(t.currentCanvasId),g.localProjectId=t.projectId,g.setProjectDirty(!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){var t=[];e.forEach((function(e){var r=e.fill||e.stroke,i=t.findIndex((function(e){return e===r}));if(-1!==i)g.currentCanvasLayer.layer[i].ids.push(e.id);else{if(t.length){var n=g.currentCanvasLayer.layer[0].index+1;g.currentCanvasLayer.layer.unshift({name:"图层 "+n,index:n,ids:[e.id],isEdit:!1,selected:!1})}else g.currentCanvasLayer.layer[0].ids.push(e.id);t.unshift(r)}}))};function $(e){var t=g.canvas().toJSON(e),r=function(e){var t="";switch(e){case"#000000":t="engrave";break;case"#E61F19":case"#00FF00":t="cut";break;case"#17489C":t="fillEngrave"}return t}(e.originStroke);if(r)switch(r){case ke.engrave:e.set({fill:"",stroke:Te.engrave,originStroke:Te.engrave}),t.processMode=ke.engrave,g.setElementProperty(t);break;case ke.fillEngrave:e.set({fill:Te.fillEngrave,stroke:Te.fillEngrave,originStroke:Te.fillEngrave}),t.processMode=ke.fillEngrave,g.setElementProperty(t);break;case ke.cut:e.set({fill:"",stroke:e.originStroke,originStroke:e.originStroke,isVariableThickness:e.originStroke===Te.variableThickness}),t.processMode=ke.cut,g.setElementProperty(t)}}var ee=function(e){P.value=e.index,C.value=!1,c(e.id)},ne=function(e,t){g.setCanvasElementProperty({type:e,value:t})},ae=function(e,t){e?(W.value=!0,n.title=_("editor.machiningParameterSetting"),n.leftText=_("editor.backEdit")):(W.value=!1,n.title=_("editor.processingMaterial"),n.leftText=_("common.back")),Y((function(){f(),t&&de(t)&&t()}))},se=function(e){return window.screen.width/375*e},ce=!1;var le=B(!1);function he(){le.value=!0,g.calculateGcode().then((function(e){var t=e||{},r=t.gcode,a=t.isOutWorkArea;if(!r)return Ie(_("editor.no_active_element")),void(le.value=!1);var s=function(){var e;if(E.value=r,Oe(E.value)>50)return Ie(_("editor.machining.gcode_size_tip")),le.value=!1,void(E.value="");e=r,(pe=new Gp).onmessage=function(e){e.data?(e.data.showModal&&(U.value=!0,T.value=e.data.duration,I.value="".concat(_("editor.preProsessTime"),": ").concat(be(T.value)),Y((function(){var t,r,a,s,o;r=null===(t=g.canvas())||void 0===t?void 0:t.whiteScreenData,a=se(n.gcodeCanvasSize.h),s=a/r.height-.1,o=document.querySelector(".gcodeViewBox"),i=new Hp({target:o,width:n.gcodeCanvasSize.w,height:a,canvasBackgroundColor:"#E6E6E6",stageWidth:r.width,stageHeight:r.height,stageBackgroundColor:r.fill,stageBorderColor:r.stroke||"#43c9b0",stageBorderWidth:1,strokeStyle:"rgba(0,0,0,1)",strokeWidth:$h.strokeWidth,isInitStage:!0,useCache:!1,scale:s,isMoveCanvas:!0,useOffscreen:ce,machineOptions:{S:1e3}});var c=JSON.parse(JSON.stringify(i.options));i.options.useOffscreen?pe.postMessage({options:c,offscreenCanvas:!0}):(ve=e.data.pictures,Y((function(){ve.forEach((function(e){i.drawLine(e)})),le.value=!1})))}))),e.data.drawOK&&(i.initOffscreen(e.data.imageBitmap),le.value=!1)):le.value=!1},pe.postMessage({gcode:e,useOffscreen:ce})};return a?De({title:_("common.tip"),message:_("editor.out_canvas_tip"),confirmButtonText:_("common.confirm"),cancelButtonText:_("common.cancel")}).then((function(){s()})).catch((function(){le.value=!1,E.value=""})):s(),!0}))}var pe,be=function(e){return e>3600?(e/3600).toFixed(1)+_("editor.hours"):e<60?e.toFixed(1)+_("editor.seconds"):e<3600?(e/60).toFixed(1)+_("editor.minits"):void 0},ve=[];var ge=function(){var e,t=null===(e=g.canvas())||void 0===e?void 0:e.canvas.getObjects(),r=null==t?void 0:t.filter((function(e){var t=e.left+e.width,r=e.top+e.height;return"element"===e.name&&e.left>=0&&e.top>=0&&t<=n.gridBackgroundSize.w&&r<=n.gridBackgroundSize.h})),i=null;return null==r||r.forEach((function(e){i?e.top<i.top&&(i=e):i=e})),i?{x:(i.left+i.left+i.width)/2,y:(i.top+i.top+i.height)/2}:{x:0,y:0}},ye=function(){D.value=!0,p.takePhoto().then((function(){var e;D.value=!1;var t=null===(e=g.canvas())||void 0===e?void 0:e.pluginManager.getPlugin("gridBackground");t&&t._plugin.grids.forEach((function(e){"pathBorder"!==e.name&&e.set("opacity",.2)}))})).catch((function(){D.value=!1,Ie(_("editor.refreshBgFailed"))})).finally((function(){D.value=!1}))};return ie((function(){j.value=p.isConnectedDevice,X.text=j.value?_("editor.startPro"):_("editor.connectDev")})),{gcodeFinish:S,connectStatusState:X,isShowPagePick:C,isShowProcessPop:W,processMode:N,imageProcessMode:z,processAttr:H,times:M,plate:O,currentPage:P,showModal:U,canvasList:G,duration:T,tip:I,processStatus:L,isConnectedDevice:j,isRanging:R,isTakingPhoto:D,isAutoFocused:F,disabledStart:V,startWork:he,onSelectPage:ee,prePage:function(){if(P.value>1){var e=P.value-1,t=G.value.find((function(t){return t.index===e}));t&&ee(t)}},nextPage:function(){if(P.value<G.value.length){var e=P.value+1,t=G.value.find((function(t){return t.index===e}));t&&ee(t)}},onFormChange:ne,onClickTab:function(e){ne("processMode",e)},hanldeMakeIt:function(){if(!V.value||!j.value)if(W.value)he();else if(j.value){if(!ge())return void Ie(_("editor.stageEmpty"));ae(!0,(function(){setTimeout((function(){n.zoomPoint={x:n.gridBackgroundSize.w/2,y:n.gridBackgroundSize.h/2-25};var e=Math.min(s.w/n.gridBackgroundSize.w,s.h/n.gridBackgroundSize.h);d(e-.1)}),100)})),o(!1)}else b.push("/connectConfig")},onClickLeft:function(){W.value?ae(!1,(function(){n.zoomPoint={x:s.w/2,y:s.h/2},d(s.h/n.gridBackgroundSize.h-.1)})):b.back()},handleSend:function(){var e=new Me;e.appendAsciiStr(E.value);var t=e.end();A.value=!0,p.uploadGcode(E.value,t).then((function(e){200===e.status&&(L.value="standby")})).catch((function(){A.value=!1}))},initMaterial:Z,closeProcessPop:function(){var e;U.value=!1,null===(e=i)||void 0===e||e.destroy(),I.value="",L.value="beforeSend",T.value=0,ae(!1)},handleFocus:function(){var e;if(!R.value){R.value=!0;var t=null===(e=g.canvas())||void 0===e?void 0:e.getClosestCanvasElementCentrePoint();if(t){for(var r=!1,i=0;i<t.length;i++){var n=t[i];if(n.x>=0&&n.x<=420&&n.y>=0&&n.y<=290){p.measureDistance({x:Number(n.x.toFixed(2)),y:Number(n.y.toFixed(2))}).then((function(e){R.value=!1;var t=e.data;g.setThickness(t["height-z"]||0),g.setCalibrationsHeight(t.distance),F.value=!0,setTimeout((function(){ye()}),1e3)})).catch((function(){R.value=!1,F.value=!1,Ie(_("editor.autoFocusFailed"))})).finally((function(){R.value=!1})),r=!1;break}r=!0}r&&Ie(_("editor.stageEmpty"))}else Ie(_("editor.stageEmpty"))}},handleTakePhoto:ye,switchOperateLan:function(){N.value=[{label:_("editor.lineEngrave"),key:ke.engrave},{label:_("editor.fillEngrave"),key:ke.fillEngrave},{label:_("editor.lineCut"),key:ke.cut}],z.value=[{label:_("editor.engrave"),key:ke.fillEngrave}]},getCenterPointer:ge}}var Yp={class:"mobile-edit-page"},Xp=function(e){return q("data-v-ed89a200"),e=e(),Z(),e}((function(){return C("div",{class:"canvas-box"},[C("div",{id:"canvas-container-box"})],-1)})),Vp=c({__name:"index",setup:function(e){var t=te(),r=fe(),i=re(),n=ue(),a=le(),s=J(),o=s.t,c=s.locale,l=we(),f=u({zoomPoint:{x:0,y:0},title:o("editor.processingMaterial"),leftText:o("common.back"),rightText:o("editor.startPro"),previewGcodeSize:{w:0,h:0},route:i,deviceStore:n,gridBackgroundSize:{w:420,h:295},ruler:{size:20},gcodeCanvasSize:{w:342,h:245}}),p=function(){Me.value="finished"},g=function(){var e=fe(),t=Yh(),r=J().t,i=B(!1),n=B(!1),a=B(!1),s=B([{label:r("editor.line"),key:Ce.LINE,icon:"&#xe606;"},{label:r("editor.text"),key:Ce.TEXT,icon:"&#xe764;"},{label:r("editor.shape"),key:Ce.SHAPE,icon:"&#xe767;"},{label:r("editor.unload"),key:Ce.UPLOAD,icon:"&#xe765;"},{label:r("editor.undo"),key:Ce.UNDO,icon:"&#xe766;"},{label:r("editor.redo"),key:Ce.REDO,icon:"&#xe763;"}]),o=function(){var a=v(m().mark((function a(s){var o,f,d,p,b,v,g,y;return m().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:h(!1),n.value=!1,a.t0=s,a.next=a.t0===Ce.LINE?5:a.t0===Ce.RECT?8:a.t0===Ce.CIRCLE?11:a.t0===Ce.TEXT?14:a.t0===Ce.SHAPE?17:a.t0===Ce.TRIANGLE?19:a.t0===Ce.SVG?22:a.t0===Ce.UPLOAD?25:a.t0===Ce.UNDO?36:a.t0===Ce.REDO?39:42;break;case 5:return i.value=!0,null===(o=e.canvas())||void 0===o||o.startDrawLine(),a.abrupt("break",42);case 8:return i.value=!0,null===(f=e.canvas())||void 0===f||f.drawShape(s),a.abrupt("break",42);case 11:return i.value=!0,null===(d=e.canvas())||void 0===d||d.drawShape(s),a.abrupt("break",42);case 14:return i.value=!0,null===(p=e.canvas())||void 0===p||p.startDrawText(),a.abrupt("break",42);case 17:return n.value=!0,a.abrupt("break",42);case 19:return i.value=!0,null===(b=e.canvas())||void 0===b||b.drawShape(s),a.abrupt("break",42);case 22:return i.value=!0,null===(v=e.canvas())||void 0===v||v.startDrawSvg("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjg2ODg0MjUyMzM1IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjMzODUiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTIzMS44NjY4NTggOTI0LjU1OTE5N2w5OS42MjM5NzUtMzE1LjMxNTQzMkw3Ni44OTMyNzQgMzkxLjUzNDM0OGwzMjAuNDMwOTQgMEw1MTIuMDUwMTQyIDk4LjE1ODZsMTI4LjY0MTg2OSAyOTMuMzc1NzQ3IDMwNi40MTQ3MTUgMEw3MDYuOTcxNTUzIDYwOS4wOTc0MzIgODA5LjY3NDY1NyA5MjUuODUwNjA5IDUxMy42NDM0MyA3MjcuNDA4MDAxIDIzMS44NjY4NTggOTI0LjU1OTE5N3pNNTEzLjEzNDg0NyA2ODcuODI2NTE4bDIzOC45MTg0NjEgMTU5LjA0NTMxOUw2NzAuODI2MzMyIDU5OS43NDIzNjdsMTk2LjAxNTMyNi0xNzYuNDg1NTI3TDYyMC4wOTM4OCA0MjMuMjU2ODQgNTEzLjcxMTk5MSAxODAuNjY2NzU2bC05NC44NjY2MjQgMjQyLjU5MDA4NEwxNjAuNjgzNjMyIDQyMy4yNTY4NCAzNjcuNjY3Nzc3IDU5OS4xMzQ1MjMgMjg5LjQ1NjQ4NSA4NDguMjEyMzY4IDUxMy4xMzQ4NDcgNjg3LjgyNjUxOHoiIHAtaWQ9IjMzODYiPjwvcGF0aD48L3N2Zz4="),a.abrupt("break",42);case 25:if(i.value=!0,!Q&&!$){a.next=30;break}ee("openAlbum",{},(function(e){var t=JSON.parse(e);"0"!==t.code&&"0"!==t.albumAuthority||Ie(r("device.blue.openAlbumPermis"))})),a.next=35;break;case 30:return a.next=32,t.uploadFile();case 32:g=a.sent,(y=g.fileData)&&u(y);case 35:return a.abrupt("break",42);case 36:return i.value=!0,c(),a.abrupt("break",42);case 39:return i.value=!0,l(),a.abrupt("break",42);case 42:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),c=function(){var t;null===(t=e.canvas())||void 0===t||t.undo()},l=function(){var t;null===(t=e.canvas())||void 0===t||t.redo()},u=function(t){var i,n=null===(i=e.canvas())||void 0===i?void 0:i.whiteScreenData;if(ot(t)){var a;null===(a=e.canvas())||void 0===a||a.loadResource(t)}else{var s,o=n.width,c=n.height,l=t.width,u=t.height;o<l||c<u?De({title:r("common.tip"),message:r("editor.tips.unloadImgs"),confirmButtonText:r("common.confirm"),cancelButtonText:r("common.cancel")}).then((function(){var r,i=Math.min(o/l,c/u);null===(r=e.canvas())||void 0===r||r.loadResource(t,{scaleX:i,scaleY:i})})).catch((function(){var r;null===(r=e.canvas())||void 0===r||r.loadResource(t)})):null===(s=e.canvas())||void 0===s||s.loadResource(t)}},h=function(t){var r,i;!0===t||!1===t?(a.value=t,null===(r=e.canvas())||void 0===r||r.setSelectable(!a.value)):(a.value=!a.value,null===(i=e.canvas())||void 0===i||i.setSelectable(!a.value))};return{buttons:s,isDrawing:i,isShowShapePop:n,isCanvasMoved:a,switchBtnsLan:function(){s.value=[{label:r("editor.line"),key:Ce.LINE,icon:"&#xe606;"},{label:r("editor.text"),key:Ce.TEXT,icon:"&#xe764;"},{label:r("editor.shape"),key:Ce.SHAPE,icon:"&#xe767;"},{label:r("editor.unload"),key:Ce.UPLOAD,icon:"&#xe765;"},{label:r("editor.undo"),key:Ce.UNDO,icon:"&#xe766;"},{label:r("editor.redo"),key:Ce.REDO,icon:"&#xe763;"}]},handleToolClick:o,handleImage:function(e){if(e){var t=JSON.parse(e),r=document.createElement("img");r.src=t.image,r.width=t.width,r.height=t.height,u(r)}},handleSwitchModel:h}}(),y=g.buttons,_=g.isShowShapePop,w=g.isCanvasMoved,x=g.switchBtnsLan,M=g.handleToolClick,A=g.handleImage,I=g.handleSwitchModel,L=function(e,t){var r=fe(),i=Be(),n=B(!1),a=B(),s=B([]),o=B(!1),c=u({x:0,y:0}),l=B(),f=B(),d=u({w:0,h:0}),p=B(),m=function(n){var o=document.getElementById("canvas-container-box"),u=document.createElement("canvas");o.appendChild(u);var p=new Fp({container:u,width:d.w,height:d.h,stageWidth:e.gridBackgroundSize.w,stageHeight:e.gridBackgroundSize.h,strokeWidth:0,stageBorCor:"#E0E0E6",minZoom:.6,maxZoom:20,operateMaxLimit:50,isInitGridBackground:!0,isOpenControlIcon:!0,viewportRatio:1,id:n,backdropStroke:"#E0E0E6",unit:i.setOption.unit,plugins:[{name:"gridBackground",options:{width:e.gridBackgroundSize.w,height:e.gridBackgroundSize.h}},{name:"ruler",options:{rulerX:l.value,rulerY:f.value}}]}),m=p.id;return r.addCanvas({id:m,canvas:p}),s.value=[].concat(h(s.value),[m]),r.loadMaterialInitLayers(m),a.value=null==p?void 0:p.whiteScreenData,window.addEventListener("resize",_),null==p||p.on(ef.SELECTION_CHANGE,(function(e){w(e)})).on(ef.SELECTION_CLEAR,(function(){r.chanePropertyMode(pe.STAGE)})).on(ef.ELEMENT_MODIFY,(function(e){w(e)})).on(ef.MOUSE_DOWN,(function(e){var t,r,i=e.e;y(e.changedTouches),c.x=null===(t=i.changedTouches)||void 0===t?void 0:t[0].clientX,c.y=null===(r=i.changedTouches)||void 0===r?void 0:r[0].clientY})).on(ef.UPDATE_ELEMENT_PROPERTY,(function(e){var t=e.type,i=e.value;r.updateElementProperty({type:t,value:i})})).on(ef.MOUSE_MOVE,(function(i){var n=i.e;if(t.value){var a,s,o,l,u,h,f=(null===(a=r.canvas())||void 0===a?void 0:a.canvas.getZoom())||1,d=(null===(s=n.changedTouches)||void 0===s?void 0:s[0].clientX)-c.x,p=(null===(o=n.changedTouches)||void 0===o?void 0:o[0].clientY)-c.y;null===(l=r.canvas())||void 0===l||l.canvasDragMove(d,p),c.y=null===(u=n.changedTouches)||void 0===u?void 0:u[0].clientY,c.x=null===(h=n.changedTouches)||void 0===h?void 0:h[0].clientX,n.changedTouches&&1===n.changedTouches.length&&(e.zoomPoint={x:0,y:0}),b(f)}})),window.canvas=r.canvas(),e.zoomPoint={x:d.w/2,y:d.h/2},b(d.h/e.gridBackgroundSize.h-.1),p.id},b=function(t){var i;null===(i=r.canvas())||void 0===i||i.zoomFinger(e.zoomPoint||{x:0,y:0},t),window.canvas=r.canvas()},v=function(t){var i,n,a,s,o,c;if(me.instance.has(t)){r.getCanvasSnapShoot((null===(i=r.canvas())||void 0===i?void 0:i.id)||""),g(!1),me.instance.setID(t),null===(n=r.canvas())||void 0===n||n.toggleControlsCanvas(null===(a=r.canvas())||void 0===a?void 0:a.canvas),r.currCanvasId=t,window.canvas=r.canvas(),null===(s=r.canvas())||void 0===s||s.updateSelectedStatus(),g(!0);var l=null===(o=r.canvas())||void 0===o?void 0:o.getActiveJSON();l?(r.chanePropertyMode(pe.ELEMENT),r.setElementProperty(l)):r.chanePropertyMode(pe.STAGE);var u,h=null===(c=r.canvas())||void 0===c?void 0:c.getCanvasDetail();(null==h?void 0:h.canvasWidth)===d.w&&(null==h?void 0:h.canvasHeight)===d.h||null===(u=r.canvas())||void 0===u||u.resize(d.w,d.h),e.zoomPoint={x:(d.w||0)/2,y:(d.h||0)/2};var f=(d.h||295)/295-.2;return b(f),r.canvas()}},g=function(e){var t;if(r.canvas()){var i=(null===(t=r.canvas())||void 0===t?void 0:t.canvas).wrapperEl;i&&(e?i.style.setProperty("display","block"):i.style.setProperty("display","none"))}},y=function(t){if(t&&t.length>1){var r=(t[0].clientX+t[1].clientX)/2,i=(t[0].clientY+t[1].clientY)/2;e.zoomPoint.x=r,e.zoomPoint.y=i}},_=function(){var e;x(),null===(e=r.canvas())||void 0===e||e.resize(d.w,d.h)},w=function(e){if("activeSelection"!==e.type)r.chanePropertyMode(pe.ELEMENT),r.setElementProperty(e);else{var t="image",i=e.children.every((function(e){return e.type!==t})),n=e.children.every((function(e){return e.type===t}));i||n?r.chanePropertyMode(pe.ELEMENT):r.chanePropertyMode(pe.DIIFGROP),e.children.forEach((function(e){r.setElementProperty(e)})),r.setElementProperty(e)}},x=function(){var t=Fe(document.body).height,r=Fe(document.querySelector(".bottom-button")).height+Fe(document.querySelector(".top-nav-bar")).height+Fe(document.querySelector(".edit-page-bar")).height+26,i=p.value;d.w=i.clientWidth-e.ruler.size-1,d.h=t-r,e.isShowProcessPop||(e.previewGcodeSize=oe(d))};return{isShowChooseBtn:n,whiteScreen:a,rulerX:l,rulerY:f,canvasSize:d,canvasBox:p,canvasIds:s,isRanging:o,onResize:_,handleInitCanvas:m,refreshCanvasWH:x,addMultCanvas:function(e){g(!1);var t=m(e);return v(t),t},toggleMultCanvas:v,setZoom:b}}(f,w),j=L.rulerX,R=L.rulerY,D=L.canvasSize,F=L.canvasBox,N=L.canvasIds,z=L.whiteScreen,X=L.onResize,V=L.refreshCanvasWH,q=L.toggleMultCanvas,Z=L.addMultCanvas,K=L.setZoom,se=Wp({state:f,canvasIds:N,canvasSize:D,handleSwitchModel:I,toggleMultCanvas:q,addMultCanvas:Z,onResize:X,setZoom:K}),ce=se.connectStatusState,he=se.isShowPagePick,de=se.isShowProcessPop,be=se.processMode,ve=se.imageProcessMode,ge=se.processAttr,ye=se.times,_e=se.plate,xe=se.currentPage,ke=se.showModal,Ue=se.canvasList,Ee=se.duration,Te=se.tip,Me=se.processStatus,Oe=se.isRanging,Pe=se.isTakingPhoto,Ae=se.isAutoFocused,Le=se.disabledStart,je=se.onSelectPage,Re=se.prePage,Ne=se.nextPage,ze=se.onFormChange,He=se.onClickTab,Ge=se.hanldeMakeIt,We=se.onClickLeft,Ye=se.handleSend,Xe=se.initMaterial,Ve=se.closeProcessPop,qe=se.handleFocus,Ze=se.handleTakePhoto,Ke=se.switchOperateLan;f.isShowProcessPop=de;var Je=function(e,t){var r=u({scale:1,originScale:1,pageX:0,pageY:0,pageX2:0,pageY2:0,moveable:!1}),i=fe(),n=null,a=function(e){var n;if(e.preventDefault(),t.value){var a=e.touches,s=a[0],o=a[1];c(a),r.pageX=s.pageX,r.pageY=s.pageY,r.moveable=!0,o&&(r.pageX2=o.pageX,r.pageY2=o.pageY),r.originScale=(null===(n=i.canvas())||void 0===n?void 0:n.canvas.getZoom())||0}},s=function(e){if(e.preventDefault(),r.moveable){var i=e.touches,n=i[0],a=i[1];if(c(i),a&&t.value){r.pageX2||(r.pageX2=a.pageX),r.pageY2||(r.pageY2=a.pageY);var s=l({x:n.pageX,y:n.pageY},{x:a.pageX,y:a.pageY})/l({x:r.pageX,y:r.pageY},{x:r.pageX2,y:r.pageY2});s=Number(s.toFixed(3));var u=r.originScale*s;u<.7&&(u=.7),o(u)}}},o=function(t){var r;null===(r=i.canvas())||void 0===r||r.zoomFinger(e.zoomPoint,t),window.canvas=i.canvas()},c=function(t){if(t&&t.length>1){var r=(t[0].clientX+t[1].clientX)/2,i=(t[0].clientY+t[1].clientY)/2;e.zoomPoint.x=r,e.zoomPoint.y=i}},l=function(e,t){return Math.hypot(t.x-e.x,t.y-e.y)};return W((function(){var e,t;null===(e=n)||void 0===e||e.removeEventListener("touchstart",a),null===(t=n)||void 0===t||t.removeEventListener("touchmove",s)})),{dragFun:function(e){Y((function(){var t,r;null===(t=n=document.querySelector(".".concat(e)))||void 0===t||t.addEventListener("touchstart",a,{passive:!1}),null===(r=n)||void 0===r||r.addEventListener("touchmove",s,{passive:!1})}))}}}(f,w),Qe=Je.dragFun;H((function(){return a.socketData.control.action}),(function(e){e===Se.FINISH?(console.info(o("editor.finished")),Me.value="finished"):e===Se.START?(console.info(o("editor.start")),Me.value="working"):e===Se.STOP&&(console.info(o("editor.suspend")),Me.value="suspend")}));var $e=function(){var e="zh-cn"===(navigator.language||navigator.browserLanguage).toLowerCase()?"zh_CN":"en_US";c.value=localStorage.getItem("language")||e,f.title=o("editor.processingMaterial"),f.leftText=o("common.back"),f.rightText=o("editor.startPro"),x(),Ke()},et=function(){var e=v(m().mark((function e(){var t;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.value=[],xe.value=1,Ae.value=!1,w.value=!1,F.value=void 0,r.editorDestroy(),(t=document.getElementById("canvas-container-box")).innerHTML="",t.innerText="",z.value="";case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return ie(v(m().mark((function e(){var r,i,n;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.options.history.state,i=r.forward,n=r.back,$e(),"/"!==n&&"/mine"!==n&&"/search"!==n||i){e.next=7;break}return e.next=5,et();case 5:Xe(),setTimeout((function(){Ze()}),1e3);case 7:case"end":return e.stop()}}),e)})))),G(v(m().mark((function e(){var t;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V(),null===(t=window)||void 0===t||t.addEventListener("resize",X),$e(),Qe("canvas-box"),ne("openAlbum"),ne("albumCallback",A),ne("androidPhysicalBackButtonClicked",(function(){ke.value?ke.value=!1:We()}));case 7:case"end":return e.stop()}}),e)})))),W((function(){window.removeEventListener("resize",X),r.editorDestroy(),l.$patch({materialSource:{}})})),function(e,t){var r=O("topBar");return P(),d("div",Yp,[k(r,{title:f.title,"left-text":f.leftText,"auto-back":!1,"bg-color":"var(--backgroundColorMain)",color:"white",onOnClickLeft:b(We),onOnClickRight:b(Ge)},{right:S((function(){return[C("span",{class:T(["bar-right-icon",{disabled:b(Le)}])},U(b(de)?f.rightText:b(ce).text),3)]})),_:1},8,["title","left-text","onOnClickLeft","onOnClickRight"]),k(Qt,{"is-show-page-pick":b(he),"current-page":b(xe),"canvas-list":b(Ue),onPrePage:b(Re),onNextPage:b(Ne),onShowPagePop:t[0]||(t[0]=function(e){return he.value=!0}),onClosePagePop:t[1]||(t[1]=function(e){return he.value=!1}),onOnSelectPage:b(je)},null,8,["is-show-page-pick","current-page","canvas-list","onPrePage","onNextPage","onOnSelectPage"]),k(qt,{processAttr:b(ge),"onUpdate:processAttr":t[2]||(t[2]=function(e){return E(ge)?ge.value=e:null}),plate:b(_e),"onUpdate:plate":t[3]||(t[3]=function(e){return E(_e)?_e.value=e:null}),times:b(ye),"onUpdate:times":t[4]||(t[4]=function(e){return E(ye)?ye.value=e:null}),"is-show-process-pop":b(de),"is-canvas-moved":b(w),"current-page":b(xe),buttons:b(y),"process-mode":b(be),"image-process-mode":b(ve),isRanging:b(Oe),isTakingPhoto:b(Pe),onHandleToolClick:b(M),onHandleSwitchModel:b(I),onOnClickTab:b(He),onOnFormChange:b(ze),onHandleFocus:b(qe),onHandleTakePhoto:b(Ze)},null,8,["processAttr","plate","times","is-show-process-pop","is-canvas-moved","current-page","buttons","process-mode","image-process-mode","isRanging","isTakingPhoto","onHandleToolClick","onHandleSwitchModel","onOnClickTab","onOnFormChange","onHandleFocus","onHandleTakePhoto"]),k(zn,{isShowShapePop:b(_),"onUpdate:isShowShapePop":t[5]||(t[5]=function(e){return E(_)?_.value=e:null}),onHandleToolClick:b(M)},null,8,["isShowShapePop","onHandleToolClick"]),C("div",{id:"canvas-box",ref_key:"canvasBox",ref:F},[C("canvas",ae({id:"rulerX",ref_key:"rulerX",ref:j},{width:b(D).w,height:f.ruler.size}),null,16),C("canvas",ae({id:"rulerY",ref_key:"rulerY",ref:R},{width:f.ruler.size,height:b(D).h}),null,16),Xp],512),k(Ln,{showModal:b(ke),"onUpdate:showModal":t[6]||(t[6]=function(e){return E(ke)?ke.value=e:null}),duration:b(Ee),"process-status":b(Me),tip:b(Te),onFinish:p,onHandleSend:b(Ye),onClose:b(Ve)},null,8,["showModal","duration","process-status","tip","onHandleSend","onClose"])])}}});t("default",L(Vp,[["__scopeId","data-v-ed89a200"]]))}}}))}();
